Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2248
Description:  icbhi_pneumoniajordan_seaprated
2021-06-23 21:35:59.063091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-23 21:36:01.830148: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 21:36:01.831202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-23 21:36:01.845091: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:01.845880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 21:36:01.845913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 21:36:01.849631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 21:36:01.849735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 21:36:01.850875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 21:36:01.851195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 21:36:01.852292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 21:36:01.853220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 21:36:01.853383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 21:36:01.853537: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:01.854513: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:01.855272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2248.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-23 21:36:07.117004: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 21:36:07.117287: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:07.118109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 21:36:07.118157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 21:36:07.118211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 21:36:07.118241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 21:36:07.118262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 21:36:07.118283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 21:36:07.118304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 21:36:07.118326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 21:36:07.118346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 21:36:07.118438: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:07.119265: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:07.119987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-23 21:36:07.120044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 21:36:07.988373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-23 21:36:07.988439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-23 21:36:07.988452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-23 21:36:07.988800: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:07.989981: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:07.991098: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:36:07.992121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-23 21:36:09.264322: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-23 21:36:09.266025: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-23 21:36:09.680185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 21:36:12.154827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 21:36:12.721284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
167/167 - 76s - loss: 0.5486 - accuracy: 0.6474 - val_loss: 0.7274 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.07386717911570578
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
167/167 - 69s - loss: 0.3172 - accuracy: 0.8035 - val_loss: 0.6909 - val_accuracy: 0.7329
Confusion matrix: 
 [[442 131]
 [ 33   8]]
Normalized Confusion matrix: 
 [[0.771 0.229]
 [0.805 0.195]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 8.89
Validation accuracy: 73.29
Validation recall: 19.51
Validation precision: 5.76
Validation AUC: 0.06306079297165115
Validation class accuracies: [0.7713787085514834, 0.1951219512195122]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
167/167 - 70s - loss: 0.1851 - accuracy: 0.8912 - val_loss: 0.5765 - val_accuracy: 0.8648
Confusion matrix: 
 [[508  65]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.439 0.561]]
Validation f1: 35.66
Validation accuracy: 86.48
Validation recall: 56.10
Validation precision: 26.14
Validation AUC: 0.4147109167802549
Validation class accuracies: [0.8865619546247818, 0.5609756097560976]
Saving model...
Epoch 4/65
167/167 - 69s - loss: 0.1248 - accuracy: 0.9392 - val_loss: 1.0822 - val_accuracy: 0.5098
Confusion matrix: 
 [[282 291]
 [ 10  31]]
Normalized Confusion matrix: 
 [[0.492 0.508]
 [0.244 0.756]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.08
Validation accuracy: 50.98
Validation recall: 75.61
Validation precision: 9.63
Validation AUC: 0.5064859386741115
Validation class accuracies: [0.49214659685863876, 0.7560975609756098]
The validation tracker metric at 0.35658914728682173 hasn't increased by 0 in 1 epochs
Epoch 5/65
167/167 - 71s - loss: 0.1001 - accuracy: 0.9497 - val_loss: 0.3629 - val_accuracy: 0.8534
Confusion matrix: 
 [[499  74]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.71
Validation accuracy: 85.34
Validation recall: 60.98
Validation precision: 25.25
Validation AUC: 0.47791602947114914
Validation class accuracies: [0.8708551483420593, 0.6097560975609756]
Saving model...
Epoch 6/65
167/167 - 69s - loss: 0.0544 - accuracy: 0.9741 - val_loss: 0.2006 - val_accuracy: 0.9397
Confusion matrix: 
 [[549  24]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.317 0.683]]
Validation f1: 60.22
Validation accuracy: 93.97
Validation recall: 68.29
Validation precision: 53.85
Validation AUC: 0.6446261260547921
Validation class accuracies: [0.9581151832460733, 0.6829268292682927]
Saving model...
Epoch 7/65
167/167 - 68s - loss: 0.0310 - accuracy: 0.9910 - val_loss: 0.5548 - val_accuracy: 0.8208
Confusion matrix: 
 [[470 103]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82  0.18 ]
 [0.171 0.829]]
Validation f1: 38.20
Validation accuracy: 82.08
Validation recall: 82.93
Validation precision: 24.82
Validation AUC: 0.5956339701862589
Validation class accuracies: [0.8202443280977313, 0.8292682926829268]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 1 epochs
Epoch 8/65
167/167 - 69s - loss: 0.0471 - accuracy: 0.9816 - val_loss: 0.6182 - val_accuracy: 0.8502
Confusion matrix: 
 [[491  82]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.857 0.143]
 [0.244 0.756]]
Validation f1: 40.26
Validation accuracy: 85.02
Validation recall: 75.61
Validation precision: 27.43
Validation AUC: 0.6052012313348313
Validation class accuracies: [0.8568935427574171, 0.7560975609756098]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 2 epochs
Epoch 9/65
167/167 - 69s - loss: 0.0319 - accuracy: 0.9865 - val_loss: 0.2431 - val_accuracy: 0.9202
Confusion matrix: 
 [[537  36]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.317 0.683]]
Validation f1: 53.33
Validation accuracy: 92.02
Validation recall: 68.29
Validation precision: 43.75
Validation AUC: 0.6344844344825195
Validation class accuracies: [0.93717277486911, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 3 epochs
Epoch 10/65
167/167 - 72s - loss: 0.0186 - accuracy: 0.9947 - val_loss: 0.2389 - val_accuracy: 0.9349
Confusion matrix: 
 [[548  25]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.366 0.634]]
Validation f1: 56.52
Validation accuracy: 93.49
Validation recall: 63.41
Validation precision: 50.98
Validation AUC: 0.6538265678213251
Validation class accuracies: [0.956369982547993, 0.6341463414634146]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 4 epochs
Epoch 11/65
167/167 - 69s - loss: 0.0106 - accuracy: 0.9981 - val_loss: 0.3164 - val_accuracy: 0.9169
Confusion matrix: 
 [[533  40]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.268 0.732]]
Validation f1: 54.05
Validation accuracy: 91.69
Validation recall: 73.17
Validation precision: 42.86
Validation AUC: 0.648359814434816
Validation class accuracies: [0.9301919720767888, 0.7317073170731707]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 5 epochs
Epoch 12/65
167/167 - 69s - loss: 0.0621 - accuracy: 0.9824 - val_loss: 0.4372 - val_accuracy: 0.8746
Confusion matrix: 
 [[514  59]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.40
Validation accuracy: 87.46
Validation recall: 56.10
Validation precision: 28.05
Validation AUC: 0.445916965840654
Validation class accuracies: [0.8970331588132635, 0.5609756097560976]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
167/167 - 69s - loss: 0.0531 - accuracy: 0.9782 - val_loss: 0.3491 - val_accuracy: 0.9023
Confusion matrix: 
 [[523  50]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.244 0.756]]
Validation f1: 50.82
Validation accuracy: 90.23
Validation recall: 75.61
Validation precision: 38.27
Validation AUC: 0.5820559270050546
Validation class accuracies: [0.912739965095986, 0.7560975609756098]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 7 epochs
Epoch 14/65
167/167 - 70s - loss: 0.0179 - accuracy: 0.9936 - val_loss: 0.2686 - val_accuracy: 0.9267
Confusion matrix: 
 [[543  30]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.366 0.634]]
Validation f1: 53.61
Validation accuracy: 92.67
Validation recall: 63.41
Validation precision: 46.43
Validation AUC: 0.5852220099021443
Validation class accuracies: [0.9476439790575916, 0.6341463414634146]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 8 epochs
Epoch 15/65
167/167 - 71s - loss: 0.0156 - accuracy: 0.9970 - val_loss: 0.2981 - val_accuracy: 0.9153
Confusion matrix: 
 [[534  39]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.317 0.683]]
Validation f1: 51.85
Validation accuracy: 91.53
Validation recall: 68.29
Validation precision: 41.79
Validation AUC: 0.5510616236934955
Validation class accuracies: [0.9319371727748691, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 9 epochs
Epoch 16/65
167/167 - 68s - loss: 0.0148 - accuracy: 0.9947 - val_loss: 0.2298 - val_accuracy: 0.9528
Confusion matrix: 
 [[561  12]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.415 0.585]]
Validation f1: 62.34
Validation accuracy: 95.28
Validation recall: 58.54
Validation precision: 66.67
Validation AUC: 0.5968926270122342
Validation class accuracies: [0.9790575916230366, 0.5853658536585366]
Saving model...
Epoch 17/65
167/167 - 69s - loss: 0.0092 - accuracy: 0.9996 - val_loss: 0.2447 - val_accuracy: 0.9414
Confusion matrix: 
 [[552  21]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.366 0.634]]
Validation f1: 59.09
Validation accuracy: 94.14
Validation recall: 63.41
Validation precision: 55.32
Validation AUC: 0.5884163112281527
Validation class accuracies: [0.9633507853403142, 0.6341463414634146]
The validation tracker metric at 0.6233766233766234 hasn't increased by 0 in 1 epochs
Epoch 18/65
167/167 - 70s - loss: 0.0064 - accuracy: 0.9992 - val_loss: 0.2368 - val_accuracy: 0.9446
Confusion matrix: 
 [[555  18]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.39  0.61 ]]
Validation f1: 59.52
Validation accuracy: 94.46
Validation recall: 60.98
Validation precision: 58.14
Validation AUC: 0.5967364270402773
Validation class accuracies: [0.9685863874345549, 0.6097560975609756]
The validation tracker metric at 0.6233766233766234 hasn't increased by 0 in 2 epochs
Epoch 19/65
167/167 - 69s - loss: 0.0074 - accuracy: 0.9989 - val_loss: 0.2540 - val_accuracy: 0.9397
Confusion matrix: 
 [[551  22]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.366 0.634]]
Validation f1: 58.43
Validation accuracy: 93.97
Validation recall: 63.41
Validation precision: 54.17
Validation AUC: 0.5884323341245179
Validation class accuracies: [0.9616055846422339, 0.6341463414634146]
The validation tracker metric at 0.6233766233766234 hasn't increased by 0 in 3 epochs
Epoch 20/65
167/167 - 72s - loss: 0.0069 - accuracy: 0.9992 - val_loss: 0.2301 - val_accuracy: 0.9463
Confusion matrix: 
 [[555  18]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.366 0.634]]
Validation f1: 61.18
Validation accuracy: 94.63
Validation recall: 63.41
Validation precision: 59.09
Validation AUC: 0.6084242104463218
Validation class accuracies: [0.9685863874345549, 0.6341463414634146]
The validation tracker metric at 0.6233766233766234 hasn't increased by 0 in 4 epochs
Epoch 21/65
167/167 - 69s - loss: 0.0056 - accuracy: 0.9989 - val_loss: 0.2426 - val_accuracy: 0.9495
Confusion matrix: 
 [[558  15]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.39  0.61 ]]
Validation f1: 61.73
Validation accuracy: 94.95
Validation recall: 60.98
Validation precision: 62.50
Validation AUC: 0.592850230528687
Validation class accuracies: [0.9738219895287958, 0.6097560975609756]
The validation tracker metric at 0.6233766233766234 hasn't increased by 0 in 5 epochs
Epoch 22/65
167/167 - 69s - loss: 0.0051 - accuracy: 1.0000 - val_loss: 0.2342 - val_accuracy: 0.9479
Confusion matrix: 
 [[556  17]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.366 0.634]]
Validation f1: 61.90
Validation accuracy: 94.79
Validation recall: 63.41
Validation precision: 60.47
Validation AUC: 0.6177845813670835
Validation class accuracies: [0.9703315881326352, 0.6341463414634146]
The validation tracker metric at 0.6233766233766234 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
167/167 - 69s - loss: 0.0047 - accuracy: 1.0000 - val_loss: 0.2464 - val_accuracy: 0.9463
Confusion matrix: 
 [[555  18]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.18
Validation accuracy: 94.63
Validation recall: 63.41
Validation precision: 59.09
Validation AUC: 0.6148947517672266
Validation class accuracies: [0.9685863874345549, 0.6341463414634146]
The validation tracker metric at 0.6233766233766234 hasn't increased by 0 in 7 epochs
Epoch 24/65
167/167 - 69s - loss: 0.0060 - accuracy: 0.9996 - val_loss: 0.2591 - val_accuracy: 0.9316
Confusion matrix: 
 [[547  26]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.39  0.61 ]]
Validation f1: 54.35
Validation accuracy: 93.16
Validation recall: 60.98
Validation precision: 49.02
Validation AUC: 0.6000432891535802
Validation class accuracies: [0.9546247818499127, 0.6097560975609756]
The validation tracker metric at 0.6233766233766234 hasn't increased by 0 in 8 epochs
Epoch 25/65
167/167 - 70s - loss: 0.0047 - accuracy: 1.0000 - val_loss: 0.2338 - val_accuracy: 0.9511
Confusion matrix: 
 [[559  14]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.39  0.61 ]]
Validation f1: 62.50
Validation accuracy: 95.11
Validation recall: 60.98
Validation precision: 64.10
Validation AUC: 0.6251289738836392
Validation class accuracies: [0.9755671902268761, 0.6097560975609756]
Saving model...
Epoch 26/65
167/167 - 69s - loss: 0.0067 - accuracy: 1.0000 - val_loss: 0.3000 - val_accuracy: 0.9218
Confusion matrix: 
 [[537  36]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.293 0.707]]
Validation f1: 54.72
Validation accuracy: 92.18
Validation recall: 70.73
Validation precision: 44.62
Validation AUC: 0.6089841704535758
Validation class accuracies: [0.93717277486911, 0.7073170731707317]
The validation tracker metric at 0.625 hasn't increased by 0 in 1 epochs
Epoch 27/65
167/167 - 69s - loss: 0.0040 - accuracy: 0.9996 - val_loss: 0.2564 - val_accuracy: 0.9479
Confusion matrix: 
 [[556  17]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.366 0.634]]
Validation f1: 61.90
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.79
Validation recall: 63.41
Validation precision: 60.47
Validation AUC: 0.6158528433029742
Validation class accuracies: [0.9703315881326352, 0.6341463414634146]
The validation tracker metric at 0.625 hasn't increased by 0 in 2 epochs
Epoch 28/65
167/167 - 69s - loss: 0.0046 - accuracy: 0.9992 - val_loss: 0.2520 - val_accuracy: 0.9414
Confusion matrix: 
 [[553  20]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.39  0.61 ]]
Validation f1: 58.14
Validation accuracy: 94.14
Validation recall: 60.98
Validation precision: 55.56
Validation AUC: 0.6225935997365054
Validation class accuracies: [0.9650959860383944, 0.6097560975609756]
The validation tracker metric at 0.625 hasn't increased by 0 in 3 epochs
Epoch 29/65
167/167 - 69s - loss: 0.0030 - accuracy: 1.0000 - val_loss: 0.2398 - val_accuracy: 0.9479
Confusion matrix: 
 [[558  15]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.415 0.585]]
Validation f1: 60.00
Validation accuracy: 94.79
Validation recall: 58.54
Validation precision: 61.54
Validation AUC: 0.6248422588721945
Validation class accuracies: [0.9738219895287958, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 4 epochs
Epoch 30/65
167/167 - 71s - loss: 0.0039 - accuracy: 0.9992 - val_loss: 0.2505 - val_accuracy: 0.9479
Confusion matrix: 
 [[557  16]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.98
Validation accuracy: 94.79
Validation recall: 60.98
Validation precision: 60.98
Validation AUC: 0.6116788670367495
Validation class accuracies: [0.9720767888307156, 0.6097560975609756]
The validation tracker metric at 0.625 hasn't increased by 0 in 5 epochs
Epoch 31/65
167/167 - 69s - loss: 0.0069 - accuracy: 0.9996 - val_loss: 0.2672 - val_accuracy: 0.9430
Confusion matrix: 
 [[553  20]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.366 0.634]]
Validation f1: 59.77
Validation accuracy: 94.30
Validation recall: 63.41
Validation precision: 56.52
Validation AUC: 0.6243698344258621
Validation class accuracies: [0.9650959860383944, 0.6341463414634146]
The validation tracker metric at 0.625 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 32/65
167/167 - 69s - loss: 0.0039 - accuracy: 0.9996 - val_loss: 0.2552 - val_accuracy: 0.9446
Confusion matrix: 
 [[554  19]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.366 0.634]]
Validation f1: 60.47
Validation accuracy: 94.46
Validation recall: 63.41
Validation precision: 57.78
Validation AUC: 0.6295817755363111
Validation class accuracies: [0.9668411867364747, 0.6341463414634146]
The validation tracker metric at 0.625 hasn't increased by 0 in 7 epochs
Epoch 33/65
167/167 - 69s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2462 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
Validation f1: 58.54
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6298420764173229
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 8 epochs
Epoch 34/65
167/167 - 69s - loss: 0.0029 - accuracy: 1.0000 - val_loss: 0.2394 - val_accuracy: 0.9479
Confusion matrix: 
 [[558  15]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.415 0.585]]
Validation f1: 60.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.79
Validation recall: 58.54
Validation precision: 61.54
Validation AUC: 0.6279223962304492
Validation class accuracies: [0.9738219895287958, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 9 epochs
Epoch 35/65
167/167 - 70s - loss: 0.0055 - accuracy: 0.9992 - val_loss: 0.2419 - val_accuracy: 0.9463
Confusion matrix: 
 [[556  17]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97 0.03]
 [0.39 0.61]]
Validation f1: 60.24
Validation accuracy: 94.63
Validation recall: 60.98
Validation precision: 59.52
Validation AUC: 0.6406927496838474
Validation class accuracies: [0.9703315881326352, 0.6097560975609756]
The validation tracker metric at 0.625 hasn't increased by 0 in 10 epochs
Epoch 36/65
167/167 - 69s - loss: 0.0026 - accuracy: 0.9996 - val_loss: 0.2443 - val_accuracy: 0.9463
Confusion matrix: 
 [[556  17]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.97 0.03]
 [0.39 0.61]]
Validation f1: 60.24
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.63
Validation recall: 60.98
Validation precision: 59.52
Validation AUC: 0.6414994213528877
Validation class accuracies: [0.9703315881326352, 0.6097560975609756]
The validation tracker metric at 0.625 hasn't increased by 0 in 11 epochs
Epoch 37/65
167/167 - 70s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.2405 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.54
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6406026435138586
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 38/65
167/167 - 69s - loss: 0.0039 - accuracy: 1.0000 - val_loss: 0.2486 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.54
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6289677216323728
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 13 epochs
Epoch 39/65
167/167 - 69s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.2466 - val_accuracy: 0.9463
Confusion matrix: 
 [[557  16]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.415 0.585]]
Validation f1: 59.26
Validation accuracy: 94.63
Validation recall: 58.54
Validation precision: 60.00
Validation AUC: 0.6315110867396667
Validation class accuracies: [0.9720767888307156, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 14 epochs
Epoch 40/65
167/167 - 71s - loss: 0.0032 - accuracy: 0.9996 - val_loss: 0.2498 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.54
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6328108407440091
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 15 epochs
Epoch 41/65
167/167 - 69s - loss: 0.0023 - accuracy: 1.0000 - val_loss: 0.2532 - val_accuracy: 0.9430
Confusion matrix: 
 [[555  18]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.415 0.585]]
Validation f1: 57.83
Validation accuracy: 94.30
Validation recall: 58.54
Validation precision: 57.14
Validation AUC: 0.6316943347150047
Validation class accuracies: [0.9685863874345549, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 16 epochs
Epoch 42/65
167/167 - 69s - loss: 0.0019 - accuracy: 1.0000 - val_loss: 0.2489 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.54
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6343172969415934
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 17 epochs
Epoch 43/65
167/167 - 69s - loss: 0.0026 - accuracy: 1.0000 - val_loss: 0.2502 - val_accuracy: 0.9463
Confusion matrix: 
 [[556  17]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97 0.03]
 [0.39 0.61]]
Validation f1: 60.24
Validation accuracy: 94.63
Validation recall: 60.98
Validation precision: 59.52
Validation AUC: 0.6379402151047346
Validation class accuracies: [0.9703315881326352, 0.6097560975609756]
The validation tracker metric at 0.625 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 44/65
167/167 - 71s - loss: 0.0029 - accuracy: 0.9992 - val_loss: 0.2478 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
Validation f1: 58.54
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6361159421992906
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]
The validation tracker metric at 0.625 hasn't increased by 0 in 19 epochs
Epoch 45/65
167/167 - 69s - loss: 0.0021 - accuracy: 1.0000 - val_loss: 0.2493 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
Validation f1: 58.54
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6350958656840672
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]

The metrics for job 0 with the best target metric are: 
Best cm: [[559  14]
 [ 16  25]]
Best normalized cm: [[0.976 0.024]
 [0.39  0.61 ]]
Best f1: 0.62
Best accuracy: 0.95
Best recall: 0.61
Best precision: 0.64
Best AUC: 0.63
Best class accuracies: [0.9755671902268761, 0.6097560975609756]
Best epoch: 25
The number of epochs since last 1% equals the patience
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.118]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.059]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[7.584e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[7.137e-07]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[9.133e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.051]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.239]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[4.061e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[1.505e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.045]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[3.056e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[3.675e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.036]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[9.087e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[1.886e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[5.193e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[5.639e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[8.063e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.241]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.021]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 20583
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_213602-l9gfgdcn/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_213602-l9gfgdcn/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.94463
wandb:             _runtime 3647
wandb:           _timestamp 1624487809
wandb:                _step 332
wandb:           train_loss 0.00211
wandb:             val_loss 0.24928
wandb:           val_recall 0.58537
wandb:        val_precision 0.58537
wandb:               val_f1 0.58537
wandb:              val_auc 0.6351
wandb:                   lr 3e-05
wandb:          best_val_f1 0.625
wandb:    best_val_accuracy 0.95114
wandb:   best_val_precision 0.64103
wandb:      best_val_recall 0.60976
wandb:             best_auc 0.62513
wandb:           best_epoch 25
wandb: Run history:
wandb:   train_accuracy ▁▄▆▇▇▇██████████████████████████████████
wandb:     val_accuracy ▁▆▇▅▇█▇▇██▇█████████████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▃▃▂▂▁▂▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▅▅▄█▂▁▄▄▁▂▃▂▂▂▁▁▁▁▁▁▁▁▁▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall █▁▄▆▅▅▇▆▅▆▄▆▅▅▄▅▅▅▅▅▅▅▅▅▅▄▅▅▅▄▄▅▄▄▄▄▄▄▅▄
wandb:    val_precision ▁▁▃▁▃▇▃▃▆▅▄▅▆▅█▇▇▇█▇▇▆█▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_f1 ▁▁▄▂▅█▅▅▇▇▅▆▇▇██▇████▇█▇▇████▇██▇▇█▇▇▇█▇
wandb:          val_auc ▁▁▅▆▆█▇▇██▆▇▇▇▇▇▇▇▇██▇█▇████████████████
wandb:               lr ███████████▄▄▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_213602-l9gfgdcn

-----------------------
Changing augmentation to v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate_55350 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_55350[0][0]              
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
167/167 - 240s - loss: 1.1908 - accuracy: 0.6422 - val_loss: 0.3781 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06329688190196492
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
167/167 - 238s - loss: 0.5080 - accuracy: 0.7457 - val_loss: 0.3976 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06921301296514697
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
167/167 - 238s - loss: 0.4164 - accuracy: 0.8005 - val_loss: 0.2996 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09451264178126817
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
167/167 - 238s - loss: 0.3110 - accuracy: 0.8481 - val_loss: 0.4298 - val_accuracy: 0.7671
Confusion matrix: 
 [[446 127]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.778 0.222]
 [0.39  0.61 ]]
Validation f1: 25.91
Validation accuracy: 76.71
Validation recall: 60.98
Validation precision: 16.45
Validation AUC: 0.3815997407671777
Validation class accuracies: [0.7783595113438045, 0.6097560975609756]
Saving model...
Epoch 5/65
167/167 - 238s - loss: 0.2931 - accuracy: 0.8766 - val_loss: 0.5402 - val_accuracy: 0.8355
Confusion matrix: 
 [[504  69]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88 0.12]
 [0.78 0.22]]
Validation f1: 15.13
Validation accuracy: 83.55
Validation recall: 21.95
Validation precision: 11.54
Validation AUC: 0.10633525151316375
Validation class accuracies: [0.8795811518324608, 0.21951219512195122]
The validation tracker metric at 0.25906735751295334 hasn't increased by 0 in 1 epochs
Epoch 6/65
167/167 - 238s - loss: 0.2544 - accuracy: 0.8732 - val_loss: 0.3367 - val_accuracy: 0.9235
Confusion matrix: 
 [[567   6]
 [ 41   0]]
Normalized Confusion matrix: 
 [[0.99 0.01]
 [1.   0.  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 0.00
Validation accuracy: 92.35
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.13030304721093985
Validation class accuracies: [0.9895287958115183, 0.0]
The validation tracker metric at 0.25906735751295334 hasn't increased by 0 in 2 epochs
Epoch 7/65
167/167 - 238s - loss: 0.2112 - accuracy: 0.9062 - val_loss: 0.6098 - val_accuracy: 0.8388
Confusion matrix: 
 [[494  79]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.488 0.512]]
Validation f1: 29.79
Validation accuracy: 83.88
Validation recall: 51.22
Validation precision: 21.00
Validation AUC: 0.39920015208029347
Validation class accuracies: [0.8621291448516579, 0.5121951219512195]
Saving model...
Epoch 8/65
167/167 - 238s - loss: 0.2223 - accuracy: 0.9122 - val_loss: 2.7521 - val_accuracy: 0.4886
Confusion matrix: 
 [[283 290]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.494 0.506]
 [0.585 0.415]]
Validation f1: 9.77
Validation accuracy: 48.86
Validation recall: 41.46
Validation precision: 5.54
Validation AUC: 0.05172805918305648
Validation class accuracies: [0.493891797556719, 0.4146341463414634]
The validation tracker metric at 0.2978723404255319 hasn't increased by 0 in 1 epochs
Epoch 9/65
167/167 - 239s - loss: 0.2357 - accuracy: 0.8912 - val_loss: 0.9144 - val_accuracy: 0.7345
Confusion matrix: 
 [[427 146]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.745 0.255]
 [0.415 0.585]]
Validation f1: 22.75
Validation accuracy: 73.45
Validation recall: 58.54
Validation precision: 14.12
Validation AUC: 0.2706053992727211
Validation class accuracies: [0.7452006980802792, 0.5853658536585366]
The validation tracker metric at 0.2978723404255319 hasn't increased by 0 in 2 epochs
Epoch 10/65
167/167 - 238s - loss: 0.1768 - accuracy: 0.9186 - val_loss: 0.7274 - val_accuracy: 0.9316
Confusion matrix: 
 [[567   6]
 [ 36   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.878 0.122]]
Validation f1: 19.23
Validation accuracy: 93.16
Validation recall: 12.20
Validation precision: 45.45
Validation AUC: 0.2519595170633336
Validation class accuracies: [0.9895287958115183, 0.12195121951219512]
The validation tracker metric at 0.2978723404255319 hasn't increased by 0 in 3 epochs
Epoch 11/65
167/167 - 238s - loss: 0.1744 - accuracy: 0.9186 - val_loss: 0.5529 - val_accuracy: 0.8111
Confusion matrix: 
 [[475  98]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.439 0.561]]
Validation f1: 28.40
Validation accuracy: 81.11
Validation recall: 56.10
Validation precision: 19.01
Validation AUC: 0.19364893247733594
Validation class accuracies: [0.8289703315881326, 0.5609756097560976]
The validation tracker metric at 0.2978723404255319 hasn't increased by 0 in 4 epochs
Epoch 12/65
167/167 - 238s - loss: 0.1545 - accuracy: 0.9242 - val_loss: 0.2967 - val_accuracy: 0.8860
Confusion matrix: 
 [[526  47]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.561 0.439]]
Validation f1: 33.96
Validation accuracy: 88.60
Validation recall: 43.90
Validation precision: 27.69
Validation AUC: 0.362343216545834
Validation class accuracies: [0.9179755671902269, 0.43902439024390244]
Saving model...
Epoch 13/65
167/167 - 238s - loss: 0.1283 - accuracy: 0.9370 - val_loss: 0.3262 - val_accuracy: 0.9267
Confusion matrix: 
 [[568   5]
 [ 40   1]]
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.976 0.024]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 4.26
Validation accuracy: 92.67
Validation recall: 2.44
Validation precision: 16.67
Validation AUC: 0.29227606970767706
Validation class accuracies: [0.9912739965095986, 0.024390243902439025]
The validation tracker metric at 0.33962264150943394 hasn't increased by 0 in 1 epochs
Epoch 14/65
167/167 - 238s - loss: 0.1244 - accuracy: 0.9404 - val_loss: 0.3275 - val_accuracy: 0.9283
Confusion matrix: 
 [[567   6]
 [ 38   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.927 0.073]]
Validation f1: 12.00
Validation accuracy: 92.83
Validation recall: 7.32
Validation precision: 33.33
Validation AUC: 0.29739595200733027
Validation class accuracies: [0.9895287958115183, 0.07317073170731707]
The validation tracker metric at 0.33962264150943394 hasn't increased by 0 in 2 epochs
Epoch 15/65
167/167 - 238s - loss: 0.1024 - accuracy: 0.9576 - val_loss: 1.3797 - val_accuracy: 0.6482
Confusion matrix: 
 [[378 195]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.66  0.34 ]
 [0.512 0.488]]
Validation f1: 15.62
Validation accuracy: 64.82
Validation recall: 48.78
Validation precision: 9.30
Validation AUC: 0.17152036560574305
Validation class accuracies: [0.6596858638743456, 0.4878048780487805]
The validation tracker metric at 0.33962264150943394 hasn't increased by 0 in 3 epochs
Epoch 16/65
167/167 - 238s - loss: 0.0885 - accuracy: 0.9565 - val_loss: 0.2989 - val_accuracy: 0.8974
Confusion matrix: 
 [[532  41]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.537 0.463]]
Validation f1: 37.62
Validation accuracy: 89.74
Validation recall: 46.34
Validation precision: 31.67
Validation AUC: 0.26306458075363703
Validation class accuracies: [0.9284467713787086, 0.4634146341463415]
Saving model...
Epoch 17/65
167/167 - 238s - loss: 0.1209 - accuracy: 0.9471 - val_loss: 0.3093 - val_accuracy: 0.8974
Confusion matrix: 
 [[536  37]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.634 0.366]]
Validation f1: 32.26
Validation accuracy: 89.74
Validation recall: 36.59
Validation precision: 28.85
Validation AUC: 0.282782256373309
Validation class accuracies: [0.9354275741710296, 0.36585365853658536]
The validation tracker metric at 0.3762376237623763 hasn't increased by 0 in 1 epochs
Epoch 18/65
167/167 - 238s - loss: 0.0785 - accuracy: 0.9595 - val_loss: 0.2847 - val_accuracy: 0.8941
Confusion matrix: 
 [[525  48]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.415 0.585]]
Validation f1: 42.48
Validation accuracy: 89.41
Validation recall: 58.54
Validation precision: 33.33
Validation AUC: 0.40461671221732604
Validation class accuracies: [0.9162303664921466, 0.5853658536585366]
Saving model...
Epoch 19/65
167/167 - 238s - loss: 0.0823 - accuracy: 0.9655 - val_loss: 0.4334 - val_accuracy: 0.9023
Confusion matrix: 
 [[547  26]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.829 0.171]]
Validation f1: 18.92
Validation accuracy: 90.23
Validation recall: 17.07
Validation precision: 21.21
Validation AUC: 0.15910461657978664
Validation class accuracies: [0.9546247818499127, 0.17073170731707318]
The validation tracker metric at 0.42477876106194684 hasn't increased by 0 in 1 epochs
Epoch 20/65
167/167 - 238s - loss: 0.1179 - accuracy: 0.9471 - val_loss: 0.4489 - val_accuracy: 0.9267
Confusion matrix: 
 [[569   4]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 92.67
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2724770803842015
Validation class accuracies: [0.9930191972076788, 0.0]
The validation tracker metric at 0.42477876106194684 hasn't increased by 0 in 2 epochs
Epoch 21/65
167/167 - 238s - loss: 0.0764 - accuracy: 0.9640 - val_loss: 0.8135 - val_accuracy: 0.8974
Confusion matrix: 
 [[551  22]
 [ 41   0]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [1.    0.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 0.00
Validation accuracy: 89.74
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06988340342917973
Validation class accuracies: [0.9616055846422339, 0.0]
The validation tracker metric at 0.42477876106194684 hasn't increased by 0 in 3 epochs
Epoch 22/65
167/167 - 238s - loss: 0.0408 - accuracy: 0.9820 - val_loss: 0.8263 - val_accuracy: 0.7443
Confusion matrix: 
 [[443 130]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.659 0.341]]
Validation f1: 15.14
Validation accuracy: 74.43
Validation recall: 34.15
Validation precision: 9.72
Validation AUC: 0.1075779909165297
Validation class accuracies: [0.7731239092495636, 0.34146341463414637]
The validation tracker metric at 0.42477876106194684 hasn't increased by 0 in 4 epochs
Epoch 23/65
167/167 - 239s - loss: 0.0439 - accuracy: 0.9801 - val_loss: 0.3666 - val_accuracy: 0.9055
Confusion matrix: 
 [[540  33]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.61  0.39 ]]
Validation f1: 35.56
Validation accuracy: 90.55
Validation recall: 39.02
Validation precision: 32.65
Validation AUC: 0.2630764416799445
Validation class accuracies: [0.9424083769633508, 0.3902439024390244]
The validation tracker metric at 0.42477876106194684 hasn't increased by 0 in 5 epochs
Epoch 24/65
167/167 - 238s - loss: 0.0646 - accuracy: 0.9737 - val_loss: 0.2939 - val_accuracy: 0.9283
Confusion matrix: 
 [[555  18]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.634 0.366]]
Validation f1: 40.54
Validation accuracy: 92.83
Validation recall: 36.59
Validation precision: 45.45
Validation AUC: 0.3527843788988791
Validation class accuracies: [0.9685863874345549, 0.36585365853658536]
The validation tracker metric at 0.42477876106194684 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 25/65
167/167 - 238s - loss: 0.0330 - accuracy: 0.9842 - val_loss: 0.2340 - val_accuracy: 0.9316
Confusion matrix: 
 [[554  19]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.561 0.439]]
Validation f1: 46.15
Validation accuracy: 93.16
Validation recall: 43.90
Validation precision: 48.65
Validation AUC: 0.4786618329904247
Validation class accuracies: [0.9668411867364747, 0.43902439024390244]
Saving model...
Epoch 26/65
167/167 - 238s - loss: 0.0240 - accuracy: 0.9899 - val_loss: 0.2342 - val_accuracy: 0.9332
Confusion matrix: 
 [[560  13]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.683 0.317]]
Validation f1: 38.81
Validation accuracy: 93.32
Validation recall: 31.71
Validation precision: 50.00
Validation AUC: 0.4049819976965277
Validation class accuracies: [0.9773123909249564, 0.3170731707317073]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 1 epochs
Epoch 27/65
167/167 - 238s - loss: 0.0259 - accuracy: 0.9895 - val_loss: 0.2513 - val_accuracy: 0.9235
Confusion matrix: 
 [[552  21]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.634 0.366]]
Validation f1: 38.96
Validation accuracy: 92.35
Validation recall: 36.59
Validation precision: 41.67
Validation AUC: 0.3438950724062474
Validation class accuracies: [0.9633507853403142, 0.36585365853658536]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 2 epochs
Epoch 28/65
167/167 - 238s - loss: 0.0372 - accuracy: 0.9839 - val_loss: 0.2535 - val_accuracy: 0.9202
Confusion matrix: 
 [[548  25]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.585 0.415]]
Validation f1: 40.96
Validation accuracy: 92.02
Validation recall: 41.46
Validation precision: 40.48
Validation AUC: 0.40364073795402
Validation class accuracies: [0.956369982547993, 0.4146341463414634]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 3 epochs
Epoch 29/65
167/167 - 238s - loss: 0.0333 - accuracy: 0.9880 - val_loss: 0.2786 - val_accuracy: 0.9300
Confusion matrix: 
 [[552  21]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.537 0.463]]
Validation f1: 46.91
Validation accuracy: 93.00
Validation recall: 46.34
Validation precision: 47.50
Validation AUC: 0.4972699810541515
Validation class accuracies: [0.9633507853403142, 0.4634146341463415]
Saving model...
Epoch 30/65
167/167 - 238s - loss: 0.0158 - accuracy: 0.9910 - val_loss: 0.2400 - val_accuracy: 0.9332
Confusion matrix: 
 [[553  20]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.512 0.488]]
Validation f1: 49.38
Validation accuracy: 93.32
Validation recall: 48.78
Validation precision: 50.00
Validation AUC: 0.42352160226856606
Validation class accuracies: [0.9650959860383944, 0.4878048780487805]
Saving model...
Epoch 31/65
167/167 - 238s - loss: 0.0130 - accuracy: 0.9955 - val_loss: 0.3092 - val_accuracy: 0.9153
Confusion matrix: 
 [[541  32]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.488 0.512]]
Validation f1: 44.68
Validation accuracy: 91.53
Validation recall: 51.22
Validation precision: 39.62
Validation AUC: 0.47514348660537736
Validation class accuracies: [0.944153577661431, 0.5121951219512195]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 1 epochs
Epoch 32/65
167/167 - 238s - loss: 0.0146 - accuracy: 0.9944 - val_loss: 0.6963 - val_accuracy: 0.8078
Confusion matrix: 
 [[471 102]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.39  0.61 ]]
Validation f1: 29.76
Validation accuracy: 80.78
Validation recall: 60.98
Validation precision: 19.69
Validation AUC: 0.266204461292121
Validation class accuracies: [0.8219895287958116, 0.6097560975609756]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 2 epochs
Epoch 33/65
167/167 - 238s - loss: 0.0275 - accuracy: 0.9891 - val_loss: 0.7489 - val_accuracy: 0.8420
Confusion matrix: 
 [[503  70]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.878 0.122]
 [0.659 0.341]]
Validation f1: 22.40
Validation accuracy: 84.20
Validation recall: 34.15
Validation precision: 16.67
Validation AUC: 0.21348477200751365
Validation class accuracies: [0.8778359511343804, 0.34146341463414637]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 3 epochs
Epoch 34/65
167/167 - 239s - loss: 0.0140 - accuracy: 0.9951 - val_loss: 0.2877 - val_accuracy: 0.9300
Confusion matrix: 
 [[564   9]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.829 0.171]]
Validation f1: 24.56
Validation accuracy: 93.00
Validation recall: 17.07
Validation precision: 43.75
Validation AUC: 0.343899000074006
Validation class accuracies: [0.9842931937172775, 0.17073170731707318]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 4 epochs
Epoch 35/65
167/167 - 238s - loss: 0.0123 - accuracy: 0.9944 - val_loss: 0.2814 - val_accuracy: 0.9316
Confusion matrix: 
 [[561  12]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.38
Validation accuracy: 93.16
Validation recall: 26.83
Validation precision: 47.83
Validation AUC: 0.33169926475068234
Validation class accuracies: [0.9790575916230366, 0.2682926829268293]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 5 epochs
Epoch 36/65
167/167 - 238s - loss: 0.0181 - accuracy: 0.9921 - val_loss: 0.2541 - val_accuracy: 0.9235
Confusion matrix: 
 [[550  23]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.585 0.415]]
Validation f1: 41.98
Validation accuracy: 92.35
Validation recall: 41.46
Validation precision: 42.50
Validation AUC: 0.3826969258337159
Validation class accuracies: [0.9598603839441536, 0.4146341463414634]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 37/65
167/167 - 238s - loss: 0.0089 - accuracy: 0.9974 - val_loss: 0.2977 - val_accuracy: 0.9235
Confusion matrix: 
 [[551  22]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.61  0.39 ]]
Validation f1: 40.51
Validation accuracy: 92.35
Validation recall: 39.02
Validation precision: 42.11
Validation AUC: 0.3275047488960827
Validation class accuracies: [0.9616055846422339, 0.3902439024390244]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 7 epochs
Epoch 38/65
167/167 - 238s - loss: 0.0073 - accuracy: 0.9977 - val_loss: 0.2982 - val_accuracy: 0.9267
Confusion matrix: 
 [[558  15]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.732 0.268]]
Validation f1: 32.84
Validation accuracy: 92.67
Validation recall: 26.83
Validation precision: 42.31
Validation AUC: 0.31582595136421987
Validation class accuracies: [0.9738219895287958, 0.2682926829268293]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 8 epochs
Epoch 39/65
167/167 - 238s - loss: 0.0075 - accuracy: 0.9977 - val_loss: 0.2625 - val_accuracy: 0.9349
Confusion matrix: 
 [[562  11]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.707 0.293]]
Validation f1: 37.50
Validation accuracy: 93.49
Validation recall: 29.27
Validation precision: 52.17
Validation AUC: 0.4232251564276558
Validation class accuracies: [0.9808027923211169, 0.2926829268292683]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 9 epochs
Epoch 40/65
167/167 - 238s - loss: 0.0052 - accuracy: 0.9996 - val_loss: 0.2733 - val_accuracy: 0.9316
Confusion matrix: 
 [[558  15]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.659 0.341]]
Validation f1: 40.00
Validation accuracy: 93.16
Validation recall: 34.15
Validation precision: 48.28
Validation AUC: 0.39845124694635325
Validation class accuracies: [0.9738219895287958, 0.34146341463414637]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 10 epochs
Epoch 41/65
167/167 - 238s - loss: 0.0154 - accuracy: 0.9947 - val_loss: 0.2763 - val_accuracy: 0.9414
Confusion matrix: 
 [[563  10]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.634 0.366]]
Validation f1: 45.45
Validation accuracy: 94.14
Validation recall: 36.59
Validation precision: 60.00
Validation AUC: 0.46977711357672053
Validation class accuracies: [0.9825479930191972, 0.36585365853658536]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 11 epochs
Epoch 42/65
167/167 - 238s - loss: 0.0121 - accuracy: 0.9959 - val_loss: 0.3083 - val_accuracy: 0.9414
Confusion matrix: 
 [[566   7]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.707 0.293]]
Validation f1: 40.00
Validation accuracy: 94.14
Validation recall: 29.27
Validation precision: 63.16
Validation AUC: 0.38031854762460443
Validation class accuracies: [0.987783595113438, 0.2926829268292683]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 43/65
167/167 - 238s - loss: 0.0146 - accuracy: 0.9947 - val_loss: 0.3432 - val_accuracy: 0.9218
Confusion matrix: 
 [[553  20]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.683 0.317]]
Validation f1: 35.14
Validation accuracy: 92.18
Validation recall: 31.71
Validation precision: 39.39
Validation AUC: 0.2760739943255041
Validation class accuracies: [0.9650959860383944, 0.3170731707317073]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 13 epochs
Epoch 44/65
167/167 - 238s - loss: 0.0069 - accuracy: 0.9974 - val_loss: 0.3121 - val_accuracy: 0.9202
Confusion matrix: 
 [[547  26]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.561 0.439]]
Validation f1: 42.35
Validation accuracy: 92.02
Validation recall: 43.90
Validation precision: 40.91
Validation AUC: 0.32964243625777456
Validation class accuracies: [0.9546247818499127, 0.43902439024390244]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 14 epochs
Epoch 45/65
167/167 - 238s - loss: 0.0054 - accuracy: 0.9981 - val_loss: 0.2920 - val_accuracy: 0.9267
Confusion matrix: 
 [[553  20]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.61  0.39 ]]
Validation f1: 41.56
Validation accuracy: 92.67
Validation recall: 39.02
Validation precision: 44.44
Validation AUC: 0.33409500629655586
Validation class accuracies: [0.9650959860383944, 0.3902439024390244]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 15 epochs
Epoch 46/65
167/167 - 238s - loss: 0.0040 - accuracy: 0.9989 - val_loss: 0.3051 - val_accuracy: 0.9267
Confusion matrix: 
 [[554  19]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.634 0.366]]
Validation f1: 40.00
Validation accuracy: 92.67
Validation recall: 36.59
Validation precision: 44.12
Validation AUC: 0.3065350295012696
Validation class accuracies: [0.9668411867364747, 0.36585365853658536]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 16 epochs
Epoch 47/65
167/167 - 238s - loss: 0.0029 - accuracy: 1.0000 - val_loss: 0.2939 - val_accuracy: 0.9283
Confusion matrix: 
 [[557  16]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.683 0.317]]
Validation f1: 37.14
Validation accuracy: 92.83
Validation recall: 31.71
Validation precision: 44.83
Validation AUC: 0.32358666727055263
Validation class accuracies: [0.9720767888307156, 0.3170731707317073]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 17 epochs
Epoch 48/65
167/167 - 240s - loss: 0.0027 - accuracy: 0.9996 - val_loss: 0.3080 - val_accuracy: 0.9267
Confusion matrix: 
 [[560  13]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.78  0.22 ]]
Validation f1: 28.57
Validation accuracy: 92.67
Validation recall: 21.95
Validation precision: 40.91
Validation AUC: 0.30131661905172
Validation class accuracies: [0.9773123909249564, 0.21951219512195122]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 49/65
167/167 - 238s - loss: 0.0051 - accuracy: 0.9989 - val_loss: 0.3087 - val_accuracy: 0.9283
Confusion matrix: 
 [[553  20]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.585 0.415]]
Validation f1: 43.59
Validation accuracy: 92.83
Validation recall: 41.46
Validation precision: 45.95
Validation AUC: 0.31106594167875934
Validation class accuracies: [0.9650959860383944, 0.4146341463414634]
The validation tracker metric at 0.49382716049382713 hasn't increased by 0 in 19 epochs
Epoch 50/65
167/167 - 238s - loss: 0.0032 - accuracy: 0.9989 - val_loss: 0.2959 - val_accuracy: 0.9316
Confusion matrix: 
 [[558  15]
 [ 27  14]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.659 0.341]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.00
Validation accuracy: 93.16
Validation recall: 34.15
Validation precision: 48.28
Validation AUC: 0.3333567474957327
Validation class accuracies: [0.9738219895287958, 0.34146341463414637]

The metrics for job 1 with the best target metric are: 
Best cm: [[553  20]
 [ 21  20]]
Best normalized cm: [[0.965 0.035]
 [0.512 0.488]]
Best f1: 0.49
Best accuracy: 0.93
Best recall: 0.49
Best precision: 0.50
Best AUC: 0.42
Best class accuracies: [0.9650959860383944, 0.4878048780487805]
Best epoch: 30
The number of epochs since last 1% equals the patience
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_207_2b4_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[8.88e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1b1_Pl_sc_Meditron_7_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1b1_Pl_sc_Meditron_6_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Lr_sc_Meditron_4_label_0_pred_1.png, [[0.509]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[8.565e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_203_2p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[1.816e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[2.503e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_226_1b1_Al_sc_Meditron_1_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_1.png, [[0.617]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_211_1p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_0.png, [[0.023]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_4b2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_203_2p3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_204_2b5_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_3b4_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[1.302e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[3.55e-07]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_207_2b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[1.127e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[3.206e-07]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[4.404e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_221_2b2_Pl_mc_LittC2SE_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_221_2b1_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1p1_Ar_sc_Litt3200_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_211_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[8.585e-07]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[3.989e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_223_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_207_2b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[9.813e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_3_label_1_pred_0.png, [[0.136]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_219_2b2_Ar_mc_LittC2SE_2_label_1_pred_1.png, [[0.534]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_204_7p5_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[5.405e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[8.861e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[1.024e-07]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_203_2p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[7.239e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[4.404e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_221_2b3_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[6.075e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_207_2b4_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[2.18e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP36_pneumonia,Crep,P R M,36,F_5_label_1_pred_1.png, [[0.589]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_2b3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[1.258e-05]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 6169
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_223732-b673e08b/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_223732-b673e08b/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99887
wandb:         val_accuracy 0.9316
wandb:             _runtime 12631
wandb:           _timestamp 1624500483
wandb:                _step 373
wandb:           train_loss 0.00322
wandb:             val_loss 0.29585
wandb:           val_recall 0.34146
wandb:        val_precision 0.48276
wandb:               val_f1 0.4
wandb:              val_auc 0.33336
wandb:                   lr 6e-05
wandb:          best_val_f1 0.49383
wandb:    best_val_accuracy 0.93322
wandb:   best_val_precision 0.5
wandb:      best_val_recall 0.4878
wandb:             best_auc 0.42352
wandb:           best_epoch 30
wandb: Run history:
wandb:   train_accuracy ▁▃▄▅▆▆▆▆▆▇▇▇▇▇▇▇▇██▇████████████████████
wandb:     val_accuracy ███▅█▆▁▅▆▇██▇▇▇▇▇▅▇██████▆▆█████████████
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▂▁▂█▃▂▁▁▁▁▁▁▂▃▃▁▁▁▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▁▁█▁▇▆█▇▆▁▂▆▅█▃▁▅▅▅▅▅▆▆▇█▅▃▆▅▄▄▅▄▅▆▅▅▄▅
wandb:    val_precision ▁▁▁▃▁▃▂▃▃▄▃▅▅▄▅▃▁▂▅▆▇▆▅▆▅▃▃▆▆▆▆▇██▅▆▆▆▆▆
wandb:           val_f1 ▁▁▁▅▁▅▂▄▅▆▂▃▇▆▇▄▁▃▆▇▇▇▇██▅▄▅▇▇▆▇█▇▆▇▇▇▅▇
wandb:          val_auc ▁▁▂▆▂▆▁▄▃▆▅▅▄▅▇▃▁▂▄▆▇▆▇██▄▄▆▆▅▅▇█▆▅▅▅▅▅▅
wandb:               lr ████████████████████▄▄▄▄▄▄▄▄▄▂▂▂▂▂▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_223732-b673e08b

-----------------------
Changing augmentation to v48
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v48'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 128, 1250, 1)    4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_55351 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 64, 625, 48)     0            concatenate_55351[0][0]              
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 64, 625, 48)     0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 64, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 32, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 16, 156, 128)    91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 8, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 4, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               513          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
167/167 - 239s - loss: 1.0871 - accuracy: 0.5698 - val_loss: 0.5044 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.10599788183230013
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
167/167 - 237s - loss: 0.4767 - accuracy: 0.7588 - val_loss: 0.2614 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06836275687143806
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
167/167 - 237s - loss: 0.3627 - accuracy: 0.8383 - val_loss: 0.2601 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06024384080450808
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
167/167 - 237s - loss: 0.2937 - accuracy: 0.8515 - val_loss: 0.3129 - val_accuracy: 0.8827
Confusion matrix: 
 [[531  42]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.732 0.268]]
Validation f1: 23.40
Validation accuracy: 88.27
Validation recall: 26.83
Validation precision: 20.75
Validation AUC: 0.20460651737436703
Validation class accuracies: [0.9267015706806283, 0.2682926829268293]
Saving model...
Epoch 5/65
167/167 - 237s - loss: 0.3362 - accuracy: 0.8578 - val_loss: 3.6032 - val_accuracy: 0.6091
Confusion matrix: 
 [[350 223]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.611 0.389]
 [0.415 0.585]]
Validation f1: 16.67
Validation accuracy: 60.91
Validation recall: 58.54
Validation precision: 9.72
Validation AUC: 0.2551746928742518
Validation class accuracies: [0.6108202443280978, 0.5853658536585366]
The validation tracker metric at 0.23404255319148937 hasn't increased by 0 in 1 epochs
Epoch 6/65
167/167 - 237s - loss: 0.2891 - accuracy: 0.8605 - val_loss: 1.6181 - val_accuracy: 0.4642
Confusion matrix: 
 [[258 315]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.45  0.55 ]
 [0.341 0.659]]
Validation f1: 14.10
Validation accuracy: 46.42
Validation recall: 65.85
Validation precision: 7.89
Validation AUC: 0.12058312495644377
Validation class accuracies: [0.450261780104712, 0.6585365853658537]
The validation tracker metric at 0.23404255319148937 hasn't increased by 0 in 2 epochs
Epoch 7/65
167/167 - 237s - loss: 0.1891 - accuracy: 0.9149 - val_loss: 0.3551 - val_accuracy: 0.9365
Confusion matrix: 
 [[573   0]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.951 0.049]]
Validation f1: 9.30
Validation accuracy: 93.65
Validation recall: 4.88
Validation precision: 100.00
Validation AUC: 0.13901486023821702
Validation class accuracies: [1.0, 0.04878048780487805]
The validation tracker metric at 0.23404255319148937 hasn't increased by 0 in 3 epochs
Epoch 8/65
167/167 - 237s - loss: 0.2372 - accuracy: 0.8942 - val_loss: 0.3024 - val_accuracy: 0.9055
Confusion matrix: 
 [[551  22]
 [ 36   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.878 0.122]]
Validation f1: 14.71
Validation accuracy: 90.55
Validation recall: 12.20
Validation precision: 18.52
Validation AUC: 0.13219122727956106
Validation class accuracies: [0.9616055846422339, 0.12195121951219512]
The validation tracker metric at 0.23404255319148937 hasn't increased by 0 in 4 epochs
Epoch 9/65
167/167 - 239s - loss: 0.1821 - accuracy: 0.9197 - val_loss: 0.6524 - val_accuracy: 0.7606
Confusion matrix: 
 [[440 133]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.768 0.232]
 [0.341 0.659]]
Validation f1: 26.87
Validation accuracy: 76.06
Validation recall: 65.85
Validation precision: 16.88
Validation AUC: 0.4169089092736492
Validation class accuracies: [0.7678883071553229, 0.6585365853658537]
Saving model...
Epoch 10/65
167/167 - 237s - loss: 0.1469 - accuracy: 0.9366 - val_loss: 0.3104 - val_accuracy: 0.9088
Confusion matrix: 
 [[531  42]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.341 0.659]]
Validation f1: 49.09
Validation accuracy: 90.88
Validation recall: 65.85
Validation precision: 39.13
Validation AUC: 0.5210825184656562
Validation class accuracies: [0.9267015706806283, 0.6585365853658537]
Saving model...
Epoch 11/65
167/167 - 237s - loss: 0.2500 - accuracy: 0.8927 - val_loss: 0.3262 - val_accuracy: 0.9267
Confusion matrix: 
 [[569   4]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 92.67
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16338457667724685
Validation class accuracies: [0.9930191972076788, 0.0]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 1 epochs
Epoch 12/65
167/167 - 237s - loss: 0.1127 - accuracy: 0.9467 - val_loss: 0.4260 - val_accuracy: 0.8355
Confusion matrix: 
 [[487  86]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85  0.15 ]
 [0.366 0.634]]
Validation f1: 33.99
Validation accuracy: 83.55
Validation recall: 63.41
Validation precision: 23.21
Validation AUC: 0.46990849456795375
Validation class accuracies: [0.849912739965096, 0.6341463414634146]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 2 epochs
Epoch 13/65
167/167 - 237s - loss: 0.1066 - accuracy: 0.9497 - val_loss: 0.2747 - val_accuracy: 0.9235
Confusion matrix: 
 [[565   8]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.951 0.049]]
Validation f1: 7.84
Validation accuracy: 92.35
Validation recall: 4.88
Validation precision: 20.00
Validation AUC: 0.18479179695055936
Validation class accuracies: [0.9860383944153578, 0.04878048780487805]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 3 epochs
Epoch 14/65
167/167 - 237s - loss: 0.1086 - accuracy: 0.9554 - val_loss: 2.2109 - val_accuracy: 0.3893
Confusion matrix: 
 [[213 360]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.372 0.628]
 [0.366 0.634]]
Validation f1: 12.18
Validation accuracy: 38.93
Validation recall: 63.41
Validation precision: 6.74
Validation AUC: 0.11302493571607153
Validation class accuracies: [0.3717277486910995, 0.6341463414634146]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 4 epochs
Epoch 15/65
167/167 - 237s - loss: 0.2502 - accuracy: 0.8961 - val_loss: 0.4537 - val_accuracy: 0.8436
Confusion matrix: 
 [[497  76]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.867 0.133]
 [0.488 0.512]]
Validation f1: 30.43
Validation accuracy: 84.36
Validation recall: 51.22
Validation precision: 21.65
Validation AUC: 0.3469419819405008
Validation class accuracies: [0.8673647469458988, 0.5121951219512195]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 5 epochs
Epoch 16/65
167/167 - 237s - loss: 0.0987 - accuracy: 0.9516 - val_loss: 0.2722 - val_accuracy: 0.8909
Confusion matrix: 
 [[523  50]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.74
Validation accuracy: 89.09
Validation recall: 58.54
Validation precision: 32.43
Validation AUC: 0.4896593233217147
Validation class accuracies: [0.912739965095986, 0.5853658536585366]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
167/167 - 237s - loss: 0.0830 - accuracy: 0.9670 - val_loss: 0.4947 - val_accuracy: 0.8208
Confusion matrix: 
 [[491  82]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.857 0.143]
 [0.683 0.317]]
Validation f1: 19.12
Validation accuracy: 82.08
Validation recall: 31.71
Validation precision: 13.68
Validation AUC: 0.15265149576162815
Validation class accuracies: [0.8568935427574171, 0.3170731707317073]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 7 epochs
Epoch 18/65
167/167 - 237s - loss: 0.0848 - accuracy: 0.9599 - val_loss: 0.2950 - val_accuracy: 0.9104
Confusion matrix: 
 [[548  25]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.732 0.268]]
Validation f1: 28.57
Validation accuracy: 91.04
Validation recall: 26.83
Validation precision: 30.56
Validation AUC: 0.22219878887501301
Validation class accuracies: [0.956369982547993, 0.2682926829268293]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 8 epochs
Epoch 19/65
167/167 - 237s - loss: 0.0625 - accuracy: 0.9730 - val_loss: 0.2158 - val_accuracy: 0.9365
Confusion matrix: 
 [[572   1]
 [ 38   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.927 0.073]]
Validation f1: 13.33
Validation accuracy: 93.65
Validation recall: 7.32
Validation precision: 75.00
Validation AUC: 0.4232073777855715
Validation class accuracies: [0.9982547993019197, 0.07317073170731707]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 9 epochs
Epoch 20/65
167/167 - 239s - loss: 0.0443 - accuracy: 0.9812 - val_loss: 0.2167 - val_accuracy: 0.9446
Confusion matrix: 
 [[573   0]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.829 0.171]]
Validation f1: 29.17
Validation accuracy: 94.46
Validation recall: 17.07
Validation precision: 100.00
Validation AUC: 0.5897688882806756
Validation class accuracies: [1.0, 0.17073170731707318]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 10 epochs
Epoch 21/65
167/167 - 237s - loss: 0.0723 - accuracy: 0.9696 - val_loss: 1.1113 - val_accuracy: 0.6906
Confusion matrix: 
 [[401 172]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.7   0.3  ]
 [0.439 0.561]]
Validation f1: 19.49
Validation accuracy: 69.06
Validation recall: 56.10
Validation precision: 11.79
Validation AUC: 0.31045071957891995
Validation class accuracies: [0.699825479930192, 0.5609756097560976]
The validation tracker metric at 0.49090909090909096 hasn't increased by 0 in 11 epochs
Epoch 22/65
167/167 - 237s - loss: 0.0590 - accuracy: 0.9726 - val_loss: 0.2272 - val_accuracy: 0.9218
Confusion matrix: 
 [[541  32]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.02
Validation accuracy: 92.18
Validation recall: 60.98
Validation precision: 43.86
Validation AUC: 0.5778904325740267
Validation class accuracies: [0.944153577661431, 0.6097560975609756]
Saving model...
Epoch 23/65
167/167 - 237s - loss: 0.0572 - accuracy: 0.9730 - val_loss: 0.1984 - val_accuracy: 0.9267
Confusion matrix: 
 [[548  25]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.488 0.512]]
Validation f1: 48.28
Validation accuracy: 92.67
Validation recall: 51.22
Validation precision: 45.65
Validation AUC: 0.49174281395015024
Validation class accuracies: [0.956369982547993, 0.5121951219512195]
The validation tracker metric at 0.5102040816326531 hasn't increased by 0 in 1 epochs
Epoch 24/65
167/167 - 237s - loss: 0.0573 - accuracy: 0.9726 - val_loss: 0.6953 - val_accuracy: 0.7704
Confusion matrix: 
 [[442 131]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.771 0.229]
 [0.244 0.756]]
Validation f1: 30.54
Validation accuracy: 77.04
Validation recall: 75.61
Validation precision: 19.14
Validation AUC: 0.5238537130457441
Validation class accuracies: [0.7713787085514834, 0.7560975609756098]
The validation tracker metric at 0.5102040816326531 hasn't increased by 0 in 2 epochs
Epoch 25/65
167/167 - 237s - loss: 0.0559 - accuracy: 0.9737 - val_loss: 0.2579 - val_accuracy: 0.9463
Confusion matrix: 
 [[571   2]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.756 0.244]]
Validation f1: 37.74
Validation accuracy: 94.63
Validation recall: 24.39
Validation precision: 83.33
Validation AUC: 0.5075414166047869
Validation class accuracies: [0.9965095986038395, 0.24390243902439024]
The validation tracker metric at 0.5102040816326531 hasn't increased by 0 in 3 epochs
Epoch 26/65
167/167 - 237s - loss: 0.0329 - accuracy: 0.9861 - val_loss: 0.2248 - val_accuracy: 0.9283
Confusion matrix: 
 [[547  26]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.11
Validation accuracy: 92.83
Validation recall: 56.10
Validation precision: 46.94
Validation AUC: 0.5663420592363099
Validation class accuracies: [0.9546247818499127, 0.5609756097560976]
Saving model...
Epoch 27/65
167/167 - 237s - loss: 0.0235 - accuracy: 0.9884 - val_loss: 0.2986 - val_accuracy: 0.9414
Confusion matrix: 
 [[568   5]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.756 0.244]]
Validation f1: 35.71
Validation accuracy: 94.14
Validation recall: 24.39
Validation precision: 66.67
Validation AUC: 0.47087484993198186
Validation class accuracies: [0.9912739965095986, 0.24390243902439024]
The validation tracker metric at 0.5111111111111111 hasn't increased by 0 in 1 epochs
Epoch 28/65
167/167 - 237s - loss: 0.0170 - accuracy: 0.9944 - val_loss: 0.2185 - val_accuracy: 0.9560
Confusion matrix: 
 [[570   3]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.585 0.415]]
Validation f1: 55.74
Validation accuracy: 95.60
Validation recall: 41.46
Validation precision: 85.00
Validation AUC: 0.5961310210261737
Validation class accuracies: [0.9947643979057592, 0.4146341463414634]
Saving model...
Epoch 29/65
167/167 - 237s - loss: 0.0235 - accuracy: 0.9887 - val_loss: 0.2453 - val_accuracy: 0.9446
Confusion matrix: 
 [[571   2]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.78  0.22 ]]
Validation f1: 34.62
Validation accuracy: 94.46
Validation recall: 21.95
Validation precision: 81.82
Validation AUC: 0.4845776212089106
Validation class accuracies: [0.9965095986038395, 0.21951219512195122]
The validation tracker metric at 0.5573770491803278 hasn't increased by 0 in 1 epochs
Epoch 30/65
167/167 - 237s - loss: 0.0181 - accuracy: 0.9932 - val_loss: 0.3859 - val_accuracy: 0.8795
Confusion matrix: 
 [[518  55]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.463 0.537]]
Validation f1: 37.29
Validation accuracy: 87.95
Validation recall: 53.66
Validation precision: 28.57
Validation AUC: 0.5686857902580333
Validation class accuracies: [0.9040139616055847, 0.5365853658536586]
The validation tracker metric at 0.5573770491803278 hasn't increased by 0 in 2 epochs
Epoch 31/65
167/167 - 239s - loss: 0.0250 - accuracy: 0.9884 - val_loss: 0.2841 - val_accuracy: 0.9251
Confusion matrix: 
 [[566   7]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.951 0.049]]
Validation f1: 8.00
Validation accuracy: 92.51
Validation recall: 4.88
Validation precision: 22.22
Validation AUC: 0.25090268006891053
Validation class accuracies: [0.987783595113438, 0.04878048780487805]
The validation tracker metric at 0.5573770491803278 hasn't increased by 0 in 3 epochs
Epoch 32/65
167/167 - 237s - loss: 0.0143 - accuracy: 0.9951 - val_loss: 0.2820 - val_accuracy: 0.9463
Confusion matrix: 
 [[571   2]
 [ 31  10]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.756 0.244]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.74
Validation accuracy: 94.63
Validation recall: 24.39
Validation precision: 83.33
Validation AUC: 0.4677811528889769
Validation class accuracies: [0.9965095986038395, 0.24390243902439024]
The validation tracker metric at 0.5573770491803278 hasn't increased by 0 in 4 epochs
Epoch 33/65
167/167 - 237s - loss: 0.0069 - accuracy: 0.9981 - val_loss: 0.2187 - val_accuracy: 0.9544
Confusion matrix: 
 [[568   5]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.561 0.439]]
Validation f1: 56.25
Validation accuracy: 95.44
Validation recall: 43.90
Validation precision: 78.26
Validation AUC: 0.6004279510664141
Validation class accuracies: [0.9912739965095986, 0.43902439024390244]
Saving model...
Epoch 34/65
167/167 - 237s - loss: 0.0068 - accuracy: 0.9977 - val_loss: 0.2077 - val_accuracy: 0.9577
Confusion matrix: 
 [[571   2]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.585 0.415]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.67
Validation accuracy: 95.77
Validation recall: 41.46
Validation precision: 89.47
Validation AUC: 0.6281793493307881
Validation class accuracies: [0.9965095986038395, 0.4146341463414634]
Saving model...
Epoch 35/65
167/167 - 238s - loss: 0.0076 - accuracy: 0.9970 - val_loss: 0.3045 - val_accuracy: 0.9414
Confusion matrix: 
 [[572   1]
 [ 35   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.854 0.146]]
Validation f1: 25.00
Validation accuracy: 94.14
Validation recall: 14.63
Validation precision: 85.71
Validation AUC: 0.5325551926387515
Validation class accuracies: [0.9982547993019197, 0.14634146341463414]
The validation tracker metric at 0.5666666666666667 hasn't increased by 0 in 1 epochs
Epoch 36/65
167/167 - 237s - loss: 0.0164 - accuracy: 0.9936 - val_loss: 0.3478 - val_accuracy: 0.9235
Confusion matrix: 
 [[550  23]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.585 0.415]]
Validation f1: 41.98
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.35
Validation recall: 41.46
Validation precision: 42.50
Validation AUC: 0.41706445325004976
Validation class accuracies: [0.9598603839441536, 0.4146341463414634]
The validation tracker metric at 0.5666666666666667 hasn't increased by 0 in 2 epochs
Epoch 37/65
167/167 - 237s - loss: 0.0820 - accuracy: 0.9707 - val_loss: 1.4809 - val_accuracy: 0.7085
Confusion matrix: 
 [[420 153]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.733 0.267]
 [0.634 0.366]]
Validation f1: 14.35
Validation accuracy: 70.85
Validation recall: 36.59
Validation precision: 8.93
Validation AUC: 0.1661831473377774
Validation class accuracies: [0.7329842931937173, 0.36585365853658536]
The validation tracker metric at 0.5666666666666667 hasn't increased by 0 in 3 epochs
Epoch 38/65
167/167 - 237s - loss: 0.0551 - accuracy: 0.9767 - val_loss: 0.3533 - val_accuracy: 0.9365
Confusion matrix: 
 [[568   5]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.829 0.171]]
Validation f1: 26.42
Validation accuracy: 93.65
Validation recall: 17.07
Validation precision: 58.33
Validation AUC: 0.3341402863805011
Validation class accuracies: [0.9912739965095986, 0.17073170731707318]
The validation tracker metric at 0.5666666666666667 hasn't increased by 0 in 4 epochs
Epoch 39/65
167/167 - 237s - loss: 0.0130 - accuracy: 0.9959 - val_loss: 0.2569 - val_accuracy: 0.9446
Confusion matrix: 
 [[571   2]
 [ 32   9]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.78  0.22 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.62
Validation accuracy: 94.46
Validation recall: 21.95
Validation precision: 81.82
Validation AUC: 0.5146503214351449
Validation class accuracies: [0.9965095986038395, 0.21951219512195122]
The validation tracker metric at 0.5666666666666667 hasn't increased by 0 in 5 epochs
Epoch 40/65
167/167 - 237s - loss: 0.0312 - accuracy: 0.9872 - val_loss: 0.2409 - val_accuracy: 0.9593
Confusion matrix: 
 [[571   2]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.561 0.439]]
Validation f1: 59.02
Validation accuracy: 95.93
Validation recall: 43.90
Validation precision: 90.00
Validation AUC: 0.6584336149832207
Validation class accuracies: [0.9965095986038395, 0.43902439024390244]
Saving model...
Epoch 41/65
167/167 - 237s - loss: 0.0089 - accuracy: 0.9974 - val_loss: 0.2322 - val_accuracy: 0.9495
Confusion matrix: 
 [[571   2]
 [ 29  12]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.707 0.293]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.64
Validation accuracy: 94.95
Validation recall: 29.27
Validation precision: 85.71
Validation AUC: 0.5598353031933989
Validation class accuracies: [0.9965095986038395, 0.2926829268292683]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 1 epochs
Epoch 42/65
167/167 - 238s - loss: 0.0140 - accuracy: 0.9940 - val_loss: 0.2557 - val_accuracy: 0.9528
Confusion matrix: 
 [[572   1]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.683 0.317]]
Validation f1: 47.27
Validation accuracy: 95.28
Validation recall: 31.71
Validation precision: 92.86
Validation AUC: 0.5474495580585871
Validation class accuracies: [0.9982547993019197, 0.3170731707317073]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 2 epochs
Epoch 43/65
167/167 - 237s - loss: 0.0052 - accuracy: 0.9992 - val_loss: 0.2558 - val_accuracy: 0.9544
Confusion matrix: 
 [[572   1]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.659 0.341]]
Validation f1: 50.00
Validation accuracy: 95.44
Validation recall: 34.15
Validation precision: 93.33
Validation AUC: 0.5757304302430233
Validation class accuracies: [0.9982547993019197, 0.34146341463414637]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 3 epochs
Epoch 44/65
167/167 - 237s - loss: 0.0056 - accuracy: 0.9981 - val_loss: 0.2677 - val_accuracy: 0.9544
Confusion matrix: 
 [[572   1]
 [ 27  14]]
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.659 0.341]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 95.44
Validation recall: 34.15
Validation precision: 93.33
Validation AUC: 0.5715156204039307
Validation class accuracies: [0.9982547993019197, 0.34146341463414637]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 4 epochs
Epoch 45/65
167/167 - 237s - loss: 0.0037 - accuracy: 0.9985 - val_loss: 0.2451 - val_accuracy: 0.9528
Confusion matrix: 
 [[571   2]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.659 0.341]]
Validation f1: 49.12
Validation accuracy: 95.28
Validation recall: 34.15
Validation precision: 87.50
Validation AUC: 0.5721573142411779
Validation class accuracies: [0.9965095986038395, 0.34146341463414637]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 5 epochs
Epoch 46/65
167/167 - 237s - loss: 0.0635 - accuracy: 0.9779 - val_loss: 0.6200 - val_accuracy: 0.8094
Confusion matrix: 
 [[468 105]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.293 0.707]]
Validation f1: 33.14
Validation accuracy: 80.94
Validation recall: 70.73
Validation precision: 21.64
Validation AUC: 0.5542969473981125
Validation class accuracies: [0.8167539267015707, 0.7073170731707317]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 47/65
167/167 - 237s - loss: 0.0135 - accuracy: 0.9944 - val_loss: 0.2878 - val_accuracy: 0.9430
Confusion matrix: 
 [[566   7]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.683 0.317]]
Validation f1: 42.62
Validation accuracy: 94.30
Validation recall: 31.71
Validation precision: 65.00
Validation AUC: 0.4451858505052263
Validation class accuracies: [0.987783595113438, 0.3170731707317073]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 7 epochs
Epoch 48/65
167/167 - 237s - loss: 0.0105 - accuracy: 0.9985 - val_loss: 0.3010 - val_accuracy: 0.9414
Confusion matrix: 
 [[567   6]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.732 0.268]]
Validation f1: 37.93
Validation accuracy: 94.14
Validation recall: 26.83
Validation precision: 64.71
Validation AUC: 0.4366537837672073
Validation class accuracies: [0.9895287958115183, 0.2682926829268293]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 8 epochs
Epoch 49/65
167/167 - 237s - loss: 0.0059 - accuracy: 0.9992 - val_loss: 0.2835 - val_accuracy: 0.9463
Confusion matrix: 
 [[567   6]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.659 0.341]]
Validation f1: 45.90
Validation accuracy: 94.63
Validation recall: 34.15
Validation precision: 70.00
Validation AUC: 0.4769060232387543
Validation class accuracies: [0.9895287958115183, 0.34146341463414637]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 9 epochs
Epoch 50/65
167/167 - 237s - loss: 0.0052 - accuracy: 0.9985 - val_loss: 0.2878 - val_accuracy: 0.9479
Confusion matrix: 
 [[570   3]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.707 0.293]]
Validation f1: 42.86
Validation accuracy: 94.79
Validation recall: 29.27
Validation precision: 80.00
Validation AUC: 0.4909582481914726
Validation class accuracies: [0.9947643979057592, 0.2926829268292683]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 10 epochs
Epoch 51/65
167/167 - 237s - loss: 0.0043 - accuracy: 0.9992 - val_loss: 0.2692 - val_accuracy: 0.9430
Confusion matrix: 
 [[565   8]
 [ 27  14]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.659 0.341]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.44
Validation accuracy: 94.30
Validation recall: 34.15
Validation precision: 63.64
Validation AUC: 0.508220627191343
Validation class accuracies: [0.9860383944153578, 0.34146341463414637]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 11 epochs
Epoch 52/65
167/167 - 237s - loss: 0.0041 - accuracy: 0.9992 - val_loss: 0.2843 - val_accuracy: 0.9495
Confusion matrix: 
 [[569   4]
 [ 27  14]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.659 0.341]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.46
Validation accuracy: 94.95
Validation recall: 34.15
Validation precision: 77.78
Validation AUC: 0.48690965480684356
Validation class accuracies: [0.9930191972076788, 0.34146341463414637]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 53/65
167/167 - 239s - loss: 0.0059 - accuracy: 0.9996 - val_loss: 0.3044 - val_accuracy: 0.9414
Confusion matrix: 
 [[563  10]
 [ 26  15]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.634 0.366]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.45
Validation accuracy: 94.14
Validation recall: 36.59
Validation precision: 60.00
Validation AUC: 0.45968536267891913
Validation class accuracies: [0.9825479930191972, 0.36585365853658536]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 13 epochs
Epoch 54/65
167/167 - 237s - loss: 0.0035 - accuracy: 0.9992 - val_loss: 0.2910 - val_accuracy: 0.9479
Confusion matrix: 
 [[568   5]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.659 0.341]]
Validation f1: 46.67
Validation accuracy: 94.79
Validation recall: 34.15
Validation precision: 73.68
Validation AUC: 0.48571844213794274
Validation class accuracies: [0.9912739965095986, 0.34146341463414637]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 14 epochs
Epoch 55/65
167/167 - 237s - loss: 0.0041 - accuracy: 0.9996 - val_loss: 0.2834 - val_accuracy: 0.9463
Confusion matrix: 
 [[567   6]
 [ 27  14]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.659 0.341]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.90
Validation accuracy: 94.63
Validation recall: 34.15
Validation precision: 70.00
Validation AUC: 0.5200452765536641
Validation class accuracies: [0.9895287958115183, 0.34146341463414637]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 15 epochs
Epoch 56/65
167/167 - 237s - loss: 0.0031 - accuracy: 0.9992 - val_loss: 0.2909 - val_accuracy: 0.9463
Confusion matrix: 
 [[569   4]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.707 0.293]]
Validation f1: 42.11
Validation accuracy: 94.63
Validation recall: 29.27
Validation precision: 75.00
Validation AUC: 0.515890440844035
Validation class accuracies: [0.9930191972076788, 0.2926829268292683]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 16 epochs
Epoch 57/65
167/167 - 237s - loss: 0.0030 - accuracy: 0.9989 - val_loss: 0.2806 - val_accuracy: 0.9479
Confusion matrix: 
 [[569   4]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.683 0.317]]
Validation f1: 44.83
Validation accuracy: 94.79
Validation recall: 31.71
Validation precision: 76.47
Validation AUC: 0.5203040043609223
Validation class accuracies: [0.9930191972076788, 0.3170731707317073]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 17 epochs
Epoch 58/65
167/167 - 237s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2915 - val_accuracy: 0.9463
Confusion matrix: 
 [[569   4]
 [ 29  12]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.707 0.293]]
Validation f1: 42.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.63
Validation recall: 29.27
Validation precision: 75.00
Validation AUC: 0.4896095137573158
Validation class accuracies: [0.9930191972076788, 0.2926829268292683]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 59/65
167/167 - 237s - loss: 0.0034 - accuracy: 1.0000 - val_loss: 0.2821 - val_accuracy: 0.9414
Confusion matrix: 
 [[566   7]
 [ 29  12]]
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.707 0.293]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.00
Validation accuracy: 94.14
Validation recall: 29.27
Validation precision: 63.16
Validation AUC: 0.5066391663462453
Validation class accuracies: [0.987783595113438, 0.2926829268292683]
The validation tracker metric at 0.5901639344262295 hasn't increased by 0 in 19 epochs
Epoch 60/65
167/167 - 237s - loss: 0.0050 - accuracy: 0.9996 - val_loss: 0.2739 - val_accuracy: 0.9446
Confusion matrix: 
 [[566   7]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.659 0.341]]
Validation f1: 45.16
Validation accuracy: 94.46
Validation recall: 34.15
Validation precision: 66.67
Validation AUC: 0.5103582729044985
Validation class accuracies: [0.987783595113438, 0.34146341463414637]

The metrics for job 2 with the best target metric are: 
Best cm: [[571   2]
 [ 23  18]]
Best normalized cm: [[0.997 0.003]
 [0.561 0.439]]
Best f1: 0.59
Best accuracy: 0.96
Best recall: 0.44
Best precision: 0.90
Best AUC: 0.66
Best class accuracies: [0.9965095986038395, 0.43902439024390244]
Best epoch: 40
The number of epochs since last 1% equals the patience
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_226_1b1_Ll_sc_Meditron_2_label_1_pred_0.png, [[4.259e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_2b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[6.921e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_211_2p4_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p5_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[1.249e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_222_1b1_Ar_sc_Meditron_11_label_0_pred_0.png, [[4.614e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_222_1b1_Lr_sc_Meditron_10_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_204_7p5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[3.133e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_211_2p3_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.155]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b2_Ar_mc_LittC2SE_3_label_0_pred_1.png, [[0.897]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Ar_sc_Meditron_6_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[1.426e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[5.116e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Pl_sc_Meditron_12_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Ar_sc_Meditron_9_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Ar_sc_Meditron_10_label_0_pred_0.png, [[0.03]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_3b2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1p1_Ar_sc_Litt3200_4_label_0_pred_0.png, [[0.373]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_2p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[9.454e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_205_3b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.113]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1p1_Pl_sc_Litt3200_2_label_0_pred_0.png, [[3.6e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_222_1b1_Lr_sc_Meditron_8_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_205_2b3_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[2.084e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_222_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[0.376]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b3_Pr_mc_LittC2SE_1_label_0_pred_0.png, [[4.646e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_2b2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.033]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Ar_sc_Meditron_11_label_0_pred_1.png, [[0.619]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b1_Pl_mc_LittC2SE_3_label_0_pred_0.png, [[6.871e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[2.231e-08]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_211_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_210_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.428e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_204_2b5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[7.612e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b1_Lr_mc_LittC2SE_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_219_2b1_Ar_mc_LittC2SE_2_label_1_pred_1.png, [[0.957]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_222_1b1_Ar_sc_Meditron_12_label_0_pred_0.png, [[4.534e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_223_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[3.066e-09]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_219_2b3_Tc_mc_LittC2SE_3_label_1_pred_0.png, [[0.097]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_217_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 7698
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_020845-1gc18km4/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_020845-1gc18km4/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99962
wandb:         val_accuracy 0.94463
wandb:             _runtime 15091
wandb:           _timestamp 1624515617
wandb:                _step 446
wandb:           train_loss 0.00495
wandb:             val_loss 0.27387
wandb:           val_recall 0.34146
wandb:        val_precision 0.66667
wandb:               val_f1 0.45161
wandb:              val_auc 0.51036
wandb:                   lr 6e-05
wandb:          best_val_f1 0.59016
wandb:    best_val_accuracy 0.95928
wandb:   best_val_precision 0.9
wandb:      best_val_recall 0.43902
wandb:             best_auc 0.65843
wandb:           best_epoch 40
wandb: Run history:
wandb:   train_accuracy ▁▄▆▆▇▆▇▆▇▇▇▇████████████████████████████
wandb:     val_accuracy ██▇▄█▇▇██▁▇▆████████████▅█████▆█████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▃▂▃▂▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▁█▁▁▁▁▁▅▁▂▁▁▁▁▁▁▁▁▁▁▁▁▄▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▁▄▇▁▂█▁▁▇▇▄▂▃▇▆▃▇▅▃▁▃▅▂▅▃▅▄▄▄█▄▄▄▄▅▄▄▄▄
wandb:    val_precision ▁▁▂▂█▂▄▁▂▁▃▂▆█▄▄▇▄▇▇▃▇▇▇▂▅▇▇██▃▆▆▇▆▅▆▆▆▆
wandb:           val_f1 ▁▁▄▃▂▃▇▁▂▂▆▃▃▄▇▇▅▇█▅▂▅█▄▃▄█▆▇▇▅▆▆▆▇▆▆▆▆▆
wandb:          val_auc ▁▁▃▃▂▂▆▂▂▂▆▂▅▇▇▆▆▇▇▆▃▆█▇▂▄█▇▇▇▇▅▆▆▆▆▆▆▆▆
wandb:               lr ███████████▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▂▂▂▂▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_020845-1gc18km4

-----------------------
Changing augmentation to v42, v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2874
-----------------------
Number of train recordings: 2874 with pneumonia: 474 and non-pneumonia: 2400
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 128, 1250, 1)    4            input_4[0][0]                        
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_15[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_17[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_55352 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_16[0][0]                      
                                                                         conv2d_18[0][0]                      
                                                                         conv2d_19[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePoolin (None, 64, 625, 48)     0            concatenate_55352[0][0]              
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_15[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 64, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_16[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_19[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 32, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_17[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_20[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 16, 156, 128)    91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_18[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_21[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 8, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_19[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 4, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 1)               513          global_average_pooling2d_3[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
180/180 - 254s - loss: 1.0585 - accuracy: 0.5981 - val_loss: 1.6454 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.08053685592978505
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
180/180 - 254s - loss: 0.6251 - accuracy: 0.6409 - val_loss: 0.6009 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.058442262175976506
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
180/180 - 254s - loss: 0.5315 - accuracy: 0.7049 - val_loss: 0.2419 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20428042914002337
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 4/65
180/180 - 254s - loss: 0.4058 - accuracy: 0.7603 - val_loss: 0.4677 - val_accuracy: 0.8127
Confusion matrix: 
 [[466 107]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.813 0.187]
 [0.195 0.805]]
Validation f1: 36.46
Validation accuracy: 81.27
Validation recall: 80.49
Validation precision: 23.57
Validation AUC: 0.4661025199921023
Validation class accuracies: [0.8132635253054101, 0.8048780487804879]
Saving model...
Epoch 5/65
180/180 - 253s - loss: 0.3636 - accuracy: 0.7992 - val_loss: 2.7557 - val_accuracy: 0.3713
Confusion matrix: 
 [[187 386]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.326 0.674]
 [0.    1.   ]]
Validation f1: 17.52
Validation accuracy: 37.13
Validation recall: 100.00
Validation precision: 9.60
Validation AUC: 0.2728568457250278
Validation class accuracies: [0.3263525305410122, 1.0]
The validation tracker metric at 0.36464088397790057 hasn't increased by 0 in 1 epochs
Epoch 6/65
180/180 - 254s - loss: 0.2467 - accuracy: 0.8706 - val_loss: 2.6703 - val_accuracy: 0.6156
Confusion matrix: 
 [[337 236]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.588 0.412]
 [0.    1.   ]]
Validation f1: 25.79
Validation accuracy: 61.56
Validation recall: 100.00
Validation precision: 14.80
Validation AUC: 0.5044323810449195
Validation class accuracies: [0.5881326352530541, 1.0]
The validation tracker metric at 0.36464088397790057 hasn't increased by 0 in 2 epochs
Epoch 7/65
180/180 - 254s - loss: 0.3084 - accuracy: 0.8521 - val_loss: 0.7099 - val_accuracy: 0.7508
Confusion matrix: 
 [[432 141]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.754 0.246]
 [0.293 0.707]]
Validation f1: 27.49
Validation accuracy: 75.08
Validation recall: 70.73
Validation precision: 17.06
Validation AUC: 0.4219956534096899
Validation class accuracies: [0.7539267015706806, 0.7073170731707317]
The validation tracker metric at 0.36464088397790057 hasn't increased by 0 in 3 epochs
Epoch 8/65
180/180 - 254s - loss: 0.2126 - accuracy: 0.8977 - val_loss: 8.4317 - val_accuracy: 0.1612
Confusion matrix: 
 [[ 59 514]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.103 0.897]
 [0.024 0.976]]
Validation f1: 13.45
Validation accuracy: 16.12
Validation recall: 97.56
Validation precision: 7.22
Validation AUC: 0.3393463670705348
Validation class accuracies: [0.10296684118673648, 0.975609756097561]
The validation tracker metric at 0.36464088397790057 hasn't increased by 0 in 4 epochs
Epoch 9/65
180/180 - 254s - loss: 0.2430 - accuracy: 0.8831 - val_loss: 2.1358 - val_accuracy: 0.6384
Confusion matrix: 
 [[356 217]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.621 0.379]
 [0.122 0.878]]
Validation f1: 24.49
Validation accuracy: 63.84
Validation recall: 87.80
Validation precision: 14.23
Validation AUC: 0.5638347982117338
Validation class accuracies: [0.6212914485165794, 0.8780487804878049]
The validation tracker metric at 0.36464088397790057 hasn't increased by 0 in 5 epochs
Epoch 10/65
180/180 - 253s - loss: 0.2158 - accuracy: 0.8900 - val_loss: 1.5447 - val_accuracy: 0.7345
Confusion matrix: 
 [[421 152]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.735 0.265]
 [0.268 0.732]]
Validation f1: 26.91
Validation accuracy: 73.45
Validation recall: 73.17
Validation precision: 16.48
Validation AUC: 0.49315657853864453
Validation class accuracies: [0.7347294938917975, 0.7317073170731707]
The validation tracker metric at 0.36464088397790057 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
180/180 - 253s - loss: 0.1309 - accuracy: 0.9301 - val_loss: 0.4272 - val_accuracy: 0.8436
Confusion matrix: 
 [[491  82]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.857 0.143]
 [0.341 0.659]]
Validation f1: 36.00
Validation accuracy: 84.36
Validation recall: 65.85
Validation precision: 24.77
Validation AUC: 0.5521711051501947
Validation class accuracies: [0.8568935427574171, 0.6585365853658537]
The validation tracker metric at 0.36464088397790057 hasn't increased by 0 in 7 epochs
Epoch 12/65
180/180 - 254s - loss: 0.1282 - accuracy: 0.9363 - val_loss: 0.3455 - val_accuracy: 0.8616
Confusion matrix: 
 [[502  71]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.341 0.659]]
Validation f1: 38.85
Validation accuracy: 86.16
Validation recall: 65.85
Validation precision: 27.55
Validation AUC: 0.5700000848238187
Validation class accuracies: [0.8760907504363001, 0.6585365853658537]
Saving model...
Epoch 13/65
180/180 - 253s - loss: 0.0973 - accuracy: 0.9513 - val_loss: 0.2338 - val_accuracy: 0.9381
Confusion matrix: 
 [[551  22]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.39  0.61 ]]
Validation f1: 56.82
Validation accuracy: 93.81
Validation recall: 60.98
Validation precision: 53.19
Validation AUC: 0.6411461871907612
Validation class accuracies: [0.9616055846422339, 0.6097560975609756]
Saving model...
Epoch 14/65
180/180 - 254s - loss: 0.0717 - accuracy: 0.9659 - val_loss: 1.0834 - val_accuracy: 0.7215
Confusion matrix: 
 [[411 162]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.717 0.283]
 [0.22  0.78 ]]
Validation f1: 27.23
Validation accuracy: 72.15
Validation recall: 78.05
Validation precision: 16.49
Validation AUC: 0.6243050584278835
Validation class accuracies: [0.7172774869109948, 0.7804878048780488]
The validation tracker metric at 0.5681818181818181 hasn't increased by 0 in 1 epochs
Epoch 15/65
180/180 - 253s - loss: 0.0461 - accuracy: 0.9756 - val_loss: 0.2217 - val_accuracy: 0.9609
Confusion matrix: 
 [[568   5]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.463 0.537]]
Validation f1: 64.71
Validation accuracy: 96.09
Validation recall: 53.66
Validation precision: 81.48
Validation AUC: 0.6199753964598345
Validation class accuracies: [0.9912739965095986, 0.5365853658536586]
Saving model...
Epoch 16/65
180/180 - 254s - loss: 0.0800 - accuracy: 0.9690 - val_loss: 0.4867 - val_accuracy: 0.8616
Confusion matrix: 
 [[499  74]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.268 0.732]]
Validation f1: 41.38
Validation accuracy: 86.16
Validation recall: 73.17
Validation precision: 28.85
Validation AUC: 0.6969956384039095
Validation class accuracies: [0.8708551483420593, 0.7317073170731707]
The validation tracker metric at 0.6470588235294118 hasn't increased by 0 in 1 epochs
Epoch 17/65
180/180 - 253s - loss: 0.0823 - accuracy: 0.9600 - val_loss: 0.2233 - val_accuracy: 0.9414
Confusion matrix: 
 [[553  20]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.14
Validation accuracy: 94.14
Validation recall: 60.98
Validation precision: 55.56
Validation AUC: 0.6048910986722887
Validation class accuracies: [0.9650959860383944, 0.6097560975609756]
The validation tracker metric at 0.6470588235294118 hasn't increased by 0 in 2 epochs
Epoch 18/65
180/180 - 253s - loss: 0.0389 - accuracy: 0.9833 - val_loss: 0.2253 - val_accuracy: 0.9381
Confusion matrix: 
 [[549  24]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.341 0.659]]
Validation f1: 58.70
Validation accuracy: 93.81
Validation recall: 65.85
Validation precision: 52.94
Validation AUC: 0.6797222626637036
Validation class accuracies: [0.9581151832460733, 0.6585365853658537]
The validation tracker metric at 0.6470588235294118 hasn't increased by 0 in 3 epochs
Epoch 19/65
180/180 - 254s - loss: 0.0404 - accuracy: 0.9812 - val_loss: 0.2578 - val_accuracy: 0.9479
Confusion matrix: 
 [[556  17]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.366 0.634]]
Validation f1: 61.90
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.79
Validation recall: 63.41
Validation precision: 60.47
Validation AUC: 0.6435279192918135
Validation class accuracies: [0.9703315881326352, 0.6341463414634146]
The validation tracker metric at 0.6470588235294118 hasn't increased by 0 in 4 epochs
Epoch 20/65
180/180 - 254s - loss: 0.0210 - accuracy: 0.9892 - val_loss: 0.3940 - val_accuracy: 0.9055
Confusion matrix: 
 [[526  47]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.268 0.732]]
Validation f1: 50.85
Validation accuracy: 90.55
Validation recall: 73.17
Validation precision: 38.96
Validation AUC: 0.6569196046334334
Validation class accuracies: [0.9179755671902269, 0.7317073170731707]
The validation tracker metric at 0.6470588235294118 hasn't increased by 0 in 5 epochs
Epoch 21/65
180/180 - 253s - loss: 0.1298 - accuracy: 0.9652 - val_loss: 0.7306 - val_accuracy: 0.9153
Confusion matrix: 
 [[552  21]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.756 0.244]]
Validation f1: 27.78
Validation accuracy: 91.53
Validation recall: 24.39
Validation precision: 32.26
Validation AUC: 0.23853764419596318
Validation class accuracies: [0.9633507853403142, 0.24390243902439024]
The validation tracker metric at 0.6470588235294118 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
180/180 - 254s - loss: 0.0624 - accuracy: 0.9673 - val_loss: 0.2208 - val_accuracy: 0.9560
Confusion matrix: 
 [[564   9]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.439 0.561]]
Validation f1: 63.01
Validation accuracy: 95.60
Validation recall: 56.10
Validation precision: 71.88
Validation AUC: 0.6365082344760312
Validation class accuracies: [0.9842931937172775, 0.5609756097560976]
The validation tracker metric at 0.6470588235294118 hasn't increased by 0 in 7 epochs
Epoch 23/65
180/180 - 254s - loss: 0.0337 - accuracy: 0.9840 - val_loss: 0.2011 - val_accuracy: 0.9560
Confusion matrix: 
 [[558  15]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.293 0.707]]
Validation f1: 68.24
Validation accuracy: 95.60
Validation recall: 70.73
Validation precision: 65.91
Validation AUC: 0.7203860528922342
Validation class accuracies: [0.9738219895287958, 0.7073170731707317]
Saving model...
Epoch 24/65
180/180 - 253s - loss: 0.0212 - accuracy: 0.9903 - val_loss: 0.2408 - val_accuracy: 0.9463
Confusion matrix: 
 [[552  21]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.293 0.707]]
Validation f1: 63.74
Validation accuracy: 94.63
Validation recall: 70.73
Validation precision: 58.00
Validation AUC: 0.7048116527701904
Validation class accuracies: [0.9633507853403142, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 1 epochs
Epoch 25/65
180/180 - 253s - loss: 0.0336 - accuracy: 0.9861 - val_loss: 0.2161 - val_accuracy: 0.9495
Confusion matrix: 
 [[554  19]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.293 0.707]]
Validation f1: 65.17
Validation accuracy: 94.95
Validation recall: 70.73
Validation precision: 60.42
Validation AUC: 0.7104207309536315
Validation class accuracies: [0.9668411867364747, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 2 epochs
Epoch 26/65
180/180 - 253s - loss: 0.0159 - accuracy: 0.9944 - val_loss: 0.4440 - val_accuracy: 0.8909
Confusion matrix: 
 [[517  56]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.902 0.098]
 [0.268 0.732]]
Validation f1: 47.24
Validation accuracy: 89.09
Validation recall: 73.17
Validation precision: 34.88
Validation AUC: 0.6923637213394944
Validation class accuracies: [0.9022687609075044, 0.7317073170731707]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 3 epochs
Epoch 27/65
180/180 - 253s - loss: 0.0118 - accuracy: 0.9958 - val_loss: 0.2541 - val_accuracy: 0.9430
Confusion matrix: 
 [[550  23]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.37
Validation accuracy: 94.30
Validation recall: 70.73
Validation precision: 55.77
Validation AUC: 0.6879092186994389
Validation class accuracies: [0.9598603839441536, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 4 epochs
Epoch 28/65
180/180 - 253s - loss: 0.0158 - accuracy: 0.9927 - val_loss: 0.3755 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.6849931304363367
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 5 epochs
Epoch 29/65
180/180 - 254s - loss: 0.0174 - accuracy: 0.9910 - val_loss: 0.2464 - val_accuracy: 0.9479
Confusion matrix: 
 [[553  20]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.293 0.707]]
Validation f1: 64.44
Validation accuracy: 94.79
Validation recall: 70.73
Validation precision: 59.18
Validation AUC: 0.6840809046185964
Validation class accuracies: [0.9650959860383944, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 30/65
180/180 - 253s - loss: 0.0135 - accuracy: 0.9955 - val_loss: 0.2666 - val_accuracy: 0.9430
Confusion matrix: 
 [[550  23]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.37
Validation accuracy: 94.30
Validation recall: 70.73
Validation precision: 55.77
Validation AUC: 0.673962068394546
Validation class accuracies: [0.9598603839441536, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 7 epochs
Epoch 31/65
180/180 - 253s - loss: 0.0127 - accuracy: 0.9948 - val_loss: 0.2722 - val_accuracy: 0.9463
Confusion matrix: 
 [[552  21]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.74
Validation accuracy: 94.63
Validation recall: 70.73
Validation precision: 58.00
Validation AUC: 0.6696252104943285
Validation class accuracies: [0.9633507853403142, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 8 epochs
Epoch 32/65
180/180 - 254s - loss: 0.0071 - accuracy: 0.9972 - val_loss: 0.2529 - val_accuracy: 0.9479
Confusion matrix: 
 [[553  20]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.293 0.707]]
Validation f1: 64.44
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.79
Validation recall: 70.73
Validation precision: 59.18
Validation AUC: 0.6889888991743092
Validation class accuracies: [0.9650959860383944, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 9 epochs
Epoch 33/65
180/180 - 254s - loss: 0.0075 - accuracy: 0.9986 - val_loss: 0.3058 - val_accuracy: 0.9381
Confusion matrix: 
 [[547  26]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.293 0.707]]
Validation f1: 60.42
Validation accuracy: 93.81
Validation recall: 70.73
Validation precision: 52.73
Validation AUC: 0.6790793995247995
Validation class accuracies: [0.9546247818499127, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 10 epochs
Epoch 34/65
180/180 - 253s - loss: 0.0068 - accuracy: 0.9976 - val_loss: 0.2553 - val_accuracy: 0.9528
Confusion matrix: 
 [[557  16]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.317 0.683]]
Validation f1: 65.88
Validation accuracy: 95.28
Validation recall: 68.29
Validation precision: 63.64
Validation AUC: 0.6698365746202475
Validation class accuracies: [0.9720767888307156, 0.6829268292682927]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 11 epochs
Epoch 35/65
180/180 - 253s - loss: 0.0071 - accuracy: 0.9986 - val_loss: 0.2633 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.317 0.683]]
Validation f1: 62.92
Validation accuracy: 94.63
Validation recall: 68.29
Validation precision: 58.33
Validation AUC: 0.6706160897845365
Validation class accuracies: [0.9650959860383944, 0.6829268292682927]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 36/65
180/180 - 253s - loss: 0.0085 - accuracy: 0.9983 - val_loss: 0.2976 - val_accuracy: 0.9430
Confusion matrix: 
 [[550  23]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.293 0.707]]
Validation f1: 62.37
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.30
Validation recall: 70.73
Validation precision: 55.77
Validation AUC: 0.6714396590984585
Validation class accuracies: [0.9598603839441536, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 13 epochs
Epoch 37/65
180/180 - 254s - loss: 0.0089 - accuracy: 0.9969 - val_loss: 0.2959 - val_accuracy: 0.9463
Confusion matrix: 
 [[552  21]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.293 0.707]]
Validation f1: 63.74
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.63
Validation recall: 70.73
Validation precision: 58.00
Validation AUC: 0.6684557837778641
Validation class accuracies: [0.9633507853403142, 0.7073170731707317]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 14 epochs
Epoch 38/65
180/180 - 253s - loss: 0.0063 - accuracy: 0.9986 - val_loss: 0.3037 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.92
Validation accuracy: 94.63
Validation recall: 68.29
Validation precision: 58.33
Validation AUC: 0.655456719789325
Validation class accuracies: [0.9650959860383944, 0.6829268292682927]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 15 epochs
Epoch 39/65
180/180 - 254s - loss: 0.0054 - accuracy: 0.9979 - val_loss: 0.2950 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.317 0.683]]
Validation f1: 62.92
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.63
Validation recall: 68.29
Validation precision: 58.33
Validation AUC: 0.6572302464914207
Validation class accuracies: [0.9650959860383944, 0.6829268292682927]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 16 epochs
Epoch 40/65
180/180 - 253s - loss: 0.0049 - accuracy: 0.9993 - val_loss: 0.3108 - val_accuracy: 0.9414
Confusion matrix: 
 [[550  23]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.317 0.683]]
Validation f1: 60.87
Validation accuracy: 94.14
Validation recall: 68.29
Validation precision: 54.90
Validation AUC: 0.6680072106508431
Validation class accuracies: [0.9598603839441536, 0.6829268292682927]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 17 epochs
Epoch 41/65
180/180 - 254s - loss: 0.0041 - accuracy: 0.9990 - val_loss: 0.2856 - val_accuracy: 0.9479
Confusion matrix: 
 [[554  19]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.317 0.683]]
Validation f1: 63.64
Validation accuracy: 94.79
Validation recall: 68.29
Validation precision: 59.57
Validation AUC: 0.6666253423367978
Validation class accuracies: [0.9668411867364747, 0.6829268292682927]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 42/65
180/180 - 253s - loss: 0.0050 - accuracy: 0.9993 - val_loss: 0.3062 - val_accuracy: 0.9430
Confusion matrix: 
 [[551  22]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.317 0.683]]
Validation f1: 61.54
Validation accuracy: 94.30
Validation recall: 68.29
Validation precision: 56.00
Validation AUC: 0.6696477372792723
Validation class accuracies: [0.9616055846422339, 0.6829268292682927]
The validation tracker metric at 0.6823529411764706 hasn't increased by 0 in 19 epochs
Epoch 43/65
180/180 - 254s - loss: 0.0058 - accuracy: 0.9990 - val_loss: 0.3075 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6660367571811253
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]

The metrics for job 3 with the best target metric are: 
Best cm: [[558  15]
 [ 12  29]]
Best normalized cm: [[0.974 0.026]
 [0.293 0.707]]
Best f1: 0.68
Best accuracy: 0.96
Best recall: 0.71
Best precision: 0.66
Best AUC: 0.72
Best class accuracies: [0.9738219895287958, 0.7073170731707317]
Best epoch: 23
The number of epochs since last 1% equals the patience
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[1.978e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_4b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[2.485e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.059]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_1.png, [[0.997]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_1b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[6.035e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[2.551e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_204_7p5_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[2.604e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP36_pneumonia,Crep,P R M,36,F_4_label_1_pred_1.png, [[0.999]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_1p2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[8.576e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_2b3_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_2p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_222_1b1_Lr_sc_Meditron_11_label_0_pred_1.png, [[0.646]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_2p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[1.128e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1b1_Pr_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1b1_Ar_sc_Meditron_13_label_0_pred_0.png, [[0.029]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_2b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_204_2b5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[5.996e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_2b4_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[4.018e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_222_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_1p5_Tc_mc_AKGC417L_0_label_0_pred_1.png, [[0.633]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_223_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[1.418e-07]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.04]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_211_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[2.317e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_1b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[9.694e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_1p2_Lr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_204_7p5_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_2p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_2b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[6.235e-05]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_1p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[2.039e-07]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_2b4_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_203_2p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[3.852e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png, [[0.985]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1b1_Al_sc_Meditron_9_label_0_pred_0.png, [[0.048]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_1b3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[4.35e-06]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 24650
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_062058-1m5xgxa7/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_062058-1m5xgxa7/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99896
wandb:         val_accuracy 0.94463
wandb:             _runtime 11500
wandb:           _timestamp 1624527158
wandb:                _step 318
wandb:           train_loss 0.00575
wandb:             val_loss 0.30752
wandb:           val_recall 0.68293
wandb:        val_precision 0.57143
wandb:               val_f1 0.62222
wandb:              val_auc 0.66604
wandb:                   lr 3e-05
wandb:          best_val_f1 0.68235
wandb:    best_val_accuracy 0.95603
wandb:   best_val_precision 0.65909
wandb:      best_val_recall 0.70732
wandb:             best_auc 0.72039
wandb:           best_epoch 23
wandb: Run history:
wandb:   train_accuracy ▁▂▃▄▅▆▅▆▆▆▇▇▇█▇▇███▇▇███████████████████
wandb:     val_accuracy ▁██▇▃▅▆▂▅▆▇▇██▇█████████▇███████████████
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▄▃▃▃▂▃▂▂▂▂▁▂▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▁▁▃▃▁█▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall █▁▁▇██▆█▇▆▆▆▅▅▆▅▆▅▆▃▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▂▁▁▃▂▂▂▂▂▂▃▃▆█▃▆▆▆▄▄▇▇▆▆▄▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_f1 ▂▁▁▅▃▄▄▂▄▄▅▅▇█▅▇▇▇▆▄▇███▆▇█▇██▇█▇▇█▇▇▇█▇
wandb:          val_auc ▁▁▃▅▃▆▅▄▆▆▆▆▇▇█▇█▇▇▃▇███████▇██▇▇▇▇▇▇▇▇▇
wandb:               lr ██████████▄▄▄▄▄▄▄▄▄▄▃▃▃▃▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_062058-1m5xgxa7

-----------------------
Model 9 with new params
Changing augmentation to time/frequency masking
Audio Augmentation Parameters: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Spec Augmentation Parameters: {'ADD': 1, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_6
Length of training samples after spec augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_7
Length of training samples after spec augmentation: 2716
-----------------------
Number of train recordings: 2716 with pneumonia: 316 and non-pneumonia: 2400
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_5 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormal (None, 128, 1250, 1)    4            input_5[0][0]                        
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_20[0][0]                      
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_22[0][0]                      
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_3[0][0]                
______________________________________________________________________________________________________________
concatenate_55353 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_21[0][0]                      
                                                                         conv2d_23[0][0]                      
                                                                         conv2d_24[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_20 (AveragePoolin (None, 64, 625, 48)     0            concatenate_55353[0][0]              
______________________________________________________________________________________________________________
batch_normalization_24 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_20[0][0]           
______________________________________________________________________________________________________________
dropout_15 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
inverted_residual_30 (InvertedResid (None, 64, 625, 32)     35840        dropout_15[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_31 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_30[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_21 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_31[0][0]           
______________________________________________________________________________________________________________
batch_normalization_25 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_21[0][0]           
______________________________________________________________________________________________________________
dropout_16 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_25[0][0]         
______________________________________________________________________________________________________________
inverted_residual_32 (InvertedResid (None, 32, 312, 64)     27136        dropout_16[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_33 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_32[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_22 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_33[0][0]           
______________________________________________________________________________________________________________
batch_normalization_26 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_22[0][0]           
______________________________________________________________________________________________________________
dropout_17 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_26[0][0]         
______________________________________________________________________________________________________________
inverted_residual_34 (InvertedResid (None, 16, 156, 128)    91136        dropout_17[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_35 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_34[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_23 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_35[0][0]           
______________________________________________________________________________________________________________
batch_normalization_27 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_23[0][0]           
______________________________________________________________________________________________________________
dropout_18 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_27[0][0]         
______________________________________________________________________________________________________________
inverted_residual_36 (InvertedResid (None, 8, 78, 256)      329728       dropout_18[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_37 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_36[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_24 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_37[0][0]           
______________________________________________________________________________________________________________
batch_normalization_28 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_24[0][0]           
______________________________________________________________________________________________________________
dropout_19 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_28[0][0]         
______________________________________________________________________________________________________________
inverted_residual_38 (InvertedResid (None, 4, 39, 512)      1249280      dropout_19[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_39 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_38[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_4 (GlobalA (None, 512)             0            inverted_residual_39[0][0]           
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 1)               513          global_average_pooling2d_4[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
170/170 - 241s - loss: 1.1440 - accuracy: 0.6263 - val_loss: 0.2470 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19300967616664366
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
170/170 - 240s - loss: 0.6240 - accuracy: 0.7220 - val_loss: 0.2744 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1570813393214143
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
170/170 - 241s - loss: 0.6695 - accuracy: 0.6889 - val_loss: 0.2106 - val_accuracy: 0.9414
Confusion matrix: 
 [[573   0]
 [ 36   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.878 0.122]]
Validation f1: 21.74
Validation accuracy: 94.14
Validation recall: 12.20
Validation precision: 100.00
Validation AUC: 0.4253147498368542
Validation class accuracies: [1.0, 0.12195121951219512]
Saving model...
Epoch 4/65
170/170 - 241s - loss: 0.4674 - accuracy: 0.7478 - val_loss: 0.2003 - val_accuracy: 0.9479
Confusion matrix: 
 [[557  16]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.98
Validation accuracy: 94.79
Validation recall: 60.98
Validation precision: 60.98
Validation AUC: 0.5387701683689224
Validation class accuracies: [0.9720767888307156, 0.6097560975609756]
Saving model...
Epoch 5/65
170/170 - 241s - loss: 0.4383 - accuracy: 0.7566 - val_loss: 0.7344 - val_accuracy: 0.7769
Confusion matrix: 
 [[446 127]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.778 0.222]
 [0.244 0.756]]
Validation f1: 31.16
Validation accuracy: 77.69
Validation recall: 75.61
Validation precision: 19.62
Validation AUC: 0.48292682602230935
Validation class accuracies: [0.7783595113438045, 0.7560975609756098]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 1 epochs
Epoch 6/65
170/170 - 240s - loss: 0.3589 - accuracy: 0.8074 - val_loss: 0.3474 - val_accuracy: 0.8697
Confusion matrix: 
 [[512  61]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.463 0.537]]
Validation f1: 35.48
Validation accuracy: 86.97
Validation recall: 53.66
Validation precision: 26.51
Validation AUC: 0.46064356767821957
Validation class accuracies: [0.893542757417103, 0.5365853658536586]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 2 epochs
Epoch 7/65
170/170 - 241s - loss: 0.3018 - accuracy: 0.8535 - val_loss: 7.7388 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.09665695324206781
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 3 epochs
Epoch 8/65
170/170 - 241s - loss: 0.4097 - accuracy: 0.7920 - val_loss: 1.4072 - val_accuracy: 0.4674
Confusion matrix: 
 [[246 327]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.429 0.571]
 [0.    1.   ]]
Validation f1: 20.05
Validation accuracy: 46.74
Validation recall: 100.00
Validation precision: 11.14
Validation AUC: 0.5866973033428096
Validation class accuracies: [0.4293193717277487, 1.0]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 4 epochs
Epoch 9/65
170/170 - 241s - loss: 0.2982 - accuracy: 0.8273 - val_loss: 0.3982 - val_accuracy: 0.8697
Confusion matrix: 
 [[505  68]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.293 0.707]]
Validation f1: 42.03
Validation accuracy: 86.97
Validation recall: 70.73
Validation precision: 29.90
Validation AUC: 0.27878477116503275
Validation class accuracies: [0.881326352530541, 0.7073170731707317]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 5 epochs
Epoch 10/65
170/170 - 241s - loss: 0.2810 - accuracy: 0.8605 - val_loss: 1.1530 - val_accuracy: 0.6384
Confusion matrix: 
 [[351 222]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.613 0.387]
 [0.    1.   ]]
Validation f1: 26.97
Validation accuracy: 63.84
Validation recall: 100.00
Validation precision: 15.59
Validation AUC: 0.5291409205004445
Validation class accuracies: [0.612565445026178, 1.0]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
170/170 - 241s - loss: 0.2186 - accuracy: 0.8873 - val_loss: 0.4682 - val_accuracy: 0.8469
Confusion matrix: 
 [[481  92]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.049 0.951]]
Validation f1: 45.35
Validation accuracy: 84.69
Validation recall: 95.12
Validation precision: 29.77
Validation AUC: 0.538431711835572
Validation class accuracies: [0.8394415357766143, 0.9512195121951219]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 7 epochs
Epoch 12/65
170/170 - 240s - loss: 0.1639 - accuracy: 0.9127 - val_loss: 1.1563 - val_accuracy: 0.6482
Confusion matrix: 
 [[357 216]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.623 0.377]
 [0.    1.   ]]
Validation f1: 27.52
Validation accuracy: 64.82
Validation recall: 100.00
Validation precision: 15.95
Validation AUC: 0.5728814233656166
Validation class accuracies: [0.6230366492146597, 1.0]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 8 epochs
Epoch 13/65
170/170 - 241s - loss: 0.1756 - accuracy: 0.9116 - val_loss: 0.4624 - val_accuracy: 0.8502
Confusion matrix: 
 [[487  86]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85  0.15 ]
 [0.146 0.854]]
Validation f1: 43.21
Validation accuracy: 85.02
Validation recall: 85.37
Validation precision: 28.93
Validation AUC: 0.6097769847973891
Validation class accuracies: [0.849912739965096, 0.8536585365853658]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 9 epochs
Epoch 14/65
170/170 - 241s - loss: 0.2142 - accuracy: 0.8991 - val_loss: 1.1701 - val_accuracy: 0.6906
Confusion matrix: 
 [[383 190]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.668 0.332]
 [0.    1.   ]]
Validation f1: 30.15
Validation accuracy: 69.06
Validation recall: 100.00
Validation precision: 17.75
Validation AUC: 0.5383599781560373
Validation class accuracies: [0.6684118673647469, 1.0]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 10 epochs
Epoch 15/65
170/170 - 241s - loss: 0.1999 - accuracy: 0.9043 - val_loss: 0.6760 - val_accuracy: 0.7199
Confusion matrix: 
 [[401 172]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.7 0.3]
 [0.  1. ]]
Validation f1: 32.28
Validation accuracy: 71.99
Validation recall: 100.00
Validation precision: 19.25
Validation AUC: 0.6796577645262196
Validation class accuracies: [0.699825479930192, 1.0]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 11 epochs
Epoch 16/65
170/170 - 241s - loss: 0.1546 - accuracy: 0.9227 - val_loss: 0.3132 - val_accuracy: 0.8941
Confusion matrix: 
 [[522  51]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.341 0.659]]
Validation f1: 45.38
Validation accuracy: 89.41
Validation recall: 65.85
Validation precision: 34.62
Validation AUC: 0.5445250116716164
Validation class accuracies: [0.9109947643979057, 0.6585365853658537]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 17/65
170/170 - 241s - loss: 0.1253 - accuracy: 0.9385 - val_loss: 0.4503 - val_accuracy: 0.8599
Confusion matrix: 
 [[491  82]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.857 0.143]
 [0.098 0.902]]
Validation f1: 46.25
Validation accuracy: 85.99
Validation recall: 90.24
Validation precision: 31.09
Validation AUC: 0.6792475893102835
Validation class accuracies: [0.8568935427574171, 0.9024390243902439]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 13 epochs
Epoch 18/65
170/170 - 241s - loss: 0.1314 - accuracy: 0.9488 - val_loss: 0.6060 - val_accuracy: 0.7557
Confusion matrix: 
 [[424 149]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.74  0.26 ]
 [0.024 0.976]]
Validation f1: 34.78
Validation accuracy: 75.57
Validation recall: 97.56
Validation precision: 21.16
Validation AUC: 0.6587139629521301
Validation class accuracies: [0.7399650959860384, 0.975609756097561]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 14 epochs
Epoch 19/65
170/170 - 241s - loss: 0.0813 - accuracy: 0.9562 - val_loss: 0.2517 - val_accuracy: 0.9137
Confusion matrix: 
 [[533  40]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.317 0.683]]
Validation f1: 51.38
Validation accuracy: 91.37
Validation recall: 68.29
Validation precision: 41.18
Validation AUC: 0.6187302404617272
Validation class accuracies: [0.9301919720767888, 0.6829268292682927]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 15 epochs
Epoch 20/65
170/170 - 240s - loss: 0.0875 - accuracy: 0.9606 - val_loss: 0.3931 - val_accuracy: 0.8664
Confusion matrix: 
 [[495  78]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.098 0.902]]
Validation f1: 47.44
Validation accuracy: 86.64
Validation recall: 90.24
Validation precision: 32.17
Validation AUC: 0.6628085343263209
Validation class accuracies: [0.8638743455497382, 0.9024390243902439]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 16 epochs
Epoch 21/65
170/170 - 241s - loss: 0.0583 - accuracy: 0.9724 - val_loss: 0.3709 - val_accuracy: 0.8941
Confusion matrix: 
 [[515  58]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.171 0.829]]
Validation f1: 51.13
Validation accuracy: 89.41
Validation recall: 82.93
Validation precision: 36.96
Validation AUC: 0.6128717839169182
Validation class accuracies: [0.8987783595113438, 0.8292682926829268]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 17 epochs
Epoch 22/65
170/170 - 241s - loss: 0.0609 - accuracy: 0.9739 - val_loss: 0.8699 - val_accuracy: 0.7410
Confusion matrix: 
 [[416 157]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.049 0.951]]
Validation f1: 32.91
Validation accuracy: 74.10
Validation recall: 95.12
Validation precision: 19.90
Validation AUC: 0.5859935627672893
Validation class accuracies: [0.7260034904013961, 0.9512195121951219]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 23/65
170/170 - 241s - loss: 0.0743 - accuracy: 0.9713 - val_loss: 0.4404 - val_accuracy: 0.8876
Confusion matrix: 
 [[512  61]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.195 0.805]]
Validation f1: 48.89
Validation accuracy: 88.76
Validation recall: 80.49
Validation precision: 35.11
Validation AUC: 0.5786005919510828
Validation class accuracies: [0.893542757417103, 0.8048780487804879]
The validation tracker metric at 0.6097560975609756 hasn't increased by 0 in 19 epochs
Epoch 24/65
170/170 - 241s - loss: 0.0472 - accuracy: 0.9786 - val_loss: 0.4699 - val_accuracy: 0.8746
Confusion matrix: 
 [[500  73]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.098 0.902]]
Validation f1: 49.01
Validation accuracy: 87.46
Validation recall: 90.24
Validation precision: 33.64
Validation AUC: 0.6034418167820973
Validation class accuracies: [0.8726003490401396, 0.9024390243902439]

The metrics for job 4 with the best target metric are: 
Best cm: [[557  16]
 [ 16  25]]
Best normalized cm: [[0.972 0.028]
 [0.39  0.61 ]]
Best f1: 0.61
Best accuracy: 0.95
Best recall: 0.61
Best precision: 0.61
Best AUC: 0.54
Best class accuracies: [0.9720767888307156, 0.6097560975609756]
Best epoch: 4
The number of epochs since last 1% equals the patience
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_221_2b3_Ar_mc_LittC2SE_2_label_0_pred_1.png, [[0.991]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_3b4_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[0.07]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[0.077]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_224_1b1_Tc_sc_Meditron_1_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_1.png, [[0.707]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png, [[0.997]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_210_1b1_Al_sc_Meditron_3_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_203_2p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.048]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.194]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_222_1b1_Ar_sc_Meditron_3_label_0_pred_1.png, [[0.884]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_3b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.034]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_2p2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_1p5_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.046]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_1b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.104]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_211_2p3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_1p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_3b2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_1b3_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.125]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_1b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_221_2b3_Ar_mc_LittC2SE_3_label_0_pred_1.png, [[0.932]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_1p3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.022]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_222_1b1_Ar_sc_Meditron_7_label_0_pred_0.png, [[0.038]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_1b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b4_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b4_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Ll_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Pr_sc_Meditron_1_label_0_pred_1.png, [[0.957]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_1.png, [[0.758]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.175]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[0.056]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_203_2p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.271]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_211_2p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 21627
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_093315-2luonyzp/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_093315-2luonyzp/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.97865
wandb:         val_accuracy 0.87459
wandb:             _runtime 6193
wandb:           _timestamp 1624533389
wandb:                _step 173
wandb:           train_loss 0.04723
wandb:             val_loss 0.46992
wandb:           val_recall 0.90244
wandb:        val_precision 0.33636
wandb:               val_f1 0.49007
wandb:              val_auc 0.60344
wandb:                   lr 0.00013
wandb:          best_val_f1 0.60976
wandb:    best_val_accuracy 0.94788
wandb:   best_val_precision 0.60976
wandb:      best_val_recall 0.60976
wandb:             best_auc 0.53877
wandb:           best_epoch 4
wandb: Run history:
wandb:   train_accuracy ▁▃▂▃▄▅▆▄▅▆▆▇▇▆▇▇▇▇██████
wandb:     val_accuracy ████▇▇▁▄▇▆▇▆▇▆▆█▇▆█▇█▆█▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▄▃▃▃▃▃▂▂▂▂▂▂▂▁▂▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▁▁▁█▂▁▂▁▂▁▂▁▁▁▁▁▁▁▂▁▁
wandb:       val_recall ▁▁▂▅▆▅██▆███▇██▆▇█▆▇▇█▇▇
wandb:    val_precision ▁▁█▅▂▃▁▂▃▂▃▂▃▂▂▃▃▂▄▃▄▂▃▃
wandb:           val_f1 ▁▁▃█▅▅▂▃▆▄▆▄▆▄▅▆▆▅▇▆▇▅▇▇
wandb:          val_auc ▂▂▅▆▆▅▁▇▃▆▆▇▇▆█▆██▇█▇▇▇▇
wandb:               lr ██████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_093315-2luonyzp

-----------------------

 See logs at ../../new_cache/conv__2248__06_2134__v39__icbhi_pneumoniajordan_seaprated/logs/