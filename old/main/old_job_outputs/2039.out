Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2039
Description:  mixednet_wmoreconv
2021-04-06 20:40:06.697953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-06 20:40:08.976029: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-06 20:40:08.977155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-06 20:40:09.028835: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.029840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-06 20:40:09.029888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-06 20:40:09.035026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-06 20:40:09.035133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-06 20:40:09.036749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-06 20:40:09.037173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-06 20:40:09.038674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-06 20:40:09.040014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-06 20:40:09.040248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-06 20:40:09.040424: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.041518: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.042540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-06 20:40:09.045385: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-06 20:40:09.045557: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.046535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-06 20:40:09.046591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-06 20:40:09.046637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-06 20:40:09.046666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-06 20:40:09.046688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-06 20:40:09.046724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-06 20:40:09.046761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-06 20:40:09.046784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-06 20:40:09.046813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-06 20:40:09.046913: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.047969: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.048855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-06 20:40:09.048959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-06 20:40:09.811006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-06 20:40:09.811056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-06 20:40:09.811066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-06 20:40:09.811369: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.812198: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.812935: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 20:40:09.813631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-04-06 20:40:10.343497: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-06 20:40:10.343567: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-06 20:40:10.343623: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-06 20:40:10.343887: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-06 20:40:10.344798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-06 20:40:10.561406: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-06 20:40:10.564341: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-06 20:40:11.530972: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-06 20:40:11.533465: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-06 20:40:13.676965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-06 20:40:14.407481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-06 20:40:14.417957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-06 20:40:19.021143: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-06 20:40:19.021204: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-06 20:40:20.215633: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-06 20:40:20.219555: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-06 20:40:20.262510: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 611 callback api events and 607 activity events. 
2021-04-06 20:40:20.285705: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2039.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_2038___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___mixednet_wmoreconv___2039/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 128, 1250, 8)      224       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 625, 16)       2320      
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 32, 313, 32)       9248      
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 16, 157, 64)       36928     
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 8, 79, 128)        147584    
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 258       
=================================================================
Total params: 302,014
Trainable params: 301,518
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
872/872 - 368s - loss: 0.3070 - calc_accuracy: 0.6729 - val_loss: 0.3438 - val_calc_accuracy: 0.7344
Epoch 2/40
872/872 - 363s - loss: 0.2531 - calc_accuracy: 0.7351 - val_loss: 0.3508 - val_calc_accuracy: 0.7297
Epoch 3/40
872/872 - 391s - loss: 0.2328 - calc_accuracy: 0.7559 - val_loss: 0.3563 - val_calc_accuracy: 0.7122
Epoch 4/40
872/872 - 364s - loss: 0.2072 - calc_accuracy: 0.7851 - val_loss: 0.2428 - val_calc_accuracy: 0.8170
Epoch 5/40
872/872 - 362s - loss: 0.1857 - calc_accuracy: 0.8120 - val_loss: 0.2321 - val_calc_accuracy: 0.8307
Epoch 6/40
872/872 - 363s - loss: 0.1695 - calc_accuracy: 0.8283 - val_loss: 0.2382 - val_calc_accuracy: 0.8345
Epoch 7/40
872/872 - 352s - loss: 0.1579 - calc_accuracy: 0.8394 - val_loss: 0.2697 - val_calc_accuracy: 0.7921
Epoch 8/40
872/872 - 361s - loss: 0.1467 - calc_accuracy: 0.8540 - val_loss: 0.2084 - val_calc_accuracy: 0.8537
Epoch 9/40
872/872 - 380s - loss: 0.1390 - calc_accuracy: 0.8604 - val_loss: 0.1902 - val_calc_accuracy: 0.8729
Epoch 10/40
872/872 - 364s - loss: 0.1278 - calc_accuracy: 0.8752 - val_loss: 0.2239 - val_calc_accuracy: 0.8485
Epoch 11/40
872/872 - 355s - loss: 0.1229 - calc_accuracy: 0.8741 - val_loss: 0.2320 - val_calc_accuracy: 0.8394
Epoch 12/40
872/872 - 354s - loss: 0.1109 - calc_accuracy: 0.8910 - val_loss: 0.1956 - val_calc_accuracy: 0.8707

Epoch 00012: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 13/40
872/872 - 353s - loss: 0.0970 - calc_accuracy: 0.9058 - val_loss: 0.1853 - val_calc_accuracy: 0.8727
Epoch 14/40
872/872 - 401s - loss: 0.0845 - calc_accuracy: 0.9148 - val_loss: 0.1982 - val_calc_accuracy: 0.8695
Epoch 15/40
872/872 - 361s - loss: 0.0774 - calc_accuracy: 0.9210 - val_loss: 0.1784 - val_calc_accuracy: 0.8916
Epoch 16/40
872/872 - 359s - loss: 0.0734 - calc_accuracy: 0.9263 - val_loss: 0.1950 - val_calc_accuracy: 0.8795
Epoch 17/40
872/872 - 357s - loss: 0.0645 - calc_accuracy: 0.9367 - val_loss: 0.1834 - val_calc_accuracy: 0.8829
Epoch 18/40
872/872 - 357s - loss: 0.0589 - calc_accuracy: 0.9391 - val_loss: 0.1784 - val_calc_accuracy: 0.8973
Epoch 19/40
872/872 - 359s - loss: 0.0514 - calc_accuracy: 0.9494 - val_loss: 0.1881 - val_calc_accuracy: 0.8910
Epoch 20/40
872/872 - 377s - loss: 0.0494 - calc_accuracy: 0.9497 - val_loss: 0.1988 - val_calc_accuracy: 0.8853
Epoch 21/40
872/872 - 363s - loss: 0.0433 - calc_accuracy: 0.9553 - val_loss: 0.2014 - val_calc_accuracy: 0.8913

Epoch 00021: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 22/40
872/872 - 361s - loss: 0.0371 - calc_accuracy: 0.9619 - val_loss: 0.1936 - val_calc_accuracy: 0.8922
Epoch 23/40
872/872 - 360s - loss: 0.0345 - calc_accuracy: 0.9681 - val_loss: 0.1974 - val_calc_accuracy: 0.8951
Epoch 24/40
872/872 - 362s - loss: 0.0339 - calc_accuracy: 0.9684 - val_loss: 0.1884 - val_calc_accuracy: 0.8979
Epoch 00024: early stopping

 See logs at ../../cache/conv___04_2038___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___mixednet_wmoreconv___2039/logs/