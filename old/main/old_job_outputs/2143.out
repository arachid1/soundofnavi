Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2143
Description:  mod9_ls04
2021-05-16 17:41:24.225347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-16 17:41:26.819400: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-16 17:41:26.820515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-16 17:41:26.873957: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:26.874765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-16 17:41:26.874799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-16 17:41:26.878595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-16 17:41:26.878707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-16 17:41:26.879878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-16 17:41:26.880180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-16 17:41:26.881288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-16 17:41:26.882250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-16 17:41:26.882410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-16 17:41:26.882574: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:26.883453: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:26.884208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2143.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2143__05_1741__v29__mod9_ls04/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2143
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2obcaro7
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210516_174127-2obcaro7
wandb: Run `wandb offline` to turn off syncing.
2021-05-16 17:41:33.107601: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-16 17:41:33.107929: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:33.109072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-16 17:41:33.109158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-16 17:41:33.109242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-16 17:41:33.109276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-16 17:41:33.109308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-16 17:41:33.109340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-16 17:41:33.109371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-16 17:41:33.109403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-16 17:41:33.109435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-16 17:41:33.109585: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:33.110798: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:33.111851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-16 17:41:33.111935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-16 17:41:33.893793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-16 17:41:33.893851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-16 17:41:33.893864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-16 17:41:33.894166: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:33.895085: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:33.895883: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 17:41:33.896617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-16 17:42:17.521662: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-16 17:42:17.523687: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-16 17:42:21.216828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-16 17:42:22.130051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-16 17:42:22.140603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
binary
Epoch 1/80
263/263 - 516s - loss: 0.7049 - accuracy: 0.7007 - val_loss: 0.7375 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23796402668143735
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
263/263 - 507s - loss: 0.6569 - accuracy: 0.7216 - val_loss: 0.6410 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1852892645837065
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
263/263 - 507s - loss: 0.6558 - accuracy: 0.7178 - val_loss: 0.6286 - val_accuracy: 0.7996
Confusion matrix: 
 [[869   1]
 [217   1]]
Validation f1: 0.91
Validation accuracy: 79.96
Validation recall: 0.46
Validation precision: 50.00
Validation AUC: 0.2228627764015909
Validation class accuracies: [0.9988505747126437, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.009090909090909092
column_sums: [1086    2]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
263/263 - 508s - loss: 0.6551 - accuracy: 0.7197 - val_loss: 0.9838 - val_accuracy: 0.4899
Confusion matrix: 
 [[433 437]
 [118 100]]
Validation f1: 26.49
Validation accuracy: 48.99
Validation recall: 45.87
Validation precision: 18.62
Validation AUC: 0.19942211803013415
Validation class accuracies: [0.49770114942528737, 0.45871559633027525]
TARGET: 1
target metric(test f1): 0.2649006622516556
column_sums: [551 537]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 5/80
263/263 - 509s - loss: 0.6529 - accuracy: 0.7247 - val_loss: 0.6690 - val_accuracy: 0.7105
Confusion matrix: 
 [[738 132]
 [183  35]]
Validation f1: 18.18
Validation accuracy: 71.05
Validation recall: 16.06
Validation precision: 20.96
Validation AUC: 0.22066183885247193
Validation class accuracies: [0.8482758620689655, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [921 167]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2649006622516556 hasn't increased by 0 in 1 epochs
Epoch 6/80
263/263 - 509s - loss: 0.6533 - accuracy: 0.7243 - val_loss: 0.6352 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17588824677823095
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
263/263 - 508s - loss: 0.6540 - accuracy: 0.7200 - val_loss: 1.1456 - val_accuracy: 0.7794
Confusion matrix: 
 [[841  29]
 [211   7]]
Validation f1: 5.51
Validation accuracy: 77.94
Validation recall: 3.21
Validation precision: 19.44
Validation AUC: 0.2387360598985099
Validation class accuracies: [0.9666666666666667, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.05511811023622047
column_sums: [1052   36]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
263/263 - 508s - loss: 0.6527 - accuracy: 0.7233 - val_loss: 0.6321 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19197501850303528
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
263/263 - 510s - loss: 0.6501 - accuracy: 0.7252 - val_loss: 0.6328 - val_accuracy: 0.7987
Confusion matrix: 
 [[867   3]
 [216   2]]
Validation f1: 1.79
Validation accuracy: 79.87
Validation recall: 0.92
Validation precision: 40.00
Validation AUC: 0.18620269530637118
Validation class accuracies: [0.996551724137931, 0.009174311926605505]
TARGET: 1
target metric(test f1): 0.017937219730941704
column_sums: [1083    5]
cm_sum: 1088
The training is defaulting to either class.
Epoch 10/80
263/263 - 509s - loss: 0.6501 - accuracy: 0.7266 - val_loss: 0.6296 - val_accuracy: 0.7969
Confusion matrix: 
 [[865   5]
 [216   2]]
Validation f1: 1.78
Validation accuracy: 79.69
Validation recall: 0.92
Validation precision: 28.57
Validation AUC: 0.20322845568943362
Validation class accuracies: [0.9942528735632183, 0.009174311926605505]
TARGET: 1
target metric(test f1): 0.017777777777777778
column_sums: [1081    7]
cm_sum: 1088
The training is defaulting to either class.
Epoch 11/80
263/263 - 507s - loss: 0.6492 - accuracy: 0.7286 - val_loss: 0.6505 - val_accuracy: 0.7996
Confusion matrix: 
 [[869   1]
 [217   1]]
Validation f1: 0.91
Validation accuracy: 79.96
Validation recall: 0.46
Validation precision: 50.00
Validation AUC: 0.2195152147753503
Validation class accuracies: [0.9988505747126437, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.009090909090909092
column_sums: [1086    2]
cm_sum: 1088
The training is defaulting to either class.
Epoch 12/80
263/263 - 508s - loss: 0.6491 - accuracy: 0.7255 - val_loss: 0.6305 - val_accuracy: 0.7941
Confusion matrix: 
 [[862   8]
 [216   2]]
Validation f1: 1.75
Validation accuracy: 79.41
Validation recall: 0.92
Validation precision: 20.00
Validation AUC: 0.21420077964567552
Validation class accuracies: [0.9908045977011494, 0.009174311926605505]
TARGET: 1
target metric(test f1): 0.017543859649122806
column_sums: [1078   10]
cm_sum: 1088
The training is defaulting to either class.
Epoch 13/80
263/263 - 508s - loss: 0.6472 - accuracy: 0.7314 - val_loss: 0.6343 - val_accuracy: 0.7950
Confusion matrix: 
 [[860  10]
 [213   5]]
Validation f1: 4.29
Validation accuracy: 79.50
Validation recall: 2.29
Validation precision: 33.33
Validation AUC: 0.22413316030139563
Validation class accuracies: [0.9885057471264368, 0.022935779816513763]
TARGET: 1
target metric(test f1): 0.04291845493562232
column_sums: [1073   15]
cm_sum: 1088
The training is defaulting to either class.
Epoch 14/80
263/263 - 510s - loss: 0.6455 - accuracy: 0.7390 - val_loss: 0.6397 - val_accuracy: 0.7822
Confusion matrix: 
 [[844  26]
 [211   7]]
Validation f1: 5.58
Validation accuracy: 78.22
Validation recall: 3.21
Validation precision: 21.21
Validation AUC: 0.20910310442448765
Validation class accuracies: [0.9701149425287356, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.05577689243027889
column_sums: [1055   33]
cm_sum: 1088
The training is defaulting to either class.
Epoch 15/80
263/263 - 508s - loss: 0.6448 - accuracy: 0.7376 - val_loss: 0.6698 - val_accuracy: 0.6857
Confusion matrix: 
 [[695 175]
 [167  51]]
Validation f1: 22.97
Validation accuracy: 68.57
Validation recall: 23.39
Validation precision: 22.57
Validation AUC: 0.22640424147302013
Validation class accuracies: [0.7988505747126436, 0.23394495412844038]
TARGET: 1
target metric(test f1): 0.22972972972972974
column_sums: [862 226]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2649006622516556 hasn't increased by 0 in 2 epochs
Epoch 16/80
263/263 - 508s - loss: 0.6456 - accuracy: 0.7407 - val_loss: 0.6754 - val_accuracy: 0.7362
Confusion matrix: 
 [[777  93]
 [194  24]]
Validation f1: 14.33
Validation accuracy: 73.62
Validation recall: 11.01
Validation precision: 20.51
Validation AUC: 0.22959161655752858
Validation class accuracies: [0.8931034482758621, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.14328358208955225
column_sums: [971 117]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2649006622516556 hasn't increased by 0 in 3 epochs
Epoch 17/80
263/263 - 508s - loss: 0.6427 - accuracy: 0.7405 - val_loss: 0.6333 - val_accuracy: 0.7812
Confusion matrix: 
 [[844  26]
 [212   6]]
Validation f1: 4.80
Validation accuracy: 78.12
Validation recall: 2.75
Validation precision: 18.75
Validation AUC: 0.22618189062191893
Validation class accuracies: [0.9701149425287356, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.048
column_sums: [1056   32]
cm_sum: 1088
The training is defaulting to either class.
Epoch 18/80
263/263 - 508s - loss: 0.6421 - accuracy: 0.7431 - val_loss: 0.6368 - val_accuracy: 0.7748
Confusion matrix: 
 [[823  47]
 [198  20]]
Validation f1: 14.04
Validation accuracy: 77.48
Validation recall: 9.17
Validation precision: 29.85
Validation AUC: 0.2349952591725441
Validation class accuracies: [0.9459770114942528, 0.09174311926605505]
TARGET: 1
target metric(test f1): 0.14035087719298248
column_sums: [1021   67]
cm_sum: 1088
The training is defaulting to either class.
Epoch 19/80
263/263 - 508s - loss: 0.6388 - accuracy: 0.7457 - val_loss: 0.6749 - val_accuracy: 0.7307
Confusion matrix: 
 [[764 106]
 [187  31]]
Validation f1: 17.46
Validation accuracy: 73.07
Validation recall: 14.22
Validation precision: 22.63
Validation AUC: 0.24255535126962996
Validation class accuracies: [0.8781609195402299, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.17464788732394368
column_sums: [951 137]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.2649006622516556 hasn't increased by 0 in 4 epochs
Epoch 20/80
263/263 - 507s - loss: 0.6307 - accuracy: 0.7676 - val_loss: 0.6607 - val_accuracy: 0.7371
Confusion matrix: 
 [[773  97]
 [189  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.86
Validation accuracy: 73.71
Validation recall: 13.30
Validation precision: 23.02
Validation AUC: 0.21181739954811155
Validation class accuracies: [0.8885057471264368, 0.13302752293577982]
TARGET: 1
target metric(test f1): 0.1686046511627907
column_sums: [962 126]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2649006622516556 hasn't increased by 0 in 5 epochs
Epoch 21/80
263/263 - 508s - loss: 0.6273 - accuracy: 0.7714 - val_loss: 0.6673 - val_accuracy: 0.7252
Confusion matrix: 
 [[758 112]
 [187  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.17
Validation accuracy: 72.52
Validation recall: 14.22
Validation precision: 21.68
Validation AUC: 0.22863400823622143
Validation class accuracies: [0.871264367816092, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.17174515235457063
column_sums: [945 143]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2649006622516556 hasn't increased by 0 in 6 epochs
Epoch 22/80
263/263 - 508s - loss: 0.6239 - accuracy: 0.7779 - val_loss: 0.6788 - val_accuracy: 0.7123
Confusion matrix: 
 [[736 134]
 [179  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 19.95
Validation accuracy: 71.23
Validation recall: 17.89
Validation precision: 22.54
Validation AUC: 0.21899491494971157
Validation class accuracies: [0.8459770114942529, 0.17889908256880735]
TARGET: 1
target metric(test f1): 0.1994884910485934
column_sums: [915 173]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2649006622516556 hasn't increased by 0 in 7 epochs
Epoch 23/80
263/263 - 509s - loss: 0.6205 - accuracy: 0.7836 - val_loss: 0.6848 - val_accuracy: 0.7040
Confusion matrix: 
 [[705 165]
 [157  61]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.48
Validation accuracy: 70.40
Validation recall: 27.98
Validation precision: 26.99
Validation AUC: 0.23370606709039413
Validation class accuracies: [0.8103448275862069, 0.2798165137614679]
TARGET: 1
target metric(test f1): 0.27477477477477474
column_sums: [862 226]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 24/80
263/263 - 508s - loss: 0.6177 - accuracy: 0.7879 - val_loss: 0.6908 - val_accuracy: 0.7086
Confusion matrix: 
 [[742 128]
 [189  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.47
Validation accuracy: 70.86
Validation recall: 13.30
Validation precision: 18.47
Validation AUC: 0.21260627098926188
Validation class accuracies: [0.8528735632183908, 0.13302752293577982]
TARGET: 1
target metric(test f1): 0.15466666666666667
column_sums: [931 157]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 1 epochs
Epoch 25/80
263/263 - 508s - loss: 0.6159 - accuracy: 0.7967 - val_loss: 0.6812 - val_accuracy: 0.7096
Confusion matrix: 
 [[719 151]
 [165  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.12
Validation accuracy: 70.96
Validation recall: 24.31
Validation precision: 25.98
Validation AUC: 0.23236376831020678
Validation class accuracies: [0.8264367816091954, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.25118483412322273
column_sums: [884 204]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 2 epochs
Epoch 26/80
263/263 - 507s - loss: 0.6118 - accuracy: 0.8053 - val_loss: 0.6850 - val_accuracy: 0.7215
Confusion matrix: 
 [[752 118]
 [185  33]]
Validation f1: 17.89
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 72.15
Validation recall: 15.14
Validation precision: 21.85
Validation AUC: 0.20453467458961339
Validation class accuracies: [0.864367816091954, 0.15137614678899083]
TARGET: 1
target metric(test f1): 0.1788617886178862
column_sums: [937 151]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 3 epochs
Epoch 27/80
263/263 - 509s - loss: 0.6076 - accuracy: 0.8170 - val_loss: 0.6735 - val_accuracy: 0.7546
Confusion matrix: 
 [[804  66]
 [201  17]]
Validation f1: 11.30
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 75.46
Validation recall: 7.80
Validation precision: 20.48
Validation AUC: 0.20981052542829406
Validation class accuracies: [0.9241379310344827, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.11295681063122925
column_sums: [1005   83]
cm_sum: 1088
The training is defaulting to either class.
Epoch 28/80
263/263 - 508s - loss: 0.6062 - accuracy: 0.8153 - val_loss: 0.6955 - val_accuracy: 0.7279
Confusion matrix: 
 [[760 110]
 [186  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.78
Validation accuracy: 72.79
Validation recall: 14.68
Validation precision: 22.54
Validation AUC: 0.21244289480899708
Validation class accuracies: [0.8735632183908046, 0.14678899082568808]
TARGET: 1
target metric(test f1): 0.17777777777777778
column_sums: [946 142]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 4 epochs
Epoch 29/80
263/263 - 507s - loss: 0.5973 - accuracy: 0.8325 - val_loss: 0.7049 - val_accuracy: 0.6994
Confusion matrix: 
 [[710 160]
 [167  51]]
Validation f1: 23.78
Validation accuracy: 69.94
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 23.39
Validation precision: 24.17
Validation AUC: 0.22076395701649928
Validation class accuracies: [0.8160919540229885, 0.23394495412844038]
TARGET: 1
target metric(test f1): 0.23776223776223776
column_sums: [877 211]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 5 epochs
Epoch 30/80
263/263 - 508s - loss: 0.5954 - accuracy: 0.8341 - val_loss: 0.6994 - val_accuracy: 0.7022
Confusion matrix: 
 [[721 149]
 [175  43]]
Validation f1: 20.98
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 70.22
Validation recall: 19.72
Validation precision: 22.40
Validation AUC: 0.21705302486688055
Validation class accuracies: [0.828735632183908, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.20975609756097563
column_sums: [896 192]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 6 epochs
Epoch 31/80
263/263 - 508s - loss: 0.5935 - accuracy: 0.8422 - val_loss: 0.7000 - val_accuracy: 0.6976
Confusion matrix: 
 [[721 149]
 [180  38]]
Validation f1: 18.77
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 69.76
Validation recall: 17.43
Validation precision: 20.32
Validation AUC: 0.21418090867192607
Validation class accuracies: [0.828735632183908, 0.1743119266055046]
TARGET: 1
target metric(test f1): 0.18765432098765436
column_sums: [901 187]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 7 epochs
Epoch 32/80
263/263 - 509s - loss: 0.5921 - accuracy: 0.8475 - val_loss: 0.6949 - val_accuracy: 0.7031
Confusion matrix: 
 [[724 146]
 [177  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 20.25
Validation accuracy: 70.31
Validation recall: 18.81
Validation precision: 21.93
Validation AUC: 0.2179009461225594
Validation class accuracies: [0.832183908045977, 0.18807339449541285]
TARGET: 1
target metric(test f1): 0.20246913580246914
column_sums: [901 187]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 8 epochs
Epoch 33/80
263/263 - 508s - loss: 0.5899 - accuracy: 0.8494 - val_loss: 0.7141 - val_accuracy: 0.6774
Confusion matrix: 
 [[682 188]
 [163  55]]
Validation f1: 23.86
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 67.74
Validation recall: 25.23
Validation precision: 22.63
Validation AUC: 0.2182715325864893
Validation class accuracies: [0.7839080459770115, 0.25229357798165136]
TARGET: 1
target metric(test f1): 0.23861171366594358
column_sums: [845 243]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 9 epochs
Epoch 34/80
263/263 - 508s - loss: 0.5887 - accuracy: 0.8508 - val_loss: 0.7204 - val_accuracy: 0.6710
Confusion matrix: 
 [[670 200]
 [158  60]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.10
Validation accuracy: 67.10
Validation recall: 27.52
Validation precision: 23.08
Validation AUC: 0.2175466318715751
Validation class accuracies: [0.7701149425287356, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.25104602510460255
column_sums: [828 260]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 10 epochs
Epoch 35/80
263/263 - 508s - loss: 0.5905 - accuracy: 0.8465 - val_loss: 0.7108 - val_accuracy: 0.6801
Confusion matrix: 
 [[684 186]
 [162  56]]
Validation f1: 24.35
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.01
Validation recall: 25.69
Validation precision: 23.14
Validation AUC: 0.21901574923051237
Validation class accuracies: [0.7862068965517242, 0.25688073394495414]
TARGET: 1
target metric(test f1): 0.24347826086956523
column_sums: [846 242]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 11 epochs
Epoch 36/80
263/263 - 507s - loss: 0.5906 - accuracy: 0.8463 - val_loss: 0.7107 - val_accuracy: 0.6847
Confusion matrix: 
 [[692 178]
 [165  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.61
Validation accuracy: 68.47
Validation recall: 24.31
Validation precision: 22.94
Validation AUC: 0.21859134773201755
Validation class accuracies: [0.7954022988505747, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.2360801781737194
column_sums: [857 231]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 12 epochs
Epoch 37/80
263/263 - 508s - loss: 0.5901 - accuracy: 0.8515 - val_loss: 0.7122 - val_accuracy: 0.6811
Confusion matrix: 
 [[690 180]
 [167  51]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 22.72
Validation accuracy: 68.11
Validation recall: 23.39
Validation precision: 22.08
Validation AUC: 0.21902957074857637
Validation class accuracies: [0.7931034482758621, 0.23394495412844038]
TARGET: 1
target metric(test f1): 0.22717149220489977
column_sums: [857 231]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 13 epochs
Epoch 38/80
263/263 - 508s - loss: 0.5907 - accuracy: 0.8501 - val_loss: 0.7152 - val_accuracy: 0.6811
Confusion matrix: 
 [[687 183]
 [164  54]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.74
Validation accuracy: 68.11
Validation recall: 24.77
Validation precision: 22.78
Validation AUC: 0.21738215564068153
Validation class accuracies: [0.7896551724137931, 0.24770642201834864]
TARGET: 1
target metric(test f1): 0.23736263736263738
column_sums: [851 237]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 14 epochs
Epoch 39/80
263/263 - 507s - loss: 0.5900 - accuracy: 0.8429 - val_loss: 0.7127 - val_accuracy: 0.6847
Confusion matrix: 
 [[694 176]
 [167  51]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 22.92
Validation accuracy: 68.47
Validation recall: 23.39
Validation precision: 22.47
Validation AUC: 0.21914684929588876
Validation class accuracies: [0.7977011494252874, 0.23394495412844038]
TARGET: 1
target metric(test f1): 0.22921348314606743
column_sums: [861 227]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 15 epochs
Epoch 40/80
263/263 - 508s - loss: 0.5898 - accuracy: 0.8503 - val_loss: 0.7228 - val_accuracy: 0.6673
Confusion matrix: 
 [[665 205]
 [157  61]]
Validation f1: 25.21
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 66.73
Validation recall: 27.98
Validation precision: 22.93
Validation AUC: 0.217331781984397
Validation class accuracies: [0.764367816091954, 0.2798165137614679]
TARGET: 1
target metric(test f1): 0.25206611570247933
column_sums: [822 266]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 16 epochs
Epoch 41/80
263/263 - 507s - loss: 0.5876 - accuracy: 0.8522 - val_loss: 0.7272 - val_accuracy: 0.6618
Confusion matrix: 
 [[658 212]
 [156  62]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.20
Validation accuracy: 66.18
Validation recall: 28.44
Validation precision: 22.63
Validation AUC: 0.2175740298046097
Validation class accuracies: [0.7563218390804598, 0.28440366972477066]
TARGET: 1
target metric(test f1): 0.25203252032520324
column_sums: [814 274]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 17 epochs
Epoch 42/80
263/263 - 508s - loss: 0.5889 - accuracy: 0.8508 - val_loss: 0.7140 - val_accuracy: 0.6801
Confusion matrix: 
 [[686 184]
 [164  54]]
Validation f1: 23.68
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.01
Validation recall: 24.77
Validation precision: 22.69
Validation AUC: 0.217892117795004
Validation class accuracies: [0.7885057471264367, 0.24770642201834864]
TARGET: 1
target metric(test f1): 0.23684210526315788
column_sums: [850 238]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 18 epochs
Epoch 43/80
263/263 - 507s - loss: 0.5878 - accuracy: 0.8561 - val_loss: 0.7230 - val_accuracy: 0.6654
Confusion matrix: 
 [[665 205]
 [159  59]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.48
Validation accuracy: 66.54
Validation recall: 27.06
Validation precision: 22.35
Validation AUC: 0.21746426041182862
Validation class accuracies: [0.764367816091954, 0.2706422018348624]
TARGET: 1
target metric(test f1): 0.24481327800829877
column_sums: [824 264]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 19 epochs
Epoch 44/80
263/263 - 508s - loss: 0.5901 - accuracy: 0.8482 - val_loss: 0.7132 - val_accuracy: 0.6820
Confusion matrix: 
 [[690 180]
 [166  52]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.11
Validation accuracy: 68.20
Validation recall: 23.85
Validation precision: 22.41
Validation AUC: 0.21877716084501525
Validation class accuracies: [0.7931034482758621, 0.23853211009174313]
TARGET: 1
target metric(test f1): 0.2311111111111111
column_sums: [856 232]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 20 epochs
Epoch 45/80
263/263 - 508s - loss: 0.5886 - accuracy: 0.8527 - val_loss: 0.7233 - val_accuracy: 0.6654
Confusion matrix: 
 [[667 203]
 [161  57]]
Validation f1: 23.85
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 66.54
Validation recall: 26.15
Validation precision: 21.92
Validation AUC: 0.2170892482864989
Validation class accuracies: [0.7666666666666667, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.23849372384937237
column_sums: [828 260]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 21 epochs
Epoch 46/80
263/263 - 508s - loss: 0.5880 - accuracy: 0.8484 - val_loss: 0.7225 - val_accuracy: 0.6682
Confusion matrix: 
 [[667 203]
 [158  60]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.95
Validation accuracy: 66.82
Validation recall: 27.52
Validation precision: 22.81
Validation AUC: 0.21722076901705992
Validation class accuracies: [0.7666666666666667, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.24948024948024944
column_sums: [825 263]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 22 epochs
Epoch 47/80
263/263 - 508s - loss: 0.5889 - accuracy: 0.8541 - val_loss: 0.7250 - val_accuracy: 0.6627
Confusion matrix: 
 [[659 211]
 [156  62]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.25
Validation accuracy: 66.27
Validation recall: 28.44
Validation precision: 22.71
Validation AUC: 0.2171315824820556
Validation class accuracies: [0.7574712643678161, 0.28440366972477066]
TARGET: 1
target metric(test f1): 0.2525458248472505
column_sums: [815 273]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 23 epochs
Epoch 48/80
263/263 - 508s - loss: 0.5879 - accuracy: 0.8553 - val_loss: 0.7166 - val_accuracy: 0.6811
Confusion matrix: 
 [[684 186]
 [161  57]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.73
Validation accuracy: 68.11
Validation recall: 26.15
Validation precision: 23.46
Validation AUC: 0.217887080947206
Validation class accuracies: [0.7862068965517242, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.2472885032537961
column_sums: [845 243]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.103515914901436e-08
The validation tracker metric at 0.27477477477477474 hasn't increased by 0 in 24 epochs
Epoch 49/80
263/263 - 508s - loss: 0.5882 - accuracy: 0.8503 - val_loss: 0.7244 - val_accuracy: 0.6645
Confusion matrix: 
 [[664 206]
 [159  59]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.43
Validation accuracy: 66.45
Validation recall: 27.06
Validation precision: 22.26
Validation AUC: 0.2163477809473981
Validation class accuracies: [0.7632183908045977, 0.2706422018348624]

The metrics for the epoch with the best target metric are: 
Best cm: [[705 165]
 [157  61]]
Best f1: 0.27477477477477474
Best accuracy: 0.7040441176470589
Best recall: 0.2798165137614679
Best precision: 0.26991150442477874
Best AUC: 0.23370606709039413
Best epoch: 23
TARGET: 1
target metric(test f1): 0.2443064182194617
column_sums: [823 265]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 23
Starting...
CM: [[26 34]
 [ 2 13]]
F1: 0.4193548387096774
AUC: 0.5849645390070922
Accuracy: 0.52
Precision: 0.2765957446808511
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2143__05_1741__v29__mod9_ls04/validation_sheet_23.xls...
Done.
Epoch: 4
Starting...
CM: [[ 0 60]
 [ 1 14]]
F1: 0.3146067415730337
AUC: 0.5679279279279279
Accuracy: 0.18666666666666668
Precision: 0.1891891891891892
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2143__05_1741__v29__mod9_ls04/validation_sheet_4.xls...
Done.
Epoch: 80
Starting...
CM: [[22 38]
 [ 2 13]]
F1: 0.3939393939393939
AUC: 0.5741176470588236
Accuracy: 0.4666666666666667
Precision: 0.2549019607843137
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2143__05_1741__v29__mod9_ls04/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 1326
wandb: Program ended successfully.
wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210516_174127-2obcaro7/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210516_174127-2obcaro7/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.85033
wandb:         val_accuracy 0.66452
wandb:             _runtime 26180
wandb:           _timestamp 1621213067
wandb:                _step 349
wandb:           train_loss 0.58819
wandb:             val_loss 0.72437
wandb:           val_recall 0.27064
wandb:        val_precision 0.22264
wandb:               val_f1 0.24431
wandb:              val_auc 0.21635
wandb:                   lr 0.0
wandb:          best_val_f1 0.27477
wandb:    best_val_accuracy 0.70404
wandb:   best_val_precision 0.26991
wandb:      best_val_recall 0.27982
wandb:             best_auc 0.23371
wandb:           best_epoch 23
wandb:           best_bd_f1 0.41935
wandb:          best_bd_auc 0.58496
wandb:     best_bd_accuracy 0.52
wandb:    best_bd_precision 0.2766
wandb:       best_bd_recall 0.86667
wandb:        best_bd_epoch 23
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▂▂▂▂▂▂▃▃▃▃▃▄▄▅▅▅▆▆▇▇▇█████▇████████
wandb:     val_accuracy ███▁▆███████▅█▇▆▇▆▆▆▆▆▆▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▅▅▅▅▅▅▅▅▄▄▄▄▄▄▃▃▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▁▆▂█▁▁▁▁▁▁▂▁▁▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ▁▁▁█▃▁▁▁▁▁▁▁▅▁▂▃▃▃▅▃▅▃▃▅▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:    val_precision ▁▁█▄▄▄▁▇▅▄▆▄▄▄▅▄▄▄▅▄▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:           val_f1 ▁▁▁█▆▂▁▁▁▁▂▂▇▂▅▅▅▅█▅▇▆▆▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▇▁▆▃▅█▂▁▃▅▆▄▆▆▇█▄▆▇▄▇▃▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:               lr ████████████████▃▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 7 media file(s), 5 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2143: https://wandb.ai/arachid1/tensorboard-integration/runs/2obcaro7


 See logs at ../../new_cache/conv__2143__05_1741__v29__mod9_ls04/logs/