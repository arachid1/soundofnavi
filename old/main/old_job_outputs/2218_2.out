Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2218
Description:  redo
2021-06-15 18:05:36.144738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-15 18:05:38.365961: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-15 18:05:38.366851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-15 18:05:38.379794: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:38.380464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-15 18:05:38.380489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 18:05:38.383742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 18:05:38.383825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-15 18:05:38.384845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-15 18:05:38.385137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-15 18:05:38.386082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-15 18:05:38.386930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-15 18:05:38.387088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 18:05:38.387200: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:38.387985: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:38.388676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2218.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2218__06_1805__v39__redo
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 50, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-15 18:05:43.096129: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-15 18:05:43.096368: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:43.097072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-15 18:05:43.097113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 18:05:43.097162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 18:05:43.097182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-15 18:05:43.097201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-15 18:05:43.097219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-15 18:05:43.097237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-15 18:05:43.097255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-15 18:05:43.097272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 18:05:43.097359: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:43.098107: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:43.098861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-15 18:05:43.098916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 18:05:43.810518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-15 18:05:43.810559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-15 18:05:43.810567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-15 18:05:43.810863: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:43.811690: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:43.812389: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:05:43.813019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-15 18:05:45.096016: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-15 18:05:45.097741: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-15 18:05:45.444736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 18:05:47.293018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 18:05:47.746801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/50
151/151 - 219s - loss: 0.8748 - accuracy: 0.6904 - val_loss: 0.3719 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.04806427126620856
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/50
151/151 - 218s - loss: 0.5670 - accuracy: 0.7670 - val_loss: 0.2783 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.056960713061623654
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/50
151/151 - 218s - loss: 0.4313 - accuracy: 0.7699 - val_loss: 0.2092 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07100439662004865
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/50
151/151 - 218s - loss: 0.4097 - accuracy: 0.7959 - val_loss: 0.2577 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09073906590455033
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 4 epochs
Epoch 5/50
151/151 - 218s - loss: 0.3472 - accuracy: 0.8448 - val_loss: 0.3032 - val_accuracy: 0.8810
Confusion matrix: 
 [[510  63]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.281 0.719]]
Validation f1: 38.98
Validation accuracy: 88.10
Validation recall: 71.88
Validation precision: 26.74
Validation AUC: 0.4930848596039728
Validation class accuracies: [0.8900523560209425, 0.71875]
Saving model...
Epoch 6/50
151/151 - 218s - loss: 0.3189 - accuracy: 0.8539 - val_loss: 0.7705 - val_accuracy: 0.7025
Confusion matrix: 
 [[400 173]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.698 0.302]
 [0.219 0.781]]
Validation f1: 21.74
Validation accuracy: 70.25
Validation recall: 78.12
Validation precision: 12.63
Validation AUC: 0.5206606972679497
Validation class accuracies: [0.6980802792321117, 0.78125]
The validation tracker metric at 0.38983050847457623 hasn't increased by 0 in 1 epochs
Epoch 7/50
151/151 - 218s - loss: 0.2667 - accuracy: 0.8738 - val_loss: 0.4120 - val_accuracy: 0.7802
Confusion matrix: 
 [[454 119]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.438 0.562]]
Validation f1: 21.30
Validation accuracy: 78.02
Validation recall: 56.25
Validation precision: 13.14
Validation AUC: 0.21458426142892134
Validation class accuracies: [0.7923211169284468, 0.5625]
The validation tracker metric at 0.38983050847457623 hasn't increased by 0 in 2 epochs
Epoch 8/50
151/151 - 218s - loss: 0.2874 - accuracy: 0.8709 - val_loss: 0.2202 - val_accuracy: 0.9372
Confusion matrix: 
 [[555  18]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.625 0.375]]
Validation f1: 38.71
Validation accuracy: 93.72
Validation recall: 37.50
Validation precision: 40.00
Validation AUC: 0.390882159716365
Validation class accuracies: [0.9685863874345549, 0.375]
The validation tracker metric at 0.38983050847457623 hasn't increased by 0 in 3 epochs
Epoch 9/50
151/151 - 219s - loss: 0.2594 - accuracy: 0.8771 - val_loss: 0.6012 - val_accuracy: 0.8149
Confusion matrix: 
 [[469 104]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.25  0.75 ]]
Validation f1: 30.00
Validation accuracy: 81.49
Validation recall: 75.00
Validation precision: 18.75
Validation AUC: 0.4922319213478798
Validation class accuracies: [0.8184991273996509, 0.75]
The validation tracker metric at 0.38983050847457623 hasn't increased by 0 in 4 epochs
Epoch 10/50
151/151 - 219s - loss: 0.2706 - accuracy: 0.8816 - val_loss: 0.2393 - val_accuracy: 0.9322
Confusion matrix: 
 [[551  22]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.594 0.406]]
Validation f1: 38.81
Validation accuracy: 93.22
Validation recall: 40.62
Validation precision: 37.14
Validation AUC: 0.43074228485386484
Validation class accuracies: [0.9616055846422339, 0.40625]
The validation tracker metric at 0.38983050847457623 hasn't increased by 0 in 5 epochs
Epoch 11/50
151/151 - 218s - loss: 0.2400 - accuracy: 0.8816 - val_loss: 0.2380 - val_accuracy: 0.9140
Confusion matrix: 
 [[532  41]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.344 0.656]]
Validation f1: 44.68
Validation accuracy: 91.40
Validation recall: 65.62
Validation precision: 33.87
Validation AUC: 0.5369397864714097
Validation class accuracies: [0.9284467713787086, 0.65625]
Saving model...
Epoch 12/50
151/151 - 217s - loss: 0.2482 - accuracy: 0.8911 - val_loss: 0.2272 - val_accuracy: 0.9339
Confusion matrix: 
 [[545  28]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.375 0.625]]
Validation f1: 50.00
Validation accuracy: 93.39
Validation recall: 62.50
Validation precision: 41.67
Validation AUC: 0.541084444209978
Validation class accuracies: [0.9511343804537522, 0.625]
Saving model...
Epoch 13/50
151/151 - 217s - loss: 0.2241 - accuracy: 0.8945 - val_loss: 0.3371 - val_accuracy: 0.9174
Confusion matrix: 
 [[535  38]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.375 0.625]]
Validation f1: 44.44
Validation accuracy: 91.74
Validation recall: 62.50
Validation precision: 34.48
Validation AUC: 0.526611739588408
Validation class accuracies: [0.9336823734729494, 0.625]
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
Epoch 14/50
151/151 - 217s - loss: 0.2325 - accuracy: 0.9007 - val_loss: 0.9620 - val_accuracy: 0.6942
Confusion matrix: 
 [[394 179]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.688 0.312]
 [0.188 0.812]]
Validation f1: 21.94
Validation accuracy: 69.42
Validation recall: 81.25
Validation precision: 12.68
Validation AUC: 0.5244944045010828
Validation class accuracies: [0.68760907504363, 0.8125]
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
Epoch 15/50
151/151 - 217s - loss: 0.2143 - accuracy: 0.9110 - val_loss: 1.6161 - val_accuracy: 0.5702
Confusion matrix: 
 [[315 258]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.55  0.45 ]
 [0.062 0.938]]
Validation f1: 18.75
Validation accuracy: 57.02
Validation recall: 93.75
Validation precision: 10.42
Validation AUC: 0.5617594831558513
Validation class accuracies: [0.5497382198952879, 0.9375]
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
Epoch 16/50
151/151 - 217s - loss: 0.1765 - accuracy: 0.9226 - val_loss: 1.4273 - val_accuracy: 0.6926
Confusion matrix: 
 [[387 186]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.675 0.325]
 [0.    1.   ]]
Validation f1: 25.60
Validation accuracy: 69.26
Validation recall: 100.00
Validation precision: 14.68
Validation AUC: 0.3686145318019385
Validation class accuracies: [0.675392670157068, 1.0]
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
Epoch 17/50
151/151 - 218s - loss: 0.1980 - accuracy: 0.9139 - val_loss: 0.3455 - val_accuracy: 0.9256
Confusion matrix: 
 [[541  32]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.406 0.594]]
Validation f1: 45.78
Validation accuracy: 92.56
Validation recall: 59.38
Validation precision: 37.25
Validation AUC: 0.46676678024859286
Validation class accuracies: [0.944153577661431, 0.59375]
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
Epoch 18/50
151/151 - 218s - loss: 0.1316 - accuracy: 0.9458 - val_loss: 0.3377 - val_accuracy: 0.8893
Confusion matrix: 
 [[512  61]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.188 0.812]]
Validation f1: 43.70
Validation accuracy: 88.93
Validation recall: 81.25
Validation precision: 29.89
Validation AUC: 0.3886216578050061
Validation class accuracies: [0.893542757417103, 0.8125]
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 19/50
151/151 - 218s - loss: 0.1110 - accuracy: 0.9536 - val_loss: 0.2677 - val_accuracy: 0.8975
Confusion matrix: 
 [[530  43]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.594 0.406]]
Validation f1: 29.55
Validation accuracy: 89.75
Validation recall: 40.62
Validation precision: 23.21
Validation AUC: 0.27563584082879355
Validation class accuracies: [0.924956369982548, 0.40625]
The validation tracker metric at 0.5 hasn't increased by 0 in 7 epochs
Epoch 20/50
151/151 - 218s - loss: 0.1038 - accuracy: 0.9632 - val_loss: 0.4611 - val_accuracy: 0.8760
Confusion matrix: 
 [[517  56]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.902 0.098]
 [0.594 0.406]]
Validation f1: 25.74
Validation accuracy: 87.60
Validation recall: 40.62
Validation precision: 18.84
Validation AUC: 0.28504845486904895
Validation class accuracies: [0.9022687609075044, 0.40625]
The validation tracker metric at 0.5 hasn't increased by 0 in 8 epochs
Epoch 21/50
151/151 - 218s - loss: 0.0812 - accuracy: 0.9636 - val_loss: 0.7217 - val_accuracy: 0.8628
Confusion matrix: 
 [[495  78]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.156 0.844]]
Validation f1: 39.42
Validation accuracy: 86.28
Validation recall: 84.38
Validation precision: 25.71
Validation AUC: 0.508991588253192
Validation class accuracies: [0.8638743455497382, 0.84375]
The validation tracker metric at 0.5 hasn't increased by 0 in 9 epochs
Epoch 22/50
151/151 - 218s - loss: 0.0780 - accuracy: 0.9652 - val_loss: 0.2749 - val_accuracy: 0.9025
Confusion matrix: 
 [[531  42]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.531 0.469]]
Validation f1: 33.71
Validation accuracy: 90.25
Validation recall: 46.88
Validation precision: 26.32
Validation AUC: 0.45121823271163636
Validation class accuracies: [0.9267015706806283, 0.46875]
The validation tracker metric at 0.5 hasn't increased by 0 in 10 epochs
Epoch 23/50
151/151 - 221s - loss: 0.0705 - accuracy: 0.9698 - val_loss: 0.2525 - val_accuracy: 0.9455
Confusion matrix: 
 [[572   1]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 94.55
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19959990703716637
Validation class accuracies: [0.9982547993019197, 0.0]
The validation tracker metric at 0.5 hasn't increased by 0 in 11 epochs
Epoch 24/50
151/151 - 221s - loss: 0.0631 - accuracy: 0.9731 - val_loss: 0.5003 - val_accuracy: 0.8645
Confusion matrix: 
 [[504  69]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.406 0.594]]
Validation f1: 31.67
Validation accuracy: 86.45
Validation recall: 59.38
Validation precision: 21.59
Validation AUC: 0.44544305955470886
Validation class accuracies: [0.8795811518324608, 0.59375]
The validation tracker metric at 0.5 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 25/50
151/151 - 220s - loss: 0.0406 - accuracy: 0.9834 - val_loss: 0.3342 - val_accuracy: 0.8926
Confusion matrix: 
 [[526  47]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.562 0.438]]
Validation f1: 30.11
Validation accuracy: 89.26
Validation recall: 43.75
Validation precision: 22.95
Validation AUC: 0.36719836789171295
Validation class accuracies: [0.9179755671902269, 0.4375]
The validation tracker metric at 0.5 hasn't increased by 0 in 13 epochs
Epoch 26/50
151/151 - 220s - loss: 0.0520 - accuracy: 0.9826 - val_loss: 0.2526 - val_accuracy: 0.9174
Confusion matrix: 
 [[539  34]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.5   0.5  ]]
Validation f1: 39.02
Validation accuracy: 91.74
Validation recall: 50.00
Validation precision: 32.00
Validation AUC: 0.44090449493094924
Validation class accuracies: [0.9406631762652705, 0.5]
The validation tracker metric at 0.5 hasn't increased by 0 in 14 epochs
Epoch 27/50
151/151 - 219s - loss: 0.0452 - accuracy: 0.9810 - val_loss: 0.2454 - val_accuracy: 0.9355
Confusion matrix: 
 [[553  20]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.594 0.406]]
Validation f1: 40.00
Validation accuracy: 93.55
Validation recall: 40.62
Validation precision: 39.39
Validation AUC: 0.47190035166013267
Validation class accuracies: [0.9650959860383944, 0.40625]
The validation tracker metric at 0.5 hasn't increased by 0 in 15 epochs
Epoch 28/50
151/151 - 220s - loss: 0.0271 - accuracy: 0.9892 - val_loss: 0.2812 - val_accuracy: 0.9306
Confusion matrix: 
 [[550  23]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.594 0.406]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.24
Validation accuracy: 93.06
Validation recall: 40.62
Validation precision: 36.11
Validation AUC: 0.4601724237452667
Validation class accuracies: [0.9598603839441536, 0.40625]
The validation tracker metric at 0.5 hasn't increased by 0 in 16 epochs
Epoch 29/50
151/151 - 220s - loss: 0.0399 - accuracy: 0.9839 - val_loss: 0.2499 - val_accuracy: 0.9223
Confusion matrix: 
 [[546  27]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.625 0.375]]
Validation f1: 33.80
Validation accuracy: 92.23
Validation recall: 37.50
Validation precision: 30.77
Validation AUC: 0.41070297984987586
Validation class accuracies: [0.9528795811518325, 0.375]
The validation tracker metric at 0.5 hasn't increased by 0 in 17 epochs
Epoch 30/50
151/151 - 226s - loss: 0.0483 - accuracy: 0.9793 - val_loss: 0.2519 - val_accuracy: 0.9174
Confusion matrix: 
 [[542  31]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.594 0.406]]
Validation f1: 34.21
Validation accuracy: 91.74
Validation recall: 40.62
Validation precision: 29.55
Validation AUC: 0.3745504513323177
Validation class accuracies: [0.9458987783595113, 0.40625]
local_gc_exec.sh: line 6: 28268 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2218__06_1805__v39__redo/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
