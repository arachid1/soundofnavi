Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2134
Description:  mixednet_undersampled_classweights
2021-05-13 12:22:03.005717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 12:22:08.515922: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-13 12:22:08.526954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-13 12:22:08.585390: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:08.586161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-13 12:22:08.586193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 12:22:08.617866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 12:22:08.617963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 12:22:08.632406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-13 12:22:08.639749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-13 12:22:08.646454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-13 12:22:08.667616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-13 12:22:08.680726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-13 12:22:08.680907: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:08.681651: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:08.683240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2134.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2134__05_1220__v29__mixednet_undersampled_classweights/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 22, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2134
wandb: ‚≠êÔ∏è View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: üöÄ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/o41hjjum
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_122209-o41hjjum
wandb: Run `wandb offline` to turn off syncing.
2021-05-13 12:22:14.901034: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-13 12:22:14.901322: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:14.902141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-13 12:22:14.902186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 12:22:14.902240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 12:22:14.902261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 12:22:14.902282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-13 12:22:14.902301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-13 12:22:14.902321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-13 12:22:14.902341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-13 12:22:14.902360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-13 12:22:14.902455: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:14.903181: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:14.903803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-13 12:22:14.904449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 12:22:16.298022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-13 12:22:16.298068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-13 12:22:16.298078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-13 12:22:16.300087: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:16.301049: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:16.301852: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:22:16.302588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-13 12:22:51.208296: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-13 12:22:51.213303: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-13 12:22:52.846789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 12:22:54.634333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 12:22:54.659872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
1150
1150
With concat = False and six = False, size of training set: 2300...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,967
Trainable params: 105,471
Non-trainable params: 496
_________________________________________________________________
Epoch 1/80
144/144 - 102s - loss: 0.7519 - accuracy: 0.5117 - val_loss: 1.1130 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2608811777199034
Validation class accuracies: [0.0, 1.0]
TARGET: 0
target metric(test auc): 0.2608811777199034
column_sums: [   0 1088]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
144/144 - 89s - loss: 0.7136 - accuracy: 0.5035 - val_loss: 1.0875 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.26179405120236804
Validation class accuracies: [0.0, 1.0]
TARGET: 0
target metric(test auc): 0.26179405120236804
column_sums: [   0 1088]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
144/144 - 89s - loss: 0.7053 - accuracy: 0.5074 - val_loss: 0.9162 - val_accuracy: 0.2013
Confusion matrix: 
 [[  1 869]
 [  0 218]]
Validation f1: 33.41
Validation accuracy: 20.13
Validation recall: 100.00
Validation precision: 20.06
Validation AUC: 0.21012746583212938
Validation class accuracies: [0.0011494252873563218, 1.0]
TARGET: 0
target metric(test auc): 0.21012746583212938
column_sums: [   1 1087]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
144/144 - 90s - loss: 0.6882 - accuracy: 0.5187 - val_loss: 0.8207 - val_accuracy: 0.2206
Confusion matrix: 
 [[ 44 826]
 [ 22 196]]
Validation f1: 31.61
Validation accuracy: 22.06
Validation recall: 89.91
Validation precision: 19.18
Validation AUC: 0.2014921691390843
Validation class accuracies: [0.05057471264367816, 0.8990825688073395]
TARGET: 0
target metric(test auc): 0.2014921691390843
column_sums: [  66 1022]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
144/144 - 94s - loss: 0.6656 - accuracy: 0.5417 - val_loss: 0.8304 - val_accuracy: 0.3585
Confusion matrix: 
 [[214 656]
 [ 42 176]]
Validation f1: 33.52
Validation accuracy: 35.85
Validation recall: 80.73
Validation precision: 21.15
Validation AUC: 0.21863890687176385
Validation class accuracies: [0.24597701149425288, 0.8073394495412844]
TARGET: 0
target metric(test auc): 0.21863890687176385
column_sums: [256 832]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 6/80
144/144 - 94s - loss: 0.6354 - accuracy: 0.5778 - val_loss: 0.8247 - val_accuracy: 0.3336
Confusion matrix: 
 [[220 650]
 [ 75 143]]
Validation f1: 28.29
Validation accuracy: 33.36
Validation recall: 65.60
Validation precision: 18.03
Validation AUC: 0.21243149749742835
Validation class accuracies: [0.25287356321839083, 0.6559633027522935]
TARGET: 0
target metric(test auc): 0.21243149749742835
column_sums: [295 793]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.21863890687176385 hasn't increased by 0 in 1 epochs
Epoch 7/80
144/144 - 94s - loss: 0.5841 - accuracy: 0.6322 - val_loss: 2.1880 - val_accuracy: 0.2031
Confusion matrix: 
 [[  5 865]
 [  2 216]]
Validation f1: 33.26
Validation accuracy: 20.31
Validation recall: 99.08
Validation precision: 19.98
Validation AUC: 0.2378476750106833
Validation class accuracies: [0.005747126436781609, 0.9908256880733946]
TARGET: 0
target metric(test auc): 0.2378476750106833
column_sums: [   7 1081]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
144/144 - 94s - loss: 0.5334 - accuracy: 0.6643 - val_loss: 2.0773 - val_accuracy: 0.2132
Confusion matrix: 
 [[ 18 852]
 [  4 214]]
Validation f1: 33.33
Validation accuracy: 21.32
Validation recall: 98.17
Validation precision: 20.08
Validation AUC: 0.2501903336508292
Validation class accuracies: [0.020689655172413793, 0.981651376146789]
TARGET: 0
target metric(test auc): 0.2501903336508292
column_sums: [  22 1066]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
144/144 - 94s - loss: 0.4647 - accuracy: 0.7352 - val_loss: 1.4742 - val_accuracy: 0.2491
Confusion matrix: 
 [[ 65 805]
 [ 12 206]]
Validation f1: 33.52
Validation accuracy: 24.91
Validation recall: 94.50
Validation precision: 20.38
Validation AUC: 0.2331454216798014
Validation class accuracies: [0.07471264367816093, 0.944954128440367]
TARGET: 0
target metric(test auc): 0.2331454216798014
column_sums: [  77 1011]
cm_sum: 1088
The training is defaulting to either class.
Epoch 10/80
144/144 - 93s - loss: 0.3911 - accuracy: 0.7965 - val_loss: 1.4313 - val_accuracy: 0.3263
Confusion matrix: 
 [[199 671]
 [ 62 156]]
Validation f1: 29.86
Validation accuracy: 32.63
Validation recall: 71.56
Validation precision: 18.86
Validation AUC: 0.22890205238821845
Validation class accuracies: [0.22873563218390805, 0.7155963302752294]
TARGET: 0
target metric(test auc): 0.22890205238821845
column_sums: [261 827]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 11/80
144/144 - 94s - loss: 0.3325 - accuracy: 0.8452 - val_loss: 1.8558 - val_accuracy: 0.2592
Confusion matrix: 
 [[107 763]
 [ 43 175]]
Validation f1: 30.28
Validation accuracy: 25.92
Validation recall: 80.28
Validation precision: 18.66
Validation AUC: 0.207387453960393
Validation class accuracies: [0.12298850574712644, 0.8027522935779816]
TARGET: 0
target metric(test auc): 0.207387453960393
column_sums: [150 938]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22890205238821845 hasn't increased by 0 in 1 epochs
Epoch 12/80
144/144 - 94s - loss: 0.2743 - accuracy: 0.8730 - val_loss: 2.3858 - val_accuracy: 0.2592
Confusion matrix: 
 [[ 85 785]
 [ 21 197]]
Validation f1: 32.83
Validation accuracy: 25.92
Validation recall: 90.37
Validation precision: 20.06
Validation AUC: 0.22245675410924232
Validation class accuracies: [0.09770114942528736, 0.9036697247706422]
TARGET: 0
target metric(test auc): 0.22245675410924232
column_sums: [106 982]
cm_sum: 1088
The training is defaulting to either class.
Epoch 13/80
144/144 - 94s - loss: 0.2283 - accuracy: 0.8974 - val_loss: 2.4055 - val_accuracy: 0.2537
Confusion matrix: 
 [[ 83 787]
 [ 25 193]]
Validation f1: 32.22
Validation accuracy: 25.37
Validation recall: 88.53
Validation precision: 19.69
Validation AUC: 0.23253886511723795
Validation class accuracies: [0.09540229885057472, 0.8853211009174312]
TARGET: 0
target metric(test auc): 0.23253886511723795
column_sums: [108 980]
cm_sum: 1088
The training is defaulting to either class.
Epoch 14/80
144/144 - 93s - loss: 0.2027 - accuracy: 0.9174 - val_loss: 3.3316 - val_accuracy: 0.2325
Confusion matrix: 
 [[ 45 825]
 [ 10 208]]
Validation f1: 33.25
Validation accuracy: 23.25
Validation recall: 95.41
Validation precision: 20.14
Validation AUC: 0.2373397371653349
Validation class accuracies: [0.05172413793103448, 0.9541284403669725]
TARGET: 0
target metric(test auc): 0.2373397371653349
column_sums: [  55 1033]
cm_sum: 1088
The training is defaulting to either class.
Epoch 15/80
144/144 - 93s - loss: 0.1460 - accuracy: 0.9439 - val_loss: 1.2011 - val_accuracy: 0.5882
Confusion matrix: 
 [[587 283]
 [165  53]]
Validation f1: 19.13
Validation accuracy: 58.82
Validation recall: 24.31
Validation precision: 15.77
Validation AUC: 0.18683641422387692
Validation class accuracies: [0.674712643678161, 0.24311926605504589]
TARGET: 0
target metric(test auc): 0.18683641422387692
column_sums: [752 336]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22890205238821845 hasn't increased by 0 in 2 epochs
Epoch 16/80
144/144 - 93s - loss: 0.1258 - accuracy: 0.9578 - val_loss: 1.5010 - val_accuracy: 0.5018
Confusion matrix: 
 [[448 422]
 [120  98]]
Validation f1: 26.56
Validation accuracy: 50.18
Validation recall: 44.95
Validation precision: 18.85
Validation AUC: 0.2138243677294176
Validation class accuracies: [0.5149425287356322, 0.44954128440366975]
TARGET: 0
target metric(test auc): 0.2138243677294176
column_sums: [568 520]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22890205238821845 hasn't increased by 0 in 3 epochs
Epoch 17/80
144/144 - 93s - loss: 0.1211 - accuracy: 0.9557 - val_loss: 1.8671 - val_accuracy: 0.3805
Confusion matrix: 
 [[287 583]
 [ 91 127]]
Validation f1: 27.37
Validation accuracy: 38.05
Validation recall: 58.26
Validation precision: 17.89
Validation AUC: 0.20991950031477372
Validation class accuracies: [0.32988505747126434, 0.5825688073394495]
TARGET: 0
target metric(test auc): 0.20991950031477372
column_sums: [378 710]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.22890205238821845 hasn't increased by 0 in 4 epochs
Epoch 18/80
144/144 - 93s - loss: 0.0861 - accuracy: 0.9709 - val_loss: 1.7572 - val_accuracy: 0.4412
Confusion matrix: 
 [[345 525]
 [ 83 135]]
Validation f1: 30.75
Validation accuracy: 44.12
Validation recall: 61.93
Validation precision: 20.45
Validation AUC: 0.21972950129177815
Validation class accuracies: [0.39655172413793105, 0.6192660550458715]
TARGET: 0
target metric(test auc): 0.21972950129177815
column_sums: [428 660]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22890205238821845 hasn't increased by 0 in 5 epochs
Epoch 19/80
144/144 - 94s - loss: 0.0732 - accuracy: 0.9774 - val_loss: 1.4759 - val_accuracy: 0.5092
Confusion matrix: 
 [[456 414]
 [120  98]]
Validation f1: 26.85
Validation accuracy: 50.92
Validation recall: 44.95
Validation precision: 19.14
Validation AUC: 0.20523618645661684
Validation class accuracies: [0.5241379310344828, 0.44954128440366975]
TARGET: 0
target metric(test auc): 0.20523618645661684
column_sums: [576 512]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22890205238821845 hasn't increased by 0 in 6 epochs
Epoch 20/80
144/144 - 93s - loss: 0.0542 - accuracy: 0.9870 - val_loss: 1.2897 - val_accuracy: 0.5790
Confusion matrix: 
 [[544 326]
 [132  86]]
Validation f1: 27.30
Validation accuracy: 57.90
Validation recall: 39.45
Validation precision: 20.87
Validation AUC: 0.22007541774923312
Validation class accuracies: [0.6252873563218391, 0.3944954128440367]
TARGET: 0
target metric(test auc): 0.22007541774923312
column_sums: [676 412]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22890205238821845 hasn't increased by 0 in 7 epochs
Epoch 21/80
144/144 - 93s - loss: 0.0687 - accuracy: 0.9800 - val_loss: 1.5400 - val_accuracy: 0.5248
Confusion matrix: 
 [[462 408]
 [109 109]]
Validation f1: 29.66
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 52.48
Validation recall: 50.00
Validation precision: 21.08
Validation AUC: 0.2295251882626546
Validation class accuracies: [0.5310344827586206, 0.5]
TARGET: 0
target metric(test auc): 0.2295251882626546
column_sums: [571 517]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 22/80
144/144 - 94s - loss: 0.0580 - accuracy: 0.9852 - val_loss: 1.4334 - val_accuracy: 0.5432
Confusion matrix: 
 [[500 370]
 [127  91]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.80
Validation accuracy: 54.32
Validation recall: 41.74
Validation precision: 19.74
Validation AUC: 0.2083856684605175
Validation class accuracies: [0.5747126436781609, 0.41743119266055045]
TARGET: 0
target metric(test auc): 0.2083856684605175
column_sums: [627 461]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 1 epochs
Epoch 23/80
144/144 - 117s - loss: 0.0586 - accuracy: 0.9826 - val_loss: 1.3626 - val_accuracy: 0.5689
Confusion matrix: 
 [[536 334]
 [135  83]]
Validation f1: 26.14
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 56.89
Validation recall: 38.07
Validation precision: 19.90
Validation AUC: 0.2119265039809921
Validation class accuracies: [0.6160919540229886, 0.38073394495412843]
TARGET: 0
target metric(test auc): 0.2119265039809921
column_sums: [671 417]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 2 epochs
Epoch 24/80
144/144 - 93s - loss: 0.0543 - accuracy: 0.9843 - val_loss: 1.4714 - val_accuracy: 0.5432
Confusion matrix: 
 [[497 373]
 [124  94]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.45
Validation accuracy: 54.32
Validation recall: 43.12
Validation precision: 20.13
Validation AUC: 0.22231116646362797
Validation class accuracies: [0.5712643678160919, 0.43119266055045874]
TARGET: 0
target metric(test auc): 0.22231116646362797
column_sums: [621 467]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 3 epochs
Epoch 25/80
144/144 - 93s - loss: 0.0508 - accuracy: 0.9865 - val_loss: 1.6616 - val_accuracy: 0.4899
Confusion matrix: 
 [[423 447]
 [108 110]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.39
Validation accuracy: 48.99
Validation recall: 50.46
Validation precision: 19.75
Validation AUC: 0.21902962061917472
Validation class accuracies: [0.4862068965517241, 0.5045871559633027]
TARGET: 0
target metric(test auc): 0.21902962061917472
column_sums: [531 557]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 4 epochs
Epoch 26/80
144/144 - 94s - loss: 0.0472 - accuracy: 0.9857 - val_loss: 1.6875 - val_accuracy: 0.4862
Confusion matrix: 
 [[422 448]
 [111 107]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.68
Validation accuracy: 48.62
Validation recall: 49.08
Validation precision: 19.28
Validation AUC: 0.217009619867545
Validation class accuracies: [0.4850574712643678, 0.4908256880733945]
TARGET: 0
target metric(test auc): 0.217009619867545
column_sums: [533 555]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 5 epochs
Epoch 27/80
144/144 - 93s - loss: 0.0465 - accuracy: 0.9896 - val_loss: 1.5551 - val_accuracy: 0.5202
Confusion matrix: 
 [[469 401]
 [121  97]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.09
Validation accuracy: 52.02
Validation recall: 44.50
Validation precision: 19.48
Validation AUC: 0.21661420408853013
Validation class accuracies: [0.539080459770115, 0.44495412844036697]
TARGET: 0
target metric(test auc): 0.21661420408853013
column_sums: [590 498]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 6 epochs
Epoch 28/80
144/144 - 94s - loss: 0.0458 - accuracy: 0.9891 - val_loss: 1.7337 - val_accuracy: 0.4835
Confusion matrix: 
 [[417 453]
 [109 109]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.95
Validation accuracy: 48.35
Validation recall: 50.00
Validation precision: 19.40
Validation AUC: 0.2167718005982337
Validation class accuracies: [0.4793103448275862, 0.5]
TARGET: 0
target metric(test auc): 0.2167718005982337
column_sums: [526 562]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 7 epochs
Epoch 29/80
144/144 - 94s - loss: 0.0469 - accuracy: 0.9870 - val_loss: 1.4903 - val_accuracy: 0.5414
Confusion matrix: 
 [[499 371]
 [128  90]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.51
Validation accuracy: 54.14
Validation recall: 41.28
Validation precision: 19.52
Validation AUC: 0.21489870687315274
Validation class accuracies: [0.5735632183908046, 0.41284403669724773]
TARGET: 0
target metric(test auc): 0.21489870687315274
column_sums: [627 461]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 8 epochs
Epoch 30/80
144/144 - 93s - loss: 0.0461 - accuracy: 0.9887 - val_loss: 1.6531 - val_accuracy: 0.4991
Confusion matrix: 
 [[441 429]
 [116 102]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.24
Validation accuracy: 49.91
Validation recall: 46.79
Validation precision: 19.21
Validation AUC: 0.21664652179051885
Validation class accuracies: [0.506896551724138, 0.46788990825688076]
TARGET: 0
target metric(test auc): 0.21664652179051885
column_sums: [557 531]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 9 epochs
Epoch 31/80
144/144 - 96s - loss: 0.0394 - accuracy: 0.9891 - val_loss: 1.6157 - val_accuracy: 0.5064
Confusion matrix: 
 [[453 417]
 [120  98]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.74
Validation accuracy: 50.64
Validation recall: 44.95
Validation precision: 19.03
Validation AUC: 0.2158446435541514
Validation class accuracies: [0.5206896551724138, 0.44954128440366975]
TARGET: 0
target metric(test auc): 0.2158446435541514
column_sums: [573 515]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 10 epochs
Epoch 32/80
144/144 - 118s - loss: 0.0457 - accuracy: 0.9874 - val_loss: 1.6031 - val_accuracy: 0.5092
Confusion matrix: 
 [[455 415]
 [119  99]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.05
Validation accuracy: 50.92
Validation recall: 45.41
Validation precision: 19.26
Validation AUC: 0.2177338449120124
Validation class accuracies: [0.5229885057471264, 0.4541284403669725]
TARGET: 0
target metric(test auc): 0.2177338449120124
column_sums: [574 514]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 11 epochs
Epoch 33/80
144/144 - 93s - loss: 0.0485 - accuracy: 0.9843 - val_loss: 1.6302 - val_accuracy: 0.5009
Confusion matrix: 
 [[445 425]
 [118 100]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.92
Validation accuracy: 50.09
Validation recall: 45.87
Validation precision: 19.05
Validation AUC: 0.21702448073478486
Validation class accuracies: [0.5114942528735632, 0.45871559633027525]
TARGET: 0
target metric(test auc): 0.21702448073478486
column_sums: [563 525]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 12 epochs
Epoch 34/80
144/144 - 94s - loss: 0.0471 - accuracy: 0.9887 - val_loss: 1.6584 - val_accuracy: 0.4972
Confusion matrix: 
 [[436 434]
 [113 105]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.74
Validation accuracy: 49.72
Validation recall: 48.17
Validation precision: 19.48
Validation AUC: 0.21688048275288235
Validation class accuracies: [0.5011494252873563, 0.481651376146789]
TARGET: 0
target metric(test auc): 0.21688048275288235
column_sums: [549 539]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 13 epochs
Epoch 35/80
144/144 - 93s - loss: 0.0412 - accuracy: 0.9904 - val_loss: 1.6395 - val_accuracy: 0.5000
Confusion matrix: 
 [[441 429]
 [115 103]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.47
Validation accuracy: 50.00
Validation recall: 47.25
Validation precision: 19.36
Validation AUC: 0.2167264939706382
Validation class accuracies: [0.506896551724138, 0.4724770642201835]
TARGET: 0
target metric(test auc): 0.2167264939706382
column_sums: [556 532]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 14 epochs
Epoch 36/80
144/144 - 93s - loss: 0.0476 - accuracy: 0.9909 - val_loss: 1.6411 - val_accuracy: 0.5000
Confusion matrix: 
 [[441 429]
 [115 103]]
Validation f1: 27.47
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 50.00
Validation recall: 47.25
Validation precision: 19.36
Validation AUC: 0.2163513081475963
Validation class accuracies: [0.506896551724138, 0.4724770642201835]
TARGET: 0
target metric(test auc): 0.2163513081475963
column_sums: [556 532]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 15 epochs
Epoch 37/80
144/144 - 93s - loss: 0.0459 - accuracy: 0.9887 - val_loss: 1.6066 - val_accuracy: 0.5074
Confusion matrix: 
 [[453 417]
 [119  99]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.98
Validation accuracy: 50.74
Validation recall: 45.41
Validation precision: 19.19
Validation AUC: 0.21726653850605443
Validation class accuracies: [0.5206896551724138, 0.4541284403669725]
TARGET: 0
target metric(test auc): 0.21726653850605443
column_sums: [572 516]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 16 epochs
Epoch 38/80
144/144 - 93s - loss: 0.0421 - accuracy: 0.9909 - val_loss: 1.6195 - val_accuracy: 0.5046
Confusion matrix: 
 [[448 422]
 [117 101]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.26
Validation accuracy: 50.46
Validation recall: 46.33
Validation precision: 19.31
Validation AUC: 0.217294610679953
Validation class accuracies: [0.5149425287356322, 0.463302752293578]
TARGET: 0
target metric(test auc): 0.217294610679953
column_sums: [565 523]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 17 epochs
Epoch 39/80
144/144 - 93s - loss: 0.0480 - accuracy: 0.9874 - val_loss: 1.6317 - val_accuracy: 0.5028
Confusion matrix: 
 [[445 425]
 [116 102]]
Validation f1: 27.38
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 50.28
Validation recall: 46.79
Validation precision: 19.35
Validation AUC: 0.21682956802803266
Validation class accuracies: [0.5114942528735632, 0.46788990825688076]
TARGET: 0
target metric(test auc): 0.21682956802803266
column_sums: [561 527]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 18 epochs
Epoch 40/80
144/144 - 93s - loss: 0.0541 - accuracy: 0.9878 - val_loss: 1.6156 - val_accuracy: 0.5074
Confusion matrix: 
 [[453 417]
 [119  99]]
Validation f1: 26.98
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 50.74
Validation recall: 45.41
Validation precision: 19.19
Validation AUC: 0.2172819020278588
Validation class accuracies: [0.5206896551724138, 0.4541284403669725]
TARGET: 0
target metric(test auc): 0.2172819020278588
column_sums: [572 516]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 19 epochs
Epoch 41/80
144/144 - 93s - loss: 0.0429 - accuracy: 0.9922 - val_loss: 1.5821 - val_accuracy: 0.5193
Confusion matrix: 
 [[466 404]
 [119  99]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.46
Validation accuracy: 51.93
Validation recall: 45.41
Validation precision: 19.68
Validation AUC: 0.21755419796446762
Validation class accuracies: [0.535632183908046, 0.4541284403669725]
TARGET: 0
target metric(test auc): 0.21755419796446762
column_sums: [585 503]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 20 epochs
Epoch 42/80
144/144 - 93s - loss: 0.0427 - accuracy: 0.9922 - val_loss: 1.6187 - val_accuracy: 0.5055
Confusion matrix: 
 [[450 420]
 [118 100]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.10
Validation accuracy: 50.55
Validation recall: 45.87
Validation precision: 19.23
Validation AUC: 0.21695775437129433
Validation class accuracies: [0.5172413793103449, 0.45871559633027525]
TARGET: 0
target metric(test auc): 0.21695775437129433
column_sums: [568 520]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2295251882626546 hasn't increased by 0 in 21 epochs
Epoch 43/80
144/144 - 94s - loss: 0.0470 - accuracy: 0.9926 - val_loss: 1.5799 - val_accuracy: 0.5211
Confusion matrix: 
 [[468 402]
 [119  99]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.54
Validation accuracy: 52.11
Validation recall: 45.41
Validation precision: 19.76
Validation AUC: 0.21728168927799835
Validation class accuracies: [0.5379310344827586, 0.4541284403669725]

The metrics for the epoch with the best target metric are: 
Best cm: [[462 408]
 [109 109]]
Best f1: 0.2965986394557823
Best accuracy: 0.5248161764705882
Best recall: 0.5
Best precision: 0.21083172147001933
Best AUC: 0.2295251882626546
Best epoch: 21
TARGET: 0
target metric(test auc): 0.21728168927799835
column_sums: [587 501]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 10
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2134__05_1220__v29__mixednet_undersampled_classweights/validation_sheet_10.xls...
Done.
Epoch: 21
Starting...
CM: [[ 2 58]
 [ 1 14]]
F1: 0.32183908045977017
AUC: 0.5705555555555555
Accuracy: 0.21333333333333335
Precision: 0.19444444444444445
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2134__05_1220__v29__mixednet_undersampled_classweights/validation_sheet_21.xls...
Done.
Epoch: 5
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2134__05_1220__v29__mixednet_undersampled_classweights/validation_sheet_5.xls...
Done.
Epoch: 80
Starting...
CM: [[ 3 57]
 [ 1 14]]
F1: 0.3255813953488372
AUC: 0.5719248826291079
Accuracy: 0.22666666666666666
Precision: 0.19718309859154928
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2134__05_1220__v29__mixednet_undersampled_classweights/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 7539
wandb: Program ended successfully.
wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.07MB of 0.08MB uploaded (0.00MB deduped)wandb: / 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: - 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: \ 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: | 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_122209-o41hjjum/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_122209-o41hjjum/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99261
wandb:         val_accuracy 0.52114
wandb:             _runtime 5123
wandb:           _timestamp 1620913652
wandb:                _step 310
wandb:           train_loss 0.04699
wandb:             val_loss 1.5799
wandb:           val_recall 0.45413
wandb:        val_precision 0.1976
wandb:               val_f1 0.27538
wandb:              val_auc 0.21728
wandb:                   lr 0.0
wandb:          best_val_f1 0.2966
wandb:    best_val_accuracy 0.52482
wandb:   best_val_precision 0.21083
wandb:      best_val_recall 0.5
wandb:             best_auc 0.22953
wandb:           best_epoch 21
wandb:           best_bd_f1 0.33333
wandb:          best_bd_auc 0.6
wandb:     best_bd_accuracy 0.2
wandb:    best_bd_precision 0.2
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 10
wandb: Run history:
wandb:   train_accuracy ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:     val_accuracy ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÑ‚ñÉ‚ñÅ‚ñÅ‚ñÇ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñà‚ñÜ‚ñÑ‚ñÖ‚ñá‚ñà‚ñá‚ñá‚ñà‚ñá‚ñÜ‚ñÜ‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñá‚ñá‚ñá
wandb:         _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:       _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:            _step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:       train_loss ‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:         val_loss ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñá‚ñá‚ñÑ‚ñÑ‚ñÜ‚ñà‚ñà‚ñÉ‚ñÑ‚ñÜ‚ñÖ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÉ‚ñÑ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ
wandb:       val_recall ‚ñà‚ñà‚ñà‚ñá‚ñÜ‚ñÖ‚ñà‚ñà‚ñá‚ñÖ‚ñÜ‚ñá‚ñá‚ñÅ‚ñÉ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÉ‚ñÉ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ
wandb:    val_precision ‚ñá‚ñá‚ñá‚ñÖ‚ñà‚ñÑ‚ñÜ‚ñá‚ñá‚ñÖ‚ñÖ‚ñá‚ñÜ‚ñÅ‚ñÖ‚ñÑ‚ñá‚ñÖ‚ñà‚ñà‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÜ
wandb:           val_f1 ‚ñà‚ñà‚ñà‚ñá‚ñà‚ñÖ‚ñà‚ñà‚ñà‚ñÜ‚ñÜ‚ñà‚ñá‚ñÅ‚ñÖ‚ñÖ‚ñá‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÑ‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ
wandb:          val_auc ‚ñà‚ñà‚ñÉ‚ñÇ‚ñÑ‚ñÉ‚ñÜ‚ñá‚ñÖ‚ñÖ‚ñÉ‚ñÑ‚ñÖ‚ñÅ‚ñÑ‚ñÉ‚ñÑ‚ñÉ‚ñÑ‚ñÖ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ
wandb:               lr ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Synced 6 W&B file(s), 10 media file(s), 7 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2134: https://wandb.ai/arachid1/tensorboard-integration/runs/o41hjjum


 See logs at ../../new_cache/conv__2134__05_1220__v29__mixednet_undersampled_classweights/logs/