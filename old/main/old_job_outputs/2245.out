Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2245
Description:  icbhi_fulljordan_seaprated
2021-06-23 18:08:01.788740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-23 18:08:04.061165: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 18:08:04.062117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-23 18:08:04.113135: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:04.113862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 18:08:04.113892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 18:08:04.117608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 18:08:04.117695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 18:08:04.118868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 18:08:04.119201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 18:08:04.120319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 18:08:04.121345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 18:08:04.121506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 18:08:04.121618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:04.122423: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:04.123112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2245.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 0, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-23 18:08:09.109925: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 18:08:09.110194: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:09.110942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 18:08:09.111008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 18:08:09.111072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 18:08:09.111093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 18:08:09.111114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 18:08:09.111133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 18:08:09.111153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 18:08:09.111172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 18:08:09.111191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 18:08:09.111289: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:09.112037: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:09.112696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-23 18:08:09.112741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 18:08:09.825940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-23 18:08:09.825986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-23 18:08:09.825996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-23 18:08:09.826286: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:09.827161: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:09.827923: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:08:09.828666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-06-23 18:08:10.907871: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-23 18:08:10.910244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-23 18:08:11.255803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 18:08:13.363228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 18:08:13.833786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 937
-----------------------
Number of train recordings: 3208 with pneumonia: 162 and non-pneumonia: 3046
Number of val recordings: 801 with pneumonia: 37 and non-pneumonia: 764
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
201/201 - 85s - loss: 0.6186 - accuracy: 0.5857 - val_loss: 0.5985 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05805822281070533
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
201/201 - 79s - loss: 0.4301 - accuracy: 0.7506 - val_loss: 0.4296 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.042134720438532274
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
201/201 - 86s - loss: 0.3313 - accuracy: 0.8494 - val_loss: 0.1766 - val_accuracy: 0.9576
Confusion matrix: 
 [[764   0]
 [ 34   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.919 0.081]]
Validation f1: 15.00
Validation accuracy: 95.76
Validation recall: 8.11
Validation precision: 100.00
Validation AUC: 0.3435087510028024
Validation class accuracies: [1.0, 0.08108108108108109]
Saving model...
Epoch 4/65
201/201 - 88s - loss: 0.2610 - accuracy: 0.8884 - val_loss: 0.5571 - val_accuracy: 0.7578
Confusion matrix: 
 [[577 187]
 [  7  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.755 0.245]
 [0.189 0.811]]
Validation f1: 23.62
Validation accuracy: 75.78
Validation recall: 81.08
Validation precision: 13.82
Validation AUC: 0.5368865026064594
Validation class accuracies: [0.7552356020942408, 0.8108108108108109]
Saving model...
Epoch 5/65
201/201 - 88s - loss: 0.2195 - accuracy: 0.9121 - val_loss: 0.1800 - val_accuracy: 0.9426
Confusion matrix: 
 [[734  30]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.432 0.568]]
Validation f1: 47.73
Validation accuracy: 94.26
Validation recall: 56.76
Validation precision: 41.18
Validation AUC: 0.6012787552381645
Validation class accuracies: [0.9607329842931938, 0.5675675675675675]
Saving model...
Epoch 6/65
201/201 - 87s - loss: 0.1620 - accuracy: 0.9333 - val_loss: 0.3269 - val_accuracy: 0.8789
Confusion matrix: 
 [[676  88]
 [  9  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.243 0.757]]
Validation f1: 36.60
Validation accuracy: 87.89
Validation recall: 75.68
Validation precision: 24.14
Validation AUC: 0.6003620392018956
Validation class accuracies: [0.8848167539267016, 0.7567567567567568]
The validation tracker metric at 0.47727272727272724 hasn't increased by 0 in 1 epochs
Epoch 7/65
201/201 - 88s - loss: 0.1267 - accuracy: 0.9539 - val_loss: 0.2913 - val_accuracy: 0.8989
Confusion matrix: 
 [[694  70]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.297 0.703]]
Validation f1: 39.10
Validation accuracy: 89.89
Validation recall: 70.27
Validation precision: 27.08
Validation AUC: 0.6259294025529388
Validation class accuracies: [0.9083769633507853, 0.7027027027027027]
The validation tracker metric at 0.47727272727272724 hasn't increased by 0 in 2 epochs
Epoch 8/65
201/201 - 88s - loss: 0.0860 - accuracy: 0.9723 - val_loss: 0.1941 - val_accuracy: 0.9401
Confusion matrix: 
 [[732  32]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.432 0.568]]
Validation f1: 46.67
Validation accuracy: 94.01
Validation recall: 56.76
Validation precision: 39.62
Validation AUC: 0.6100073602970707
Validation class accuracies: [0.9581151832460733, 0.5675675675675675]
The validation tracker metric at 0.47727272727272724 hasn't increased by 0 in 3 epochs
Epoch 9/65
201/201 - 88s - loss: 0.0720 - accuracy: 0.9760 - val_loss: 0.7839 - val_accuracy: 0.7665
Confusion matrix: 
 [[581 183]
 [  4  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.76  0.24 ]
 [0.108 0.892]]
Validation f1: 26.09
Validation accuracy: 76.65
Validation recall: 89.19
Validation precision: 15.28
Validation AUC: 0.5693216638263842
Validation class accuracies: [0.7604712041884817, 0.8918918918918919]
The validation tracker metric at 0.47727272727272724 hasn't increased by 0 in 4 epochs
Epoch 10/65
201/201 - 88s - loss: 0.0700 - accuracy: 0.9788 - val_loss: 0.3941 - val_accuracy: 0.8851
Confusion matrix: 
 [[680  84]
 [  8  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.216 0.784]]
Validation f1: 38.67
Validation accuracy: 88.51
Validation recall: 78.38
Validation precision: 25.66
Validation AUC: 0.5273299471582191
Validation class accuracies: [0.8900523560209425, 0.7837837837837838]
The validation tracker metric at 0.47727272727272724 hasn't increased by 0 in 5 epochs
Epoch 11/65
201/201 - 88s - loss: 0.0450 - accuracy: 0.9872 - val_loss: 0.4412 - val_accuracy: 0.8864
Confusion matrix: 
 [[680  84]
 [  7  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.189 0.811]]
Validation f1: 39.74
Validation accuracy: 88.64
Validation recall: 81.08
Validation precision: 26.32
Validation AUC: 0.63968407213533
Validation class accuracies: [0.8900523560209425, 0.8108108108108109]
The validation tracker metric at 0.47727272727272724 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 12/65
201/201 - 88s - loss: 0.0372 - accuracy: 0.9903 - val_loss: 0.3840 - val_accuracy: 0.9114
Confusion matrix: 
 [[702  62]
 [  9  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.919 0.081]
 [0.243 0.757]]
Validation f1: 44.09
Validation accuracy: 91.14
Validation recall: 75.68
Validation precision: 31.11
Validation AUC: 0.6221035692151167
Validation class accuracies: [0.918848167539267, 0.7567567567567568]
The validation tracker metric at 0.47727272727272724 hasn't increased by 0 in 7 epochs
Epoch 13/65
201/201 - 88s - loss: 0.0306 - accuracy: 0.9935 - val_loss: 0.1938 - val_accuracy: 0.9463
Confusion matrix: 
 [[733  31]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.959 0.041]
 [0.324 0.676]]
Validation f1: 53.76
Validation accuracy: 94.63
Validation recall: 67.57
Validation precision: 44.64
Validation AUC: 0.655108312858786
Validation class accuracies: [0.9594240837696335, 0.6756756756756757]
Saving model...
Epoch 14/65
201/201 - 87s - loss: 0.0237 - accuracy: 0.9959 - val_loss: 0.2586 - val_accuracy: 0.9338
Confusion matrix: 
 [[722  42]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.945 0.055]
 [0.297 0.703]]
Validation f1: 49.52
Validation accuracy: 93.38
Validation recall: 70.27
Validation precision: 38.24
Validation AUC: 0.635863481460522
Validation class accuracies: [0.9450261780104712, 0.7027027027027027]
The validation tracker metric at 0.5376344086021506 hasn't increased by 0 in 1 epochs
Epoch 15/65
201/201 - 88s - loss: 0.0208 - accuracy: 0.9969 - val_loss: 0.2625 - val_accuracy: 0.9351
Confusion matrix: 
 [[723  41]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.297 0.703]]
Validation f1: 50.00
Validation accuracy: 93.51
Validation recall: 70.27
Validation precision: 38.81
Validation AUC: 0.624306830177472
Validation class accuracies: [0.9463350785340314, 0.7027027027027027]
The validation tracker metric at 0.5376344086021506 hasn't increased by 0 in 2 epochs
Epoch 16/65
201/201 - 88s - loss: 0.0308 - accuracy: 0.9953 - val_loss: 0.1739 - val_accuracy: 0.9513
Confusion matrix: 
 [[738  26]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.966 0.034]
 [0.351 0.649]]
Validation f1: 55.17
Validation accuracy: 95.13
Validation recall: 64.86
Validation precision: 48.00
Validation AUC: 0.6501822024823145
Validation class accuracies: [0.9659685863874345, 0.6486486486486487]
Saving model...
Epoch 17/65
201/201 - 88s - loss: 0.0160 - accuracy: 0.9978 - val_loss: 0.2601 - val_accuracy: 0.9376
Confusion matrix: 
 [[726  38]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.95  0.05 ]
 [0.324 0.676]]
Validation f1: 50.00
Validation accuracy: 93.76
Validation recall: 67.57
Validation precision: 39.68
Validation AUC: 0.615484843547071
Validation class accuracies: [0.9502617801047121, 0.6756756756756757]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 1 epochs
Epoch 18/65
201/201 - 88s - loss: 0.0179 - accuracy: 0.9972 - val_loss: 0.2013 - val_accuracy: 0.9476
Confusion matrix: 
 [[736  28]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.378 0.622]]
Validation f1: 52.27
Validation accuracy: 94.76
Validation recall: 62.16
Validation precision: 45.10
Validation AUC: 0.6348052815368148
Validation class accuracies: [0.9633507853403142, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 2 epochs
Epoch 19/65
201/201 - 87s - loss: 0.0142 - accuracy: 0.9984 - val_loss: 0.2082 - val_accuracy: 0.9501
Confusion matrix: 
 [[738  26]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.966 0.034]
 [0.378 0.622]]
Validation f1: 53.49
Validation accuracy: 95.01
Validation recall: 62.16
Validation precision: 46.94
Validation AUC: 0.6109772860402211
Validation class accuracies: [0.9659685863874345, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 3 epochs
Epoch 20/65
201/201 - 88s - loss: 0.0149 - accuracy: 0.9969 - val_loss: 0.2117 - val_accuracy: 0.9501
Confusion matrix: 
 [[738  26]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.966 0.034]
 [0.378 0.622]]
Validation f1: 53.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.01
Validation recall: 62.16
Validation precision: 46.94
Validation AUC: 0.610749298831415
Validation class accuracies: [0.9659685863874345, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 4 epochs
Epoch 21/65
201/201 - 88s - loss: 0.0104 - accuracy: 0.9997 - val_loss: 0.2002 - val_accuracy: 0.9501
Confusion matrix: 
 [[738  26]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.966 0.034]
 [0.378 0.622]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.49
Validation accuracy: 95.01
Validation recall: 62.16
Validation precision: 46.94
Validation AUC: 0.6311083591875488
Validation class accuracies: [0.9659685863874345, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 5 epochs
Epoch 22/65
201/201 - 87s - loss: 0.0110 - accuracy: 0.9994 - val_loss: 0.3103 - val_accuracy: 0.9276
Confusion matrix: 
 [[718  46]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.94  0.06 ]
 [0.324 0.676]]
Validation f1: 46.30
Validation accuracy: 92.76
Validation recall: 67.57
Validation precision: 35.21
Validation AUC: 0.621794810015483
Validation class accuracies: [0.9397905759162304, 0.6756756756756757]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
201/201 - 88s - loss: 0.0110 - accuracy: 1.0000 - val_loss: 0.3591 - val_accuracy: 0.9238
Confusion matrix: 
 [[714  50]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.297 0.703]]
Validation f1: 46.02
Validation accuracy: 92.38
Validation recall: 70.27
Validation precision: 34.21
Validation AUC: 0.615523640778794
Validation class accuracies: [0.9345549738219895, 0.7027027027027027]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 7 epochs
Epoch 24/65
201/201 - 88s - loss: 0.0093 - accuracy: 0.9991 - val_loss: 0.2351 - val_accuracy: 0.9476
Confusion matrix: 
 [[736  28]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.378 0.622]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.27
Validation accuracy: 94.76
Validation recall: 62.16
Validation precision: 45.10
Validation AUC: 0.6220116051348302
Validation class accuracies: [0.9633507853403142, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 8 epochs
Epoch 25/65
201/201 - 87s - loss: 0.0077 - accuracy: 1.0000 - val_loss: 0.2667 - val_accuracy: 0.9413
Confusion matrix: 
 [[729  35]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.954 0.046]
 [0.324 0.676]]
Validation f1: 51.55
Validation accuracy: 94.13
Validation recall: 67.57
Validation precision: 41.67
Validation AUC: 0.6164382497390734
Validation class accuracies: [0.9541884816753927, 0.6756756756756757]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 9 epochs
Epoch 26/65
201/201 - 87s - loss: 0.0071 - accuracy: 1.0000 - val_loss: 0.2487 - val_accuracy: 0.9451
Confusion matrix: 
 [[734  30]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.378 0.622]]
Validation f1: 51.11
Validation accuracy: 94.51
Validation recall: 62.16
Validation precision: 43.40
Validation AUC: 0.604265317534103
Validation class accuracies: [0.9607329842931938, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 10 epochs
Epoch 27/65
201/201 - 84s - loss: 0.0073 - accuracy: 0.9994 - val_loss: 0.2526 - val_accuracy: 0.9438
Confusion matrix: 
 [[733  31]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.959 0.041]
 [0.378 0.622]]
Validation f1: 50.55
Validation accuracy: 94.38
Validation recall: 62.16
Validation precision: 42.59
Validation AUC: 0.6130099087911308
Validation class accuracies: [0.9594240837696335, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 11 epochs
Epoch 28/65
201/201 - 81s - loss: 0.0067 - accuracy: 1.0000 - val_loss: 0.2431 - val_accuracy: 0.9451
Confusion matrix: 
 [[733  31]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.959 0.041]
 [0.351 0.649]]
Validation f1: 52.17
Validation accuracy: 94.51
Validation recall: 64.86
Validation precision: 43.64
Validation AUC: 0.6221347165709171
Validation class accuracies: [0.9594240837696335, 0.6486486486486487]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 29/65
201/201 - 81s - loss: 0.0063 - accuracy: 1.0000 - val_loss: 0.2466 - val_accuracy: 0.9476
Confusion matrix: 
 [[735  29]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.351 0.649]]
Validation f1: 53.33
Validation accuracy: 94.76
Validation recall: 64.86
Validation precision: 45.28
Validation AUC: 0.6252718529700498
Validation class accuracies: [0.9620418848167539, 0.6486486486486487]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 13 epochs
Epoch 30/65
201/201 - 83s - loss: 0.0068 - accuracy: 0.9997 - val_loss: 0.2402 - val_accuracy: 0.9488
Confusion matrix: 
 [[736  28]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.351 0.649]]
Validation f1: 53.93
Validation accuracy: 94.88
Validation recall: 64.86
Validation precision: 46.15
Validation AUC: 0.6191725421766462
Validation class accuracies: [0.9633507853403142, 0.6486486486486487]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 14 epochs
Epoch 31/65
201/201 - 82s - loss: 0.0058 - accuracy: 1.0000 - val_loss: 0.2495 - val_accuracy: 0.9463
Confusion matrix: 
 [[734  30]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.351 0.649]]
Validation f1: 52.75
Validation accuracy: 94.63
Validation recall: 64.86
Validation precision: 44.44
Validation AUC: 0.6211616575699083
Validation class accuracies: [0.9607329842931938, 0.6486486486486487]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 15 epochs
Epoch 32/65
201/201 - 82s - loss: 0.0065 - accuracy: 0.9997 - val_loss: 0.2507 - val_accuracy: 0.9451
Confusion matrix: 
 [[734  30]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.378 0.622]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.11
Validation accuracy: 94.51
Validation recall: 62.16
Validation precision: 43.40
Validation AUC: 0.6080630388628425
Validation class accuracies: [0.9607329842931938, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 16 epochs
Epoch 33/65
201/201 - 83s - loss: 0.0061 - accuracy: 0.9997 - val_loss: 0.2403 - val_accuracy: 0.9476
Confusion matrix: 
 [[736  28]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.378 0.622]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.27
Validation accuracy: 94.76
Validation recall: 62.16
Validation precision: 45.10
Validation AUC: 0.6151178179438517
Validation class accuracies: [0.9633507853403142, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 17 epochs
Epoch 34/65
201/201 - 82s - loss: 0.0055 - accuracy: 1.0000 - val_loss: 0.2730 - val_accuracy: 0.9438
Confusion matrix: 
 [[732  32]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.351 0.649]]
Validation f1: 51.61
Validation accuracy: 94.38
Validation recall: 64.86
Validation precision: 42.86
Validation AUC: 0.6037151076671015
Validation class accuracies: [0.9581151832460733, 0.6486486486486487]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 35/65
201/201 - 83s - loss: 0.0057 - accuracy: 0.9994 - val_loss: 0.2479 - val_accuracy: 0.9476
Confusion matrix: 
 [[736  28]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.378 0.622]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.27
Validation accuracy: 94.76
Validation recall: 62.16
Validation precision: 45.10
Validation AUC: 0.6163761569846671
Validation class accuracies: [0.9633507853403142, 0.6216216216216216]
The validation tracker metric at 0.5517241379310345 hasn't increased by 0 in 19 epochs
Epoch 36/65
201/201 - 82s - loss: 0.0058 - accuracy: 1.0000 - val_loss: 0.2585 - val_accuracy: 0.9438
Confusion matrix: 
 [[732  32]
 [ 13  24]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.351 0.649]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.61
Validation accuracy: 94.38
Validation recall: 64.86
Validation precision: 42.86
Validation AUC: 0.6178601526094675
Validation class accuracies: [0.9581151832460733, 0.6486486486486487]

The metrics for job 0 with the best target metric are: 
Best cm: [[738  26]
 [ 13  24]]
Best normalized cm: [[0.966 0.034]
 [0.351 0.649]]
Best f1: 0.55
Best accuracy: 0.95
Best recall: 0.65
Best precision: 0.48
Best AUC: 0.65
Best class accuracies: [0.9659685863874345, 0.6486486486486487]
Best epoch: 16
The number of epochs since last 1% equals the patience
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_205_4b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP6_Plueral Effusion,I C B,P L R,81,M_3_label_0_pred_0.png, [[0.022]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP78_Asthma,E W,P R M,20,M_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_204_7p5_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.099e-06]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_205_2b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[6.823e-05]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP82_N,N,P L U,38,M_0_label_0_pred_0.png, [[0.118]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_218_1b1_Al_sc_Meditron_12_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_204_2b5_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_223_1b1_Al_sc_Meditron_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_222_1b1_Ar_sc_Meditron_9_label_0_pred_0.png, [[7.243e-05]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP47_asthma,E W,P L M,60,M_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_205_3b4_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[5.657e-05]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_223_1b1_Pl_sc_Meditron_5_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_221_2b2_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_208_1b1_Ll_sc_Meditron_1_label_0_pred_0.png, [[0.348]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_219_2b2_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_207_2b3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.038]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_218_1p1_Pr_sc_Litt3200_3_label_0_pred_0.png, [[0.067]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_223_1b1_Ll_sc_Meditron_5_label_0_pred_0.png, [[0.032]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_218_1b1_Ar_sc_Meditron_4_label_0_pred_0.png, [[9.871e-05]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP80_asthma,E W,A L U,38,M_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_221_2b2_Al_mc_LittC2SE_0_label_0_pred_1.png, [[0.911]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_204_7p5_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP4_Heart Failure + Lung Fibrosis ,I C,P L R,72,F_1_label_0_pred_0.png, [[0.065]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_205_1b3_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_213_2p2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.021]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_218_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP79_asthma,E W,A R U,46,M_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_213_1p5_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.029]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.071]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_205_1b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_225_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP94_N,N,P L L,24,M_0_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_205_1b3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_210_1b1_Al_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_218_1b1_Pl_sc_Meditron_7_label_0_pred_0.png, [[2.664e-05]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/jordan_EP66_heart failure,Crep,P R L ,43,M_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_211_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/0/icbhi_218_1b1_Pr_sc_Meditron_4_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 27014
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_180804-x0mj8ho4/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_180804-x0mj8ho4/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.94382
wandb:             _runtime 3613
wandb:           _timestamp 1624475297
wandb:                _step 266
wandb:           train_loss 0.00581
wandb:             val_loss 0.25846
wandb:           val_recall 0.64865
wandb:        val_precision 0.42857
wandb:               val_f1 0.51613
wandb:              val_auc 0.61786
wandb:                   lr 6e-05
wandb:          best_val_f1 0.55172
wandb:    best_val_accuracy 0.95131
wandb:   best_val_precision 0.48
wandb:      best_val_recall 0.64865
wandb:             best_auc 0.65018
wandb:           best_epoch 16
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_180804-x0mj8ho4

-----------------------
Model
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 937
-----------------------
Number of train recordings: 3208 with pneumonia: 162 and non-pneumonia: 3046
Number of val recordings: 801 with pneumonia: 37 and non-pneumonia: 764
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate_54765 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_54765[0][0]              
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
201/201 - 311s - loss: 0.9200 - accuracy: 0.5988 - val_loss: 0.6088 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.04721235511392563
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
201/201 - 306s - loss: 0.6229 - accuracy: 0.6627 - val_loss: 0.6196 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07274724601321589
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
201/201 - 306s - loss: 0.5340 - accuracy: 0.6855 - val_loss: 0.3907 - val_accuracy: 0.7803
Confusion matrix: 
 [[609 155]
 [ 21  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.797 0.203]
 [0.568 0.432]]
Validation f1: 15.38
Validation accuracy: 78.03
Validation recall: 43.24
Validation precision: 9.36
Validation AUC: 0.3040025876722775
Validation class accuracies: [0.7971204188481675, 0.43243243243243246]
Saving model...
Epoch 4/65
201/201 - 307s - loss: 0.4702 - accuracy: 0.7475 - val_loss: 0.8063 - val_accuracy: 0.5218
Confusion matrix: 
 [[385 379]
 [  4  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.504 0.496]
 [0.108 0.892]]
Validation f1: 14.70
Validation accuracy: 52.18
Validation recall: 89.19
Validation precision: 8.01
Validation AUC: 0.4954644886579489
Validation class accuracies: [0.5039267015706806, 0.8918918918918919]
The validation tracker metric at 0.15384615384615385 hasn't increased by 0 in 1 epochs
Epoch 5/65
201/201 - 306s - loss: 0.5166 - accuracy: 0.7996 - val_loss: 0.5403 - val_accuracy: 0.6816
Confusion matrix: 
 [[522 242]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.683 0.317]
 [0.351 0.649]]
Validation f1: 15.84
Validation accuracy: 68.16
Validation recall: 64.86
Validation precision: 9.02
Validation AUC: 0.16540068579837497
Validation class accuracies: [0.6832460732984293, 0.6486486486486487]
Saving model...
Epoch 6/65
201/201 - 307s - loss: 0.4175 - accuracy: 0.7968 - val_loss: 0.6157 - val_accuracy: 0.7990
Confusion matrix: 
 [[616 148]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.351 0.649]]
Validation f1: 22.97
Validation accuracy: 79.90
Validation recall: 64.86
Validation precision: 13.95
Validation AUC: 0.4594513530785017
Validation class accuracies: [0.806282722513089, 0.6486486486486487]
Saving model...
Epoch 7/65
201/201 - 306s - loss: 0.4368 - accuracy: 0.7999 - val_loss: 0.4847 - val_accuracy: 0.7878
Confusion matrix: 
 [[611 153]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.8   0.2  ]
 [0.459 0.541]]
Validation f1: 19.05
Validation accuracy: 78.78
Validation recall: 54.05
Validation precision: 11.56
Validation AUC: 0.5156568604443833
Validation class accuracies: [0.7997382198952879, 0.5405405405405406]
The validation tracker metric at 0.2296650717703349 hasn't increased by 0 in 1 epochs
Epoch 8/65
201/201 - 307s - loss: 0.4192 - accuracy: 0.8142 - val_loss: 0.5502 - val_accuracy: 0.7341
Confusion matrix: 
 [[558 206]
 [  7  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.73  0.27 ]
 [0.189 0.811]]
Validation f1: 21.98
Validation accuracy: 73.41
Validation recall: 81.08
Validation precision: 12.71
Validation AUC: 0.5688537726416139
Validation class accuracies: [0.7303664921465969, 0.8108108108108109]
The validation tracker metric at 0.2296650717703349 hasn't increased by 0 in 2 epochs
Epoch 9/65
201/201 - 306s - loss: 0.4128 - accuracy: 0.8416 - val_loss: 1.1231 - val_accuracy: 0.6142
Confusion matrix: 
 [[464 300]
 [  9  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.607 0.393]
 [0.243 0.757]]
Validation f1: 15.34
Validation accuracy: 61.42
Validation recall: 75.68
Validation precision: 8.54
Validation AUC: 0.491260927402388
Validation class accuracies: [0.6073298429319371, 0.7567567567567568]
The validation tracker metric at 0.2296650717703349 hasn't increased by 0 in 3 epochs
Epoch 10/65
201/201 - 306s - loss: 0.3833 - accuracy: 0.8367 - val_loss: 0.5963 - val_accuracy: 0.7703
Confusion matrix: 
 [[595 169]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.779 0.221]
 [0.405 0.595]]
Validation f1: 19.30
Validation accuracy: 77.03
Validation recall: 59.46
Validation precision: 11.52
Validation AUC: 0.4145074020395859
Validation class accuracies: [0.7787958115183246, 0.5945945945945946]
The validation tracker metric at 0.2296650717703349 hasn't increased by 0 in 4 epochs
Epoch 11/65
201/201 - 306s - loss: 0.3456 - accuracy: 0.8610 - val_loss: 1.7372 - val_accuracy: 0.4182
Confusion matrix: 
 [[301 463]
 [  3  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.394 0.606]
 [0.081 0.919]]
Validation f1: 12.73
Validation accuracy: 41.82
Validation recall: 91.89
Validation precision: 6.84
Validation AUC: 0.35852666968935515
Validation class accuracies: [0.39397905759162305, 0.918918918918919]
The validation tracker metric at 0.2296650717703349 hasn't increased by 0 in 5 epochs
Epoch 12/65
201/201 - 306s - loss: 0.3564 - accuracy: 0.8426 - val_loss: 2.6994 - val_accuracy: 0.3858
Confusion matrix: 
 [[272 492]
 [  0  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.356 0.644]
 [0.    1.   ]]
Validation f1: 13.07
Validation accuracy: 38.58
Validation recall: 100.00
Validation precision: 6.99
Validation AUC: 0.37791643548125686
Validation class accuracies: [0.35602094240837695, 1.0]
The validation tracker metric at 0.2296650717703349 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
201/201 - 306s - loss: 0.3142 - accuracy: 0.8738 - val_loss: 0.2258 - val_accuracy: 0.9338
Confusion matrix: 
 [[728  36]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.459 0.541]]
Validation f1: 43.01
Validation accuracy: 93.38
Validation recall: 54.05
Validation precision: 35.71
Validation AUC: 0.5442721541370914
Validation class accuracies: [0.9528795811518325, 0.5405405405405406]
Saving model...
Epoch 14/65
201/201 - 306s - loss: 0.2896 - accuracy: 0.8862 - val_loss: 0.5800 - val_accuracy: 0.7653
Confusion matrix: 
 [[589 175]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.771 0.229]
 [0.351 0.649]]
Validation f1: 20.34
Validation accuracy: 76.53
Validation recall: 64.86
Validation precision: 12.06
Validation AUC: 0.40489013268637475
Validation class accuracies: [0.7709424083769634, 0.6486486486486487]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 1 epochs
Epoch 15/65
201/201 - 306s - loss: 0.2730 - accuracy: 0.8900 - val_loss: 0.7728 - val_accuracy: 0.7728
Confusion matrix: 
 [[593 171]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.776 0.224]
 [0.297 0.703]]
Validation f1: 22.22
Validation accuracy: 77.28
Validation recall: 70.27
Validation precision: 13.20
Validation AUC: 0.5551309923692618
Validation class accuracies: [0.7761780104712042, 0.7027027027027027]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 2 epochs
Epoch 16/65
201/201 - 307s - loss: 0.2509 - accuracy: 0.8884 - val_loss: 0.7872 - val_accuracy: 0.7715
Confusion matrix: 
 [[594 170]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.777 0.223]
 [0.351 0.649]]
Validation f1: 20.78
Validation accuracy: 77.15
Validation recall: 64.86
Validation precision: 12.37
Validation AUC: 0.5241632134206209
Validation class accuracies: [0.7774869109947644, 0.6486486486486487]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 3 epochs
Epoch 17/65
201/201 - 306s - loss: 0.2156 - accuracy: 0.9080 - val_loss: 0.3651 - val_accuracy: 0.8876
Confusion matrix: 
 [[692  72]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.486 0.514]]
Validation f1: 29.69
Validation accuracy: 88.76
Validation recall: 51.35
Validation precision: 20.88
Validation AUC: 0.41616929825653864
Validation class accuracies: [0.9057591623036649, 0.5135135135135135]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 4 epochs
Epoch 18/65
201/201 - 307s - loss: 0.2694 - accuracy: 0.8981 - val_loss: 1.4700 - val_accuracy: 0.5618
Confusion matrix: 
 [[416 348]
 [  3  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.545 0.455]
 [0.081 0.919]]
Validation f1: 16.23
Validation accuracy: 56.18
Validation recall: 91.89
Validation precision: 8.90
Validation AUC: 0.4991495881747451
Validation class accuracies: [0.5445026178010471, 0.918918918918919]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 5 epochs
Epoch 19/65
201/201 - 307s - loss: 0.2402 - accuracy: 0.9143 - val_loss: 0.2416 - val_accuracy: 0.9151
Confusion matrix: 
 [[717  47]
 [ 21  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.938 0.062]
 [0.568 0.432]]
Validation f1: 32.00
Validation accuracy: 91.51
Validation recall: 43.24
Validation precision: 25.40
Validation AUC: 0.45299878342718247
Validation class accuracies: [0.9384816753926701, 0.43243243243243246]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 20/65
201/201 - 307s - loss: 0.1754 - accuracy: 0.9252 - val_loss: 0.4125 - val_accuracy: 0.8589
Confusion matrix: 
 [[660 104]
 [  9  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.243 0.757]]
Validation f1: 33.14
Validation accuracy: 85.89
Validation recall: 75.68
Validation precision: 21.21
Validation AUC: 0.5582684140029043
Validation class accuracies: [0.8638743455497382, 0.7567567567567568]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 7 epochs
Epoch 21/65
201/201 - 307s - loss: 0.1458 - accuracy: 0.9345 - val_loss: 0.4390 - val_accuracy: 0.8602
Confusion matrix: 
 [[665  99]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87  0.13 ]
 [0.351 0.649]]
Validation f1: 30.00
Validation accuracy: 86.02
Validation recall: 64.86
Validation precision: 19.51
Validation AUC: 0.49917209441552657
Validation class accuracies: [0.8704188481675392, 0.6486486486486487]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 8 epochs
Epoch 22/65
201/201 - 306s - loss: 0.1287 - accuracy: 0.9486 - val_loss: 0.6542 - val_accuracy: 0.8215
Confusion matrix: 
 [[626 138]
 [  5  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.819 0.181]
 [0.135 0.865]]
Validation f1: 30.92
Validation accuracy: 82.15
Validation recall: 86.49
Validation precision: 18.82
Validation AUC: 0.530504813239897
Validation class accuracies: [0.819371727748691, 0.8648648648648649]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 9 epochs
Epoch 23/65
201/201 - 306s - loss: 0.1365 - accuracy: 0.9514 - val_loss: 0.2912 - val_accuracy: 0.9101
Confusion matrix: 
 [[705  59]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.351 0.649]]
Validation f1: 40.00
Validation accuracy: 91.01
Validation recall: 64.86
Validation precision: 28.92
Validation AUC: 0.5186086116186966
Validation class accuracies: [0.9227748691099477, 0.6486486486486487]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 10 epochs
Epoch 24/65
201/201 - 307s - loss: 0.1285 - accuracy: 0.9473 - val_loss: 0.3120 - val_accuracy: 0.9051
Confusion matrix: 
 [[700  64]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.324 0.676]]
Validation f1: 39.68
Validation accuracy: 90.51
Validation recall: 67.57
Validation precision: 28.09
Validation AUC: 0.5490300597406728
Validation class accuracies: [0.9162303664921466, 0.6756756756756757]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 11 epochs
Epoch 25/65
201/201 - 306s - loss: 0.1285 - accuracy: 0.9532 - val_loss: 1.3232 - val_accuracy: 0.7216
Confusion matrix: 
 [[542 222]
 [  1  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.709 0.291]
 [0.027 0.973]]
Validation f1: 24.41
Validation accuracy: 72.16
Validation recall: 97.30
Validation precision: 13.95
Validation AUC: 0.5102347352777177
Validation class accuracies: [0.7094240837696335, 0.972972972972973]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 26/65
201/201 - 308s - loss: 0.1071 - accuracy: 0.9648 - val_loss: 0.5864 - val_accuracy: 0.8527
Confusion matrix: 
 [[649 115]
 [  3  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.849 0.151]
 [0.081 0.919]]
Validation f1: 36.56
Validation accuracy: 85.27
Validation recall: 91.89
Validation precision: 22.82
Validation AUC: 0.620267063353477
Validation class accuracies: [0.849476439790576, 0.918918918918919]
local_gc_exec.sh: line 6: 26981 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2245__06_1807__v39__icbhi_fulljordan_seaprated/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 12 leaked semaphores to clean up at shutdown
  len(cache))
