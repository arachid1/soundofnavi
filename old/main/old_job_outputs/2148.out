Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2148
Description:  mod9_concat
2021-05-17 19:06:29.543115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 19:06:31.734872: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-17 19:06:31.735756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-17 19:06:31.782248: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:31.783012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-17 19:06:31.783046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 19:06:31.786453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 19:06:31.786529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 19:06:31.787625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-17 19:06:31.787951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-17 19:06:31.788918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-17 19:06:31.789790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-17 19:06:31.789946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-17 19:06:31.790051: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:31.790791: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:31.791419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2148.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2148__05_1905__v29__mod9_concat/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 4, 'LR': 1e-05, 'SHAPE': (6, 128, 1250), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: True and Concat: True
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2148
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/220lgywt
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_190632-220lgywt
wandb: Run `wandb offline` to turn off syncing.
2021-05-17 19:06:37.478042: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-17 19:06:37.478294: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:37.479336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-17 19:06:37.479393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 19:06:37.479455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 19:06:37.479487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 19:06:37.479515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-17 19:06:37.479544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-17 19:06:37.479571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-17 19:06:37.479598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-17 19:06:37.479623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-17 19:06:37.479761: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:37.480802: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:37.481724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-17 19:06:37.481786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 19:06:38.203123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-17 19:06:38.203180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-17 19:06:38.203192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-17 19:06:38.203596: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:38.204795: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:38.205861: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 19:06:38.206820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-17 19:07:16.077262: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-17 19:07:16.077954: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-17 19:07:19.097666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 19:07:20.148547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 19:07:20.156121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 6, 128, 1250 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 6, 128, 1250) 5000        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 16, 128, 1250 112         batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 16, 128, 1250 112         batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 6, 128, 1250) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 16, 128, 1250 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 16, 128, 1250 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 16, 128, 1250 112         max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 48, 128, 1250 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 48, 64, 625)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 48, 64, 625)  2500        average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 48, 64, 625)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 32, 64, 625)  40908       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 32, 64, 625)  26700       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 32, 312)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 312)  1248        average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 32, 312)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 64, 32, 312)  29088       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 64, 32, 312)  66720       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 64, 16, 156)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 64, 16, 156)  624         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64, 16, 156)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 128, 16, 156) 89424       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 128, 16, 156) 226128      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 128, 8, 78)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 8, 78)   312         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128, 8, 78)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 256, 8, 78)   323496      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 256, 8, 78)   842664      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 256, 4, 39)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 256, 4, 39)   156         average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 256, 4, 39)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 512, 4, 39)   1235412     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 512, 4, 39)   3256788     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,156,753
Trainable params: 6,137,313
Non-trainable params: 19,440
__________________________________________________________________________________________________
binary
Epoch 1/80
76/76 - 54s - loss: 0.6778 - accuracy: 0.6349 - val_loss: 0.6926 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 2/80
76/76 - 48s - loss: 0.6893 - accuracy: 0.6151 - val_loss: 0.6875 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5719248826291079
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 3/80
76/76 - 49s - loss: 0.6611 - accuracy: 0.6579 - val_loss: 0.6740 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21811860780526426
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 4/80
76/76 - 49s - loss: 0.6734 - accuracy: 0.6546 - val_loss: 0.6599 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1365902478673592
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 5/80
76/76 - 49s - loss: 0.6361 - accuracy: 0.6711 - val_loss: 0.6504 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12273561772577912
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 6/80
76/76 - 50s - loss: 0.6579 - accuracy: 0.6743 - val_loss: 0.6327 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.13941440614748196
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 7/80
76/76 - 49s - loss: 0.6200 - accuracy: 0.6842 - val_loss: 0.6128 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16229089255626644
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 8/80
76/76 - 49s - loss: 0.6232 - accuracy: 0.7039 - val_loss: 0.6072 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25585859861943194
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 9/80
76/76 - 49s - loss: 0.6093 - accuracy: 0.7007 - val_loss: 0.5714 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16174526020111035
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 10/80
76/76 - 50s - loss: 0.6440 - accuracy: 0.6875 - val_loss: 0.5384 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.18028089821203364
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 11/80
76/76 - 49s - loss: 0.6223 - accuracy: 0.6974 - val_loss: 0.7801 - val_accuracy: 0.5733
Confusion matrix: 
 [[31 29]
 [ 3 12]]
Validation f1: 42.86
Validation accuracy: 57.33
Validation recall: 80.00
Validation precision: 29.27
Validation AUC: 0.3122596279218987
Validation class accuracies: [0.5166666666666667, 0.8]
TARGET: 1
target metric(test f1): 0.4285714285714285
column_sums: [34 41]
cm_sum: 75
inside not defaulting
Saving model...
Epoch 12/80
76/76 - 49s - loss: 0.6392 - accuracy: 0.6579 - val_loss: 0.5958 - val_accuracy: 0.7333
Confusion matrix: 
 [[52  8]
 [12  3]]
Validation f1: 23.08
Validation accuracy: 73.33
Validation recall: 20.00
Validation precision: 27.27
Validation AUC: 0.29365289418713403
Validation class accuracies: [0.8666666666666667, 0.2]
TARGET: 1
target metric(test f1): 0.23076923076923075
column_sums: [64 11]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 1 epochs
Epoch 13/80
76/76 - 49s - loss: 0.6111 - accuracy: 0.6908 - val_loss: 0.5151 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.1870083199448619
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 14/80
76/76 - 49s - loss: 0.6163 - accuracy: 0.6743 - val_loss: 0.5332 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.254207138478334
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 15/80
76/76 - 49s - loss: 0.6390 - accuracy: 0.6776 - val_loss: 0.5114 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.24103067156179525
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 16/80
76/76 - 49s - loss: 0.6141 - accuracy: 0.6842 - val_loss: 0.5579 - val_accuracy: 0.7200
Confusion matrix: 
 [[53  7]
 [14  1]]
Validation f1: 8.70
Validation accuracy: 72.00
Validation recall: 6.67
Validation precision: 12.50
Validation AUC: 0.27281506733630034
Validation class accuracies: [0.8833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.08695652173913045
column_sums: [67  8]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 2 epochs
Epoch 17/80
76/76 - 49s - loss: 0.6225 - accuracy: 0.6875 - val_loss: 0.5079 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.2346672135504006
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 18/80
76/76 - 49s - loss: 0.6013 - accuracy: 0.6842 - val_loss: 0.5529 - val_accuracy: 0.7467
Confusion matrix: 
 [[55  5]
 [14  1]]
Validation f1: 9.52
Validation accuracy: 74.67
Validation recall: 6.67
Validation precision: 16.67
Validation AUC: 0.2767441152484543
Validation class accuracies: [0.9166666666666666, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09523809523809522
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 19/80
76/76 - 49s - loss: 0.6120 - accuracy: 0.6842 - val_loss: 0.5755 - val_accuracy: 0.7067
Confusion matrix: 
 [[52  8]
 [14  1]]
Validation f1: 8.33
Validation accuracy: 70.67
Validation recall: 6.67
Validation precision: 11.11
Validation AUC: 0.2903876742080435
Validation class accuracies: [0.8666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.08333333333333334
column_sums: [66  9]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 3 epochs
Epoch 20/80
76/76 - 49s - loss: 0.6070 - accuracy: 0.6776 - val_loss: 0.4987 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.25488598694827413
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 21/80
76/76 - 49s - loss: 0.6272 - accuracy: 0.6776 - val_loss: 0.5191 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.2677052110349604
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 22/80
76/76 - 49s - loss: 0.6047 - accuracy: 0.7007 - val_loss: 0.4994 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.25992846247141277
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 23/80
76/76 - 49s - loss: 0.5889 - accuracy: 0.6842 - val_loss: 0.5369 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.2781005150388679
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 24/80
76/76 - 49s - loss: 0.5840 - accuracy: 0.7138 - val_loss: 0.5019 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 100.00
Validation AUC: 0.2478874089800044
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 25/80
76/76 - 49s - loss: 0.6039 - accuracy: 0.6809 - val_loss: 0.5170 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.29241655600350336
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 26/80
76/76 - 49s - loss: 0.5942 - accuracy: 0.6974 - val_loss: 0.5111 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 11.76
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.24636092472513266
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 27/80
76/76 - 49s - loss: 0.5912 - accuracy: 0.7270 - val_loss: 0.5415 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.22696126579484238
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 28/80
76/76 - 49s - loss: 0.6120 - accuracy: 0.7007 - val_loss: 0.5081 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.25574671491691764
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 29/80
76/76 - 49s - loss: 0.5742 - accuracy: 0.7138 - val_loss: 0.5493 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.00
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.28563693849130645
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 30/80
76/76 - 49s - loss: 0.6056 - accuracy: 0.6711 - val_loss: 0.5157 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 11.11
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.25767799786691353
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 31/80
76/76 - 49s - loss: 0.5866 - accuracy: 0.6941 - val_loss: 0.5171 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.24027940797799205
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 32/80
76/76 - 49s - loss: 0.5637 - accuracy: 0.7072 - val_loss: 0.5288 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.26500135649374246
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 33/80
76/76 - 49s - loss: 0.5613 - accuracy: 0.7237 - val_loss: 0.6370 - val_accuracy: 0.6667
Confusion matrix: 
 [[46 14]
 [11  4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.24
Validation accuracy: 66.67
Validation recall: 26.67
Validation precision: 22.22
Validation AUC: 0.2875817182692758
Validation class accuracies: [0.7666666666666667, 0.26666666666666666]
TARGET: 1
target metric(test f1): 0.2424242424242424
column_sums: [57 18]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 2.499999936844688e-06
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 4 epochs
Epoch 34/80
76/76 - 49s - loss: 0.5555 - accuracy: 0.7303 - val_loss: 0.5332 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.26736666359310374
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 35/80
76/76 - 49s - loss: 0.5438 - accuracy: 0.7303 - val_loss: 0.5495 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.2694909903415826
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 36/80
76/76 - 49s - loss: 0.5322 - accuracy: 0.7566 - val_loss: 0.5252 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.26490680649029674
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 37/80
76/76 - 49s - loss: 0.5365 - accuracy: 0.7467 - val_loss: 0.5240 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 11.11
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.2574539178981847
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 38/80
76/76 - 50s - loss: 0.5317 - accuracy: 0.7434 - val_loss: 0.5388 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.27064747774387066
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 39/80
76/76 - 50s - loss: 0.5182 - accuracy: 0.7500 - val_loss: 0.5509 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.28056512172131104
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 40/80
76/76 - 49s - loss: 0.5346 - accuracy: 0.7401 - val_loss: 0.5458 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.268001384549308
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 41/80
76/76 - 49s - loss: 0.5230 - accuracy: 0.7566 - val_loss: 0.5410 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.25652407918193726
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 42/80
76/76 - 49s - loss: 0.5109 - accuracy: 0.7697 - val_loss: 0.5441 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.25360921740240605
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 43/80
76/76 - 49s - loss: 0.5117 - accuracy: 0.7632 - val_loss: 0.5473 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.2478554897402993
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 44/80
76/76 - 49s - loss: 0.5183 - accuracy: 0.7599 - val_loss: 0.5600 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2611111984951134
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 45/80
76/76 - 50s - loss: 0.5052 - accuracy: 0.7500 - val_loss: 0.5525 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.24903840839640956
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 46/80
76/76 - 49s - loss: 0.5128 - accuracy: 0.7533 - val_loss: 0.5535 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.2521049398149015
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 47/80
76/76 - 49s - loss: 0.4980 - accuracy: 0.7533 - val_loss: 0.5739 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.2569169571849019
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 48/80
76/76 - 50s - loss: 0.5037 - accuracy: 0.7697 - val_loss: 0.5720 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
Validation accuracy: 78.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.24737069251112595
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 49/80
76/76 - 50s - loss: 0.5029 - accuracy: 0.7664 - val_loss: 0.5834 - val_accuracy: 0.7467
Confusion matrix: 
 [[55  5]
 [14  1]]
Validation f1: 9.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 74.67
Validation recall: 6.67
Validation precision: 16.67
Validation AUC: 0.2607147948323879
Validation class accuracies: [0.9166666666666666, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09523809523809522
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 50/80
76/76 - 49s - loss: 0.4850 - accuracy: 0.7730 - val_loss: 0.5710 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2556765011219956
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 51/80
76/76 - 49s - loss: 0.4975 - accuracy: 0.7730 - val_loss: 0.5722 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2608774200411693
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 52/80
76/76 - 49s - loss: 0.4803 - accuracy: 0.7697 - val_loss: 0.5707 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.2530566510678149
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 53/80
76/76 - 49s - loss: 0.4876 - accuracy: 0.7632 - val_loss: 0.6165 - val_accuracy: 0.7067
Confusion matrix: 
 [[50 10]
 [12  3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 21.43
Validation accuracy: 70.67
Validation recall: 20.00
Validation precision: 23.08
Validation AUC: 0.2714408498717686
Validation class accuracies: [0.8333333333333334, 0.2]
TARGET: 1
target metric(test f1): 0.21428571428571427
column_sums: [62 13]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 5 epochs
Epoch 54/80
76/76 - 49s - loss: 0.4664 - accuracy: 0.7961 - val_loss: 0.5876 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 20.00
Validation AUC: 0.25846082363278383
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 55/80
76/76 - 49s - loss: 0.4786 - accuracy: 0.7829 - val_loss: 0.6087 - val_accuracy: 0.7200
Confusion matrix: 
 [[52  8]
 [13  2]]
Validation f1: 16.00
Validation accuracy: 72.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 13.33
Validation precision: 20.00
Validation AUC: 0.26077902273999487
Validation class accuracies: [0.8666666666666667, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.16
column_sums: [65 10]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 6 epochs
Epoch 56/80
76/76 - 49s - loss: 0.4774 - accuracy: 0.7829 - val_loss: 0.6016 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.26002117989641427
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 57/80
76/76 - 49s - loss: 0.4696 - accuracy: 0.7895 - val_loss: 0.6011 - val_accuracy: 0.7467
Confusion matrix: 
 [[55  5]
 [14  1]]
Validation f1: 9.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 74.67
Validation recall: 6.67
Validation precision: 16.67
Validation AUC: 0.2582400449508978
Validation class accuracies: [0.9166666666666666, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09523809523809522
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 58/80
76/76 - 49s - loss: 0.4704 - accuracy: 0.7763 - val_loss: 0.5948 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.25561633007548973
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 59/80
76/76 - 49s - loss: 0.4720 - accuracy: 0.7862 - val_loss: 0.6186 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
Validation accuracy: 78.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.24775780576343387
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 60/80
76/76 - 49s - loss: 0.4720 - accuracy: 0.7763 - val_loss: 0.6264 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.25045456046370645
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 61/80
76/76 - 49s - loss: 0.4550 - accuracy: 0.7993 - val_loss: 0.6341 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 9.09
Validation accuracy: 73.33
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.25042203748020453
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 62/80
76/76 - 49s - loss: 0.4545 - accuracy: 0.7895 - val_loss: 0.6278 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2515490272770221
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 63/80
76/76 - 50s - loss: 0.4564 - accuracy: 0.7862 - val_loss: 0.6657 - val_accuracy: 0.6933
Confusion matrix: 
 [[49 11]
 [12  3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 20.69
Validation accuracy: 69.33
Validation recall: 20.00
Validation precision: 21.43
Validation AUC: 0.2548755505458056
Validation class accuracies: [0.8166666666666667, 0.2]
TARGET: 1
target metric(test f1): 0.20689655172413796
column_sums: [61 14]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 7 epochs
Epoch 64/80
76/76 - 49s - loss: 0.4538 - accuracy: 0.7763 - val_loss: 0.6907 - val_accuracy: 0.6933
Confusion matrix: 
 [[49 11]
 [12  3]]
Validation f1: 20.69
Validation accuracy: 69.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 20.00
Validation precision: 21.43
Validation AUC: 0.25659098928374857
Validation class accuracies: [0.8166666666666667, 0.2]
TARGET: 1
target metric(test f1): 0.20689655172413796
column_sums: [61 14]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 6.24999984211172e-07
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 8 epochs
Epoch 65/80
76/76 - 49s - loss: 0.4417 - accuracy: 0.8026 - val_loss: 0.6438 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 73.33
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.25852884952117966
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 66/80
76/76 - 49s - loss: 0.4379 - accuracy: 0.8026 - val_loss: 0.6399 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.255445313550263
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 67/80
76/76 - 49s - loss: 0.4583 - accuracy: 0.7862 - val_loss: 0.6486 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
Validation accuracy: 73.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.258133732487076
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 68/80
76/76 - 49s - loss: 0.4437 - accuracy: 0.7993 - val_loss: 0.6549 - val_accuracy: 0.7333
Confusion matrix: 
 [[53  7]
 [13  2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.67
Validation accuracy: 73.33
Validation recall: 13.33
Validation precision: 22.22
Validation AUC: 0.2573565062277077
Validation class accuracies: [0.8833333333333333, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.16666666666666669
column_sums: [66  9]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 9 epochs
Epoch 69/80
76/76 - 49s - loss: 0.4276 - accuracy: 0.8191 - val_loss: 0.6423 - val_accuracy: 0.7467
Confusion matrix: 
 [[55  5]
 [14  1]]
Validation f1: 9.52
Validation accuracy: 74.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 16.67
Validation AUC: 0.2566615710522611
Validation class accuracies: [0.9166666666666666, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09523809523809522
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 70/80
76/76 - 50s - loss: 0.4403 - accuracy: 0.8026 - val_loss: 0.6445 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 73.33
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.25886585630399017
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 71/80
76/76 - 50s - loss: 0.4374 - accuracy: 0.8092 - val_loss: 0.6491 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
Validation accuracy: 73.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.25957938485009496
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 72/80
76/76 - 49s - loss: 0.4457 - accuracy: 0.8125 - val_loss: 0.6572 - val_accuracy: 0.7333
Confusion matrix: 
 [[53  7]
 [13  2]]
Validation f1: 16.67
Validation accuracy: 73.33
Validation recall: 13.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 22.22
Validation AUC: 0.2557006192922689
Validation class accuracies: [0.8833333333333333, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.16666666666666669
column_sums: [66  9]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 10 epochs
Epoch 73/80
76/76 - 49s - loss: 0.4420 - accuracy: 0.8125 - val_loss: 0.6597 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
Validation accuracy: 73.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.25568752193699995
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 74/80
76/76 - 49s - loss: 0.4346 - accuracy: 0.8092 - val_loss: 0.6534 - val_accuracy: 0.7467
Confusion matrix: 
 [[55  5]
 [14  1]]
Validation f1: 9.52
Validation accuracy: 74.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 16.67
Validation AUC: 0.2569232536181167
Validation class accuracies: [0.9166666666666666, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09523809523809522
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 75/80
76/76 - 49s - loss: 0.4472 - accuracy: 0.8026 - val_loss: 0.6684 - val_accuracy: 0.7467
Confusion matrix: 
 [[53  7]
 [12  3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.00
Validation accuracy: 74.67
Validation recall: 20.00
Validation precision: 30.00
Validation AUC: 0.2584118871529979
Validation class accuracies: [0.8833333333333333, 0.2]
TARGET: 1
target metric(test f1): 0.24
column_sums: [65 10]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 11 epochs
Epoch 76/80
76/76 - 49s - loss: 0.4358 - accuracy: 0.8289 - val_loss: 0.6588 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 73.33
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.2584886013807023
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 77/80
76/76 - 49s - loss: 0.4392 - accuracy: 0.8059 - val_loss: 0.6685 - val_accuracy: 0.7333
Confusion matrix: 
 [[53  7]
 [13  2]]
Validation f1: 16.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 73.33
Validation recall: 13.33
Validation precision: 22.22
Validation AUC: 0.25822631767418874
Validation class accuracies: [0.8833333333333333, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.16666666666666669
column_sums: [66  9]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 1.56249996052793e-07
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 12 epochs
Epoch 78/80
76/76 - 49s - loss: 0.4229 - accuracy: 0.8191 - val_loss: 0.6669 - val_accuracy: 0.7333
Confusion matrix: 
 [[53  7]
 [13  2]]
Validation f1: 16.67
Validation accuracy: 73.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 13.33
Validation precision: 22.22
Validation AUC: 0.2561005198989298
Validation class accuracies: [0.8833333333333333, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.16666666666666669
column_sums: [66  9]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4285714285714285 hasn't increased by 0 in 13 epochs
Epoch 79/80
76/76 - 49s - loss: 0.4375 - accuracy: 0.7862 - val_loss: 0.6628 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 73.33
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.2562897130992232
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 80/80
76/76 - 49s - loss: 0.4268 - accuracy: 0.8125 - val_loss: 0.6622 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 73.33
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.25722143941642217
Validation class accuracies: [0.9, 0.06666666666666667]

The metrics for the epoch with the best target metric are: 
Best cm: [[31 29]
 [ 3 12]]
Best f1: 0.4285714285714285
Best accuracy: 0.5733333333333334
Best recall: 0.8
Best precision: 0.2926829268292683
Best AUC: 0.3122596279218987
Best epoch: 11
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.

Starting the Bangladesh analysis...
Epoch: 80
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2148.py", line 308, in <module>
    train_model(**arguments)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2148.py", line 257, in train_model
    bd_f1, bd_accuracy, bd_precision, bd_recall, bd_auc, bd_y_true, bd_y_pred = generate_bangladesh_sheet(model, grouped_val_samples, excel_dest, six, initial_channels)
TypeError: generate_bangladesh_sheet() missing 1 required positional argument: 'pneumonia_threshold'
wandb: Waiting for W&B process to finish, PID 8335
wandb: Program failed with code 1.  Press ctrl-c to abort syncing.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: / 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: - 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: \ 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_190632-220lgywt/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_190632-220lgywt/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.8125
wandb:         val_accuracy 0.73333
wandb:             _runtime 4497
wandb:           _timestamp 1621282889
wandb:                _step 562
wandb:           train_loss 0.42675
wandb:             val_loss 0.66219
wandb:           val_recall 0.06667
wandb:        val_precision 0.14286
wandb:               val_f1 0.09091
wandb:              val_auc 0.25722
wandb:                   lr 0.0
wandb:          best_val_f1 0.42857
wandb:    best_val_accuracy 0.57333
wandb:   best_val_precision 0.29268
wandb:      best_val_recall 0.8
wandb:             best_auc 0.31226
wandb:           best_epoch 11
wandb: Run history:
wandb:   train_accuracy ▁▂▂▃▄▃▃▃▃▃▃▃▃▅▄▃▄▅▅▅▆▆▅▅▆▆▆▇▇▇▇▇▇▇███▇██
wandb:     val_accuracy █████▁███▅▆▆▆█▆█▄▆▇▆▇▇█▆▆▇▅▅▆▇▆▅▆▆▆▆▆▆▆▆
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss ██▇▆▆▆▆▇▆▆▇▆▆▆▅▅▅▄▄▄▄▃▃▃▃▃▃▂▂▂▂▂▁▂▁▁▁▂▁▁
wandb:         val_loss ▆▅▅▄▃█▁▁▁▃▁▂▁▂▂▁▄▂▁▂▂▂▂▃▃▃▄▄▃▄▄▅▄▅▄▅▅▅▅▅
wandb:       val_recall ▁▁▁▁▁█▁▂▂▂▂▂▂▂▂▂▃▂▂▂▂▂▂▂▂▂▃▂▂▂▂▃▂▂▂▂▂▃▂▂
wandb:    val_precision ▁▁▁▁▁▃▁██▂▂▂▂█▂█▃▂▃▂▃▃▅▂▂▃▃▂▂▃▂▃▂▂▂▂▂▃▃▂
wandb:           val_f1 ▁▁▁▁▁█▁▃▃▂▃▃▃▃▃▃▅▃▃▃▃▃▃▃▃▃▅▄▃▃▂▄▂▂▃▂▂▅▄▂
wandb:          val_auc █▂▁▂▂▄▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:               lr █████████████████▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 3 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2148: https://wandb.ai/arachid1/tensorboard-integration/runs/220lgywt


 See logs at ../../new_cache/conv__2148__05_1905__v29__mod9_concat/logs/