Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2229
Description:  time_frq_masking
2021-06-16 20:53:51.498394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-16 20:53:53.735425: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 20:53:53.736398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-16 20:53:53.748755: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:53:53.749576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 20:53:53.749623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 20:53:53.753146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 20:53:53.753222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 20:53:53.754478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 20:53:53.754796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 20:53:53.755818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 20:53:53.756805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 20:53:53.756974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 20:53:53.757088: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:53:53.757816: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:53:53.758491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2229.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2229__06_2045__v39__time_frq_masking
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 148, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 148, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-16 20:55:15.106266: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 20:55:15.106572: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:55:15.107515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 20:55:15.107613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 20:55:15.107747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 20:55:15.107797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 20:55:15.107838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 20:55:15.107883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 20:55:15.107921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 20:55:15.107957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 20:55:15.107993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 20:55:15.108132: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:55:15.108997: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:55:15.109737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-16 20:55:15.109806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 20:55:15.831191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-16 20:55:15.831238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-16 20:55:15.831248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-16 20:55:15.831521: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:55:15.832300: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:55:15.833011: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:55:15.833654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_3
Length of training samples after spec augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_4
Length of training samples after spec augmentation: 2652
-----------------------
Number of train recordings: 2652 with pneumonia: 232 and non-pneumonia: 2420
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-16 20:55:17.133573: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-16 20:55:17.136387: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-16 20:55:17.537386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 20:55:19.511227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 20:55:20.039893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
166/166 - 236s - loss: 1.0367 - accuracy: 0.5750 - val_loss: 1.5564 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.05408151925301938
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
166/166 - 239s - loss: 0.5710 - accuracy: 0.7161 - val_loss: 0.9856 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.05008462124392026
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
166/166 - 241s - loss: 0.4517 - accuracy: 0.7564 - val_loss: 0.2055 - val_accuracy: 0.9504
Confusion matrix: 
 [[571   2]
 [ 28   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.875 0.125]]
Validation f1: 21.05
Validation accuracy: 95.04
Validation recall: 12.50
Validation precision: 66.67
Validation AUC: 0.33132388086902026
Validation class accuracies: [0.9965095986038395, 0.125]
Saving model...
Epoch 4/65
166/166 - 240s - loss: 0.4416 - accuracy: 0.7715 - val_loss: 0.4989 - val_accuracy: 0.8050
Confusion matrix: 
 [[464 109]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.281 0.719]]
Validation f1: 28.05
Validation accuracy: 80.50
Validation recall: 71.88
Validation precision: 17.42
Validation AUC: 0.46846126187841347
Validation class accuracies: [0.8097731239092496, 0.71875]
Saving model...
Epoch 5/65
166/166 - 240s - loss: 0.4219 - accuracy: 0.7790 - val_loss: 1.1815 - val_accuracy: 0.5140
Confusion matrix: 
 [[291 282]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.508 0.492]
 [0.375 0.625]]
Validation f1: 11.98
Validation accuracy: 51.40
Validation recall: 62.50
Validation precision: 6.62
Validation AUC: 0.06493717787108555
Validation class accuracies: [0.5078534031413613, 0.625]
The validation tracker metric at 0.28048780487804875 hasn't increased by 0 in 1 epochs
Epoch 6/65
166/166 - 240s - loss: 0.3512 - accuracy: 0.8122 - val_loss: 0.2025 - val_accuracy: 0.9421
Confusion matrix: 
 [[555  18]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.531 0.469]]
Validation f1: 46.15
Validation accuracy: 94.21
Validation recall: 46.88
Validation precision: 45.45
Validation AUC: 0.5316669518341647
Validation class accuracies: [0.9685863874345549, 0.46875]
Saving model...
Epoch 7/65
166/166 - 240s - loss: 0.3066 - accuracy: 0.8288 - val_loss: 0.3874 - val_accuracy: 0.8479
Confusion matrix: 
 [[490  83]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.855 0.145]
 [0.281 0.719]]
Validation f1: 33.33
Validation accuracy: 84.79
Validation recall: 71.88
Validation precision: 21.70
Validation AUC: 0.4812445033798933
Validation class accuracies: [0.8551483420593369, 0.71875]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 1 epochs
Epoch 8/65
166/166 - 240s - loss: 0.3047 - accuracy: 0.8446 - val_loss: 0.6680 - val_accuracy: 0.7223
Confusion matrix: 
 [[405 168]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.707 0.293]
 [0.    1.   ]]
Validation f1: 27.59
Validation accuracy: 72.23
Validation recall: 100.00
Validation precision: 16.00
Validation AUC: 0.5656932190895141
Validation class accuracies: [0.7068062827225131, 1.0]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 2 epochs
Epoch 9/65
166/166 - 240s - loss: 0.3680 - accuracy: 0.8431 - val_loss: 0.9343 - val_accuracy: 0.5967
Confusion matrix: 
 [[330 243]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.576 0.424]
 [0.031 0.969]]
Validation f1: 20.26
Validation accuracy: 59.67
Validation recall: 96.88
Validation precision: 11.31
Validation AUC: 0.5551054104400243
Validation class accuracies: [0.5759162303664922, 0.96875]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 3 epochs
Epoch 10/65
166/166 - 240s - loss: 0.2893 - accuracy: 0.8450 - val_loss: 0.2562 - val_accuracy: 0.9190
Confusion matrix: 
 [[539  34]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.469 0.531]]
Validation f1: 40.96
Validation accuracy: 91.90
Validation recall: 53.12
Validation precision: 33.33
Validation AUC: 0.5049276967427564
Validation class accuracies: [0.9406631762652705, 0.53125]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 4 epochs
Epoch 11/65
166/166 - 240s - loss: 0.2900 - accuracy: 0.8571 - val_loss: 0.3445 - val_accuracy: 0.8694
Confusion matrix: 
 [[506  67]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.375 0.625]]
Validation f1: 33.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 86.94
Validation recall: 62.50
Validation precision: 22.99
Validation AUC: 0.6167599871959023
Validation class accuracies: [0.8830715532286213, 0.625]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 5 epochs
Epoch 12/65
166/166 - 239s - loss: 0.1976 - accuracy: 0.8982 - val_loss: 0.1987 - val_accuracy: 0.9140
Confusion matrix: 
 [[536  37]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.469 0.531]]
Validation f1: 39.53
Validation accuracy: 91.40
Validation recall: 53.12
Validation precision: 31.48
Validation AUC: 0.4872063481403091
Validation class accuracies: [0.9354275741710296, 0.53125]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
166/166 - 240s - loss: 0.1350 - accuracy: 0.9370 - val_loss: 0.5173 - val_accuracy: 0.8165
Confusion matrix: 
 [[467 106]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.815 0.185]
 [0.156 0.844]]
Validation f1: 32.73
Validation accuracy: 81.65
Validation recall: 84.38
Validation precision: 20.30
Validation AUC: 0.6623591661427165
Validation class accuracies: [0.8150087260034904, 0.84375]
The validation tracker metric at 0.4615384615384615 hasn't increased by 0 in 7 epochs
Epoch 14/65
166/166 - 240s - loss: 0.1838 - accuracy: 0.9216 - val_loss: 0.2422 - val_accuracy: 0.9273
Confusion matrix: 
 [[541  32]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.375 0.625]]
Validation f1: 47.62
Validation accuracy: 92.73
Validation recall: 62.50
Validation precision: 38.46
Validation AUC: 0.5464112637515357
Validation class accuracies: [0.944153577661431, 0.625]
Saving model...
Epoch 15/65
166/166 - 240s - loss: 0.1070 - accuracy: 0.9517 - val_loss: 0.2698 - val_accuracy: 0.9256
Confusion matrix: 
 [[544  29]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.5   0.5  ]]
Validation f1: 41.56
Validation accuracy: 92.56
Validation recall: 50.00
Validation precision: 35.56
Validation AUC: 0.49925788303290053
Validation class accuracies: [0.9493891797556719, 0.5]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 1 epochs
Epoch 16/65
166/166 - 240s - loss: 0.0930 - accuracy: 0.9566 - val_loss: 0.3170 - val_accuracy: 0.9025
Confusion matrix: 
 [[523  50]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.281 0.719]]
Validation f1: 43.81
Validation accuracy: 90.25
Validation recall: 71.88
Validation precision: 31.51
Validation AUC: 0.5243609787408888
Validation class accuracies: [0.912739965095986, 0.71875]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 2 epochs
Epoch 17/65
166/166 - 240s - loss: 0.0747 - accuracy: 0.9683 - val_loss: 0.1896 - val_accuracy: 0.9620
Confusion matrix: 
 [[565   8]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.469 0.531]]
Validation f1: 59.65
Validation accuracy: 96.20
Validation recall: 53.12
Validation precision: 68.00
Validation AUC: 0.5677535612940743
Validation class accuracies: [0.9860383944153578, 0.53125]
Saving model...
Epoch 18/65
166/166 - 240s - loss: 0.1298 - accuracy: 0.9495 - val_loss: 0.2707 - val_accuracy: 0.9223
Confusion matrix: 
 [[538  35]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.375 0.625]]
Validation f1: 45.98
Validation accuracy: 92.23
Validation recall: 62.50
Validation precision: 36.36
Validation AUC: 0.5999332997530102
Validation class accuracies: [0.9389179755671903, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 1 epochs
Epoch 19/65
166/166 - 240s - loss: 0.0754 - accuracy: 0.9642 - val_loss: 0.3116 - val_accuracy: 0.9157
Confusion matrix: 
 [[530  43]
 [  8  24]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.25  0.75 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.48
Validation accuracy: 91.57
Validation recall: 75.00
Validation precision: 35.82
Validation AUC: 0.5488119451551735
Validation class accuracies: [0.924956369982548, 0.75]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 2 epochs
Epoch 20/65
166/166 - 240s - loss: 0.0484 - accuracy: 0.9793 - val_loss: 0.1916 - val_accuracy: 0.9355
Confusion matrix: 
 [[544  29]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.312 0.688]]
Validation f1: 53.01
Validation accuracy: 93.55
Validation recall: 68.75
Validation precision: 43.14
Validation AUC: 0.6109579176240144
Validation class accuracies: [0.9493891797556719, 0.6875]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 3 epochs
Epoch 21/65
166/166 - 239s - loss: 0.0512 - accuracy: 0.9830 - val_loss: 0.1747 - val_accuracy: 0.9554
Confusion matrix: 
 [[560  13]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.438 0.562]]
Validation f1: 57.14
Validation accuracy: 95.54
Validation recall: 56.25
Validation precision: 58.06
Validation AUC: 0.6159218723691869
Validation class accuracies: [0.9773123909249564, 0.5625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 4 epochs
Epoch 22/65
166/166 - 240s - loss: 0.1049 - accuracy: 0.9668 - val_loss: 0.2966 - val_accuracy: 0.9603
Confusion matrix: 
 [[568   5]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.594 0.406]]
Validation f1: 52.00
Validation accuracy: 96.03
Validation recall: 40.62
Validation precision: 72.22
Validation AUC: 0.5125898868274056
Validation class accuracies: [0.9912739965095986, 0.40625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 5 epochs
Epoch 23/65
166/166 - 240s - loss: 0.0725 - accuracy: 0.9630 - val_loss: 0.4171 - val_accuracy: 0.8744
Confusion matrix: 
 [[511  62]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.438 0.562]]
Validation f1: 32.14
Validation accuracy: 87.44
Validation recall: 56.25
Validation precision: 22.50
Validation AUC: 0.4312441726157727
Validation class accuracies: [0.8917975567190227, 0.5625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 24/65
166/166 - 240s - loss: 0.0459 - accuracy: 0.9796 - val_loss: 0.2512 - val_accuracy: 0.9322
Confusion matrix: 
 [[545  28]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.406 0.594]]
Validation f1: 48.10
Validation accuracy: 93.22
Validation recall: 59.38
Validation precision: 40.43
Validation AUC: 0.5209827536957568
Validation class accuracies: [0.9511343804537522, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 7 epochs
Epoch 25/65
166/166 - 240s - loss: 0.0314 - accuracy: 0.9876 - val_loss: 0.2861 - val_accuracy: 0.9306
Confusion matrix: 
 [[546  27]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.469 0.531]]
Validation f1: 44.74
Validation accuracy: 93.06
Validation recall: 53.12
Validation precision: 38.64
Validation AUC: 0.5458752458233742
Validation class accuracies: [0.9528795811518325, 0.53125]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 8 epochs
Epoch 26/65
166/166 - 240s - loss: 0.0504 - accuracy: 0.9815 - val_loss: 0.2093 - val_accuracy: 0.9521
Confusion matrix: 
 [[556  17]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.375 0.625]]
Validation f1: 57.97
Validation accuracy: 95.21
Validation recall: 62.50
Validation precision: 54.05
Validation AUC: 0.6716163323724279
Validation class accuracies: [0.9703315881326352, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 9 epochs
Epoch 27/65
166/166 - 239s - loss: 0.0448 - accuracy: 0.9811 - val_loss: 0.2781 - val_accuracy: 0.9289
Confusion matrix: 
 [[541  32]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.344 0.656]]
Validation f1: 49.41
Validation accuracy: 92.89
Validation recall: 65.62
Validation precision: 39.62
Validation AUC: 0.6154104949953894
Validation class accuracies: [0.944153577661431, 0.65625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 10 epochs
Epoch 28/65
166/166 - 239s - loss: 0.0319 - accuracy: 0.9868 - val_loss: 0.3113 - val_accuracy: 0.9372
Confusion matrix: 
 [[542  31]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.219 0.781]]
Validation f1: 56.82
Validation accuracy: 93.72
Validation recall: 78.12
Validation precision: 44.64
Validation AUC: 0.6347392875890472
Validation class accuracies: [0.9458987783595113, 0.78125]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 11 epochs
Epoch 29/65
166/166 - 240s - loss: 0.0319 - accuracy: 0.9876 - val_loss: 0.2461 - val_accuracy: 0.9471
Confusion matrix: 
 [[550  23]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.281 0.719]]
Validation f1: 58.97
Validation accuracy: 94.71
Validation recall: 71.88
Validation precision: 50.00
Validation AUC: 0.6223801414285934
Validation class accuracies: [0.9598603839441536, 0.71875]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 30/65
166/166 - 240s - loss: 0.0183 - accuracy: 0.9951 - val_loss: 0.2603 - val_accuracy: 0.9339
Confusion matrix: 
 [[540  33]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.219 0.781]]
Validation f1: 55.56
Validation accuracy: 93.39
Validation recall: 78.12
Validation precision: 43.10
Validation AUC: 0.6623831717321211
Validation class accuracies: [0.9424083769633508, 0.78125]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 13 epochs
Epoch 31/65
166/166 - 240s - loss: 0.0210 - accuracy: 0.9913 - val_loss: 0.2608 - val_accuracy: 0.9471
Confusion matrix: 
 [[553  20]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.375 0.625]]
Validation f1: 55.56
Validation accuracy: 94.71
Validation recall: 62.50
Validation precision: 50.00
Validation AUC: 0.6230200575449787
Validation class accuracies: [0.9650959860383944, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 14 epochs
Epoch 32/65
166/166 - 240s - loss: 0.0216 - accuracy: 0.9925 - val_loss: 0.2632 - val_accuracy: 0.9471
Confusion matrix: 
 [[555  18]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.438 0.562]]
Validation f1: 52.94
Validation accuracy: 94.71
Validation recall: 56.25
Validation precision: 50.00
Validation AUC: 0.5850255144619029
Validation class accuracies: [0.9685863874345549, 0.5625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 15 epochs
Epoch 33/65
166/166 - 239s - loss: 0.0182 - accuracy: 0.9921 - val_loss: 0.2249 - val_accuracy: 0.9504
Confusion matrix: 
 [[556  17]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.406 0.594]]
Validation f1: 55.88
Validation accuracy: 95.04
Validation recall: 59.38
Validation precision: 52.78
Validation AUC: 0.6052350922229742
Validation class accuracies: [0.9703315881326352, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 16 epochs
Epoch 34/65
166/166 - 240s - loss: 0.0421 - accuracy: 0.9864 - val_loss: 0.3054 - val_accuracy: 0.9306
Confusion matrix: 
 [[543  30]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.375 0.625]]
Validation f1: 48.78
Validation accuracy: 93.06
Validation recall: 62.50
Validation precision: 40.00
Validation AUC: 0.586274130686967
Validation class accuracies: [0.9476439790575916, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 17 epochs
Epoch 35/65
166/166 - 239s - loss: 0.0235 - accuracy: 0.9921 - val_loss: 0.2344 - val_accuracy: 0.9421
Confusion matrix: 
 [[551  22]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.406 0.594]]
Validation f1: 52.05
Validation accuracy: 94.21
Validation recall: 59.38
Validation precision: 46.34
Validation AUC: 0.6040425349407529
Validation class accuracies: [0.9616055846422339, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 36/65
166/166 - 240s - loss: 0.0139 - accuracy: 0.9974 - val_loss: 0.2547 - val_accuracy: 0.9388
Confusion matrix: 
 [[547  26]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.344 0.656]]
Validation f1: 53.16
Validation accuracy: 93.88
Validation recall: 65.62
Validation precision: 44.68
Validation AUC: 0.6015732588982057
Validation class accuracies: [0.9546247818499127, 0.65625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 19 epochs
Epoch 37/65
166/166 - 239s - loss: 0.0143 - accuracy: 0.9947 - val_loss: 0.2336 - val_accuracy: 0.9438
Confusion matrix: 
 [[554  19]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.469 0.531]]
Validation f1: 50.00
Validation accuracy: 94.38
Validation recall: 53.12
Validation precision: 47.22
Validation AUC: 0.5788616942218288
Validation class accuracies: [0.9668411867364747, 0.53125]

The metrics for job 0 with the best target metric are: 
Best cm: [[565   8]
 [ 15  17]]
Best normalized cm: [[0.986 0.014]
 [0.469 0.531]]
Best f1: 0.60
Best accuracy: 0.96
Best recall: 0.53
Best precision: 0.68
Best AUC: 0.57
Best class accuracies: [0.9860383944153578, 0.53125]
Best epoch: 17
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 25616
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_205353-3rwiaywt/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_205353-3rwiaywt/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99472
wandb:         val_accuracy 0.9438
wandb:             _runtime 9467
wandb:           _timestamp 1623886300
wandb:                _step 276
wandb:           train_loss 0.01427
wandb:             val_loss 0.23356
wandb:           val_recall 0.53125
wandb:        val_precision 0.47222
wandb:               val_f1 0.5
wandb:              val_auc 0.57886
wandb:                   lr 6e-05
wandb:          best_val_f1 0.59649
wandb:    best_val_accuracy 0.96198
wandb:   best_val_precision 0.68
wandb:      best_val_recall 0.53125
wandb:             best_auc 0.56775
wandb:           best_epoch 17
wandb: Run history:
wandb:   train_accuracy ▁▃▄▄▄▅▅▅▅▅▆▆▇▇▇▇█▇▇██▇▇██████████████
wandb:     val_accuracy ▁▁█▇▅█▇▆▅█▇█▇█████████▇██████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▄▄▃▃▃▃▃▃▂▂▂▂▂▁▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss █▅▁▃▆▁▂▃▅▁▂▁▃▁▁▂▁▁▂▁▁▂▂▁▂▁▂▂▁▁▁▁▁▂▁▁▁
wandb:       val_recall ██▁▆▅▄▆██▄▅▄▇▅▄▆▄▅▆▅▅▃▅▅▄▅▅▆▆▆▅▅▅▅▅▅▄
wandb:    val_precision ▁▁▇▂▁▅▃▂▂▄▃▄▃▄▄▄█▄▄▅▇█▃▅▄▆▅▅▆▅▆▆▆▅▅▅▅
wandb:           val_f1 ▁▁▃▄▁▆▄▃▂▅▄▅▄▆▅▆█▆▆▇█▇▄▆▆█▇██▇▇▇▇▆▇▇▇
wandb:          val_auc ▁▁▄▆▁▆▆▇▇▆▇▆█▇▆▆▇▇▇▇▇▆▅▆▇█▇█▇█▇▇▇▇▇▇▇
wandb:               lr ████████████▄▄▄▄▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_205353-3rwiaywt


 See logs at ../../new_cache/conv__2229__06_2045__v39__time_frq_masking/logs/