Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2254
Description:  augm_half
2021-06-25 21:30:54.225817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-25 21:30:56.524115: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-25 21:30:56.525029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-25 21:30:56.573003: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:30:56.573751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-25 21:30:56.573782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 21:30:56.577460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 21:30:56.577538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-25 21:30:56.578771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-25 21:30:56.579159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-25 21:30:56.580227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-25 21:30:56.581162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-25 21:30:56.581318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 21:30:56.581424: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:30:56.582169: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:30:56.582849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2254.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2254__06_2129__v39__augm_half
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-25 21:31:01.427715: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-25 21:31:01.427965: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:31:01.428792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-25 21:31:01.428842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 21:31:01.428903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 21:31:01.428926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-25 21:31:01.428949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-25 21:31:01.428971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-25 21:31:01.428993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-25 21:31:01.429015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-25 21:31:01.429036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 21:31:01.429136: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:31:01.429940: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:31:01.430681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-25 21:31:01.430735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 21:31:02.144992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:31:02.145038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-25 21:31:02.145048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-25 21:31:02.145368: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:31:02.146174: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:31:02.146966: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:31:02.147718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 64, 1250, 1)]   0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 64, 1250, 1)     4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 64, 1250, 16)    32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 64, 1250, 16)    32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 64, 1250, 1)     0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 64, 1250, 16)    2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 64, 1250, 16)    6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 64, 1250, 16)    32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 64, 1250, 48)    0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 32, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 32, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 32, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 32, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 32, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 16, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 16, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 16, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 16, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 16, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 8, 156, 64)      0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 8, 156, 64)      256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 8, 156, 64)      0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 8, 156, 128)     91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 8, 156, 128)     230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 4, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 4, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 4, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 4, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 4, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 2, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 2, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 2, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 2, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 2, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-25 21:31:03.500987: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-25 21:31:03.503517: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-25 21:31:03.878374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 21:31:05.734979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 21:31:06.194292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
154/154 - 116s - loss: 1.0188 - accuracy: 0.5517 - val_loss: 1.1985 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.08366808986400828
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 118s - loss: 0.5098 - accuracy: 0.7234 - val_loss: 0.6417 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23970460019419243
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 118s - loss: 0.4605 - accuracy: 0.7661 - val_loss: 0.4634 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2811417331631638
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 4/65
154/154 - 118s - loss: 0.4051 - accuracy: 0.8011 - val_loss: 0.1963 - val_accuracy: 0.9528
Confusion matrix: 
 [[567   6]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.561 0.439]]
Validation f1: 55.38
Validation accuracy: 95.28
Validation recall: 43.90
Validation precision: 75.00
Validation AUC: 0.5633923477827383
Validation class accuracies: [0.9895287958115183, 0.43902439024390244]
Saving model...
Epoch 5/65
154/154 - 117s - loss: 0.3719 - accuracy: 0.8316 - val_loss: 0.4294 - val_accuracy: 0.8599
Confusion matrix: 
 [[495  78]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.195 0.805]]
Validation f1: 43.42
Validation accuracy: 85.99
Validation recall: 80.49
Validation precision: 29.73
Validation AUC: 0.4389504249189251
Validation class accuracies: [0.8638743455497382, 0.8048780487804879]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 117s - loss: 0.3507 - accuracy: 0.8161 - val_loss: 0.2649 - val_accuracy: 0.8941
Confusion matrix: 
 [[523  50]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.366 0.634]]
Validation f1: 44.44
Validation accuracy: 89.41
Validation recall: 63.41
Validation precision: 34.21
Validation AUC: 0.5572124206351968
Validation class accuracies: [0.912739965095986, 0.6341463414634146]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 2 epochs
Epoch 7/65
154/154 - 118s - loss: 0.2948 - accuracy: 0.8568 - val_loss: 0.4509 - val_accuracy: 0.8827
Confusion matrix: 
 [[509  64]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.195 0.805]]
Validation f1: 47.83
Validation accuracy: 88.27
Validation recall: 80.49
Validation precision: 34.02
Validation AUC: 0.5804111229218925
Validation class accuracies: [0.8883071553228621, 0.8048780487804879]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 3 epochs
Epoch 8/65
154/154 - 118s - loss: 0.2656 - accuracy: 0.8816 - val_loss: 1.6511 - val_accuracy: 0.3616
Confusion matrix: 
 [[181 392]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.316 0.684]
 [0.    1.   ]]
Validation f1: 17.30
Validation accuracy: 36.16
Validation recall: 100.00
Validation precision: 9.47
Validation AUC: 0.32207255622244785
Validation class accuracies: [0.3158813263525305, 1.0]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 4 epochs
Epoch 9/65
154/154 - 118s - loss: 0.2710 - accuracy: 0.8662 - val_loss: 1.6776 - val_accuracy: 0.4072
Confusion matrix: 
 [[209 364]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.365 0.635]
 [0.    1.   ]]
Validation f1: 18.39
Validation accuracy: 40.72
Validation recall: 100.00
Validation precision: 10.12
Validation AUC: 0.2536852570254433
Validation class accuracies: [0.3647469458987784, 1.0]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 5 epochs
Epoch 10/65
154/154 - 118s - loss: 0.2461 - accuracy: 0.8954 - val_loss: 2.4960 - val_accuracy: 0.5309
Confusion matrix: 
 [[289 284]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.504 0.496]
 [0.098 0.902]]
Validation f1: 20.44
Validation accuracy: 53.09
Validation recall: 90.24
Validation precision: 11.53
Validation AUC: 0.2608652123403553
Validation class accuracies: [0.5043630017452007, 0.9024390243902439]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
154/154 - 119s - loss: 0.1993 - accuracy: 0.9036 - val_loss: 0.2794 - val_accuracy: 0.9137
Confusion matrix: 
 [[529  44]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.22  0.78 ]]
Validation f1: 54.70
Validation accuracy: 91.37
Validation recall: 78.05
Validation precision: 42.11
Validation AUC: 0.5779259881826844
Validation class accuracies: [0.9232111692844677, 0.7804878048780488]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 7 epochs
Epoch 12/65
154/154 - 119s - loss: 0.1518 - accuracy: 0.9292 - val_loss: 0.3489 - val_accuracy: 0.8941
Confusion matrix: 
 [[515  58]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.171 0.829]]
Validation f1: 51.13
Validation accuracy: 89.41
Validation recall: 82.93
Validation precision: 36.96
Validation AUC: 0.5792861373273628
Validation class accuracies: [0.8987783595113438, 0.8292682926829268]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 8 epochs
Epoch 13/65
154/154 - 119s - loss: 0.2184 - accuracy: 0.9211 - val_loss: 0.6307 - val_accuracy: 0.8192
Confusion matrix: 
 [[468 105]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.146 0.854]]
Validation f1: 38.67
Validation accuracy: 81.92
Validation recall: 85.37
Validation precision: 25.00
Validation AUC: 0.4786432514219315
Validation class accuracies: [0.8167539267015707, 0.8536585365853658]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 9 epochs
Epoch 14/65
154/154 - 119s - loss: 0.1496 - accuracy: 0.9333 - val_loss: 0.4583 - val_accuracy: 0.8860
Confusion matrix: 
 [[508  65]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.122 0.878]]
Validation f1: 50.70
Validation accuracy: 88.60
Validation recall: 87.80
Validation precision: 35.64
Validation AUC: 0.48706849530750645
Validation class accuracies: [0.8865619546247818, 0.8780487804878049]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 10 epochs
Epoch 15/65
154/154 - 118s - loss: 0.1260 - accuracy: 0.9422 - val_loss: 0.5454 - val_accuracy: 0.8779
Confusion matrix: 
 [[511  62]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.317 0.683]]
Validation f1: 42.75
Validation accuracy: 87.79
Validation recall: 68.29
Validation precision: 31.11
Validation AUC: 0.45779563728686984
Validation class accuracies: [0.8917975567190227, 0.6829268292682927]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 11 epochs
Epoch 16/65
154/154 - 119s - loss: 0.1318 - accuracy: 0.9524 - val_loss: 1.6204 - val_accuracy: 0.6938
Confusion matrix: 
 [[385 188]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.672 0.328]
 [0.    1.   ]]
Validation f1: 30.37
Validation accuracy: 69.38
Validation recall: 100.00
Validation precision: 17.90
Validation AUC: 0.503523475805232
Validation class accuracies: [0.6719022687609075, 1.0]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 17/65
154/154 - 118s - loss: 0.1055 - accuracy: 0.9528 - val_loss: 0.3688 - val_accuracy: 0.9072
Confusion matrix: 
 [[524  49]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.195 0.805]]
Validation f1: 53.66
Validation accuracy: 90.72
Validation recall: 80.49
Validation precision: 40.24
Validation AUC: 0.5855613935359808
Validation class accuracies: [0.9144851657940664, 0.8048780487804879]
The validation tracker metric at 0.5538461538461539 hasn't increased by 0 in 13 epochs
Epoch 18/65
154/154 - 118s - loss: 0.1112 - accuracy: 0.9577 - val_loss: 0.2468 - val_accuracy: 0.9300
Confusion matrix: 
 [[538  35]
 [  8  33]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.195 0.805]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.55
Validation accuracy: 93.00
Validation recall: 80.49
Validation precision: 48.53
Validation AUC: 0.5405899696721175
Validation class accuracies: [0.9389179755671903, 0.8048780487804879]
Saving model...
Epoch 19/65
154/154 - 118s - loss: 0.0709 - accuracy: 0.9703 - val_loss: 0.3136 - val_accuracy: 0.9153
Confusion matrix: 
 [[529  44]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.195 0.805]]
Validation f1: 55.93
Validation accuracy: 91.53
Validation recall: 80.49
Validation precision: 42.86
Validation AUC: 0.5651432972824435
Validation class accuracies: [0.9232111692844677, 0.8048780487804879]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 1 epochs
Epoch 20/65
154/154 - 117s - loss: 0.0782 - accuracy: 0.9687 - val_loss: 0.4531 - val_accuracy: 0.8762
Confusion matrix: 
 [[505  68]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.195 0.805]]
Validation f1: 46.48
Validation accuracy: 87.62
Validation recall: 80.49
Validation precision: 32.67
Validation AUC: 0.5110385399179769
Validation class accuracies: [0.881326352530541, 0.8048780487804879]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 2 epochs
Epoch 21/65
154/154 - 117s - loss: 0.0569 - accuracy: 0.9772 - val_loss: 0.5601 - val_accuracy: 0.8583
Confusion matrix: 
 [[494  79]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.195 0.805]]
Validation f1: 43.14
Validation accuracy: 85.83
Validation recall: 80.49
Validation precision: 29.46
Validation AUC: 0.44742832749163186
Validation class accuracies: [0.8621291448516579, 0.8048780487804879]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 3 epochs
Epoch 22/65
154/154 - 117s - loss: 0.0754 - accuracy: 0.9707 - val_loss: 0.4096 - val_accuracy: 0.8616
Confusion matrix: 
 [[496  77]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.866 0.134]
 [0.195 0.805]]
Validation f1: 43.71
Validation accuracy: 86.16
Validation recall: 80.49
Validation precision: 30.00
Validation AUC: 0.44028221006763235
Validation class accuracies: [0.8656195462478184, 0.8048780487804879]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 4 epochs
Epoch 23/65
154/154 - 117s - loss: 0.0510 - accuracy: 0.9784 - val_loss: 0.3401 - val_accuracy: 0.9088
Confusion matrix: 
 [[526  47]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.22  0.78 ]]
Validation f1: 53.33
Validation accuracy: 90.88
Validation recall: 78.05
Validation precision: 40.51
Validation AUC: 0.5151257527240161
Validation class accuracies: [0.9179755671902269, 0.7804878048780488]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 5 epochs
Epoch 24/65
154/154 - 117s - loss: 0.0353 - accuracy: 0.9882 - val_loss: 0.4243 - val_accuracy: 0.8795
Confusion matrix: 
 [[516  57]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.415 0.585]]
Validation f1: 39.34
Validation accuracy: 87.95
Validation recall: 58.54
Validation precision: 29.63
Validation AUC: 0.42775597822445205
Validation class accuracies: [0.900523560209424, 0.5853658536585366]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 25/65
154/154 - 117s - loss: 0.0328 - accuracy: 0.9886 - val_loss: 0.3691 - val_accuracy: 0.9088
Confusion matrix: 
 [[532  41]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.366 0.634]]
Validation f1: 48.15
Validation accuracy: 90.88
Validation recall: 63.41
Validation precision: 38.81
Validation AUC: 0.47982228119188
Validation class accuracies: [0.9284467713787086, 0.6341463414634146]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 7 epochs
Epoch 26/65
154/154 - 117s - loss: 0.0380 - accuracy: 0.9858 - val_loss: 0.3470 - val_accuracy: 0.9169
Confusion matrix: 
 [[535  38]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.317 0.683]]
Validation f1: 52.34
Validation accuracy: 91.69
Validation recall: 68.29
Validation precision: 42.42
Validation AUC: 0.5125422808495809
Validation class accuracies: [0.9336823734729494, 0.6829268292682927]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 8 epochs
Epoch 27/65
154/154 - 117s - loss: 0.0452 - accuracy: 0.9845 - val_loss: 0.3895 - val_accuracy: 0.9121
Confusion matrix: 
 [[529  44]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.244 0.756]]
Validation f1: 53.45
Validation accuracy: 91.21
Validation recall: 75.61
Validation precision: 41.33
Validation AUC: 0.5071763128981656
Validation class accuracies: [0.9232111692844677, 0.7560975609756098]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 9 epochs
Epoch 28/65
154/154 - 117s - loss: 0.0293 - accuracy: 0.9902 - val_loss: 0.2908 - val_accuracy: 0.9251
Confusion matrix: 
 [[541  32]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.341 0.659]]
Validation f1: 54.00
Validation accuracy: 92.51
Validation recall: 65.85
Validation precision: 45.76
Validation AUC: 0.5206162999818831
Validation class accuracies: [0.944153577661431, 0.6585365853658537]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 10 epochs
Epoch 29/65
154/154 - 117s - loss: 0.0234 - accuracy: 0.9935 - val_loss: 0.4391 - val_accuracy: 0.9023
Confusion matrix: 
 [[526  47]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.317 0.683]]
Validation f1: 48.28
Validation accuracy: 90.23
Validation recall: 68.29
Validation precision: 37.33
Validation AUC: 0.4727417618587733
Validation class accuracies: [0.9179755671902269, 0.6829268292682927]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 11 epochs
Epoch 30/65
154/154 - 117s - loss: 0.0237 - accuracy: 0.9919 - val_loss: 0.4076 - val_accuracy: 0.9023
Confusion matrix: 
 [[529  44]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.39  0.61 ]]
Validation f1: 45.45
Validation accuracy: 90.23
Validation recall: 60.98
Validation precision: 36.23
Validation AUC: 0.4687694831416082
Validation class accuracies: [0.9232111692844677, 0.6097560975609756]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 31/65
154/154 - 117s - loss: 0.0217 - accuracy: 0.9915 - val_loss: 0.3547 - val_accuracy: 0.9186
Confusion matrix: 
 [[536  37]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.317 0.683]]
Validation f1: 52.83
Validation accuracy: 91.86
Validation recall: 68.29
Validation precision: 43.08
Validation AUC: 0.4920336851952377
Validation class accuracies: [0.9354275741710296, 0.6829268292682927]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 13 epochs
Epoch 32/65
154/154 - 117s - loss: 0.0244 - accuracy: 0.9935 - val_loss: 0.4371 - val_accuracy: 0.9055
Confusion matrix: 
 [[531  42]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.39  0.61 ]]
Validation f1: 46.30
Validation accuracy: 90.55
Validation recall: 60.98
Validation precision: 37.31
Validation AUC: 0.46244704956123034
Validation class accuracies: [0.9267015706806283, 0.6097560975609756]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 14 epochs
Epoch 33/65
154/154 - 117s - loss: 0.0225 - accuracy: 0.9939 - val_loss: 0.3856 - val_accuracy: 0.9121
Confusion matrix: 
 [[535  38]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.39  0.61 ]]
Validation f1: 48.08
Validation accuracy: 91.21
Validation recall: 60.98
Validation precision: 39.68
Validation AUC: 0.4624529854345942
Validation class accuracies: [0.9336823734729494, 0.6097560975609756]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 15 epochs
Epoch 34/65
154/154 - 117s - loss: 0.0205 - accuracy: 0.9959 - val_loss: 0.4503 - val_accuracy: 0.9023
Confusion matrix: 
 [[529  44]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.45
Validation accuracy: 90.23
Validation recall: 60.98
Validation precision: 36.23
Validation AUC: 0.4559825446060366
Validation class accuracies: [0.9232111692844677, 0.6097560975609756]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 16 epochs
Epoch 35/65
154/154 - 117s - loss: 0.0198 - accuracy: 0.9931 - val_loss: 0.4260 - val_accuracy: 0.9088
Confusion matrix: 
 [[531  42]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.341 0.659]]
Validation f1: 49.09
Validation accuracy: 90.88
Validation recall: 65.85
Validation precision: 39.13
Validation AUC: 0.48669977587894026
Validation class accuracies: [0.9267015706806283, 0.6585365853658537]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 17 epochs
Epoch 36/65
154/154 - 117s - loss: 0.0153 - accuracy: 0.9955 - val_loss: 0.3492 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.5246288249947723
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 37/65
154/154 - 117s - loss: 0.0193 - accuracy: 0.9943 - val_loss: 0.3436 - val_accuracy: 0.9235
Confusion matrix: 
 [[540  33]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.341 0.659]]
Validation f1: 53.47
Validation accuracy: 92.35
Validation recall: 65.85
Validation precision: 45.00
Validation AUC: 0.5167562303231059
Validation class accuracies: [0.9424083769633508, 0.6585365853658537]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 19 epochs
Epoch 38/65
154/154 - 117s - loss: 0.0259 - accuracy: 0.9935 - val_loss: 0.4196 - val_accuracy: 0.9137
Confusion matrix: 
 [[534  39]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.341 0.659]]
Validation f1: 50.47
Validation accuracy: 91.37
Validation recall: 65.85
Validation precision: 40.91
Validation AUC: 0.49799011642659374
Validation class accuracies: [0.9319371727748691, 0.6585365853658537]

The metrics for job 0 with the best target metric are: 
Best cm: [[538  35]
 [  8  33]]
Best normalized cm: [[0.939 0.061]
 [0.195 0.805]]
Best f1: 0.61
Best accuracy: 0.93
Best recall: 0.80
Best precision: 0.49
Best AUC: 0.54
Best class accuracies: [0.9389179755671903, 0.8048780487804879]
Best epoch: 18
The number of epochs since last 1% equals the patience
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.019]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.073]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[9.295e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.212]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.03]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[5.741e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.04]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_1.png, [[0.943]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2254__06_2129__v39__augm_half/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.952]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 27680
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_213056-2wby2mbe/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_213056-2wby2mbe/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99349
wandb:         val_accuracy 0.91368
wandb:             _runtime 4891
wandb:           _timestamp 1624661548
wandb:                _step 274
wandb:           train_loss 0.02592
wandb:             val_loss 0.41961
wandb:           val_recall 0.65854
wandb:        val_precision 0.40909
wandb:               val_f1 0.50467
wandb:              val_auc 0.49799
wandb:                   lr 3e-05
wandb:          best_val_f1 0.6055
wandb:    best_val_accuracy 0.92997
wandb:   best_val_precision 0.48529
wandb:      best_val_recall 0.80488
wandb:             best_auc 0.54059
wandb:           best_epoch 18
wandb: Run history:
wandb:   train_accuracy ▁▄▄▅▅▅▆▆▆▆▇▇▇▇▇▇▇▇████████████████████
wandb:     val_accuracy ▁███▇█▇▃▄▅██▇▇▇▆███▇▇▇█▇██████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▄▂▂▁▂▁▂▅▆█▁▁▂▂▂▅▂▁▁▂▂▂▁▂▂▁▂▁▂▂▁▂▂▂▂▁▁▂
wandb:       val_recall █▁▁▄▇▅▇██▇▆▇▇▇▆█▇▇▇▇▇▇▆▅▅▆▆▆▆▅▆▅▅▅▆▆▆▆
wandb:    val_precision ▂▁▁█▄▄▄▂▂▂▅▄▃▄▄▃▅▆▅▄▄▄▅▄▅▅▅▅▄▄▅▄▅▄▅▅▅▅
wandb:           val_f1 ▂▁▁▇▆▆▇▃▃▃▇▇▅▇▆▅▇█▇▆▆▆▇▆▇▇▇▇▇▆▇▆▇▆▇▇▇▇
wandb:          val_auc ▁▃▄█▆██▄▃▃██▇▇▆▇█▇█▇▆▆▇▆▇▇▇▇▆▆▇▆▆▆▇▇▇▇
wandb:               lr ██████████▄▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_213056-2wby2mbe

-----------------------
Mixednet
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 64, 1250, 1)]                       0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 64, 1250, 8)                         80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 64, 1250, 8)                         162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 32, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 32, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 32, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 32, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 16, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 16, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 16, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 16, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 8, 157, 32)                          0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 8, 157, 32)                          128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 8, 157, 64)                          18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 8, 157, 64)                          1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 4, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 4, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 4, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 4, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 2, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 2, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 54s - loss: 0.5420 - accuracy: 0.6343 - val_loss: 0.6287 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20615620454379502
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 50s - loss: 0.3432 - accuracy: 0.8088 - val_loss: 0.9065 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.0811843599295126
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 3/65
154/154 - 54s - loss: 0.2926 - accuracy: 0.8739 - val_loss: 1.5788 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.5284151537751711
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 4/65
154/154 - 50s - loss: 0.1915 - accuracy: 0.9194 - val_loss: 0.6291 - val_accuracy: 0.7052
Confusion matrix: 
 [[398 175]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.695 0.305]
 [0.146 0.854]]
Validation f1: 27.89
Validation accuracy: 70.52
Validation recall: 85.37
Validation precision: 16.67
Validation AUC: 0.42933766965148507
Validation class accuracies: [0.6945898778359512, 0.8536585365853658]
Saving model...
Epoch 5/65
154/154 - 53s - loss: 0.1814 - accuracy: 0.9272 - val_loss: 0.7256 - val_accuracy: 0.7443
Confusion matrix: 
 [[416 157]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.    1.   ]]
Validation f1: 34.31
Validation accuracy: 74.43
Validation recall: 100.00
Validation precision: 20.71
Validation AUC: 0.4783384185642121
Validation class accuracies: [0.7260034904013961, 1.0]
Saving model...
Epoch 6/65
154/154 - 50s - loss: 0.1126 - accuracy: 0.9565 - val_loss: 0.4549 - val_accuracy: 0.8485
Confusion matrix: 
 [[484  89]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.845 0.155]
 [0.098 0.902]]
Validation f1: 44.31
Validation accuracy: 84.85
Validation recall: 90.24
Validation precision: 29.37
Validation AUC: 0.5058951326133201
Validation class accuracies: [0.8446771378708552, 0.9024390243902439]
Saving model...
Epoch 7/65
154/154 - 53s - loss: 0.0841 - accuracy: 0.9748 - val_loss: 2.1591 - val_accuracy: 0.5700
Confusion matrix: 
 [[311 262]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.543 0.457]
 [0.049 0.951]]
Validation f1: 22.81
Validation accuracy: 57.00
Validation recall: 95.12
Validation precision: 12.96
Validation AUC: 0.4226021706271131
Validation class accuracies: [0.5427574171029669, 0.9512195121951219]
The validation tracker metric at 0.4431137724550898 hasn't increased by 0 in 1 epochs
Epoch 8/65
154/154 - 50s - loss: 0.0756 - accuracy: 0.9691 - val_loss: 0.3503 - val_accuracy: 0.8746
Confusion matrix: 
 [[505  68]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.22  0.78 ]]
Validation f1: 45.39
Validation accuracy: 87.46
Validation recall: 78.05
Validation precision: 32.00
Validation AUC: 0.5249403628599493
Validation class accuracies: [0.881326352530541, 0.7804878048780488]
Saving model...
Epoch 9/65
154/154 - 53s - loss: 0.0470 - accuracy: 0.9866 - val_loss: 0.2609 - val_accuracy: 0.9104
Confusion matrix: 
 [[529  44]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.268 0.732]]
Validation f1: 52.17
Validation accuracy: 91.04
Validation recall: 73.17
Validation precision: 40.54
Validation AUC: 0.47798064437037796
Validation class accuracies: [0.9232111692844677, 0.7317073170731707]
Saving model...
Epoch 10/65
154/154 - 51s - loss: 0.0285 - accuracy: 0.9947 - val_loss: 0.3422 - val_accuracy: 0.9072
Confusion matrix: 
 [[527  46]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.28
Validation accuracy: 90.72
Validation recall: 73.17
Validation precision: 39.47
Validation AUC: 0.5239242473049122
Validation class accuracies: [0.9197207678883071, 0.7317073170731707]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 1 epochs
Epoch 11/65
154/154 - 51s - loss: 0.0224 - accuracy: 0.9943 - val_loss: 0.2582 - val_accuracy: 0.9300
Confusion matrix: 
 [[541  32]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.268 0.732]]
Validation f1: 58.25
Validation accuracy: 93.00
Validation recall: 73.17
Validation precision: 48.39
Validation AUC: 0.5768141233097938
Validation class accuracies: [0.944153577661431, 0.7317073170731707]
Saving model...
Epoch 12/65
154/154 - 51s - loss: 0.0149 - accuracy: 0.9976 - val_loss: 0.3756 - val_accuracy: 0.8925
Confusion matrix: 
 [[515  58]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.195 0.805]]
Validation f1: 50.00
Validation accuracy: 89.25
Validation recall: 80.49
Validation precision: 36.26
Validation AUC: 0.5028278464644956
Validation class accuracies: [0.8987783595113438, 0.8048780487804879]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 1 epochs
Epoch 13/65
154/154 - 50s - loss: 0.0237 - accuracy: 0.9923 - val_loss: 0.3147 - val_accuracy: 0.8958
Confusion matrix: 
 [[522  51]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.317 0.683]]
Validation f1: 46.67
Validation accuracy: 89.58
Validation recall: 68.29
Validation precision: 35.44
Validation AUC: 0.47616302659127063
Validation class accuracies: [0.9109947643979057, 0.6829268292682927]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 2 epochs
Epoch 14/65
154/154 - 53s - loss: 0.0221 - accuracy: 0.9955 - val_loss: 0.3228 - val_accuracy: 0.9153
Confusion matrix: 
 [[532  41]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.268 0.732]]
Validation f1: 53.57
Validation accuracy: 91.53
Validation recall: 73.17
Validation precision: 42.25
Validation AUC: 0.548778251529701
Validation class accuracies: [0.9284467713787086, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 3 epochs
Epoch 15/65
154/154 - 50s - loss: 0.0099 - accuracy: 0.9992 - val_loss: 0.2755 - val_accuracy: 0.9186
Confusion matrix: 
 [[534  39]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.268 0.732]]
Validation f1: 54.55
Validation accuracy: 91.86
Validation recall: 73.17
Validation precision: 43.48
Validation AUC: 0.5451510930295559
Validation class accuracies: [0.9319371727748691, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 4 epochs
Epoch 16/65
154/154 - 53s - loss: 0.0064 - accuracy: 1.0000 - val_loss: 0.3254 - val_accuracy: 0.9153
Confusion matrix: 
 [[532  41]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.268 0.732]]
Validation f1: 53.57
Validation accuracy: 91.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 73.17
Validation precision: 42.25
Validation AUC: 0.5414617015783133
Validation class accuracies: [0.9284467713787086, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 5 epochs
Epoch 17/65
154/154 - 51s - loss: 0.0049 - accuracy: 0.9996 - val_loss: 0.2945 - val_accuracy: 0.9202
Confusion matrix: 
 [[535  38]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.268 0.732]]
Validation f1: 55.05
Validation accuracy: 92.02
Validation recall: 73.17
Validation precision: 44.12
Validation AUC: 0.5524333939735748
Validation class accuracies: [0.9336823734729494, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 18/65
154/154 - 54s - loss: 0.0045 - accuracy: 1.0000 - val_loss: 0.3978 - val_accuracy: 0.8909
Confusion matrix: 
 [[516  57]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.244 0.756]]
Validation f1: 48.06
Validation accuracy: 89.09
Validation recall: 75.61
Validation precision: 35.23
Validation AUC: 0.5418535947229283
Validation class accuracies: [0.900523560209424, 0.7560975609756098]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 7 epochs
Epoch 19/65
154/154 - 50s - loss: 0.0054 - accuracy: 0.9996 - val_loss: 0.4135 - val_accuracy: 0.8844
Confusion matrix: 
 [[513  60]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.268 0.732]]
Validation f1: 45.80
Validation accuracy: 88.44
Validation recall: 73.17
Validation precision: 33.33
Validation AUC: 0.530661395344321
Validation class accuracies: [0.8952879581151832, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 8 epochs
Epoch 20/65
154/154 - 53s - loss: 0.0045 - accuracy: 1.0000 - val_loss: 0.3128 - val_accuracy: 0.9186
Confusion matrix: 
 [[534  39]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.55
Validation accuracy: 91.86
Validation recall: 73.17
Validation precision: 43.48
Validation AUC: 0.5317800194224462
Validation class accuracies: [0.9319371727748691, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 9 epochs
Epoch 21/65
154/154 - 50s - loss: 0.0042 - accuracy: 1.0000 - val_loss: 0.3296 - val_accuracy: 0.9169
Confusion matrix: 
 [[533  40]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.268 0.732]]
Validation f1: 54.05
Validation accuracy: 91.69
Validation recall: 73.17
Validation precision: 42.86
Validation AUC: 0.5379548929635497
Validation class accuracies: [0.9301919720767888, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 10 epochs
Epoch 22/65
154/154 - 52s - loss: 0.0049 - accuracy: 1.0000 - val_loss: 0.2839 - val_accuracy: 0.9251
Confusion matrix: 
 [[538  35]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.268 0.732]]
Validation f1: 56.60
Validation accuracy: 92.51
Validation recall: 73.17
Validation precision: 46.15
Validation AUC: 0.5511673698220704
Validation class accuracies: [0.9389179755671903, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 11 epochs
Epoch 23/65
154/154 - 50s - loss: 0.0033 - accuracy: 1.0000 - val_loss: 0.3253 - val_accuracy: 0.9169
Confusion matrix: 
 [[533  40]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.05
Validation accuracy: 91.69
Validation recall: 73.17
Validation precision: 42.86
Validation AUC: 0.5385070395508509
Validation class accuracies: [0.9301919720767888, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 24/65
154/154 - 51s - loss: 0.0033 - accuracy: 1.0000 - val_loss: 0.3497 - val_accuracy: 0.9153
Confusion matrix: 
 [[532  41]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.57
Validation accuracy: 91.53
Validation recall: 73.17
Validation precision: 42.25
Validation AUC: 0.5351688649287334
Validation class accuracies: [0.9284467713787086, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 13 epochs
Epoch 25/65
154/154 - 51s - loss: 0.0041 - accuracy: 1.0000 - val_loss: 0.3420 - val_accuracy: 0.9202
Confusion matrix: 
 [[535  38]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.05
Validation accuracy: 92.02
Validation recall: 73.17
Validation precision: 44.12
Validation AUC: 0.5272230111435259
Validation class accuracies: [0.9336823734729494, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 14 epochs
Epoch 26/65
154/154 - 50s - loss: 0.0031 - accuracy: 1.0000 - val_loss: 0.3677 - val_accuracy: 0.9104
Confusion matrix: 
 [[528  45]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.244 0.756]]
Validation f1: 52.99
Validation accuracy: 91.04
Validation recall: 75.61
Validation precision: 40.79
Validation AUC: 0.5339667825504374
Validation class accuracies: [0.9214659685863874, 0.7560975609756098]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 15 epochs
Epoch 27/65
154/154 - 53s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.3888 - val_accuracy: 0.9039
Confusion matrix: 
 [[525  48]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.268 0.732]]
Validation f1: 50.42
Validation accuracy: 90.39
Validation recall: 73.17
Validation precision: 38.46
Validation AUC: 0.5282480545054281
Validation class accuracies: [0.9162303664921466, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 16 epochs
Epoch 28/65
154/154 - 50s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.4055 - val_accuracy: 0.8990
Confusion matrix: 
 [[521  52]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.244 0.756]]
Validation f1: 50.00
Validation accuracy: 89.90
Validation recall: 75.61
Validation precision: 37.35
Validation AUC: 0.5293741578740345
Validation class accuracies: [0.9092495636998255, 0.7560975609756098]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 17 epochs
Epoch 29/65
154/154 - 53s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.3149 - val_accuracy: 0.9267
Confusion matrix: 
 [[539  34]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.268 0.732]]
Validation f1: 57.14
Validation accuracy: 92.67
Validation recall: 73.17
Validation precision: 46.88
Validation AUC: 0.5424744414568564
Validation class accuracies: [0.9406631762652705, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 30/65
154/154 - 50s - loss: 0.0049 - accuracy: 1.0000 - val_loss: 0.4090 - val_accuracy: 0.9153
Confusion matrix: 
 [[532  41]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.268 0.732]]
Validation f1: 53.57
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 91.53
Validation recall: 73.17
Validation precision: 42.25
Validation AUC: 0.5200955198795348
Validation class accuracies: [0.9284467713787086, 0.7317073170731707]
The validation tracker metric at 0.5825242718446603 hasn't increased by 0 in 19 epochs
Epoch 31/65
154/154 - 53s - loss: 0.0025 - accuracy: 1.0000 - val_loss: 0.3690 - val_accuracy: 0.9235
Confusion matrix: 
 [[537  36]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.268 0.732]]
Validation f1: 56.07
Validation accuracy: 92.35
Validation recall: 73.17
Validation precision: 45.45
Validation AUC: 0.5214761159909524
Validation class accuracies: [0.93717277486911, 0.7317073170731707]

The metrics for job 1 with the best target metric are: 
Best cm: [[541  32]
 [ 11  30]]
Best normalized cm: [[0.944 0.056]
 [0.268 0.732]]
Best f1: 0.58
Best accuracy: 0.93
Best recall: 0.73
Best precision: 0.48
Best AUC: 0.58
Best class accuracies: [0.944153577661431, 0.7317073170731707]
Best epoch: 11
The number of epochs since last 1% equals the patience
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_219_2b3_Tc_mc_LittC2SE_1_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_205_1b3_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_218_1b1_Al_sc_Meditron_4_label_0_pred_0.png, [[4.215e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_219_2b2_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_207_2b4_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_218_1b1_Al_sc_Meditron_13_label_0_pred_0.png, [[0.021]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_205_1b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_207_2b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_207_3b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_205_1b3_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_1p2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_1p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_212_2b2_Tc_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_2p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.021]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_1p2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_1p2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_221_2b2_Pl_mc_LittC2SE_0_label_0_pred_1.png, [[0.872]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_215_1b3_Tc_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_211_2p4_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.362]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[9.36e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_204_7p5_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[7.874e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_1p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_1p5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_205_3b4_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_218_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_223_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_223_1b1_Lr_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_222_1b1_Lr_sc_Meditron_6_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_219_2b1_Tc_mc_LittC2SE_3_label_1_pred_1.png, [[0.979]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_207_2b2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_226_1b1_Ll_sc_Meditron_0_label_1_pred_0.png, [[0.003]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_205_2b4_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_225_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_226_1b1_Al_sc_Meditron_3_label_1_pred_0.png, [[0.086]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_213_1p3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_218_1b1_Pl_sc_Meditron_10_label_0_pred_0.png, [[9.787e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_203_2p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_223_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_218_1p1_Pl_sc_Litt3200_5_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_205_3b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/1/icbhi_207_2b4_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 6321
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_225301-20c88d8c/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_225301-20c88d8c/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.92345
wandb:             _runtime 1922
wandb:           _timestamp 1624663504
wandb:                _step 237
wandb:           train_loss 0.00245
wandb:             val_loss 0.36901
wandb:           val_recall 0.73171
wandb:        val_precision 0.45455
wandb:               val_f1 0.56075
wandb:              val_auc 0.52148
wandb:                   lr 0.00013
wandb:          best_val_f1 0.58252
wandb:    best_val_accuracy 0.92997
wandb:   best_val_precision 0.48387
wandb:      best_val_recall 0.73171
wandb:             best_auc 0.57681
wandb:           best_epoch 11
wandb: Run history:
wandb:   train_accuracy ▁▄▆▆▇▇█▇███████████████████████
wandb:     val_accuracy █▁▁▆▆▇▅████████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▃▆▂▃▂█▁▁▁▁▁▁▁▁▁▁▂▂▁▁▁▁▁▁▁▁▂▁▂▁
wandb:       val_recall ▁██▇█▇█▆▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▂▂▃▄▅▃▆▇▇█▆▆▇▇▇▇▆▆▇▇█▇▇▇▇▇▆█▇█
wandb:           val_f1 ▁▃▃▄▅▆▄▆▇▇█▇▇▇█▇█▇▇█▇█▇▇█▇▇▇█▇█
wandb:          val_auc ▃▁▇▆▇▇▆▇▇▇█▇▇█████▇▇▇█▇▇▇▇▇▇█▇▇
wandb:               lr █████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_225301-20c88d8c

-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 1e-05, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 64, 1250, 1)]   0                                                 
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 64, 1250, 1)     4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 64, 1250, 1)     0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 64, 1250, 16)    2320         conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 64, 1250, 16)    6416         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 64, 1250, 16)    32           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_36186 (Concatenate)     (None, 64, 1250, 48)    0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 32, 625, 48)     0            concatenate_36186[0][0]              
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 32, 625, 48)     192          average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 32, 625, 48)     0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 32, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 32, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 16, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 16, 312, 32)     128          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 16, 312, 32)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 16, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 16, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 8, 156, 64)      0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 8, 156, 64)      256          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 8, 156, 64)      0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 8, 156, 128)     91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 8, 156, 128)     230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 4, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 4, 78, 128)      512          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 4, 78, 128)      0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 4, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 4, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 2, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 2, 39, 256)      1024         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 2, 39, 256)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 2, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 2, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               513          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 118s - loss: 0.9996 - accuracy: 0.5899 - val_loss: 0.4274 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05583775387073538
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 117s - loss: 0.5277 - accuracy: 0.7274 - val_loss: 0.4219 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08703750683855492
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 117s - loss: 0.4782 - accuracy: 0.7567 - val_loss: 0.2562 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.15312293312051556
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 117s - loss: 0.5125 - accuracy: 0.7624 - val_loss: 0.6275 - val_accuracy: 0.7785
Confusion matrix: 
 [[471 102]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.829 0.171]]
Validation f1: 9.33
Validation accuracy: 77.85
Validation recall: 17.07
Validation precision: 6.42
Validation AUC: 0.07122601349998425
Validation class accuracies: [0.8219895287958116, 0.17073170731707318]
Saving model...
Epoch 5/65
154/154 - 117s - loss: 0.4952 - accuracy: 0.7408 - val_loss: 0.4362 - val_accuracy: 0.9397
Confusion matrix: 
 [[573   0]
 [ 37   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.902 0.098]]
Validation f1: 17.78
Validation accuracy: 93.97
Validation recall: 9.76
Validation precision: 100.00
Validation AUC: 0.502302486309173
Validation class accuracies: [1.0, 0.0975609756097561]
Saving model...
Epoch 6/65
154/154 - 117s - loss: 0.4024 - accuracy: 0.7913 - val_loss: 0.6157 - val_accuracy: 0.7850
Confusion matrix: 
 [[447 126]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.146 0.854]]
Validation f1: 34.65
Validation accuracy: 78.50
Validation recall: 85.37
Validation precision: 21.74
Validation AUC: 0.4325250127366056
Validation class accuracies: [0.7801047120418848, 0.8536585365853658]
Saving model...
Epoch 7/65
154/154 - 117s - loss: 0.3877 - accuracy: 0.7669 - val_loss: 0.7490 - val_accuracy: 0.7834
Confusion matrix: 
 [[443 130]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.073 0.927]]
Validation f1: 36.36
Validation accuracy: 78.34
Validation recall: 92.68
Validation precision: 22.62
Validation AUC: 0.5686977252002999
Validation class accuracies: [0.7731239092495636, 0.926829268292683]
Saving model...
Epoch 8/65
154/154 - 117s - loss: 0.3361 - accuracy: 0.8385 - val_loss: 0.3914 - val_accuracy: 0.8127
Confusion matrix: 
 [[474  99]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.827 0.173]
 [0.39  0.61 ]]
Validation f1: 30.30
Validation accuracy: 81.27
Validation recall: 60.98
Validation precision: 20.16
Validation AUC: 0.19164915274038946
Validation class accuracies: [0.8272251308900523, 0.6097560975609756]
The validation tracker metric at 0.36363636363636365 hasn't increased by 0 in 1 epochs
Epoch 9/65
154/154 - 117s - loss: 0.3852 - accuracy: 0.8291 - val_loss: 4.6518 - val_accuracy: 0.1824
Confusion matrix: 
 [[ 71 502]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.124 0.876]
 [0.    1.   ]]
Validation f1: 14.04
Validation accuracy: 18.24
Validation recall: 100.00
Validation precision: 7.55
Validation AUC: 0.5182310211929011
Validation class accuracies: [0.12390924956369982, 1.0]
The validation tracker metric at 0.36363636363636365 hasn't increased by 0 in 2 epochs
Epoch 10/65
154/154 - 117s - loss: 0.4607 - accuracy: 0.8027 - val_loss: 2.4082 - val_accuracy: 0.6059
Confusion matrix: 
 [[370 203]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.646 0.354]
 [0.951 0.049]]
Validation f1: 1.63
Validation accuracy: 60.59
Validation recall: 4.88
Validation precision: 0.98
Validation AUC: 0.0372780327992739
Validation class accuracies: [0.6457242582897034, 0.04878048780487805]
The validation tracker metric at 0.36363636363636365 hasn't increased by 0 in 3 epochs
Epoch 11/65
154/154 - 116s - loss: 0.3289 - accuracy: 0.8279 - val_loss: 0.2385 - val_accuracy: 0.9104
Confusion matrix: 
 [[535  38]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.415 0.585]]
Validation f1: 46.60
Validation accuracy: 91.04
Validation recall: 58.54
Validation precision: 38.71
Validation AUC: 0.5415302133113903
Validation class accuracies: [0.9336823734729494, 0.5853658536585366]
Saving model...
Epoch 12/65
154/154 - 117s - loss: 0.2825 - accuracy: 0.8592 - val_loss: 0.7485 - val_accuracy: 0.8013
Confusion matrix: 
 [[461 112]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.805 0.195]
 [0.244 0.756]]
Validation f1: 33.70
Validation accuracy: 80.13
Validation recall: 75.61
Validation precision: 21.68
Validation AUC: 0.28210767030082917
Validation class accuracies: [0.8045375218150087, 0.7560975609756098]
The validation tracker metric at 0.4660194174757281 hasn't increased by 0 in 1 epochs
Epoch 13/65
154/154 - 118s - loss: 0.2675 - accuracy: 0.8836 - val_loss: 0.3505 - val_accuracy: 0.8974
Confusion matrix: 
 [[522  51]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.293 0.707]]
Validation f1: 47.93
Validation accuracy: 89.74
Validation recall: 70.73
Validation precision: 36.25
Validation AUC: 0.43598118790508694
Validation class accuracies: [0.9109947643979057, 0.7073170731707317]
Saving model...
Epoch 14/65
154/154 - 117s - loss: 0.2463 - accuracy: 0.8865 - val_loss: 1.7849 - val_accuracy: 0.6368
Confusion matrix: 
 [[351 222]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.613 0.387]
 [0.024 0.976]]
Validation f1: 26.40
Validation accuracy: 63.68
Validation recall: 97.56
Validation precision: 15.27
Validation AUC: 0.2551993988366597
Validation class accuracies: [0.612565445026178, 0.975609756097561]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 1 epochs
Epoch 15/65
154/154 - 117s - loss: 0.2545 - accuracy: 0.8877 - val_loss: 0.7886 - val_accuracy: 0.8094
Confusion matrix: 
 [[463 110]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.808 0.192]
 [0.171 0.829]]
Validation f1: 36.76
Validation accuracy: 80.94
Validation recall: 82.93
Validation precision: 23.61
Validation AUC: 0.35355584213876123
Validation class accuracies: [0.8080279232111692, 0.8292682926829268]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 2 epochs
Epoch 16/65
154/154 - 117s - loss: 0.3367 - accuracy: 0.8747 - val_loss: 1.4665 - val_accuracy: 0.5423
Confusion matrix: 
 [[298 275]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.52  0.48 ]
 [0.146 0.854]]
Validation f1: 19.94
Validation accuracy: 54.23
Validation recall: 85.37
Validation precision: 11.29
Validation AUC: 0.2720596261032463
Validation class accuracies: [0.5200698080279232, 0.8536585365853658]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 3 epochs
Epoch 17/65
154/154 - 117s - loss: 0.2461 - accuracy: 0.8857 - val_loss: 0.2860 - val_accuracy: 0.8893
Confusion matrix: 
 [[525  48]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.488 0.512]]
Validation f1: 38.18
Validation accuracy: 88.93
Validation recall: 51.22
Validation precision: 30.43
Validation AUC: 0.49109928554346854
Validation class accuracies: [0.9162303664921466, 0.5121951219512195]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 4 epochs
Epoch 18/65
154/154 - 117s - loss: 0.2193 - accuracy: 0.9020 - val_loss: 0.5206 - val_accuracy: 0.8453
Confusion matrix: 
 [[485  88]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.171 0.829]]
Validation f1: 41.72
Validation accuracy: 84.53
Validation recall: 82.93
Validation precision: 27.87
Validation AUC: 0.2756051428983141
Validation class accuracies: [0.8464223385689355, 0.8292682926829268]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 5 epochs
Epoch 19/65
154/154 - 117s - loss: 0.2254 - accuracy: 0.9015 - val_loss: 1.2031 - val_accuracy: 0.7020
Confusion matrix: 
 [[391 182]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.682 0.318]
 [0.024 0.976]]
Validation f1: 30.42
Validation accuracy: 70.20
Validation recall: 97.56
Validation precision: 18.02
Validation AUC: 0.24641932498038804
Validation class accuracies: [0.6823734729493892, 0.975609756097561]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 20/65
154/154 - 117s - loss: 0.1970 - accuracy: 0.9182 - val_loss: 0.4713 - val_accuracy: 0.8388
Confusion matrix: 
 [[479  94]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.836 0.164]
 [0.122 0.878]]
Validation f1: 42.11
Validation accuracy: 83.88
Validation recall: 87.80
Validation precision: 27.69
Validation AUC: 0.3406838876504955
Validation class accuracies: [0.8359511343804538, 0.8780487804878049]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 7 epochs
Epoch 21/65
154/154 - 117s - loss: 0.1316 - accuracy: 0.9439 - val_loss: 0.8939 - val_accuracy: 0.7752
Confusion matrix: 
 [[435 138]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.759 0.241]
 [0.    1.   ]]
Validation f1: 37.27
Validation accuracy: 77.52
Validation recall: 100.00
Validation precision: 22.91
Validation AUC: 0.3327172843336249
Validation class accuracies: [0.7591623036649214, 1.0]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 8 epochs
Epoch 22/65
154/154 - 117s - loss: 0.1219 - accuracy: 0.9459 - val_loss: 0.6313 - val_accuracy: 0.8697
Confusion matrix: 
 [[505  68]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.293 0.707]]
Validation f1: 42.03
Validation accuracy: 86.97
Validation recall: 70.73
Validation precision: 29.90
Validation AUC: 0.31207601239692956
Validation class accuracies: [0.881326352530541, 0.7073170731707317]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 9 epochs
Epoch 23/65
154/154 - 117s - loss: 0.1190 - accuracy: 0.9536 - val_loss: 0.3703 - val_accuracy: 0.8795
Confusion matrix: 
 [[505  68]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.146 0.854]]
Validation f1: 48.61
Validation accuracy: 87.95
Validation recall: 85.37
Validation precision: 33.98
Validation AUC: 0.38753195948808516
Validation class accuracies: [0.881326352530541, 0.8536585365853658]
Saving model...
Epoch 24/65
154/154 - 117s - loss: 0.1392 - accuracy: 0.9406 - val_loss: 1.5646 - val_accuracy: 0.6596
Confusion matrix: 
 [[364 209]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.635 0.365]
 [0.    1.   ]]
Validation f1: 28.18
Validation accuracy: 65.96
Validation recall: 100.00
Validation precision: 16.40
Validation AUC: 0.23388852413031933
Validation class accuracies: [0.6352530541012217, 1.0]
The validation tracker metric at 0.4861111111111111 hasn't increased by 0 in 1 epochs
Epoch 25/65
154/154 - 117s - loss: 0.0905 - accuracy: 0.9626 - val_loss: 0.4050 - val_accuracy: 0.8795
Confusion matrix: 
 [[509  64]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.244 0.756]]
Validation f1: 45.59
Validation accuracy: 87.95
Validation recall: 75.61
Validation precision: 32.63
Validation AUC: 0.40918197836960973
Validation class accuracies: [0.8883071553228621, 0.7560975609756098]
The validation tracker metric at 0.4861111111111111 hasn't increased by 0 in 2 epochs
Epoch 26/65
154/154 - 117s - loss: 0.0960 - accuracy: 0.9614 - val_loss: 0.4197 - val_accuracy: 0.8909
Confusion matrix: 
 [[513  60]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.171 0.829]]
Validation f1: 50.37
Validation accuracy: 89.09
Validation recall: 82.93
Validation precision: 36.17
Validation AUC: 0.35720598303589157
Validation class accuracies: [0.8952879581151832, 0.8292682926829268]
Saving model...
Epoch 27/65
154/154 - 117s - loss: 0.1601 - accuracy: 0.9349 - val_loss: 0.4871 - val_accuracy: 0.9121
Confusion matrix: 
 [[540  33]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.512 0.488]]
Validation f1: 42.55
Validation accuracy: 91.21
Validation recall: 48.78
Validation precision: 37.74
Validation AUC: 0.32300128931209915
Validation class accuracies: [0.9424083769633508, 0.4878048780487805]
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 1 epochs
Epoch 28/65
154/154 - 117s - loss: 0.1136 - accuracy: 0.9463 - val_loss: 0.6611 - val_accuracy: 0.8550
Confusion matrix: 
 [[490  83]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.855 0.145]
 [0.146 0.854]]
Validation f1: 44.03
Validation accuracy: 85.50
Validation recall: 85.37
Validation precision: 29.66
Validation AUC: 0.35472754431587555
Validation class accuracies: [0.8551483420593369, 0.8536585365853658]
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 2 epochs
Epoch 29/65
154/154 - 117s - loss: 0.1204 - accuracy: 0.9459 - val_loss: 0.9038 - val_accuracy: 0.8339
Confusion matrix: 
 [[483  90]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.293 0.707]]
Validation f1: 36.25
Validation accuracy: 83.39
Validation recall: 70.73
Validation precision: 24.37
Validation AUC: 0.3136215476779541
Validation class accuracies: [0.8429319371727748, 0.7073170731707317]
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 3 epochs
Epoch 30/65
154/154 - 117s - loss: 0.1403 - accuracy: 0.9398 - val_loss: 0.7758 - val_accuracy: 0.8111
Confusion matrix: 
 [[462 111]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.122 0.878]]
Validation f1: 38.30
Validation accuracy: 81.11
Validation recall: 87.80
Validation precision: 24.49
Validation AUC: 0.32457315029022693
Validation class accuracies: [0.806282722513089, 0.8780487804878049]
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 4 epochs
Epoch 31/65
154/154 - 117s - loss: 0.1296 - accuracy: 0.9597 - val_loss: 0.4939 - val_accuracy: 0.8811
Confusion matrix: 
 [[509  64]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.22  0.78 ]]
Validation f1: 46.72
Validation accuracy: 88.11
Validation recall: 78.05
Validation precision: 33.33
Validation AUC: 0.37739061301253995
Validation class accuracies: [0.8883071553228621, 0.7804878048780488]
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 5 epochs
Epoch 32/65
154/154 - 117s - loss: 0.1028 - accuracy: 0.9565 - val_loss: 1.8784 - val_accuracy: 0.6042
Confusion matrix: 
 [[330 243]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.576 0.424]
 [0.    1.   ]]
Validation f1: 25.23
Validation accuracy: 60.42
Validation recall: 100.00
Validation precision: 14.44
Validation AUC: 0.1870368545006685
Validation class accuracies: [0.5759162303664922, 1.0]
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 33/65
154/154 - 117s - loss: 0.0703 - accuracy: 0.9691 - val_loss: 0.4443 - val_accuracy: 0.8844
Confusion matrix: 
 [[508  65]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.146 0.854]]
Validation f1: 49.65
Validation accuracy: 88.44
Validation recall: 85.37
Validation precision: 35.00
Validation AUC: 0.47422804956573694
Validation class accuracies: [0.8865619546247818, 0.8536585365853658]
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 7 epochs
Epoch 34/65
154/154 - 117s - loss: 0.0448 - accuracy: 0.9740 - val_loss: 0.3614 - val_accuracy: 0.9153
Confusion matrix: 
 [[533  40]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.293 0.707]]
Validation f1: 52.73
Validation accuracy: 91.53
Validation recall: 70.73
Validation precision: 42.03
Validation AUC: 0.3703396420958579
Validation class accuracies: [0.9301919720767888, 0.7073170731707317]
Saving model...
Epoch 35/65
154/154 - 117s - loss: 0.0735 - accuracy: 0.9727 - val_loss: 0.3609 - val_accuracy: 0.9186
Confusion matrix: 
 [[537  36]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.341 0.659]]
Validation f1: 51.92
Validation accuracy: 91.86
Validation recall: 65.85
Validation precision: 42.86
Validation AUC: 0.3422544619799275
Validation class accuracies: [0.93717277486911, 0.6585365853658537]
The validation tracker metric at 0.5272727272727273 hasn't increased by 0 in 1 epochs
Epoch 36/65
154/154 - 117s - loss: 0.0440 - accuracy: 0.9793 - val_loss: 0.4385 - val_accuracy: 0.8860
Confusion matrix: 
 [[505  68]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.049 0.951]]
Validation f1: 52.70
Validation accuracy: 88.60
Validation recall: 95.12
Validation precision: 36.45
Validation AUC: 0.3793929261069683
Validation class accuracies: [0.881326352530541, 0.9512195121951219]
The validation tracker metric at 0.5272727272727273 hasn't increased by 0 in 2 epochs
Epoch 37/65
154/154 - 117s - loss: 0.0489 - accuracy: 0.9780 - val_loss: 0.4658 - val_accuracy: 0.9007
Confusion matrix: 
 [[523  50]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.268 0.732]]
Validation f1: 49.59
Validation accuracy: 90.07
Validation recall: 73.17
Validation precision: 37.50
Validation AUC: 0.3810967601090026
Validation class accuracies: [0.912739965095986, 0.7317073170731707]
The validation tracker metric at 0.5272727272727273 hasn't increased by 0 in 3 epochs
Epoch 38/65
154/154 - 118s - loss: 0.0294 - accuracy: 0.9878 - val_loss: 0.3959 - val_accuracy: 0.9104
Confusion matrix: 
 [[525  48]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.171 0.829]]
Validation f1: 55.28
Validation accuracy: 91.04
Validation recall: 82.93
Validation precision: 41.46
Validation AUC: 0.4569265929275957
Validation class accuracies: [0.9162303664921466, 0.8292682926829268]
Saving model...
Epoch 39/65
154/154 - 117s - loss: 0.0565 - accuracy: 0.9776 - val_loss: 0.4492 - val_accuracy: 0.9072
Confusion matrix: 
 [[520  53]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.098 0.902]]
Validation f1: 56.49
Validation accuracy: 90.72
Validation recall: 90.24
Validation precision: 41.11
Validation AUC: 0.356019936409184
Validation class accuracies: [0.9075043630017452, 0.9024390243902439]
Saving model...
Epoch 40/65
154/154 - 117s - loss: 0.0428 - accuracy: 0.9801 - val_loss: 0.3854 - val_accuracy: 0.9072
Confusion matrix: 
 [[526  47]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.244 0.756]]
Validation f1: 52.10
Validation accuracy: 90.72
Validation recall: 75.61
Validation precision: 39.74
Validation AUC: 0.45322557288717374
Validation class accuracies: [0.9179755671902269, 0.7560975609756098]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 1 epochs
Epoch 41/65
154/154 - 117s - loss: 0.0242 - accuracy: 0.9902 - val_loss: 0.4318 - val_accuracy: 0.9055
Confusion matrix: 
 [[524  49]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.22  0.78 ]]
Validation f1: 52.46
Validation accuracy: 90.55
Validation recall: 78.05
Validation precision: 39.51
Validation AUC: 0.4446811234156174
Validation class accuracies: [0.9144851657940664, 0.7804878048780488]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 2 epochs
Epoch 42/65
154/154 - 117s - loss: 0.0688 - accuracy: 0.9683 - val_loss: 0.6444 - val_accuracy: 0.8176
Confusion matrix: 
 [[464 109]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.073 0.927]]
Validation f1: 40.43
Validation accuracy: 81.76
Validation recall: 92.68
Validation precision: 25.85
Validation AUC: 0.5498296858970824
Validation class accuracies: [0.8097731239092496, 0.926829268292683]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 3 epochs
Epoch 43/65
154/154 - 117s - loss: 0.0495 - accuracy: 0.9740 - val_loss: 0.3245 - val_accuracy: 0.9121
Confusion matrix: 
 [[536  37]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.415 0.585]]
Validation f1: 47.06
Validation accuracy: 91.21
Validation recall: 58.54
Validation precision: 39.34
Validation AUC: 0.4005708324982668
Validation class accuracies: [0.9354275741710296, 0.5853658536585366]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 4 epochs
Epoch 44/65
154/154 - 117s - loss: 0.0514 - accuracy: 0.9780 - val_loss: 0.5577 - val_accuracy: 0.8974
Confusion matrix: 
 [[521  52]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.268 0.732]]
Validation f1: 48.78
Validation accuracy: 89.74
Validation recall: 73.17
Validation precision: 36.59
Validation AUC: 0.4184152890707521
Validation class accuracies: [0.9092495636998255, 0.7317073170731707]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 5 epochs
Epoch 45/65
154/154 - 117s - loss: 0.0125 - accuracy: 0.9919 - val_loss: 0.4263 - val_accuracy: 0.8990
Confusion matrix: 
 [[528  45]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.415 0.585]]
Validation f1: 43.64
Validation accuracy: 89.90
Validation recall: 58.54
Validation precision: 34.78
Validation AUC: 0.4115308839744067
Validation class accuracies: [0.9214659685863874, 0.5853658536585366]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 46/65
154/154 - 117s - loss: 0.0311 - accuracy: 0.9886 - val_loss: 1.0263 - val_accuracy: 0.7899
Confusion matrix: 
 [[446 127]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.778 0.222]
 [0.049 0.951]]
Validation f1: 37.68
Validation accuracy: 78.99
Validation recall: 95.12
Validation precision: 23.49
Validation AUC: 0.403080664260423
Validation class accuracies: [0.7783595113438045, 0.9512195121951219]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 7 epochs
Epoch 47/65
154/154 - 118s - loss: 0.0297 - accuracy: 0.9866 - val_loss: 0.3629 - val_accuracy: 0.9121
Confusion matrix: 
 [[532  41]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.317 0.683]]
Validation f1: 50.91
Validation accuracy: 91.21
Validation recall: 68.29
Validation precision: 40.58
Validation AUC: 0.45569049632160624
Validation class accuracies: [0.9284467713787086, 0.6829268292682927]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 8 epochs
Epoch 48/65
154/154 - 118s - loss: 0.0101 - accuracy: 0.9955 - val_loss: 0.3813 - val_accuracy: 0.9088
Confusion matrix: 
 [[530  43]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.317 0.683]]
Validation f1: 50.00
Validation accuracy: 90.88
Validation recall: 68.29
Validation precision: 39.44
Validation AUC: 0.4627857367776947
Validation class accuracies: [0.924956369982548, 0.6829268292682927]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 9 epochs
Epoch 49/65
154/154 - 119s - loss: 0.0068 - accuracy: 0.9972 - val_loss: 0.3740 - val_accuracy: 0.9121
Confusion matrix: 
 [[533  40]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.341 0.659]]
Validation f1: 50.00
Validation accuracy: 91.21
Validation recall: 65.85
Validation precision: 40.30
Validation AUC: 0.4646652547633836
Validation class accuracies: [0.9301919720767888, 0.6585365853658537]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 10 epochs
Epoch 50/65
154/154 - 118s - loss: 0.0079 - accuracy: 0.9963 - val_loss: 0.3782 - val_accuracy: 0.9137
Confusion matrix: 
 [[535  38]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.366 0.634]]
Validation f1: 49.52
Validation accuracy: 91.37
Validation recall: 63.41
Validation precision: 40.62
Validation AUC: 0.4285692065921786
Validation class accuracies: [0.9336823734729494, 0.6341463414634146]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 11 epochs
Epoch 51/65
154/154 - 118s - loss: 0.0076 - accuracy: 0.9976 - val_loss: 0.4395 - val_accuracy: 0.9121
Confusion matrix: 
 [[535  38]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.08
Validation accuracy: 91.21
Validation recall: 60.98
Validation precision: 39.68
Validation AUC: 0.44400544852328083
Validation class accuracies: [0.9336823734729494, 0.6097560975609756]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 52/65
154/154 - 118s - loss: 0.0086 - accuracy: 0.9972 - val_loss: 0.4672 - val_accuracy: 0.9007
Confusion matrix: 
 [[526  47]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.341 0.659]]
Validation f1: 46.96
Validation accuracy: 90.07
Validation recall: 65.85
Validation precision: 36.49
Validation AUC: 0.4168041997260965
Validation class accuracies: [0.9179755671902269, 0.6585365853658537]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 13 epochs
Epoch 53/65
154/154 - 118s - loss: 0.0050 - accuracy: 0.9984 - val_loss: 0.4104 - val_accuracy: 0.9055
Confusion matrix: 
 [[532  41]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.415 0.585]]
Validation f1: 45.28
Validation accuracy: 90.55
Validation recall: 58.54
Validation precision: 36.92
Validation AUC: 0.43592177313269914
Validation class accuracies: [0.9284467713787086, 0.5853658536585366]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 14 epochs
Epoch 54/65
154/154 - 118s - loss: 0.0115 - accuracy: 0.9967 - val_loss: 0.3655 - val_accuracy: 0.9202
Confusion matrix: 
 [[534  39]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.244 0.756]]
Validation f1: 55.86
Validation accuracy: 92.02
Validation recall: 75.61
Validation precision: 44.29
Validation AUC: 0.5206487318986428
Validation class accuracies: [0.9319371727748691, 0.7560975609756098]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 15 epochs
Epoch 55/65
154/154 - 117s - loss: 0.0077 - accuracy: 0.9967 - val_loss: 0.3326 - val_accuracy: 0.9169
Confusion matrix: 
 [[535  38]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.34
Validation accuracy: 91.69
Validation recall: 68.29
Validation precision: 42.42
Validation AUC: 0.5200580567962805
Validation class accuracies: [0.9336823734729494, 0.6829268292682927]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 16 epochs
Epoch 56/65
154/154 - 117s - loss: 0.0040 - accuracy: 0.9984 - val_loss: 0.3684 - val_accuracy: 0.9121
Confusion matrix: 
 [[533  40]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 91.21
Validation recall: 65.85
Validation precision: 40.30
Validation AUC: 0.4888609029686735
Validation class accuracies: [0.9301919720767888, 0.6585365853658537]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 17 epochs
Epoch 57/65
154/154 - 117s - loss: 0.0026 - accuracy: 0.9996 - val_loss: 0.4110 - val_accuracy: 0.9153
Confusion matrix: 
 [[534  39]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.317 0.683]]
Validation f1: 51.85
Validation accuracy: 91.53
Validation recall: 68.29
Validation precision: 41.79
Validation AUC: 0.4821958473754958
Validation class accuracies: [0.9319371727748691, 0.6829268292682927]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 58/65
154/154 - 117s - loss: 0.0103 - accuracy: 0.9988 - val_loss: 0.4640 - val_accuracy: 0.9088
Confusion matrix: 
 [[529  44]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.293 0.707]]
Validation f1: 50.88
Validation accuracy: 90.88
Validation recall: 70.73
Validation precision: 39.73
Validation AUC: 0.46261649129685795
Validation class accuracies: [0.9232111692844677, 0.7073170731707317]
The validation tracker metric at 0.5648854961832062 hasn't increased by 0 in 19 epochs
Epoch 59/65
154/154 - 117s - loss: 0.0052 - accuracy: 0.9980 - val_loss: 0.4160 - val_accuracy: 0.9169
Confusion matrix: 
 [[535  38]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.317 0.683]]
Validation f1: 52.34
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 91.69
Validation recall: 68.29
Validation precision: 42.42
Validation AUC: 0.473599160879033
Validation class accuracies: [0.9336823734729494, 0.6829268292682927]

The metrics for job 2 with the best target metric are: 
Best cm: [[520  53]
 [  4  37]]
Best normalized cm: [[0.908 0.092]
 [0.098 0.902]]
Best f1: 0.56
Best accuracy: 0.91
Best recall: 0.90
Best precision: 0.41
Best AUC: 0.36
Best class accuracies: [0.9075043630017452, 0.9024390243902439]
Best epoch: 39
The number of epochs since last 1% equals the patience
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_207_3b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[1.781e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_207_2b3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.448e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_207_2b2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[9.753e-07]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_218_1b1_Pr_sc_Meditron_6_label_0_pred_0.png, [[9.605e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_221_2b2_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.473]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_205_1b3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_207_2b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_226_1b1_Ll_sc_Meditron_0_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_203_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.404]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_213_1p5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[2.384e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_213_2p2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/jordan_EP36_pneumonia,Crep,P R M,36,F_4_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_221_2b3_Pr_mc_LittC2SE_2_label_0_pred_1.png, [[0.967]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_211_2p4_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[3.364e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_223_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[1.968e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_213_1p5_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[3.896e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_223_1b1_Pr_sc_Meditron_1_label_0_pred_0.png, [[7.977e-08]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_213_1p2_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_219_2b3_Tc_mc_LittC2SE_3_label_1_pred_1.png, [[0.749]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_213_1p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_204_7p5_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[7.389e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_213_1p3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.061]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_222_1b1_Pr_sc_Meditron_10_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_219_2b1_Ar_mc_LittC2SE_2_label_1_pred_0.png, [[0.09]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_222_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[3.248e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_211_1p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_204_7p5_Al_mc_AKGC417L_2_label_0_pred_0.png, [[5.182e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_205_3b4_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[4.52e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_219_2b2_Ar_mc_LittC2SE_3_label_1_pred_1.png, [[0.947]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[3.264e-08]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_207_3b2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[1.952e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_213_1p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_207_2b2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[2.085e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_222_1b1_Ar_sc_Meditron_6_label_0_pred_0.png, [[5.932e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_218_1p1_Pl_sc_Litt3200_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[2.887e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[3.079e-07]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_210_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[1.408e-05]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_224_1b2_Al_sc_Meditron_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_219_2b3_Tc_mc_LittC2SE_1_label_1_pred_1.png, [[0.727]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_221_2b3_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.998]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_203_2p3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.016e-06]]
../../new_cache/conv__2254__06_2129__v39__augm_half/2/icbhi_222_1b1_Ar_sc_Meditron_12_label_0_pred_0.png, [[6.212e-07]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 12315
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_232538-la5u1h8n/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_232538-la5u1h8n/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99797
wandb:         val_accuracy 0.91694
wandb:             _runtime 7552
wandb:           _timestamp 1624671090
wandb:                _step 445
wandb:           train_loss 0.00518
wandb:             val_loss 0.41598
wandb:           val_recall 0.68293
wandb:        val_precision 0.42424
wandb:               val_f1 0.52336
wandb:              val_auc 0.4736
wandb:                   lr 3e-05
wandb:          best_val_f1 0.56489
wandb:    best_val_accuracy 0.90717
wandb:   best_val_precision 0.41111
wandb:      best_val_recall 0.90244
wandb:             best_auc 0.35602
wandb:           best_epoch 39
wandb: Run history:
wandb:   train_accuracy ▁▃▄▄▄▅▅▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇█████▇███████████
wandb:     val_accuracy ████▇▇▁█▇▅▇█▇▇▆▇▅██▇▇▅▇█████▇███████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▄▄▃▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▁▂▁█▁▂▃▂▁▁▁▂▁▃▁▁▂▂▄▁▁▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▁▁▂▇▅█▅▆█▇▅▇▇█▇█▇▄▆▇█▇▆█▇▇▆▇▆▅▆▆▅▅▅▆▆▆▆
wandb:    val_precision ▁▁▁█▃▂▂▄▃▂▃▃▃▃▃▃▂▄▄▃▃▂▃▄▄▄▄▄▃▄▃▄▄▄▄▄▄▄▄▄
wandb:           val_f1 ▁▁▁▃▅▅▃▇▅▄▆▆▆▆▆▇▄▇▆▅▆▄▇▇████▆▇▆▇▇▇▇▇█▇▇▇
wandb:          val_auc ▁▁▂▇▆▃██▄▄▅▇▄▅▅▆▄▅▅▅▅▃▇▅▆▇▅▇█▆▆▇▇▆▇▆█▇▇▇
wandb:               lr █████████████▄▄▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▃▂▂▂▂▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_232538-la5u1h8n

-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0.4, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 64, 1250, 1)]   0                                                 
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 64, 1250, 1)     4            input_4[0][0]                        
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 64, 1250, 1)     0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 64, 1250, 16)    2320         conv2d_15[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 64, 1250, 16)    6416         conv2d_17[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 64, 1250, 16)    32           max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_36187 (Concatenate)     (None, 64, 1250, 48)    0            conv2d_16[0][0]                      
                                                                         conv2d_18[0][0]                      
                                                                         conv2d_19[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePoolin (None, 32, 625, 48)     0            concatenate_36187[0][0]              
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormal (None, 32, 625, 48)     192          average_pooling2d_15[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 32, 625, 48)     0            batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 32, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 32, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePoolin (None, 16, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormal (None, 16, 312, 32)     128          average_pooling2d_16[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 16, 312, 32)     0            batch_normalization_19[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 16, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 16, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePoolin (None, 8, 156, 64)      0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormal (None, 8, 156, 64)      256          average_pooling2d_17[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 8, 156, 64)      0            batch_normalization_20[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 8, 156, 128)     91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 8, 156, 128)     230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePoolin (None, 4, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormal (None, 4, 78, 128)      512          average_pooling2d_18[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 4, 78, 128)      0            batch_normalization_21[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 4, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 4, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePoolin (None, 2, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormal (None, 2, 39, 256)      1024         average_pooling2d_19[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 2, 39, 256)      0            batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 2, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 2, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 1)               513          global_average_pooling2d_3[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 116s - loss: 1.1525 - accuracy: 0.5700 - val_loss: 2.0733 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.03854182824052531
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 117s - loss: 0.7847 - accuracy: 0.6505 - val_loss: 1.6107 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.05090021303733619
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 117s - loss: 0.7119 - accuracy: 0.7551 - val_loss: 1.0061 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.05353709299068779
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 4/65
154/154 - 117s - loss: 0.6760 - accuracy: 0.7966 - val_loss: 0.5636 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09164605399657025
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 3 epochs
Epoch 5/65
154/154 - 117s - loss: 0.6716 - accuracy: 0.8181 - val_loss: 0.5531 - val_accuracy: 0.9202
Confusion matrix: 
 [[544  29]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.488 0.512]]
Validation f1: 46.15
Validation accuracy: 92.02
Validation recall: 51.22
Validation precision: 42.00
Validation AUC: 0.4826830809331028
Validation class accuracies: [0.9493891797556719, 0.5121951219512195]
Saving model...
Epoch 6/65
154/154 - 117s - loss: 0.6466 - accuracy: 0.8560 - val_loss: 0.6019 - val_accuracy: 0.8420
Confusion matrix: 
 [[496  77]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.866 0.134]
 [0.488 0.512]]
Validation f1: 30.22
Validation accuracy: 84.20
Validation recall: 51.22
Validation precision: 21.43
Validation AUC: 0.2625261365865389
Validation class accuracies: [0.8656195462478184, 0.5121951219512195]
The validation tracker metric at 0.46153846153846156 hasn't increased by 0 in 1 epochs
Epoch 7/65
154/154 - 117s - loss: 0.6591 - accuracy: 0.8454 - val_loss: 0.6071 - val_accuracy: 0.8355
Confusion matrix: 
 [[485  88]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.317 0.683]]
Validation f1: 35.67
Validation accuracy: 83.55
Validation recall: 68.29
Validation precision: 24.14
Validation AUC: 0.30072478225236143
Validation class accuracies: [0.8464223385689355, 0.6829268292682927]
The validation tracker metric at 0.46153846153846156 hasn't increased by 0 in 2 epochs
Epoch 8/65
154/154 - 117s - loss: 0.6620 - accuracy: 0.8470 - val_loss: 0.6527 - val_accuracy: 0.7720
Confusion matrix: 
 [[436 137]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.761 0.239]
 [0.073 0.927]]
Validation f1: 35.19
Validation accuracy: 77.20
Validation recall: 92.68
Validation precision: 21.71
Validation AUC: 0.35376324550049243
Validation class accuracies: [0.7609075043630017, 0.926829268292683]
The validation tracker metric at 0.46153846153846156 hasn't increased by 0 in 3 epochs
Epoch 9/65
154/154 - 117s - loss: 0.6379 - accuracy: 0.8718 - val_loss: 0.5755 - val_accuracy: 0.9283
Confusion matrix: 
 [[557  16]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.683 0.317]]
Validation f1: 37.14
Validation accuracy: 92.83
Validation recall: 31.71
Validation precision: 44.83
Validation AUC: 0.3384877887544318
Validation class accuracies: [0.9720767888307156, 0.3170731707317073]
The validation tracker metric at 0.46153846153846156 hasn't increased by 0 in 4 epochs
Epoch 10/65
154/154 - 117s - loss: 0.6506 - accuracy: 0.8727 - val_loss: 0.5770 - val_accuracy: 0.8876
Confusion matrix: 
 [[509  64]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.122 0.878]]
Validation f1: 51.06
Validation accuracy: 88.76
Validation recall: 87.80
Validation precision: 36.00
Validation AUC: 0.5997584220774379
Validation class accuracies: [0.8883071553228621, 0.8780487804878049]
Saving model...
Epoch 11/65
154/154 - 117s - loss: 0.6409 - accuracy: 0.8792 - val_loss: 0.6604 - val_accuracy: 0.7899
Confusion matrix: 
 [[450 123]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.146 0.854]]
Validation f1: 35.18
Validation accuracy: 78.99
Validation recall: 85.37
Validation precision: 22.15
Validation AUC: 0.4788993223310283
Validation class accuracies: [0.7853403141361257, 0.8536585365853658]
The validation tracker metric at 0.5106382978723404 hasn't increased by 0 in 1 epochs
Epoch 12/65
154/154 - 117s - loss: 0.6290 - accuracy: 0.9089 - val_loss: 0.7825 - val_accuracy: 0.5912
Confusion matrix: 
 [[328 245]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.572 0.428]
 [0.146 0.854]]
Validation f1: 21.81
Validation accuracy: 59.12
Validation recall: 85.37
Validation precision: 12.50
Validation AUC: 0.22925614514660855
Validation class accuracies: [0.5724258289703316, 0.8536585365853658]
The validation tracker metric at 0.5106382978723404 hasn't increased by 0 in 2 epochs
Epoch 13/65
154/154 - 117s - loss: 0.6266 - accuracy: 0.8906 - val_loss: 0.6799 - val_accuracy: 0.7671
Confusion matrix: 
 [[436 137]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.761 0.239]
 [0.146 0.854]]
Validation f1: 32.86
Validation accuracy: 76.71
Validation recall: 85.37
Validation precision: 20.35
Validation AUC: 0.33937822897452075
Validation class accuracies: [0.7609075043630017, 0.8536585365853658]
The validation tracker metric at 0.5106382978723404 hasn't increased by 0 in 3 epochs
Epoch 14/65
154/154 - 117s - loss: 0.6290 - accuracy: 0.9251 - val_loss: 0.5984 - val_accuracy: 0.8762
Confusion matrix: 
 [[511  62]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.341 0.659]]
Validation f1: 41.54
Validation accuracy: 87.62
Validation recall: 65.85
Validation precision: 30.34
Validation AUC: 0.36310659200773493
Validation class accuracies: [0.8917975567190227, 0.6585365853658537]
The validation tracker metric at 0.5106382978723404 hasn't increased by 0 in 4 epochs
Epoch 15/65
154/154 - 117s - loss: 0.6189 - accuracy: 0.9182 - val_loss: 0.5569 - val_accuracy: 0.9316
Confusion matrix: 
 [[546  27]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.366 0.634]]
Validation f1: 55.32
Validation accuracy: 93.16
Validation recall: 63.41
Validation precision: 49.06
Validation AUC: 0.5896105065843422
Validation class accuracies: [0.9528795811518325, 0.6341463414634146]
Saving model...
Epoch 16/65
154/154 - 117s - loss: 0.6179 - accuracy: 0.9280 - val_loss: 0.7110 - val_accuracy: 0.6971
Confusion matrix: 
 [[391 182]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.682 0.318]
 [0.098 0.902]]
Validation f1: 28.46
Validation accuracy: 69.71
Validation recall: 90.24
Validation precision: 16.89
Validation AUC: 0.4426342501555577
Validation class accuracies: [0.6823734729493892, 0.9024390243902439]
The validation tracker metric at 0.5531914893617021 hasn't increased by 0 in 1 epochs
Epoch 17/65
154/154 - 117s - loss: 0.6201 - accuracy: 0.9292 - val_loss: 0.8122 - val_accuracy: 0.4691
Confusion matrix: 
 [[247 326]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.431 0.569]
 [0.    1.   ]]
Validation f1: 20.10
Validation accuracy: 46.91
Validation recall: 100.00
Validation precision: 11.17
Validation AUC: 0.15170832973566228
Validation class accuracies: [0.43106457242582896, 1.0]
The validation tracker metric at 0.5531914893617021 hasn't increased by 0 in 2 epochs
Epoch 18/65
154/154 - 117s - loss: 0.6255 - accuracy: 0.9162 - val_loss: 0.6578 - val_accuracy: 0.7101
Confusion matrix: 
 [[414 159]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.723 0.277]
 [0.463 0.537]]
Validation f1: 19.82
Validation accuracy: 71.01
Validation recall: 53.66
Validation precision: 12.15
Validation AUC: 0.26062352577556097
Validation class accuracies: [0.7225130890052356, 0.5365853658536586]
The validation tracker metric at 0.5531914893617021 hasn't increased by 0 in 3 epochs
Epoch 19/65
154/154 - 118s - loss: 0.6262 - accuracy: 0.9089 - val_loss: 0.6333 - val_accuracy: 0.7704
Confusion matrix: 
 [[437 136]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.763 0.237]
 [0.122 0.878]]
Validation f1: 33.80
Validation accuracy: 77.04
Validation recall: 87.80
Validation precision: 20.93
Validation AUC: 0.6580567810990514
Validation class accuracies: [0.7626527050610821, 0.8780487804878049]
The validation tracker metric at 0.5531914893617021 hasn't increased by 0 in 4 epochs
Epoch 20/65
154/154 - 117s - loss: 0.6153 - accuracy: 0.9337 - val_loss: 0.6103 - val_accuracy: 0.8420
Confusion matrix: 
 [[489  84]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.853 0.147]
 [0.317 0.683]]
Validation f1: 36.60
Validation accuracy: 84.20
Validation recall: 68.29
Validation precision: 25.00
Validation AUC: 0.26944363721185643
Validation class accuracies: [0.8534031413612565, 0.6829268292682927]
The validation tracker metric at 0.5531914893617021 hasn't increased by 0 in 5 epochs
Epoch 21/65
154/154 - 117s - loss: 0.6124 - accuracy: 0.9345 - val_loss: 0.6929 - val_accuracy: 0.6156
Confusion matrix: 
 [[337 236]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.588 0.412]
 [0.    1.   ]]
Validation f1: 25.79
Validation accuracy: 61.56
Validation recall: 100.00
Validation precision: 14.80
Validation AUC: 0.6300224796440074
Validation class accuracies: [0.5881326352530541, 1.0]
The validation tracker metric at 0.5531914893617021 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 22/65
154/154 - 117s - loss: 0.6027 - accuracy: 0.9605 - val_loss: 0.5717 - val_accuracy: 0.8827
Confusion matrix: 
 [[511  62]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.244 0.756]]
Validation f1: 46.27
Validation accuracy: 88.27
Validation recall: 75.61
Validation precision: 33.33
Validation AUC: 0.5361230066551167
Validation class accuracies: [0.8917975567190227, 0.7560975609756098]
The validation tracker metric at 0.5531914893617021 hasn't increased by 0 in 7 epochs
Epoch 23/65
154/154 - 117s - loss: 0.5976 - accuracy: 0.9622 - val_loss: 0.5629 - val_accuracy: 0.9055
Confusion matrix: 
 [[525  48]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.244 0.756]]
Validation f1: 51.67
Validation accuracy: 90.55
Validation recall: 75.61
Validation precision: 39.24
Validation AUC: 0.5787713742395593
Validation class accuracies: [0.9162303664921466, 0.7560975609756098]
The validation tracker metric at 0.5531914893617021 hasn't increased by 0 in 8 epochs
Epoch 24/65
154/154 - 117s - loss: 0.5936 - accuracy: 0.9776 - val_loss: 0.5534 - val_accuracy: 0.9300
Confusion matrix: 
 [[538  35]
 [  8  33]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.195 0.805]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.55
Validation accuracy: 93.00
Validation recall: 80.49
Validation precision: 48.53
Validation AUC: 0.5767663814110827
Validation class accuracies: [0.9389179755671903, 0.8048780487804879]
Saving model...
Epoch 25/65
154/154 - 117s - loss: 0.5978 - accuracy: 0.9654 - val_loss: 0.5632 - val_accuracy: 0.8893
Confusion matrix: 
 [[521  52]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.39  0.61 ]]
Validation f1: 42.37
Validation accuracy: 88.93
Validation recall: 60.98
Validation precision: 32.47
Validation AUC: 0.5825015343027737
Validation class accuracies: [0.9092495636998255, 0.6097560975609756]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 1 epochs
Epoch 26/65
154/154 - 117s - loss: 0.5979 - accuracy: 0.9675 - val_loss: 0.5631 - val_accuracy: 0.9007
Confusion matrix: 
 [[524  49]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.293 0.707]]
Validation f1: 48.74
Validation accuracy: 90.07
Validation recall: 70.73
Validation precision: 37.18
Validation AUC: 0.4602583307675601
Validation class accuracies: [0.9144851657940664, 0.7073170731707317]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 2 epochs
Epoch 27/65
154/154 - 117s - loss: 0.5898 - accuracy: 0.9817 - val_loss: 0.5544 - val_accuracy: 0.9121
Confusion matrix: 
 [[531  42]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.293 0.707]]
Validation f1: 51.79
Validation accuracy: 91.21
Validation recall: 70.73
Validation precision: 40.85
Validation AUC: 0.5507115253604686
Validation class accuracies: [0.9267015706806283, 0.7073170731707317]
The validation tracker metric at 0.6055045871559633 hasn't increased by 0 in 3 epochs
Epoch 28/65
154/154 - 117s - loss: 0.5922 - accuracy: 0.9756 - val_loss: 0.5391 - val_accuracy: 0.9446
Confusion matrix: 
 [[549  24]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.244 0.756]]
Validation f1: 64.58
Validation accuracy: 94.46
Validation recall: 75.61
Validation precision: 56.36
Validation AUC: 0.5725469361694273
Validation class accuracies: [0.9581151832460733, 0.7560975609756098]
Saving model...
Epoch 29/65
154/154 - 117s - loss: 0.5867 - accuracy: 0.9837 - val_loss: 0.5557 - val_accuracy: 0.9218
Confusion matrix: 
 [[535  38]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.244 0.756]]
Validation f1: 56.36
Validation accuracy: 92.18
Validation recall: 75.61
Validation precision: 44.93
Validation AUC: 0.5036426186066505
Validation class accuracies: [0.9336823734729494, 0.7560975609756098]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 1 epochs
Epoch 30/65
154/154 - 117s - loss: 0.5881 - accuracy: 0.9841 - val_loss: 0.5748 - val_accuracy: 0.8860
Confusion matrix: 
 [[515  58]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.293 0.707]]
Validation f1: 45.31
Validation accuracy: 88.60
Validation recall: 70.73
Validation precision: 33.33
Validation AUC: 0.35921973065313556
Validation class accuracies: [0.8987783595113438, 0.7073170731707317]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 2 epochs
Epoch 31/65
154/154 - 117s - loss: 0.5966 - accuracy: 0.9691 - val_loss: 0.5532 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.5442367071277203
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 3 epochs
Epoch 32/65
154/154 - 117s - loss: 0.5896 - accuracy: 0.9801 - val_loss: 0.5783 - val_accuracy: 0.8681
Confusion matrix: 
 [[504  69]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.293 0.707]]
Validation f1: 41.73
Validation accuracy: 86.81
Validation recall: 70.73
Validation precision: 29.59
Validation AUC: 0.4851573207732071
Validation class accuracies: [0.8795811518324608, 0.7073170731707317]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 4 epochs
Epoch 33/65
154/154 - 117s - loss: 0.5887 - accuracy: 0.9825 - val_loss: 0.5332 - val_accuracy: 0.9479
Confusion matrix: 
 [[557  16]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.39  0.61 ]]
Validation f1: 60.98
Validation accuracy: 94.79
Validation recall: 60.98
Validation precision: 60.98
Validation AUC: 0.6831889243111939
Validation class accuracies: [0.9720767888307156, 0.6097560975609756]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 5 epochs
Epoch 34/65
154/154 - 117s - loss: 0.5880 - accuracy: 0.9821 - val_loss: 0.5434 - val_accuracy: 0.9365
Confusion matrix: 
 [[551  22]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.415 0.585]]
Validation f1: 55.17
Validation accuracy: 93.65
Validation recall: 58.54
Validation precision: 52.17
Validation AUC: 0.582263516918622
Validation class accuracies: [0.9616055846422339, 0.5853658536585366]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 35/65
154/154 - 117s - loss: 0.5830 - accuracy: 0.9935 - val_loss: 0.5512 - val_accuracy: 0.9283
Confusion matrix: 
 [[548  25]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.463 0.537]]
Validation f1: 50.00
Validation accuracy: 92.83
Validation recall: 53.66
Validation precision: 46.81
Validation AUC: 0.5185085660636483
Validation class accuracies: [0.956369982547993, 0.5365853658536586]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 7 epochs
Epoch 36/65
154/154 - 118s - loss: 0.5823 - accuracy: 0.9902 - val_loss: 0.5486 - val_accuracy: 0.9283
Confusion matrix: 
 [[549  24]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.488 0.512]]
Validation f1: 48.84
Validation accuracy: 92.83
Validation recall: 51.22
Validation precision: 46.67
Validation AUC: 0.5081334241936636
Validation class accuracies: [0.9581151832460733, 0.5121951219512195]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 8 epochs
Epoch 37/65
154/154 - 118s - loss: 0.5837 - accuracy: 0.9890 - val_loss: 0.5495 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
Validation f1: 51.69
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.5456421197567061
Validation class accuracies: [0.956369982547993, 0.5609756097560976]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 9 epochs
Epoch 38/65
154/154 - 118s - loss: 0.5811 - accuracy: 0.9931 - val_loss: 0.5495 - val_accuracy: 0.9283
Confusion matrix: 
 [[549  24]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.84
Validation accuracy: 92.83
Validation recall: 51.22
Validation precision: 46.67
Validation AUC: 0.49431392376236805
Validation class accuracies: [0.9581151832460733, 0.5121951219512195]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 10 epochs
Epoch 39/65
154/154 - 119s - loss: 0.5821 - accuracy: 0.9935 - val_loss: 0.5543 - val_accuracy: 0.9186
Confusion matrix: 
 [[543  30]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.488 0.512]]
Validation f1: 45.65
Validation accuracy: 91.86
Validation recall: 51.22
Validation precision: 41.18
Validation AUC: 0.5439794460046025
Validation class accuracies: [0.9476439790575916, 0.5121951219512195]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 11 epochs
Epoch 40/65
154/154 - 119s - loss: 0.5826 - accuracy: 0.9919 - val_loss: 0.5568 - val_accuracy: 0.9316
Confusion matrix: 
 [[551  22]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.488 0.512]]
Validation f1: 50.00
Validation accuracy: 93.16
Validation recall: 51.22
Validation precision: 48.84
Validation AUC: 0.468760791555151
Validation class accuracies: [0.9616055846422339, 0.5121951219512195]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 41/65
154/154 - 119s - loss: 0.5814 - accuracy: 0.9923 - val_loss: 0.5472 - val_accuracy: 0.9365
Confusion matrix: 
 [[553  20]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.463 0.537]]
Validation f1: 53.01
Validation accuracy: 93.65
Validation recall: 53.66
Validation precision: 52.38
Validation AUC: 0.48856157905175
Validation class accuracies: [0.9650959860383944, 0.5365853658536586]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 13 epochs
Epoch 42/65
154/154 - 119s - loss: 0.5805 - accuracy: 0.9939 - val_loss: 0.5498 - val_accuracy: 0.9300
Confusion matrix: 
 [[549  24]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.463 0.537]]
Validation f1: 50.57
Validation accuracy: 93.00
Validation recall: 53.66
Validation precision: 47.83
Validation AUC: 0.4892973289974757
Validation class accuracies: [0.9581151832460733, 0.5365853658536586]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 14 epochs
Epoch 43/65
154/154 - 118s - loss: 0.5803 - accuracy: 0.9972 - val_loss: 0.5501 - val_accuracy: 0.9332
Confusion matrix: 
 [[552  21]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.488 0.512]]
Validation f1: 50.60
Validation accuracy: 93.32
Validation recall: 51.22
Validation precision: 50.00
Validation AUC: 0.5011329513996616
Validation class accuracies: [0.9633507853403142, 0.5121951219512195]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 15 epochs
Epoch 44/65
154/154 - 119s - loss: 0.5795 - accuracy: 0.9976 - val_loss: 0.5487 - val_accuracy: 0.9365
Confusion matrix: 
 [[555  18]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.512 0.488]]
Validation f1: 50.63
Validation accuracy: 93.65
Validation recall: 48.78
Validation precision: 52.63
Validation AUC: 0.5007977898635242
Validation class accuracies: [0.9685863874345549, 0.4878048780487805]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 16 epochs
Epoch 45/65
154/154 - 119s - loss: 0.5792 - accuracy: 0.9963 - val_loss: 0.5502 - val_accuracy: 0.9332
Confusion matrix: 
 [[553  20]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.512 0.488]]
Validation f1: 49.38
Validation accuracy: 93.32
Validation recall: 48.78
Validation precision: 50.00
Validation AUC: 0.4772477362264247
Validation class accuracies: [0.9650959860383944, 0.4878048780487805]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 17 epochs
Epoch 46/65
154/154 - 118s - loss: 0.5790 - accuracy: 0.9972 - val_loss: 0.5446 - val_accuracy: 0.9365
Confusion matrix: 
 [[553  20]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.01
Validation accuracy: 93.65
Validation recall: 53.66
Validation precision: 52.38
Validation AUC: 0.516676206824605
Validation class accuracies: [0.9650959860383944, 0.5365853658536586]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 47/65
154/154 - 117s - loss: 0.5788 - accuracy: 0.9980 - val_loss: 0.5449 - val_accuracy: 0.9381
Confusion matrix: 
 [[554  19]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.463 0.537]]
Validation f1: 53.66
Validation accuracy: 93.81
Validation recall: 53.66
Validation precision: 53.66
Validation AUC: 0.5162446299215113
Validation class accuracies: [0.9668411867364747, 0.5365853658536586]
The validation tracker metric at 0.6458333333333333 hasn't increased by 0 in 19 epochs
Epoch 48/65
154/154 - 117s - loss: 0.5781 - accuracy: 0.9988 - val_loss: 0.5454 - val_accuracy: 0.9381
Confusion matrix: 
 [[556  17]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.512 0.488]]
Validation f1: 51.28
Validation accuracy: 93.81
Validation recall: 48.78
Validation precision: 54.05
Validation AUC: 0.4952371734935153
Validation class accuracies: [0.9703315881326352, 0.4878048780487805]

The metrics for job 3 with the best target metric are: 
Best cm: [[549  24]
 [ 10  31]]
Best normalized cm: [[0.958 0.042]
 [0.244 0.756]]
Best f1: 0.65
Best accuracy: 0.94
Best recall: 0.76
Best precision: 0.56
Best AUC: 0.57
Best class accuracies: [0.9581151832460733, 0.7560975609756098]
Best epoch: 28
The number of epochs since last 1% equals the patience
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_205_3b4_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.16]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_1p5_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.347]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_1p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.205]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_207_2b3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.29]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_2p2_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.182]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_218_1b1_Al_sc_Meditron_3_label_0_pred_0.png, [[0.19]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_226_1b1_Pl_sc_LittC2SE_0_label_1_pred_0.png, [[0.265]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[0.228]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_211_1p5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.167]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_224_1b1_Tc_sc_Meditron_3_label_0_pred_0.png, [[0.167]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_3_label_1_pred_1.png, [[0.531]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_207_2b4_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.195]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_207_3b2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.205]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_2p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.214]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_219_2b3_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[0.769]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_203_2p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.199]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_223_1b1_Ll_sc_Meditron_3_label_0_pred_0.png, [[0.213]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_219_2b2_Ar_mc_LittC2SE_3_label_1_pred_0.png, [[0.354]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_1p2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.193]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_221_2b1_Ar_mc_LittC2SE_2_label_0_pred_1.png, [[0.722]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_217_1b1_Tc_sc_Meditron_2_label_0_pred_0.png, [[0.208]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_223_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[0.209]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_223_1b1_Ll_sc_Meditron_0_label_0_pred_0.png, [[0.205]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.202]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.149]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_205_1b3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.232]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_223_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[0.186]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_211_1p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.202]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_218_1b1_Ar_sc_Meditron_9_label_0_pred_0.png, [[0.361]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.2]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/jordan_EP36_pneumonia,Crep,P R M,36,F_4_label_1_pred_1.png, [[0.83]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.672]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_211_1p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.216]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_218_1p1_Pl_sc_Litt3200_0_label_0_pred_0.png, [[0.284]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_203_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.167]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_221_2b3_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.699]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_0_label_1_pred_1.png, [[0.532]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_210_1b1_Al_sc_Meditron_2_label_0_pred_0.png, [[0.192]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_1p5_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.358]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_207_3b2_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[0.179]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_207_2b4_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.19]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.205]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_218_1b1_Pl_sc_Meditron_6_label_0_pred_0.png, [[0.215]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_203_2p3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.167]]
../../new_cache/conv__2254__06_2129__v39__augm_half/3/icbhi_204_2b5_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.202]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 27566
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_013207-1qfjphv1/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_013207-1qfjphv1/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99878
wandb:         val_accuracy 0.93811
wandb:             _runtime 6159
wandb:           _timestamp 1624677287
wandb:                _step 353
wandb:           train_loss 0.57815
wandb:             val_loss 0.54541
wandb:           val_recall 0.4878
wandb:        val_precision 0.54054
wandb:               val_f1 0.51282
wandb:              val_auc 0.49524
wandb:                   lr 6e-05
wandb:          best_val_f1 0.64583
wandb:    best_val_accuracy 0.94463
wandb:   best_val_precision 0.56364
wandb:      best_val_recall 0.7561
wandb:             best_auc 0.57255
wandb:           best_epoch 28
wandb: Run history:
wandb:   train_accuracy ▁▂▄▅▅▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇██████████████████
wandb:     val_accuracy ▁▁▁██▇▇██▇▇▇█▆▄▇▇▅▇███████▇█████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▂▂▂▂▂▂▂▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss █▆▃▁▁▁▂▁▁▂▂▁▁▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ███▁▅▆▇▃▇▇▇▆▅▇█▇▆█▆▆▅▆▆▆▆▆▆▅▅▅▅▅▅▅▅▅▄▄▅▄
wandb:    val_precision ▂▂▂▁▆▄▃▆▅▄▃▄▇▃▂▃▄▃▅▆▅▅▆▇▆▆▄█▇▆▇▆▆▇▇▇▇▇▇▇
wandb:           val_f1 ▂▂▂▁▆▅▅▅▇▅▅▆▇▄▃▅▅▄▆▇▆▆▇█▇▇▆█▇▆▇▆▆▆▇▆▆▆▇▇
wandb:          val_auc ▁▁▁▂▆▄▄▄▇▆▄▅▇▅▂█▄▇▆▇▇▆▇▇▆▆▆█▇▆▇▆▆▆▆▆▆▆▆▆
wandb:               lr ██████████████████▄▄▄▄▄▄▄▄▄▄▄▂▂▂▂▂▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_013207-1qfjphv1

-----------------------

 See logs at ../../new_cache/conv__2254__06_2129__v39__augm_half/logs/