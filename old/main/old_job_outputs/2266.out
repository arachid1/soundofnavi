Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2266
Description:  mixup
2021-06-28 21:53:10.726331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-28 21:53:13.745393: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-28 21:53:13.746463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-28 21:53:13.806876: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:13.807688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-28 21:53:13.807726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 21:53:13.811628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 21:53:13.811744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-28 21:53:13.812953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-28 21:53:13.813336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-28 21:53:13.814466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-28 21:53:13.815396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-28 21:53:13.815558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 21:53:13.815705: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:13.816539: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:13.817259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2266.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2266__06_2118__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-28 21:53:19.086957: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-28 21:53:19.087315: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:19.088127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-28 21:53:19.088201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 21:53:19.088286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 21:53:19.088310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-28 21:53:19.088333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-28 21:53:19.088355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-28 21:53:19.088376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-28 21:53:19.088399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-28 21:53:19.088419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 21:53:19.088544: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:19.089351: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:19.090047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-28 21:53:19.090098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 21:53:20.086796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-28 21:53:20.086864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-28 21:53:20.086887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-28 21:53:20.087277: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:20.088483: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:20.089683: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 21:53:20.090720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-28 21:53:21.269824: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-28 21:53:21.272326: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-28 21:54:28.941917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 21:54:39.102591: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 21:54:49.008760: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 2858
2021-06-28 21:54:58.920921: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2369 of 2858
2021-06-28 21:55:08.916349: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 2858
2021-06-28 21:55:12.801342: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-06-28 21:55:13.230627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 21:55:15.224952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 21:55:15.854891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 2858
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
179/179 - 132s - loss: 0.3187 - accuracy: 0.8947 - val_loss: 0.2483 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.38793976087928833
Validation class accuracies: [1.0, 0.0]
2021-06-28 21:56:51.978688: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 21:57:02.018890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 21:57:12.053507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 2858
2021-06-28 21:57:21.996435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 2858
2021-06-28 21:57:32.007735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 2858
2021-06-28 21:57:36.180459: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
179/179 - 126s - loss: 0.1374 - accuracy: 0.9451 - val_loss: 0.2720 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09741071103700229
Validation class accuracies: [1.0, 0.0]
2021-06-28 21:59:08.373558: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 21:59:18.448550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 2858
2021-06-28 21:59:28.368569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 2858
2021-06-28 21:59:38.382716: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 2858
2021-06-28 21:59:48.390455: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2763 of 2858
2021-06-28 21:59:50.912834: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
179/179 - 125s - loss: 0.1019 - accuracy: 0.9479 - val_loss: 0.2886 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12894777690112408
Validation class accuracies: [1.0, 0.0]
2021-06-28 22:01:23.760028: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:01:33.772639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:01:43.782993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:01:53.897966: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2369 of 2858
2021-06-28 22:02:03.886633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-28 22:02:07.131706: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
179/179 - 126s - loss: 0.0766 - accuracy: 0.9633 - val_loss: 0.1649 - val_accuracy: 0.9446
Confusion matrix: 
 [[573   0]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.829 0.171]]
Validation f1: 29.17
Validation accuracy: 94.46
Validation recall: 17.07
Validation precision: 100.00
Validation AUC: 0.6680449202620969
Validation class accuracies: [1.0, 0.17073170731707318]
2021-06-28 22:03:40.814800: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:03:50.895997: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:04:00.931041: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:04:10.946243: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 2858
2021-06-28 22:04:20.734248: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2711 of 2858
2021-06-28 22:04:24.741350: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
179/179 - 127s - loss: 0.0544 - accuracy: 0.9724 - val_loss: 0.2745 - val_accuracy: 0.9186
Confusion matrix: 
 [[534  39]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.268 0.732]]
Validation f1: 54.55
Validation accuracy: 91.86
Validation recall: 73.17
Validation precision: 43.48
Validation AUC: 0.5298512463683763
Validation class accuracies: [0.9319371727748691, 0.7317073170731707]
2021-06-28 22:05:58.080729: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:06:07.911241: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:06:18.075626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 2858
2021-06-28 22:06:27.900068: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2369 of 2858
2021-06-28 22:06:38.205142: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-28 22:06:41.497083: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
179/179 - 125s - loss: 0.0372 - accuracy: 0.9780 - val_loss: 0.1966 - val_accuracy: 0.9300
Confusion matrix: 
 [[542  31]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.293 0.707]]
Validation f1: 57.43
Validation accuracy: 93.00
Validation recall: 70.73
Validation precision: 48.33
Validation AUC: 0.6513690488314468
Validation class accuracies: [0.9458987783595113, 0.7073170731707317]
2021-06-28 22:08:13.592117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 22:08:23.674083: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-28 22:08:33.691616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 2858
2021-06-28 22:08:43.513099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2515 of 2858
2021-06-28 22:08:52.758836: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 7/65
179/179 - 122s - loss: 0.0261 - accuracy: 0.9850 - val_loss: 0.3671 - val_accuracy: 0.8893
Confusion matrix: 
 [[514  59]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.22  0.78 ]]
Validation f1: 48.48
Validation accuracy: 88.93
Validation recall: 78.05
Validation precision: 35.16
Validation AUC: 0.538597827927963
Validation class accuracies: [0.8970331588132635, 0.7804878048780488]
2021-06-28 22:10:25.440969: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:10:35.570141: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:10:45.530826: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:10:55.559461: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 2858
2021-06-28 22:11:05.479007: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-28 22:11:08.851174: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5742574257425742 hasn't increased by 0 in 1 epochs
Epoch 8/65
179/179 - 126s - loss: 0.0317 - accuracy: 0.9804 - val_loss: 0.2675 - val_accuracy: 0.9186
Confusion matrix: 
 [[538  35]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.366 0.634]]
Validation f1: 50.98
Validation accuracy: 91.86
Validation recall: 63.41
Validation precision: 42.62
Validation AUC: 0.4939731162460543
Validation class accuracies: [0.9389179755671903, 0.6341463414634146]
2021-06-28 22:12:41.866526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:12:51.957655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 2858
2021-06-28 22:13:01.755692: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 2858
2021-06-28 22:13:11.920489: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 2858
2021-06-28 22:13:21.735456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-28 22:13:25.197505: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5742574257425742 hasn't increased by 0 in 2 epochs
Epoch 9/65
179/179 - 126s - loss: 0.0274 - accuracy: 0.9801 - val_loss: 0.1892 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6358528727371352
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-28 22:14:57.756031: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:15:07.684743: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:15:17.732481: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 2858
2021-06-28 22:15:27.734580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 2858
2021-06-28 22:15:37.707799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 2858
2021-06-28 22:15:39.564359: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 10/65
179/179 - 124s - loss: 0.0232 - accuracy: 0.9829 - val_loss: 0.2209 - val_accuracy: 0.9316
Confusion matrix: 
 [[540  33]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.22  0.78 ]]
Validation f1: 60.38
Validation accuracy: 93.16
Validation recall: 78.05
Validation precision: 49.23
Validation AUC: 0.6430314193841065
Validation class accuracies: [0.9424083769633508, 0.7804878048780488]
2021-06-28 22:17:11.992725: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:17:22.067340: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-28 22:17:32.026948: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 22:17:41.868047: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2858
2021-06-28 22:17:50.635463: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 1 epochs
Epoch 11/65
179/179 - 121s - loss: 0.0362 - accuracy: 0.9790 - val_loss: 0.2677 - val_accuracy: 0.9381
Confusion matrix: 
 [[567   6]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99 0.01]
 [0.78 0.22]]
Validation f1: 32.14
Validation accuracy: 93.81
Validation recall: 21.95
Validation precision: 60.00
Validation AUC: 0.48070347906514477
Validation class accuracies: [0.9895287958115183, 0.21951219512195122]
2021-06-28 22:19:23.321439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:19:33.235759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:19:43.284366: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 2858
2021-06-28 22:19:53.686697: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:20:03.090721: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2801 of 2858
2021-06-28 22:20:04.531568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 2 epochs
Epoch 12/65
179/179 - 124s - loss: 0.0211 - accuracy: 0.9815 - val_loss: 0.1628 - val_accuracy: 0.9479
Confusion matrix: 
 [[557  16]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.39  0.61 ]]
Validation f1: 60.98
Validation accuracy: 94.79
Validation recall: 60.98
Validation precision: 60.98
Validation AUC: 0.6725196535854204
Validation class accuracies: [0.9720767888307156, 0.6097560975609756]
2021-06-28 22:21:37.753367: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:21:47.589117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 2858
2021-06-28 22:21:57.648197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 2858
2021-06-28 22:22:07.512745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 2858
2021-06-28 22:22:17.565640: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2747 of 2858
2021-06-28 22:22:20.379509: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 3 epochs
Epoch 13/65
179/179 - 126s - loss: 0.0203 - accuracy: 0.9832 - val_loss: 0.1713 - val_accuracy: 0.9544
Confusion matrix: 
 [[558  15]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.317 0.683]]
Validation f1: 66.67
Validation accuracy: 95.44
Validation recall: 68.29
Validation precision: 65.12
Validation AUC: 0.6916036565567469
Validation class accuracies: [0.9738219895287958, 0.6829268292682927]
2021-06-28 22:23:53.855735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:24:03.840348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:24:13.623512: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:24:24.562853: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:24:33.966846: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2795 of 2858
2021-06-28 22:24:35.445110: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 14/65
179/179 - 124s - loss: 0.0209 - accuracy: 0.9850 - val_loss: 0.1787 - val_accuracy: 0.9528
Confusion matrix: 
 [[557  16]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.317 0.683]]
Validation f1: 65.88
Validation accuracy: 95.28
Validation recall: 68.29
Validation precision: 63.64
Validation AUC: 0.6822814393933897
Validation class accuracies: [0.9720767888307156, 0.6829268292682927]
2021-06-28 22:26:08.053150: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:26:18.014525: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 22:26:28.046633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-28 22:26:37.966900: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2858
2021-06-28 22:26:46.904099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 1 epochs
Epoch 15/65
179/179 - 122s - loss: 0.0196 - accuracy: 0.9843 - val_loss: 0.2291 - val_accuracy: 0.9528
Confusion matrix: 
 [[570   3]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.634 0.366]]
Validation f1: 50.85
Validation accuracy: 95.28
Validation recall: 36.59
Validation precision: 83.33
Validation AUC: 0.6281938926372014
Validation class accuracies: [0.9947643979057592, 0.36585365853658536]
2021-06-28 22:28:19.948178: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:28:29.982285: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2858
2021-06-28 22:28:39.942382: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 22:28:50.067681: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2858
2021-06-28 22:29:00.024959: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2827 of 2858
2021-06-28 22:29:00.480160: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 2 epochs
Epoch 16/65
179/179 - 124s - loss: 0.0186 - accuracy: 0.9829 - val_loss: 0.2096 - val_accuracy: 0.9463
Confusion matrix: 
 [[563  10]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.561 0.439]]
Validation f1: 52.17
Validation accuracy: 94.63
Validation recall: 43.90
Validation precision: 64.29
Validation AUC: 0.5660023137443276
Validation class accuracies: [0.9825479930191972, 0.43902439024390244]
2021-06-28 22:30:34.544517: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:30:44.366922: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:30:54.525918: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 22:31:04.321677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2468 of 2858
2021-06-28 22:31:14.335147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2827 of 2858
2021-06-28 22:31:14.960207: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 3 epochs
Epoch 17/65
179/179 - 124s - loss: 0.0170 - accuracy: 0.9843 - val_loss: 0.2432 - val_accuracy: 0.9235
Confusion matrix: 
 [[537  36]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.268 0.732]]
Validation f1: 56.07
Validation accuracy: 92.35
Validation recall: 73.17
Validation precision: 45.45
Validation AUC: 0.6267297832394526
Validation class accuracies: [0.93717277486911, 0.7317073170731707]
2021-06-28 22:32:49.492958: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:32:59.562418: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:33:09.364284: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 2858
2021-06-28 22:33:19.977835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:33:29.456192: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2795 of 2858
2021-06-28 22:33:30.833403: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 4 epochs
Epoch 18/65
179/179 - 125s - loss: 0.0198 - accuracy: 0.9808 - val_loss: 0.1867 - val_accuracy: 0.9479
Confusion matrix: 
 [[564   9]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.561 0.439]]
Validation f1: 52.94
Validation accuracy: 94.79
Validation recall: 43.90
Validation precision: 66.67
Validation AUC: 0.6185632788214849
Validation class accuracies: [0.9842931937172775, 0.43902439024390244]
2021-06-28 22:35:04.110786: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:35:14.119550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2858
2021-06-28 22:35:23.959142: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 22:35:34.003759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 2858
2021-06-28 22:35:42.801790: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 5 epochs
Epoch 19/65
179/179 - 122s - loss: 0.0169 - accuracy: 0.9839 - val_loss: 0.1889 - val_accuracy: 0.9511
Confusion matrix: 
 [[564   9]
 [ 21  20]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.512 0.488]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.14
Validation accuracy: 95.11
Validation recall: 48.78
Validation precision: 68.97
Validation AUC: 0.6270954874816639
Validation class accuracies: [0.9842931937172775, 0.4878048780487805]
2021-06-28 22:37:19.472143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 2858
2021-06-28 22:37:29.336266: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 2858
2021-06-28 22:37:39.466175: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2858
2021-06-28 22:37:49.306133: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1793 of 2858
2021-06-28 22:37:59.368754: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2305 of 2858
2021-06-28 22:38:09.611752: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 2858
2021-06-28 22:38:14.072805: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 20/65
179/179 - 137s - loss: 0.0131 - accuracy: 0.9864 - val_loss: 0.2102 - val_accuracy: 0.9381
Confusion matrix: 
 [[548  25]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.317 0.683]]
Validation f1: 59.57
Validation accuracy: 93.81
Validation recall: 68.29
Validation precision: 52.83
Validation AUC: 0.6366250031884058
Validation class accuracies: [0.956369982547993, 0.6829268292682927]
2021-06-28 22:39:45.799855: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 22:39:55.956237: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2858
2021-06-28 22:40:05.948040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 2858
2021-06-28 22:40:15.926136: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2603 of 2858
2021-06-28 22:40:20.636620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 7 epochs
Epoch 21/65
179/179 - 115s - loss: 0.0196 - accuracy: 0.9811 - val_loss: 0.1735 - val_accuracy: 0.9479
Confusion matrix: 
 [[560  13]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.463 0.537]]
Validation f1: 57.89
Validation accuracy: 94.79
Validation recall: 53.66
Validation precision: 62.86
Validation AUC: 0.649049254691183
Validation class accuracies: [0.9773123909249564, 0.5365853658536586]
2021-06-28 22:41:50.641834: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:42:00.834920: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-28 22:42:10.731888: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 2858
2021-06-28 22:42:20.650073: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 2858
2021-06-28 22:42:25.606845: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 8 epochs
Epoch 22/65
179/179 - 115s - loss: 0.0141 - accuracy: 0.9857 - val_loss: 0.1934 - val_accuracy: 0.9463
Confusion matrix: 
 [[554  19]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.341 0.659]]
Validation f1: 62.07
Validation accuracy: 94.63
Validation recall: 65.85
Validation precision: 58.70
Validation AUC: 0.6521061637267034
Validation class accuracies: [0.9668411867364747, 0.6585365853658537]
2021-06-28 22:43:54.891172: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 22:44:05.041759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2858
2021-06-28 22:44:14.887613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 2858
2021-06-28 22:44:24.965184: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 2858
2021-06-28 22:44:28.719456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 9 epochs
Epoch 23/65
179/179 - 115s - loss: 0.0167 - accuracy: 0.9825 - val_loss: 0.1979 - val_accuracy: 0.9316
Confusion matrix: 
 [[545  28]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.341 0.659]]
Validation f1: 56.25
Validation accuracy: 93.16
Validation recall: 65.85
Validation precision: 49.09
Validation AUC: 0.6594568444894189
Validation class accuracies: [0.9511343804537522, 0.6585365853658537]
2021-06-28 22:46:01.254566: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:46:11.330445: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2858
2021-06-28 22:46:21.328047: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 2858
2021-06-28 22:46:31.301539: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2500 of 2858
2021-06-28 22:46:38.658190: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 10 epochs
Epoch 24/65
179/179 - 117s - loss: 0.0172 - accuracy: 0.9850 - val_loss: 0.1737 - val_accuracy: 0.9528
Confusion matrix: 
 [[556  17]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.293 0.707]]
Validation f1: 66.67
Validation accuracy: 95.28
Validation recall: 70.73
Validation precision: 63.04
Validation AUC: 0.685942957985489
Validation class accuracies: [0.9703315881326352, 0.7073170731707317]
2021-06-28 22:48:08.460719: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:48:18.409046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 2858
2021-06-28 22:48:28.473283: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 2858
2021-06-28 22:48:38.869363: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:48:46.642854: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 11 epochs
Epoch 25/65
179/179 - 120s - loss: 0.0177 - accuracy: 0.9825 - val_loss: 0.1842 - val_accuracy: 0.9528
Confusion matrix: 
 [[563  10]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.463 0.537]]
Validation f1: 60.27
Validation accuracy: 95.28
Validation recall: 53.66
Validation precision: 68.75
Validation AUC: 0.6474760119967699
Validation class accuracies: [0.9825479930191972, 0.5365853658536586]
2021-06-28 22:50:18.501119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:50:28.442534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 22:50:38.425169: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-28 22:50:48.476303: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 2858
2021-06-28 22:50:54.020571: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 26/65
179/179 - 116s - loss: 0.0114 - accuracy: 0.9867 - val_loss: 0.1895 - val_accuracy: 0.9495
Confusion matrix: 
 [[555  18]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.317 0.683]]
Validation f1: 64.37
Validation accuracy: 94.95
Validation recall: 68.29
Validation precision: 60.87
Validation AUC: 0.655294579463085
Validation class accuracies: [0.9685863874345549, 0.6829268292682927]
2021-06-28 22:52:23.520018: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 22:52:33.503723: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-28 22:52:43.543504: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 2858
2021-06-28 22:52:53.679618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 2858
2021-06-28 22:52:58.615648: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 13 epochs
Epoch 27/65
179/179 - 115s - loss: 0.0149 - accuracy: 0.9871 - val_loss: 0.1893 - val_accuracy: 0.9397
Confusion matrix: 
 [[551  22]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.43
Validation accuracy: 93.97
Validation recall: 63.41
Validation precision: 54.17
Validation AUC: 0.6353301108066768
Validation class accuracies: [0.9616055846422339, 0.6341463414634146]
2021-06-28 22:54:28.884315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:54:38.906487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 22:54:48.972157: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-28 22:54:58.816285: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2565 of 2858
2021-06-28 22:55:04.392681: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 14 epochs
Epoch 28/65
179/179 - 116s - loss: 0.0192 - accuracy: 0.9818 - val_loss: 0.2020 - val_accuracy: 0.9349
Confusion matrix: 
 [[550  23]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.415 0.585]]
Validation f1: 54.55
Validation accuracy: 93.49
Validation recall: 58.54
Validation precision: 51.06
Validation AUC: 0.6087253055157164
Validation class accuracies: [0.9598603839441536, 0.5853658536585366]
2021-06-28 22:56:34.823657: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:56:44.958066: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-28 22:56:54.980606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 22:57:05.013330: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-28 22:57:10.270838: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 15 epochs
Epoch 29/65
179/179 - 116s - loss: 0.0157 - accuracy: 0.9843 - val_loss: 0.1847 - val_accuracy: 0.9430
Confusion matrix: 
 [[556  17]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.439 0.561]]
Validation f1: 56.79
Validation accuracy: 94.30
Validation recall: 56.10
Validation precision: 57.50
Validation AUC: 0.6267946859990794
Validation class accuracies: [0.9703315881326352, 0.5609756097560976]
2021-06-28 22:58:39.746039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 2858
2021-06-28 22:58:49.547083: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 2858
2021-06-28 22:58:59.672267: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 2858
2021-06-28 22:59:09.597872: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2747 of 2858
2021-06-28 22:59:11.295383: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 16 epochs
Epoch 30/65
179/179 - 111s - loss: 0.0156 - accuracy: 0.9850 - val_loss: 0.1782 - val_accuracy: 0.9430
Confusion matrix: 
 [[558  15]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.488 0.512]]
Validation f1: 54.55
Validation accuracy: 94.30
Validation recall: 51.22
Validation precision: 58.33
Validation AUC: 0.641220540442312
Validation class accuracies: [0.9738219895287958, 0.5121951219512195]
2021-06-28 23:00:40.403549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-28 23:00:50.466550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-28 23:01:00.361693: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 2858
2021-06-28 23:01:10.295869: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 2858
2021-06-28 23:01:14.492037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 17 epochs
Epoch 31/65
179/179 - 115s - loss: 0.0155 - accuracy: 0.9822 - val_loss: 0.1775 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.317 0.683]]
Validation f1: 62.92
Validation accuracy: 94.63
Validation recall: 68.29
Validation precision: 58.33
Validation AUC: 0.6644350368223558
Validation class accuracies: [0.9650959860383944, 0.6829268292682927]
2021-06-28 23:02:45.190681: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 23:02:55.259662: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-28 23:03:05.027109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1965 of 2858
2021-06-28 23:03:15.110343: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 2858
2021-06-28 23:03:20.764826: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 32/65
179/179 - 116s - loss: 0.0135 - accuracy: 0.9853 - val_loss: 0.1734 - val_accuracy: 0.9495
Confusion matrix: 
 [[557  16]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.366 0.634]]
Validation f1: 62.65
Validation accuracy: 94.95
Validation recall: 63.41
Validation precision: 61.90
Validation AUC: 0.6605007076662541
Validation class accuracies: [0.9720767888307156, 0.6341463414634146]
2021-06-28 23:04:51.159647: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 23:05:01.360950: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-28 23:05:11.359272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 23:05:21.219409: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 2858
2021-06-28 23:05:26.957566: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 19 epochs
Epoch 33/65
179/179 - 116s - loss: 0.0172 - accuracy: 0.9811 - val_loss: 0.1839 - val_accuracy: 0.9463
Confusion matrix: 
 [[555  18]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.366 0.634]]
Validation f1: 61.18
Validation accuracy: 94.63
Validation recall: 63.41
Validation precision: 59.09
Validation AUC: 0.65748525167697
Validation class accuracies: [0.9685863874345549, 0.6341463414634146]

The metrics for job 0 with the best target metric are: 
Best cm: [[558  15]
 [ 13  28]]
Best normalized cm: [[0.974 0.026]
 [0.317 0.683]]
Best f1: 0.67
Best accuracy: 0.95
Best recall: 0.68
Best precision: 0.65
Best AUC: 0.69
Best class accuracies: [0.9738219895287958, 0.6829268292682927]
Best epoch: 13
The number of epochs since last 1% equals the patience
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[3.23e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[5.043e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[8.748e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.323]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.754e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.028]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.089]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[3.887e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.249e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[1.205e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[3.448e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[7.461e-06]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[8.973e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[8.905e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[6.05e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.038]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.052]]
../../new_cache/conv__2266__06_2118__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.528]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 19519
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_215314-1u89jiox/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_215314-1u89jiox/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98111
wandb:         val_accuracy 0.94625
wandb:             _runtime 4413
wandb:           _timestamp 1624921607
wandb:                _step 245
wandb:           train_loss 0.01717
wandb:             val_loss 0.18387
wandb:           val_recall 0.63415
wandb:        val_precision 0.59091
wandb:               val_f1 0.61176
wandb:              val_auc 0.65749
wandb:                   lr 0.00013
wandb:          best_val_f1 0.66667
wandb:    best_val_accuracy 0.9544
wandb:   best_val_precision 0.65116
wandb:      best_val_recall 0.68293
wandb:             best_auc 0.6916
wandb:           best_epoch 13
wandb: Run history:
wandb:   train_accuracy ▁▅▅▆▇▇█▇▇█▇██████████████████████
wandb:     val_accuracy ▆▆▆▇▄▅▁▄▇▆▆▇███▇▅▇█▆▇▇▆██▇▆▆▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▄▅▅▁▅▂█▅▂▃▅▁▁▂▃▃▄▂▂▃▁▂▂▁▂▂▂▂▂▂▂▁▂
wandb:       val_recall ▁▁▁▃█▇█▇▇█▃▆▇▇▄▅█▅▅▇▆▇▇▇▆▇▇▆▆▆▇▇▇
wandb:    val_precision ▁▁▁█▄▄▃▄▅▄▅▅▆▅▇▅▄▆▆▅▅▅▄▅▆▅▅▅▅▅▅▅▅
wandb:           val_f1 ▁▁▁▄▇▇▆▆█▇▄▇██▆▆▇▇▇▇▇█▇█▇█▇▇▇▇██▇
wandb:          val_auc ▄▁▁█▆█▆▆▇▇▆███▇▇▇▇▇▇▇███▇█▇▇▇▇███
wandb:               lr ███████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_215314-1u89jiox

-----------------------
model 9
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 2858
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate_42630 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_42630[0][0]              
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-28 23:08:27.468103: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 23:08:37.547786: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-28 23:08:47.503649: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2858
2021-06-28 23:08:57.653096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 2858
2021-06-28 23:09:01.823542: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Epoch 1/65
179/179 - 312s - loss: 0.3629 - accuracy: 0.8842 - val_loss: 0.2657 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2998673179189034
Validation class accuracies: [1.0, 0.0]
2021-06-28 23:13:53.748685: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 23:14:03.753969: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 23:14:13.644598: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-28 23:14:23.863290: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-28 23:14:29.050727: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
179/179 - 310s - loss: 0.1715 - accuracy: 0.9272 - val_loss: 0.2451 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.34325318045974074
Validation class accuracies: [1.0, 0.0]
2021-06-28 23:19:17.448034: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-28 23:19:27.383100: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2858
2021-06-28 23:19:37.499417: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 2858
2021-06-28 23:19:47.354776: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2625 of 2858
2021-06-28 23:19:51.657917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
179/179 - 309s - loss: 0.1564 - accuracy: 0.9342 - val_loss: 0.2609 - val_accuracy: 0.9397
Confusion matrix: 
 [[570   3]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.829 0.171]]
Validation f1: 27.45
Validation accuracy: 93.97
Validation recall: 17.07
Validation precision: 70.00
Validation AUC: 0.500957733642076
Validation class accuracies: [0.9947643979057592, 0.17073170731707318]
2021-06-28 23:24:40.332551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 23:24:50.367617: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 23:25:00.465047: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-28 23:25:10.411812: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 2858
2021-06-28 23:25:16.292820: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
179/179 - 310s - loss: 0.1320 - accuracy: 0.9398 - val_loss: 0.1585 - val_accuracy: 0.9332
Confusion matrix: 
 [[554  19]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.537 0.463]]
Validation f1: 48.10
Validation accuracy: 93.32
Validation recall: 46.34
Validation precision: 50.00
Validation AUC: 0.5210708395199483
Validation class accuracies: [0.9668411867364747, 0.4634146341463415]
2021-06-28 23:30:04.628462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-28 23:30:14.796155: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 2858
2021-06-28 23:30:24.615763: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 2858
2021-06-28 23:30:34.653719: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 2858
2021-06-28 23:30:38.643220: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
179/179 - 308s - loss: 0.1268 - accuracy: 0.9437 - val_loss: 0.2700 - val_accuracy: 0.8990
Confusion matrix: 
 [[534  39]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.561 0.439]]
Validation f1: 36.73
Validation accuracy: 89.90
Validation recall: 43.90
Validation precision: 31.58
Validation AUC: 0.2930863586211983
Validation class accuracies: [0.9319371727748691, 0.43902439024390244]
2021-06-28 23:35:26.748716: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 23:35:36.796215: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2858
2021-06-28 23:35:46.816012: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 2858
2021-06-28 23:35:56.665494: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2603 of 2858
2021-06-28 23:36:01.289145: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.48101265822784817 hasn't increased by 0 in 1 epochs
Epoch 6/65
179/179 - 309s - loss: 0.1143 - accuracy: 0.9538 - val_loss: 0.2724 - val_accuracy: 0.9495
Confusion matrix: 
 [[571   2]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.707 0.293]]
Validation f1: 43.64
Validation accuracy: 94.95
Validation recall: 29.27
Validation precision: 85.71
Validation AUC: 0.505672905195315
Validation class accuracies: [0.9965095986038395, 0.2926829268292683]
2021-06-28 23:40:49.446240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 23:40:59.413508: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-28 23:41:09.238246: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 23:41:19.249137: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-28 23:41:24.476755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.48101265822784817 hasn't increased by 0 in 2 epochs
Epoch 7/65
179/179 - 309s - loss: 0.1092 - accuracy: 0.9545 - val_loss: 0.3494 - val_accuracy: 0.9137
Confusion matrix: 
 [[550  23]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.732 0.268]]
Validation f1: 29.33
Validation accuracy: 91.37
Validation recall: 26.83
Validation precision: 32.35
Validation AUC: 0.23516557342653518
Validation class accuracies: [0.9598603839441536, 0.2682926829268293]
2021-06-28 23:46:12.600623: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 23:46:22.415141: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 2858
2021-06-28 23:46:32.572385: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 2858
2021-06-28 23:46:42.474728: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 2858
2021-06-28 23:46:48.510610: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.48101265822784817 hasn't increased by 0 in 3 epochs
Epoch 8/65
179/179 - 310s - loss: 0.0945 - accuracy: 0.9594 - val_loss: 0.4468 - val_accuracy: 0.8876
Confusion matrix: 
 [[521  52]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.415 0.585]]
Validation f1: 41.03
Validation accuracy: 88.76
Validation recall: 58.54
Validation precision: 31.58
Validation AUC: 0.4271414205414296
Validation class accuracies: [0.9092495636998255, 0.5853658536585366]
2021-06-28 23:51:36.284171: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 23:51:46.342364: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-28 23:51:56.344491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2858
2021-06-28 23:52:06.241702: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2603 of 2858
2021-06-28 23:52:10.763087: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.48101265822784817 hasn't increased by 0 in 4 epochs
Epoch 9/65
179/179 - 308s - loss: 0.0890 - accuracy: 0.9580 - val_loss: 0.2164 - val_accuracy: 0.9397
Confusion matrix: 
 [[562  11]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.634 0.366]]
Validation f1: 44.78
Validation accuracy: 93.97
Validation recall: 36.59
Validation precision: 57.69
Validation AUC: 0.4160868842801692
Validation class accuracies: [0.9808027923211169, 0.36585365853658536]
2021-06-28 23:56:58.842241: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 23:57:08.811096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-28 23:57:18.690701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 23:57:28.721586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-28 23:57:33.996670: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.48101265822784817 hasn't increased by 0 in 5 epochs
Epoch 10/65
179/179 - 309s - loss: 0.0852 - accuracy: 0.9601 - val_loss: 0.7400 - val_accuracy: 0.8290
Confusion matrix: 
 [[474  99]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.827 0.173]
 [0.146 0.854]]
Validation f1: 40.00
Validation accuracy: 82.90
Validation recall: 85.37
Validation precision: 26.12
Validation AUC: 0.33044856347186097
Validation class accuracies: [0.8272251308900523, 0.8536585365853658]
2021-06-29 00:02:21.764792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 00:02:31.740181: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-29 00:02:41.860865: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 2858
2021-06-29 00:02:51.881054: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 2858
2021-06-29 00:02:54.672163: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.48101265822784817 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
179/179 - 307s - loss: 0.0686 - accuracy: 0.9657 - val_loss: 0.2182 - val_accuracy: 0.9511
Confusion matrix: 
 [[565   8]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.537 0.463]]
Validation f1: 55.88
Validation accuracy: 95.11
Validation recall: 46.34
Validation precision: 70.37
Validation AUC: 0.5253733238247009
Validation class accuracies: [0.9860383944153578, 0.4634146341463415]
2021-06-29 00:07:43.100563: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-29 00:07:53.120633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-29 00:08:03.020262: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 2858
2021-06-29 00:08:13.097847: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 2858
2021-06-29 00:08:18.039774: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 12/65
179/179 - 309s - loss: 0.0566 - accuracy: 0.9703 - val_loss: 0.3142 - val_accuracy: 0.9088
Confusion matrix: 
 [[539  34]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.537 0.463]]
Validation f1: 40.43
Validation accuracy: 90.88
Validation recall: 46.34
Validation precision: 35.85
Validation AUC: 0.4552088365201625
Validation class accuracies: [0.9406631762652705, 0.4634146341463415]
2021-06-29 00:13:06.222767: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 00:13:16.148382: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-29 00:13:26.087462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2858
2021-06-29 00:13:36.076377: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2603 of 2858
2021-06-29 00:13:40.621757: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 1 epochs
Epoch 13/65
179/179 - 308s - loss: 0.0548 - accuracy: 0.9773 - val_loss: 0.1869 - val_accuracy: 0.9365
Confusion matrix: 
 [[567   6]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.805 0.195]]
Validation f1: 29.09
Validation accuracy: 93.65
Validation recall: 19.51
Validation precision: 57.14
Validation AUC: 0.4114197728478601
Validation class accuracies: [0.9895287958115183, 0.1951219512195122]
2021-06-29 00:18:28.554488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 2858
2021-06-29 00:18:38.333464: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 2858
2021-06-29 00:18:48.510494: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 2858
2021-06-29 00:18:58.504177: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2763 of 2858
2021-06-29 00:19:00.112293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 2 epochs
Epoch 14/65
179/179 - 306s - loss: 0.0541 - accuracy: 0.9713 - val_loss: 0.4618 - val_accuracy: 0.8876
Confusion matrix: 
 [[523  50]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.463 0.537]]
Validation f1: 38.94
Validation accuracy: 88.76
Validation recall: 53.66
Validation precision: 30.56
Validation AUC: 0.42835616834205964
Validation class accuracies: [0.912739965095986, 0.5365853658536586]
2021-06-29 00:23:48.044567: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-29 00:23:58.138919: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-29 00:24:08.022616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 2858
2021-06-29 00:24:18.113022: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 2858
2021-06-29 00:24:23.072175: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 3 epochs
Epoch 15/65
179/179 - 309s - loss: 0.0482 - accuracy: 0.9720 - val_loss: 0.3201 - val_accuracy: 0.9137
Confusion matrix: 
 [[537  36]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.415 0.585]]
Validation f1: 47.52
Validation accuracy: 91.37
Validation recall: 58.54
Validation precision: 40.00
Validation AUC: 0.5039711581953089
Validation class accuracies: [0.93717277486911, 0.5853658536585366]
2021-06-29 00:29:11.148715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-29 00:29:21.043807: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-29 00:29:30.961729: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-29 00:29:40.942868: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2567 of 2858
2021-06-29 00:29:46.467669: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 4 epochs
Epoch 16/65
179/179 - 310s - loss: 0.0551 - accuracy: 0.9717 - val_loss: 0.2528 - val_accuracy: 0.9169
Confusion matrix: 
 [[541  32]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.463 0.537]]
Validation f1: 46.32
Validation accuracy: 91.69
Validation recall: 53.66
Validation precision: 40.74
Validation AUC: 0.5013951809221511
Validation class accuracies: [0.944153577661431, 0.5365853658536586]
2021-06-29 00:34:34.535348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 00:34:44.449466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-29 00:34:54.550138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 2858
2021-06-29 00:35:04.651300: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 2858
2021-06-29 00:35:07.563322: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 5 epochs
Epoch 17/65
179/179 - 307s - loss: 0.0449 - accuracy: 0.9724 - val_loss: 0.3035 - val_accuracy: 0.9121
Confusion matrix: 
 [[537  36]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.439 0.561]]
Validation f1: 46.00
Validation accuracy: 91.21
Validation recall: 56.10
Validation precision: 38.98
Validation AUC: 0.46283253420065956
Validation class accuracies: [0.93717277486911, 0.5609756097560976]
2021-06-29 00:39:55.525147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 00:40:05.445844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-29 00:40:15.438927: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 2858
2021-06-29 00:40:25.418886: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2647 of 2858
2021-06-29 00:40:29.355618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 18/65
179/179 - 308s - loss: 0.0400 - accuracy: 0.9724 - val_loss: 0.5792 - val_accuracy: 0.8632
Confusion matrix: 
 [[501  72]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.874 0.126]
 [0.293 0.707]]
Validation f1: 40.85
Validation accuracy: 86.32
Validation recall: 70.73
Validation precision: 28.71
Validation AUC: 0.4369244947538764
Validation class accuracies: [0.8743455497382199, 0.7073170731707317]
2021-06-29 00:45:17.440240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 00:45:27.349274: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-29 00:45:37.436854: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 2858
2021-06-29 00:45:47.412708: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2651 of 2858
2021-06-29 00:45:51.041398: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 7 epochs
Epoch 19/65
179/179 - 308s - loss: 0.0305 - accuracy: 0.9811 - val_loss: 0.3799 - val_accuracy: 0.8990
Confusion matrix: 
 [[525  48]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.341 0.659]]
Validation f1: 46.55
Validation accuracy: 89.90
Validation recall: 65.85
Validation precision: 36.00
Validation AUC: 0.48417503343476065
Validation class accuracies: [0.9162303664921466, 0.6585365853658537]
2021-06-29 00:50:38.956520: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 00:50:49.164427: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 2858
2021-06-29 00:50:58.963575: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 2858
2021-06-29 00:51:08.958608: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2671 of 2858
2021-06-29 00:51:12.324230: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 8 epochs
Epoch 20/65
179/179 - 307s - loss: 0.0277 - accuracy: 0.9794 - val_loss: 0.4336 - val_accuracy: 0.8925
Confusion matrix: 
 [[525  48]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.439 0.561]]
Validation f1: 41.07
Validation accuracy: 89.25
Validation recall: 56.10
Validation precision: 32.39
Validation AUC: 0.3950727031470719
Validation class accuracies: [0.9162303664921466, 0.5609756097560976]
2021-06-29 00:56:00.051229: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 00:56:09.902704: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2858
2021-06-29 00:56:19.990072: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 2858
2021-06-29 00:56:29.881622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2620 of 2858
2021-06-29 00:56:34.172226: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 9 epochs
Epoch 21/65
179/179 - 308s - loss: 0.0276 - accuracy: 0.9804 - val_loss: 0.5797 - val_accuracy: 0.8795
Confusion matrix: 
 [[514  59]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.366 0.634]]
Validation f1: 41.27
Validation accuracy: 87.95
Validation recall: 63.41
Validation precision: 30.59
Validation AUC: 0.3560097764985563
Validation class accuracies: [0.8970331588132635, 0.6341463414634146]
2021-06-29 01:01:21.781074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 2858
2021-06-29 01:01:31.818584: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 2858
2021-06-29 01:01:41.880882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 2858
2021-06-29 01:01:51.728471: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 2858
2021-06-29 01:01:54.718383: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 10 epochs
Epoch 22/65
179/179 - 307s - loss: 0.0232 - accuracy: 0.9822 - val_loss: 0.4548 - val_accuracy: 0.8990
Confusion matrix: 
 [[528  45]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.415 0.585]]
Validation f1: 43.64
Validation accuracy: 89.90
Validation recall: 58.54
Validation precision: 34.78
Validation AUC: 0.4347363412065626
Validation class accuracies: [0.9214659685863874, 0.5853658536585366]
2021-06-29 01:06:44.601350: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 417 of 2858
2021-06-29 01:06:54.520315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 2858
2021-06-29 01:07:04.486890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1185 of 2858
2021-06-29 01:07:14.408408: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 2858
2021-06-29 01:07:24.764693: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-29 01:07:32.282070: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 11 epochs
Epoch 23/65
179/179 - 322s - loss: 0.0262 - accuracy: 0.9818 - val_loss: 0.3365 - val_accuracy: 0.9104
Confusion matrix: 
 [[539  34]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.512 0.488]]
Validation f1: 42.11
Validation accuracy: 91.04
Validation recall: 48.78
Validation precision: 37.04
Validation AUC: 0.4058572524448275
Validation class accuracies: [0.9406631762652705, 0.4878048780487805]
2021-06-29 01:12:20.411415: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2858
2021-06-29 01:12:30.569945: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-29 01:12:40.496293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 2858
2021-06-29 01:12:50.561156: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-29 01:12:57.916138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 24/65
179/179 - 312s - loss: 0.0242 - accuracy: 0.9801 - val_loss: 0.4045 - val_accuracy: 0.9072
Confusion matrix: 
 [[532  41]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.39  0.61 ]]
Validation f1: 46.73
Validation accuracy: 90.72
Validation recall: 60.98
Validation precision: 37.88
Validation AUC: 0.46529250393244115
Validation class accuracies: [0.9284467713787086, 0.6097560975609756]
2021-06-29 01:17:46.851620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 2858
2021-06-29 01:17:56.758414: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 2858
2021-06-29 01:18:06.730244: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1537 of 2858
2021-06-29 01:18:16.908802: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 2858
2021-06-29 01:18:26.820709: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2858
2021-06-29 01:18:35.309565: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 13 epochs
Epoch 25/65
179/179 - 324s - loss: 0.0239 - accuracy: 0.9839 - val_loss: 0.4279 - val_accuracy: 0.8974
Confusion matrix: 
 [[525  48]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.366 0.634]]
Validation f1: 45.22
Validation accuracy: 89.74
Validation recall: 63.41
Validation precision: 35.14
Validation AUC: 0.45061756628640764
Validation class accuracies: [0.9162303664921466, 0.6341463414634146]
2021-06-29 01:23:25.768396: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 2858
2021-06-29 01:23:35.533076: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 2858
2021-06-29 01:23:45.864701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-29 01:23:55.639312: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1777 of 2858
2021-06-29 01:24:05.739957: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-29 01:24:12.794705: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 14 epochs
Epoch 26/65
179/179 - 325s - loss: 0.0247 - accuracy: 0.9801 - val_loss: 0.3487 - val_accuracy: 0.9023
Confusion matrix: 
 [[530  43]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.415 0.585]]
Validation f1: 44.44
Validation accuracy: 90.23
Validation recall: 58.54
Validation precision: 35.82
Validation AUC: 0.4626074662842428
Validation class accuracies: [0.924956369982548, 0.5853658536585366]
2021-06-29 01:29:04.869599: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2858
2021-06-29 01:29:14.905185: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 2858
2021-06-29 01:29:24.963661: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 2858
2021-06-29 01:29:34.864171: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 2858
2021-06-29 01:29:37.557357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 15 epochs
Epoch 27/65
179/179 - 307s - loss: 0.0252 - accuracy: 0.9808 - val_loss: 0.5096 - val_accuracy: 0.8779
Confusion matrix: 
 [[513  60]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.366 0.634]]
Validation f1: 40.94
Validation accuracy: 87.79
Validation recall: 63.41
Validation precision: 30.23
Validation AUC: 0.41663190881573464
Validation class accuracies: [0.8952879581151832, 0.6341463414634146]
2021-06-29 01:34:25.792688: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2858
2021-06-29 01:34:36.017511: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2858
2021-06-29 01:34:45.821551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 2858
2021-06-29 01:34:55.879683: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 2858
2021-06-29 01:35:05.870807: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 2858
2021-06-29 01:35:07.563374: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 16 epochs
Epoch 28/65
179/179 - 317s - loss: 0.0219 - accuracy: 0.9818 - val_loss: 0.5175 - val_accuracy: 0.8844
Confusion matrix: 
 [[515  58]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.317 0.683]]
Validation f1: 44.09
Validation accuracy: 88.44
Validation recall: 68.29
Validation precision: 32.56
Validation AUC: 0.45990654062347547
Validation class accuracies: [0.8987783595113438, 0.6829268292682927]
2021-06-29 01:39:57.629212: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 2858
2021-06-29 01:40:07.707195: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 2858
2021-06-29 01:40:17.743075: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 2858
2021-06-29 01:40:27.804934: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-29 01:40:37.494118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-29 01:40:44.581773: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 17 epochs
Epoch 29/65
179/179 - 325s - loss: 0.0258 - accuracy: 0.9808 - val_loss: 0.4541 - val_accuracy: 0.8893
Confusion matrix: 
 [[522  51]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.415 0.585]]
Validation f1: 41.38
Validation accuracy: 88.93
Validation recall: 58.54
Validation precision: 32.00
Validation AUC: 0.3832199812073493
Validation class accuracies: [0.9109947643979057, 0.5853658536585366]
2021-06-29 01:45:36.275500: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 2858
2021-06-29 01:45:46.333981: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 2858
2021-06-29 01:45:56.354758: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 2858
2021-06-29 01:46:06.318013: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-29 01:46:08.331851: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 30/65
179/179 - 306s - loss: 0.0184 - accuracy: 0.9853 - val_loss: 0.3964 - val_accuracy: 0.8990
Confusion matrix: 
 [[528  45]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.64
Validation accuracy: 89.90
Validation recall: 58.54
Validation precision: 34.78
Validation AUC: 0.43558490677158257
Validation class accuracies: [0.9214659685863874, 0.5853658536585366]
2021-06-29 01:50:56.483232: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 2858
2021-06-29 01:51:06.366678: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 2858
2021-06-29 01:51:16.494402: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 2858
2021-06-29 01:51:26.489976: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 2858
2021-06-29 01:51:36.705595: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 2858
2021-06-29 01:51:39.842242: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5588235294117647 hasn't increased by 0 in 19 epochs
Epoch 31/65
179/179 - 319s - loss: 0.0174 - accuracy: 0.9853 - val_loss: 0.4227 - val_accuracy: 0.8990
Confusion matrix: 
 [[527  46]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92 0.08]
 [0.39 0.61]]
Validation f1: 44.64
Validation accuracy: 89.90
Validation recall: 60.98
Validation precision: 35.21
Validation AUC: 0.44674651964059003
Validation class accuracies: [0.9197207678883071, 0.6097560975609756]

The metrics for job 1 with the best target metric are: 
Best cm: [[565   8]
 [ 22  19]]
Best normalized cm: [[0.986 0.014]
 [0.537 0.463]]
Best f1: 0.56
Best accuracy: 0.95
Best recall: 0.46
Best precision: 0.70
Best AUC: 0.53
Best class accuracies: [0.9860383944153578, 0.4634146341463415]
Best epoch: 11
The number of epochs since last 1% equals the patience
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_219_2b3_Tc_mc_LittC2SE_1_label_1_pred_1.png, [[0.992]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_205_1b3_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_218_1b1_Al_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_219_2b2_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_207_2b4_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_218_1b1_Al_sc_Meditron_13_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_205_1b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_207_2b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_207_3b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[9.766e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.995]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_205_1b3_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_1p2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_1p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_212_2b2_Tc_mc_LittC2SE_1_label_0_pred_1.png, [[0.964]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_2p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_1p2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_1p2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_221_2b2_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.022]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_215_1b3_Tc_sc_Meditron_3_label_0_pred_0.png, [[3.272e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_211_2p4_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_204_7p5_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[9.973e-07]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_1p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_1p5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[3.728e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_205_3b4_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_218_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_223_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_223_1b1_Lr_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_222_1b1_Lr_sc_Meditron_6_label_0_pred_1.png, [[0.863]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_219_2b1_Tc_mc_LittC2SE_3_label_1_pred_1.png, [[0.991]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[9.325e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_207_2b2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_226_1b1_Ll_sc_Meditron_0_label_1_pred_0.png, [[0.005]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_205_2b4_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_225_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_226_1b1_Al_sc_Meditron_3_label_1_pred_0.png, [[0.259]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_213_1p3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_218_1b1_Pl_sc_Meditron_10_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_203_2p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_223_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[4.672e-05]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_218_1p1_Pl_sc_Litt3200_5_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_205_3b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2266__06_2118__v39__mixup/1/icbhi_207_2b4_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.005]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 29769
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_230725-1mt5dnbu/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_230725-1mt5dnbu/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9853
wandb:         val_accuracy 0.89902
wandb:             _runtime 10134
wandb:           _timestamp 1624931779
wandb:                _step 225
wandb:           train_loss 0.01738
wandb:             val_loss 0.42274
wandb:           val_recall 0.60976
wandb:        val_precision 0.35211
wandb:               val_f1 0.44643
wandb:              val_auc 0.44675
wandb:                   lr 6e-05
wandb:          best_val_f1 0.55882
wandb:    best_val_accuracy 0.95114
wandb:   best_val_precision 0.7037
wandb:      best_val_recall 0.46341
wandb:             best_auc 0.52537
wandb:           best_epoch 11
wandb: Run history:
wandb:   train_accuracy ▁▄▄▅▅▆▆▆▆▆▇▇▇▇▇▇▇▇█████████████
wandb:     val_accuracy ▇▇▇▇▅█▆▄▇▁█▆▇▄▆▆▆▃▅▅▄▅▆▅▅▅▄▄▄▅▅
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▄▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▂▁▂▂▃▄▂█▂▃▁▅▃▂▃▆▄▄▆▅▃▄▄▃▅▅▅▄▄
wandb:       val_recall ▁▁▂▅▅▃▃▆▄█▅▅▃▅▆▅▆▇▆▆▆▆▅▆▆▆▆▇▆▆▆
wandb:    val_precision ▁▁▇▅▄█▄▄▆▃▇▄▆▃▄▄▄▃▄▄▃▄▄▄▄▄▃▄▄▄▄
wandb:           val_f1 ▁▁▄▇▆▆▅▆▇▆█▆▅▆▇▇▇▆▇▆▆▆▆▇▇▇▆▇▆▆▇
wandb:          val_auc ▃▄▇█▂█▁▆▅▃█▆▅▆▇▇▆▆▇▅▄▆▅▇▆▆▅▆▅▆▆
wandb:               lr ██████████▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_230725-1mt5dnbu

-----------------------

 See logs at ../../new_cache/conv__2266__06_2118__v39__mixup/logs/