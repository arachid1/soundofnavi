Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2230
Description:  time_frq_masking
2021-06-21 05:23:42.934496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-21 05:23:45.175840: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-21 05:23:45.176772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-21 05:23:45.218099: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:23:45.218738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-21 05:23:45.218768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 05:23:45.222640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 05:23:45.222734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-21 05:23:45.223820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-21 05:23:45.224111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-21 05:23:45.225132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-21 05:23:45.226018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-21 05:23:45.226178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 05:23:45.226284: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:23:45.226899: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:23:45.227422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2230.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2230__06_0523__v39__time_frq_masking
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 148, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 148, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-21 05:26:30.990611: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-21 05:26:30.990989: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:26:30.991673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-21 05:26:30.991727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 05:26:30.991814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 05:26:30.991837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-21 05:26:30.991857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-21 05:26:30.991879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-21 05:26:30.991899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-21 05:26:30.991920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-21 05:26:30.991940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 05:26:30.992035: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:26:30.992659: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:26:30.993213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-21 05:26:30.993262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 05:26:31.678627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-21 05:26:31.678676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-21 05:26:31.678684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-21 05:26:31.678974: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:26:31.679710: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:26:31.680315: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 05:26:31.680860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_4
Length of training samples after spec augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_5
Length of training samples after spec augmentation: 2932
-----------------------
Number of train recordings: 2932 with pneumonia: 232 and non-pneumonia: 2700
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-21 05:26:33.003924: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-21 05:26:33.005484: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-21 05:26:33.356782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 05:26:35.171171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 05:26:35.617302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
184/184 - 260s - loss: 0.8395 - accuracy: 0.6610 - val_loss: 0.2877 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09183137973214395
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
184/184 - 257s - loss: 0.5074 - accuracy: 0.7391 - val_loss: 0.2362 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12738551470839377
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
184/184 - 257s - loss: 0.4014 - accuracy: 0.8018 - val_loss: 0.2057 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.132497124762201
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
184/184 - 257s - loss: 0.3656 - accuracy: 0.8305 - val_loss: 0.2951 - val_accuracy: 0.9438
Confusion matrix: 
 [[567   6]
 [ 28   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.875 0.125]]
Validation f1: 19.05
Validation accuracy: 94.38
Validation recall: 12.50
Validation precision: 40.00
Validation AUC: 0.1353795306855873
Validation class accuracies: [0.9895287958115183, 0.125]
Saving model...
Epoch 5/65
184/184 - 257s - loss: 0.2974 - accuracy: 0.8581 - val_loss: 0.3723 - val_accuracy: 0.8380
Confusion matrix: 
 [[485  88]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.312 0.688]]
Validation f1: 30.99
Validation accuracy: 83.80
Validation recall: 68.75
Validation precision: 20.00
Validation AUC: 0.46938124551704175
Validation class accuracies: [0.8464223385689355, 0.6875]
Saving model...
Epoch 6/65
184/184 - 256s - loss: 0.3594 - accuracy: 0.8216 - val_loss: 0.6642 - val_accuracy: 0.7570
Confusion matrix: 
 [[427 146]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.745 0.255]
 [0.031 0.969]]
Validation f1: 29.67
Validation accuracy: 75.70
Validation recall: 96.88
Validation precision: 17.51
Validation AUC: 0.4168505329460121
Validation class accuracies: [0.7452006980802792, 0.96875]
The validation tracker metric at 0.3098591549295775 hasn't increased by 0 in 1 epochs
Epoch 7/65
184/184 - 256s - loss: 0.2522 - accuracy: 0.8892 - val_loss: 0.3210 - val_accuracy: 0.8562
Confusion matrix: 
 [[498  75]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.375 0.625]]
Validation f1: 31.50
Validation accuracy: 85.62
Validation recall: 62.50
Validation precision: 21.05
Validation AUC: 0.44240839787940267
Validation class accuracies: [0.8691099476439791, 0.625]
Saving model...
Epoch 8/65
184/184 - 257s - loss: 0.2152 - accuracy: 0.8915 - val_loss: 2.5016 - val_accuracy: 0.6562
Confusion matrix: 
 [[375 198]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.654 0.346]
 [0.312 0.688]]
Validation f1: 17.46
Validation accuracy: 65.62
Validation recall: 68.75
Validation precision: 10.00
Validation AUC: 0.44343814201001147
Validation class accuracies: [0.6544502617801047, 0.6875]
The validation tracker metric at 0.31496062992125984 hasn't increased by 0 in 1 epochs
Epoch 9/65
184/184 - 257s - loss: 0.1831 - accuracy: 0.9110 - val_loss: 2.4570 - val_accuracy: 0.3686
Confusion matrix: 
 [[191 382]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.333 0.667]
 [0.    1.   ]]
Validation f1: 14.35
Validation accuracy: 36.86
Validation recall: 100.00
Validation precision: 7.73
Validation AUC: 0.5181253182028303
Validation class accuracies: [0.3333333333333333, 1.0]
The validation tracker metric at 0.31496062992125984 hasn't increased by 0 in 2 epochs
Epoch 10/65
184/184 - 257s - loss: 0.1920 - accuracy: 0.9154 - val_loss: 5.2543 - val_accuracy: 0.1620
Confusion matrix: 
 [[ 66 507]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.115 0.885]
 [0.    1.   ]]
Validation f1: 11.21
Validation accuracy: 16.20
Validation recall: 100.00
Validation precision: 5.94
Validation AUC: 0.5642128085524432
Validation class accuracies: [0.11518324607329843, 1.0]
The validation tracker metric at 0.31496062992125984 hasn't increased by 0 in 3 epochs
Epoch 11/65
184/184 - 257s - loss: 0.1559 - accuracy: 0.9342 - val_loss: 0.7823 - val_accuracy: 0.8298
Confusion matrix: 
 [[488  85]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.852 0.148]
 [0.562 0.438]]
Validation f1: 21.37
Validation accuracy: 82.98
Validation recall: 43.75
Validation precision: 14.14
Validation AUC: 0.44381739648253615
Validation class accuracies: [0.8516579406631762, 0.4375]
The validation tracker metric at 0.31496062992125984 hasn't increased by 0 in 4 epochs
Epoch 12/65
184/184 - 256s - loss: 0.1775 - accuracy: 0.9274 - val_loss: 0.7558 - val_accuracy: 0.8033
Confusion matrix: 
 [[462 111]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.25  0.75 ]]
Validation f1: 28.74
Validation accuracy: 80.33
Validation recall: 75.00
Validation precision: 17.78
Validation AUC: 0.42449244113215506
Validation class accuracies: [0.806282722513089, 0.75]
The validation tracker metric at 0.31496062992125984 hasn't increased by 0 in 5 epochs
Epoch 13/65
184/184 - 256s - loss: 0.1038 - accuracy: 0.9495 - val_loss: 0.2883 - val_accuracy: 0.9240
Confusion matrix: 
 [[540  33]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.406 0.594]]
Validation f1: 45.24
Validation accuracy: 92.40
Validation recall: 59.38
Validation precision: 36.54
Validation AUC: 0.43237600637131557
Validation class accuracies: [0.9424083769633508, 0.59375]
Saving model...
Epoch 14/65
184/184 - 257s - loss: 0.0933 - accuracy: 0.9543 - val_loss: 9.1312 - val_accuracy: 0.3736
Confusion matrix: 
 [[195 378]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.34  0.66 ]
 [0.031 0.969]]
Validation f1: 14.06
Validation accuracy: 37.36
Validation recall: 96.88
Validation precision: 7.58
Validation AUC: 0.3942214043534765
Validation class accuracies: [0.3403141361256545, 0.96875]
The validation tracker metric at 0.45238095238095233 hasn't increased by 0 in 1 epochs
Epoch 15/65
184/184 - 257s - loss: 0.1085 - accuracy: 0.9536 - val_loss: 0.5810 - val_accuracy: 0.8000
Confusion matrix: 
 [[454 119]
 [  2  30]]
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.062 0.938]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 33.15
Validation accuracy: 80.00
Validation recall: 93.75
Validation precision: 20.13
Validation AUC: 0.4260593757455352
Validation class accuracies: [0.7923211169284468, 0.9375]
The validation tracker metric at 0.45238095238095233 hasn't increased by 0 in 2 epochs
Epoch 16/65
184/184 - 257s - loss: 0.0838 - accuracy: 0.9645 - val_loss: 0.6704 - val_accuracy: 0.8876
Confusion matrix: 
 [[529  44]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.75  0.25 ]]
Validation f1: 19.05
Validation accuracy: 88.76
Validation recall: 25.00
Validation precision: 15.38
Validation AUC: 0.14749290775053592
Validation class accuracies: [0.9232111692844677, 0.25]
The validation tracker metric at 0.45238095238095233 hasn't increased by 0 in 3 epochs
Epoch 17/65
184/184 - 256s - loss: 0.0972 - accuracy: 0.9563 - val_loss: 0.2242 - val_accuracy: 0.9273
Confusion matrix: 
 [[539  34]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.312 0.688]]
Validation f1: 50.00
Validation accuracy: 92.73
Validation recall: 68.75
Validation precision: 39.29
Validation AUC: 0.6853259749985051
Validation class accuracies: [0.9406631762652705, 0.6875]
Saving model...
Epoch 18/65
184/184 - 256s - loss: 0.1198 - accuracy: 0.9550 - val_loss: 1.8780 - val_accuracy: 0.7488
Confusion matrix: 
 [[427 146]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.745 0.255]
 [0.188 0.812]]
Validation f1: 25.49
Validation accuracy: 74.88
Validation recall: 81.25
Validation precision: 15.12
Validation AUC: 0.4223888572714628
Validation class accuracies: [0.7452006980802792, 0.8125]
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
Epoch 19/65
184/184 - 257s - loss: 0.0845 - accuracy: 0.9618 - val_loss: 0.3776 - val_accuracy: 0.9041
Confusion matrix: 
 [[527  46]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.375 0.625]]
Validation f1: 40.82
Validation accuracy: 90.41
Validation recall: 62.50
Validation precision: 30.30
Validation AUC: 0.4623372620683706
Validation class accuracies: [0.9197207678883071, 0.625]
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
Epoch 20/65
184/184 - 257s - loss: 0.0881 - accuracy: 0.9659 - val_loss: 2.2710 - val_accuracy: 0.6149
Confusion matrix: 
 [[348 225]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.607 0.393]
 [0.25  0.75 ]]
Validation f1: 17.08
Validation accuracy: 61.49
Validation recall: 75.00
Validation precision: 9.64
Validation AUC: 0.4464407323690829
Validation class accuracies: [0.6073298429319371, 0.75]
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
Epoch 21/65
184/184 - 257s - loss: 0.0741 - accuracy: 0.9638 - val_loss: 0.7249 - val_accuracy: 0.8579
Confusion matrix: 
 [[490  83]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.855 0.145]
 [0.094 0.906]]
Validation f1: 40.28
Validation accuracy: 85.79
Validation recall: 90.62
Validation precision: 25.89
Validation AUC: 0.5615049449125258
Validation class accuracies: [0.8551483420593369, 0.90625]
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
Epoch 22/65
184/184 - 257s - loss: 0.0712 - accuracy: 0.9731 - val_loss: 0.2464 - val_accuracy: 0.9471
Confusion matrix: 
 [[570   3]
 [ 29   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.906 0.094]]
Validation f1: 15.79
Validation accuracy: 94.71
Validation recall: 9.38
Validation precision: 50.00
Validation AUC: 0.24526164939972306
Validation class accuracies: [0.9947643979057592, 0.09375]
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
Epoch 23/65
184/184 - 257s - loss: 0.0381 - accuracy: 0.9853 - val_loss: 0.3472 - val_accuracy: 0.9322
Confusion matrix: 
 [[544  29]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.375 0.625]]
Validation f1: 49.38
Validation accuracy: 93.22
Validation recall: 62.50
Validation precision: 40.82
Validation AUC: 0.5238156762786563
Validation class accuracies: [0.9493891797556719, 0.625]
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 24/65
184/184 - 257s - loss: 0.0173 - accuracy: 0.9932 - val_loss: 0.2871 - val_accuracy: 0.9405
Confusion matrix: 
 [[545  28]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.25  0.75 ]]
Validation f1: 57.14
Validation accuracy: 94.05
Validation recall: 75.00
Validation precision: 46.15
Validation AUC: 0.6068966980254742
Validation class accuracies: [0.9511343804537522, 0.75]
Saving model...
Epoch 25/65
184/184 - 257s - loss: 0.0293 - accuracy: 0.9881 - val_loss: 0.3029 - val_accuracy: 0.9273
Confusion matrix: 
 [[538  35]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.281 0.719]]
Validation f1: 51.11
Validation accuracy: 92.73
Validation recall: 71.88
Validation precision: 39.66
Validation AUC: 0.617871607407166
Validation class accuracies: [0.9389179755671903, 0.71875]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 1 epochs
Epoch 26/65
184/184 - 256s - loss: 0.0283 - accuracy: 0.9911 - val_loss: 0.2352 - val_accuracy: 0.9504
Confusion matrix: 
 [[551  22]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.25  0.75 ]]
Validation f1: 61.54
Validation accuracy: 95.04
Validation recall: 75.00
Validation precision: 52.17
Validation AUC: 0.608014686970924
Validation class accuracies: [0.9616055846422339, 0.75]
Saving model...
Epoch 27/65
184/184 - 257s - loss: 0.0081 - accuracy: 0.9980 - val_loss: 0.2344 - val_accuracy: 0.9455
Confusion matrix: 
 [[552  21]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.375 0.625]]
Validation f1: 54.79
Validation accuracy: 94.55
Validation recall: 62.50
Validation precision: 48.78
Validation AUC: 0.5800247845642352
Validation class accuracies: [0.9633507853403142, 0.625]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 1 epochs
Epoch 28/65
184/184 - 256s - loss: 0.0074 - accuracy: 0.9976 - val_loss: 0.2557 - val_accuracy: 0.9488
Confusion matrix: 
 [[552  21]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.312 0.688]]
Validation f1: 58.67
Validation accuracy: 94.88
Validation recall: 68.75
Validation precision: 51.16
Validation AUC: 0.6299221335969475
Validation class accuracies: [0.9633507853403142, 0.6875]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 2 epochs
Epoch 29/65
184/184 - 257s - loss: 0.0126 - accuracy: 0.9962 - val_loss: 0.3437 - val_accuracy: 0.9306
Confusion matrix: 
 [[543  30]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.375 0.625]]
Validation f1: 48.78
Validation accuracy: 93.06
Validation recall: 62.50
Validation precision: 40.00
Validation AUC: 0.5957105110907621
Validation class accuracies: [0.9476439790575916, 0.625]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 3 epochs
Epoch 30/65
184/184 - 257s - loss: 0.0091 - accuracy: 0.9966 - val_loss: 0.2275 - val_accuracy: 0.9471
Confusion matrix: 
 [[555  18]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.438 0.562]]
Validation f1: 52.94
Validation accuracy: 94.71
Validation recall: 56.25
Validation precision: 50.00
Validation AUC: 0.593783548287343
Validation class accuracies: [0.9685863874345549, 0.5625]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 4 epochs
Epoch 31/65
184/184 - 257s - loss: 0.0357 - accuracy: 0.9973 - val_loss: 0.5662 - val_accuracy: 0.9157
Confusion matrix: 
 [[531  42]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.281 0.719]]
Validation f1: 47.42
Validation accuracy: 91.57
Validation recall: 71.88
Validation precision: 35.38
Validation AUC: 0.5605861078226234
Validation class accuracies: [0.9267015706806283, 0.71875]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 5 epochs
Epoch 32/65
184/184 - 257s - loss: 0.0507 - accuracy: 0.9792 - val_loss: 0.3579 - val_accuracy: 0.9174
Confusion matrix: 
 [[533  40]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.312 0.688]]
Validation f1: 46.81
Validation accuracy: 91.74
Validation recall: 68.75
Validation precision: 35.48
Validation AUC: 0.5857787580675682
Validation class accuracies: [0.9301919720767888, 0.6875]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 33/65
184/184 - 256s - loss: 0.0316 - accuracy: 0.9867 - val_loss: 0.3475 - val_accuracy: 0.9190
Confusion matrix: 
 [[534  39]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.312 0.688]]
Validation f1: 47.31
Validation accuracy: 91.90
Validation recall: 68.75
Validation precision: 36.07
Validation AUC: 0.6245227156906661
Validation class accuracies: [0.9319371727748691, 0.6875]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 7 epochs
Epoch 34/65
184/184 - 256s - loss: 0.0133 - accuracy: 0.9949 - val_loss: 0.2821 - val_accuracy: 0.9256
Confusion matrix: 
 [[540  33]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.375 0.625]]
Validation f1: 47.06
Validation accuracy: 92.56
Validation recall: 62.50
Validation precision: 37.74
Validation AUC: 0.587184068144423
Validation class accuracies: [0.9424083769633508, 0.625]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 8 epochs
Epoch 35/65
184/184 - 256s - loss: 0.0096 - accuracy: 0.9990 - val_loss: 0.3904 - val_accuracy: 0.9107
Confusion matrix: 
 [[528  45]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.281 0.719]]
Validation f1: 46.00
Validation accuracy: 91.07
Validation recall: 71.88
Validation precision: 33.82
Validation AUC: 0.5866834536582639
Validation class accuracies: [0.9214659685863874, 0.71875]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 9 epochs
Epoch 36/65
184/184 - 256s - loss: 0.0090 - accuracy: 0.9966 - val_loss: 0.3899 - val_accuracy: 0.9140
Confusion matrix: 
 [[531  42]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.312 0.688]]
Validation f1: 45.83
Validation accuracy: 91.40
Validation recall: 68.75
Validation precision: 34.38
Validation AUC: 0.5571433332594531
Validation class accuracies: [0.9267015706806283, 0.6875]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 10 epochs
Epoch 37/65
184/184 - 256s - loss: 0.0063 - accuracy: 0.9983 - val_loss: 0.3232 - val_accuracy: 0.9240
Confusion matrix: 
 [[540  33]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.24
Validation accuracy: 92.40
Validation recall: 59.38
Validation precision: 36.54
Validation AUC: 0.5721550760392902
Validation class accuracies: [0.9424083769633508, 0.59375]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 11 epochs
Epoch 38/65
184/184 - 256s - loss: 0.0084 - accuracy: 0.9959 - val_loss: 0.2847 - val_accuracy: 0.9289
Confusion matrix: 
 [[546  27]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.5   0.5  ]]
Validation f1: 42.67
Validation accuracy: 92.89
Validation recall: 50.00
Validation precision: 37.21
Validation AUC: 0.5490371410069973
Validation class accuracies: [0.9528795811518325, 0.5]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 39/65
184/184 - 256s - loss: 0.0052 - accuracy: 0.9983 - val_loss: 0.3197 - val_accuracy: 0.9256
Confusion matrix: 
 [[543  30]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.469 0.531]]
Validation f1: 43.04
Validation accuracy: 92.56
Validation recall: 53.12
Validation precision: 36.17
Validation AUC: 0.5335835341609012
Validation class accuracies: [0.9476439790575916, 0.53125]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 13 epochs
Epoch 40/65
184/184 - 256s - loss: 0.0079 - accuracy: 0.9969 - val_loss: 0.3758 - val_accuracy: 0.9240
Confusion matrix: 
 [[537  36]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.312 0.688]]
Validation f1: 48.89
Validation accuracy: 92.40
Validation recall: 68.75
Validation precision: 37.93
Validation AUC: 0.5611714371616807
Validation class accuracies: [0.93717277486911, 0.6875]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 14 epochs
Epoch 41/65
184/184 - 257s - loss: 0.0042 - accuracy: 0.9997 - val_loss: 0.3341 - val_accuracy: 0.9289
Confusion matrix: 
 [[544  29]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.438 0.562]]
Validation f1: 45.57
Validation accuracy: 92.89
Validation recall: 56.25
Validation precision: 38.30
Validation AUC: 0.564187921837445
Validation class accuracies: [0.9493891797556719, 0.5625]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 15 epochs
Epoch 42/65
184/184 - 256s - loss: 0.0069 - accuracy: 0.9973 - val_loss: 0.3536 - val_accuracy: 0.9273
Confusion matrix: 
 [[542  31]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.406 0.594]]
Validation f1: 46.34
Validation accuracy: 92.73
Validation recall: 59.38
Validation precision: 38.00
Validation AUC: 0.5431837816334841
Validation class accuracies: [0.9458987783595113, 0.59375]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 16 epochs
Epoch 43/65
184/184 - 257s - loss: 0.0061 - accuracy: 0.9986 - val_loss: 0.3400 - val_accuracy: 0.9256
Confusion matrix: 
 [[541  32]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.78
Validation accuracy: 92.56
Validation recall: 59.38
Validation precision: 37.25
Validation AUC: 0.5468215081087662
Validation class accuracies: [0.944153577661431, 0.59375]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 17 epochs
Epoch 44/65
184/184 - 257s - loss: 0.0040 - accuracy: 0.9990 - val_loss: 0.3435 - val_accuracy: 0.9289
Confusion matrix: 
 [[543  30]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.406 0.594]]
Validation f1: 46.91
Validation accuracy: 92.89
Validation recall: 59.38
Validation precision: 38.78
Validation AUC: 0.5522838695350174
Validation class accuracies: [0.9476439790575916, 0.59375]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 45/65
184/184 - 257s - loss: 0.0051 - accuracy: 0.9983 - val_loss: 0.3256 - val_accuracy: 0.9306
Confusion matrix: 
 [[544  29]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.406 0.594]]
Validation f1: 47.50
Validation accuracy: 93.06
Validation recall: 59.38
Validation precision: 39.58
Validation AUC: 0.5487128615953358
Validation class accuracies: [0.9493891797556719, 0.59375]
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 19 epochs
Epoch 46/65
184/184 - 257s - loss: 0.0082 - accuracy: 0.9980 - val_loss: 0.4955 - val_accuracy: 0.9107
Confusion matrix: 
 [[530  43]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.344 0.656]]
Validation f1: 43.75
Validation accuracy: 91.07
Validation recall: 65.62
Validation precision: 32.81
Validation AUC: 0.5498513364978531
Validation class accuracies: [0.924956369982548, 0.65625]

The metrics for job 0 with the best target metric are: 
Best cm: [[551  22]
 [  8  24]]
Best normalized cm: [[0.962 0.038]
 [0.25  0.75 ]]
Best f1: 0.62
Best accuracy: 0.95
Best recall: 0.75
Best precision: 0.52
Best AUC: 0.61
Best class accuracies: [0.9616055846422339, 0.75]
Best epoch: 26
The number of epochs since last 1% equals the patience
-----------------------
Mixednet
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_4
Length of training samples after spec augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_5
Length of training samples after spec augmentation: 2932
-----------------------
Number of train recordings: 2932 with pneumonia: 232 and non-pneumonia: 2700
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
184/184 - 73s - loss: 0.5056 - accuracy: 0.6555 - val_loss: 0.5340 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0758200582121703
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
184/184 - 70s - loss: 0.3034 - accuracy: 0.8411 - val_loss: 0.2573 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05979016230383688
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
184/184 - 70s - loss: 0.2060 - accuracy: 0.9093 - val_loss: 0.2072 - val_accuracy: 0.9603
Confusion matrix: 
 [[570   3]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.656 0.344]]
Validation f1: 47.83
Validation accuracy: 96.03
Validation recall: 34.38
Validation precision: 78.57
Validation AUC: 0.568280869530043
Validation class accuracies: [0.9947643979057592, 0.34375]
Saving model...
Epoch 4/65
184/184 - 70s - loss: 0.1576 - accuracy: 0.9355 - val_loss: 0.8503 - val_accuracy: 0.6826
Confusion matrix: 
 [[384 189]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.67  0.33 ]
 [0.094 0.906]]
Validation f1: 23.20
Validation accuracy: 68.26
Validation recall: 90.62
Validation precision: 13.30
Validation AUC: 0.4986850489504391
Validation class accuracies: [0.6701570680628273, 0.90625]
The validation tracker metric at 0.4782608695652174 hasn't increased by 0 in 1 epochs
Epoch 5/65
184/184 - 70s - loss: 0.1106 - accuracy: 0.9628 - val_loss: 0.4398 - val_accuracy: 0.8727
Confusion matrix: 
 [[503  70]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.878 0.122]
 [0.219 0.781]]
Validation f1: 39.37
Validation accuracy: 87.27
Validation recall: 78.12
Validation precision: 26.32
Validation AUC: 0.6474902894836573
Validation class accuracies: [0.8778359511343804, 0.78125]
The validation tracker metric at 0.4782608695652174 hasn't increased by 0 in 2 epochs
Epoch 6/65
184/184 - 70s - loss: 0.0816 - accuracy: 0.9737 - val_loss: 0.1673 - val_accuracy: 0.9504
Confusion matrix: 
 [[558  15]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.469 0.531]]
Validation f1: 53.12
Validation accuracy: 95.04
Validation recall: 53.12
Validation precision: 53.12
Validation AUC: 0.5974553819073126
Validation class accuracies: [0.9738219895287958, 0.53125]
Saving model...
Epoch 7/65
184/184 - 70s - loss: 0.0358 - accuracy: 0.9918 - val_loss: 0.2472 - val_accuracy: 0.9405
Confusion matrix: 
 [[549  24]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.375 0.625]]
Validation f1: 52.63
Validation accuracy: 94.05
Validation recall: 62.50
Validation precision: 45.45
Validation AUC: 0.6083060192487509
Validation class accuracies: [0.9581151832460733, 0.625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 1 epochs
Epoch 8/65
184/184 - 71s - loss: 0.0410 - accuracy: 0.9891 - val_loss: 1.6665 - val_accuracy: 0.4248
Confusion matrix: 
 [[228 345]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.398 0.602]
 [0.094 0.906]]
Validation f1: 14.29
Validation accuracy: 42.48
Validation recall: 90.62
Validation precision: 7.75
Validation AUC: 0.5142905796636156
Validation class accuracies: [0.39790575916230364, 0.90625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 2 epochs
Epoch 9/65
184/184 - 71s - loss: 0.0640 - accuracy: 0.9789 - val_loss: 0.2301 - val_accuracy: 0.9405
Confusion matrix: 
 [[549  24]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.63
Validation accuracy: 94.05
Validation recall: 62.50
Validation precision: 45.45
Validation AUC: 0.5946923762015682
Validation class accuracies: [0.9581151832460733, 0.625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 3 epochs
Epoch 10/65
184/184 - 70s - loss: 0.0194 - accuracy: 0.9973 - val_loss: 0.3241 - val_accuracy: 0.9289
Confusion matrix: 
 [[540  33]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.312 0.688]]
Validation f1: 50.57
Validation accuracy: 92.89
Validation recall: 68.75
Validation precision: 40.00
Validation AUC: 0.5907005443603478
Validation class accuracies: [0.9424083769633508, 0.6875]
The validation tracker metric at 0.53125 hasn't increased by 0 in 4 epochs
Epoch 11/65
184/184 - 70s - loss: 0.0203 - accuracy: 0.9949 - val_loss: 0.3408 - val_accuracy: 0.9289
Confusion matrix: 
 [[542  31]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.375 0.625]]
Validation f1: 48.19
Validation accuracy: 92.89
Validation recall: 62.50
Validation precision: 39.22
Validation AUC: 0.6017269628615468
Validation class accuracies: [0.9458987783595113, 0.625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 5 epochs
Epoch 12/65
184/184 - 70s - loss: 0.0115 - accuracy: 0.9976 - val_loss: 0.2557 - val_accuracy: 0.9471
Confusion matrix: 
 [[555  18]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.94
Validation accuracy: 94.71
Validation recall: 56.25
Validation precision: 50.00
Validation AUC: 0.5594830875459648
Validation class accuracies: [0.9685863874345549, 0.5625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
184/184 - 70s - loss: 0.0077 - accuracy: 0.9997 - val_loss: 0.3337 - val_accuracy: 0.9322
Confusion matrix: 
 [[544  29]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.38
Validation accuracy: 93.22
Validation recall: 62.50
Validation precision: 40.82
Validation AUC: 0.5685386652881468
Validation class accuracies: [0.9493891797556719, 0.625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 7 epochs
Epoch 14/65
184/184 - 70s - loss: 0.0067 - accuracy: 0.9990 - val_loss: 0.2808 - val_accuracy: 0.9421
Confusion matrix: 
 [[554  19]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.5   0.5  ]]
Validation f1: 47.76
Validation accuracy: 94.21
Validation recall: 50.00
Validation precision: 45.71
Validation AUC: 0.5361786722336319
Validation class accuracies: [0.9668411867364747, 0.5]
The validation tracker metric at 0.53125 hasn't increased by 0 in 8 epochs
Epoch 15/65
184/184 - 70s - loss: 0.0060 - accuracy: 0.9997 - val_loss: 0.3305 - val_accuracy: 0.9355
Confusion matrix: 
 [[546  27]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.375 0.625]]
Validation f1: 50.63
Validation accuracy: 93.55
Validation recall: 62.50
Validation precision: 42.55
Validation AUC: 0.553399653478354
Validation class accuracies: [0.9528795811518325, 0.625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 9 epochs
Epoch 16/65
184/184 - 71s - loss: 0.0054 - accuracy: 1.0000 - val_loss: 0.2942 - val_accuracy: 0.9438
Confusion matrix: 
 [[552  21]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.406 0.594]]
Validation f1: 52.78
Validation accuracy: 94.38
Validation recall: 59.38
Validation precision: 47.50
Validation AUC: 0.5462994786120599
Validation class accuracies: [0.9633507853403142, 0.59375]
The validation tracker metric at 0.53125 hasn't increased by 0 in 10 epochs
Epoch 17/65
184/184 - 70s - loss: 0.0052 - accuracy: 0.9997 - val_loss: 0.2987 - val_accuracy: 0.9421
Confusion matrix: 
 [[552  21]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.438 0.562]]
Validation f1: 50.70
Validation accuracy: 94.21
Validation recall: 56.25
Validation precision: 46.15
Validation AUC: 0.5460804557418045
Validation class accuracies: [0.9633507853403142, 0.5625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 11 epochs
Epoch 18/65
184/184 - 70s - loss: 0.0044 - accuracy: 1.0000 - val_loss: 0.3216 - val_accuracy: 0.9388
Confusion matrix: 
 [[550  23]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.438 0.562]]
Validation f1: 49.32
Validation accuracy: 93.88
Validation recall: 56.25
Validation precision: 43.90
Validation AUC: 0.5416313601702026
Validation class accuracies: [0.9598603839441536, 0.5625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 19/65
184/184 - 70s - loss: 0.0056 - accuracy: 0.9993 - val_loss: 0.3068 - val_accuracy: 0.9438
Confusion matrix: 
 [[553  20]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.438 0.562]]
Validation f1: 51.43
Validation accuracy: 94.38
Validation recall: 56.25
Validation precision: 47.37
Validation AUC: 0.5436072784079088
Validation class accuracies: [0.9650959860383944, 0.5625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 13 epochs
Epoch 20/65
184/184 - 71s - loss: 0.0039 - accuracy: 1.0000 - val_loss: 0.3014 - val_accuracy: 0.9438
Confusion matrix: 
 [[553  20]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.43
Validation accuracy: 94.38
Validation recall: 56.25
Validation precision: 47.37
Validation AUC: 0.5484724103793808
Validation class accuracies: [0.9650959860383944, 0.5625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 14 epochs
Epoch 21/65
184/184 - 70s - loss: 0.0057 - accuracy: 1.0000 - val_loss: 0.3440 - val_accuracy: 0.9339
Confusion matrix: 
 [[545  28]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.375 0.625]]
Validation f1: 50.00
Validation accuracy: 93.39
Validation recall: 62.50
Validation precision: 41.67
Validation AUC: 0.5504899263723353
Validation class accuracies: [0.9511343804537522, 0.625]
The validation tracker metric at 0.53125 hasn't increased by 0 in 15 epochs
Epoch 22/65
184/184 - 70s - loss: 0.0082 - accuracy: 0.9983 - val_loss: 0.3255 - val_accuracy: 0.9372
Confusion matrix: 
 [[548  25]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.406 0.594]]
Validation f1: 50.00
Validation accuracy: 93.72
Validation recall: 59.38
Validation precision: 43.18
Validation AUC: 0.5379515840107156
Validation class accuracies: [0.956369982547993, 0.59375]
The validation tracker metric at 0.53125 hasn't increased by 0 in 16 epochs
Epoch 23/65
184/184 - 70s - loss: 0.0051 - accuracy: 0.9997 - val_loss: 0.3069 - val_accuracy: 0.9405
Confusion matrix: 
 [[553  20]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.5   0.5  ]]
Validation f1: 47.06
Validation accuracy: 94.05
Validation recall: 50.00
Validation precision: 44.44
Validation AUC: 0.5250168432898829
Validation class accuracies: [0.9650959860383944, 0.5]
The validation tracker metric at 0.53125 hasn't increased by 0 in 17 epochs
Epoch 24/65
184/184 - 71s - loss: 0.0039 - accuracy: 1.0000 - val_loss: 0.3291 - val_accuracy: 0.9355
Confusion matrix: 
 [[550  23]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.5  0.5 ]]
Validation f1: 45.07
Validation accuracy: 93.55
Validation recall: 50.00
Validation precision: 41.03
Validation AUC: 0.5108507723490651
Validation class accuracies: [0.9598603839441536, 0.5]
The validation tracker metric at 0.53125 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 25/65
184/184 - 71s - loss: 0.0045 - accuracy: 1.0000 - val_loss: 0.3198 - val_accuracy: 0.9372
Confusion matrix: 
 [[551  22]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.5   0.5  ]]
Validation f1: 45.71
Validation accuracy: 93.72
Validation recall: 50.00
Validation precision: 42.11
Validation AUC: 0.5186125344878028
Validation class accuracies: [0.9616055846422339, 0.5]
The validation tracker metric at 0.53125 hasn't increased by 0 in 19 epochs
Epoch 26/65
184/184 - 71s - loss: 0.0034 - accuracy: 1.0000 - val_loss: 0.3255 - val_accuracy: 0.9372
Confusion matrix: 
 [[551  22]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.71
Validation accuracy: 93.72
Validation recall: 50.00
Validation precision: 42.11
Validation AUC: 0.5350768566865355
Validation class accuracies: [0.9616055846422339, 0.5]

The metrics for job 0 with the best target metric are: 
Best cm: [[558  15]
 [ 15  17]]
Best normalized cm: [[0.974 0.026]
 [0.469 0.531]]
Best f1: 0.53
Best accuracy: 0.95
Best recall: 0.53
Best precision: 0.53
Best AUC: 0.60
Best class accuracies: [0.9738219895287958, 0.53125]
Best epoch: 6
The number of epochs since last 1% equals the patience
-----------------------
Model 10
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_4
Length of training samples after spec augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_5
Length of training samples after spec augmentation: 2932
-----------------------
Number of train recordings: 2932 with pneumonia: 232 and non-pneumonia: 2700
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 128, 1250, 1)    4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 128, 1250, 8)    16           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 128, 1250, 8)    16           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 128, 1250, 8)    584          conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 128, 1250, 8)    1608         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 128, 1250, 8)    16           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_33801 (Concatenate)     (None, 128, 1250, 24)   0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 64, 625, 24)     0            concatenate_33801[0][0]              
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 64, 625, 24)     96           average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 64, 625, 16)     400          batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 64, 625, 16)     400          batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 64, 625, 24)     0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 64, 625, 16)     2320         conv2d_15[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 64, 625, 16)     6416         conv2d_17[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 64, 625, 16)     400          max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_33802 (Concatenate)     (None, 64, 625, 48)     0            conv2d_16[0][0]                      
                                                                         conv2d_18[0][0]                      
                                                                         conv2d_19[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 32, 313, 48)     0            concatenate_33802[0][0]              
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 32, 313, 48)     192          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                  (None, 32, 313, 32)     1568         batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                  (None, 32, 313, 32)     1568         batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)      (None, 32, 313, 48)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                  (None, 32, 313, 32)     9248         conv2d_20[0][0]                      
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                  (None, 32, 313, 32)     25632        conv2d_22[0][0]                      
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                  (None, 32, 313, 32)     1568         max_pooling2d_3[0][0]                
______________________________________________________________________________________________________________
concatenate_33803 (Concatenate)     (None, 32, 313, 96)     0            conv2d_21[0][0]                      
                                                                         conv2d_23[0][0]                      
                                                                         conv2d_24[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 16, 157, 96)     0            concatenate_33803[0][0]              
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 16, 157, 96)     384          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
conv2d_25 (Conv2D)                  (None, 16, 157, 64)     6208         batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
conv2d_27 (Conv2D)                  (None, 16, 157, 64)     6208         batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)      (None, 16, 157, 96)     0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
conv2d_26 (Conv2D)                  (None, 16, 157, 64)     36928        conv2d_25[0][0]                      
______________________________________________________________________________________________________________
conv2d_28 (Conv2D)                  (None, 16, 157, 64)     102464       conv2d_27[0][0]                      
______________________________________________________________________________________________________________
conv2d_29 (Conv2D)                  (None, 16, 157, 64)     6208         max_pooling2d_4[0][0]                
______________________________________________________________________________________________________________
concatenate_33804 (Concatenate)     (None, 16, 157, 192)    0            conv2d_26[0][0]                      
                                                                         conv2d_28[0][0]                      
                                                                         conv2d_29[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 8, 79, 192)      0            concatenate_33804[0][0]              
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 8, 79, 192)      768          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
conv2d_30 (Conv2D)                  (None, 8, 79, 128)      24704        batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
conv2d_32 (Conv2D)                  (None, 8, 79, 128)      24704        batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)      (None, 8, 79, 192)      0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
conv2d_31 (Conv2D)                  (None, 8, 79, 128)      147584       conv2d_30[0][0]                      
______________________________________________________________________________________________________________
conv2d_33 (Conv2D)                  (None, 8, 79, 128)      409728       conv2d_32[0][0]                      
______________________________________________________________________________________________________________
conv2d_34 (Conv2D)                  (None, 8, 79, 128)      24704        max_pooling2d_5[0][0]                
______________________________________________________________________________________________________________
concatenate_33805 (Concatenate)     (None, 8, 79, 384)      0            conv2d_31[0][0]                      
                                                                         conv2d_33[0][0]                      
                                                                         conv2d_34[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 4, 40, 384)      0            concatenate_33805[0][0]              
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 4, 40, 384)      1536         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
conv2d_35 (Conv2D)                  (None, 4, 40, 256)      98560        batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
conv2d_37 (Conv2D)                  (None, 4, 40, 256)      98560        batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)      (None, 4, 40, 384)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
conv2d_36 (Conv2D)                  (None, 4, 40, 256)      590080       conv2d_35[0][0]                      
______________________________________________________________________________________________________________
conv2d_38 (Conv2D)                  (None, 4, 40, 256)      1638656      conv2d_37[0][0]                      
______________________________________________________________________________________________________________
conv2d_39 (Conv2D)                  (None, 4, 40, 256)      98560        max_pooling2d_6[0][0]                
______________________________________________________________________________________________________________
concatenate_33806 (Concatenate)     (None, 4, 40, 768)      0            conv2d_36[0][0]                      
                                                                         conv2d_38[0][0]                      
                                                                         conv2d_39[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePoolin (None, 2, 20, 768)      0            concatenate_33806[0][0]              
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 2, 20, 768)      3072         average_pooling2d_15[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 768)             0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               769          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 3,372,437
Trainable params: 3,369,411
Non-trainable params: 3,026
______________________________________________________________________________________________________________
Epoch 1/65
184/184 - 61s - loss: 0.5252 - accuracy: 0.7132 - val_loss: 0.4046 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0904208391444297
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
184/184 - 55s - loss: 0.3522 - accuracy: 0.8073 - val_loss: 0.3511 - val_accuracy: 0.8645
Confusion matrix: 
 [[507  66]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.5   0.5  ]]
Validation f1: 28.07
Validation accuracy: 86.45
Validation recall: 50.00
Validation precision: 19.51
Validation AUC: 0.2875982173091399
Validation class accuracies: [0.8848167539267016, 0.5]
Saving model...
Epoch 3/65
184/184 - 55s - loss: 0.2909 - accuracy: 0.8554 - val_loss: 0.4913 - val_accuracy: 0.8231
Confusion matrix: 
 [[475  98]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.281 0.719]]
Validation f1: 30.07
Validation accuracy: 82.31
Validation recall: 71.88
Validation precision: 19.01
Validation AUC: 0.49015679722751326
Validation class accuracies: [0.8289703315881326, 0.71875]
Saving model...
Epoch 4/65
184/184 - 55s - loss: 0.2007 - accuracy: 0.9069 - val_loss: 0.2503 - val_accuracy: 0.9306
Confusion matrix: 
 [[550  23]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.594 0.406]]
Validation f1: 38.24
Validation accuracy: 93.06
Validation recall: 40.62
Validation precision: 36.11
Validation AUC: 0.43965980620846434
Validation class accuracies: [0.9598603839441536, 0.40625]
Saving model...
Epoch 5/65
184/184 - 55s - loss: 0.2991 - accuracy: 0.8578 - val_loss: 0.2191 - val_accuracy: 0.9306
Confusion matrix: 
 [[551  22]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.625 0.375]]
Validation f1: 36.36
Validation accuracy: 93.06
Validation recall: 37.50
Validation precision: 35.29
Validation AUC: 0.3991824561541964
Validation class accuracies: [0.9616055846422339, 0.375]
The validation tracker metric at 0.38235294117647056 hasn't increased by 0 in 1 epochs
Epoch 6/65
184/184 - 55s - loss: 0.1614 - accuracy: 0.9212 - val_loss: 0.4000 - val_accuracy: 0.8479
Confusion matrix: 
 [[488  85]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.852 0.148]
 [0.219 0.781]]
Validation f1: 35.21
Validation accuracy: 84.79
Validation recall: 78.12
Validation precision: 22.73
Validation AUC: 0.4587454861207532
Validation class accuracies: [0.8516579406631762, 0.78125]
The validation tracker metric at 0.38235294117647056 hasn't increased by 0 in 2 epochs
Epoch 7/65
184/184 - 55s - loss: 0.1724 - accuracy: 0.9175 - val_loss: 0.2564 - val_accuracy: 0.9207
Confusion matrix: 
 [[537  36]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.375 0.625]]
Validation f1: 45.45
Validation accuracy: 92.07
Validation recall: 62.50
Validation precision: 35.71
Validation AUC: 0.5543712254891486
Validation class accuracies: [0.93717277486911, 0.625]
Saving model...
Epoch 8/65
184/184 - 55s - loss: 0.1005 - accuracy: 0.9499 - val_loss: 0.2557 - val_accuracy: 0.9355
Confusion matrix: 
 [[553  20]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.594 0.406]]
Validation f1: 40.00
Validation accuracy: 93.55
Validation recall: 40.62
Validation precision: 39.39
Validation AUC: 0.4677573039423839
Validation class accuracies: [0.9650959860383944, 0.40625]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 1 epochs
Epoch 9/65
184/184 - 55s - loss: 0.0920 - accuracy: 0.9570 - val_loss: 0.2034 - val_accuracy: 0.9339
Confusion matrix: 
 [[550  23]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.531 0.469]]
Validation f1: 42.86
Validation accuracy: 93.39
Validation recall: 46.88
Validation precision: 39.47
Validation AUC: 0.46774160610837695
Validation class accuracies: [0.9598603839441536, 0.46875]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 2 epochs
Epoch 10/65
184/184 - 55s - loss: 0.0636 - accuracy: 0.9727 - val_loss: 0.2094 - val_accuracy: 0.9438
Confusion matrix: 
 [[555  18]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.5   0.5  ]]
Validation f1: 48.48
Validation accuracy: 94.38
Validation recall: 50.00
Validation precision: 47.06
Validation AUC: 0.5278737330992451
Validation class accuracies: [0.9685863874345549, 0.5]
Saving model...
Epoch 11/65
184/184 - 55s - loss: 0.0435 - accuracy: 0.9823 - val_loss: 0.3122 - val_accuracy: 0.9256
Confusion matrix: 
 [[543  30]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.04
Validation accuracy: 92.56
Validation recall: 53.12
Validation precision: 36.17
Validation AUC: 0.5319224613291514
Validation class accuracies: [0.9476439790575916, 0.53125]
The validation tracker metric at 0.48484848484848486 hasn't increased by 0 in 1 epochs
Epoch 12/65
184/184 - 55s - loss: 0.0433 - accuracy: 0.9826 - val_loss: 0.5757 - val_accuracy: 0.8479
Confusion matrix: 
 [[486  87]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.156 0.844]]
Validation f1: 36.99
Validation accuracy: 84.79
Validation recall: 84.38
Validation precision: 23.68
Validation AUC: 0.5595687778406851
Validation class accuracies: [0.8481675392670157, 0.84375]
The validation tracker metric at 0.48484848484848486 hasn't increased by 0 in 2 epochs
Epoch 13/65
184/184 - 55s - loss: 0.0231 - accuracy: 0.9918 - val_loss: 0.2613 - val_accuracy: 0.9207
Confusion matrix: 
 [[541  32]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.5   0.5  ]]
Validation f1: 40.00
Validation accuracy: 92.07
Validation recall: 50.00
Validation precision: 33.33
Validation AUC: 0.47175553026900197
Validation class accuracies: [0.944153577661431, 0.5]
The validation tracker metric at 0.48484848484848486 hasn't increased by 0 in 3 epochs
Epoch 14/65
184/184 - 55s - loss: 0.0440 - accuracy: 0.9829 - val_loss: 0.5228 - val_accuracy: 0.8860
Confusion matrix: 
 [[515  58]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.344 0.656]]
Validation f1: 37.84
Validation accuracy: 88.60
Validation recall: 65.62
Validation precision: 26.58
Validation AUC: 0.5321358276404514
Validation class accuracies: [0.8987783595113438, 0.65625]
The validation tracker metric at 0.48484848484848486 hasn't increased by 0 in 4 epochs
Epoch 15/65
184/184 - 55s - loss: 0.0170 - accuracy: 0.9935 - val_loss: 0.5145 - val_accuracy: 0.8810
Confusion matrix: 
 [[514  59]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.406 0.594]]
Validation f1: 34.55
Validation accuracy: 88.10
Validation recall: 59.38
Validation precision: 24.36
Validation AUC: 0.5090148475239571
Validation class accuracies: [0.8970331588132635, 0.59375]
The validation tracker metric at 0.48484848484848486 hasn't increased by 0 in 5 epochs
Epoch 16/65
184/184 - 55s - loss: 0.0246 - accuracy: 0.9956 - val_loss: 0.6590 - val_accuracy: 0.8463
Confusion matrix: 
 [[485  88]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.156 0.844]]
Validation f1: 36.73
Validation accuracy: 84.63
Validation recall: 84.38
Validation precision: 23.48
Validation AUC: 0.5892255109095323
Validation class accuracies: [0.8464223385689355, 0.84375]
The validation tracker metric at 0.48484848484848486 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
184/184 - 55s - loss: 0.0572 - accuracy: 0.9799 - val_loss: 0.2829 - val_accuracy: 0.9521
Confusion matrix: 
 [[561  12]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.531 0.469]]
Validation f1: 50.85
Validation accuracy: 95.21
Validation recall: 46.88
Validation precision: 55.56
Validation AUC: 0.5091216011492261
Validation class accuracies: [0.9790575916230366, 0.46875]
Saving model...
Epoch 18/65
184/184 - 55s - loss: 0.0167 - accuracy: 0.9952 - val_loss: 0.2449 - val_accuracy: 0.9537
Confusion matrix: 
 [[562  11]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.531 0.469]]
Validation f1: 51.72
Validation accuracy: 95.37
Validation recall: 46.88
Validation precision: 57.69
Validation AUC: 0.5072979440934992
Validation class accuracies: [0.9808027923211169, 0.46875]
Saving model...
Epoch 19/65
184/184 - 55s - loss: 0.0137 - accuracy: 0.9969 - val_loss: 0.3309 - val_accuracy: 0.9438
Confusion matrix: 
 [[555  18]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.48
Validation accuracy: 94.38
Validation recall: 50.00
Validation precision: 47.06
Validation AUC: 0.48423307731105186
Validation class accuracies: [0.9685863874345549, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 1 epochs
Epoch 20/65
184/184 - 55s - loss: 0.0081 - accuracy: 0.9990 - val_loss: 0.2766 - val_accuracy: 0.9372
Confusion matrix: 
 [[551  22]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.71
Validation accuracy: 93.72
Validation recall: 50.00
Validation precision: 42.11
Validation AUC: 0.517054287717875
Validation class accuracies: [0.9616055846422339, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 2 epochs
Epoch 21/65
184/184 - 55s - loss: 0.0054 - accuracy: 0.9993 - val_loss: 0.3060 - val_accuracy: 0.9339
Confusion matrix: 
 [[549  24]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.5   0.5  ]]
Validation f1: 44.44
Validation accuracy: 93.39
Validation recall: 50.00
Validation precision: 40.00
Validation AUC: 0.5157194593519706
Validation class accuracies: [0.9581151832460733, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 3 epochs
Epoch 22/65
184/184 - 55s - loss: 0.0055 - accuracy: 0.9997 - val_loss: 0.2893 - val_accuracy: 0.9421
Confusion matrix: 
 [[554  19]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.76
Validation accuracy: 94.21
Validation recall: 50.00
Validation precision: 45.71
Validation AUC: 0.5197942799171102
Validation class accuracies: [0.9668411867364747, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 4 epochs
Epoch 23/65
184/184 - 55s - loss: 0.0049 - accuracy: 0.9997 - val_loss: 0.3537 - val_accuracy: 0.9273
Confusion matrix: 
 [[545  28]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.5   0.5  ]]
Validation f1: 42.11
Validation accuracy: 92.73
Validation recall: 50.00
Validation precision: 36.36
Validation AUC: 0.5213517632709045
Validation class accuracies: [0.9511343804537522, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 5 epochs
Epoch 24/65
184/184 - 55s - loss: 0.0039 - accuracy: 0.9997 - val_loss: 0.3241 - val_accuracy: 0.9322
Confusion matrix: 
 [[548  25]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.5   0.5  ]]
Validation f1: 43.84
Validation accuracy: 93.22
Validation recall: 50.00
Validation precision: 39.02
Validation AUC: 0.5279565078060993
Validation class accuracies: [0.956369982547993, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 25/65
184/184 - 55s - loss: 0.0059 - accuracy: 0.9990 - val_loss: 0.4053 - val_accuracy: 0.9256
Confusion matrix: 
 [[541  32]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.406 0.594]]
Validation f1: 45.78
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.56
Validation recall: 59.38
Validation precision: 37.25
Validation AUC: 0.5637804944433076
Validation class accuracies: [0.944153577661431, 0.59375]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 7 epochs
Epoch 26/65
184/184 - 55s - loss: 0.0044 - accuracy: 0.9997 - val_loss: 0.3491 - val_accuracy: 0.9306
Confusion matrix: 
 [[547  26]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.5   0.5  ]]
Validation f1: 43.24
Validation accuracy: 93.06
Validation recall: 50.00
Validation precision: 38.10
Validation AUC: 0.5254739063970946
Validation class accuracies: [0.9546247818499127, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 8 epochs
Epoch 27/65
184/184 - 55s - loss: 0.0037 - accuracy: 1.0000 - val_loss: 0.3154 - val_accuracy: 0.9355
Confusion matrix: 
 [[550  23]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.5  0.5 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.07
Validation accuracy: 93.55
Validation recall: 50.00
Validation precision: 41.03
Validation AUC: 0.5179683883334466
Validation class accuracies: [0.9598603839441536, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 9 epochs
Epoch 28/65
184/184 - 55s - loss: 0.0035 - accuracy: 1.0000 - val_loss: 0.3081 - val_accuracy: 0.9405
Confusion matrix: 
 [[553  20]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.06
Validation accuracy: 94.05
Validation recall: 50.00
Validation precision: 44.44
Validation AUC: 0.5203116228012867
Validation class accuracies: [0.9650959860383944, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 10 epochs
Epoch 29/65
184/184 - 55s - loss: 0.0117 - accuracy: 0.9966 - val_loss: 0.3131 - val_accuracy: 0.9388
Confusion matrix: 
 [[552  21]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.5   0.5  ]]
Validation f1: 46.38
Validation accuracy: 93.88
Validation recall: 50.00
Validation precision: 43.24
Validation AUC: 0.5533364106539638
Validation class accuracies: [0.9633507853403142, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 11 epochs
Epoch 30/65
184/184 - 55s - loss: 0.0036 - accuracy: 0.9993 - val_loss: 0.3112 - val_accuracy: 0.9388
Confusion matrix: 
 [[552  21]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 46.38
Validation accuracy: 93.88
Validation recall: 50.00
Validation precision: 43.24
Validation AUC: 0.5392347612332166
Validation class accuracies: [0.9633507853403142, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 31/65
184/184 - 55s - loss: 0.0041 - accuracy: 1.0000 - val_loss: 0.3071 - val_accuracy: 0.9388
Confusion matrix: 
 [[552  21]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 46.38
Validation accuracy: 93.88
Validation recall: 50.00
Validation precision: 43.24
Validation AUC: 0.5285303715457428
Validation class accuracies: [0.9633507853403142, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 13 epochs
Epoch 32/65
184/184 - 55s - loss: 0.0033 - accuracy: 1.0000 - val_loss: 0.3119 - val_accuracy: 0.9355
Confusion matrix: 
 [[550  23]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.5  0.5 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.07
Validation accuracy: 93.55
Validation recall: 50.00
Validation precision: 41.03
Validation AUC: 0.5461743801267972
Validation class accuracies: [0.9598603839441536, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 14 epochs
Epoch 33/65
184/184 - 55s - loss: 0.0032 - accuracy: 0.9997 - val_loss: 0.3308 - val_accuracy: 0.9322
Confusion matrix: 
 [[548  25]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.84
Validation accuracy: 93.22
Validation recall: 50.00
Validation precision: 39.02
Validation AUC: 0.5342712397222931
Validation class accuracies: [0.956369982547993, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 15 epochs
Epoch 34/65
184/184 - 55s - loss: 0.0036 - accuracy: 0.9997 - val_loss: 0.3226 - val_accuracy: 0.9372
Confusion matrix: 
 [[551  22]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.71
Validation accuracy: 93.72
Validation recall: 50.00
Validation precision: 42.11
Validation AUC: 0.5351886567763242
Validation class accuracies: [0.9616055846422339, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 16 epochs
Epoch 35/65
184/184 - 55s - loss: 0.0035 - accuracy: 0.9993 - val_loss: 0.3400 - val_accuracy: 0.9355
Confusion matrix: 
 [[550  23]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.5  0.5 ]]
Validation f1: 45.07
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.55
Validation recall: 50.00
Validation precision: 41.03
Validation AUC: 0.5447943619668776
Validation class accuracies: [0.9598603839441536, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 17 epochs
Epoch 36/65
184/184 - 55s - loss: 0.0035 - accuracy: 0.9997 - val_loss: 0.3044 - val_accuracy: 0.9405
Confusion matrix: 
 [[553  20]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.06
Validation accuracy: 94.05
Validation recall: 50.00
Validation precision: 44.44
Validation AUC: 0.5399408166516386
Validation class accuracies: [0.9650959860383944, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 37/65
184/184 - 55s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.3204 - val_accuracy: 0.9355
Confusion matrix: 
 [[550  23]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.5  0.5 ]]
Validation f1: 45.07
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.55
Validation recall: 50.00
Validation precision: 41.03
Validation AUC: 0.5449591153008709
Validation class accuracies: [0.9598603839441536, 0.5]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 19 epochs
Epoch 38/65
184/184 - 55s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.3273 - val_accuracy: 0.9355
Confusion matrix: 
 [[550  23]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.5  0.5 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.07
Validation accuracy: 93.55
Validation recall: 50.00
Validation precision: 41.03
Validation AUC: 0.5426678487895037
Validation class accuracies: [0.9598603839441536, 0.5]

The metrics for job 0 with the best target metric are: 
Best cm: [[562  11]
 [ 17  15]]
Best normalized cm: [[0.981 0.019]
 [0.531 0.469]]
Best f1: 0.52
Best accuracy: 0.95
Best recall: 0.47
Best precision: 0.58
Best AUC: 0.51
Best class accuracies: [0.9808027923211169, 0.46875]
Best epoch: 18
The number of epochs since last 1% equals the patience
-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_4
Length of training samples after spec augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_5
Length of training samples after spec augmentation: 2932
-----------------------
Number of train recordings: 2932 with pneumonia: 232 and non-pneumonia: 2700
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormal (None, 128, 1250, 1)    4            input_4[0][0]                        
______________________________________________________________________________________________________________
conv2d_40 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_42 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_41 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_40[0][0]                      
______________________________________________________________________________________________________________
conv2d_43 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_42[0][0]                      
______________________________________________________________________________________________________________
conv2d_44 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_7[0][0]                
______________________________________________________________________________________________________________
concatenate_33807 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_41[0][0]                      
                                                                         conv2d_43[0][0]                      
                                                                         conv2d_44[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePoolin (None, 64, 625, 48)     0            concatenate_33807[0][0]              
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_16[0][0]           
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 64, 625, 48)     0            batch_normalization_19[0][0]         
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 64, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_17[0][0]           
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_20[0][0]         
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 32, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_18[0][0]           
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_21[0][0]         
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 16, 156, 128)    91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_19[0][0]           
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 8, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_20 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_20[0][0]           
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 4, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 1)               513          global_average_pooling2d_3[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
184/184 - 256s - loss: 0.9564 - accuracy: 0.5992 - val_loss: 0.5660 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06629479161394457
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
184/184 - 256s - loss: 0.5133 - accuracy: 0.7217 - val_loss: 0.3710 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12069591030330515
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
184/184 - 256s - loss: 0.4155 - accuracy: 0.7790 - val_loss: 0.1721 - val_accuracy: 0.9537
Confusion matrix: 
 [[573   0]
 [ 28   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.875 0.125]]
Validation f1: 22.22
Validation accuracy: 95.37
Validation recall: 12.50
Validation precision: 100.00
Validation AUC: 0.4263864773219842
Validation class accuracies: [1.0, 0.125]
Saving model...
Epoch 4/65
184/184 - 256s - loss: 0.3509 - accuracy: 0.8158 - val_loss: 0.2542 - val_accuracy: 0.9008
Confusion matrix: 
 [[525  48]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.375 0.625]]
Validation f1: 40.00
Validation accuracy: 90.08
Validation recall: 62.50
Validation precision: 29.41
Validation AUC: 0.45005976267654463
Validation class accuracies: [0.9162303664921466, 0.625]
Saving model...
Epoch 5/65
184/184 - 256s - loss: 0.3462 - accuracy: 0.8271 - val_loss: 0.4022 - val_accuracy: 0.8397
Confusion matrix: 
 [[494  79]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.562 0.438]]
Validation f1: 22.40
Validation accuracy: 83.97
Validation recall: 43.75
Validation precision: 15.05
Validation AUC: 0.4087341095067176
Validation class accuracies: [0.8621291448516579, 0.4375]
The validation tracker metric at 0.4 hasn't increased by 0 in 1 epochs
Epoch 6/65
184/184 - 256s - loss: 0.3510 - accuracy: 0.8404 - val_loss: 0.4554 - val_accuracy: 0.9140
Confusion matrix: 
 [[549  24]
 [ 28   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.875 0.125]]
Validation f1: 13.33
Validation accuracy: 91.40
Validation recall: 12.50
Validation precision: 14.29
Validation AUC: 0.17527979451619025
Validation class accuracies: [0.9581151832460733, 0.125]
The validation tracker metric at 0.4 hasn't increased by 0 in 2 epochs
Epoch 7/65
184/184 - 256s - loss: 0.3096 - accuracy: 0.8516 - val_loss: 0.6941 - val_accuracy: 0.7669
Confusion matrix: 
 [[434 139]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.757 0.243]
 [0.062 0.938]]
Validation f1: 29.85
Validation accuracy: 76.69
Validation recall: 93.75
Validation precision: 17.75
Validation AUC: 0.5781806038406456
Validation class accuracies: [0.7574171029668412, 0.9375]
The validation tracker metric at 0.4 hasn't increased by 0 in 3 epochs
Epoch 8/65
184/184 - 256s - loss: 0.2565 - accuracy: 0.8752 - val_loss: 0.9245 - val_accuracy: 0.8215
Confusion matrix: 
 [[469 104]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.125 0.875]]
Validation f1: 34.15
Validation accuracy: 82.15
Validation recall: 87.50
Validation precision: 21.21
Validation AUC: 0.3324193392255168
Validation class accuracies: [0.8184991273996509, 0.875]
The validation tracker metric at 0.4 hasn't increased by 0 in 4 epochs
Epoch 9/65
184/184 - 256s - loss: 0.2192 - accuracy: 0.8922 - val_loss: 0.2856 - val_accuracy: 0.8744
Confusion matrix: 
 [[506  67]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.281 0.719]]
Validation f1: 37.70
Validation accuracy: 87.44
Validation recall: 71.88
Validation precision: 25.56
Validation AUC: 0.49432222208544696
Validation class accuracies: [0.8830715532286213, 0.71875]
The validation tracker metric at 0.4 hasn't increased by 0 in 5 epochs
Epoch 10/65
184/184 - 256s - loss: 0.2116 - accuracy: 0.9079 - val_loss: 3.8669 - val_accuracy: 0.2793
Confusion matrix: 
 [[137 436]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.239 0.761]
 [0.    1.   ]]
Validation f1: 12.80
Validation accuracy: 27.93
Validation recall: 100.00
Validation precision: 6.84
Validation AUC: 0.10118824974828397
Validation class accuracies: [0.23909249563699825, 1.0]
The validation tracker metric at 0.4 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
184/184 - 256s - loss: 0.1877 - accuracy: 0.9055 - val_loss: 0.2835 - val_accuracy: 0.8942
Confusion matrix: 
 [[525  48]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.5   0.5  ]]
Validation f1: 33.33
Validation accuracy: 89.42
Validation recall: 50.00
Validation precision: 25.00
Validation AUC: 0.37845788948007875
Validation class accuracies: [0.9162303664921466, 0.5]
The validation tracker metric at 0.4 hasn't increased by 0 in 7 epochs
Epoch 12/65
184/184 - 256s - loss: 0.1518 - accuracy: 0.9386 - val_loss: 0.6053 - val_accuracy: 0.8529
Confusion matrix: 
 [[491  82]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.857 0.143]
 [0.219 0.781]]
Validation f1: 35.97
Validation accuracy: 85.29
Validation recall: 78.12
Validation precision: 23.36
Validation AUC: 0.35352288259237247
Validation class accuracies: [0.8568935427574171, 0.78125]
The validation tracker metric at 0.4 hasn't increased by 0 in 8 epochs
Epoch 13/65
184/184 - 256s - loss: 0.1151 - accuracy: 0.9465 - val_loss: 0.2922 - val_accuracy: 0.9339
Confusion matrix: 
 [[554  19]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.656 0.344]]
Validation f1: 35.48
Validation accuracy: 93.39
Validation recall: 34.38
Validation precision: 36.67
Validation AUC: 0.324305323726142
Validation class accuracies: [0.9668411867364747, 0.34375]
The validation tracker metric at 0.4 hasn't increased by 0 in 9 epochs
Epoch 14/65
184/184 - 256s - loss: 0.1259 - accuracy: 0.9478 - val_loss: 0.2317 - val_accuracy: 0.9388
Confusion matrix: 
 [[557  16]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.656 0.344]]
Validation f1: 37.29
Validation accuracy: 93.88
Validation recall: 34.38
Validation precision: 40.74
Validation AUC: 0.34526461510220324
Validation class accuracies: [0.9720767888307156, 0.34375]
The validation tracker metric at 0.4 hasn't increased by 0 in 10 epochs
Epoch 15/65
184/184 - 256s - loss: 0.0694 - accuracy: 0.9707 - val_loss: 0.4087 - val_accuracy: 0.8760
Confusion matrix: 
 [[499  74]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.031 0.969]]
Validation f1: 45.26
Validation accuracy: 87.60
Validation recall: 96.88
Validation precision: 29.52
Validation AUC: 0.5662123082527
Validation class accuracies: [0.8708551483420593, 0.96875]
Saving model...
Epoch 16/65
184/184 - 256s - loss: 0.0734 - accuracy: 0.9717 - val_loss: 0.2682 - val_accuracy: 0.9074
Confusion matrix: 
 [[528  45]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.344 0.656]]
Validation f1: 42.86
Validation accuracy: 90.74
Validation recall: 65.62
Validation precision: 31.82
Validation AUC: 0.5447514234941861
Validation class accuracies: [0.9214659685863874, 0.65625]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 1 epochs
Epoch 17/65
184/184 - 256s - loss: 0.1162 - accuracy: 0.9475 - val_loss: 0.7957 - val_accuracy: 0.8248
Confusion matrix: 
 [[468 105]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.031 0.969]]
Validation f1: 36.90
Validation accuracy: 82.48
Validation recall: 96.88
Validation precision: 22.79
Validation AUC: 0.4445846858972414
Validation class accuracies: [0.8167539267015707, 0.96875]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 2 epochs
Epoch 18/65
184/184 - 256s - loss: 0.0704 - accuracy: 0.9720 - val_loss: 0.2545 - val_accuracy: 0.9455
Confusion matrix: 
 [[559  14]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.594 0.406]]
Validation f1: 44.07
Validation accuracy: 94.55
Validation recall: 40.62
Validation precision: 48.15
Validation AUC: 0.47770901151994716
Validation class accuracies: [0.9755671902268761, 0.40625]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 3 epochs
Epoch 19/65
184/184 - 256s - loss: 0.0934 - accuracy: 0.9604 - val_loss: 0.2357 - val_accuracy: 0.9438
Confusion matrix: 
 [[571   2]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 94.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21341890412554929
Validation class accuracies: [0.9965095986038395, 0.0]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 4 epochs
Epoch 20/65
184/184 - 256s - loss: 0.0612 - accuracy: 0.9724 - val_loss: 0.5947 - val_accuracy: 0.8694
Confusion matrix: 
 [[497  76]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.867 0.133]
 [0.094 0.906]]
Validation f1: 42.34
Validation accuracy: 86.94
Validation recall: 90.62
Validation precision: 27.62
Validation AUC: 0.463239807105232
Validation class accuracies: [0.8673647469458988, 0.90625]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 5 epochs
Epoch 21/65
184/184 - 256s - loss: 0.0582 - accuracy: 0.9765 - val_loss: 0.3166 - val_accuracy: 0.9091
Confusion matrix: 
 [[528  45]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.312 0.688]]
Validation f1: 44.44
Validation accuracy: 90.91
Validation recall: 68.75
Validation precision: 32.84
Validation AUC: 0.48184766312924243
Validation class accuracies: [0.9214659685863874, 0.6875]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
184/184 - 256s - loss: 0.0374 - accuracy: 0.9857 - val_loss: 0.3185 - val_accuracy: 0.9041
Confusion matrix: 
 [[528  45]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.406 0.594]]
Validation f1: 39.58
Validation accuracy: 90.41
Validation recall: 59.38
Validation precision: 29.69
Validation AUC: 0.4242902748938596
Validation class accuracies: [0.9214659685863874, 0.59375]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 7 epochs
Epoch 23/65
184/184 - 256s - loss: 0.0353 - accuracy: 0.9857 - val_loss: 0.2672 - val_accuracy: 0.9124
Confusion matrix: 
 [[536  37]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.5   0.5  ]]
Validation f1: 37.65
Validation accuracy: 91.24
Validation recall: 50.00
Validation precision: 30.19
Validation AUC: 0.41107857319158253
Validation class accuracies: [0.9354275741710296, 0.5]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 8 epochs
Epoch 24/65
184/184 - 256s - loss: 0.0413 - accuracy: 0.9853 - val_loss: 0.2476 - val_accuracy: 0.9207
Confusion matrix: 
 [[541  32]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.00
Validation accuracy: 92.07
Validation recall: 50.00
Validation precision: 33.33
Validation AUC: 0.40199655234761916
Validation class accuracies: [0.944153577661431, 0.5]
The validation tracker metric at 0.4525547445255474 hasn't increased by 0 in 9 epochs
Epoch 25/65
184/184 - 256s - loss: 0.0210 - accuracy: 0.9928 - val_loss: 0.2668 - val_accuracy: 0.9322
Confusion matrix: 
 [[547  26]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.469 0.531]]
Validation f1: 45.33
Validation accuracy: 93.22
Validation recall: 53.12
Validation precision: 39.53
Validation AUC: 0.43507747590024903
Validation class accuracies: [0.9546247818499127, 0.53125]
Saving model...
Epoch 26/65
184/184 - 256s - loss: 0.0233 - accuracy: 0.9901 - val_loss: 0.3732 - val_accuracy: 0.9074
Confusion matrix: 
 [[531  42]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.438 0.562]]
Validation f1: 39.13
Validation accuracy: 90.74
Validation recall: 56.25
Validation precision: 30.00
Validation AUC: 0.42360041622289724
Validation class accuracies: [0.9267015706806283, 0.5625]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 1 epochs
Epoch 27/65
184/184 - 256s - loss: 0.0201 - accuracy: 0.9922 - val_loss: 0.2619 - val_accuracy: 0.9405
Confusion matrix: 
 [[555  18]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.562 0.438]]
Validation f1: 43.75
Validation accuracy: 94.05
Validation recall: 43.75
Validation precision: 43.75
Validation AUC: 0.39636708580480545
Validation class accuracies: [0.9685863874345549, 0.4375]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 2 epochs
Epoch 28/65
184/184 - 256s - loss: 0.0207 - accuracy: 0.9942 - val_loss: 0.4954 - val_accuracy: 0.8893
Confusion matrix: 
 [[523  50]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.531 0.469]]
Validation f1: 30.93
Validation accuracy: 88.93
Validation recall: 46.88
Validation precision: 23.08
Validation AUC: 0.39049221059495653
Validation class accuracies: [0.912739965095986, 0.46875]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 3 epochs
Epoch 29/65
184/184 - 256s - loss: 0.0140 - accuracy: 0.9956 - val_loss: 0.2978 - val_accuracy: 0.9306
Confusion matrix: 
 [[551  22]
 [ 20  12]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.625 0.375]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.36
Validation accuracy: 93.06
Validation recall: 37.50
Validation precision: 35.29
Validation AUC: 0.33647096006099
Validation class accuracies: [0.9616055846422339, 0.375]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 4 epochs
Epoch 30/65
184/184 - 256s - loss: 0.0119 - accuracy: 0.9962 - val_loss: 0.3353 - val_accuracy: 0.9256
Confusion matrix: 
 [[544  29]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.5   0.5  ]]
Validation f1: 41.56
Validation accuracy: 92.56
Validation recall: 50.00
Validation precision: 35.56
Validation AUC: 0.343220596063216
Validation class accuracies: [0.9493891797556719, 0.5]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 5 epochs
Epoch 31/65
184/184 - 256s - loss: 0.0066 - accuracy: 0.9993 - val_loss: 0.3518 - val_accuracy: 0.9240
Confusion matrix: 
 [[542  31]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.469 0.531]]
Validation f1: 42.50
Validation accuracy: 92.40
Validation recall: 53.12
Validation precision: 35.42
Validation AUC: 0.3812824389398143
Validation class accuracies: [0.9458987783595113, 0.53125]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 32/65
184/184 - 256s - loss: 0.0198 - accuracy: 0.9928 - val_loss: 0.4386 - val_accuracy: 0.9008
Confusion matrix: 
 [[526  47]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.406 0.594]]
Validation f1: 38.78
Validation accuracy: 90.08
Validation recall: 59.38
Validation precision: 28.79
Validation AUC: 0.38886450861944877
Validation class accuracies: [0.9179755671902269, 0.59375]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 7 epochs
Epoch 33/65
184/184 - 256s - loss: 0.0184 - accuracy: 0.9925 - val_loss: 0.3359 - val_accuracy: 0.9190
Confusion matrix: 
 [[541  32]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.531 0.469]]
Validation f1: 37.97
Validation accuracy: 91.90
Validation recall: 46.88
Validation precision: 31.91
Validation AUC: 0.4153077544473431
Validation class accuracies: [0.944153577661431, 0.46875]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 8 epochs
Epoch 34/65
184/184 - 256s - loss: 0.0082 - accuracy: 0.9969 - val_loss: 0.3794 - val_accuracy: 0.9174
Confusion matrix: 
 [[540  33]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.531 0.469]]
Validation f1: 37.50
Validation accuracy: 91.74
Validation recall: 46.88
Validation precision: 31.25
Validation AUC: 0.3881341598167857
Validation class accuracies: [0.9424083769633508, 0.46875]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 9 epochs
Epoch 35/65
184/184 - 256s - loss: 0.0078 - accuracy: 0.9980 - val_loss: 0.3626 - val_accuracy: 0.9223
Confusion matrix: 
 [[544  29]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.562 0.438]]
Validation f1: 37.33
Validation accuracy: 92.23
Validation recall: 43.75
Validation precision: 32.56
Validation AUC: 0.3993498957352976
Validation class accuracies: [0.9493891797556719, 0.4375]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 10 epochs
Epoch 36/65
184/184 - 256s - loss: 0.0099 - accuracy: 0.9980 - val_loss: 0.5690 - val_accuracy: 0.8760
Confusion matrix: 
 [[511  62]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.406 0.594]]
Validation f1: 33.63
Validation accuracy: 87.60
Validation recall: 59.38
Validation precision: 23.46
Validation AUC: 0.3453975456914951
Validation class accuracies: [0.8917975567190227, 0.59375]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 11 epochs
Epoch 37/65
184/184 - 256s - loss: 0.0091 - accuracy: 0.9969 - val_loss: 0.3948 - val_accuracy: 0.9240
Confusion matrix: 
 [[544  29]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.531 0.469]]
Validation f1: 39.47
Validation accuracy: 92.40
Validation recall: 46.88
Validation precision: 34.09
Validation AUC: 0.4099046224559012
Validation class accuracies: [0.9493891797556719, 0.46875]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 38/65
184/184 - 256s - loss: 0.0074 - accuracy: 0.9986 - val_loss: 0.4049 - val_accuracy: 0.9140
Confusion matrix: 
 [[534  39]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.406 0.594]]
Validation f1: 42.22
Validation accuracy: 91.40
Validation recall: 59.38
Validation precision: 32.76
Validation AUC: 0.4305939131341422
Validation class accuracies: [0.9319371727748691, 0.59375]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 13 epochs
Epoch 39/65
184/184 - 256s - loss: 0.0090 - accuracy: 0.9962 - val_loss: 0.3718 - val_accuracy: 0.9240
Confusion matrix: 
 [[542  31]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.50
Validation accuracy: 92.40
Validation recall: 53.12
Validation precision: 35.42
Validation AUC: 0.43833337463934696
Validation class accuracies: [0.9458987783595113, 0.53125]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 14 epochs
Epoch 40/65
184/184 - 256s - loss: 0.0094 - accuracy: 0.9962 - val_loss: 0.3943 - val_accuracy: 0.9240
Confusion matrix: 
 [[544  29]
 [ 17  15]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.531 0.469]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.47
Validation accuracy: 92.40
Validation recall: 46.88
Validation precision: 34.09
Validation AUC: 0.40751124960310964
Validation class accuracies: [0.9493891797556719, 0.46875]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 15 epochs
Epoch 41/65
184/184 - 256s - loss: 0.0043 - accuracy: 0.9990 - val_loss: 0.3829 - val_accuracy: 0.9207
Confusion matrix: 
 [[542  31]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.531 0.469]]
Validation f1: 38.46
Validation accuracy: 92.07
Validation recall: 46.88
Validation precision: 32.61
Validation AUC: 0.4152033987915573
Validation class accuracies: [0.9458987783595113, 0.46875]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 16 epochs
Epoch 42/65
184/184 - 256s - loss: 0.0061 - accuracy: 0.9986 - val_loss: 0.3717 - val_accuracy: 0.9223
Confusion matrix: 
 [[543  30]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.531 0.469]]
Validation f1: 38.96
Validation accuracy: 92.23
Validation recall: 46.88
Validation precision: 33.33
Validation AUC: 0.40707596326283113
Validation class accuracies: [0.9476439790575916, 0.46875]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 17 epochs
Epoch 43/65
184/184 - 256s - loss: 0.0053 - accuracy: 0.9993 - val_loss: 0.3948 - val_accuracy: 0.9157
Confusion matrix: 
 [[539  34]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.531 0.469]]
Validation f1: 37.04
Validation accuracy: 91.57
Validation recall: 46.88
Validation precision: 30.61
Validation AUC: 0.38760130833502027
Validation class accuracies: [0.9406631762652705, 0.46875]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 44/65
184/184 - 256s - loss: 0.0102 - accuracy: 0.9986 - val_loss: 0.4033 - val_accuracy: 0.9174
Confusion matrix: 
 [[539  34]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.5   0.5  ]]
Validation f1: 39.02
Validation accuracy: 91.74
Validation recall: 50.00
Validation precision: 32.00
Validation AUC: 0.4024578696269741
Validation class accuracies: [0.9406631762652705, 0.5]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 19 epochs
Epoch 45/65
184/184 - 256s - loss: 0.0039 - accuracy: 0.9993 - val_loss: 0.3866 - val_accuracy: 0.9190
Confusion matrix: 
 [[540  33]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.5   0.5  ]]
Validation f1: 39.51
Validation accuracy: 91.90
Validation recall: 50.00
Validation precision: 32.65
Validation AUC: 0.4025588987381125
Validation class accuracies: [0.9424083769633508, 0.5]

The metrics for job 0 with the best target metric are: 
Best cm: [[547  26]
 [ 15  17]]
Best normalized cm: [[0.955 0.045]
 [0.469 0.531]]
Best f1: 0.45
Best accuracy: 0.93
Best recall: 0.53
Best precision: 0.40
Best AUC: 0.44
Best class accuracies: [0.9546247818499127, 0.53125]
Best epoch: 25
The number of epochs since last 1% equals the patience
-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_4
Length of training samples after spec augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_5
Length of training samples after spec augmentation: 2932
-----------------------
Number of train recordings: 2932 with pneumonia: 232 and non-pneumonia: 2700
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_5 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_24 (BatchNormal (None, 128, 1250, 1)    4            input_5[0][0]                        
______________________________________________________________________________________________________________
conv2d_45 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_47 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_46 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_45[0][0]                      
______________________________________________________________________________________________________________
conv2d_48 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_47[0][0]                      
______________________________________________________________________________________________________________
conv2d_49 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_8[0][0]                
______________________________________________________________________________________________________________
concatenate_33808 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_46[0][0]                      
                                                                         conv2d_48[0][0]                      
                                                                         conv2d_49[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_21 (AveragePoolin (None, 64, 625, 48)     0            concatenate_33808[0][0]              
______________________________________________________________________________________________________________
batch_normalization_25 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_21[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_25[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 64, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_22 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_26 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_22[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_26[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 32, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_23 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_27 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_23[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_27[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 16, 156, 128)    91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_24 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_28 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_24[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_28[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 8, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_25 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_29 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_25[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_29[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 4, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_4 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 1)               513          global_average_pooling2d_4[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
184/184 - 255s - loss: 0.9687 - accuracy: 0.6610 - val_loss: 0.4734 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05525848912935162
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
184/184 - 255s - loss: 0.4967 - accuracy: 0.7534 - val_loss: 0.3229 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09054572066492826
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
184/184 - 255s - loss: 0.4342 - accuracy: 0.7756 - val_loss: 0.1899 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3331560088704755
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
184/184 - 255s - loss: 0.3939 - accuracy: 0.7988 - val_loss: 0.3800 - val_accuracy: 0.8760
Confusion matrix: 
 [[510  63]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.375 0.625]]
Validation f1: 34.78
Validation accuracy: 87.60
Validation recall: 62.50
Validation precision: 24.10
Validation AUC: 0.5877602439816393
Validation class accuracies: [0.8900523560209425, 0.625]
Saving model...
Epoch 5/65
184/184 - 255s - loss: 0.3937 - accuracy: 0.8100 - val_loss: 0.3564 - val_accuracy: 0.9091
Confusion matrix: 
 [[539  34]
 [ 21  11]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.656 0.344]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.57
Validation accuracy: 90.91
Validation recall: 34.38
Validation precision: 24.44
Validation AUC: 0.3692058210034579
Validation class accuracies: [0.9406631762652705, 0.34375]
The validation tracker metric at 0.34782608695652173 hasn't increased by 0 in 1 epochs
Epoch 6/65
184/184 - 255s - loss: 0.2698 - accuracy: 0.8619 - val_loss: 0.3408 - val_accuracy: 0.8231
Confusion matrix: 
 [[471 102]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.156 0.844]]
Validation f1: 33.54
Validation accuracy: 82.31
Validation recall: 84.38
Validation precision: 20.93
Validation AUC: 0.6146956545195037
Validation class accuracies: [0.8219895287958116, 0.84375]
The validation tracker metric at 0.34782608695652173 hasn't increased by 0 in 2 epochs
Epoch 7/65
184/184 - 255s - loss: 0.2723 - accuracy: 0.8748 - val_loss: 0.8047 - val_accuracy: 0.7537
Confusion matrix: 
 [[428 145]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.747 0.253]
 [0.125 0.875]]
Validation f1: 27.32
Validation accuracy: 75.37
Validation recall: 87.50
Validation precision: 16.18
Validation AUC: 0.6028463632048774
Validation class accuracies: [0.7469458987783595, 0.875]
The validation tracker metric at 0.34782608695652173 hasn't increased by 0 in 3 epochs
Epoch 8/65
184/184 - 255s - loss: 0.2226 - accuracy: 0.8943 - val_loss: 2.9257 - val_accuracy: 0.4479
Confusion matrix: 
 [[239 334]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.417 0.583]
 [0.    1.   ]]
Validation f1: 16.08
Validation accuracy: 44.79
Validation recall: 100.00
Validation precision: 8.74
Validation AUC: 0.540558375475322
Validation class accuracies: [0.41710296684118675, 1.0]
The validation tracker metric at 0.34782608695652173 hasn't increased by 0 in 4 epochs
Epoch 9/65
184/184 - 255s - loss: 0.2078 - accuracy: 0.9055 - val_loss: 0.2607 - val_accuracy: 0.9504
Confusion matrix: 
 [[568   5]
 [ 25   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.781 0.219]]
Validation f1: 31.82
Validation accuracy: 95.04
Validation recall: 21.88
Validation precision: 58.33
Validation AUC: 0.4273416161905147
Validation class accuracies: [0.9912739965095986, 0.21875]
The validation tracker metric at 0.34782608695652173 hasn't increased by 0 in 5 epochs
Epoch 10/65
184/184 - 255s - loss: 0.1660 - accuracy: 0.9202 - val_loss: 1.3277 - val_accuracy: 0.6298
Confusion matrix: 
 [[351 222]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.613 0.387]
 [0.062 0.938]]
Validation f1: 21.13
Validation accuracy: 62.98
Validation recall: 93.75
Validation precision: 11.90
Validation AUC: 0.630226842672125
Validation class accuracies: [0.612565445026178, 0.9375]
The validation tracker metric at 0.34782608695652173 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
184/184 - 255s - loss: 0.1290 - accuracy: 0.9366 - val_loss: 1.0507 - val_accuracy: 0.7983
Confusion matrix: 
 [[462 111]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.344 0.656]]
Validation f1: 25.61
Validation accuracy: 79.83
Validation recall: 65.62
Validation precision: 15.91
Validation AUC: 0.23778861024764414
Validation class accuracies: [0.806282722513089, 0.65625]
The validation tracker metric at 0.34782608695652173 hasn't increased by 0 in 7 epochs
Epoch 12/65
184/184 - 255s - loss: 0.1038 - accuracy: 0.9516 - val_loss: 0.3075 - val_accuracy: 0.9008
Confusion matrix: 
 [[517  56]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.902 0.098]
 [0.125 0.875]]
Validation f1: 48.28
Validation accuracy: 90.08
Validation recall: 87.50
Validation precision: 33.33
Validation AUC: 0.7534639464368238
Validation class accuracies: [0.9022687609075044, 0.875]
Saving model...
Epoch 13/65
184/184 - 255s - loss: 0.0868 - accuracy: 0.9662 - val_loss: 0.2552 - val_accuracy: 0.9554
Confusion matrix: 
 [[572   1]
 [ 26   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.812 0.188]]
Validation f1: 30.77
Validation accuracy: 95.54
Validation recall: 18.75
Validation precision: 85.71
Validation AUC: 0.3435283415265665
Validation class accuracies: [0.9982547993019197, 0.1875]
The validation tracker metric at 0.48275862068965514 hasn't increased by 0 in 1 epochs
Epoch 14/65
184/184 - 255s - loss: 0.1353 - accuracy: 0.9458 - val_loss: 0.1157 - val_accuracy: 0.9603
Confusion matrix: 
 [[564   9]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.469 0.531]]
Validation f1: 58.62
Validation accuracy: 96.03
Validation recall: 53.12
Validation precision: 65.38
Validation AUC: 0.6320983945480869
Validation class accuracies: [0.9842931937172775, 0.53125]
Saving model...
Epoch 15/65
184/184 - 255s - loss: 0.0537 - accuracy: 0.9754 - val_loss: 0.3957 - val_accuracy: 0.8826
Confusion matrix: 
 [[509  64]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.219 0.781]]
Validation f1: 41.32
Validation accuracy: 88.26
Validation recall: 78.12
Validation precision: 28.09
Validation AUC: 0.5388318859897177
Validation class accuracies: [0.8883071553228621, 0.78125]
The validation tracker metric at 0.5862068965517242 hasn't increased by 0 in 1 epochs
Epoch 16/65
184/184 - 255s - loss: 0.0836 - accuracy: 0.9662 - val_loss: 0.2600 - val_accuracy: 0.9388
Confusion matrix: 
 [[554  19]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.562 0.438]]
Validation f1: 43.08
Validation accuracy: 93.88
Validation recall: 43.75
Validation precision: 42.42
Validation AUC: 0.5176940892810987
Validation class accuracies: [0.9668411867364747, 0.4375]
The validation tracker metric at 0.5862068965517242 hasn't increased by 0 in 2 epochs
Epoch 17/65
184/184 - 255s - loss: 0.0541 - accuracy: 0.9812 - val_loss: 0.4256 - val_accuracy: 0.8826
Confusion matrix: 
 [[504  69]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.062 0.938]]
Validation f1: 45.80
Validation accuracy: 88.26
Validation recall: 93.75
Validation precision: 30.30
Validation AUC: 0.57432178215907
Validation class accuracies: [0.8795811518324608, 0.9375]
The validation tracker metric at 0.5862068965517242 hasn't increased by 0 in 3 epochs
Epoch 18/65
184/184 - 255s - loss: 0.0740 - accuracy: 0.9703 - val_loss: 0.2092 - val_accuracy: 0.9355
Confusion matrix: 
 [[543  30]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.281 0.719]]
Validation f1: 54.12
Validation accuracy: 93.55
Validation recall: 71.88
Validation precision: 43.40
Validation AUC: 0.6108440121431326
Validation class accuracies: [0.9476439790575916, 0.71875]
The validation tracker metric at 0.5862068965517242 hasn't increased by 0 in 4 epochs
Epoch 19/65
184/184 - 255s - loss: 0.0572 - accuracy: 0.9765 - val_loss: 3.6237 - val_accuracy: 0.5174
Confusion matrix: 
 [[281 292]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.49 0.51]
 [0.   1.  ]]
Validation f1: 17.98
Validation accuracy: 51.74
Validation recall: 100.00
Validation precision: 9.88
Validation AUC: 0.5672493708615216
Validation class accuracies: [0.49040139616055844, 1.0]
The validation tracker metric at 0.5862068965517242 hasn't increased by 0 in 5 epochs
Epoch 20/65
184/184 - 255s - loss: 0.0425 - accuracy: 0.9826 - val_loss: 0.2410 - val_accuracy: 0.9157
Confusion matrix: 
 [[534  39]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.375 0.625]]
Validation f1: 43.96
Validation accuracy: 91.57
Validation recall: 62.50
Validation precision: 33.90
Validation AUC: 0.5111969078239119
Validation class accuracies: [0.9319371727748691, 0.625]
local_gc_exec.sh: line 6:  9567 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2230__06_0523__v39__time_frq_masking/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
