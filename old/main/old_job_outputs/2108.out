Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2108
Description:  mixednet_lowerpatience
2021-05-09 15:52:32.535488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 15:52:34.794915: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 15:52:34.795906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-09 15:52:34.845142: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:34.845899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 15:52:34.845928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 15:52:34.849456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 15:52:34.849537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 15:52:34.850626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 15:52:34.850925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 15:52:34.851995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 15:52:34.852889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 15:52:34.853044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 15:52:34.853153: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:34.853873: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:34.854513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2108.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2108__05_1552__v29__mixednet_lowerpatience/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 3, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2108
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/vob3k5tb
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_155235-vob3k5tb
wandb: Run `wandb offline` to turn off syncing.
2021-05-09 15:52:40.000648: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 15:52:40.000931: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:40.001736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 15:52:40.001780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 15:52:40.001830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 15:52:40.001852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 15:52:40.001874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 15:52:40.001896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 15:52:40.001918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 15:52:40.001951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 15:52:40.001971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 15:52:40.002057: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:40.002813: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:40.003483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-09 15:52:40.003527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 15:52:40.746575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-09 15:52:40.746622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-09 15:52:40.746631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-09 15:52:40.746939: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:40.747702: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:40.748384: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 15:52:40.749029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-09 15:53:17.868207: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-09 15:53:17.869807: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-09 15:53:19.516883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 15:53:20.249665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 15:53:20.257982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
263/263 - 152s - loss: 0.6767 - accuracy: 0.6168 - val_loss: 0.6311 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.196178134315727
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
263/263 - 145s - loss: 0.6630 - accuracy: 0.6320 - val_loss: 0.5698 - val_accuracy: 0.7987
Confusion matrix: 
 [[868   2]
 [217   1]]
Validation f1: 0.90
Validation accuracy: 79.87
Validation recall: 0.46
Validation precision: 33.33
Validation AUC: 0.1921763603068415
Validation class accuracies: [0.9977011494252873, 0.0045871559633027525]
Epoch 3/40
263/263 - 145s - loss: 0.6462 - accuracy: 0.6556 - val_loss: 0.6427 - val_accuracy: 0.6994
Confusion matrix: 
 [[728 142]
 [185  33]]
Validation f1: 16.79
Validation accuracy: 69.94
Validation recall: 15.14
Validation precision: 18.86
Validation AUC: 0.20858405044343403
Validation class accuracies: [0.8367816091954023, 0.15137614678899083]
Epoch 4/40
263/263 - 145s - loss: 0.6315 - accuracy: 0.6530 - val_loss: 0.7181 - val_accuracy: 0.5717
Confusion matrix: 
 [[524 346]
 [120  98]]
Validation f1: 29.61
Validation accuracy: 57.17
Validation recall: 44.95
Validation precision: 22.07
Validation AUC: 0.22153903649032186
Validation class accuracies: [0.6022988505747127, 0.44954128440366975]
Epoch 5/40
263/263 - 145s - loss: 0.6117 - accuracy: 0.6864 - val_loss: 0.6898 - val_accuracy: 0.6517
Confusion matrix: 
 [[645 225]
 [154  64]]
Validation f1: 25.25
Validation accuracy: 65.17
Validation recall: 29.36
Validation precision: 22.15
Validation AUC: 0.21981638741033804
Validation class accuracies: [0.7413793103448276, 0.29357798165137616]
Saving model...
Epoch 6/40
263/263 - 146s - loss: 0.5881 - accuracy: 0.7023 - val_loss: 0.6244 - val_accuracy: 0.7059
Confusion matrix: 
 [[742 128]
 [192  26]]
Validation f1: 13.98
Validation accuracy: 70.59
Validation recall: 11.93
Validation precision: 16.88
Validation AUC: 0.19653315094228496
Validation class accuracies: [0.8528735632183908, 0.11926605504587157]
The validation tracker metric at 0.252465483234714 hasn't increased by 0.01 in 1 epochs
Epoch 7/40
263/263 - 145s - loss: 0.5507 - accuracy: 0.7374 - val_loss: 0.5767 - val_accuracy: 0.7537
Confusion matrix: 
 [[801  69]
 [199  19]]
Validation f1: 12.42
Validation accuracy: 75.37
Validation recall: 8.72
Validation precision: 21.59
Validation AUC: 0.21572885324951419
Validation class accuracies: [0.9206896551724137, 0.0871559633027523]
The validation tracker metric at 0.252465483234714 hasn't increased by 0.01 in 2 epochs
Epoch 8/40
263/263 - 145s - loss: 0.5111 - accuracy: 0.7684 - val_loss: 0.6450 - val_accuracy: 0.7206
Confusion matrix: 
 [[756 114]
 [190  28]]
Validation f1: 15.56
Validation accuracy: 72.06
Validation recall: 12.84
Validation precision: 19.72
Validation AUC: 0.19922588040566572
Validation class accuracies: [0.8689655172413793, 0.12844036697247707]
Lr has been adjusted to 0.0005000000237487257
The validation tracker metric at 0.252465483234714 hasn't increased by 0.01 in 3 epochs
Epoch 9/40
263/263 - 145s - loss: 0.4437 - accuracy: 0.8172 - val_loss: 0.7803 - val_accuracy: 0.5983
Confusion matrix: 
 [[559 311]
 [126  92]]
Validation f1: 29.63
Validation accuracy: 59.83
Validation recall: 42.20
Validation precision: 22.83
Validation AUC: 0.22246690053670554
Validation class accuracies: [0.6425287356321839, 0.42201834862385323]
Saving model...
Epoch 10/40
263/263 - 145s - loss: 0.4073 - accuracy: 0.8351 - val_loss: 0.7207 - val_accuracy: 0.6397
Confusion matrix: 
 [[640 230]
 [162  56]]
Validation f1: 22.22
Validation accuracy: 63.97
Validation recall: 25.69
Validation precision: 19.58
Validation AUC: 0.21821870722387476
Validation class accuracies: [0.735632183908046, 0.25688073394495414]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 1 epochs
Epoch 11/40
263/263 - 145s - loss: 0.3662 - accuracy: 0.8587 - val_loss: 0.6983 - val_accuracy: 0.6728
Confusion matrix: 
 [[680 190]
 [166  52]]
Validation f1: 22.61
Validation accuracy: 67.28
Validation recall: 23.85
Validation precision: 21.49
Validation AUC: 0.2211205692863778
Validation class accuracies: [0.7816091954022989, 0.23853211009174313]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 2 epochs
Epoch 12/40
263/263 - 145s - loss: 0.3439 - accuracy: 0.8682 - val_loss: 0.7580 - val_accuracy: 0.6314
Confusion matrix: 
 [[631 239]
 [162  56]]
Validation f1: 21.83
Validation accuracy: 63.14
Validation recall: 25.69
Validation precision: 18.98
Validation AUC: 0.21222029833927505
Validation class accuracies: [0.725287356321839, 0.25688073394495414]
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 3 epochs
Epoch 13/40
263/263 - 145s - loss: 0.3075 - accuracy: 0.8897 - val_loss: 0.7625 - val_accuracy: 0.6379
Confusion matrix: 
 [[625 245]
 [149  69]]
Validation f1: 25.94
Validation accuracy: 63.79
Validation recall: 31.65
Validation precision: 21.97
Validation AUC: 0.22290966573142787
Validation class accuracies: [0.7183908045977011, 0.3165137614678899]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 4 epochs
Epoch 14/40
263/263 - 145s - loss: 0.2877 - accuracy: 0.8966 - val_loss: 0.8034 - val_accuracy: 0.6029
Confusion matrix: 
 [[583 287]
 [145  73]]
Validation f1: 25.26
Validation accuracy: 60.29
Validation recall: 33.49
Validation precision: 20.28
Validation AUC: 0.21443899518116816
Validation class accuracies: [0.6701149425287356, 0.3348623853211009]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 5 epochs
Epoch 15/40
263/263 - 145s - loss: 0.2684 - accuracy: 0.9087 - val_loss: 0.7321 - val_accuracy: 0.6673
Confusion matrix: 
 [[674 196]
 [166  52]]
Validation f1: 22.32
Validation accuracy: 66.73
Validation recall: 23.85
Validation precision: 20.97
Validation AUC: 0.21565922853748012
Validation class accuracies: [0.774712643678161, 0.23853211009174313]
Lr has been adjusted to 0.0001250000059371814
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 6 epochs
Epoch 16/40
263/263 - 145s - loss: 0.2602 - accuracy: 0.9073 - val_loss: 0.7961 - val_accuracy: 0.6213
Confusion matrix: 
 [[610 260]
 [152  66]]
Validation f1: 24.26
Validation accuracy: 62.13
Validation recall: 30.28
Validation precision: 20.25
Validation AUC: 0.21616868054501948
Validation class accuracies: [0.7011494252873564, 0.30275229357798167]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 7 epochs
Epoch 17/40
263/263 - 145s - loss: 0.2506 - accuracy: 0.9202 - val_loss: 0.7753 - val_accuracy: 0.6498
Confusion matrix: 
 [[653 217]
 [164  54]]
Validation f1: 22.09
Validation accuracy: 64.98
Validation recall: 24.77
Validation precision: 19.93
Validation AUC: 0.21429260671858008
Validation class accuracies: [0.7505747126436781, 0.24770642201834864]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 8 epochs
Epoch 18/40
263/263 - 149s - loss: 0.2489 - accuracy: 0.9183 - val_loss: 0.8121 - val_accuracy: 0.6186
Confusion matrix: 
 [[610 260]
 [155  63]]
Validation f1: 23.29
Validation accuracy: 61.86
Validation recall: 28.90
Validation precision: 19.50
Validation AUC: 0.21360589214573722
Validation class accuracies: [0.7011494252873564, 0.2889908256880734]
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 9 epochs
Epoch 19/40
263/263 - 149s - loss: 0.2400 - accuracy: 0.9211 - val_loss: 0.8098 - val_accuracy: 0.6241
Confusion matrix: 
 [[611 259]
 [150  68]]
Validation f1: 24.95
Validation accuracy: 62.41
Validation recall: 31.19
Validation precision: 20.80
Validation AUC: 0.21505910603781753
Validation class accuracies: [0.7022988505747126, 0.3119266055045872]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 10 epochs
Epoch 20/40
263/263 - 149s - loss: 0.2298 - accuracy: 0.9280 - val_loss: 0.8300 - val_accuracy: 0.6085
Confusion matrix: 
 [[595 275]
 [151  67]]
Validation f1: 23.93
Validation accuracy: 60.85
Validation recall: 30.73
Validation precision: 19.59
Validation AUC: 0.2172304887362413
Validation class accuracies: [0.6839080459770115, 0.3073394495412844]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 11 epochs
Epoch 21/40
263/263 - 149s - loss: 0.2367 - accuracy: 0.9230 - val_loss: 0.8226 - val_accuracy: 0.6195
Confusion matrix: 
 [[610 260]
 [154  64]]
Validation f1: 23.62
Validation accuracy: 61.95
Validation recall: 29.36
Validation precision: 19.75
Validation AUC: 0.2155550019005878
Validation class accuracies: [0.7011494252873564, 0.29357798165137616]
Lr has been adjusted to 3.125000148429535e-05
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 12 epochs
Epoch 22/40
263/263 - 149s - loss: 0.2288 - accuracy: 0.9273 - val_loss: 0.7907 - val_accuracy: 0.6461
Confusion matrix: 
 [[645 225]
 [160  58]]
Validation f1: 23.15
Validation accuracy: 64.61
Validation recall: 26.61
Validation precision: 20.49
Validation AUC: 0.21524590405743194
Validation class accuracies: [0.7413793103448276, 0.26605504587155965]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 13 epochs
Epoch 23/40
263/263 - 149s - loss: 0.2231 - accuracy: 0.9292 - val_loss: 0.7886 - val_accuracy: 0.6489
Confusion matrix: 
 [[649 221]
 [161  57]]
Validation f1: 22.98
Validation accuracy: 64.89
Validation recall: 26.15
Validation precision: 20.50
Validation AUC: 0.21357737015720624
Validation class accuracies: [0.7459770114942529, 0.26146788990825687]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 14 epochs
Epoch 24/40
263/263 - 149s - loss: 0.2315 - accuracy: 0.9254 - val_loss: 0.7874 - val_accuracy: 0.6507
Confusion matrix: 
 [[652 218]
 [162  56]]
Validation f1: 22.76
Validation accuracy: 65.07
Validation recall: 25.69
Validation precision: 20.44
Validation AUC: 0.21373525594109088
Validation class accuracies: [0.7494252873563219, 0.25688073394495414]
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 15 epochs
Epoch 25/40
263/263 - 149s - loss: 0.2357 - accuracy: 0.9235 - val_loss: 0.8068 - val_accuracy: 0.6333
Confusion matrix: 
 [[629 241]
 [158  60]]
Validation f1: 23.12
Validation accuracy: 63.33
Validation recall: 27.52
Validation precision: 19.93
Validation AUC: 0.21484396764907698
Validation class accuracies: [0.7229885057471265, 0.27522935779816515]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 16 epochs
Epoch 26/40
263/263 - 149s - loss: 0.2260 - accuracy: 0.9285 - val_loss: 0.7956 - val_accuracy: 0.6461
Confusion matrix: 
 [[644 226]
 [159  59]]
Validation f1: 23.46
Validation accuracy: 64.61
Validation recall: 27.06
Validation precision: 20.70
Validation AUC: 0.21554453734559986
Validation class accuracies: [0.7402298850574712, 0.2706422018348624]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 17 epochs
Epoch 27/40
263/263 - 149s - loss: 0.2204 - accuracy: 0.9287 - val_loss: 0.8127 - val_accuracy: 0.6342
Confusion matrix: 
 [[629 241]
 [157  61]]
Validation f1: 23.46
Validation accuracy: 63.42
Validation recall: 27.98
Validation precision: 20.20
Validation AUC: 0.21477075637909906
Validation class accuracies: [0.7229885057471265, 0.2798165137614679]
Lr has been adjusted to 7.812500371073838e-06
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 18 epochs
Epoch 28/40
263/263 - 149s - loss: 0.2239 - accuracy: 0.9287 - val_loss: 0.8025 - val_accuracy: 0.6379
Confusion matrix: 
 [[635 235]
 [159  59]]
Validation f1: 23.05
Validation accuracy: 63.79
Validation recall: 27.06
Validation precision: 20.07
Validation AUC: 0.2157196972891403
Validation class accuracies: [0.7298850574712644, 0.2706422018348624]
The validation tracker metric at 0.2962962962962963 hasn't increased by 0.01 in 19 epochs
Epoch 29/40
263/263 - 149s - loss: 0.2225 - accuracy: 0.9285 - val_loss: 0.8006 - val_accuracy: 0.6443
Confusion matrix: 
 [[642 228]
 [159  59]]
Validation f1: 23.37
Validation accuracy: 64.43
Validation recall: 27.06
Validation precision: 20.56
Validation AUC: 0.21409284021155855
Validation class accuracies: [0.7379310344827587, 0.2706422018348624]

The metrics for the epoch with the best target metric are: 
Best cm: [[559 311]
 [126  92]]
Best f1: 0.2962962962962963
Best accuracy: 0.5983455882352942
Best recall: 0.42201834862385323
Best precision: 0.228287841191067
Best AUC: 0.22246690053670554
Best epoch: 8
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 4
Starting...
F1: 0.3421052631578947
Accuracy: 0.3333333333333333
Precision: 0.21311475409836064
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2108__05_1552__v29__mixednet_lowerpatience/validation_sheet_4.xls...
Done.
Epoch: 8
Starting...
F1: 0.375
Accuracy: 0.3333333333333333
Precision: 0.23076923076923078
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2108__05_1552__v29__mixednet_lowerpatience/validation_sheet_8.xls...
Done.
Epoch: 40
Starting...
F1: 0.3333333333333333
Accuracy: 0.36
Precision: 0.21052631578947367
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2108__05_1552__v29__mixednet_lowerpatience/validation_sheet_40.xls...
Done.
wandb: Waiting for W&B process to finish, PID 31436
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_155235-vob3k5tb/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_155235-vob3k5tb/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9285
wandb:         val_accuracy 0.6443
wandb:             _runtime 4838
wandb:           _timestamp 1620580393
wandb:                _step 204
wandb:           train_loss 0.22249
wandb:             val_loss 0.80055
wandb:           val_recall 0.27064
wandb:        val_precision 0.20557
wandb:               val_f1 0.23366
wandb:              val_auc 0.21409
wandb:                   lr 1e-05
wandb:          best_val_f1 0.2963
wandb:    best_val_accuracy 0.59835
wandb:   best_val_precision 0.22829
wandb:      best_val_recall 0.42202
wandb:             best_auc 0.22247
wandb:           best_epoch 8
wandb:           best_bd_f1 0.375
wandb:     best_bd_accuracy 0.33333
wandb:    best_bd_precision 0.23077
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 8
wandb: Run history:
wandb:   train_accuracy ▁▁▂▂▃▃▄▄▅▆▆▇▇▇███████████████
wandb:     val_accuracy ██▅▁▃▅▇▆▂▃▄▃▃▂▄▃▃▂▃▂▂▃▃▃▃▃▃▃▃
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ███▇▇▇▆▅▄▄▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▁▃▅▄▂▁▃▇▅▄▆▆▇▅▇▇█▇██▇▇▇▇▇█▇▇
wandb:       val_recall ▁▁▃█▆▃▂▃█▅▅▅▆▆▅▆▅▆▆▆▆▅▅▅▅▅▅▅▅
wandb:    val_precision ▁█▅▆▆▅▆▅▆▅▆▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_f1 ▁▁▅█▇▄▄▅█▆▆▆▇▇▆▇▆▇▇▇▇▆▆▆▆▇▇▆▇
wandb:          val_auc ▂▁▅█▇▂▆▃█▇█▆█▆▆▆▆▆▆▇▆▆▆▆▆▆▆▆▆
wandb:               lr ████████▄▄▄▄▃▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 2 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2108: https://wandb.ai/arachid1/tensorboard-integration/runs/vob3k5tb


 See logs at ../../new_cache/conv__2108__05_1552__v29__mixednet_lowerpatience/logs/