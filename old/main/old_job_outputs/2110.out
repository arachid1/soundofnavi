Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2110
Description:  mixednet
2021-05-08 23:31:06.722122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-08 23:31:09.810895: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-08 23:31:09.811983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-08 23:31:09.879494: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:09.880310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-08 23:31:09.880346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-08 23:31:09.884421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-08 23:31:09.884585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-08 23:31:09.885823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-08 23:31:09.886218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-08 23:31:09.887343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-08 23:31:09.888287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-08 23:31:09.888457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-08 23:31:09.888612: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:09.889471: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:09.890210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2110.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2110__05_2331__v29__mixednet/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.01, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 5, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2110
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/h3w4upr2
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210508_233110-h3w4upr2
wandb: Run `wandb offline` to turn off syncing.
2021-05-08 23:31:16.085319: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-08 23:31:16.085694: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:16.086878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-08 23:31:16.086970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-08 23:31:16.087058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-08 23:31:16.087100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-08 23:31:16.087133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-08 23:31:16.087162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-08 23:31:16.087191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-08 23:31:16.087221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-08 23:31:16.087249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-08 23:31:16.087401: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:16.088613: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:16.089668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-08 23:31:16.089753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-08 23:31:17.064266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-08 23:31:17.064335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-08 23:31:17.064349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-08 23:31:17.064736: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:17.066271: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:17.067745: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 23:31:17.068871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-08 23:32:08.040272: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-08 23:32:08.042366: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-08 23:32:10.424091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-08 23:32:11.406384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-08 23:32:11.416334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
263/263 - 162s - loss: 0.6734 - accuracy: 0.6156 - val_loss: 0.6406 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24985479118220116
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
263/263 - 154s - loss: 0.6565 - accuracy: 0.6449 - val_loss: 0.6092 - val_accuracy: 0.7858
Confusion matrix: 
 [[849  21]
 [212   6]]
Validation f1: 4.90
Validation accuracy: 78.58
Validation recall: 2.75
Validation precision: 22.22
Validation AUC: 0.22210567915319612
Validation class accuracies: [0.9758620689655172, 0.027522935779816515]
Epoch 3/40
263/263 - 153s - loss: 0.6416 - accuracy: 0.6675 - val_loss: 0.6468 - val_accuracy: 0.7013
Confusion matrix: 
 [[724 146]
 [179  39]]
Validation f1: 19.35
Validation accuracy: 70.13
Validation recall: 17.89
Validation precision: 21.08
Validation AUC: 0.21765009033860927
Validation class accuracies: [0.832183908045977, 0.17889908256880735]
Epoch 4/40
263/263 - 153s - loss: 0.6331 - accuracy: 0.6649 - val_loss: 0.6913 - val_accuracy: 0.5717
Confusion matrix: 
 [[520 350]
 [116 102]]
Validation f1: 30.45
Validation accuracy: 57.17
Validation recall: 46.79
Validation precision: 22.57
Validation AUC: 0.22310815574970666
Validation class accuracies: [0.5977011494252874, 0.46788990825688076]
Epoch 5/40
263/263 - 152s - loss: 0.6244 - accuracy: 0.6828 - val_loss: 0.7702 - val_accuracy: 0.4926
Confusion matrix: 
 [[412 458]
 [ 94 124]]
Validation f1: 31.00
Validation accuracy: 49.26
Validation recall: 56.88
Validation precision: 21.31
Validation AUC: 0.22753285570328796
Validation class accuracies: [0.4735632183908046, 0.5688073394495413]
Saving model...
Epoch 6/40
263/263 - 152s - loss: 0.6170 - accuracy: 0.6814 - val_loss: 0.7138 - val_accuracy: 0.5689
Confusion matrix: 
 [[528 342]
 [127  91]]
Validation f1: 27.96
Validation accuracy: 56.89
Validation recall: 41.74
Validation precision: 21.02
Validation AUC: 0.2139422411025197
Validation class accuracies: [0.6068965517241379, 0.41743119266055045]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 1 epochs
Epoch 7/40
263/263 - 152s - loss: 0.6074 - accuracy: 0.7000 - val_loss: 0.6364 - val_accuracy: 0.7031
Confusion matrix: 
 [[719 151]
 [172  46]]
Validation f1: 22.17
Validation accuracy: 70.31
Validation recall: 21.10
Validation precision: 23.35
Validation AUC: 0.22294384418928614
Validation class accuracies: [0.8264367816091954, 0.21100917431192662]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 2 epochs
Epoch 8/40
263/263 - 151s - loss: 0.5995 - accuracy: 0.7042 - val_loss: 0.6887 - val_accuracy: 0.6121
Confusion matrix: 
 [[592 278]
 [144  74]]
Validation f1: 25.96
Validation accuracy: 61.21
Validation recall: 33.94
Validation precision: 21.02
Validation AUC: 0.20571641067987856
Validation class accuracies: [0.6804597701149425, 0.3394495412844037]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 3 epochs
Epoch 9/40
263/263 - 153s - loss: 0.5903 - accuracy: 0.7171 - val_loss: 0.7303 - val_accuracy: 0.5469
Confusion matrix: 
 [[496 374]
 [119  99]]
Validation f1: 28.65
Validation accuracy: 54.69
Validation recall: 45.41
Validation precision: 20.93
Validation AUC: 0.21606968906960639
Validation class accuracies: [0.5701149425287356, 0.4541284403669725]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 4 epochs
Epoch 10/40
263/263 - 151s - loss: 0.5854 - accuracy: 0.7226 - val_loss: 0.7314 - val_accuracy: 0.5478
Confusion matrix: 
 [[504 366]
 [126  92]]
Validation f1: 27.22
Validation accuracy: 54.78
Validation recall: 42.20
Validation precision: 20.09
Validation AUC: 0.21072782059203546
Validation class accuracies: [0.5793103448275863, 0.42201834862385323]
Lr has been adjusted to 0.0005000000237487257
The validation tracker metric at 0.31 hasn't increased by 0.01 in 5 epochs
Epoch 11/40
263/263 - 153s - loss: 0.5761 - accuracy: 0.7355 - val_loss: 0.7067 - val_accuracy: 0.6048
Confusion matrix: 
 [[575 295]
 [135  83]]
Validation f1: 27.85
Validation accuracy: 60.48
Validation recall: 38.07
Validation precision: 21.96
Validation AUC: 0.22279141533465002
Validation class accuracies: [0.6609195402298851, 0.38073394495412843]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 6 epochs
Epoch 12/40
263/263 - 154s - loss: 0.5734 - accuracy: 0.7393 - val_loss: 0.7070 - val_accuracy: 0.5892
Confusion matrix: 
 [[553 317]
 [130  88]]
Validation f1: 28.25
Validation accuracy: 58.92
Validation recall: 40.37
Validation precision: 21.73
Validation AUC: 0.21996942598496458
Validation class accuracies: [0.635632183908046, 0.4036697247706422]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 7 epochs
Epoch 13/40
263/263 - 154s - loss: 0.5688 - accuracy: 0.7393 - val_loss: 0.6960 - val_accuracy: 0.6176
Confusion matrix: 
 [[595 275]
 [141  77]]
Validation f1: 27.02
Validation accuracy: 61.76
Validation recall: 35.32
Validation precision: 21.88
Validation AUC: 0.2184141920878202
Validation class accuracies: [0.6839080459770115, 0.3532110091743119]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 8 epochs
Epoch 14/40
263/263 - 152s - loss: 0.5649 - accuracy: 0.7364 - val_loss: 0.6892 - val_accuracy: 0.6314
Confusion matrix: 
 [[615 255]
 [146  72]]
Validation f1: 26.42
Validation accuracy: 63.14
Validation recall: 33.03
Validation precision: 22.02
Validation AUC: 0.22147151938600362
Validation class accuracies: [0.7068965517241379, 0.3302752293577982]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 9 epochs
Epoch 15/40
263/263 - 154s - loss: 0.5623 - accuracy: 0.7395 - val_loss: 0.6819 - val_accuracy: 0.6351
Confusion matrix: 
 [[625 245]
 [152  66]]
Validation f1: 24.95
Validation accuracy: 63.51
Validation recall: 30.28
Validation precision: 21.22
Validation AUC: 0.2200157980773721
Validation class accuracies: [0.7183908045977011, 0.30275229357798167]
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.31 hasn't increased by 0.01 in 10 epochs
Epoch 16/40
263/263 - 152s - loss: 0.5585 - accuracy: 0.7488 - val_loss: 0.6890 - val_accuracy: 0.6314
Confusion matrix: 
 [[613 257]
 [144  74]]
Validation f1: 26.96
Validation accuracy: 63.14
Validation recall: 33.94
Validation precision: 22.36
Validation AUC: 0.22371941248752703
Validation class accuracies: [0.7045977011494253, 0.3394495412844037]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 11 epochs
Epoch 17/40
263/263 - 152s - loss: 0.5561 - accuracy: 0.7479 - val_loss: 0.6886 - val_accuracy: 0.6278
Confusion matrix: 
 [[609 261]
 [144  74]]
Validation f1: 26.76
Validation accuracy: 62.78
Validation recall: 33.94
Validation precision: 22.09
Validation AUC: 0.2233049722399931
Validation class accuracies: [0.7, 0.3394495412844037]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 12 epochs
Epoch 18/40
263/263 - 153s - loss: 0.5611 - accuracy: 0.7407 - val_loss: 0.7101 - val_accuracy: 0.5947
Confusion matrix: 
 [[564 306]
 [135  83]]
Validation f1: 27.35
Validation accuracy: 59.47
Validation recall: 38.07
Validation precision: 21.34
Validation AUC: 0.22017903593574423
Validation class accuracies: [0.6482758620689655, 0.38073394495412843]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 13 epochs
Epoch 19/40
263/263 - 151s - loss: 0.5536 - accuracy: 0.7524 - val_loss: 0.7120 - val_accuracy: 0.5993
Confusion matrix: 
 [[568 302]
 [134  84]]
Validation f1: 27.81
Validation accuracy: 59.93
Validation recall: 38.53
Validation precision: 21.76
Validation AUC: 0.22378174190436073
Validation class accuracies: [0.6528735632183909, 0.3853211009174312]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 14 epochs
Epoch 20/40
263/263 - 148s - loss: 0.5522 - accuracy: 0.7541 - val_loss: 0.6932 - val_accuracy: 0.6167
Confusion matrix: 
 [[597 273]
 [144  74]]
Validation f1: 26.19
Validation accuracy: 61.67
Validation recall: 33.94
Validation precision: 21.33
Validation AUC: 0.2221573036472497
Validation class accuracies: [0.6862068965517242, 0.3394495412844037]
Lr has been adjusted to 0.0001250000059371814
The validation tracker metric at 0.31 hasn't increased by 0.01 in 15 epochs
Epoch 21/40
263/263 - 148s - loss: 0.5529 - accuracy: 0.7507 - val_loss: 0.7013 - val_accuracy: 0.6121
Confusion matrix: 
 [[591 279]
 [143  75]]
Validation f1: 26.22
Validation accuracy: 61.21
Validation recall: 34.40
Validation precision: 21.19
Validation AUC: 0.22119015695542282
Validation class accuracies: [0.6793103448275862, 0.3440366972477064]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 16 epochs
Epoch 22/40
263/263 - 149s - loss: 0.5535 - accuracy: 0.7548 - val_loss: 0.6985 - val_accuracy: 0.6213
Confusion matrix: 
 [[600 270]
 [142  76]]
Validation f1: 26.95
Validation accuracy: 62.13
Validation recall: 34.86
Validation precision: 21.97
Validation AUC: 0.22272677928874388
Validation class accuracies: [0.6896551724137931, 0.3486238532110092]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 17 epochs
Epoch 23/40
263/263 - 151s - loss: 0.5501 - accuracy: 0.7519 - val_loss: 0.7035 - val_accuracy: 0.6048
Confusion matrix: 
 [[582 288]
 [142  76]]
Validation f1: 26.12
Validation accuracy: 60.48
Validation recall: 34.86
Validation precision: 20.88
Validation AUC: 0.22035049497755216
Validation class accuracies: [0.6689655172413793, 0.3486238532110092]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 18 epochs
Epoch 24/40
263/263 - 149s - loss: 0.5518 - accuracy: 0.7562 - val_loss: 0.6926 - val_accuracy: 0.6204
Confusion matrix: 
 [[603 267]
 [146  72]]
Validation f1: 25.85
Validation accuracy: 62.04
Validation recall: 33.03
Validation precision: 21.24
Validation AUC: 0.22199047764497867
Validation class accuracies: [0.6931034482758621, 0.3302752293577982]
The validation tracker metric at 0.31 hasn't increased by 0.01 in 19 epochs
Epoch 25/40
263/263 - 150s - loss: 0.5538 - accuracy: 0.7517 - val_loss: 0.7019 - val_accuracy: 0.6075
Confusion matrix: 
 [[586 284]
 [143  75]]
Validation f1: 26.00
Validation accuracy: 60.75
Validation recall: 34.40
Validation precision: 20.89
Validation AUC: 0.22080335006999974
Validation class accuracies: [0.6735632183908046, 0.3440366972477064]

The metrics for the epoch with the best target metric are: 
Best cm: [[412 458]
 [ 94 124]]
Best f1: 0.31
Best accuracy: 0.49264705882352944
Best recall: 0.5688073394495413
Best precision: 0.21305841924398625
Best AUC: 0.22753285570328796
Best epoch: 4
Lr has been adjusted to 6.25000029685907e-05
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 4
Starting...
F1: 0.35294117647058826
Accuracy: 0.26666666666666666
Precision: 0.21428571428571427
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2110__05_2331__v29__mixednet/validation_sheet_4.xls...
Done.
Epoch: 40
Starting...
F1: 0.3421052631578947
Accuracy: 0.3333333333333333
Precision: 0.21311475409836064
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2110__05_2331__v29__mixednet/validation_sheet_40.xls...
Done.
wandb: Waiting for W&B process to finish, PID 11437
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: | 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210508_233110-h3w4upr2/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210508_233110-h3w4upr2/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.75167
wandb:         val_accuracy 0.60754
wandb:             _runtime 4422
wandb:           _timestamp 1620521092
wandb:                _step 175
wandb:           train_loss 0.55377
wandb:             val_loss 0.70191
wandb:           val_recall 0.34404
wandb:        val_precision 0.20891
wandb:               val_f1 0.25997
wandb:              val_auc 0.2208
wandb:                   lr 0.00013
wandb:          best_val_f1 0.31
wandb:    best_val_accuracy 0.49265
wandb:   best_val_precision 0.21306
wandb:      best_val_recall 0.56881
wandb:             best_auc 0.22753
wandb:           best_epoch 4
wandb:           best_bd_f1 0.35294
wandb:     best_bd_accuracy 0.26667
wandb:    best_bd_precision 0.21429
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 4
wandb: Run history:
wandb:   train_accuracy ▁▂▄▃▄▄▅▅▆▆▇▇▇▇▇██▇███████
wandb:     val_accuracy ██▆▃▁▃▆▄▂▂▄▃▄▄▄▄▄▃▃▄▄▄▄▄▄
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▆▆▅▅▄▄▃▃▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▃▅█▆▂▄▆▆▅▅▅▄▄▄▄▅▅▅▅▅▅▅▅
wandb:       val_recall ▁▁▃▇█▆▄▅▇▆▆▆▅▅▅▅▅▆▆▅▅▅▅▅▅
wandb:    val_precision ▁█▇█▇▇█▇▇▇████▇██▇█▇▇█▇▇▇
wandb:           val_f1 ▁▂▅██▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc █▄▃▄▄▂▄▁▃▂▄▃▃▃▃▄▄▃▄▄▃▄▃▄▃
wandb:               lr ██████████▄▄▄▄▄▂▂▂▂▂▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2110: https://wandb.ai/arachid1/tensorboard-integration/runs/h3w4upr2


 See logs at ../../new_cache/conv__2110__05_2331__v29__mixednet/logs/