Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2257
Description:  lstm
2021-06-27 16:29:30.739076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-27 16:29:33.041910: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 16:29:33.042855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-27 16:29:33.092724: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:33.093463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 16:29:33.093499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 16:29:33.097100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 16:29:33.097201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 16:29:33.098308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 16:29:33.098612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 16:29:33.099705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 16:29:33.100635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 16:29:33.100795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 16:29:33.100919: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:33.101668: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:33.102338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2257.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2257__06_1625__v39__lstm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-27 16:29:37.995108: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 16:29:37.995350: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:37.996105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 16:29:37.996145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 16:29:37.996189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 16:29:37.996209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 16:29:37.996229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 16:29:37.996248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 16:29:37.996268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 16:29:37.996287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 16:29:37.996305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 16:29:37.996397: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:37.997195: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:37.997928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-27 16:29:37.997972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 16:29:38.721880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-27 16:29:38.721927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-27 16:29:38.721936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-27 16:29:38.722241: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:38.723071: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:38.723835: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:29:38.724517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-06-27 16:29:40.486824: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-27 16:29:40.489335: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-27 16:29:40.906986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 16:29:41.562156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 16:29:41.581025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 10, 125, 128, 1)]                   0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 10, 125, 128, 1)                     4                
______________________________________________________________________________________________________________
time_distributed_inverted_residual (TimeDistribu (None, 10, 125, 128, 32)                    359              
______________________________________________________________________________________________________________
time_distributed_inverted_residual_1 (TimeDistri (None, 10, 125, 128, 32)                    10496            
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)               (None, 10, 63, 64, 32)                      0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 10, 63, 64, 32)                      128              
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed)             (None, 10, 32)                              0                
______________________________________________________________________________________________________________
bidirectional (Bidirectional)                    (None, 10, 256)                             164864           
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)                  (None, 10, 256)                             394240           
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 10, 128)                             32896            
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 10, 1)                               129              
______________________________________________________________________________________________________________
flatten (Flatten)                                (None, 10)                                  0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   11               
==============================================================================================================
Total params: 603,127
Trainable params: 602,537
Non-trainable params: 590
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 160s - loss: 0.6946 - accuracy: 0.5452 - val_loss: 0.5204 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06951235859116892
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 156s - loss: 0.7064 - accuracy: 0.3979 - val_loss: 0.6994 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.19806236631538174
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 3/65
154/154 - 157s - loss: 0.7471 - accuracy: 0.2193 - val_loss: 0.7057 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.227992909796354
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 4/65
154/154 - 156s - loss: 0.6946 - accuracy: 0.5517 - val_loss: 1.2210 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.21476065037708078
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 5/65
154/154 - 156s - loss: 0.7568 - accuracy: 0.0850 - val_loss: 0.7584 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
Validation f1: 12.54
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.10227460743221556
Validation class accuracies: [0.0017452006980802793, 1.0]
Saving model...
Epoch 6/65
154/154 - 156s - loss: 0.7613 - accuracy: 0.0663 - val_loss: 0.8127 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.1037615743669583
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1253822629969419 hasn't increased by 0 in 1 epochs
Epoch 7/65
154/154 - 156s - loss: 0.7607 - accuracy: 0.0659 - val_loss: 0.9581 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.09965410490666693
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1253822629969419 hasn't increased by 0 in 2 epochs
Epoch 8/65
154/154 - 156s - loss: 0.7646 - accuracy: 0.0647 - val_loss: 0.7905 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.26774355390967464
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1253822629969419 hasn't increased by 0 in 3 epochs
Epoch 9/65
154/154 - 156s - loss: 0.7631 - accuracy: 0.0643 - val_loss: 0.7257 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.30937210462340375
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1253822629969419 hasn't increased by 0 in 4 epochs
Epoch 10/65
154/154 - 157s - loss: 0.7586 - accuracy: 0.0643 - val_loss: 0.7301 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.22033776353370144
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1253822629969419 hasn't increased by 0 in 5 epochs
Epoch 11/65
154/154 - 155s - loss: 0.7430 - accuracy: 0.0643 - val_loss: 0.7248 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.3611569784007549
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1253822629969419 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 12/65
154/154 - 156s - loss: 0.7551 - accuracy: 0.0643 - val_loss: 0.7713 - val_accuracy: 0.0717
Confusion matrix: 
 [[  3 570]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.005 0.995]
 [0.    1.   ]]
Validation f1: 12.58
Validation accuracy: 7.17
Validation recall: 100.00
Validation precision: 6.71
Validation AUC: 0.1757011130590151
Validation class accuracies: [0.005235602094240838, 1.0]
Saving model...
Epoch 13/65
154/154 - 156s - loss: 0.7455 - accuracy: 0.0643 - val_loss: 0.9108 - val_accuracy: 0.0651
Confusion matrix: 
 [[  0 573]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.    1.   ]
 [0.024 0.976]]
Validation f1: 12.23
Validation accuracy: 6.51
Validation recall: 97.56
Validation precision: 6.53
Validation AUC: 0.13744179394744116
Validation class accuracies: [0.0, 0.975609756097561]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 1 epochs
Epoch 14/65
154/154 - 155s - loss: 0.7354 - accuracy: 0.0647 - val_loss: 0.8605 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.18876816756933218
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 2 epochs
Epoch 15/65
154/154 - 156s - loss: 0.7438 - accuracy: 0.0643 - val_loss: 0.8136 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.20368391006105013
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 3 epochs
Epoch 16/65
154/154 - 156s - loss: 0.7077 - accuracy: 0.0643 - val_loss: 0.9228 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.14112728115744236
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 4 epochs
Epoch 17/65
154/154 - 155s - loss: 0.7340 - accuracy: 0.0651 - val_loss: 0.9206 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.14553507916086506
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 5 epochs
Epoch 18/65
154/154 - 156s - loss: 0.7406 - accuracy: 0.0643 - val_loss: 0.8050 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.20075234474285988
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 19/65
154/154 - 151s - loss: 0.7400 - accuracy: 0.0643 - val_loss: 0.7342 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.54
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.2826825343326944
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 7 epochs
Epoch 20/65
154/154 - 149s - loss: 0.7428 - accuracy: 0.0647 - val_loss: 0.7369 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.54
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.2612908254985515
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 8 epochs
Epoch 21/65
154/154 - 149s - loss: 0.7349 - accuracy: 0.0647 - val_loss: 0.7285 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.2783287564213865
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 9 epochs
Epoch 22/65
154/154 - 152s - loss: 0.7372 - accuracy: 0.0651 - val_loss: 0.7320 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
Validation f1: 12.54
Validation accuracy: 6.84
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.24515989030174468
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 10 epochs
Epoch 23/65
154/154 - 155s - loss: 0.7485 - accuracy: 0.0655 - val_loss: 0.7395 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.2786363747468595
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 11 epochs
Epoch 24/65
154/154 - 155s - loss: 0.7192 - accuracy: 0.0655 - val_loss: 0.7261 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.32287775334559576
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 25/65
154/154 - 155s - loss: 0.7320 - accuracy: 0.0643 - val_loss: 0.7286 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
Validation f1: 12.54
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.31617353102731466
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 13 epochs
Epoch 26/65
154/154 - 156s - loss: 0.7194 - accuracy: 0.0647 - val_loss: 0.7273 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.54
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.3124306291671712
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 14 epochs
Epoch 27/65
154/154 - 155s - loss: 0.7228 - accuracy: 0.0643 - val_loss: 0.7322 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.329341488494425
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 15 epochs
Epoch 28/65
154/154 - 155s - loss: 0.7364 - accuracy: 0.0647 - val_loss: 0.7272 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.54
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.3268124658261019
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 16 epochs
Epoch 29/65
154/154 - 155s - loss: 0.7274 - accuracy: 0.0643 - val_loss: 0.7320 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.54
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.3248660559965123
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 17 epochs
Epoch 30/65
154/154 - 155s - loss: 0.7159 - accuracy: 0.0643 - val_loss: 0.7271 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.3492621956274711
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 31/65
154/154 - 155s - loss: 0.7383 - accuracy: 0.0651 - val_loss: 0.7314 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.54
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.3584802753731744
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.1257668711656442 hasn't increased by 0 in 19 epochs
Epoch 32/65
154/154 - 155s - loss: 0.7241 - accuracy: 0.0647 - val_loss: 0.7305 - val_accuracy: 0.0700
Confusion matrix: 
 [[  2 571]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.003 0.997]
 [0.    1.   ]]
Validation f1: 12.56
Validation accuracy: 7.00
Validation recall: 100.00
Validation precision: 6.70
Validation AUC: 0.3624180598713201
Validation class accuracies: [0.0034904013961605585, 1.0]

The metrics for job 0 with the best target metric are: 
Best cm: [[  3 570]
 [  0  41]]
Best normalized cm: [[0.005 0.995]
 [0.    1.   ]]
Best f1: 0.13
Best accuracy: 0.07
Best recall: 1.00
Best precision: 0.07
Best AUC: 0.18
Best class accuracies: [0.005235602094240838, 1.0]
Best epoch: 12
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 2784
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_162933-28ihkljh/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_162933-28ihkljh/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.06469
wandb:         val_accuracy 0.07003
wandb:             _runtime 5329
wandb:           _timestamp 1624816703
wandb:                _step 232
wandb:           train_loss 0.72408
wandb:             val_loss 0.73055
wandb:           val_recall 1.0
wandb:        val_precision 0.06699
wandb:               val_f1 0.12557
wandb:              val_auc 0.36242
wandb:                   lr 6e-05
wandb:          best_val_f1 0.12577
wandb:    best_val_accuracy 0.07166
wandb:   best_val_precision 0.0671
wandb:      best_val_recall 1.0
wandb:             best_auc 0.1757
wandb:           best_epoch 12
wandb: Run history:
wandb:   train_accuracy █▆▃█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     val_accuracy █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ▁▂▆▁▇████▇▆▇▆▅▆▂▅▆▆▆▅▅▆▃▅▃▄▅▄▃▅▄
wandb:         val_loss ▁▃▃█▃▄▅▄▃▃▃▄▅▄▄▅▅▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:       val_recall ▁███████████████████████████████
wandb:    val_precision ▁███████████████████████████████
wandb:           val_f1 ▁███████████████████████████████
wandb:          val_auc ▁▄▅▄▂▂▂▆▇▅█▄▃▄▄▃▃▄▆▆▆▅▆▇▇▇▇▇▇███
wandb:               lr ███████████▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_162933-28ihkljh


 See logs at ../../new_cache/conv__2257__06_1625__v39__lstm/logs/