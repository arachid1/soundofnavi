Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2250
Description:  lstm_on_5timesteps
2021-06-24 19:46:32.405029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-24 19:46:34.508383: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-24 19:46:34.509299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-24 19:46:34.521760: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:34.522439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-24 19:46:34.522464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-24 19:46:34.525795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-24 19:46:34.525875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-24 19:46:34.526991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-24 19:46:34.527257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-24 19:46:34.528203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-24 19:46:34.529025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-24 19:46:34.529171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-24 19:46:34.529269: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:34.529983: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:34.530607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2250.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2250__06_1730__v39__lstm_on_5timesteps
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-24 19:46:39.754272: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-24 19:46:39.754589: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:39.755623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-24 19:46:39.755693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-24 19:46:39.755777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-24 19:46:39.755809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-24 19:46:39.755847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-24 19:46:39.755884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-24 19:46:39.755915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-24 19:46:39.755946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-24 19:46:39.755974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-24 19:46:39.756109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:39.757109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:39.758012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-24 19:46:39.758096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-24 19:46:40.606321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-24 19:46:40.606371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-24 19:46:40.606384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-24 19:46:40.606708: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:40.609865: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:40.610984: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-24 19:46:40.611955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-24 19:46:42.461048: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-24 19:46:42.462482: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-24 19:46:42.886069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-24 19:46:45.171358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-24 19:46:45.721901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 5, 250, 128, 1) 0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 5, 250, 128, 1)  4            input_1[0][0]                        
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 5, 250, 128, 16) 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed (None, 5, 250, 128, 16) 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed (None, 5, 250, 128, 1)  0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed (None, 5, 250, 128, 16) 2320         time_distributed[0][0]               
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed (None, 5, 250, 128, 16) 6416         time_distributed_2[0][0]             
______________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed (None, 5, 250, 128, 16) 32           time_distributed_4[0][0]             
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 5, 250, 128, 48) 0            time_distributed_1[0][0]             
                                                                         time_distributed_3[0][0]             
                                                                         time_distributed_5[0][0]             
______________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed (None, 5, 125, 64, 48)  0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 5, 125, 64, 48)  192          time_distributed_6[0][0]             
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 5, 125, 64, 48)  0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed (None, 5, 48)           0            dropout[0][0]                        
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 5, 256)          181248       time_distributed_7[0][0]             
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 5, 256)          394240       bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 5, 128)          32896        bidirectional_1[0][0]                
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 5, 1)            129          dense[0][0]                          
______________________________________________________________________________________________________________
flatten (Flatten)                   (None, 5)               0            dense_1[0][0]                        
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               6            flatten[0][0]                        
==============================================================================================================
Total params: 617,547
Trainable params: 617,449
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 58s - loss: 0.7527 - accuracy: 0.3275 - val_loss: 1.2286 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.22045102421616342
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 48s - loss: 0.6707 - accuracy: 0.6355 - val_loss: 1.2882 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.09081212726083271
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 48s - loss: 0.6409 - accuracy: 0.7360 - val_loss: 0.9347 - val_accuracy: 0.1531
Confusion matrix: 
 [[ 54 519]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.094 0.906]
 [0.024 0.976]]
Validation f1: 13.33
Validation accuracy: 15.31
Validation recall: 97.56
Validation precision: 7.16
Validation AUC: 0.25267956324546265
Validation class accuracies: [0.09424083769633508, 0.975609756097561]
Saving model...
Epoch 4/65
154/154 - 48s - loss: 0.6632 - accuracy: 0.4679 - val_loss: 0.8517 - val_accuracy: 0.4805
Confusion matrix: 
 [[254 319]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.443 0.557]
 [0.    1.   ]]
Validation f1: 20.45
Validation accuracy: 48.05
Validation recall: 100.00
Validation precision: 11.39
Validation AUC: 0.19194943653091395
Validation class accuracies: [0.4432809773123909, 1.0]
Saving model...
Epoch 5/65
154/154 - 48s - loss: 0.6620 - accuracy: 0.4508 - val_loss: 1.1190 - val_accuracy: 0.1059
Confusion matrix: 
 [[ 24 549]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.042 0.958]
 [0.    1.   ]]
Validation f1: 13.00
Validation accuracy: 10.59
Validation recall: 100.00
Validation precision: 6.95
Validation AUC: 0.18473142552401434
Validation class accuracies: [0.041884816753926704, 1.0]
The validation tracker metric at 0.20448877805486282 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 48s - loss: 0.5848 - accuracy: 0.7091 - val_loss: 0.8393 - val_accuracy: 0.5993
Confusion matrix: 
 [[331 242]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.578 0.422]
 [0.098 0.902]]
Validation f1: 23.12
Validation accuracy: 59.93
Validation recall: 90.24
Validation precision: 13.26
Validation AUC: 0.14476756734918947
Validation class accuracies: [0.5776614310645725, 0.9024390243902439]
Saving model...
Epoch 7/65
154/154 - 51s - loss: 0.5647 - accuracy: 0.6985 - val_loss: 0.7961 - val_accuracy: 0.6254
Confusion matrix: 
 [[346 227]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.604 0.396]
 [0.073 0.927]]
Validation f1: 24.84
Validation accuracy: 62.54
Validation recall: 92.68
Validation precision: 14.34
Validation AUC: 0.24560194607235458
Validation class accuracies: [0.6038394415357766, 0.926829268292683]
Saving model...
Epoch 8/65
154/154 - 49s - loss: 0.5480 - accuracy: 0.7819 - val_loss: 0.5543 - val_accuracy: 0.8730
Confusion matrix: 
 [[504  69]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88 0.12]
 [0.22 0.78]]
Validation f1: 45.07
Validation accuracy: 87.30
Validation recall: 78.05
Validation precision: 31.68
Validation AUC: 0.31627224721288805
Validation class accuracies: [0.8795811518324608, 0.7804878048780488]
Saving model...
Epoch 9/65
154/154 - 48s - loss: 0.5498 - accuracy: 0.7657 - val_loss: 0.8217 - val_accuracy: 0.6857
Confusion matrix: 
 [[382 191]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.667 0.333]
 [0.049 0.951]]
Validation f1: 28.78
Validation accuracy: 68.57
Validation recall: 95.12
Validation precision: 16.96
Validation AUC: 0.22940129893071765
Validation class accuracies: [0.6666666666666666, 0.9512195121951219]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 1 epochs
Epoch 10/65
154/154 - 49s - loss: 0.5256 - accuracy: 0.8613 - val_loss: 0.6741 - val_accuracy: 0.7834
Confusion matrix: 
 [[447 126]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.171 0.829]]
Validation f1: 33.83
Validation accuracy: 78.34
Validation recall: 82.93
Validation precision: 21.25
Validation AUC: 0.31904483561359265
Validation class accuracies: [0.7801047120418848, 0.8292682926829268]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 2 epochs
Epoch 11/65
154/154 - 49s - loss: 0.5746 - accuracy: 0.7352 - val_loss: 0.5809 - val_accuracy: 0.8046
Confusion matrix: 
 [[461 112]
 [  8  33]]
Normalized Confusion matrix: 
 [[0.805 0.195]
 [0.195 0.805]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.48
Validation accuracy: 80.46
Validation recall: 80.49
Validation precision: 22.76
Validation AUC: 0.38142622438797635
Validation class accuracies: [0.8045375218150087, 0.8048780487804879]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 3 epochs
Epoch 12/65
154/154 - 48s - loss: 0.5230 - accuracy: 0.7982 - val_loss: 0.6920 - val_accuracy: 0.7427
Confusion matrix: 
 [[419 154]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.731 0.269]
 [0.098 0.902]]
Validation f1: 31.90
Validation accuracy: 74.27
Validation recall: 90.24
Validation precision: 19.37
Validation AUC: 0.288140633276611
Validation class accuracies: [0.731239092495637, 0.9024390243902439]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 4 epochs
Epoch 13/65
154/154 - 48s - loss: 0.5028 - accuracy: 0.8324 - val_loss: 0.7445 - val_accuracy: 0.7085
Confusion matrix: 
 [[398 175]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.695 0.305]
 [0.098 0.902]]
Validation f1: 29.25
Validation accuracy: 70.85
Validation recall: 90.24
Validation precision: 17.45
Validation AUC: 0.2527851350235971
Validation class accuracies: [0.6945898778359512, 0.9024390243902439]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 5 epochs
Epoch 14/65
154/154 - 54s - loss: 0.5064 - accuracy: 0.8206 - val_loss: 0.6575 - val_accuracy: 0.7720
Confusion matrix: 
 [[438 135]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.764 0.236]
 [0.122 0.878]]
Validation f1: 33.96
Validation accuracy: 77.20
Validation recall: 87.80
Validation precision: 21.05
Validation AUC: 0.31586377341104654
Validation class accuracies: [0.7643979057591623, 0.8780487804878049]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 15/65
154/154 - 49s - loss: 0.4957 - accuracy: 0.8015 - val_loss: 0.6054 - val_accuracy: 0.7948
Confusion matrix: 
 [[454 119]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.171 0.829]]
Validation f1: 35.05
Validation accuracy: 79.48
Validation recall: 82.93
Validation precision: 22.22
Validation AUC: 0.3441404166188074
Validation class accuracies: [0.7923211169284468, 0.8292682926829268]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 7 epochs
Epoch 16/65
154/154 - 48s - loss: 0.4556 - accuracy: 0.8731 - val_loss: 0.5209 - val_accuracy: 0.8599
Confusion matrix: 
 [[493  80]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86  0.14 ]
 [0.146 0.854]]
Validation f1: 44.87
Validation accuracy: 85.99
Validation recall: 85.37
Validation precision: 30.43
Validation AUC: 0.33747551363857764
Validation class accuracies: [0.8603839441535777, 0.8536585365853658]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 8 epochs
Epoch 17/65
154/154 - 48s - loss: 0.4804 - accuracy: 0.8080 - val_loss: 0.5951 - val_accuracy: 0.7948
Confusion matrix: 
 [[448 125]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.782 0.218]
 [0.024 0.976]]
Validation f1: 38.83
Validation accuracy: 79.48
Validation recall: 97.56
Validation precision: 24.24
Validation AUC: 0.35099516368711847
Validation class accuracies: [0.7818499127399651, 0.975609756097561]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 9 epochs
Epoch 18/65
154/154 - 48s - loss: 0.4559 - accuracy: 0.8446 - val_loss: 0.5612 - val_accuracy: 0.8290
Confusion matrix: 
 [[473 100]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.122 0.878]]
Validation f1: 40.68
Validation accuracy: 82.90
Validation recall: 87.80
Validation precision: 26.47
Validation AUC: 0.35267521371293453
Validation class accuracies: [0.8254799301919721, 0.8780487804878049]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 10 epochs
Epoch 19/65
154/154 - 48s - loss: 0.4623 - accuracy: 0.8792 - val_loss: 0.7406 - val_accuracy: 0.7378
Confusion matrix: 
 [[416 157]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.098 0.902]]
Validation f1: 31.49
Validation accuracy: 73.78
Validation recall: 90.24
Validation precision: 19.07
Validation AUC: 0.17328145258168093
Validation class accuracies: [0.7260034904013961, 0.9024390243902439]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 11 epochs
Epoch 20/65
154/154 - 48s - loss: 0.4495 - accuracy: 0.8478 - val_loss: 0.5574 - val_accuracy: 0.8388
Confusion matrix: 
 [[480  93]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.146 0.854]]
Validation f1: 41.42
Validation accuracy: 83.88
Validation recall: 85.37
Validation precision: 27.34
Validation AUC: 0.3574249968169749
Validation class accuracies: [0.837696335078534, 0.8536585365853658]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 21/65
154/154 - 54s - loss: 0.4424 - accuracy: 0.8629 - val_loss: 0.6795 - val_accuracy: 0.7606
Confusion matrix: 
 [[430 143]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.75  0.25 ]
 [0.098 0.902]]
Validation f1: 33.48
Validation accuracy: 76.06
Validation recall: 90.24
Validation precision: 20.56
Validation AUC: 0.227424180162039
Validation class accuracies: [0.7504363001745201, 0.9024390243902439]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 13 epochs
Epoch 22/65
154/154 - 48s - loss: 0.4359 - accuracy: 0.8621 - val_loss: 0.6455 - val_accuracy: 0.7769
Confusion matrix: 
 [[441 132]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77  0.23 ]
 [0.122 0.878]]
Validation f1: 34.45
Validation accuracy: 77.69
Validation recall: 87.80
Validation precision: 21.43
Validation AUC: 0.23770594305454637
Validation class accuracies: [0.7696335078534031, 0.8780487804878049]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 14 epochs
Epoch 23/65
154/154 - 48s - loss: 0.4395 - accuracy: 0.8690 - val_loss: 0.6326 - val_accuracy: 0.7866
Confusion matrix: 
 [[447 126]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.122 0.878]]
Validation f1: 35.47
Validation accuracy: 78.66
Validation recall: 87.80
Validation precision: 22.22
Validation AUC: 0.24240902560199207
Validation class accuracies: [0.7801047120418848, 0.8780487804878049]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 15 epochs
Epoch 24/65
154/154 - 48s - loss: 0.4435 - accuracy: 0.8405 - val_loss: 0.6255 - val_accuracy: 0.7785
Confusion matrix: 
 [[439 134]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.766 0.234]
 [0.049 0.951]]
Validation f1: 36.45
Validation accuracy: 77.85
Validation recall: 95.12
Validation precision: 22.54
Validation AUC: 0.288054937127458
Validation class accuracies: [0.7661431064572426, 0.9512195121951219]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 16 epochs
Epoch 25/65
154/154 - 49s - loss: 0.4557 - accuracy: 0.8063 - val_loss: 0.6849 - val_accuracy: 0.7215
Confusion matrix: 
 [[403 170]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.703 0.297]
 [0.024 0.976]]
Validation f1: 31.87
Validation accuracy: 72.15
Validation recall: 97.56
Validation precision: 19.05
Validation AUC: 0.29465659084464485
Validation class accuracies: [0.7033158813263525, 0.975609756097561]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 17 epochs
Epoch 26/65
154/154 - 48s - loss: 0.4389 - accuracy: 0.8275 - val_loss: 0.6590 - val_accuracy: 0.7394
Confusion matrix: 
 [[416 157]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.073 0.927]]
Validation f1: 32.20
Validation accuracy: 73.94
Validation recall: 92.68
Validation precision: 19.49
Validation AUC: 0.32839885032371
Validation class accuracies: [0.7260034904013961, 0.926829268292683]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 27/65
154/154 - 48s - loss: 0.4417 - accuracy: 0.8365 - val_loss: 0.6530 - val_accuracy: 0.7427
Confusion matrix: 
 [[418 155]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.729 0.271]
 [0.073 0.927]]
Validation f1: 32.48
Validation accuracy: 74.27
Validation recall: 92.68
Validation precision: 19.69
Validation AUC: 0.36163800286554143
Validation class accuracies: [0.7294938917975567, 0.926829268292683]
The validation tracker metric at 0.4507042253521127 hasn't increased by 0 in 19 epochs
Epoch 28/65
154/154 - 52s - loss: 0.4334 - accuracy: 0.8458 - val_loss: 0.6302 - val_accuracy: 0.7638
Confusion matrix: 
 [[431 142]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.752 0.248]
 [0.073 0.927]]
Validation f1: 34.39
Validation accuracy: 76.38
Validation recall: 92.68
Validation precision: 21.11
Validation AUC: 0.36052768384109896
Validation class accuracies: [0.7521815008726004, 0.926829268292683]

The metrics for job 0 with the best target metric are: 
Best cm: [[504  69]
 [  9  32]]
Best normalized cm: [[0.88 0.12]
 [0.22 0.78]]
Best f1: 0.45
Best accuracy: 0.87
Best recall: 0.78
Best precision: 0.32
Best AUC: 0.32
Best class accuracies: [0.8795811518324608, 0.7804878048780488]
Best epoch: 8
The number of epochs since last 1% equals the patience
../../new_cache/conv__2250__06_1730__v39__lstm_on_5timesteps/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.257]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2250.py", line 379, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params, conv2d, job_count=0)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2250.py", line 321, in train_model
    callbacks=[metrics_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/integration/keras/keras.py", line 124, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1154, in fit
    callbacks.on_train_end(logs=training_logs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/callbacks.py", line 532, in on_train_end
    callback.on_train_end(numpy_logs)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/callbacks.py", line 143, in on_train_end
    visualize_spectrogram(spec_to_vis, self.sr, name)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/helpers.py", line 64, in visualize_spectrogram
    cmap="coolwarm"
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/librosa/display.py", line 848, in specshow
    out = axes.pcolormesh(x_coords, y_coords, data, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/matplotlib/__init__.py", line 1599, in inner
    return func(ax, *map(sanitize_sequence, args), **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/matplotlib/axes/_axes.py", line 6165, in pcolormesh
    X, Y, C = self._pcolorargs('pcolormesh', *args, allmatch=allmatch)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/matplotlib/axes/_axes.py", line 5734, in _pcolorargs
    numRows, numCols = C.shape
ValueError: too many values to unpack (expected 2)
wandb: Waiting for W&B process to finish, PID 32201
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_194634-18lq996y/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_194634-18lq996y/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.84581
wandb:         val_accuracy 0.76384
wandb:             _runtime 1665
wandb:           _timestamp 1624565659
wandb:                _step 213
wandb:           train_loss 0.4334
wandb:             val_loss 0.63023
wandb:           val_recall 0.92683
wandb:        val_precision 0.21111
wandb:               val_f1 0.34389
wandb:              val_auc 0.36053
wandb:                   lr 0.00013
wandb:          best_val_f1 0.4507
wandb:    best_val_accuracy 0.87296
wandb:   best_val_precision 0.31683
wandb:      best_val_recall 0.78049
wandb:             best_auc 0.31627
wandb:           best_epoch 8
wandb: Run history:
wandb:   train_accuracy ▁▅▆▃▃▆▆▇▇█▆▇▇▇▇█▇███████▇▇▇█
wandb:     val_accuracy ▁▁▂▅▁▆▆█▆▇▇▇▇▇▇█▇█▇█▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▆▆▆▄▄▄▄▃▄▃▃▃▂▁▂▁▂▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▇█▅▄▆▄▄▁▄▂▂▃▃▂▂▁▂▁▃▁▂▂▂▂▂▂▂▂
wandb:       val_recall ██▇██▅▆▁▆▃▂▅▅▄▃▃▇▄▅▃▅▄▄▆▇▆▆▆
wandb:    val_precision ▁▁▁▂▁▃▃█▄▅▆▅▄▅▅█▆▇▄▇▅▅▅▅▄▅▅▅
wandb:           val_f1 ▁▁▁▃▁▃▄█▄▆▆▅▅▆▆█▇▇▅▇▆▆▆▆▅▅▅▆
wandb:          val_auc ▄▁▅▃▃▂▅▆▄▆█▆▅▆▇▇▇▇▃▇▄▅▅▆▆▇█▇
wandb:               lr ██████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_194634-18lq996y


 See logs at ../../new_cache/conv__2250__06_1730__v39__lstm_on_5timesteps/logs/