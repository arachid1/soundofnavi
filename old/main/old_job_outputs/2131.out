Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2131
Description:  mixednet
2021-05-12 19:21:04.862635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-12 19:21:07.219333: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-12 19:21:07.220420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-12 19:21:07.283735: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:07.284708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-12 19:21:07.284759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-12 19:21:07.289519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-12 19:21:07.289657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-12 19:21:07.291145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-12 19:21:07.291537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-12 19:21:07.292961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-12 19:21:07.294165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-12 19:21:07.294386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-12 19:21:07.294563: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:07.295594: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:07.296486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2131.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2131__05_1920__v29__mixednet/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 22, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2131
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1p2y7902
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210512_192107-1p2y7902
wandb: Run `wandb offline` to turn off syncing.
2021-05-12 19:21:12.784512: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-12 19:21:12.784827: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:12.785876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-12 19:21:12.785941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-12 19:21:12.786035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-12 19:21:12.786073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-12 19:21:12.786106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-12 19:21:12.786138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-12 19:21:12.786169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-12 19:21:12.786200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-12 19:21:12.786229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-12 19:21:12.786387: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:12.787437: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:12.788349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-12 19:21:12.788423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-12 19:21:13.505465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-12 19:21:13.505506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-12 19:21:13.505514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-12 19:21:13.505815: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:13.506609: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:13.507289: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 19:21:13.507921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-12 19:21:51.255517: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-12 19:21:51.257170: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-12 19:21:52.816136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-12 19:21:53.542119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-12 19:21:53.588505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,967
Trainable params: 105,471
Non-trainable params: 496
_________________________________________________________________
Epoch 1/80
263/263 - 157s - loss: 0.5955 - accuracy: 0.7031 - val_loss: 0.5049 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19721988163976983
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.19721988163976983
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
263/263 - 149s - loss: 0.5694 - accuracy: 0.7259 - val_loss: 0.5130 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17169101163402722
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.17169101163402722
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
263/263 - 150s - loss: 0.5553 - accuracy: 0.7362 - val_loss: 0.5268 - val_accuracy: 0.7923
Confusion matrix: 
 [[858  12]
 [214   4]]
Validation f1: 3.42
Validation accuracy: 79.23
Validation recall: 1.83
Validation precision: 25.00
Validation AUC: 0.2047188785781283
Validation class accuracies: [0.9862068965517241, 0.01834862385321101]
TARGET: 0
target metric(test auc): 0.2047188785781283
column_sums: [1072   16]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
263/263 - 156s - loss: 0.5421 - accuracy: 0.7452 - val_loss: 0.5651 - val_accuracy: 0.7767
Confusion matrix: 
 [[823  47]
 [196  22]]
Validation f1: 15.33
Validation accuracy: 77.67
Validation recall: 10.09
Validation precision: 31.88
Validation AUC: 0.2345525421990477
Validation class accuracies: [0.9459770114942528, 0.10091743119266056]
TARGET: 0
target metric(test auc): 0.2345525421990477
column_sums: [1019   69]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
263/263 - 150s - loss: 0.5234 - accuracy: 0.7502 - val_loss: 0.5874 - val_accuracy: 0.7537
Confusion matrix: 
 [[801  69]
 [199  19]]
Validation f1: 12.42
Validation accuracy: 75.37
Validation recall: 8.72
Validation precision: 21.59
Validation AUC: 0.2182215593273995
Validation class accuracies: [0.9206896551724137, 0.0871559633027523]
TARGET: 0
target metric(test auc): 0.2182215593273995
column_sums: [1000   88]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
263/263 - 150s - loss: 0.4990 - accuracy: 0.7688 - val_loss: 0.5638 - val_accuracy: 0.7914
Confusion matrix: 
 [[857  13]
 [214   4]]
Validation f1: 3.40
Validation accuracy: 79.14
Validation recall: 1.83
Validation precision: 23.53
Validation AUC: 0.19864811140470318
Validation class accuracies: [0.9850574712643678, 0.01834862385321101]
TARGET: 0
target metric(test auc): 0.19864811140470318
column_sums: [1071   17]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
263/263 - 155s - loss: 0.4634 - accuracy: 0.7862 - val_loss: 0.5729 - val_accuracy: 0.7978
Confusion matrix: 
 [[867   3]
 [217   1]]
Validation f1: 0.90
Validation accuracy: 79.78
Validation recall: 0.46
Validation precision: 25.00
Validation AUC: 0.21172014306093473
Validation class accuracies: [0.996551724137931, 0.0045871559633027525]
TARGET: 0
target metric(test auc): 0.21172014306093473
column_sums: [1084    4]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
263/263 - 149s - loss: 0.4192 - accuracy: 0.8139 - val_loss: 0.7442 - val_accuracy: 0.7932
Confusion matrix: 
 [[861   9]
 [216   2]]
Validation f1: 1.75
Validation accuracy: 79.32
Validation recall: 0.92
Validation precision: 18.18
Validation AUC: 0.19190317767840037
Validation class accuracies: [0.9896551724137931, 0.009174311926605505]
TARGET: 0
target metric(test auc): 0.19190317767840037
column_sums: [1077   11]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
263/263 - 149s - loss: 0.3681 - accuracy: 0.8449 - val_loss: 0.8461 - val_accuracy: 0.6471
Confusion matrix: 
 [[635 235]
 [149  69]]
Validation f1: 26.44
Validation accuracy: 64.71
Validation recall: 31.65
Validation precision: 22.70
Validation AUC: 0.2211022665403182
Validation class accuracies: [0.7298850574712644, 0.3165137614678899]
TARGET: 0
target metric(test auc): 0.2211022665403182
column_sums: [784 304]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 10/80
263/263 - 151s - loss: 0.3223 - accuracy: 0.8737 - val_loss: 0.8245 - val_accuracy: 0.6296
Confusion matrix: 
 [[622 248]
 [155  63]]
Validation f1: 23.82
Validation accuracy: 62.96
Validation recall: 28.90
Validation precision: 20.26
Validation AUC: 0.22181447678485353
Validation class accuracies: [0.7149425287356321, 0.2889908256880734]
TARGET: 0
target metric(test auc): 0.22181447678485353
column_sums: [777 311]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 11/80
263/263 - 149s - loss: 0.2648 - accuracy: 0.9009 - val_loss: 0.8224 - val_accuracy: 0.6829
Confusion matrix: 
 [[692 178]
 [167  51]]
Validation f1: 22.82
Validation accuracy: 68.29
Validation recall: 23.39
Validation precision: 22.27
Validation AUC: 0.21697983707700116
Validation class accuracies: [0.7954022988505747, 0.23394495412844038]
TARGET: 0
target metric(test auc): 0.21697983707700116
column_sums: [859 229]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22181447678485353 hasn't increased by 0 in 1 epochs
Epoch 12/80
263/263 - 150s - loss: 0.2301 - accuracy: 0.9161 - val_loss: 0.8175 - val_accuracy: 0.7335
Confusion matrix: 
 [[759 111]
 [179  39]]
Validation f1: 21.20
Validation accuracy: 73.35
Validation recall: 17.89
Validation precision: 26.00
Validation AUC: 0.2126973435581458
Validation class accuracies: [0.8724137931034482, 0.17889908256880735]
TARGET: 0
target metric(test auc): 0.2126973435581458
column_sums: [938 150]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22181447678485353 hasn't increased by 0 in 2 epochs
Epoch 13/80
263/263 - 151s - loss: 0.1883 - accuracy: 0.9368 - val_loss: 0.8121 - val_accuracy: 0.6967
Confusion matrix: 
 [[708 162]
 [168  50]]
Validation f1: 23.26
Validation accuracy: 69.67
Validation recall: 22.94
Validation precision: 23.58
Validation AUC: 0.23054827415029183
Validation class accuracies: [0.8137931034482758, 0.22935779816513763]
TARGET: 0
target metric(test auc): 0.23054827415029183
column_sums: [876 212]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 14/80
263/263 - 150s - loss: 0.1679 - accuracy: 0.9423 - val_loss: 0.9230 - val_accuracy: 0.6287
Confusion matrix: 
 [[619 251]
 [153  65]]
Validation f1: 24.34
Validation accuracy: 62.87
Validation recall: 29.82
Validation precision: 20.57
Validation AUC: 0.21257183417657738
Validation class accuracies: [0.7114942528735633, 0.2981651376146789]
TARGET: 0
target metric(test auc): 0.21257183417657738
column_sums: [772 316]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.23054827415029183 hasn't increased by 0 in 1 epochs
Epoch 15/80
263/263 - 150s - loss: 0.1358 - accuracy: 0.9590 - val_loss: 0.9279 - val_accuracy: 0.7748
Confusion matrix: 
 [[812  58]
 [187  31]]
Validation f1: 20.20
Validation accuracy: 77.48
Validation recall: 14.22
Validation precision: 34.83
Validation AUC: 0.23217899379656656
Validation class accuracies: [0.9333333333333333, 0.14220183486238533]
TARGET: 0
target metric(test auc): 0.23217899379656656
column_sums: [999  89]
cm_sum: 1088
The training is defaulting to either class.
Epoch 16/80
263/263 - 150s - loss: 0.1200 - accuracy: 0.9616 - val_loss: 0.9403 - val_accuracy: 0.6949
Confusion matrix: 
 [[702 168]
 [164  54]]
Validation f1: 24.55
Validation accuracy: 69.49
Validation recall: 24.77
Validation precision: 24.32
Validation AUC: 0.2273927714152865
Validation class accuracies: [0.8068965517241379, 0.24770642201834864]
TARGET: 0
target metric(test auc): 0.2273927714152865
column_sums: [866 222]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.23054827415029183 hasn't increased by 0 in 2 epochs
Epoch 17/80
263/263 - 150s - loss: 0.1016 - accuracy: 0.9664 - val_loss: 1.1357 - val_accuracy: 0.7831
Confusion matrix: 
 [[837  33]
 [203  15]]
Validation f1: 11.28
Validation accuracy: 78.31
Validation recall: 6.88
Validation precision: 31.25
Validation AUC: 0.2325521274480789
Validation class accuracies: [0.9620689655172414, 0.06880733944954129]
TARGET: 0
target metric(test auc): 0.2325521274480789
column_sums: [1040   48]
cm_sum: 1088
The training is defaulting to either class.
Epoch 18/80
263/263 - 150s - loss: 0.1011 - accuracy: 0.9685 - val_loss: 1.1287 - val_accuracy: 0.7739
Confusion matrix: 
 [[832  38]
 [208  10]]
Validation f1: 7.52
Validation accuracy: 77.39
Validation recall: 4.59
Validation precision: 20.83
Validation AUC: 0.21402876615255573
Validation class accuracies: [0.9563218390804598, 0.045871559633027525]
TARGET: 0
target metric(test auc): 0.21402876615255573
column_sums: [1040   48]
cm_sum: 1088
The training is defaulting to either class.
Epoch 19/80
263/263 - 150s - loss: 0.0818 - accuracy: 0.9766 - val_loss: 1.0102 - val_accuracy: 0.6737
Confusion matrix: 
 [[676 194]
 [161  57]]
Validation f1: 24.31
Validation accuracy: 67.37
Validation recall: 26.15
Validation precision: 22.71
Validation AUC: 0.2308301911392463
Validation class accuracies: [0.7770114942528735, 0.26146788990825687]
TARGET: 0
target metric(test auc): 0.2308301911392463
column_sums: [837 251]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 20/80
263/263 - 149s - loss: 0.0725 - accuracy: 0.9781 - val_loss: 1.1987 - val_accuracy: 0.7610
Confusion matrix: 
 [[813  57]
 [203  15]]
Validation f1: 10.34
Validation accuracy: 76.10
Validation recall: 6.88
Validation precision: 20.83
Validation AUC: 0.1941859736503369
Validation class accuracies: [0.9344827586206896, 0.06880733944954129]
TARGET: 0
target metric(test auc): 0.1941859736503369
column_sums: [1016   72]
cm_sum: 1088
The training is defaulting to either class.
Epoch 21/80
263/263 - 150s - loss: 0.0677 - accuracy: 0.9774 - val_loss: 1.1412 - val_accuracy: 0.6314
Confusion matrix: 
 [[620 250]
 [151  67]]
Validation f1: 25.05
Validation accuracy: 63.14
Validation recall: 30.73
Validation precision: 21.14
Validation AUC: 0.2223684058793885
Validation class accuracies: [0.7126436781609196, 0.3073394495412844]
TARGET: 0
target metric(test auc): 0.2223684058793885
column_sums: [771 317]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 1 epochs
Epoch 22/80
263/263 - 150s - loss: 0.0592 - accuracy: 0.9864 - val_loss: 1.1095 - val_accuracy: 0.7298
Confusion matrix: 
 [[757 113]
 [181  37]]
Validation f1: 20.11
Validation accuracy: 72.98
Validation recall: 16.97
Validation precision: 24.67
Validation AUC: 0.2125640664206605
Validation class accuracies: [0.8701149425287357, 0.16972477064220184]
TARGET: 0
target metric(test auc): 0.2125640664206605
column_sums: [938 150]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 2 epochs
Epoch 23/80
263/263 - 151s - loss: 0.0537 - accuracy: 0.9878 - val_loss: 1.0874 - val_accuracy: 0.6857
Confusion matrix: 
 [[694 176]
 [166  52]]
Validation f1: 23.32
Validation accuracy: 68.57
Validation recall: 23.85
Validation precision: 22.81
Validation AUC: 0.2214534079997577
Validation class accuracies: [0.7977011494252874, 0.23853211009174313]
TARGET: 0
target metric(test auc): 0.2214534079997577
column_sums: [860 228]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 3 epochs
Epoch 24/80
263/263 - 150s - loss: 0.0509 - accuracy: 0.9869 - val_loss: 1.1872 - val_accuracy: 0.6820
Confusion matrix: 
 [[695 175]
 [171  47]]
Validation f1: 21.36
Validation accuracy: 68.20
Validation recall: 21.56
Validation precision: 21.17
Validation AUC: 0.22565395206197858
Validation class accuracies: [0.7988505747126436, 0.21559633027522937]
TARGET: 0
target metric(test auc): 0.22565395206197858
column_sums: [866 222]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 4 epochs
Epoch 25/80
263/263 - 150s - loss: 0.0482 - accuracy: 0.9871 - val_loss: 1.1334 - val_accuracy: 0.6967
Confusion matrix: 
 [[713 157]
 [173  45]]
Validation f1: 21.43
Validation accuracy: 69.67
Validation recall: 20.64
Validation precision: 22.28
Validation AUC: 0.2257449963620403
Validation class accuracies: [0.8195402298850575, 0.20642201834862386]
TARGET: 0
target metric(test auc): 0.2257449963620403
column_sums: [886 202]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 5 epochs
Epoch 26/80
263/263 - 150s - loss: 0.0378 - accuracy: 0.9924 - val_loss: 1.1403 - val_accuracy: 0.7390
Confusion matrix: 
 [[771  99]
 [185  33]]
Validation f1: 18.86
Validation accuracy: 73.90
Validation recall: 15.14
Validation precision: 25.00
Validation AUC: 0.22307974757807308
Validation class accuracies: [0.8862068965517241, 0.15137614678899083]
TARGET: 0
target metric(test auc): 0.22307974757807308
column_sums: [956 132]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 6 epochs
Epoch 27/80
263/263 - 168s - loss: 0.0342 - accuracy: 0.9921 - val_loss: 1.2477 - val_accuracy: 0.7757
Confusion matrix: 
 [[821  49]
 [195  23]]
Validation f1: 15.86
Validation accuracy: 77.57
Validation recall: 10.55
Validation precision: 31.94
Validation AUC: 0.22066141942760187
Validation class accuracies: [0.9436781609195403, 0.10550458715596331]
TARGET: 0
target metric(test auc): 0.22066141942760187
column_sums: [1016   72]
cm_sum: 1088
The training is defaulting to either class.
Epoch 28/80
263/263 - 151s - loss: 0.0359 - accuracy: 0.9907 - val_loss: 1.1599 - val_accuracy: 0.7086
Confusion matrix: 
 [[729 141]
 [176  42]]
Validation f1: 20.95
Validation accuracy: 70.86
Validation recall: 19.27
Validation precision: 22.95
Validation AUC: 0.22220628048124758
Validation class accuracies: [0.8379310344827586, 0.1926605504587156]
TARGET: 0
target metric(test auc): 0.22220628048124758
column_sums: [905 183]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 7 epochs
Epoch 29/80
263/263 - 150s - loss: 0.0328 - accuracy: 0.9926 - val_loss: 1.1552 - val_accuracy: 0.7270
Confusion matrix: 
 [[752 118]
 [179  39]]
Validation f1: 20.80
Validation accuracy: 72.70
Validation recall: 17.89
Validation precision: 24.84
Validation AUC: 0.2231476223816094
Validation class accuracies: [0.864367816091954, 0.17889908256880735]
TARGET: 0
target metric(test auc): 0.2231476223816094
column_sums: [931 157]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 8 epochs
Epoch 30/80
263/263 - 149s - loss: 0.0343 - accuracy: 0.9926 - val_loss: 1.1557 - val_accuracy: 0.7086
Confusion matrix: 
 [[728 142]
 [175  43]]
Validation f1: 21.34
Validation accuracy: 70.86
Validation recall: 19.72
Validation precision: 23.24
Validation AUC: 0.22291738657432705
Validation class accuracies: [0.8367816091954023, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.22291738657432705
column_sums: [903 185]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 9 epochs
Epoch 31/80
263/263 - 150s - loss: 0.0323 - accuracy: 0.9938 - val_loss: 1.1593 - val_accuracy: 0.7169
Confusion matrix: 
 [[740 130]
 [178  40]]
Validation f1: 20.62
Validation accuracy: 71.69
Validation recall: 18.35
Validation precision: 23.53
Validation AUC: 0.2210486210424882
Validation class accuracies: [0.8505747126436781, 0.1834862385321101]
TARGET: 0
target metric(test auc): 0.2210486210424882
column_sums: [918 170]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 10 epochs
Epoch 32/80
263/263 - 150s - loss: 0.0369 - accuracy: 0.9914 - val_loss: 1.1654 - val_accuracy: 0.7004
Confusion matrix: 
 [[719 151]
 [175  43]]
Validation f1: 20.87
Validation accuracy: 70.04
Validation recall: 19.72
Validation precision: 22.16
Validation AUC: 0.22318846568647502
Validation class accuracies: [0.8264367816091954, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.22318846568647502
column_sums: [894 194]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 11 epochs
Epoch 33/80
263/263 - 150s - loss: 0.0329 - accuracy: 0.9929 - val_loss: 1.1639 - val_accuracy: 0.7215
Confusion matrix: 
 [[746 124]
 [179  39]]
Validation f1: 20.47
Validation accuracy: 72.15
Validation recall: 17.89
Validation precision: 23.93
Validation AUC: 0.2207584050382156
Validation class accuracies: [0.8574712643678161, 0.17889908256880735]
TARGET: 0
target metric(test auc): 0.2207584050382156
column_sums: [925 163]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 12 epochs
Epoch 34/80
263/263 - 149s - loss: 0.0307 - accuracy: 0.9936 - val_loss: 1.1620 - val_accuracy: 0.7077
Confusion matrix: 
 [[728 142]
 [176  42]]
Validation f1: 20.90
Validation accuracy: 70.77
Validation recall: 19.27
Validation precision: 22.83
Validation AUC: 0.2218384796533145
Validation class accuracies: [0.8367816091954023, 0.1926605504587156]
TARGET: 0
target metric(test auc): 0.2218384796533145
column_sums: [904 184]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 13 epochs
Epoch 35/80
263/263 - 155s - loss: 0.0304 - accuracy: 0.9943 - val_loss: 1.1626 - val_accuracy: 0.7132
Confusion matrix: 
 [[733 137]
 [175  43]]
Validation f1: 21.61
Validation accuracy: 71.32
Validation recall: 19.72
Validation precision: 23.89
Validation AUC: 0.22324630088756775
Validation class accuracies: [0.8425287356321839, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.22324630088756775
column_sums: [908 180]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 14 epochs
Epoch 36/80
263/263 - 149s - loss: 0.0370 - accuracy: 0.9902 - val_loss: 1.1561 - val_accuracy: 0.7114
Confusion matrix: 
 [[731 139]
 [175  43]]
Validation f1: 21.50
Validation accuracy: 71.14
Validation recall: 19.72
Validation precision: 23.63
Validation AUC: 0.22250660593996602
Validation class accuracies: [0.8402298850574713, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.22250660593996602
column_sums: [906 182]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 15 epochs
Epoch 37/80
263/263 - 152s - loss: 0.0296 - accuracy: 0.9933 - val_loss: 1.1605 - val_accuracy: 0.7123
Confusion matrix: 
 [[732 138]
 [175  43]]
Validation f1: 21.55
Validation accuracy: 71.23
Validation recall: 19.72
Validation precision: 23.76
Validation AUC: 0.22308181319902154
Validation class accuracies: [0.8413793103448276, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.22308181319902154
column_sums: [907 181]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 16 epochs
Epoch 38/80
263/263 - 161s - loss: 0.0295 - accuracy: 0.9952 - val_loss: 1.1633 - val_accuracy: 0.7197
Confusion matrix: 
 [[742 128]
 [177  41]]
Validation f1: 21.19
Validation accuracy: 71.97
Validation recall: 18.81
Validation precision: 24.26
Validation AUC: 0.22107670489921563
Validation class accuracies: [0.8528735632183908, 0.18807339449541285]
TARGET: 0
target metric(test auc): 0.22107670489921563
column_sums: [919 169]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 17 epochs
Epoch 39/80
263/263 - 149s - loss: 0.0319 - accuracy: 0.9921 - val_loss: 1.1688 - val_accuracy: 0.7022
Confusion matrix: 
 [[721 149]
 [175  43]]
Validation f1: 20.98
Validation accuracy: 70.22
Validation recall: 19.72
Validation precision: 22.40
Validation AUC: 0.22116225394253064
Validation class accuracies: [0.828735632183908, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.22116225394253064
column_sums: [896 192]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 18 epochs
Epoch 40/80
263/263 - 149s - loss: 0.0282 - accuracy: 0.9959 - val_loss: 1.1609 - val_accuracy: 0.7151
Confusion matrix: 
 [[735 135]
 [175  43]]
Validation f1: 21.72
Validation accuracy: 71.51
Validation recall: 19.72
Validation precision: 24.16
Validation AUC: 0.2219075807758114
Validation class accuracies: [0.8448275862068966, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.2219075807758114
column_sums: [910 178]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 19 epochs
Epoch 41/80
263/263 - 154s - loss: 0.0335 - accuracy: 0.9938 - val_loss: 1.1670 - val_accuracy: 0.7068
Confusion matrix: 
 [[726 144]
 [175  43]]
Validation f1: 21.23
Validation accuracy: 70.68
Validation recall: 19.72
Validation precision: 22.99
Validation AUC: 0.22204397653427746
Validation class accuracies: [0.8344827586206897, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.22204397653427746
column_sums: [901 187]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 20 epochs
Epoch 42/80
263/263 - 150s - loss: 0.0309 - accuracy: 0.9943 - val_loss: 1.1619 - val_accuracy: 0.7142
Confusion matrix: 
 [[735 135]
 [176  42]]
Validation f1: 21.27
Validation accuracy: 71.42
Validation recall: 19.27
Validation precision: 23.73
Validation AUC: 0.22238755905570703
Validation class accuracies: [0.8448275862068966, 0.1926605504587156]
TARGET: 0
target metric(test auc): 0.22238755905570703
column_sums: [911 177]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2308301911392463 hasn't increased by 0 in 21 epochs
Epoch 43/80
263/263 - 149s - loss: 0.0278 - accuracy: 0.9952 - val_loss: 1.1624 - val_accuracy: 0.7086
Confusion matrix: 
 [[728 142]
 [175  43]]
Validation f1: 21.34
Validation accuracy: 70.86
Validation recall: 19.72
Validation precision: 23.24
Validation AUC: 0.22220611524740294
Validation class accuracies: [0.8367816091954023, 0.19724770642201836]

The metrics for the epoch with the best target metric are: 
Best cm: [[676 194]
 [161  57]]
Best f1: 0.24307036247334754
Best accuracy: 0.6737132352941176
Best recall: 0.26146788990825687
Best precision: 0.22709163346613545
Best AUC: 0.2308301911392463
Best epoch: 19
TARGET: 0
target metric(test auc): 0.22220611524740294
column_sums: [903 185]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 10
Starting...
CM: [[14 46]
 [ 2 13]]
F1: 0.3513513513513513
AUC: 0.5568361581920905
Accuracy: 0.36
Precision: 0.22033898305084745
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2131__05_1920__v29__mixednet/validation_sheet_10.xls...
Done.
Epoch: 13
Starting...
CM: [[21 39]
 [ 2 13]]
F1: 0.3880597014925373
AUC: 0.5716666666666668
Accuracy: 0.4533333333333333
Precision: 0.25
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2131__05_1920__v29__mixednet/validation_sheet_13.xls...
Done.
Epoch: 19
Starting...
CM: [[15 45]
 [ 1 14]]
F1: 0.37837837837837834
AUC: 0.5919774011299436
Accuracy: 0.38666666666666666
Precision: 0.23728813559322035
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2131__05_1920__v29__mixednet/validation_sheet_19.xls...
Done.
Epoch: 80
Starting...
CM: [[23 37]
 [ 6  9]]
F1: 0.29508196721311475
AUC: 0.43782608695652175
Accuracy: 0.4266666666666667
Precision: 0.1956521739130435
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2131__05_1920__v29__mixednet/validation_sheet_80.xls...
Done.
Epoch: 9
Starting...
CM: [[17 43]
 [ 3 12]]
F1: 0.34285714285714286
AUC: 0.5290909090909091
Accuracy: 0.38666666666666666
Precision: 0.21818181818181817
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2131__05_1920__v29__mixednet/validation_sheet_9.xls...
Done.
wandb: Waiting for W&B process to finish, PID 31986
wandb: Program ended successfully.
wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: / 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: - 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: \ 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: / 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210512_192107-1p2y7902/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210512_192107-1p2y7902/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99523
wandb:         val_accuracy 0.70864
wandb:             _runtime 7403
wandb:           _timestamp 1620854670
wandb:                _step 308
wandb:           train_loss 0.02777
wandb:             val_loss 1.16239
wandb:           val_recall 0.19725
wandb:        val_precision 0.23243
wandb:               val_f1 0.2134
wandb:              val_auc 0.22221
wandb:                   lr 0.0
wandb:          best_val_f1 0.24307
wandb:    best_val_accuracy 0.67371
wandb:   best_val_precision 0.22709
wandb:      best_val_recall 0.26147
wandb:             best_auc 0.23083
wandb:           best_epoch 19
wandb:           best_bd_f1 0.37838
wandb:          best_bd_auc 0.59198
wandb:     best_bd_accuracy 0.38667
wandb:    best_bd_precision 0.23729
wandb:       best_bd_recall 0.93333
wandb:        best_bd_epoch 19
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▃▃▄▄▅▆▆▇▇▇▇▇███████████████████████
wandb:     val_accuracy ███▇▆███▂▁▃▅▄▇▄▇▇▃▆▁▅▃▃▄▆▇▅▄▅▄▅▄▄▄▄▅▄▅▄▄
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ███▇▇▇▆▆▅▅▄▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▂▂▂▂▃▄▄▄▄▄▅▅▇▇▆█▇▇▆▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:       val_recall ▁▁▁▃▃▁▁▁█▇▆▅▆▄▆▃▂▇▃█▅▆▆▆▄▃▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:    val_precision ▁▁▆▇▅▆▆▅▆▅▅▆▆█▆▇▅▆▅▅▆▆▅▅▆▇▆▆▆▅▆▆▆▆▆▆▆▆▆▆
wandb:           val_f1 ▁▁▂▅▄▂▁▁█▇▇▇▇▆▇▄▃▇▄█▆▇▇▇▆▅▇▇▆▇▆▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▄▁▅█▆▄▅▃▇▇▆▆██▇█▆█▄▇▆▇▇▇▇▆▇▇▆▇▆▇▇▇▇▆▇▇▇▇
wandb:               lr ███████████████████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 8 media file(s), 8 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2131: https://wandb.ai/arachid1/tensorboard-integration/runs/1p2y7902


 See logs at ../../new_cache/conv__2131__05_1920__v29__mixednet/logs/