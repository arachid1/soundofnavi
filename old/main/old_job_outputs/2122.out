Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2122
Description:  mod9_newparams
2021-05-10 20:45:02.485094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 20:45:04.787576: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 20:45:04.788563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-10 20:45:04.838963: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:04.839669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 20:45:04.839697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 20:45:04.843212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 20:45:04.843297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 20:45:04.844370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 20:45:04.844711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 20:45:04.845856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 20:45:04.846867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 20:45:04.847032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 20:45:04.847140: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:04.847892: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:04.848543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2122.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2122__05_2011__v29__mod9_newparams/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 12, 5.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2122
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/3gnk0oyb
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_204505-3gnk0oyb
wandb: Run `wandb offline` to turn off syncing.
2021-05-10 20:45:10.026996: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 20:45:10.027266: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:10.028038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 20:45:10.028079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 20:45:10.028130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 20:45:10.028156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 20:45:10.028175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 20:45:10.028216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 20:45:10.028236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 20:45:10.028255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 20:45:10.028274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 20:45:10.028368: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:10.029100: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:10.029779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-10 20:45:10.029822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 20:45:10.767908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-10 20:45:10.767956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-10 20:45:10.767964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-10 20:45:10.768267: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:10.769051: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:10.769802: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 20:45:10.770547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-10 20:45:47.521248: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-10 20:45:47.522852: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-10 20:45:50.518222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 20:45:51.255565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 20:45:51.265583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
263/263 - 507s - loss: 0.7274 - accuracy: 0.5529 - val_loss: 0.6279 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2660219101314304
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.2660219101314304
Saving model...
Epoch 2/40
263/263 - 497s - loss: 0.6872 - accuracy: 0.5717 - val_loss: 0.7834 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2035060690126696
Validation class accuracies: [0.0, 1.0]
TARGET: 0
target metric(test auc): 0.2035060690126696
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 1 epochs
Epoch 3/40
263/263 - 499s - loss: 0.6877 - accuracy: 0.5779 - val_loss: 1.0546 - val_accuracy: 0.7987
Confusion matrix: 
 [[863   7]
 [212   6]]
Validation f1: 5.19
Validation accuracy: 79.87
Validation recall: 2.75
Validation precision: 46.15
Validation AUC: 0.25309942884738723
Validation class accuracies: [0.9919540229885058, 0.027522935779816515]
TARGET: 0
target metric(test auc): 0.25309942884738723
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 2 epochs
Epoch 4/40
263/263 - 498s - loss: 0.6853 - accuracy: 0.5465 - val_loss: 0.7106 - val_accuracy: 0.2335
Confusion matrix: 
 [[ 65 805]
 [ 29 189]]
Validation f1: 31.19
Validation accuracy: 23.35
Validation recall: 86.70
Validation precision: 19.01
Validation AUC: 0.17023806637894412
Validation class accuracies: [0.07471264367816093, 0.8669724770642202]
TARGET: 0
target metric(test auc): 0.17023806637894412
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 3 epochs
Epoch 5/40
263/263 - 497s - loss: 0.6827 - accuracy: 0.5748 - val_loss: 0.8485 - val_accuracy: 0.4164
Confusion matrix: 
 [[315 555]
 [ 80 138]]
Validation f1: 30.30
Validation accuracy: 41.64
Validation recall: 63.30
Validation precision: 19.91
Validation AUC: 0.20969797865300904
Validation class accuracies: [0.3620689655172414, 0.6330275229357798]
TARGET: 0
target metric(test auc): 0.20969797865300904
Lr has been adjusted to 0.000750000006519258
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 4 epochs
Epoch 6/40
263/263 - 498s - loss: 0.6811 - accuracy: 0.5720 - val_loss: 0.6358 - val_accuracy: 0.7950
Confusion matrix: 
 [[860  10]
 [213   5]]
Validation f1: 4.29
Validation accuracy: 79.50
Validation recall: 2.29
Validation precision: 33.33
Validation AUC: 0.18583840717181596
Validation class accuracies: [0.9885057471264368, 0.022935779816513763]
TARGET: 0
target metric(test auc): 0.18583840717181596
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 5 epochs
Epoch 7/40
263/263 - 497s - loss: 0.6786 - accuracy: 0.6127 - val_loss: 0.6522 - val_accuracy: 0.7381
Confusion matrix: 
 [[782  88]
 [197  21]]
Validation f1: 12.84
Validation accuracy: 73.81
Validation recall: 9.63
Validation precision: 19.27
Validation AUC: 0.23213174042657608
Validation class accuracies: [0.8988505747126436, 0.0963302752293578]
TARGET: 0
target metric(test auc): 0.23213174042657608
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 6 epochs
Epoch 8/40
263/263 - 499s - loss: 0.6766 - accuracy: 0.5953 - val_loss: 0.6781 - val_accuracy: 0.6268
Confusion matrix: 
 [[636 234]
 [172  46]]
Validation f1: 18.47
Validation accuracy: 62.68
Validation recall: 21.10
Validation precision: 16.43
Validation AUC: 0.19169202327495496
Validation class accuracies: [0.7310344827586207, 0.21100917431192662]
TARGET: 0
target metric(test auc): 0.19169202327495496
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 7 epochs
Epoch 9/40
263/263 - 499s - loss: 0.6761 - accuracy: 0.6001 - val_loss: 0.6497 - val_accuracy: 0.7693
Confusion matrix: 
 [[828  42]
 [209   9]]
Validation f1: 6.69
Validation accuracy: 76.93
Validation recall: 4.13
Validation precision: 17.65
Validation AUC: 0.21515660994163505
Validation class accuracies: [0.9517241379310345, 0.04128440366972477]
TARGET: 0
target metric(test auc): 0.21515660994163505
Lr has been adjusted to 0.0005624999757856131
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 8 epochs
Epoch 10/40
263/263 - 497s - loss: 0.6734 - accuracy: 0.6189 - val_loss: 0.6571 - val_accuracy: 0.7215
Confusion matrix: 
 [[760 110]
 [193  25]]
Validation f1: 14.16
Validation accuracy: 72.15
Validation recall: 11.47
Validation precision: 18.52
Validation AUC: 0.22533735189843263
Validation class accuracies: [0.8735632183908046, 0.11467889908256881]
TARGET: 0
target metric(test auc): 0.22533735189843263
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 9 epochs
Epoch 11/40
263/263 - 496s - loss: 0.6697 - accuracy: 0.6363 - val_loss: 0.6409 - val_accuracy: 0.7767
Confusion matrix: 
 [[830  40]
 [203  15]]
Validation f1: 10.99
Validation accuracy: 77.67
Validation recall: 6.88
Validation precision: 27.27
Validation AUC: 0.21926811205771612
Validation class accuracies: [0.9540229885057471, 0.06880733944954129]
TARGET: 0
target metric(test auc): 0.21926811205771612
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 10 epochs
Epoch 12/40
263/263 - 496s - loss: 0.6687 - accuracy: 0.6366 - val_loss: 0.6647 - val_accuracy: 0.6700
Confusion matrix: 
 [[671 199]
 [160  58]]
Validation f1: 24.42
Validation accuracy: 67.00
Validation recall: 26.61
Validation precision: 22.57
Validation AUC: 0.2111060994317533
Validation class accuracies: [0.771264367816092, 0.26605504587155965]
TARGET: 0
target metric(test auc): 0.2111060994317533
The validation tracker metric at 0.2660219101314304 hasn't increased by 0.05 in 11 epochs
Epoch 13/40
263/263 - 499s - loss: 0.6664 - accuracy: 0.6523 - val_loss: 0.6893 - val_accuracy: 0.6057
Confusion matrix: 
 [[617 253]
 [176  42]]
Validation f1: 16.37
Validation accuracy: 60.57
Validation recall: 19.27
Validation precision: 14.24
Validation AUC: 0.16883196585400817
Validation class accuracies: [0.7091954022988506, 0.1926605504587156]

The metrics for the epoch with the best target metric are: 
Best cm: [[870   0]
 [218   0]]
Best f1: 0.0
Best accuracy: 0.7996323529411765
Best recall: 0.0
Best precision: 0.0
Best AUC: 0.2660219101314304
Best epoch: 1
TARGET: 0
target metric(test auc): 0.16883196585400817
Lr has been adjusted to 0.0004218749818392098
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 1
Starting...
CM: [[60  0]
 [15  0]]
F1: 0.0
AUC: 0.6
Accuracy: 0.8
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2122__05_2011__v29__mod9_newparams/validation_sheet_1.xls...
Done.
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2122.py", line 378, in <module>
    train_model(**arguments)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2122.py", line 333, in train_model
    if target_metric > best_bd_target_metric:
TypeError: '>' not supported between instances of 'function' and 'int'
wandb: Waiting for W&B process to finish, PID 1821
wandb: Program failed with code 1.  Press ctrl-c to abort syncing.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_204505-3gnk0oyb/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_204505-3gnk0oyb/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.65229
wandb:         val_accuracy 0.6057
wandb:             _runtime 6809
wandb:           _timestamp 1620686314
wandb:                _step 91
wandb:           train_loss 0.66643
wandb:             val_loss 0.68926
wandb:           val_recall 0.19266
wandb:        val_precision 0.14237
wandb:               val_f1 0.16374
wandb:              val_auc 0.16883
wandb:                   lr 0.00056
wandb:          best_val_f1 0.0
wandb:    best_val_accuracy 0.79963
wandb:   best_val_precision 0.0
wandb:      best_val_recall 0.0
wandb:             best_auc 0.26602
wandb:           best_epoch 1
wandb: Run history:
wandb:   train_accuracy ▁▃▃▁▃▃▅▄▅▆▇▇█
wandb:     val_accuracy █▁█▁▄█▇▆█▇█▆▆
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▃▃▃▃▃▂▂▂▂▁▁▁
wandb:         val_loss ▁▄█▂▅▁▁▂▁▁▁▂▂
wandb:       val_recall ▁█▁▇▅▁▂▂▁▂▁▃▂
wandb:    val_precision ▁▄█▄▄▆▄▃▄▄▅▄▃
wandb:           val_f1 ▁█▂█▇▂▄▅▂▄▃▆▄
wandb:          val_auc █▃▇▁▄▂▆▃▄▅▅▄▁
wandb:               lr █████▄▄▄▄▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2122: https://wandb.ai/arachid1/tensorboard-integration/runs/3gnk0oyb


 See logs at ../../new_cache/conv__2122__05_2011__v29__mod9_newparams/logs/