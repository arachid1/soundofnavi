Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2128
Description:  model9_undersampled
2021-05-11 19:20:59.065465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 19:21:01.857766: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 19:21:01.858848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-11 19:21:01.914120: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:01.914946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 19:21:01.914984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 19:21:01.918985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 19:21:01.919106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 19:21:01.920295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 19:21:01.920622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 19:21:01.921762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 19:21:01.922789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 19:21:01.922970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 19:21:01.923133: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:01.924020: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:01.924748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2128.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2128__05_1920__v29__model9_undersampled/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 22, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2128
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2h14ehu2
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_192102-2h14ehu2
wandb: Run `wandb offline` to turn off syncing.
2021-05-11 19:21:08.127881: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 19:21:08.128246: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:08.129388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 19:21:08.129459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 19:21:08.129561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 19:21:08.129601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 19:21:08.129641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 19:21:08.129679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 19:21:08.129710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 19:21:08.129747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 19:21:08.129827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 19:21:08.129995: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:08.131194: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:08.132223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-11 19:21:08.132298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 19:21:09.132774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-11 19:21:09.132842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-11 19:21:09.132857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-11 19:21:09.133312: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:09.134604: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:09.135763: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 19:21:09.136810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-11 19:21:56.715502: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-11 19:21:56.717303: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-11 19:22:00.765894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 19:22:01.711520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 19:22:01.723311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
1150
1150
With concat = False and six = False, size of training set: 2300...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/50
144/144 - 303s - loss: 0.7807 - accuracy: 0.5157 - val_loss: 0.7757 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2573631764414614
Validation class accuracies: [0.0, 1.0]
TARGET: 0
target metric(test auc): 0.2573631764414614
Saving model...
Epoch 2/50
144/144 - 291s - loss: 0.7015 - accuracy: 0.5304 - val_loss: 0.7946 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2354119675948349
Validation class accuracies: [0.0, 1.0]
TARGET: 0
target metric(test auc): 0.2354119675948349
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 1 epochs
Epoch 3/50
144/144 - 293s - loss: 0.6962 - accuracy: 0.5426 - val_loss: 0.8389 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.24286367243876317
Validation class accuracies: [0.0, 1.0]
TARGET: 0
target metric(test auc): 0.24286367243876317
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 2 epochs
Epoch 4/50
144/144 - 293s - loss: 0.6881 - accuracy: 0.5417 - val_loss: 0.8471 - val_accuracy: 0.2022
Confusion matrix: 
 [[  4 866]
 [  2 216]]
Validation f1: 33.23
Validation accuracy: 20.22
Validation recall: 99.08
Validation precision: 19.96
Validation AUC: 0.1922307922698251
Validation class accuracies: [0.004597701149425287, 0.9908256880733946]
TARGET: 0
target metric(test auc): 0.1922307922698251
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 3 epochs
Epoch 5/50
144/144 - 292s - loss: 0.6861 - accuracy: 0.5522 - val_loss: 0.6798 - val_accuracy: 0.6250
Confusion matrix: 
 [[603 267]
 [141  77]]
Validation f1: 27.40
Validation accuracy: 62.50
Validation recall: 35.32
Validation precision: 22.38
Validation AUC: 0.2202661166059896
Validation class accuracies: [0.6931034482758621, 0.3532110091743119]
TARGET: 0
target metric(test auc): 0.2202661166059896
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 4 epochs
Epoch 6/50
144/144 - 292s - loss: 0.6657 - accuracy: 0.5922 - val_loss: 0.8291 - val_accuracy: 0.3263
Confusion matrix: 
 [[206 664]
 [ 69 149]]
Validation f1: 28.90
Validation accuracy: 32.63
Validation recall: 68.35
Validation precision: 18.33
Validation AUC: 0.18820517445748608
Validation class accuracies: [0.2367816091954023, 0.6834862385321101]
TARGET: 0
target metric(test auc): 0.18820517445748608
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 5 epochs
Epoch 7/50
144/144 - 293s - loss: 0.6592 - accuracy: 0.5835 - val_loss: 0.7342 - val_accuracy: 0.4274
Confusion matrix: 
 [[303 567]
 [ 56 162]]
Validation f1: 34.21
Validation accuracy: 42.74
Validation recall: 74.31
Validation precision: 22.22
Validation AUC: 0.20660806160685657
Validation class accuracies: [0.3482758620689655, 0.7431192660550459]
TARGET: 0
target metric(test auc): 0.20660806160685657
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 6 epochs
Epoch 8/50
144/144 - 292s - loss: 0.6546 - accuracy: 0.6039 - val_loss: 0.6234 - val_accuracy: 0.6618
Confusion matrix: 
 [[649 221]
 [147  71]]
Validation f1: 27.84
Validation accuracy: 66.18
Validation recall: 32.57
Validation precision: 24.32
Validation AUC: 0.23801509381674535
Validation class accuracies: [0.7459770114942529, 0.3256880733944954]
TARGET: 0
target metric(test auc): 0.23801509381674535
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 7 epochs
Epoch 9/50
144/144 - 291s - loss: 0.6511 - accuracy: 0.6043 - val_loss: 0.7446 - val_accuracy: 0.4945
Confusion matrix: 
 [[419 451]
 [ 99 119]]
Validation f1: 30.20
Validation accuracy: 49.45
Validation recall: 54.59
Validation precision: 20.88
Validation AUC: 0.20739179302228933
Validation class accuracies: [0.48160919540229885, 0.5458715596330275]
TARGET: 0
target metric(test auc): 0.20739179302228933
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 8 epochs
Epoch 10/50
144/144 - 290s - loss: 0.6410 - accuracy: 0.6291 - val_loss: 0.7317 - val_accuracy: 0.4623
Confusion matrix: 
 [[378 492]
 [ 93 125]]
Validation f1: 29.94
Validation accuracy: 46.23
Validation recall: 57.34
Validation precision: 20.26
Validation AUC: 0.205052705295205
Validation class accuracies: [0.43448275862068964, 0.573394495412844]
TARGET: 0
target metric(test auc): 0.205052705295205
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 9 epochs
Epoch 11/50
144/144 - 290s - loss: 0.6391 - accuracy: 0.6274 - val_loss: 0.7486 - val_accuracy: 0.4439
Confusion matrix: 
 [[346 524]
 [ 81 137]]
Validation f1: 31.17
Validation accuracy: 44.39
Validation recall: 62.84
Validation precision: 20.73
Validation AUC: 0.20524432461405726
Validation class accuracies: [0.39770114942528734, 0.6284403669724771]
TARGET: 0
target metric(test auc): 0.20524432461405726
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 10 epochs
Epoch 12/50
144/144 - 290s - loss: 0.6361 - accuracy: 0.6448 - val_loss: 0.7510 - val_accuracy: 0.4632
Confusion matrix: 
 [[374 496]
 [ 88 130]]
Validation f1: 30.81
Validation accuracy: 46.32
Validation recall: 59.63
Validation precision: 20.77
Validation AUC: 0.1991233414400783
Validation class accuracies: [0.4298850574712644, 0.5963302752293578]
TARGET: 0
target metric(test auc): 0.1991233414400783
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 11 epochs
Epoch 13/50
144/144 - 289s - loss: 0.6280 - accuracy: 0.6409 - val_loss: 0.7838 - val_accuracy: 0.4733
Confusion matrix: 
 [[403 467]
 [106 112]]
Validation f1: 28.11
Validation accuracy: 47.33
Validation recall: 51.38
Validation precision: 19.34
Validation AUC: 0.19498311145087796
Validation class accuracies: [0.4632183908045977, 0.5137614678899083]
TARGET: 0
target metric(test auc): 0.19498311145087796
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 12 epochs
Epoch 14/50
144/144 - 290s - loss: 0.6260 - accuracy: 0.6383 - val_loss: 0.7553 - val_accuracy: 0.4972
Confusion matrix: 
 [[426 444]
 [103 115]]
Validation f1: 29.60
Validation accuracy: 49.72
Validation recall: 52.75
Validation precision: 20.57
Validation AUC: 0.19568063947965816
Validation class accuracies: [0.4896551724137931, 0.5275229357798165]
TARGET: 0
target metric(test auc): 0.19568063947965816
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 13 epochs
Epoch 15/50
144/144 - 290s - loss: 0.6242 - accuracy: 0.6487 - val_loss: 0.7408 - val_accuracy: 0.4991
Confusion matrix: 
 [[425 445]
 [100 118]]
Validation f1: 30.22
Validation accuracy: 49.91
Validation recall: 54.13
Validation precision: 20.96
Validation AUC: 0.2000727939544261
Validation class accuracies: [0.4885057471264368, 0.5412844036697247]
TARGET: 0
target metric(test auc): 0.2000727939544261
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 14 epochs
Epoch 16/50
144/144 - 290s - loss: 0.6253 - accuracy: 0.6461 - val_loss: 0.7473 - val_accuracy: 0.4991
Confusion matrix: 
 [[423 447]
 [ 98 120]]
Validation f1: 30.57
Validation accuracy: 49.91
Validation recall: 55.05
Validation precision: 21.16
Validation AUC: 0.20100675505235172
Validation class accuracies: [0.4862068965517241, 0.5504587155963303]
TARGET: 0
target metric(test auc): 0.20100675505235172
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 15 epochs
Epoch 17/50
144/144 - 290s - loss: 0.6169 - accuracy: 0.6457 - val_loss: 0.7913 - val_accuracy: 0.4706
Confusion matrix: 
 [[379 491]
 [ 85 133]]
Validation f1: 31.59
Validation accuracy: 47.06
Validation recall: 61.01
Validation precision: 21.31
Validation AUC: 0.2038563779665281
Validation class accuracies: [0.435632183908046, 0.6100917431192661]
TARGET: 0
target metric(test auc): 0.2038563779665281
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 16 epochs
Epoch 18/50
144/144 - 289s - loss: 0.6216 - accuracy: 0.6496 - val_loss: 0.7916 - val_accuracy: 0.4706
Confusion matrix: 
 [[380 490]
 [ 86 132]]
Validation f1: 31.43
Validation accuracy: 47.06
Validation recall: 60.55
Validation precision: 21.22
Validation AUC: 0.20312538497000607
Validation class accuracies: [0.4367816091954023, 0.6055045871559633]
TARGET: 0
target metric(test auc): 0.20312538497000607
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 17 epochs
Epoch 19/50
144/144 - 292s - loss: 0.6189 - accuracy: 0.6343 - val_loss: 0.7923 - val_accuracy: 0.4715
Confusion matrix: 
 [[382 488]
 [ 87 131]]
Validation f1: 31.30
Validation accuracy: 47.15
Validation recall: 60.09
Validation precision: 21.16
Validation AUC: 0.20210848221935257
Validation class accuracies: [0.43908045977011495, 0.6009174311926605]
TARGET: 0
target metric(test auc): 0.20210848221935257
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 18 epochs
Epoch 20/50
144/144 - 290s - loss: 0.6106 - accuracy: 0.6609 - val_loss: 0.7744 - val_accuracy: 0.4789
Confusion matrix: 
 [[400 470]
 [ 97 121]]
Validation f1: 29.91
Validation accuracy: 47.89
Validation recall: 55.50
Validation precision: 20.47
Validation AUC: 0.20146232705659828
Validation class accuracies: [0.45977011494252873, 0.555045871559633]
TARGET: 0
target metric(test auc): 0.20146232705659828
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 19 epochs
Epoch 21/50
144/144 - 290s - loss: 0.6168 - accuracy: 0.6513 - val_loss: 0.7767 - val_accuracy: 0.4761
Confusion matrix: 
 [[397 473]
 [ 97 121]]
Validation f1: 29.80
Validation accuracy: 47.61
Validation recall: 55.50
Validation precision: 20.37
Validation AUC: 0.20101073313363788
Validation class accuracies: [0.45632183908045976, 0.555045871559633]
TARGET: 0
target metric(test auc): 0.20101073313363788
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 20 epochs
Epoch 22/50
144/144 - 292s - loss: 0.6185 - accuracy: 0.6491 - val_loss: 0.7707 - val_accuracy: 0.4807
Confusion matrix: 
 [[402 468]
 [ 97 121]]
Validation f1: 29.99
Validation accuracy: 48.07
Validation recall: 55.50
Validation precision: 20.54
Validation AUC: 0.20066647002710303
Validation class accuracies: [0.46206896551724136, 0.555045871559633]
TARGET: 0
target metric(test auc): 0.20066647002710303
The validation tracker metric at 0.2573631764414614 hasn't increased by 0 in 21 epochs
Epoch 23/50
144/144 - 289s - loss: 0.6193 - accuracy: 0.6552 - val_loss: 0.7827 - val_accuracy: 0.4770
Confusion matrix: 
 [[393 477]
 [ 92 126]]
Validation f1: 30.69
Validation accuracy: 47.70
Validation recall: 57.80
Validation precision: 20.90
Validation AUC: 0.20159102859621408
Validation class accuracies: [0.4517241379310345, 0.5779816513761468]

The metrics for the epoch with the best target metric are: 
Best cm: [[  0 870]
 [  0 218]]
Best f1: 0.333843797856049
Best accuracy: 0.20036764705882354
Best recall: 1.0
Best precision: 0.20036764705882354
Best AUC: 0.2573631764414614
Best epoch: 1
TARGET: 0
target metric(test auc): 0.20159102859621408
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 1
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2128__05_1920__v29__model9_undersampled/validation_sheet_1.xls...
Done.
Epoch: 50
Starting...
CM: [[ 5 55]
 [ 1 14]]
F1: 0.33333333333333337
AUC: 0.5747826086956522
Accuracy: 0.25333333333333335
Precision: 0.2028985507246377
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2128__05_1920__v29__model9_undersampled/validation_sheet_50.xls...
Done.
wandb: Waiting for W&B process to finish, PID 3630
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_192102-2h14ehu2/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_192102-2h14ehu2/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.65522
wandb:         val_accuracy 0.47702
wandb:             _runtime 7284
wandb:           _timestamp 1620768146
wandb:                _step 161
wandb:           train_loss 0.61933
wandb:             val_loss 0.78266
wandb:           val_recall 0.57798
wandb:        val_precision 0.20896
wandb:               val_f1 0.30694
wandb:              val_auc 0.20159
wandb:                   lr 0.0
wandb:          best_val_f1 0.33384
wandb:    best_val_accuracy 0.20037
wandb:   best_val_precision 0.20037
wandb:      best_val_recall 1.0
wandb:             best_auc 0.25736
wandb:           best_epoch 1
wandb:           best_bd_f1 0.33333
wandb:          best_bd_auc 0.6
wandb:     best_bd_accuracy 0.2
wandb:    best_bd_precision 0.2
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 1
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▃▅▄▅▅▆▆▇▇▇▇▇▇▇▇██▇█
wandb:     val_accuracy ▁▁▁▁▇▃▄█▅▅▅▅▅▆▆▆▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▄▄▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb:         val_loss ▆▆██▃▇▄▁▅▄▅▅▆▅▅▅▆▆▆▆▆▆▆
wandb:       val_recall ████▁▅▅▁▃▄▄▄▃▃▃▃▄▄▄▃▃▃▄
wandb:    val_precision ▃▃▃▃▆▁▆█▄▃▄▄▂▄▄▄▄▄▄▄▃▄▄
wandb:           val_f1 ▇▇▇▇▁▃█▁▄▄▅▄▂▃▄▄▅▅▅▄▃▄▄
wandb:          val_auc █▆▇▁▄▁▃▆▃▃▃▂▂▂▂▂▃▃▂▂▂▂▂
wandb:               lr █████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2128: https://wandb.ai/arachid1/tensorboard-integration/runs/2h14ehu2


 See logs at ../../new_cache/conv__2128__05_1920__v29__model9_undersampled/logs/