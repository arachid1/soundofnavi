Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2139
Description:  mod9_undersampled
2021-05-14 14:48:40.597483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-14 14:48:43.470057: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-14 14:48:43.471166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-14 14:48:43.524456: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:43.525227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-14 14:48:43.525279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-14 14:48:43.529080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-14 14:48:43.529183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-14 14:48:43.530334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-14 14:48:43.530615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-14 14:48:43.531723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-14 14:48:43.532665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-14 14:48:43.532814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-14 14:48:43.532965: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:43.533756: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:43.534591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2139.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2139__05_1447__v29__mod9_undersampled/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2139
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/6204jjus
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210514_144843-6204jjus
wandb: Run `wandb offline` to turn off syncing.
2021-05-14 14:48:49.588108: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-14 14:48:49.588415: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:49.589534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-14 14:48:49.589603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-14 14:48:49.589675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-14 14:48:49.589713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-14 14:48:49.589746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-14 14:48:49.589780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-14 14:48:49.589810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-14 14:48:49.589842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-14 14:48:49.589866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-14 14:48:49.589991: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:49.591324: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:49.592479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-14 14:48:49.592565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-14 14:48:50.370771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-14 14:48:50.370838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-14 14:48:50.370852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-14 14:48:50.371157: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:50.372031: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:50.372901: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:48:50.373663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-14 14:49:35.018849: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-14 14:49:35.020546: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-14 14:49:38.929587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-14 14:49:39.734255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-14 14:49:39.771369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
1150
1150
With concat = False and six = False, size of training set: 2300...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
binary
Epoch 1/80
144/144 - 289s - loss: 0.7817 - accuracy: 0.5152 - val_loss: 0.7502 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2226715805038904
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.333843797856049
column_sums: [   0 1088]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
144/144 - 281s - loss: 0.7051 - accuracy: 0.5330 - val_loss: 0.7244 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2633144965162797
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.333843797856049
column_sums: [   0 1088]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
144/144 - 282s - loss: 0.6957 - accuracy: 0.5287 - val_loss: 0.8998 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.21133653802426303
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.333843797856049
column_sums: [   0 1088]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
144/144 - 283s - loss: 0.6924 - accuracy: 0.5361 - val_loss: 0.7632 - val_accuracy: 0.3116
Confusion matrix: 
 [[145 725]
 [ 24 194]]
Validation f1: 34.12
Validation accuracy: 31.16
Validation recall: 88.99
Validation precision: 21.11
Validation AUC: 0.21126356188891873
Validation class accuracies: [0.16666666666666666, 0.8899082568807339]
TARGET: 1
target metric(test f1): 0.34124890061565527
column_sums: [169 919]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 5/80
144/144 - 283s - loss: 0.6861 - accuracy: 0.5443 - val_loss: 0.5867 - val_accuracy: 0.7546
Confusion matrix: 
 [[811  59]
 [208  10]]
Validation f1: 6.97
Validation accuracy: 75.46
Validation recall: 4.59
Validation precision: 14.49
Validation AUC: 0.21227310353862539
Validation class accuracies: [0.9321839080459771, 0.045871559633027525]
TARGET: 1
target metric(test f1): 0.0696864111498258
column_sums: [1019   69]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
144/144 - 284s - loss: 0.6814 - accuracy: 0.5496 - val_loss: 0.8866 - val_accuracy: 0.2684
Confusion matrix: 
 [[ 88 782]
 [ 14 204]]
Validation f1: 33.89
Validation accuracy: 26.84
Validation recall: 93.58
Validation precision: 20.69
Validation AUC: 0.1832280279776265
Validation class accuracies: [0.10114942528735632, 0.9357798165137615]
TARGET: 1
target metric(test f1): 0.3388704318936877
column_sums: [102 986]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
144/144 - 283s - loss: 0.6780 - accuracy: 0.5622 - val_loss: 0.6313 - val_accuracy: 0.5846
Confusion matrix: 
 [[535 335]
 [117 101]]
Validation f1: 30.89
Validation accuracy: 58.46
Validation recall: 46.33
Validation precision: 23.17
Validation AUC: 0.22969680285724603
Validation class accuracies: [0.6149425287356322, 0.463302752293578]
TARGET: 1
target metric(test f1): 0.308868501529052
column_sums: [652 436]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 1 epochs
Epoch 8/80
144/144 - 282s - loss: 0.6713 - accuracy: 0.5826 - val_loss: 1.3635 - val_accuracy: 0.4412
Confusion matrix: 
 [[324 546]
 [ 62 156]]
Validation f1: 33.91
Validation accuracy: 44.12
Validation recall: 71.56
Validation precision: 22.22
Validation AUC: 0.22389175678502632
Validation class accuracies: [0.3724137931034483, 0.7155963302752294]
TARGET: 1
target metric(test f1): 0.3391304347826087
column_sums: [386 702]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 2 epochs
Epoch 9/80
144/144 - 282s - loss: 0.6659 - accuracy: 0.5809 - val_loss: 0.6729 - val_accuracy: 0.6085
Confusion matrix: 
 [[583 287]
 [139  79]]
Validation f1: 27.05
Validation accuracy: 60.85
Validation recall: 36.24
Validation precision: 21.58
Validation AUC: 0.22862566872269446
Validation class accuracies: [0.6701149425287356, 0.3623853211009174]
TARGET: 1
target metric(test f1): 0.2705479452054795
column_sums: [722 366]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 3 epochs
Epoch 10/80
144/144 - 282s - loss: 0.6666 - accuracy: 0.5809 - val_loss: 0.9442 - val_accuracy: 0.6333
Confusion matrix: 
 [[603 267]
 [132  86]]
Validation f1: 30.12
Validation accuracy: 63.33
Validation recall: 39.45
Validation precision: 24.36
Validation AUC: 0.22989410681667966
Validation class accuracies: [0.6931034482758621, 0.3944954128440367]
TARGET: 1
target metric(test f1): 0.3012259194395797
column_sums: [735 353]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 4 epochs
Epoch 11/80
144/144 - 282s - loss: 0.6545 - accuracy: 0.5943 - val_loss: 0.6567 - val_accuracy: 0.6029
Confusion matrix: 
 [[560 310]
 [122  96]]
Validation f1: 30.77
Validation accuracy: 60.29
Validation recall: 44.04
Validation precision: 23.65
Validation AUC: 0.21991743645343212
Validation class accuracies: [0.6436781609195402, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.3076923076923077
column_sums: [682 406]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 5 epochs
Epoch 12/80
144/144 - 280s - loss: 0.6473 - accuracy: 0.6065 - val_loss: 0.7106 - val_accuracy: 0.5395
Confusion matrix: 
 [[473 397]
 [104 114]]
Validation f1: 31.28
Validation accuracy: 53.95
Validation recall: 52.29
Validation precision: 22.31
Validation AUC: 0.21575387321908296
Validation class accuracies: [0.5436781609195402, 0.5229357798165137]
TARGET: 1
target metric(test f1): 0.3127572016460905
column_sums: [577 511]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 6 epochs
Epoch 13/80
144/144 - 282s - loss: 0.6345 - accuracy: 0.6283 - val_loss: 0.8412 - val_accuracy: 0.5101
Confusion matrix: 
 [[440 430]
 [103 115]]
Validation f1: 30.14
Validation accuracy: 51.01
Validation recall: 52.75
Validation precision: 21.10
Validation AUC: 0.21489555481567277
Validation class accuracies: [0.5057471264367817, 0.5275229357798165]
TARGET: 1
target metric(test f1): 0.30144167758846657
column_sums: [543 545]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 7 epochs
Epoch 14/80
144/144 - 282s - loss: 0.6329 - accuracy: 0.6317 - val_loss: 0.7695 - val_accuracy: 0.5809
Confusion matrix: 
 [[528 342]
 [114 104]]
Validation f1: 31.33
Validation accuracy: 58.09
Validation recall: 47.71
Validation precision: 23.32
Validation AUC: 0.22005814046352162
Validation class accuracies: [0.6068965517241379, 0.47706422018348627]
TARGET: 1
target metric(test f1): 0.3132530120481928
column_sums: [642 446]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 8 epochs
Epoch 15/80
144/144 - 282s - loss: 0.6202 - accuracy: 0.6387 - val_loss: 0.6837 - val_accuracy: 0.6039
Confusion matrix: 
 [[564 306]
 [125  93]]
Validation f1: 30.15
Validation accuracy: 60.39
Validation recall: 42.66
Validation precision: 23.31
Validation AUC: 0.22546494627592656
Validation class accuracies: [0.6482758620689655, 0.42660550458715596]
TARGET: 1
target metric(test f1): 0.3014586709886548
column_sums: [689 399]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 9 epochs
Epoch 16/80
144/144 - 281s - loss: 0.6172 - accuracy: 0.6557 - val_loss: 0.6966 - val_accuracy: 0.6213
Confusion matrix: 
 [[594 276]
 [136  82]]
Validation f1: 28.47
Validation accuracy: 62.13
Validation recall: 37.61
Validation precision: 22.91
Validation AUC: 0.22092762289938167
Validation class accuracies: [0.6827586206896552, 0.3761467889908257]
TARGET: 1
target metric(test f1): 0.28472222222222227
column_sums: [730 358]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.34124890061565527 hasn't increased by 0 in 10 epochs
Epoch 17/80
144/144 - 281s - loss: 0.6117 - accuracy: 0.6530 - val_loss: 0.7608 - val_accuracy: 0.5579
Confusion matrix: 
 [[482 388]
 [ 93 125]]
Validation f1: 34.20
Validation accuracy: 55.79
Validation recall: 57.34
Validation precision: 24.37
Validation AUC: 0.21796828050067102
Validation class accuracies: [0.5540229885057472, 0.573394495412844]
TARGET: 1
target metric(test f1): 0.3419972640218878
column_sums: [575 513]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 18/80
144/144 - 287s - loss: 0.6080 - accuracy: 0.6561 - val_loss: 0.7491 - val_accuracy: 0.5395
Confusion matrix: 
 [[469 401]
 [100 118]]
Validation f1: 32.02
Validation accuracy: 53.95
Validation recall: 54.13
Validation precision: 22.74
Validation AUC: 0.2178950078762209
Validation class accuracies: [0.539080459770115, 0.5412844036697247]
TARGET: 1
target metric(test f1): 0.3202170963364993
column_sums: [569 519]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 1 epochs
Epoch 19/80
144/144 - 283s - loss: 0.6027 - accuracy: 0.6674 - val_loss: 0.7633 - val_accuracy: 0.5450
Confusion matrix: 
 [[497 373]
 [122  96]]
Validation f1: 27.95
Validation accuracy: 54.50
Validation recall: 44.04
Validation precision: 20.47
Validation AUC: 0.2082486343256561
Validation class accuracies: [0.5712643678160919, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.2794759825327511
column_sums: [619 469]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 2 epochs
Epoch 20/80
144/144 - 282s - loss: 0.5854 - accuracy: 0.6848 - val_loss: 0.6787 - val_accuracy: 0.6287
Confusion matrix: 
 [[603 267]
 [137  81]]
Validation f1: 28.62
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 62.87
Validation recall: 37.16
Validation precision: 23.28
Validation AUC: 0.2158918718612777
Validation class accuracies: [0.6931034482758621, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.28621908127208484
column_sums: [740 348]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 3 epochs
Epoch 21/80
144/144 - 282s - loss: 0.5943 - accuracy: 0.6709 - val_loss: 0.7562 - val_accuracy: 0.5625
Confusion matrix: 
 [[510 360]
 [116 102]]
Validation f1: 30.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 56.25
Validation recall: 46.79
Validation precision: 22.08
Validation AUC: 0.21704679419520487
Validation class accuracies: [0.5862068965517241, 0.46788990825688076]
TARGET: 1
target metric(test f1): 0.3
column_sums: [626 462]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 4 epochs
Epoch 22/80
144/144 - 282s - loss: 0.5837 - accuracy: 0.6835 - val_loss: 0.7277 - val_accuracy: 0.5928
Confusion matrix: 
 [[558 312]
 [131  87]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.20
Validation accuracy: 59.28
Validation recall: 39.91
Validation precision: 21.80
Validation AUC: 0.21293922046543445
Validation class accuracies: [0.6413793103448275, 0.39908256880733944]
TARGET: 1
target metric(test f1): 0.28200972447325773
column_sums: [689 399]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 5 epochs
Epoch 23/80
144/144 - 288s - loss: 0.5833 - accuracy: 0.6887 - val_loss: 0.7395 - val_accuracy: 0.5956
Confusion matrix: 
 [[557 313]
 [127  91]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 29.26
Validation accuracy: 59.56
Validation recall: 41.74
Validation precision: 22.52
Validation AUC: 0.21402746473180853
Validation class accuracies: [0.6402298850574712, 0.41743119266055045]
TARGET: 1
target metric(test f1): 0.292604501607717
column_sums: [684 404]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 6 epochs
Epoch 24/80
144/144 - 282s - loss: 0.5770 - accuracy: 0.6813 - val_loss: 0.7376 - val_accuracy: 0.5928
Confusion matrix: 
 [[559 311]
 [132  86]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.97
Validation accuracy: 59.28
Validation recall: 39.45
Validation precision: 21.66
Validation AUC: 0.21232141541541677
Validation class accuracies: [0.6425287356321839, 0.3944954128440367]
TARGET: 1
target metric(test f1): 0.2796747967479675
column_sums: [691 397]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 7 epochs
Epoch 25/80
144/144 - 281s - loss: 0.5750 - accuracy: 0.6926 - val_loss: 0.7314 - val_accuracy: 0.6085
Confusion matrix: 
 [[577 293]
 [133  85]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.52
Validation accuracy: 60.85
Validation recall: 38.99
Validation precision: 22.49
Validation AUC: 0.21367474353273705
Validation class accuracies: [0.6632183908045977, 0.38990825688073394]
TARGET: 1
target metric(test f1): 0.28523489932885904
column_sums: [710 378]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 8 epochs
Epoch 26/80
144/144 - 282s - loss: 0.5828 - accuracy: 0.6843 - val_loss: 0.7240 - val_accuracy: 0.6103
Confusion matrix: 
 [[580 290]
 [134  84]]
Validation f1: 28.38
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 61.03
Validation recall: 38.53
Validation precision: 22.46
Validation AUC: 0.2137056722911448
Validation class accuracies: [0.6666666666666666, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.28378378378378377
column_sums: [714 374]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 9 epochs
Epoch 27/80
144/144 - 282s - loss: 0.5710 - accuracy: 0.6891 - val_loss: 0.7344 - val_accuracy: 0.6020
Confusion matrix: 
 [[571 299]
 [134  84]]
Validation f1: 27.95
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 60.20
Validation recall: 38.53
Validation precision: 21.93
Validation AUC: 0.21258983998584557
Validation class accuracies: [0.6563218390804598, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.27953410981697174
column_sums: [705 383]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 10 epochs
Epoch 28/80
144/144 - 283s - loss: 0.5746 - accuracy: 0.6922 - val_loss: 0.7396 - val_accuracy: 0.5947
Confusion matrix: 
 [[560 310]
 [131  87]]
Validation f1: 28.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 59.47
Validation recall: 39.91
Validation precision: 21.91
Validation AUC: 0.2120192454314046
Validation class accuracies: [0.6436781609195402, 0.39908256880733944]
TARGET: 1
target metric(test f1): 0.28292682926829266
column_sums: [691 397]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 11 epochs
Epoch 29/80
144/144 - 283s - loss: 0.5824 - accuracy: 0.6817 - val_loss: 0.7380 - val_accuracy: 0.5983
Confusion matrix: 
 [[565 305]
 [132  86]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.24
Validation accuracy: 59.83
Validation recall: 39.45
Validation precision: 21.99
Validation AUC: 0.21291716911775327
Validation class accuracies: [0.6494252873563219, 0.3944954128440367]
TARGET: 1
target metric(test f1): 0.2824302134646962
column_sums: [697 391]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 12 epochs
Epoch 30/80
144/144 - 281s - loss: 0.5778 - accuracy: 0.6843 - val_loss: 0.7415 - val_accuracy: 0.5928
Confusion matrix: 
 [[557 313]
 [130  88]]
Validation f1: 28.43
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 59.28
Validation recall: 40.37
Validation precision: 21.95
Validation AUC: 0.2118775809683754
Validation class accuracies: [0.6402298850574712, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.284329563812601
column_sums: [687 401]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 13 epochs
Epoch 31/80
144/144 - 282s - loss: 0.5658 - accuracy: 0.7048 - val_loss: 0.7469 - val_accuracy: 0.5846
Confusion matrix: 
 [[550 320]
 [132  86]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.56
Validation accuracy: 58.46
Validation recall: 39.45
Validation precision: 21.18
Validation AUC: 0.21150725128769607
Validation class accuracies: [0.632183908045977, 0.3944954128440367]
TARGET: 1
target metric(test f1): 0.2756410256410256
column_sums: [682 406]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 14 epochs
Epoch 32/80
144/144 - 282s - loss: 0.5823 - accuracy: 0.6822 - val_loss: 0.7431 - val_accuracy: 0.5983
Confusion matrix: 
 [[563 307]
 [130  88]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.71
Validation accuracy: 59.83
Validation recall: 40.37
Validation precision: 22.28
Validation AUC: 0.21295272572380697
Validation class accuracies: [0.6471264367816092, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.2871125611745514
column_sums: [693 395]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 15 epochs
Epoch 33/80
144/144 - 283s - loss: 0.5756 - accuracy: 0.6861 - val_loss: 0.7363 - val_accuracy: 0.6002
Confusion matrix: 
 [[569 301]
 [134  84]]
Validation f1: 27.86
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 60.02
Validation recall: 38.53
Validation precision: 21.82
Validation AUC: 0.21291235218557492
Validation class accuracies: [0.6540229885057471, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.27860696517412936
column_sums: [703 385]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 16 epochs
Epoch 34/80
144/144 - 282s - loss: 0.5825 - accuracy: 0.6826 - val_loss: 0.7395 - val_accuracy: 0.5974
Confusion matrix: 
 [[562 308]
 [130  88]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.66
Validation accuracy: 59.74
Validation recall: 40.37
Validation precision: 22.22
Validation AUC: 0.21226532390574668
Validation class accuracies: [0.6459770114942529, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.28664495114006516
column_sums: [692 396]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 17 epochs
Epoch 35/80
144/144 - 283s - loss: 0.5772 - accuracy: 0.6900 - val_loss: 0.7375 - val_accuracy: 0.5983
Confusion matrix: 
 [[566 304]
 [133  85]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.01
Validation accuracy: 59.83
Validation recall: 38.99
Validation precision: 21.85
Validation AUC: 0.21242730236207913
Validation class accuracies: [0.6505747126436782, 0.38990825688073394]
TARGET: 1
target metric(test f1): 0.2800658978583196
column_sums: [699 389]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 18 epochs
Epoch 36/80
144/144 - 282s - loss: 0.5779 - accuracy: 0.6774 - val_loss: 0.7427 - val_accuracy: 0.5910
Confusion matrix: 
 [[555 315]
 [130  88]]
Validation f1: 28.34
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 59.10
Validation recall: 40.37
Validation precision: 21.84
Validation AUC: 0.21222389574118555
Validation class accuracies: [0.6379310344827587, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.2834138486312399
column_sums: [685 403]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 19 epochs
Epoch 37/80
144/144 - 282s - loss: 0.5757 - accuracy: 0.6848 - val_loss: 0.7365 - val_accuracy: 0.6011
Confusion matrix: 
 [[570 300]
 [134  84]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.91
Validation accuracy: 60.11
Validation recall: 38.53
Validation precision: 21.88
Validation AUC: 0.21241660594975958
Validation class accuracies: [0.6551724137931034, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.27906976744186046
column_sums: [704 384]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.103515914901436e-08
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 20 epochs
Epoch 38/80
144/144 - 282s - loss: 0.5682 - accuracy: 0.6926 - val_loss: 0.7340 - val_accuracy: 0.6039
Confusion matrix: 
 [[572 298]
 [133  85]]
Validation f1: 28.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 60.39
Validation recall: 38.99
Validation precision: 22.19
Validation AUC: 0.21335807464994727
Validation class accuracies: [0.6574712643678161, 0.38990825688073394]
TARGET: 1
target metric(test f1): 0.28286189683860236
column_sums: [705 383]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 21 epochs
Epoch 39/80
144/144 - 282s - loss: 0.5733 - accuracy: 0.7017 - val_loss: 0.7465 - val_accuracy: 0.5928
Confusion matrix: 
 [[557 313]
 [130  88]]
Validation f1: 28.43
Validation accuracy: 59.28
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 40.37
Validation precision: 21.95
Validation AUC: 0.21224859818504624
Validation class accuracies: [0.6402298850574712, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.284329563812601
column_sums: [687 401]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 22 epochs
Epoch 40/80
144/144 - 287s - loss: 0.5738 - accuracy: 0.6870 - val_loss: 0.7342 - val_accuracy: 0.6002
Confusion matrix: 
 [[569 301]
 [134  84]]
Validation f1: 27.86
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 60.02
Validation recall: 38.53
Validation precision: 21.82
Validation AUC: 0.2131526465590642
Validation class accuracies: [0.6540229885057471, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.27860696517412936
column_sums: [703 385]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 23 epochs
Epoch 41/80
144/144 - 282s - loss: 0.5753 - accuracy: 0.6948 - val_loss: 0.7289 - val_accuracy: 0.6075
Confusion matrix: 
 [[576 294]
 [133  85]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.48
Validation accuracy: 60.75
Validation recall: 38.99
Validation precision: 22.43
Validation AUC: 0.214371431158975
Validation class accuracies: [0.6620689655172414, 0.38990825688073394]
TARGET: 1
target metric(test f1): 0.28475711892797323
column_sums: [709 379]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.525878978725359e-08
The validation tracker metric at 0.3419972640218878 hasn't increased by 0 in 24 epochs
Epoch 42/80
144/144 - 282s - loss: 0.5687 - accuracy: 0.7022 - val_loss: 0.7334 - val_accuracy: 0.6029
Confusion matrix: 
 [[570 300]
 [132  86]]
Validation f1: 28.48
Validation accuracy: 60.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 39.45
Validation precision: 22.28
Validation AUC: 0.2137783982779076
Validation class accuracies: [0.6551724137931034, 0.3944954128440367]

The metrics for the epoch with the best target metric are: 
Best cm: [[482 388]
 [ 93 125]]
Best f1: 0.3419972640218878
Best accuracy: 0.5579044117647058
Best recall: 0.573394495412844
Best precision: 0.24366471734892786
Best AUC: 0.21796828050067102
Best epoch: 17
TARGET: 1
target metric(test f1): 0.2847682119205298
column_sums: [702 386]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 17
Starting...
CM: [[ 6 54]
 [ 0 15]]
F1: 0.3571428571428571
AUC: 0.6086956521739131
Accuracy: 0.28
Precision: 0.21739130434782608
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2139__05_1447__v29__mod9_undersampled/validation_sheet_17.xls...
Done.
Epoch: 4
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2139__05_1447__v29__mod9_undersampled/validation_sheet_4.xls...
Done.
Epoch: 80
Starting...
CM: [[10 50]
 [ 1 14]]
F1: 0.35443037974683544
AUC: 0.5827083333333333
Accuracy: 0.32
Precision: 0.21875
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2139__05_1447__v29__mod9_undersampled/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 31064
wandb: Program ended successfully.
wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210514_144843-6204jjus/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210514_144843-6204jjus/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.70217
wandb:         val_accuracy 0.60294
wandb:             _runtime 12994
wandb:           _timestamp 1621016717
wandb:                _step 300
wandb:           train_loss 0.56868
wandb:             val_loss 0.73344
wandb:           val_recall 0.3945
wandb:        val_precision 0.2228
wandb:               val_f1 0.28477
wandb:              val_auc 0.21378
wandb:                   lr 0.0
wandb:          best_val_f1 0.342
wandb:    best_val_accuracy 0.5579
wandb:   best_val_precision 0.24366
wandb:      best_val_recall 0.57339
wandb:             best_auc 0.21797
wandb:           best_epoch 17
wandb:           best_bd_f1 0.35714
wandb:          best_bd_auc 0.6087
wandb:     best_bd_accuracy 0.28
wandb:    best_bd_precision 0.21739
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 17
wandb: Run history:
wandb:   train_accuracy ▁▂▁▂▂▂▃▃▃▃▄▄▅▅▆▆▆▆▇▇▇▇▇█▇▇█▇▇█▇▇▇▇▇▇██▇█
wandb:     val_accuracy ▁▁▁▂█▂▆▄▆▆▆▅▅▆▆▆▆▅▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▆▅▅▅▅▅▄▄▄▄▄▃▃▃▃▂▂▂▂▂▂▁▁▂▁▁▂▁▁▂▁▂▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▄▃▁▄▁█▂▄▂▂▃▃▂▂▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ███▇▁█▄▆▃▄▄▅▅▄▄▃▅▅▄▃▄▄▄▄▃▃▄▄▄▄▄▃▄▄▄▃▄▄▃▄
wandb:    val_precision ▅▅▅▆▁▅▇▆▆█▇▇▆▇▇▇█▇▅▇▆▇▆▇▇▆▆▆▆▆▇▆▆▆▆▆▆▆▆▇
wandb:           val_f1 ████▁█▇█▆▇▇▇▇▇▇▇█▇▆▇▆▇▆▇▇▆▆▆▇▆▇▆▇▆▆▆▆▇▆▇
wandb:          val_auc ▄█▃▃▄▁▅▅▅▅▄▄▄▄▅▄▄▄▃▄▄▄▄▄▄▄▄▄▄▃▄▄▄▄▄▄▄▄▄▄
wandb:               lr ██████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 7 media file(s), 5 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2139: https://wandb.ai/arachid1/tensorboard-integration/runs/6204jjus


 See logs at ../../new_cache/conv__2139__05_1447__v29__mod9_undersampled/logs/