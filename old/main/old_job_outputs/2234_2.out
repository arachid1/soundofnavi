Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2334
Description:  augmentation
Collecting Variables...
All variables have been collected.
-----------------------
Job id is 0.
725 Icbhi audios have been loaded.
336 Jordan audios have been loaded.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
112 Jordan groups of audio chunks (by filename or patients) have been prepared.
0.7
--- Samples are being split and extended... ---
- Icbhi has 2220 training samples with 2104 0's and 116 1's, and 801 val samples with 769 0's and 32 1's - 
- Jordan has 238 training samples with 222 0's and 16 1's, and 90 val samples with 89 0's and 1 1's - 
--- Original training dataset contains 2458 elements ---
--- Final training dataset went from 2458 to 2458 elements, with 2326 0's, 132 1's and 0 others ---
--- Validation dataset contains 891 elements, with 858 0's and 33 1's ---
Initializing weights...
weights = {0: 0.5283748925193466, 1: 9.31060606060606}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 313, 1)]                       0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 313, 8)                         80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 313, 8)                         162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 157, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 157, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 157, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 157, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 79, 16)                          0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 79, 16)                          64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 79, 32)                          4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 79, 32)                          828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 40, 32)                          0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 40, 32)                          128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 40, 64)                          18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 40, 64)                          1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 20, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 20, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 20, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 20, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 10, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 10, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 24s - loss: 0.4944 - accuracy: 0.6953
Confusion matrix: 
 [[858   0]
 [ 33   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 96.30
Validation recall: 0.00
Validation precision: 0.00
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 19s - loss: 0.3160 - accuracy: 0.8698
Confusion matrix: 
 [[858   0]
 [ 33   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 96.30
Validation recall: 0.00
Validation precision: 0.00
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 19s - loss: 0.2645 - accuracy: 0.8841
Confusion matrix: 
 [[858   0]
 [ 33   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 96.30
Validation recall: 0.00
Validation precision: 0.00
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 19s - loss: 0.1737 - accuracy: 0.9341
Confusion matrix: 
 [[858   0]
 [ 33   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 96.30
Validation recall: 0.00
Validation precision: 0.00
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 4 epochs
Epoch 5/65
154/154 - 19s - loss: 0.1398 - accuracy: 0.9357
Confusion matrix: 
 [[843  15]
 [  9  24]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.273 0.727]]
Validation f1: 66.67
Validation accuracy: 97.31
Validation recall: 72.73
Validation precision: 61.54
Validation class accuracies: [0.9825174825174825, 0.7272727272727273]
Saving model...
Epoch 6/65
154/154 - 19s - loss: 0.0999 - accuracy: 0.9687
Confusion matrix: 
 [[303 555]
 [  0  33]]
Normalized Confusion matrix: 
 [[0.353 0.647]
 [0.    1.   ]]
Validation f1: 10.63
Validation accuracy: 37.71
Validation recall: 100.00
Validation precision: 5.61
Validation class accuracies: [0.3531468531468531, 1.0]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 1 epochs
Epoch 7/65
154/154 - 19s - loss: 0.1137 - accuracy: 0.9528
Confusion matrix: 
 [[854   4]
 [ 25   8]]
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.758 0.242]]
Validation f1: 35.56
Validation accuracy: 96.75
Validation recall: 24.24
Validation precision: 66.67
Validation class accuracies: [0.9953379953379954, 0.24242424242424243]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 2 epochs
Epoch 8/65
154/154 - 19s - loss: 0.0900 - accuracy: 0.9618
Confusion matrix: 
 [[795  63]
 [  9  24]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.273 0.727]]
Validation f1: 40.00
Validation accuracy: 91.92
Validation recall: 72.73
Validation precision: 27.59
Validation class accuracies: [0.9265734265734266, 0.7272727272727273]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 3 epochs
Epoch 9/65
154/154 - 19s - loss: 0.0730 - accuracy: 0.9707
Confusion matrix: 
 [[800  58]
 [ 13  20]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.394 0.606]]
Validation f1: 36.04
Validation accuracy: 92.03
Validation recall: 60.61
Validation precision: 25.64
Validation class accuracies: [0.9324009324009324, 0.6060606060606061]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 4 epochs
Epoch 10/65
154/154 - 19s - loss: 0.0396 - accuracy: 0.9894
Confusion matrix: 
 [[831  27]
 [ 15  18]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.455 0.545]]
Validation f1: 46.15
Validation accuracy: 95.29
Validation recall: 54.55
Validation precision: 40.00
Validation class accuracies: [0.9685314685314685, 0.5454545454545454]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 11/65
154/154 - 19s - loss: 0.0240 - accuracy: 0.9902
Confusion matrix: 
 [[840  18]
 [ 17  16]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.515 0.485]]
Validation f1: 47.76
Validation accuracy: 96.07
Validation recall: 48.48
Validation precision: 47.06
Validation class accuracies: [0.9790209790209791, 0.48484848484848486]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 6 epochs
Epoch 12/65
154/154 - 19s - loss: 0.0204 - accuracy: 0.9943
Confusion matrix: 
 [[842  16]
 [ 17  16]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.515 0.485]]
Validation f1: 49.23
Validation accuracy: 96.30
Validation recall: 48.48
Validation precision: 50.00
Validation class accuracies: [0.9813519813519813, 0.48484848484848486]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 7 epochs
Epoch 13/65
154/154 - 19s - loss: 0.0145 - accuracy: 0.9976
Confusion matrix: 
 [[842  16]
 [ 17  16]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.515 0.485]]
Validation f1: 49.23
Validation accuracy: 96.30
Validation recall: 48.48
Validation precision: 50.00
Validation class accuracies: [0.9813519813519813, 0.48484848484848486]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 8 epochs
Epoch 14/65
154/154 - 19s - loss: 0.0136 - accuracy: 0.9972
Confusion matrix: 
 [[841  17]
 [ 13  20]]
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.394 0.606]]
Validation f1: 57.14
Validation accuracy: 96.63
Validation recall: 60.61
Validation precision: 54.05
Validation class accuracies: [0.9801864801864801, 0.6060606060606061]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 9 epochs
Epoch 15/65
154/154 - 19s - loss: 0.0114 - accuracy: 0.9976
Confusion matrix: 
 [[840  18]
 [ 17  16]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.515 0.485]]
Validation f1: 47.76
Validation accuracy: 96.07
Validation recall: 48.48
Validation precision: 47.06
Validation class accuracies: [0.9790209790209791, 0.48484848484848486]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 16/65
154/154 - 19s - loss: 0.0096 - accuracy: 0.9980
Confusion matrix: 
 [[840  18]
 [ 17  16]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.515 0.485]]
Validation f1: 47.76
Validation accuracy: 96.07
Validation recall: 48.48
Validation precision: 47.06
Validation class accuracies: [0.9790209790209791, 0.48484848484848486]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 11 epochs
Epoch 17/65
154/154 - 19s - loss: 0.0093 - accuracy: 0.9984
Confusion matrix: 
 [[842  16]
 [ 17  16]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.515 0.485]]
Validation f1: 49.23
Validation accuracy: 96.30
Validation recall: 48.48
Validation precision: 50.00
Validation class accuracies: [0.9813519813519813, 0.48484848484848486]
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 12 epochs
Epoch 18/65
154/154 - 19s - loss: 0.0071 - accuracy: 0.9988
Confusion matrix: 
 [[846  12]
 [ 17  16]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.515 0.485]]
Validation f1: 52.46
Validation accuracy: 96.75
Validation recall: 48.48
Validation precision: 57.14
Validation class accuracies: [0.986013986013986, 0.48484848484848486]
local_gc_exec.sh: line 6: 26683 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2334__07_1918__v39__augmentation/logs/