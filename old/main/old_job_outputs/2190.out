Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2190
Description:  augmenting_pneumonia
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2190.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2190__06_1704__v29__augmenting_pneumonia
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 80, 'FACTOR': 0.75, 'PATIENCE': 4, 'MIN_LR': 1e-08, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 25, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 500, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 500, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Length of training samples after audio augmentation: 5212
Length of training samples after spec augmentation: 5712
-----------------------
Number of train recordings: 5712 with pneumonia: 2580 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
The initial learning rate for this job is: 0.0007373949579831934
With concat = False and six = False, size of training set: 5712...
...and size of validation set: 1072
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/80
357/357 - 503s - loss: 0.3898 - accuracy: 0.8566 - val_loss: 0.5982 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.30498200924874896
Validation class accuracies: [1.0, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 2/80
357/357 - 502s - loss: 0.2778 - accuracy: 0.9023 - val_loss: 1.1450 - val_accuracy: 0.6250
Confusion matrix: 
 [[643 141]
 [261  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82015306 0.17984694]
 [0.90625    0.09375   ]]
Validation f1: 11.84
Validation accuracy: 62.50
Validation recall: 9.38
Validation precision: 16.07
Validation AUC: 0.2492894266116812
Validation class accuracies: [0.8201530612244898, 0.09375]
The clause is activated.
Not defaulting.
Lr has been adjusted to 0.000750000006519258
Saving model...
Epoch 3/80
357/357 - 502s - loss: 0.2537 - accuracy: 0.9135 - val_loss: 1.1446 - val_accuracy: 0.7146
Confusion matrix: 
 [[764  20]
 [286   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.9744898  0.0255102 ]
 [0.99305556 0.00694444]]
Validation f1: 1.29
Validation accuracy: 71.46
Validation recall: 0.69
Validation precision: 9.09
Validation AUC: 0.25912366013690435
Validation class accuracies: [0.9744897959183674, 0.006944444444444444]
The clause is activated.
The training is defaulting to either class.
Epoch 4/80
357/357 - 502s - loss: 0.2423 - accuracy: 0.9179 - val_loss: 1.1339 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2967028665035909
Validation class accuracies: [1.0, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 5/80
357/357 - 502s - loss: 0.2286 - accuracy: 0.9263 - val_loss: 1.0485 - val_accuracy: 0.7313
Confusion matrix: 
 [[780   4]
 [284   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99489796 0.00510204]
 [0.98611111 0.01388889]]
Validation f1: 2.70
Validation accuracy: 73.13
Validation recall: 1.39
Validation precision: 50.00
Validation AUC: 0.2684067381800968
Validation class accuracies: [0.9948979591836735, 0.013888888888888888]
The clause is activated.
The training is defaulting to either class.
Epoch 6/80
357/357 - 502s - loss: 0.2343 - accuracy: 0.9212 - val_loss: 0.8189 - val_accuracy: 0.7295
Confusion matrix: 
 [[782   2]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99744898 0.00255102]
 [1.         0.        ]]
Validation f1: 0.00
Validation accuracy: 72.95
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32765597865359164
Validation class accuracies: [0.9974489795918368, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 7/80
357/357 - 502s - loss: 0.2182 - accuracy: 0.9289 - val_loss: 0.6772 - val_accuracy: 0.6903
Confusion matrix: 
 [[708  76]
 [256  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90306122 0.09693878]
 [0.88888889 0.11111111]]
Validation f1: 16.16
Validation accuracy: 69.03
Validation recall: 11.11
Validation precision: 29.63
Validation AUC: 0.300028482735632
Validation class accuracies: [0.9030612244897959, 0.1111111111111111]
The clause is activated.
Not defaulting.
Lr has been adjusted to 0.0005624999757856131
Saving model...
Epoch 8/80
357/357 - 502s - loss: 0.2052 - accuracy: 0.9328 - val_loss: 0.7300 - val_accuracy: 0.7239
Confusion matrix: 
 [[774  10]
 [286   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.9872449  0.0127551 ]
 [0.99305556 0.00694444]]
Validation f1: 1.33
Validation accuracy: 72.39
Validation recall: 0.69
Validation precision: 16.67
Validation AUC: 0.28990615397177105
Validation class accuracies: [0.9872448979591837, 0.006944444444444444]
The clause is activated.
The training is defaulting to either class.
Epoch 9/80
357/357 - 502s - loss: 0.2058 - accuracy: 0.9317 - val_loss: 0.6012 - val_accuracy: 0.7174
Confusion matrix: 
 [[762  22]
 [281   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97193878 0.02806122]
 [0.97569444 0.02430556]]
Validation f1: 4.42
Validation accuracy: 71.74
Validation recall: 2.43
Validation precision: 24.14
Validation AUC: 0.3286200922461704
Validation class accuracies: [0.9719387755102041, 0.024305555555555556]
The clause is activated.
The training is defaulting to either class.
Epoch 10/80
357/357 - 502s - loss: 0.1910 - accuracy: 0.9364 - val_loss: 0.8426 - val_accuracy: 0.7276
Confusion matrix: 
 [[780   4]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99489796 0.00510204]
 [1.         0.        ]]
Validation f1: 0.00
Validation accuracy: 72.76
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27306592762940496
Validation class accuracies: [0.9948979591836735, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 11/80
357/357 - 502s - loss: 0.1818 - accuracy: 0.9375 - val_loss: 1.0224 - val_accuracy: 0.7276
Confusion matrix: 
 [[780   4]
 [288   0]]
Normalized Confusion matrix: 
 [[0.99489796 0.00510204]
 [1.         0.        ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 0.00
Validation accuracy: 72.76
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2835751444298266
Validation class accuracies: [0.9948979591836735, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 12/80
357/357 - 502s - loss: 0.1780 - accuracy: 0.9393 - val_loss: 0.7643 - val_accuracy: 0.7248
Confusion matrix: 
 [[776   8]
 [287   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98979592 0.01020408]
 [0.99652778 0.00347222]]
Validation f1: 0.67
Validation accuracy: 72.48
Validation recall: 0.35
Validation precision: 11.11
Validation AUC: 0.29510348180682966
Validation class accuracies: [0.9897959183673469, 0.003472222222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 13/80
357/357 - 502s - loss: 0.1727 - accuracy: 0.9428 - val_loss: 0.6958 - val_accuracy: 0.7080
Confusion matrix: 
 [[736  48]
 [265  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93877551 0.06122449]
 [0.92013889 0.07986111]]
Validation f1: 12.81
Validation accuracy: 70.80
Validation recall: 7.99
Validation precision: 32.39
Validation AUC: 0.31489899008832634
Validation class accuracies: [0.9387755102040817, 0.0798611111111111]
The clause is activated.
The training is defaulting to either class.
Epoch 14/80
357/357 - 502s - loss: 0.1677 - accuracy: 0.9433 - val_loss: 0.9712 - val_accuracy: 0.7304
Confusion matrix: 
 [[780   4]
 [285   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99489796 0.00510204]
 [0.98958333 0.01041667]]
Validation f1: 2.03
Validation accuracy: 73.04
Validation recall: 1.04
Validation precision: 42.86
Validation AUC: 0.3152670127317509
Validation class accuracies: [0.9948979591836735, 0.010416666666666666]
The clause is activated.
The training is defaulting to either class.
Epoch 15/80
357/357 - 502s - loss: 0.1543 - accuracy: 0.9461 - val_loss: 0.8649 - val_accuracy: 0.7192
Confusion matrix: 
 [[770  14]
 [287   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98214286 0.01785714]
 [0.99652778 0.00347222]]
Validation f1: 0.66
Validation accuracy: 71.92
Validation recall: 0.35
Validation precision: 6.67
Validation AUC: 0.29915809599734877
Validation class accuracies: [0.9821428571428571, 0.003472222222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 16/80
357/357 - 502s - loss: 0.1451 - accuracy: 0.9492 - val_loss: 1.2905 - val_accuracy: 0.7276
Confusion matrix: 
 [[780   4]
 [288   0]]
Normalized Confusion matrix: 
 [[0.99489796 0.00510204]
 [1.         0.        ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 0.00
Validation accuracy: 72.76
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2817881687125302
Validation class accuracies: [0.9948979591836735, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 17/80
357/357 - 502s - loss: 0.1331 - accuracy: 0.9524 - val_loss: 1.0467 - val_accuracy: 0.6418
Confusion matrix: 
 [[635 149]
 [235  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.80994898 0.19005102]
 [0.81597222 0.18402778]]
Validation f1: 21.63
Validation accuracy: 64.18
Validation recall: 18.40
Validation precision: 26.24
Validation AUC: 0.2646965719252247
Validation class accuracies: [0.8099489795918368, 0.1840277777777778]
The clause is activated.
Not defaulting.
Lr has been adjusted to 0.0004218749818392098
Saving model...
Epoch 18/80
357/357 - 502s - loss: 0.1074 - accuracy: 0.9610 - val_loss: 1.4580 - val_accuracy: 0.7267
Confusion matrix: 
 [[779   5]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99362245 0.00637755]
 [1.         0.        ]]
Validation f1: 0.00
Validation accuracy: 72.67
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.28019254820987083
Validation class accuracies: [0.9936224489795918, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 19/80
357/357 - 502s - loss: 0.0961 - accuracy: 0.9685 - val_loss: 1.2844 - val_accuracy: 0.7127
Confusion matrix: 
 [[752  32]
 [276  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.95918367 0.04081633]
 [0.95833333 0.04166667]]
Validation f1: 7.23
Validation accuracy: 71.27
Validation recall: 4.17
Validation precision: 27.27
Validation AUC: 0.2822049909299492
Validation class accuracies: [0.9591836734693877, 0.041666666666666664]
The clause is activated.
The training is defaulting to either class.
Epoch 20/80
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/context.py", line 2113, in execution_mode
    yield
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/iterator_ops.py", line 733, in _next_internal
    output_shapes=self._flat_output_shapes)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/ops/gen_dataset_ops.py", line 2579, in iterator_get_next
    _ops.raise_from_not_ok_status(e, name)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 6862, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.NotFoundError: ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000/augmented/0272604_170916-009-4_F_3___1_v36_366.txt; No such file or directory
	 [[{{node ReadFile}}]] [Op:IteratorGetNext]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2190.py", line 405, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2190.py", line 313, in train_model
    callbacks=[metrics_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/integration/keras/keras.py", line 124, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1100, in fit
    tmp_logs = self.train_function(iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 805, in train_function
    return step_function(self, iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 794, in step_function
    data = next(iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/iterator_ops.py", line 747, in __next__
    return self._next_internal()
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/iterator_ops.py", line 739, in _next_internal
    return structure.from_compatible_tensor_list(self._element_spec, ret)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/context.py", line 2116, in execution_mode
    executor_new.wait()
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/executor.py", line 69, in wait
    pywrap_tfe.TFE_ExecutorWaitForAllPendingNodes(self._handle)
tensorflow.python.framework.errors_impl.NotFoundError: ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000/augmented/0272604_170916-009-4_F_3___1_v36_366.txt; No such file or directory
	 [[{{node ReadFile}}]]
wandb: Waiting for W&B process to finish, PID 3730
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210604_170924-3lwy0acn/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210604_170924-3lwy0acn/logs/debug-internal.log
wandb: Run summary:
wandb:   train_accuracy 0.96849
wandb:     val_accuracy 0.71269
wandb:         _runtime 10170
wandb:       _timestamp 1622836734
wandb:            _step 141
wandb:       train_loss 0.09606
wandb:         val_loss 1.28435
wandb:       val_recall 0.04167
wandb:    val_precision 0.27273
wandb:           val_f1 0.07229
wandb:          val_auc 0.2822
wandb:               lr 0.00042
wandb: Run history:
wandb:   train_accuracy ▁▄▅▅▅▅▆▆▆▆▆▆▆▆▇▇▇██
wandb:     val_accuracy █▁▇███▅█▇███▆█▇█▂█▇
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▃▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▃▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▄▄▄▄▄▄▃▃▃▃▃▂▂▂▁▁
wandb:         val_loss ▁▅▅▅▅▃▂▂▁▃▄▂▂▄▃▇▅█▇
wandb:       val_recall ▁▅▁▁▂▁▅▁▂▁▁▁▄▁▁▁█▁▃
wandb:    val_precision ▁▃▂▁█▁▅▃▄▁▁▃▆▇▂▁▅▁▅
wandb:           val_f1 ▁▅▁▁▂▁▆▁▂▁▁▁▅▂▁▁█▁▃
wandb:          val_auc ▆▁▂▅▃█▅▅█▃▄▅▇▇▅▄▂▄▄
wandb:               lr ██▅▅▅▅▅▃▃▃▃▃▃▃▃▃▃▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210604_170924-3lwy0acn


 See logs at ../../new_cache/conv__2190__06_1704__v29__augmenting_pneumonia/logs/