Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2255
Description:  augm_half
2021-06-25 21:32:23.988802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-25 21:32:26.457424: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-25 21:32:26.458478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-25 21:32:26.510042: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:26.511302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-25 21:32:26.511368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 21:32:26.515915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 21:32:26.516030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-25 21:32:26.517453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-25 21:32:26.517825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-25 21:32:26.519235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-25 21:32:26.520395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-25 21:32:26.520599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 21:32:26.520767: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:26.521879: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:26.522838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2255.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2255__06_2131__v39__augm_half
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-25 21:32:31.806710: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-25 21:32:31.806990: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:31.807732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-25 21:32:31.807780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 21:32:31.807835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 21:32:31.807854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-25 21:32:31.807899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-25 21:32:31.807943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-25 21:32:31.807960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-25 21:32:31.807980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-25 21:32:31.808000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 21:32:31.808101: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:31.808862: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:31.809539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-25 21:32:31.809581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 21:32:32.713407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:32:32.713462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-25 21:32:32.713479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-25 21:32:32.713870: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:32.715103: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:32.716234: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 21:32:32.717949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 64, 1250, 1)]   0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 64, 1250, 1)     4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 64, 1250, 16)    32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 64, 1250, 16)    32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 64, 1250, 1)     0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 64, 1250, 16)    2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 64, 1250, 16)    6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 64, 1250, 16)    32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 64, 1250, 48)    0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 32, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 32, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 32, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 32, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 32, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 16, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 16, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 16, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 16, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 16, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 8, 156, 64)      0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 8, 156, 64)      256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 8, 156, 64)      0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 8, 156, 128)     91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 8, 156, 128)     230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 4, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 4, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 4, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 4, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 4, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 2, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 2, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 2, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 2, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 2, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-25 21:32:34.173570: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-25 21:32:34.176257: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-25 21:32:34.528011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 21:32:36.579456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 21:32:37.095233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
167/167 - 121s - loss: 1.0574 - accuracy: 0.5735 - val_loss: 2.4654 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.0782450755397512
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
167/167 - 120s - loss: 0.6040 - accuracy: 0.6793 - val_loss: 2.0556 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.08918687521155444
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
167/167 - 120s - loss: 0.4724 - accuracy: 0.7333 - val_loss: 2.0774 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.2193443340612155
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 4/65
167/167 - 120s - loss: 0.3892 - accuracy: 0.8053 - val_loss: 0.5074 - val_accuracy: 0.7785
Confusion matrix: 
 [[451 122]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.341 0.659]]
Validation f1: 28.42
Validation accuracy: 77.85
Validation recall: 65.85
Validation precision: 18.12
Validation AUC: 0.49030833160558623
Validation class accuracies: [0.787085514834206, 0.6585365853658537]
Saving model...
Epoch 5/65
167/167 - 120s - loss: 0.3227 - accuracy: 0.8432 - val_loss: 3.6538 - val_accuracy: 0.1775
Confusion matrix: 
 [[ 68 505]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.119 0.881]
 [0.    1.   ]]
Validation f1: 13.97
Validation accuracy: 17.75
Validation recall: 100.00
Validation precision: 7.51
Validation AUC: 0.39318485308408635
Validation class accuracies: [0.11867364746945899, 1.0]
The validation tracker metric at 0.28421052631578947 hasn't increased by 0 in 1 epochs
Epoch 6/65
167/167 - 120s - loss: 0.2640 - accuracy: 0.8706 - val_loss: 0.3498 - val_accuracy: 0.8697
Confusion matrix: 
 [[508  65]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.366 0.634]]
Validation f1: 39.39
Validation accuracy: 86.97
Validation recall: 63.41
Validation precision: 28.57
Validation AUC: 0.5248959599830495
Validation class accuracies: [0.8865619546247818, 0.6341463414634146]
Saving model...
Epoch 7/65
167/167 - 120s - loss: 0.3480 - accuracy: 0.8473 - val_loss: 1.5199 - val_accuracy: 0.7313
Confusion matrix: 
 [[426 147]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.743 0.257]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.80
Validation accuracy: 73.13
Validation recall: 56.10
Validation precision: 13.53
Validation AUC: 0.33740124228573454
Validation class accuracies: [0.743455497382199, 0.5609756097560976]
The validation tracker metric at 0.3939393939393939 hasn't increased by 0 in 1 epochs
Epoch 8/65
167/167 - 120s - loss: 0.2450 - accuracy: 0.8807 - val_loss: 0.1969 - val_accuracy: 0.9283
Confusion matrix: 
 [[546  27]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.415 0.585]]
Validation f1: 52.17
Validation accuracy: 92.83
Validation recall: 58.54
Validation precision: 47.06
Validation AUC: 0.5406429798238824
Validation class accuracies: [0.9528795811518325, 0.5853658536585366]
Saving model...
Epoch 9/65
167/167 - 120s - loss: 0.2504 - accuracy: 0.8905 - val_loss: 0.5303 - val_accuracy: 0.8420
Confusion matrix: 
 [[490  83]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.855 0.145]
 [0.341 0.659]]
Validation f1: 35.76
Validation accuracy: 84.20
Validation recall: 65.85
Validation precision: 24.55
Validation AUC: 0.29077097577904626
Validation class accuracies: [0.8551483420593369, 0.6585365853658537]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 1 epochs
Epoch 10/65
167/167 - 119s - loss: 0.1579 - accuracy: 0.9201 - val_loss: 0.2544 - val_accuracy: 0.9039
Confusion matrix: 
 [[531  42]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.415 0.585]]
Validation f1: 44.86
Validation accuracy: 90.39
Validation recall: 58.54
Validation precision: 36.36
Validation AUC: 0.4654551619522693
Validation class accuracies: [0.9267015706806283, 0.5853658536585366]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 2 epochs
Epoch 11/65
167/167 - 119s - loss: 0.1812 - accuracy: 0.9201 - val_loss: 0.5344 - val_accuracy: 0.8420
Confusion matrix: 
 [[491  82]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.857 0.143]
 [0.366 0.634]]
Validation f1: 34.90
Validation accuracy: 84.20
Validation recall: 63.41
Validation precision: 24.07
Validation AUC: 0.37258871746673683
Validation class accuracies: [0.8568935427574171, 0.6341463414634146]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 3 epochs
Epoch 12/65
167/167 - 120s - loss: 0.2439 - accuracy: 0.8965 - val_loss: 0.7576 - val_accuracy: 0.9463
Confusion matrix: 
 [[571   2]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.756 0.244]]
Validation f1: 37.74
Validation accuracy: 94.63
Validation recall: 24.39
Validation precision: 83.33
Validation AUC: 0.3371205785957007
Validation class accuracies: [0.9965095986038395, 0.24390243902439024]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 4 epochs
Epoch 13/65
167/167 - 120s - loss: 0.1986 - accuracy: 0.9077 - val_loss: 0.3264 - val_accuracy: 0.9169
Confusion matrix: 
 [[553  20]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.756 0.244]]
Validation f1: 28.17
Validation accuracy: 91.69
Validation recall: 24.39
Validation precision: 33.33
Validation AUC: 0.1926501201323221
Validation class accuracies: [0.9650959860383944, 0.24390243902439024]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 5 epochs
Epoch 14/65
167/167 - 120s - loss: 0.1215 - accuracy: 0.9407 - val_loss: 0.2446 - val_accuracy: 0.8941
Confusion matrix: 
 [[527  46]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.463 0.537]]
Validation f1: 40.37
Validation accuracy: 89.41
Validation recall: 53.66
Validation precision: 32.35
Validation AUC: 0.477743810526458
Validation class accuracies: [0.9197207678883071, 0.5365853658536586]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 15/65
167/167 - 120s - loss: 0.1004 - accuracy: 0.9606 - val_loss: 0.6835 - val_accuracy: 0.7899
Confusion matrix: 
 [[451 122]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.171 0.829]]
Validation f1: 34.52
Validation accuracy: 78.99
Validation recall: 82.93
Validation precision: 21.79
Validation AUC: 0.42546750584318066
Validation class accuracies: [0.787085514834206, 0.8292682926829268]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 7 epochs
Epoch 16/65
167/167 - 121s - loss: 0.0781 - accuracy: 0.9599 - val_loss: 0.2349 - val_accuracy: 0.9153
Confusion matrix: 
 [[536  37]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.366 0.634]]
Validation f1: 50.00
Validation accuracy: 91.53
Validation recall: 63.41
Validation precision: 41.27
Validation AUC: 0.5788757612583206
Validation class accuracies: [0.9354275741710296, 0.6341463414634146]
The validation tracker metric at 0.5217391304347826 hasn't increased by 0 in 8 epochs
Epoch 17/65
167/167 - 121s - loss: 0.0651 - accuracy: 0.9707 - val_loss: 0.2060 - val_accuracy: 0.9300
Confusion matrix: 
 [[545  28]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.366 0.634]]
Validation f1: 54.74
Validation accuracy: 93.00
Validation recall: 63.41
Validation precision: 48.15
Validation AUC: 0.5985887268132782
Validation class accuracies: [0.9511343804537522, 0.6341463414634146]
Saving model...
Epoch 18/65
167/167 - 121s - loss: 0.0556 - accuracy: 0.9737 - val_loss: 0.2222 - val_accuracy: 0.9251
Confusion matrix: 
 [[545  28]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.439 0.561]]
Validation f1: 50.00
Validation accuracy: 92.51
Validation recall: 56.10
Validation precision: 45.10
Validation AUC: 0.5521583020641905
Validation class accuracies: [0.9511343804537522, 0.5609756097560976]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 1 epochs
Epoch 19/65
167/167 - 121s - loss: 0.0510 - accuracy: 0.9797 - val_loss: 0.3909 - val_accuracy: 0.8518
Confusion matrix: 
 [[496  77]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.866 0.134]
 [0.341 0.659]]
Validation f1: 37.24
Validation accuracy: 85.18
Validation recall: 65.85
Validation precision: 25.96
Validation AUC: 0.37182379658209774
Validation class accuracies: [0.8656195462478184, 0.6585365853658537]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 2 epochs
Epoch 20/65
167/167 - 121s - loss: 0.0447 - accuracy: 0.9779 - val_loss: 0.2665 - val_accuracy: 0.8990
Confusion matrix: 
 [[526  47]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.366 0.634]]
Validation f1: 45.61
Validation accuracy: 89.90
Validation recall: 63.41
Validation precision: 35.62
Validation AUC: 0.5301013663750687
Validation class accuracies: [0.9179755671902269, 0.6341463414634146]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 3 epochs
Epoch 21/65
167/167 - 121s - loss: 0.0700 - accuracy: 0.9685 - val_loss: 1.1546 - val_accuracy: 0.6450
Confusion matrix: 
 [[365 208]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.637 0.363]
 [0.244 0.756]]
Validation f1: 22.14
Validation accuracy: 64.50
Validation recall: 75.61
Validation precision: 12.97
Validation AUC: 0.3260364543585641
Validation class accuracies: [0.6369982547993019, 0.7560975609756098]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 4 epochs
Epoch 22/65
167/167 - 120s - loss: 0.0467 - accuracy: 0.9782 - val_loss: 0.2591 - val_accuracy: 0.9267
Confusion matrix: 
 [[559  14]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.756 0.244]]
Validation f1: 30.77
Validation accuracy: 92.67
Validation recall: 24.39
Validation precision: 41.67
Validation AUC: 0.40312365125532346
Validation class accuracies: [0.9755671902268761, 0.24390243902439024]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 5 epochs
Epoch 23/65
167/167 - 120s - loss: 0.0244 - accuracy: 0.9899 - val_loss: 0.2602 - val_accuracy: 0.9218
Confusion matrix: 
 [[548  25]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.561 0.439]]
Validation f1: 42.86
Validation accuracy: 92.18
Validation recall: 43.90
Validation precision: 41.86
Validation AUC: 0.434893682836333
Validation class accuracies: [0.956369982547993, 0.43902439024390244]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 24/65
167/167 - 120s - loss: 0.0235 - accuracy: 0.9865 - val_loss: 0.2207 - val_accuracy: 0.9365
Confusion matrix: 
 [[556  17]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.537 0.463]]
Validation f1: 49.35
Validation accuracy: 93.65
Validation recall: 46.34
Validation precision: 52.78
Validation AUC: 0.475037859699505
Validation class accuracies: [0.9703315881326352, 0.4634146341463415]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 7 epochs
Epoch 25/65
167/167 - 120s - loss: 0.0285 - accuracy: 0.9891 - val_loss: 0.2488 - val_accuracy: 0.9332
Confusion matrix: 
 [[558  15]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.634 0.366]]
Validation f1: 42.25
Validation accuracy: 93.32
Validation recall: 36.59
Validation precision: 50.00
Validation AUC: 0.4185698321743909
Validation class accuracies: [0.9738219895287958, 0.36585365853658536]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 8 epochs
Epoch 26/65
167/167 - 119s - loss: 0.0296 - accuracy: 0.9917 - val_loss: 0.8606 - val_accuracy: 0.7915
Confusion matrix: 
 [[460 113]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.803 0.197]
 [0.366 0.634]]
Validation f1: 28.89
Validation accuracy: 79.15
Validation recall: 63.41
Validation precision: 18.71
Validation AUC: 0.31957819773139423
Validation class accuracies: [0.8027923211169284, 0.6341463414634146]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 9 epochs
Epoch 27/65
167/167 - 120s - loss: 0.0329 - accuracy: 0.9820 - val_loss: 0.2670 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
Validation f1: 51.69
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.49598811156003836
Validation class accuracies: [0.956369982547993, 0.5609756097560976]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 10 epochs
Epoch 28/65
167/167 - 120s - loss: 0.0164 - accuracy: 0.9940 - val_loss: 0.2380 - val_accuracy: 0.9397
Confusion matrix: 
 [[554  19]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.439 0.561]]
Validation f1: 55.42
Validation accuracy: 93.97
Validation recall: 56.10
Validation precision: 54.76
Validation AUC: 0.5322829183732338
Validation class accuracies: [0.9668411867364747, 0.5609756097560976]
Saving model...
Epoch 29/65
167/167 - 119s - loss: 0.0104 - accuracy: 0.9966 - val_loss: 0.2475 - val_accuracy: 0.9414
Confusion matrix: 
 [[554  19]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.415 0.585]]
Validation f1: 57.14
Validation accuracy: 94.14
Validation recall: 58.54
Validation precision: 55.81
Validation AUC: 0.5463062590875866
Validation class accuracies: [0.9668411867364747, 0.5853658536585366]
Saving model...
Epoch 30/65
167/167 - 120s - loss: 0.0210 - accuracy: 0.9929 - val_loss: 0.2835 - val_accuracy: 0.9218
Confusion matrix: 
 [[537  36]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.293 0.707]]
Validation f1: 54.72
Validation accuracy: 92.18
Validation recall: 70.73
Validation precision: 44.62
Validation AUC: 0.5325741545814473
Validation class accuracies: [0.93717277486911, 0.7073170731707317]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 1 epochs
Epoch 31/65
167/167 - 120s - loss: 0.0382 - accuracy: 0.9865 - val_loss: 0.2385 - val_accuracy: 0.9430
Confusion matrix: 
 [[560  13]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.537 0.463]]
Validation f1: 52.05
Validation accuracy: 94.30
Validation recall: 46.34
Validation precision: 59.38
Validation AUC: 0.5126266305277316
Validation class accuracies: [0.9773123909249564, 0.4634146341463415]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 2 epochs
Epoch 32/65
167/167 - 120s - loss: 0.0135 - accuracy: 0.9966 - val_loss: 0.2384 - val_accuracy: 0.9332
Confusion matrix: 
 [[551  22]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.463 0.537]]
Validation f1: 51.76
Validation accuracy: 93.32
Validation recall: 53.66
Validation precision: 50.00
Validation AUC: 0.5192171239502881
Validation class accuracies: [0.9616055846422339, 0.5365853658536586]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 3 epochs
Epoch 33/65
167/167 - 120s - loss: 0.0096 - accuracy: 0.9962 - val_loss: 0.2613 - val_accuracy: 0.9300
Confusion matrix: 
 [[552  21]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.537 0.463]]
Validation f1: 46.91
Validation accuracy: 93.00
Validation recall: 46.34
Validation precision: 47.50
Validation AUC: 0.4707941761899042
Validation class accuracies: [0.9633507853403142, 0.4634146341463415]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 4 epochs
Epoch 34/65
167/167 - 119s - loss: 0.0093 - accuracy: 0.9974 - val_loss: 0.2725 - val_accuracy: 0.9218
Confusion matrix: 
 [[544  29]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.463 0.537]]
Validation f1: 47.83
Validation accuracy: 92.18
Validation recall: 53.66
Validation precision: 43.14
Validation AUC: 0.4699174952770382
Validation class accuracies: [0.9493891797556719, 0.5365853658536586]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 5 epochs
Epoch 35/65
167/167 - 120s - loss: 0.0445 - accuracy: 0.9827 - val_loss: 0.2880 - val_accuracy: 0.9251
Confusion matrix: 
 [[542  31]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.366 0.634]]
Validation f1: 53.06
Validation accuracy: 92.51
Validation recall: 63.41
Validation precision: 45.61
Validation AUC: 0.503777171765814
Validation class accuracies: [0.9458987783595113, 0.6341463414634146]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 36/65
167/167 - 120s - loss: 0.0085 - accuracy: 0.9977 - val_loss: 0.2318 - val_accuracy: 0.9446
Confusion matrix: 
 [[554  19]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.366 0.634]]
Validation f1: 60.47
Validation accuracy: 94.46
Validation recall: 63.41
Validation precision: 57.78
Validation AUC: 0.5679883690986102
Validation class accuracies: [0.9668411867364747, 0.6341463414634146]
Saving model...
Epoch 37/65
167/167 - 119s - loss: 0.0150 - accuracy: 0.9951 - val_loss: 0.2508 - val_accuracy: 0.9300
Confusion matrix: 
 [[551  22]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.512 0.488]]
Validation f1: 48.19
Validation accuracy: 93.00
Validation recall: 48.78
Validation precision: 47.62
Validation AUC: 0.47309301459663256
Validation class accuracies: [0.9616055846422339, 0.4878048780487805]
The validation tracker metric at 0.6046511627906976 hasn't increased by 0 in 1 epochs
Epoch 38/65
167/167 - 122s - loss: 0.0118 - accuracy: 0.9947 - val_loss: 0.2410 - val_accuracy: 0.9430
Confusion matrix: 
 [[553  20]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.366 0.634]]
Validation f1: 59.77
Validation accuracy: 94.30
Validation recall: 63.41
Validation precision: 56.52
Validation AUC: 0.5570772934327285
Validation class accuracies: [0.9650959860383944, 0.6341463414634146]
The validation tracker metric at 0.6046511627906976 hasn't increased by 0 in 2 epochs
Epoch 39/65
167/167 - 122s - loss: 0.0063 - accuracy: 0.9985 - val_loss: 0.2130 - val_accuracy: 0.9430
Confusion matrix: 
 [[555  18]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.415 0.585]]
Validation f1: 57.83
Validation accuracy: 94.30
Validation recall: 58.54
Validation precision: 57.14
Validation AUC: 0.5468291765276938
Validation class accuracies: [0.9685863874345549, 0.5853658536585366]
The validation tracker metric at 0.6046511627906976 hasn't increased by 0 in 3 epochs
Epoch 40/65
167/167 - 123s - loss: 0.0092 - accuracy: 0.9966 - val_loss: 0.2221 - val_accuracy: 0.9397
Confusion matrix: 
 [[548  25]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.293 0.707]]
Validation f1: 61.05
Validation accuracy: 93.97
Validation recall: 70.73
Validation precision: 53.70
Validation AUC: 0.5742873834590971
Validation class accuracies: [0.956369982547993, 0.7073170731707317]
Saving model...
Epoch 41/65
167/167 - 122s - loss: 0.0074 - accuracy: 0.9985 - val_loss: 0.2303 - val_accuracy: 0.9446
Confusion matrix: 
 [[554  19]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.366 0.634]]
Validation f1: 60.47
Validation accuracy: 94.46
Validation recall: 63.41
Validation precision: 57.78
Validation AUC: 0.5789528761478507
Validation class accuracies: [0.9668411867364747, 0.6341463414634146]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 1 epochs
Epoch 42/65
167/167 - 122s - loss: 0.0049 - accuracy: 0.9996 - val_loss: 0.2102 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.5877153845249439
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
Saving model...
Epoch 43/65
167/167 - 122s - loss: 0.0077 - accuracy: 0.9981 - val_loss: 0.2580 - val_accuracy: 0.9332
Confusion matrix: 
 [[545  28]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.317 0.683]]
Validation f1: 57.73
Validation accuracy: 93.32
Validation recall: 68.29
Validation precision: 50.00
Validation AUC: 0.6061534973331443
Validation class accuracies: [0.9511343804537522, 0.6829268292682927]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 1 epochs
Epoch 44/65
167/167 - 122s - loss: 0.0052 - accuracy: 0.9992 - val_loss: 0.2262 - val_accuracy: 0.9446
Confusion matrix: 
 [[557  16]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.439 0.561]]
Validation f1: 57.50
Validation accuracy: 94.46
Validation recall: 56.10
Validation precision: 58.97
Validation AUC: 0.5700348460038296
Validation class accuracies: [0.9720767888307156, 0.5609756097560976]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 2 epochs
Epoch 45/65
167/167 - 123s - loss: 0.0080 - accuracy: 0.9977 - val_loss: 0.2546 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.69
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.5132956538291961
Validation class accuracies: [0.956369982547993, 0.5609756097560976]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 3 epochs
Epoch 46/65
167/167 - 122s - loss: 0.0036 - accuracy: 1.0000 - val_loss: 0.2409 - val_accuracy: 0.9381
Confusion matrix: 
 [[556  17]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.512 0.488]]
Validation f1: 51.28
Validation accuracy: 93.81
Validation recall: 48.78
Validation precision: 54.05
Validation AUC: 0.5058121779137661
Validation class accuracies: [0.9703315881326352, 0.4878048780487805]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 4 epochs
Epoch 47/65
167/167 - 122s - loss: 0.0052 - accuracy: 1.0000 - val_loss: 0.3673 - val_accuracy: 0.9137
Confusion matrix: 
 [[533  40]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.317 0.683]]
Validation f1: 51.38
Validation accuracy: 91.37
Validation recall: 68.29
Validation precision: 41.18
Validation AUC: 0.5528551713411697
Validation class accuracies: [0.9301919720767888, 0.6829268292682927]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 5 epochs
Epoch 48/65
167/167 - 122s - loss: 0.0059 - accuracy: 0.9974 - val_loss: 0.2577 - val_accuracy: 0.9349
Confusion matrix: 
 [[554  19]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.512 0.488]]
Validation f1: 50.00
Validation accuracy: 93.49
Validation recall: 48.78
Validation precision: 51.28
Validation AUC: 0.4900401298098221
Validation class accuracies: [0.9668411867364747, 0.4878048780487805]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 49/65
167/167 - 122s - loss: 0.0043 - accuracy: 0.9985 - val_loss: 0.2498 - val_accuracy: 0.9365
Confusion matrix: 
 [[554  19]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.488 0.512]]
Validation f1: 51.85
Validation accuracy: 93.65
Validation recall: 51.22
Validation precision: 52.50
Validation AUC: 0.4978318155957413
Validation class accuracies: [0.9668411867364747, 0.5121951219512195]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 7 epochs
Epoch 50/65
167/167 - 122s - loss: 0.0070 - accuracy: 0.9989 - val_loss: 0.2800 - val_accuracy: 0.9316
Confusion matrix: 
 [[551  22]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.488 0.512]]
Validation f1: 50.00
Validation accuracy: 93.16
Validation recall: 51.22
Validation precision: 48.84
Validation AUC: 0.483716309216441
Validation class accuracies: [0.9616055846422339, 0.5121951219512195]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 8 epochs
Epoch 51/65
167/167 - 122s - loss: 0.0044 - accuracy: 0.9989 - val_loss: 0.2420 - val_accuracy: 0.9381
Confusion matrix: 
 [[552  21]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.415 0.585]]
Validation f1: 55.81
Validation accuracy: 93.81
Validation recall: 58.54
Validation precision: 53.33
Validation AUC: 0.5537858316995294
Validation class accuracies: [0.9633507853403142, 0.5853658536585366]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 9 epochs
Epoch 52/65
167/167 - 119s - loss: 0.0039 - accuracy: 0.9992 - val_loss: 0.2427 - val_accuracy: 0.9381
Confusion matrix: 
 [[555  18]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.488 0.512]]
Validation f1: 52.50
Validation accuracy: 93.81
Validation recall: 51.22
Validation precision: 53.85
Validation AUC: 0.516027055104861
Validation class accuracies: [0.9685863874345549, 0.5121951219512195]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 10 epochs
Epoch 53/65
167/167 - 119s - loss: 0.0036 - accuracy: 0.9996 - val_loss: 0.2454 - val_accuracy: 0.9381
Confusion matrix: 
 [[554  19]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.463 0.537]]
Validation f1: 53.66
Validation accuracy: 93.81
Validation recall: 53.66
Validation precision: 53.66
Validation AUC: 0.5238710309232273
Validation class accuracies: [0.9668411867364747, 0.5365853658536586]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 11 epochs
Epoch 54/65
167/167 - 119s - loss: 0.0037 - accuracy: 1.0000 - val_loss: 0.2510 - val_accuracy: 0.9414
Confusion matrix: 
 [[555  18]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.439 0.561]]
Validation f1: 56.10
Validation accuracy: 94.14
Validation recall: 56.10
Validation precision: 56.10
Validation AUC: 0.5234558490083885
Validation class accuracies: [0.9685863874345549, 0.5609756097560976]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 55/65
167/167 - 120s - loss: 0.0036 - accuracy: 1.0000 - val_loss: 0.2494 - val_accuracy: 0.9414
Confusion matrix: 
 [[554  19]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.14
Validation accuracy: 94.14
Validation recall: 58.54
Validation precision: 55.81
Validation AUC: 0.5384442687701928
Validation class accuracies: [0.9668411867364747, 0.5853658536585366]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 13 epochs
Epoch 56/65
167/167 - 120s - loss: 0.0038 - accuracy: 0.9996 - val_loss: 0.2711 - val_accuracy: 0.9349
Confusion matrix: 
 [[549  24]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.39  0.61 ]]
Validation f1: 55.56
Validation accuracy: 93.49
Validation recall: 60.98
Validation precision: 51.02
Validation AUC: 0.5193120884108666
Validation class accuracies: [0.9581151832460733, 0.6097560975609756]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 14 epochs
Epoch 57/65
167/167 - 119s - loss: 0.0033 - accuracy: 0.9992 - val_loss: 0.2563 - val_accuracy: 0.9381
Confusion matrix: 
 [[552  21]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.415 0.585]]
Validation f1: 55.81
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.81
Validation recall: 58.54
Validation precision: 53.33
Validation AUC: 0.5230697402996344
Validation class accuracies: [0.9633507853403142, 0.5853658536585366]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 15 epochs
Epoch 58/65
167/167 - 120s - loss: 0.0047 - accuracy: 0.9981 - val_loss: 0.2586 - val_accuracy: 0.9349
Confusion matrix: 
 [[552  21]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.463 0.537]]
Validation f1: 52.38
Validation accuracy: 93.49
Validation recall: 53.66
Validation precision: 51.16
Validation AUC: 0.5049805661582223
Validation class accuracies: [0.9633507853403142, 0.5365853658536586]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 16 epochs
Epoch 59/65
167/167 - 120s - loss: 0.0026 - accuracy: 0.9996 - val_loss: 0.2582 - val_accuracy: 0.9349
Confusion matrix: 
 [[553  20]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.22
Validation accuracy: 93.49
Validation recall: 51.22
Validation precision: 51.22
Validation AUC: 0.5036607784108235
Validation class accuracies: [0.9650959860383944, 0.5121951219512195]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 17 epochs
Epoch 60/65
167/167 - 120s - loss: 0.0042 - accuracy: 0.9992 - val_loss: 0.2519 - val_accuracy: 0.9397
Confusion matrix: 
 [[554  19]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.42
Validation accuracy: 93.97
Validation recall: 56.10
Validation precision: 54.76
Validation AUC: 0.5247983786534592
Validation class accuracies: [0.9668411867364747, 0.5609756097560976]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 61/65
167/167 - 120s - loss: 0.0052 - accuracy: 0.9989 - val_loss: 0.2686 - val_accuracy: 0.9397
Confusion matrix: 
 [[553  20]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.415 0.585]]
Validation f1: 56.47
Validation accuracy: 93.97
Validation recall: 58.54
Validation precision: 54.55
Validation AUC: 0.5199523235177752
Validation class accuracies: [0.9650959860383944, 0.5853658536585366]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 19 epochs
Epoch 62/65
167/167 - 119s - loss: 0.0030 - accuracy: 1.0000 - val_loss: 0.2603 - val_accuracy: 0.9397
Confusion matrix: 
 [[553  20]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.47
Validation accuracy: 93.97
Validation recall: 58.54
Validation precision: 54.55
Validation AUC: 0.5248834333540713
Validation class accuracies: [0.9650959860383944, 0.5853658536585366]

The metrics for job 0 with the best target metric are: 
Best cm: [[555  18]
 [ 14  27]]
Best normalized cm: [[0.969 0.031]
 [0.341 0.659]]
Best f1: 0.63
Best accuracy: 0.95
Best recall: 0.66
Best precision: 0.60
Best AUC: 0.59
Best class accuracies: [0.9685863874345549, 0.6585365853658537]
Best epoch: 42
The number of epochs since last 1% equals the patience
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.08]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[8.085e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.065]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[2.067e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[4.247e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[7.508e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.793e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[8.97e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[5.444e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[2.983e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.064]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[3.427e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.484e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[3.939e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[3.214e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[4.502e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.165]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.077]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 27822
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_213226-17xcri2b/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_213226-17xcri2b/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.93974
wandb:             _runtime 8165
wandb:           _timestamp 1624664912
wandb:                _step 463
wandb:           train_loss 0.00298
wandb:             val_loss 0.26034
wandb:           val_recall 0.58537
wandb:        val_precision 0.54545
wandb:               val_f1 0.56471
wandb:              val_auc 0.52488
wandb:                   lr 2e-05
wandb:          best_val_f1 0.62791
wandb:    best_val_accuracy 0.94788
wandb:   best_val_precision 0.6
wandb:      best_val_recall 0.65854
wandb:             best_auc 0.58772
wandb:           best_epoch 42
wandb: Run history:
wandb:   train_accuracy ▁▃▅▅▅▆▇▇▆▇▇██▇██████████████████████████
wandb:     val_accuracy ▁▁▇▂▆██▇█▇██▇▆██▇███████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▆▅▂█▄▁▁▂▁▂▁▁▁▃▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ██▅█▄▄▄▅▁▆▅▄▅▆▁▃▅▄▄▅▄▃▅▅▅▅▅▅▄▃▅▃▄▃▄▄▄▄▄▄
wandb:    val_precision ▁▁▃▁▂▆▅▃▅▃▆▆▄▂▆▇▃▇█▆▇▆▆██▇█▇█▇▆▇▇▇██▇▇▇▇
wandb:           val_f1 ▁▁▃▁▂▇▆▄▃▄▆▆▅▂▄▆▃▇▇▇▇▆▇█████▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▁▆▅▄▇▆▅▃▆█▇▅▄▅▆▄▇▇▇▇▆▇▇▇████▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr █████████▄▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_213226-17xcri2b

-----------------------
Changing augmentation to v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 64, 1250, 1)]   0                                                 
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 64, 1250, 1)     4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 64, 1250, 16)    32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 64, 1250, 16)    32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 64, 1250, 1)     0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 64, 1250, 16)    2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 64, 1250, 16)    6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 64, 1250, 16)    32           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 64, 1250, 48)    0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 32, 625, 48)     0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 32, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 32, 625, 48)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 32, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 32, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 16, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 16, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 16, 312, 32)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 16, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 16, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 8, 156, 64)      0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 8, 156, 64)      256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 8, 156, 64)      0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 8, 156, 128)     91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 8, 156, 128)     230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 4, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 4, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 4, 78, 128)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 4, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 4, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 2, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 2, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 2, 39, 256)      0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 2, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 2, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
167/167 - 121s - loss: 1.0316 - accuracy: 0.5930 - val_loss: 1.7416 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.10711379377054972
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
167/167 - 121s - loss: 0.4979 - accuracy: 0.7588 - val_loss: 1.0962 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.18754931926743995
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
167/167 - 121s - loss: 0.3253 - accuracy: 0.8286 - val_loss: 0.7538 - val_accuracy: 0.4283
Confusion matrix: 
 [[228 345]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.398 0.602]
 [0.146 0.854]]
Validation f1: 16.63
Validation accuracy: 42.83
Validation recall: 85.37
Validation precision: 9.21
Validation AUC: 0.17774002500992825
Validation class accuracies: [0.39790575916230364, 0.8536585365853658]
Saving model...
Epoch 4/65
167/167 - 121s - loss: 0.3434 - accuracy: 0.8481 - val_loss: 0.2785 - val_accuracy: 0.9039
Confusion matrix: 
 [[548  25]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.829 0.171]]
Validation f1: 19.18
Validation accuracy: 90.39
Validation recall: 17.07
Validation precision: 21.88
Validation AUC: 0.1689006122914169
Validation class accuracies: [0.956369982547993, 0.17073170731707318]
Saving model...
Epoch 5/65
167/167 - 120s - loss: 0.2912 - accuracy: 0.8616 - val_loss: 0.3387 - val_accuracy: 0.9169
Confusion matrix: 
 [[555  18]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.805 0.195]]
Validation f1: 23.88
Validation accuracy: 91.69
Validation recall: 19.51
Validation precision: 30.77
Validation AUC: 0.1664575574877108
Validation class accuracies: [0.9685863874345549, 0.1951219512195122]
Saving model...
Epoch 6/65
167/167 - 120s - loss: 0.1803 - accuracy: 0.9126 - val_loss: 0.3933 - val_accuracy: 0.8664
Confusion matrix: 
 [[514  59]
 [ 23  18]]
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.561 0.439]]
Validation f1: 30.51
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 86.64
Validation recall: 43.90
Validation precision: 23.38
Validation AUC: 0.1710095508132703
Validation class accuracies: [0.8970331588132635, 0.43902439024390244]
Saving model...
Epoch 7/65
167/167 - 120s - loss: 0.1868 - accuracy: 0.9254 - val_loss: 4.5977 - val_accuracy: 0.4121
Confusion matrix: 
 [[217 356]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.379 0.621]
 [0.122 0.878]]
Validation f1: 16.63
Validation accuracy: 41.21
Validation recall: 87.80
Validation precision: 9.18
Validation AUC: 0.1860420171783242
Validation class accuracies: [0.3787085514834206, 0.8780487804878049]
The validation tracker metric at 0.3050847457627119 hasn't increased by 0 in 1 epochs
Epoch 8/65
167/167 - 120s - loss: 0.1985 - accuracy: 0.9254 - val_loss: 0.2195 - val_accuracy: 0.9332
Confusion matrix: 
 [[559  14]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.659 0.341]]
Validation f1: 40.58
Validation accuracy: 93.32
Validation recall: 34.15
Validation precision: 50.00
Validation AUC: 0.4685086408122215
Validation class accuracies: [0.9755671902268761, 0.34146341463414637]
Saving model...
Epoch 9/65
167/167 - 120s - loss: 0.1714 - accuracy: 0.9261 - val_loss: 0.2926 - val_accuracy: 0.8990
Confusion matrix: 
 [[541  32]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.732 0.268]]
Validation f1: 26.19
Validation accuracy: 89.90
Validation recall: 26.83
Validation precision: 25.58
Validation AUC: 0.20418045281841185
Validation class accuracies: [0.944153577661431, 0.2682926829268293]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 1 epochs
Epoch 10/65
167/167 - 120s - loss: 0.1529 - accuracy: 0.9310 - val_loss: 0.3365 - val_accuracy: 0.8827
Confusion matrix: 
 [[535  38]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.829 0.171]]
Validation f1: 16.28
Validation accuracy: 88.27
Validation recall: 17.07
Validation precision: 15.56
Validation AUC: 0.24070261039416024
Validation class accuracies: [0.9336823734729494, 0.17073170731707318]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 2 epochs
Epoch 11/65
167/167 - 120s - loss: 0.1360 - accuracy: 0.9370 - val_loss: 0.2430 - val_accuracy: 0.9267
Confusion matrix: 
 [[564   9]
 [ 36   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.878 0.122]]
Validation f1: 18.18
Validation accuracy: 92.67
Validation recall: 12.20
Validation precision: 35.71
Validation AUC: 0.297976604084815
Validation class accuracies: [0.9842931937172775, 0.12195121951219512]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 3 epochs
Epoch 12/65
167/167 - 120s - loss: 0.1220 - accuracy: 0.9494 - val_loss: 0.6525 - val_accuracy: 0.7362
Confusion matrix: 
 [[439 134]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.766 0.234]
 [0.683 0.317]]
Validation f1: 13.83
Validation accuracy: 73.62
Validation recall: 31.71
Validation precision: 8.84
Validation AUC: 0.10743479507765621
Validation class accuracies: [0.7661431064572426, 0.3170731707317073]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 4 epochs
Epoch 13/65
167/167 - 120s - loss: 0.1192 - accuracy: 0.9557 - val_loss: 0.8262 - val_accuracy: 0.7980
Confusion matrix: 
 [[482  91]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.805 0.195]]
Validation f1: 11.43
Validation accuracy: 79.80
Validation recall: 19.51
Validation precision: 8.08
Validation AUC: 0.09576978384412588
Validation class accuracies: [0.8411867364746946, 0.1951219512195122]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 5 epochs
Epoch 14/65
167/167 - 120s - loss: 0.0908 - accuracy: 0.9629 - val_loss: 2.3055 - val_accuracy: 0.6026
Confusion matrix: 
 [[351 222]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.613 0.387]
 [0.537 0.463]]
Validation f1: 13.48
Validation accuracy: 60.26
Validation recall: 46.34
Validation precision: 7.88
Validation AUC: 0.07300662110188785
Validation class accuracies: [0.612565445026178, 0.4634146341463415]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 15/65
167/167 - 120s - loss: 0.1078 - accuracy: 0.9640 - val_loss: 0.3324 - val_accuracy: 0.8860
Confusion matrix: 
 [[536  37]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.805 0.195]]
Validation f1: 18.60
Validation accuracy: 88.60
Validation recall: 19.51
Validation precision: 17.78
Validation AUC: 0.14842139510483549
Validation class accuracies: [0.9354275741710296, 0.1951219512195122]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 7 epochs
Epoch 16/65
167/167 - 120s - loss: 0.0515 - accuracy: 0.9767 - val_loss: 0.2340 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.409339315461905
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 8 epochs
Epoch 17/65
167/167 - 120s - loss: 0.0517 - accuracy: 0.9790 - val_loss: 0.2889 - val_accuracy: 0.9186
Confusion matrix: 
 [[556  17]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.805 0.195]]
Validation f1: 24.24
Validation accuracy: 91.86
Validation recall: 19.51
Validation precision: 32.00
Validation AUC: 0.20369282331161112
Validation class accuracies: [0.9703315881326352, 0.1951219512195122]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 9 epochs
Epoch 18/65
167/167 - 120s - loss: 0.0531 - accuracy: 0.9782 - val_loss: 0.2638 - val_accuracy: 0.9267
Confusion matrix: 
 [[566   7]
 [ 38   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.927 0.073]]
Validation f1: 11.76
Validation accuracy: 92.67
Validation recall: 7.32
Validation precision: 30.00
Validation AUC: 0.2373826006825362
Validation class accuracies: [0.987783595113438, 0.07317073170731707]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 10 epochs
Epoch 19/65
167/167 - 120s - loss: 0.0409 - accuracy: 0.9835 - val_loss: 0.2295 - val_accuracy: 0.9397
Confusion matrix: 
 [[566   7]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.732 0.268]]
Validation f1: 37.29
Validation accuracy: 93.97
Validation recall: 26.83
Validation precision: 61.11
Validation AUC: 0.46382455875238154
Validation class accuracies: [0.987783595113438, 0.2682926829268293]
The validation tracker metric at 0.40579710144927533 hasn't increased by 0 in 11 epochs
Epoch 20/65
167/167 - 120s - loss: 0.0235 - accuracy: 0.9925 - val_loss: 0.2217 - val_accuracy: 0.9365
Confusion matrix: 
 [[561  12]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.659 0.341]]
Validation f1: 41.79
Validation accuracy: 93.65
Validation recall: 34.15
Validation precision: 53.85
Validation AUC: 0.403101895700506
Validation class accuracies: [0.9790575916230366, 0.34146341463414637]
Saving model...
Epoch 21/65
167/167 - 120s - loss: 0.0605 - accuracy: 0.9779 - val_loss: 0.3260 - val_accuracy: 0.9186
Confusion matrix: 
 [[553  20]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.732 0.268]]
Validation f1: 30.56
Validation accuracy: 91.86
Validation recall: 26.83
Validation precision: 35.48
Validation AUC: 0.30542497875023195
Validation class accuracies: [0.9650959860383944, 0.2682926829268293]
The validation tracker metric at 0.41791044776119407 hasn't increased by 0 in 1 epochs
Epoch 22/65
167/167 - 120s - loss: 0.0456 - accuracy: 0.9824 - val_loss: 0.3160 - val_accuracy: 0.9235
Confusion matrix: 
 [[556  17]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.732 0.268]]
Validation f1: 31.88
Validation accuracy: 92.35
Validation recall: 26.83
Validation precision: 39.29
Validation AUC: 0.27042637369393485
Validation class accuracies: [0.9703315881326352, 0.2682926829268293]
The validation tracker metric at 0.41791044776119407 hasn't increased by 0 in 2 epochs
Epoch 23/65
167/167 - 120s - loss: 0.0725 - accuracy: 0.9722 - val_loss: 0.3541 - val_accuracy: 0.9169
Confusion matrix: 
 [[563  10]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 91.69
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1093988613927122
Validation class accuracies: [0.9825479930191972, 0.0]
The validation tracker metric at 0.41791044776119407 hasn't increased by 0 in 3 epochs
Epoch 24/65
167/167 - 120s - loss: 0.0436 - accuracy: 0.9839 - val_loss: 0.2547 - val_accuracy: 0.9397
Confusion matrix: 
 [[570   3]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.829 0.171]]
Validation f1: 27.45
Validation accuracy: 93.97
Validation recall: 17.07
Validation precision: 70.00
Validation AUC: 0.4025114658716364
Validation class accuracies: [0.9947643979057592, 0.17073170731707318]
The validation tracker metric at 0.41791044776119407 hasn't increased by 0 in 4 epochs
Epoch 25/65
167/167 - 120s - loss: 0.0867 - accuracy: 0.9692 - val_loss: 0.5956 - val_accuracy: 0.7899
Confusion matrix: 
 [[464 109]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.488 0.512]]
Validation f1: 24.56
Validation accuracy: 78.99
Validation recall: 51.22
Validation precision: 16.15
Validation AUC: 0.3143931569703427
Validation class accuracies: [0.8097731239092496, 0.5121951219512195]
The validation tracker metric at 0.41791044776119407 hasn't increased by 0 in 5 epochs
Epoch 26/65
167/167 - 120s - loss: 0.0347 - accuracy: 0.9865 - val_loss: 0.7129 - val_accuracy: 0.7606
Confusion matrix: 
 [[442 131]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.771 0.229]
 [0.39  0.61 ]]
Validation f1: 25.38
Validation accuracy: 76.06
Validation recall: 60.98
Validation precision: 16.03
Validation AUC: 0.1444415404665224
Validation class accuracies: [0.7713787085514834, 0.6097560975609756]
The validation tracker metric at 0.41791044776119407 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 27/65
167/167 - 120s - loss: 0.0226 - accuracy: 0.9887 - val_loss: 0.2430 - val_accuracy: 0.9300
Confusion matrix: 
 [[555  18]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.61  0.39 ]]
Validation f1: 42.67
Validation accuracy: 93.00
Validation recall: 39.02
Validation precision: 47.06
Validation AUC: 0.35154140211663515
Validation class accuracies: [0.9685863874345549, 0.3902439024390244]
Saving model...
Epoch 28/65
167/167 - 120s - loss: 0.0160 - accuracy: 0.9932 - val_loss: 0.2411 - val_accuracy: 0.9381
Confusion matrix: 
 [[558  15]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.561 0.439]]
Validation f1: 48.65
Validation accuracy: 93.81
Validation recall: 43.90
Validation precision: 54.55
Validation AUC: 0.3767845287699452
Validation class accuracies: [0.9738219895287958, 0.43902439024390244]
Saving model...
Epoch 29/65
167/167 - 120s - loss: 0.0140 - accuracy: 0.9936 - val_loss: 0.2419 - val_accuracy: 0.9381
Confusion matrix: 
 [[564   9]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.707 0.293]]
Validation f1: 38.71
Validation accuracy: 93.81
Validation recall: 29.27
Validation precision: 57.14
Validation AUC: 0.3782538541728892
Validation class accuracies: [0.9842931937172775, 0.2926829268292683]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 1 epochs
Epoch 30/65
167/167 - 120s - loss: 0.0109 - accuracy: 0.9959 - val_loss: 0.2483 - val_accuracy: 0.9349
Confusion matrix: 
 [[562  11]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.707 0.293]]
Validation f1: 37.50
Validation accuracy: 93.49
Validation recall: 29.27
Validation precision: 52.17
Validation AUC: 0.3335383326997146
Validation class accuracies: [0.9808027923211169, 0.2926829268292683]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 2 epochs
Epoch 31/65
167/167 - 120s - loss: 0.0222 - accuracy: 0.9906 - val_loss: 0.4525 - val_accuracy: 0.8713
Confusion matrix: 
 [[520  53]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.634 0.366]]
Validation f1: 27.52
Validation accuracy: 87.13
Validation recall: 36.59
Validation precision: 22.06
Validation AUC: 0.2629635394828191
Validation class accuracies: [0.9075043630017452, 0.36585365853658536]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 3 epochs
Epoch 32/65
167/167 - 120s - loss: 0.0148 - accuracy: 0.9947 - val_loss: 0.2797 - val_accuracy: 0.9316
Confusion matrix: 
 [[567   6]
 [ 36   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.878 0.122]]
Validation f1: 19.23
Validation accuracy: 93.16
Validation recall: 12.20
Validation precision: 45.45
Validation AUC: 0.31850515058450224
Validation class accuracies: [0.9895287958115183, 0.12195121951219512]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 4 epochs
Epoch 33/65
167/167 - 120s - loss: 0.0121 - accuracy: 0.9944 - val_loss: 0.2822 - val_accuracy: 0.9235
Confusion matrix: 
 [[560  13]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.829 0.171]]
Validation f1: 22.95
Validation accuracy: 92.35
Validation recall: 17.07
Validation precision: 35.00
Validation AUC: 0.32792775574508726
Validation class accuracies: [0.9773123909249564, 0.17073170731707318]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 5 epochs
Epoch 34/65
167/167 - 120s - loss: 0.0066 - accuracy: 0.9977 - val_loss: 0.2685 - val_accuracy: 0.9300
Confusion matrix: 
 [[561  12]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.756 0.244]]
Validation f1: 31.75
Validation accuracy: 93.00
Validation recall: 24.39
Validation precision: 45.45
Validation AUC: 0.30788247383621453
Validation class accuracies: [0.9790575916230366, 0.24390243902439024]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 35/65
167/167 - 120s - loss: 0.0064 - accuracy: 0.9977 - val_loss: 0.2599 - val_accuracy: 0.9349
Confusion matrix: 
 [[559  14]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.634 0.366]]
Validation f1: 42.86
Validation accuracy: 93.49
Validation recall: 36.59
Validation precision: 51.72
Validation AUC: 0.3637823094839695
Validation class accuracies: [0.9755671902268761, 0.36585365853658536]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 7 epochs
Epoch 36/65
167/167 - 120s - loss: 0.0064 - accuracy: 0.9981 - val_loss: 0.2722 - val_accuracy: 0.9414
Confusion matrix: 
 [[563  10]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.634 0.366]]
Validation f1: 45.45
Validation accuracy: 94.14
Validation recall: 36.59
Validation precision: 60.00
Validation AUC: 0.33937309620220885
Validation class accuracies: [0.9825479930191972, 0.36585365853658536]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 8 epochs
Epoch 37/65
167/167 - 120s - loss: 0.0066 - accuracy: 0.9970 - val_loss: 0.2702 - val_accuracy: 0.9430
Confusion matrix: 
 [[565   8]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.659 0.341]]
Validation f1: 44.44
Validation accuracy: 94.30
Validation recall: 34.15
Validation precision: 63.64
Validation AUC: 0.3835496009436973
Validation class accuracies: [0.9860383944153578, 0.34146341463414637]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 9 epochs
Epoch 38/65
167/167 - 120s - loss: 0.0102 - accuracy: 0.9981 - val_loss: 0.2617 - val_accuracy: 0.9381
Confusion matrix: 
 [[564   9]
 [ 29  12]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.707 0.293]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.71
Validation accuracy: 93.81
Validation recall: 29.27
Validation precision: 57.14
Validation AUC: 0.4071560269366671
Validation class accuracies: [0.9842931937172775, 0.2926829268292683]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 10 epochs
Epoch 39/65
167/167 - 120s - loss: 0.0112 - accuracy: 0.9944 - val_loss: 0.2720 - val_accuracy: 0.9332
Confusion matrix: 
 [[560  13]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.683 0.317]]
Validation f1: 38.81
Validation accuracy: 93.32
Validation recall: 31.71
Validation precision: 50.00
Validation AUC: 0.35524490517100693
Validation class accuracies: [0.9773123909249564, 0.3170731707317073]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 11 epochs
Epoch 40/65
167/167 - 121s - loss: 0.0059 - accuracy: 0.9970 - val_loss: 0.2898 - val_accuracy: 0.9349
Confusion matrix: 
 [[563  10]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.732 0.268]]
Validation f1: 35.48
Validation accuracy: 93.49
Validation recall: 26.83
Validation precision: 52.38
Validation AUC: 0.3487720400089523
Validation class accuracies: [0.9825479930191972, 0.2682926829268293]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 41/65
167/167 - 121s - loss: 0.0086 - accuracy: 0.9974 - val_loss: 0.3040 - val_accuracy: 0.9316
Confusion matrix: 
 [[561  12]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.732 0.268]]
Validation f1: 34.38
Validation accuracy: 93.16
Validation recall: 26.83
Validation precision: 47.83
Validation AUC: 0.3530689999721943
Validation class accuracies: [0.9790575916230366, 0.2682926829268293]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 13 epochs
Epoch 42/65
167/167 - 121s - loss: 0.0065 - accuracy: 0.9977 - val_loss: 0.2932 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.3552042875087561
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 14 epochs
Epoch 43/65
167/167 - 121s - loss: 0.0059 - accuracy: 0.9966 - val_loss: 0.2955 - val_accuracy: 0.9283
Confusion matrix: 
 [[562  11]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.805 0.195]]
Validation f1: 26.67
Validation accuracy: 92.83
Validation recall: 19.51
Validation precision: 42.11
Validation AUC: 0.3271263502419616
Validation class accuracies: [0.9808027923211169, 0.1951219512195122]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 15 epochs
Epoch 44/65
167/167 - 121s - loss: 0.0038 - accuracy: 0.9989 - val_loss: 0.3011 - val_accuracy: 0.9332
Confusion matrix: 
 [[565   8]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.805 0.195]]
Validation f1: 28.07
Validation accuracy: 93.32
Validation recall: 19.51
Validation precision: 50.00
Validation AUC: 0.33119423616917276
Validation class accuracies: [0.9860383944153578, 0.1951219512195122]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 16 epochs
Epoch 45/65
167/167 - 121s - loss: 0.0147 - accuracy: 0.9962 - val_loss: 0.3319 - val_accuracy: 0.9169
Confusion matrix: 
 [[556  17]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.829 0.171]]
Validation f1: 21.54
Validation accuracy: 91.69
Validation recall: 17.07
Validation precision: 29.17
Validation AUC: 0.2500489879439483
Validation class accuracies: [0.9703315881326352, 0.17073170731707318]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 17 epochs
Epoch 46/65
167/167 - 121s - loss: 0.0074 - accuracy: 0.9966 - val_loss: 0.3359 - val_accuracy: 0.9202
Confusion matrix: 
 [[559  14]
 [ 35   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.854 0.146]]
Validation f1: 19.67
Validation accuracy: 92.02
Validation recall: 14.63
Validation precision: 30.00
Validation AUC: 0.2654317544921805
Validation class accuracies: [0.9755671902268761, 0.14634146341463414]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 47/65
167/167 - 119s - loss: 0.0095 - accuracy: 0.9981 - val_loss: 0.3180 - val_accuracy: 0.9218
Confusion matrix: 
 [[556  17]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.756 0.244]]
Validation f1: 29.41
Validation accuracy: 92.18
Validation recall: 24.39
Validation precision: 37.04
Validation AUC: 0.28232869137778815
Validation class accuracies: [0.9703315881326352, 0.24390243902439024]
The validation tracker metric at 0.48648648648648646 hasn't increased by 0 in 19 epochs
Epoch 48/65
167/167 - 120s - loss: 0.0051 - accuracy: 0.9981 - val_loss: 0.3213 - val_accuracy: 0.9283
Confusion matrix: 
 [[562  11]
 [ 33   8]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.805 0.195]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.67
Validation accuracy: 92.83
Validation recall: 19.51
Validation precision: 42.11
Validation AUC: 0.28330089858075463
Validation class accuracies: [0.9808027923211169, 0.1951219512195122]

The metrics for job 1 with the best target metric are: 
Best cm: [[558  15]
 [ 23  18]]
Best normalized cm: [[0.974 0.026]
 [0.561 0.439]]
Best f1: 0.49
Best accuracy: 0.94
Best recall: 0.44
Best precision: 0.55
Best AUC: 0.38
Best class accuracies: [0.9738219895287958, 0.43902439024390244]
Best epoch: 28
The number of epochs since last 1% equals the patience
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_207_2b4_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_218_1b1_Pl_sc_Meditron_7_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_218_1b1_Pl_sc_Meditron_6_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_222_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[3.455e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_222_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_203_2p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[3.7e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_226_1b1_Al_sc_Meditron_1_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_0.png, [[0.234]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_213_1p5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_211_1p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[2.848e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_0.png, [[0.014]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_205_4b2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_203_2p3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_222_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_204_2b5_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[7.215e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_205_3b4_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_207_2b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[3.268e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[2.171e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_213_1p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_221_2b2_Pl_mc_LittC2SE_3_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_221_2b1_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.33]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_218_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_218_1p1_Ar_sc_Litt3200_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_211_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.095e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_213_1p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[4.164e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_223_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_207_2b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_3_label_1_pred_1.png, [[0.802]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_219_2b2_Ar_mc_LittC2SE_2_label_1_pred_1.png, [[0.62]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_204_7p5_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_203_2p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[4.588e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_222_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_221_2b3_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_207_2b4_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/jordan_EP36_pneumonia,Crep,P R M,36,F_5_label_1_pred_0.png, [[0.319]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_205_2b3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2255__06_2131__v39__augm_half/1/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 15281
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_234907-3n5flas5/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_234907-3n5flas5/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99812
wandb:         val_accuracy 0.92834
wandb:             _runtime 6291
wandb:           _timestamp 1624671239
wandb:                _step 362
wandb:           train_loss 0.00511
wandb:             val_loss 0.32127
wandb:           val_recall 0.19512
wandb:        val_precision 0.42105
wandb:               val_f1 0.26667
wandb:              val_auc 0.2833
wandb:                   lr 3e-05
wandb:          best_val_f1 0.48649
wandb:    best_val_accuracy 0.93811
wandb:   best_val_precision 0.54545
wandb:      best_val_recall 0.43902
wandb:             best_auc 0.37678
wandb:           best_epoch 28
wandb: Run history:
wandb:   train_accuracy ▁▄▅▅▆▇▇▇▇▇▇▇▇███████▇███████████████████
wandb:     val_accuracy ▁▁▄██▄████▇▅████████▇▇███▇██████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▂▂▁▁█▁▁▁▁▂▄▁▁▁▁▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ██▇▂▂▇▃▃▂▂▂▄▂▃▂▃▃▃▃▁▅▅▄▄▃▄▂▂▃▄▃▃▃▃▃▂▂▂▂▂
wandb:    val_precision ▂▂▂▃▄▂▇▄▃▅▂▂▃▇▅█▇▅▅▁▃▃▆▇▇▃▆▅▆▇█▇▇▇▆▆▇▄▄▆
wandb:           val_f1 ▃▃▃▄▄▃▇▅▃▄▃▃▄▆▄▆▇▅▆▁▅▅▇█▇▅▄▄▆▇▇▇▇▆▆▅▅▄▄▅
wandb:          val_auc ▂▃▃▃▃▃█▃▄▅▁▁▂▇▃█▇▅▄▂▅▂▆▆▆▄▅▆▅▆▆▇▆▆▆▅▆▄▄▅
wandb:               lr ████████████▄▄▄▄▄▄▄▄▄▄▃▃▃▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_234907-3n5flas5

-----------------------
Changing augmentation to v48
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v48'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 64, 1250, 1)]   0                                                 
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 64, 1250, 1)     4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 64, 1250, 1)     0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 64, 1250, 16)    2320         conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 64, 1250, 16)    6416         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 64, 1250, 16)    32           max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_2 (Concatenate)         (None, 64, 1250, 48)    0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 32, 625, 48)     0            concatenate_2[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 32, 625, 48)     192          average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 32, 625, 48)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 32, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 32, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 16, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 16, 312, 32)     128          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 16, 312, 32)     0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 16, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 16, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 8, 156, 64)      0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 8, 156, 64)      256          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 8, 156, 64)      0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 8, 156, 128)     91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 8, 156, 128)     230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 4, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 4, 78, 128)      512          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 4, 78, 128)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 4, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 4, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 2, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 2, 39, 256)      1024         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 2, 39, 256)      0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 2, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 2, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               513          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
167/167 - 120s - loss: 1.0036 - accuracy: 0.5983 - val_loss: 1.5848 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.09468129436680828
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
167/167 - 120s - loss: 0.4706 - accuracy: 0.7479 - val_loss: 1.3407 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.13761381497668443
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
167/167 - 120s - loss: 0.2904 - accuracy: 0.8590 - val_loss: 0.7291 - val_accuracy: 0.5016
Confusion matrix: 
 [[275 298]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.48  0.52 ]
 [0.195 0.805]]
Validation f1: 17.74
Validation accuracy: 50.16
Validation recall: 80.49
Validation precision: 9.97
Validation AUC: 0.20698336282094304
Validation class accuracies: [0.4799301919720768, 0.8048780487804879]
Saving model...
Epoch 4/65
167/167 - 120s - loss: 0.2695 - accuracy: 0.8788 - val_loss: 0.3244 - val_accuracy: 0.8795
Confusion matrix: 
 [[538  35]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.951 0.049]]
Validation f1: 5.13
Validation accuracy: 87.95
Validation recall: 4.88
Validation precision: 5.41
Validation AUC: 0.10936753622029523
Validation class accuracies: [0.9389179755671903, 0.04878048780487805]
The validation tracker metric at 0.1774193548387097 hasn't increased by 0 in 1 epochs
Epoch 5/65
167/167 - 120s - loss: 0.2414 - accuracy: 0.8920 - val_loss: 0.6043 - val_accuracy: 0.7671
Confusion matrix: 
 [[454 119]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.585 0.415]]
Validation f1: 19.21
Validation accuracy: 76.71
Validation recall: 41.46
Validation precision: 12.50
Validation AUC: 0.26430344281899903
Validation class accuracies: [0.7923211169284468, 0.4146341463414634]
Saving model...
Epoch 6/65
167/167 - 120s - loss: 0.2041 - accuracy: 0.9149 - val_loss: 1.4587 - val_accuracy: 0.5879
Confusion matrix: 
 [[333 240]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.581 0.419]
 [0.317 0.683]]
Validation f1: 18.12
Validation accuracy: 58.79
Validation recall: 68.29
Validation precision: 10.45
Validation AUC: 0.31766830661195705
Validation class accuracies: [0.581151832460733, 0.6829268292682927]
The validation tracker metric at 0.192090395480226 hasn't increased by 0 in 1 epochs
Epoch 7/65
167/167 - 119s - loss: 0.1802 - accuracy: 0.9190 - val_loss: 0.4118 - val_accuracy: 0.8599
Confusion matrix: 
 [[508  65]
 [ 21  20]]
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.512 0.488]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 31.75
Validation accuracy: 85.99
Validation recall: 48.78
Validation precision: 23.53
Validation AUC: 0.23769416773797486
Validation class accuracies: [0.8865619546247818, 0.4878048780487805]
Saving model...
Epoch 8/65
167/167 - 120s - loss: 0.1567 - accuracy: 0.9325 - val_loss: 0.9489 - val_accuracy: 0.7296
Confusion matrix: 
 [[429 144]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.749 0.251]
 [0.537 0.463]]
Validation f1: 18.63
Validation accuracy: 72.96
Validation recall: 46.34
Validation precision: 11.66
Validation AUC: 0.35238808885276607
Validation class accuracies: [0.7486910994764397, 0.4634146341463415]
The validation tracker metric at 0.31746031746031744 hasn't increased by 0 in 1 epochs
Epoch 9/65
167/167 - 120s - loss: 0.1881 - accuracy: 0.9182 - val_loss: 1.0646 - val_accuracy: 0.7508
Confusion matrix: 
 [[441 132]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77  0.23 ]
 [0.512 0.488]]
Validation f1: 20.73
Validation accuracy: 75.08
Validation recall: 48.78
Validation precision: 13.16
Validation AUC: 0.2351903241676742
Validation class accuracies: [0.7696335078534031, 0.4878048780487805]
The validation tracker metric at 0.31746031746031744 hasn't increased by 0 in 2 epochs
Epoch 10/65
167/167 - 120s - loss: 0.1651 - accuracy: 0.9254 - val_loss: 2.8668 - val_accuracy: 0.4772
Confusion matrix: 
 [[261 312]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.455 0.545]
 [0.22  0.78 ]]
Validation f1: 16.62
Validation accuracy: 47.72
Validation recall: 78.05
Validation precision: 9.30
Validation AUC: 0.13758742710843877
Validation class accuracies: [0.45549738219895286, 0.7804878048780488]
The validation tracker metric at 0.31746031746031744 hasn't increased by 0 in 3 epochs
Epoch 11/65
167/167 - 119s - loss: 0.1246 - accuracy: 0.9467 - val_loss: 0.3274 - val_accuracy: 0.9039
Confusion matrix: 
 [[537  36]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.561 0.439]]
Validation f1: 37.89
Validation accuracy: 90.39
Validation recall: 43.90
Validation precision: 33.33
Validation AUC: 0.44401178875981895
Validation class accuracies: [0.93717277486911, 0.43902439024390244]
Saving model...
Epoch 12/65
167/167 - 120s - loss: 0.0700 - accuracy: 0.9704 - val_loss: 0.2816 - val_accuracy: 0.9137
Confusion matrix: 
 [[544  29]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.585 0.415]]
Validation f1: 39.08
Validation accuracy: 91.37
Validation recall: 41.46
Validation precision: 36.96
Validation AUC: 0.39544394896532026
Validation class accuracies: [0.9493891797556719, 0.4146341463414634]
Saving model...
Epoch 13/65
167/167 - 120s - loss: 0.0912 - accuracy: 0.9681 - val_loss: 7.3198 - val_accuracy: 0.1417
Confusion matrix: 
 [[ 50 523]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.087 0.913]
 [0.098 0.902]]
Validation f1: 12.31
Validation accuracy: 14.17
Validation recall: 90.24
Validation precision: 6.61
Validation AUC: 0.1729047990262268
Validation class accuracies: [0.08726003490401396, 0.9024390243902439]
The validation tracker metric at 0.3908045977011494 hasn't increased by 0 in 1 epochs
Epoch 14/65
167/167 - 120s - loss: 0.2240 - accuracy: 0.9126 - val_loss: 0.5753 - val_accuracy: 0.8958
Confusion matrix: 
 [[536  37]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.659 0.341]]
Validation f1: 30.43
Validation accuracy: 89.58
Validation recall: 34.15
Validation precision: 27.45
Validation AUC: 0.1804174272430576
Validation class accuracies: [0.9354275741710296, 0.34146341463414637]
The validation tracker metric at 0.3908045977011494 hasn't increased by 0 in 2 epochs
Epoch 15/65
167/167 - 120s - loss: 0.0856 - accuracy: 0.9606 - val_loss: 0.4829 - val_accuracy: 0.8290
Confusion matrix: 
 [[491  82]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.857 0.143]
 [0.561 0.439]]
Validation f1: 25.53
Validation accuracy: 82.90
Validation recall: 43.90
Validation precision: 18.00
Validation AUC: 0.3931516865753688
Validation class accuracies: [0.8568935427574171, 0.43902439024390244]
The validation tracker metric at 0.3908045977011494 hasn't increased by 0 in 3 epochs
Epoch 16/65
167/167 - 120s - loss: 0.0825 - accuracy: 0.9625 - val_loss: 0.5111 - val_accuracy: 0.8339
Confusion matrix: 
 [[488  85]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.852 0.148]
 [0.415 0.585]]
Validation f1: 32.00
Validation accuracy: 83.39
Validation recall: 58.54
Validation precision: 22.02
Validation AUC: 0.45062788746526006
Validation class accuracies: [0.8516579406631762, 0.5853658536585366]
The validation tracker metric at 0.3908045977011494 hasn't increased by 0 in 4 epochs
Epoch 17/65
167/167 - 120s - loss: 0.1054 - accuracy: 0.9591 - val_loss: 1.2169 - val_accuracy: 0.8893
Confusion matrix: 
 [[534  39]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.707 0.293]]
Validation f1: 26.09
Validation accuracy: 88.93
Validation recall: 29.27
Validation precision: 23.53
Validation AUC: 0.2894146563144569
Validation class accuracies: [0.9319371727748691, 0.2926829268292683]
The validation tracker metric at 0.3908045977011494 hasn't increased by 0 in 5 epochs
Epoch 18/65
167/167 - 120s - loss: 0.0982 - accuracy: 0.9606 - val_loss: 0.3634 - val_accuracy: 0.8974
Confusion matrix: 
 [[534  39]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.585 0.415]]
Validation f1: 35.05
Validation accuracy: 89.74
Validation recall: 41.46
Validation precision: 30.36
Validation AUC: 0.36929852205365093
Validation class accuracies: [0.9319371727748691, 0.4146341463414634]
The validation tracker metric at 0.3908045977011494 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 19/65
167/167 - 120s - loss: 0.0536 - accuracy: 0.9737 - val_loss: 0.3875 - val_accuracy: 0.8925
Confusion matrix: 
 [[526  47]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.463 0.537]]
Validation f1: 40.00
Validation accuracy: 89.25
Validation recall: 53.66
Validation precision: 31.88
Validation AUC: 0.486266293068084
Validation class accuracies: [0.9179755671902269, 0.5365853658536586]
Saving model...
Epoch 20/65
167/167 - 120s - loss: 0.0611 - accuracy: 0.9756 - val_loss: 0.3705 - val_accuracy: 0.9121
Confusion matrix: 
 [[543  30]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.585 0.415]]
Validation f1: 38.64
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 91.21
Validation recall: 41.46
Validation precision: 36.17
Validation AUC: 0.4228428489324256
Validation class accuracies: [0.9476439790575916, 0.4146341463414634]
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 1 epochs
Epoch 21/65
167/167 - 120s - loss: 0.0442 - accuracy: 0.9801 - val_loss: 0.3073 - val_accuracy: 0.9283
Confusion matrix: 
 [[551  22]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.537 0.463]]
Validation f1: 46.34
Validation accuracy: 92.83
Validation recall: 46.34
Validation precision: 46.34
Validation AUC: 0.4602932450001836
Validation class accuracies: [0.9616055846422339, 0.4634146341463415]
Saving model...
Epoch 22/65
167/167 - 120s - loss: 0.0321 - accuracy: 0.9846 - val_loss: 0.3558 - val_accuracy: 0.9218
Confusion matrix: 
 [[557  16]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.78  0.22 ]]
Validation f1: 27.27
Validation accuracy: 92.18
Validation recall: 21.95
Validation precision: 36.00
Validation AUC: 0.2782636599602427
Validation class accuracies: [0.9720767888307156, 0.21951219512195122]
The validation tracker metric at 0.4634146341463415 hasn't increased by 0 in 1 epochs
Epoch 23/65
167/167 - 120s - loss: 0.0415 - accuracy: 0.9831 - val_loss: 1.3274 - val_accuracy: 0.6873
Confusion matrix: 
 [[395 178]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.689 0.311]
 [0.341 0.659]]
Validation f1: 21.95
Validation accuracy: 68.73
Validation recall: 65.85
Validation precision: 13.17
Validation AUC: 0.31088617741871316
Validation class accuracies: [0.6893542757417103, 0.6585365853658537]
The validation tracker metric at 0.4634146341463415 hasn't increased by 0 in 2 epochs
Epoch 24/65
167/167 - 120s - loss: 0.0321 - accuracy: 0.9842 - val_loss: 0.3510 - val_accuracy: 0.9186
Confusion matrix: 
 [[544  29]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.512 0.488]]
Validation f1: 44.44
Validation accuracy: 91.86
Validation recall: 48.78
Validation precision: 40.82
Validation AUC: 0.4664709198486087
Validation class accuracies: [0.9493891797556719, 0.4878048780487805]
The validation tracker metric at 0.4634146341463415 hasn't increased by 0 in 3 epochs
Epoch 25/65
167/167 - 120s - loss: 0.0139 - accuracy: 0.9959 - val_loss: 0.3369 - val_accuracy: 0.9267
Confusion matrix: 
 [[552  21]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.585 0.415]]
Validation f1: 43.04
Validation accuracy: 92.67
Validation recall: 41.46
Validation precision: 44.74
Validation AUC: 0.4021276140251028
Validation class accuracies: [0.9633507853403142, 0.4146341463414634]
The validation tracker metric at 0.4634146341463415 hasn't increased by 0 in 4 epochs
Epoch 26/65
167/167 - 120s - loss: 0.0232 - accuracy: 0.9932 - val_loss: 0.3729 - val_accuracy: 0.9235
Confusion matrix: 
 [[557  16]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.756 0.244]]
Validation f1: 29.85
Validation accuracy: 92.35
Validation recall: 24.39
Validation precision: 38.46
Validation AUC: 0.3199460937428903
Validation class accuracies: [0.9720767888307156, 0.24390243902439024]
The validation tracker metric at 0.4634146341463415 hasn't increased by 0 in 5 epochs
Epoch 27/65
167/167 - 120s - loss: 0.0553 - accuracy: 0.9719 - val_loss: 0.4483 - val_accuracy: 0.9283
Confusion matrix: 
 [[554  19]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.61  0.39 ]]
Validation f1: 42.11
Validation accuracy: 92.83
Validation recall: 39.02
Validation precision: 45.71
Validation AUC: 0.3884364219736242
Validation class accuracies: [0.9668411867364747, 0.3902439024390244]
The validation tracker metric at 0.4634146341463415 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 28/65
167/167 - 120s - loss: 0.0232 - accuracy: 0.9902 - val_loss: 0.2892 - val_accuracy: 0.9381
Confusion matrix: 
 [[557  16]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.537 0.463]]
Validation f1: 50.00
Validation accuracy: 93.81
Validation recall: 46.34
Validation precision: 54.29
Validation AUC: 0.47555774540481865
Validation class accuracies: [0.9720767888307156, 0.4634146341463415]
Saving model...
Epoch 29/65
167/167 - 120s - loss: 0.0146 - accuracy: 0.9936 - val_loss: 0.3129 - val_accuracy: 0.9267
Confusion matrix: 
 [[550  23]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.537 0.463]]
Validation f1: 45.78
Validation accuracy: 92.67
Validation recall: 46.34
Validation precision: 45.24
Validation AUC: 0.4911939238632807
Validation class accuracies: [0.9598603839441536, 0.4634146341463415]
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
Epoch 30/65
167/167 - 120s - loss: 0.0198 - accuracy: 0.9921 - val_loss: 0.3393 - val_accuracy: 0.9381
Confusion matrix: 
 [[562  11]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.659 0.341]]
Validation f1: 42.42
Validation accuracy: 93.81
Validation recall: 34.15
Validation precision: 56.00
Validation AUC: 0.42769346304601574
Validation class accuracies: [0.9808027923211169, 0.34146341463414637]
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
Epoch 31/65
167/167 - 120s - loss: 0.0276 - accuracy: 0.9925 - val_loss: 0.6589 - val_accuracy: 0.8567
Confusion matrix: 
 [[494  79]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.22  0.78 ]]
Validation f1: 42.11
Validation accuracy: 85.67
Validation recall: 78.05
Validation precision: 28.83
Validation AUC: 0.4915758152956499
Validation class accuracies: [0.8621291448516579, 0.7804878048780488]
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
Epoch 32/65
167/167 - 120s - loss: 0.0418 - accuracy: 0.9861 - val_loss: 0.3518 - val_accuracy: 0.9283
Confusion matrix: 
 [[549  24]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.488 0.512]]
Validation f1: 48.84
Validation accuracy: 92.83
Validation recall: 51.22
Validation precision: 46.67
Validation AUC: 0.5469505886070218
Validation class accuracies: [0.9581151832460733, 0.5121951219512195]
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
Epoch 33/65
167/167 - 120s - loss: 0.0134 - accuracy: 0.9940 - val_loss: 0.3200 - val_accuracy: 0.9283
Confusion matrix: 
 [[556  17]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.659 0.341]]
Validation f1: 38.89
Validation accuracy: 92.83
Validation recall: 34.15
Validation precision: 45.16
Validation AUC: 0.4439246029324736
Validation class accuracies: [0.9703315881326352, 0.34146341463414637]
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
Epoch 34/65
167/167 - 120s - loss: 0.0195 - accuracy: 0.9940 - val_loss: 0.3491 - val_accuracy: 0.9414
Confusion matrix: 
 [[566   7]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.707 0.293]]
Validation f1: 40.00
Validation accuracy: 94.14
Validation recall: 29.27
Validation precision: 63.16
Validation AUC: 0.3899811569799184
Validation class accuracies: [0.987783595113438, 0.2926829268292683]
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 35/65
167/167 - 120s - loss: 0.0269 - accuracy: 0.9936 - val_loss: 0.3753 - val_accuracy: 0.9316
Confusion matrix: 
 [[553  20]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.537 0.463]]
Validation f1: 47.50
Validation accuracy: 93.16
Validation recall: 46.34
Validation precision: 48.72
Validation AUC: 0.4360451877936029
Validation class accuracies: [0.9650959860383944, 0.4634146341463415]
The validation tracker metric at 0.5 hasn't increased by 0 in 7 epochs
Epoch 36/65
167/167 - 120s - loss: 0.0094 - accuracy: 0.9944 - val_loss: 0.3521 - val_accuracy: 0.9300
Confusion matrix: 
 [[555  18]
 [ 25  16]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.61  0.39 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.67
Validation accuracy: 93.00
Validation recall: 39.02
Validation precision: 47.06
Validation AUC: 0.43937431107125635
Validation class accuracies: [0.9685863874345549, 0.3902439024390244]
The validation tracker metric at 0.5 hasn't increased by 0 in 8 epochs
Epoch 37/65
167/167 - 120s - loss: 0.0108 - accuracy: 0.9951 - val_loss: 0.3413 - val_accuracy: 0.9267
Confusion matrix: 
 [[550  23]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.78
Validation accuracy: 92.67
Validation recall: 46.34
Validation precision: 45.24
Validation AUC: 0.482393908244505
Validation class accuracies: [0.9598603839441536, 0.4634146341463415]
The validation tracker metric at 0.5 hasn't increased by 0 in 9 epochs
Epoch 38/65
167/167 - 120s - loss: 0.0122 - accuracy: 0.9951 - val_loss: 0.3316 - val_accuracy: 0.9349
Confusion matrix: 
 [[559  14]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.634 0.366]]
Validation f1: 42.86
Validation accuracy: 93.49
Validation recall: 36.59
Validation precision: 51.72
Validation AUC: 0.4551570213129361
Validation class accuracies: [0.9755671902268761, 0.36585365853658536]
The validation tracker metric at 0.5 hasn't increased by 0 in 10 epochs
Epoch 39/65
167/167 - 120s - loss: 0.0064 - accuracy: 0.9974 - val_loss: 0.3248 - val_accuracy: 0.9365
Confusion matrix: 
 [[557  16]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.561 0.439]]
Validation f1: 48.00
Validation accuracy: 93.65
Validation recall: 43.90
Validation precision: 52.94
Validation AUC: 0.4854721603873527
Validation class accuracies: [0.9720767888307156, 0.43902439024390244]
The validation tracker metric at 0.5 hasn't increased by 0 in 11 epochs
Epoch 40/65
167/167 - 120s - loss: 0.0069 - accuracy: 0.9985 - val_loss: 0.3427 - val_accuracy: 0.9300
Confusion matrix: 
 [[552  21]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 46.91
Validation accuracy: 93.00
Validation recall: 46.34
Validation precision: 47.50
Validation AUC: 0.49800133174520156
Validation class accuracies: [0.9633507853403142, 0.4634146341463415]
The validation tracker metric at 0.5 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 41/65
167/167 - 121s - loss: 0.0124 - accuracy: 0.9974 - val_loss: 0.3316 - val_accuracy: 0.9283
Confusion matrix: 
 [[553  20]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.585 0.415]]
Validation f1: 43.59
Validation accuracy: 92.83
Validation recall: 41.46
Validation precision: 45.95
Validation AUC: 0.4618035173602149
Validation class accuracies: [0.9650959860383944, 0.4146341463414634]
The validation tracker metric at 0.5 hasn't increased by 0 in 13 epochs
Epoch 42/65
167/167 - 121s - loss: 0.0077 - accuracy: 0.9970 - val_loss: 0.3301 - val_accuracy: 0.9316
Confusion matrix: 
 [[553  20]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.50
Validation accuracy: 93.16
Validation recall: 46.34
Validation precision: 48.72
Validation AUC: 0.4821229903597723
Validation class accuracies: [0.9650959860383944, 0.4634146341463415]
The validation tracker metric at 0.5 hasn't increased by 0 in 14 epochs
Epoch 43/65
167/167 - 121s - loss: 0.0039 - accuracy: 0.9996 - val_loss: 0.3307 - val_accuracy: 0.9349
Confusion matrix: 
 [[556  17]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.561 0.439]]
Validation f1: 47.37
Validation accuracy: 93.49
Validation recall: 43.90
Validation precision: 51.43
Validation AUC: 0.47587395262993404
Validation class accuracies: [0.9703315881326352, 0.43902439024390244]
The validation tracker metric at 0.5 hasn't increased by 0 in 15 epochs
Epoch 44/65
167/167 - 121s - loss: 0.0086 - accuracy: 0.9977 - val_loss: 0.3414 - val_accuracy: 0.9365
Confusion matrix: 
 [[556  17]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.35
Validation accuracy: 93.65
Validation recall: 46.34
Validation precision: 52.78
Validation AUC: 0.48385044953306605
Validation class accuracies: [0.9703315881326352, 0.4634146341463415]
The validation tracker metric at 0.5 hasn't increased by 0 in 16 epochs
Epoch 45/65
167/167 - 121s - loss: 0.0046 - accuracy: 0.9981 - val_loss: 0.3407 - val_accuracy: 0.9365
Confusion matrix: 
 [[557  16]
 [ 23  18]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.561 0.439]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.00
Validation accuracy: 93.65
Validation recall: 43.90
Validation precision: 52.94
Validation AUC: 0.4763822243246826
Validation class accuracies: [0.9720767888307156, 0.43902439024390244]
The validation tracker metric at 0.5 hasn't increased by 0 in 17 epochs
Epoch 46/65
167/167 - 121s - loss: 0.0039 - accuracy: 0.9985 - val_loss: 0.3408 - val_accuracy: 0.9349
Confusion matrix: 
 [[559  14]
 [ 26  15]]
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.634 0.366]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.86
Validation accuracy: 93.49
Validation recall: 36.59
Validation precision: 51.72
Validation AUC: 0.4551938216104168
Validation class accuracies: [0.9755671902268761, 0.36585365853658536]
The validation tracker metric at 0.5 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 47/65
167/167 - 117s - loss: 0.0071 - accuracy: 1.0000 - val_loss: 0.3400 - val_accuracy: 0.9349
Confusion matrix: 
 [[555  18]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.537 0.463]]
Validation f1: 48.72
Validation accuracy: 93.49
Validation recall: 46.34
Validation precision: 51.35
Validation AUC: 0.47910213211596564
Validation class accuracies: [0.9685863874345549, 0.4634146341463415]
The validation tracker metric at 0.5 hasn't increased by 0 in 19 epochs
Epoch 48/65
167/167 - 117s - loss: 0.0079 - accuracy: 0.9989 - val_loss: 0.3410 - val_accuracy: 0.9365
Confusion matrix: 
 [[556  17]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.35
Validation accuracy: 93.65
Validation recall: 46.34
Validation precision: 52.78
Validation AUC: 0.4753773310253285
Validation class accuracies: [0.9703315881326352, 0.4634146341463415]

The metrics for job 2 with the best target metric are: 
Best cm: [[557  16]
 [ 22  19]]
Best normalized cm: [[0.972 0.028]
 [0.537 0.463]]
Best f1: 0.50
Best accuracy: 0.94
Best recall: 0.46
Best precision: 0.54
Best AUC: 0.48
Best class accuracies: [0.9720767888307156, 0.4634146341463415]
Best epoch: 28
The number of epochs since last 1% equals the patience
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_226_1b1_Ll_sc_Meditron_2_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_207_2b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[1.591e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_211_2p4_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.064]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[8.584e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_213_1p5_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_222_1b1_Ar_sc_Meditron_11_label_0_pred_0.png, [[1.866e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_222_1b1_Lr_sc_Meditron_10_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_204_7p5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_211_2p3_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_221_2b2_Ar_mc_LittC2SE_3_label_0_pred_0.png, [[0.399]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1b1_Ar_sc_Meditron_6_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_213_1p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[2.447e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1b1_Pl_sc_Meditron_12_label_0_pred_0.png, [[0.331]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1b1_Ar_sc_Meditron_9_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1b1_Ar_sc_Meditron_10_label_0_pred_1.png, [[0.604]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_207_3b2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[2.744e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1p1_Ar_sc_Litt3200_4_label_0_pred_0.png, [[0.445]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_213_2p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[9.409e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_205_3b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[8.339e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1p1_Pl_sc_Litt3200_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_222_1b1_Lr_sc_Meditron_8_label_0_pred_0.png, [[0.047]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_205_2b3_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[1.478e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[1.14e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_222_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_221_2b3_Pr_mc_LittC2SE_1_label_0_pred_0.png, [[4.421e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[1.588e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.029]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_207_2b2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[4.453e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_218_1b1_Ar_sc_Meditron_11_label_0_pred_1.png, [[0.715]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_221_2b1_Pl_mc_LittC2SE_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[6.097e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_211_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_210_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.62e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_204_2b5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_221_2b1_Lr_mc_LittC2SE_3_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_219_2b1_Ar_mc_LittC2SE_2_label_1_pred_1.png, [[0.999]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_222_1b1_Ar_sc_Meditron_12_label_0_pred_0.png, [[1.092e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_223_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[4.526e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_219_2b3_Tc_mc_LittC2SE_3_label_1_pred_0.png, [[0.056]]
../../new_cache/conv__2255__06_2131__v39__augm_half/2/icbhi_217_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 28049
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_013436-rkybzipn/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_013436-rkybzipn/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99887
wandb:         val_accuracy 0.93648
wandb:             _runtime 6272
wandb:           _timestamp 1624677549
wandb:                _step 362
wandb:           train_loss 0.00794
wandb:             val_loss 0.34104
wandb:           val_recall 0.46341
wandb:        val_precision 0.52778
wandb:               val_f1 0.49351
wandb:              val_auc 0.47538
wandb:                   lr 3e-05
wandb:          best_val_f1 0.5
wandb:    best_val_accuracy 0.93811
wandb:   best_val_precision 0.54286
wandb:      best_val_recall 0.46341
wandb:             best_auc 0.47556
wandb:           best_epoch 28
wandb: Run history:
wandb:   train_accuracy ▁▄▆▆▆▇▇▇▇▇▇▆▇▇▇█████████████████████████
wandb:     val_accuracy ▁▁▄█▇▇▆▆▄█▂█▇▇█████▆█████▇██████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▃▃▂▂▂▂▂▂▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▁▁▁▁▂▂▄▁█▁▁▁▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ██▇▁▄▄▄▄▆▄▇▃▄▅▃▅▄▄▂▅▄▂▄▄▄▆▄▃▃▄▄▃▄▄▄▄▄▄▃▄
wandb:    val_precision ▁▁▂▁▂▃▂▂▁▄▁▄▃▃▃▄▅▆▅▂▆▅▆▇▆▄▆▆█▆▆▇▇▆▆▇▇▇▇▇
wandb:           val_f1 ▂▂▃▁▃▅▃▃▃▆▂▅▄▅▄▆▆▇▄▄▇▅▇█▇▇█▆▆█▇▇██▇███▇█
wandb:          val_auc ▁▂▃▁▄▃▅▃▂▆▂▂▆▇▄▇▆▇▄▄▆▄▆▇▇▇█▆▆▆▇▇▇▇▇▇▇▇▇▇
wandb:               lr ███████████████▄▄▄▄▄▄▄▄▃▃▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_013436-rkybzipn

-----------------------
Changing augmentation to v42, v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2874
-----------------------
Number of train recordings: 2874 with pneumonia: 474 and non-pneumonia: 2400
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 64, 1250, 1)]   0                                                 
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormal (None, 64, 1250, 1)     4            input_4[0][0]                        
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)      (None, 64, 1250, 1)     0            batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 64, 1250, 16)    2320         conv2d_15[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 64, 1250, 16)    6416         conv2d_17[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 64, 1250, 16)    32           max_pooling2d_3[0][0]                
______________________________________________________________________________________________________________
concatenate_3 (Concatenate)         (None, 64, 1250, 48)    0            conv2d_16[0][0]                      
                                                                         conv2d_18[0][0]                      
                                                                         conv2d_19[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePoolin (None, 32, 625, 48)     0            concatenate_3[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormal (None, 32, 625, 48)     192          average_pooling2d_15[0][0]           
______________________________________________________________________________________________________________
dropout_15 (Dropout)                (None, 32, 625, 48)     0            batch_normalization_19[0][0]         
______________________________________________________________________________________________________________
inverted_residual_30 (InvertedResid (None, 32, 625, 32)     35840        dropout_15[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_31 (InvertedResid (None, 32, 625, 32)     20864        inverted_residual_30[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePoolin (None, 16, 312, 32)     0            inverted_residual_31[0][0]           
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormal (None, 16, 312, 32)     128          average_pooling2d_16[0][0]           
______________________________________________________________________________________________________________
dropout_16 (Dropout)                (None, 16, 312, 32)     0            batch_normalization_20[0][0]         
______________________________________________________________________________________________________________
inverted_residual_32 (InvertedResid (None, 16, 312, 64)     27136        dropout_16[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_33 (InvertedResid (None, 16, 312, 64)     66304        inverted_residual_32[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePoolin (None, 8, 156, 64)      0            inverted_residual_33[0][0]           
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormal (None, 8, 156, 64)      256          average_pooling2d_17[0][0]           
______________________________________________________________________________________________________________
dropout_17 (Dropout)                (None, 8, 156, 64)      0            batch_normalization_21[0][0]         
______________________________________________________________________________________________________________
inverted_residual_34 (InvertedResid (None, 8, 156, 128)     91136        dropout_17[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_35 (InvertedResid (None, 8, 156, 128)     230912       inverted_residual_34[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePoolin (None, 4, 78, 128)      0            inverted_residual_35[0][0]           
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormal (None, 4, 78, 128)      512          average_pooling2d_18[0][0]           
______________________________________________________________________________________________________________
dropout_18 (Dropout)                (None, 4, 78, 128)      0            batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
inverted_residual_36 (InvertedResid (None, 4, 78, 256)      329728       dropout_18[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_37 (InvertedResid (None, 4, 78, 256)      855040       inverted_residual_36[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePoolin (None, 2, 39, 256)      0            inverted_residual_37[0][0]           
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormal (None, 2, 39, 256)      1024         average_pooling2d_19[0][0]           
______________________________________________________________________________________________________________
dropout_19 (Dropout)                (None, 2, 39, 256)      0            batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
inverted_residual_38 (InvertedResid (None, 2, 39, 512)      1249280      dropout_19[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_39 (InvertedResid (None, 2, 39, 512)      3282944      inverted_residual_38[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalA (None, 512)             0            inverted_residual_39[0][0]           
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 1)               513          global_average_pooling2d_3[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
180/180 - 125s - loss: 1.2299 - accuracy: 0.5348 - val_loss: 2.2722 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.08618432610900975
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
180/180 - 125s - loss: 0.5932 - accuracy: 0.6510 - val_loss: 1.4083 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.06124544738364993
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
180/180 - 125s - loss: 0.4834 - accuracy: 0.7394 - val_loss: 0.8509 - val_accuracy: 0.3876
Confusion matrix: 
 [[218 355]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.38  0.62 ]
 [0.512 0.488]]
Validation f1: 9.62
Validation accuracy: 38.76
Validation recall: 48.78
Validation precision: 5.33
Validation AUC: 0.04924422148649835
Validation class accuracies: [0.38045375218150085, 0.4878048780487805]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 4/65
180/180 - 125s - loss: 0.4126 - accuracy: 0.7891 - val_loss: 0.9025 - val_accuracy: 0.6661
Confusion matrix: 
 [[371 202]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.647 0.353]
 [0.073 0.927]]
Validation f1: 27.05
Validation accuracy: 66.61
Validation recall: 92.68
Validation precision: 15.83
Validation AUC: 0.5258520702253249
Validation class accuracies: [0.6474694589877836, 0.926829268292683]
Saving model...
Epoch 5/65
180/180 - 125s - loss: 0.4095 - accuracy: 0.8038 - val_loss: 5.5605 - val_accuracy: 0.4642
Confusion matrix: 
 [[255 318]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.445 0.555]
 [0.268 0.732]]
Validation f1: 15.42
Validation accuracy: 46.42
Validation recall: 73.17
Validation precision: 8.62
Validation AUC: 0.22722196894342564
Validation class accuracies: [0.44502617801047123, 0.7317073170731707]
The validation tracker metric at 0.2704626334519573 hasn't increased by 0 in 1 epochs
Epoch 6/65
180/180 - 125s - loss: 0.2892 - accuracy: 0.8493 - val_loss: 0.6358 - val_accuracy: 0.7785
Confusion matrix: 
 [[442 131]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.771 0.229]
 [0.122 0.878]]
Validation f1: 34.62
Validation accuracy: 77.85
Validation recall: 87.80
Validation precision: 21.56
Validation AUC: 0.3086583415437058
Validation class accuracies: [0.7713787085514834, 0.8780487804878049]
Saving model...
Epoch 7/65
180/180 - 125s - loss: 0.2928 - accuracy: 0.8643 - val_loss: 4.1115 - val_accuracy: 0.2671
Confusion matrix: 
 [[123 450]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.215 0.785]
 [0.    1.   ]]
Validation f1: 15.41
Validation accuracy: 26.71
Validation recall: 100.00
Validation precision: 8.35
Validation AUC: 0.3663328906986871
Validation class accuracies: [0.21465968586387435, 1.0]
The validation tracker metric at 0.34615384615384615 hasn't increased by 0 in 1 epochs
Epoch 8/65
180/180 - 125s - loss: 0.2552 - accuracy: 0.8880 - val_loss: 0.4788 - val_accuracy: 0.8404
Confusion matrix: 
 [[497  76]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.867 0.133]
 [0.537 0.463]]
Validation f1: 27.94
Validation accuracy: 84.04
Validation recall: 46.34
Validation precision: 20.00
Validation AUC: 0.16504565516553657
Validation class accuracies: [0.8673647469458988, 0.4634146341463415]
The validation tracker metric at 0.34615384615384615 hasn't increased by 0 in 2 epochs
Epoch 9/65
180/180 - 125s - loss: 0.2471 - accuracy: 0.8768 - val_loss: 0.5164 - val_accuracy: 0.8681
Confusion matrix: 
 [[514  59]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.537 0.463]]
Validation f1: 31.93
Validation accuracy: 86.81
Validation recall: 46.34
Validation precision: 24.36
Validation AUC: 0.17166408608646402
Validation class accuracies: [0.8970331588132635, 0.4634146341463415]
The validation tracker metric at 0.34615384615384615 hasn't increased by 0 in 3 epochs
Epoch 10/65
180/180 - 125s - loss: 0.2411 - accuracy: 0.8932 - val_loss: 5.9747 - val_accuracy: 0.1840
Confusion matrix: 
 [[ 78 495]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.136 0.864]
 [0.146 0.854]]
Validation f1: 12.26
Validation accuracy: 18.40
Validation recall: 85.37
Validation precision: 6.60
Validation AUC: 0.061462256045267546
Validation class accuracies: [0.13612565445026178, 0.8536585365853658]
The validation tracker metric at 0.34615384615384615 hasn't increased by 0 in 4 epochs
Epoch 11/65
180/180 - 125s - loss: 0.2851 - accuracy: 0.8636 - val_loss: 2.1320 - val_accuracy: 0.4674
Confusion matrix: 
 [[246 327]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.429 0.571]
 [0.    1.   ]]
Validation f1: 20.05
Validation accuracy: 46.74
Validation recall: 100.00
Validation precision: 11.14
Validation AUC: 0.48941608956272187
Validation class accuracies: [0.4293193717277487, 1.0]
The validation tracker metric at 0.34615384615384615 hasn't increased by 0 in 5 epochs
Epoch 12/65
180/180 - 125s - loss: 0.1617 - accuracy: 0.9238 - val_loss: 1.8668 - val_accuracy: 0.6303
Confusion matrix: 
 [[347 226]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.606 0.394]
 [0.024 0.976]]
Validation f1: 26.06
Validation accuracy: 63.03
Validation recall: 97.56
Validation precision: 15.04
Validation AUC: 0.6248749972640968
Validation class accuracies: [0.6055846422338569, 0.975609756097561]
The validation tracker metric at 0.34615384615384615 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
180/180 - 125s - loss: 0.1375 - accuracy: 0.9395 - val_loss: 0.5425 - val_accuracy: 0.8355
Confusion matrix: 
 [[480  93]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.22  0.78 ]]
Validation f1: 38.55
Validation accuracy: 83.39
Validation recall: 78.05
Validation precision: 25.60
Validation AUC: 0.49271815231785504
Validation class accuracies: [0.837696335078534, 0.7804878048780488]
Saving model...
Epoch 14/65
180/180 - 125s - loss: 0.1011 - accuracy: 0.9523 - val_loss: 0.2046 - val_accuracy: 0.9300
Confusion matrix: 
 [[549  24]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.463 0.537]]
Validation f1: 50.57
Validation accuracy: 93.00
Validation recall: 53.66
Validation precision: 47.83
Validation AUC: 0.541839782008704
Validation class accuracies: [0.9581151832460733, 0.5365853658536586]
Saving model...
Epoch 15/65
180/180 - 125s - loss: 0.0945 - accuracy: 0.9558 - val_loss: 0.7060 - val_accuracy: 0.7964
Confusion matrix: 
 [[469 104]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.512 0.488]]
Validation f1: 24.24
Validation accuracy: 79.64
Validation recall: 48.78
Validation precision: 16.13
Validation AUC: 0.13112294013376907
Validation class accuracies: [0.8184991273996509, 0.4878048780487805]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 1 epochs
Epoch 16/65
180/180 - 125s - loss: 0.0841 - accuracy: 0.9645 - val_loss: 0.5215 - val_accuracy: 0.8893
Confusion matrix: 
 [[519  54]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.341 0.659]]
Validation f1: 44.26
Validation accuracy: 88.93
Validation recall: 65.85
Validation precision: 33.33
Validation AUC: 0.5415102251244848
Validation class accuracies: [0.9057591623036649, 0.6585365853658537]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 2 epochs
Epoch 17/65
180/180 - 125s - loss: 0.0745 - accuracy: 0.9659 - val_loss: 0.4728 - val_accuracy: 0.9169
Confusion matrix: 
 [[539  34]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.415 0.585]]
Validation f1: 48.48
Validation accuracy: 91.69
Validation recall: 58.54
Validation precision: 41.38
Validation AUC: 0.4613380329161006
Validation class accuracies: [0.9406631762652705, 0.5853658536585366]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 3 epochs
Epoch 18/65
180/180 - 125s - loss: 0.0522 - accuracy: 0.9749 - val_loss: 1.5456 - val_accuracy: 0.7883
Confusion matrix: 
 [[453 120]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.791 0.209]
 [0.244 0.756]]
Validation f1: 32.29
Validation accuracy: 78.83
Validation recall: 75.61
Validation precision: 20.53
Validation AUC: 0.4499656826678251
Validation class accuracies: [0.7905759162303665, 0.7560975609756098]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 4 epochs
Epoch 19/65
180/180 - 125s - loss: 0.0833 - accuracy: 0.9631 - val_loss: 0.3868 - val_accuracy: 0.9055
Confusion matrix: 
 [[539  34]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.585 0.415]]
Validation f1: 36.96
Validation accuracy: 90.55
Validation recall: 41.46
Validation precision: 33.33
Validation AUC: 0.3717898563555276
Validation class accuracies: [0.9406631762652705, 0.4146341463414634]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 5 epochs
Epoch 20/65
180/180 - 125s - loss: 0.0936 - accuracy: 0.9621 - val_loss: 0.3939 - val_accuracy: 0.9267
Confusion matrix: 
 [[558  15]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.732 0.268]]
Validation f1: 32.84
Validation accuracy: 92.67
Validation recall: 26.83
Validation precision: 42.31
Validation AUC: 0.40835793695714606
Validation class accuracies: [0.9738219895287958, 0.2682926829268293]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 21/65
180/180 - 125s - loss: 0.0436 - accuracy: 0.9805 - val_loss: 0.2887 - val_accuracy: 0.9121
Confusion matrix: 
 [[547  26]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.683 0.317]]
Validation f1: 32.50
Validation accuracy: 91.21
Validation recall: 31.71
Validation precision: 33.33
Validation AUC: 0.4395233572795216
Validation class accuracies: [0.9546247818499127, 0.3170731707317073]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 7 epochs
Epoch 22/65
180/180 - 125s - loss: 0.0566 - accuracy: 0.9756 - val_loss: 0.5019 - val_accuracy: 0.8909
Confusion matrix: 
 [[522  51]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.39  0.61 ]]
Validation f1: 42.74
Validation accuracy: 89.09
Validation recall: 60.98
Validation precision: 32.89
Validation AUC: 0.4101178851555381
Validation class accuracies: [0.9109947643979057, 0.6097560975609756]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 8 epochs
Epoch 23/65
180/180 - 125s - loss: 0.0209 - accuracy: 0.9916 - val_loss: 0.3032 - val_accuracy: 0.9169
Confusion matrix: 
 [[544  29]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.537 0.463]]
Validation f1: 42.70
Validation accuracy: 91.69
Validation recall: 46.34
Validation precision: 39.58
Validation AUC: 0.45937794148295696
Validation class accuracies: [0.9493891797556719, 0.4634146341463415]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 9 epochs
Epoch 24/65
180/180 - 125s - loss: 0.0191 - accuracy: 0.9937 - val_loss: 0.2932 - val_accuracy: 0.9137
Confusion matrix: 
 [[544  29]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.585 0.415]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.08
Validation accuracy: 91.37
Validation recall: 41.46
Validation precision: 36.96
Validation AUC: 0.44691842335246124
Validation class accuracies: [0.9493891797556719, 0.4146341463414634]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 10 epochs
Epoch 25/65
180/180 - 125s - loss: 0.0207 - accuracy: 0.9916 - val_loss: 0.3544 - val_accuracy: 0.9186
Confusion matrix: 
 [[549  24]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.634 0.366]]
Validation f1: 37.50
Validation accuracy: 91.86
Validation recall: 36.59
Validation precision: 38.46
Validation AUC: 0.4310328595041652
Validation class accuracies: [0.9581151832460733, 0.36585365853658536]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 11 epochs
Epoch 26/65
180/180 - 125s - loss: 0.0218 - accuracy: 0.9910 - val_loss: 0.2937 - val_accuracy: 0.9218
Confusion matrix: 
 [[546  27]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.512 0.488]]
Validation f1: 45.45
Validation accuracy: 92.18
Validation recall: 48.78
Validation precision: 42.55
Validation AUC: 0.48672241315916387
Validation class accuracies: [0.9528795811518325, 0.4878048780487805]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 27/65
180/180 - 125s - loss: 0.0134 - accuracy: 0.9951 - val_loss: 0.3506 - val_accuracy: 0.9202
Confusion matrix: 
 [[544  29]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.488 0.512]]
Validation f1: 46.15
Validation accuracy: 92.02
Validation recall: 51.22
Validation precision: 42.00
Validation AUC: 0.4678589827412499
Validation class accuracies: [0.9493891797556719, 0.5121951219512195]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 13 epochs
Epoch 28/65
180/180 - 125s - loss: 0.0176 - accuracy: 0.9934 - val_loss: 0.4264 - val_accuracy: 0.9300
Confusion matrix: 
 [[546  27]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.39  0.61 ]]
Validation f1: 53.76
Validation accuracy: 93.00
Validation recall: 60.98
Validation precision: 48.08
Validation AUC: 0.5123802596797131
Validation class accuracies: [0.9528795811518325, 0.6097560975609756]
Saving model...
Epoch 29/65
180/180 - 125s - loss: 0.0152 - accuracy: 0.9934 - val_loss: 0.3606 - val_accuracy: 0.9104
Confusion matrix: 
 [[549  24]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.756 0.244]]
Validation f1: 26.67
Validation accuracy: 91.04
Validation recall: 24.39
Validation precision: 29.41
Validation AUC: 0.3780506432148751
Validation class accuracies: [0.9581151832460733, 0.24390243902439024]
The validation tracker metric at 0.5376344086021505 hasn't increased by 0 in 1 epochs
Epoch 30/65
180/180 - 125s - loss: 0.0117 - accuracy: 0.9965 - val_loss: 0.3703 - val_accuracy: 0.9137
Confusion matrix: 
 [[546  27]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.634 0.366]]
Validation f1: 36.14
Validation accuracy: 91.37
Validation recall: 36.59
Validation precision: 35.71
Validation AUC: 0.41606651858631394
Validation class accuracies: [0.9528795811518325, 0.36585365853658536]
The validation tracker metric at 0.5376344086021505 hasn't increased by 0 in 2 epochs
Epoch 31/65
180/180 - 125s - loss: 0.0163 - accuracy: 0.9948 - val_loss: 0.3857 - val_accuracy: 0.9055
Confusion matrix: 
 [[544  29]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.707 0.293]]
Validation f1: 29.27
Validation accuracy: 90.55
Validation recall: 29.27
Validation precision: 29.27
Validation AUC: 0.39173248334114846
Validation class accuracies: [0.9493891797556719, 0.2926829268292683]
The validation tracker metric at 0.5376344086021505 hasn't increased by 0 in 3 epochs
Epoch 32/65
180/180 - 130s - loss: 0.0124 - accuracy: 0.9962 - val_loss: 0.5368 - val_accuracy: 0.9283
Confusion matrix: 
 [[542  31]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.317 0.683]]
Validation f1: 56.00
Validation accuracy: 92.83
Validation recall: 68.29
Validation precision: 47.46
Validation AUC: 0.4410001941365939
Validation class accuracies: [0.9458987783595113, 0.6829268292682927]
Saving model...
Epoch 33/65
180/180 - 131s - loss: 0.0120 - accuracy: 0.9962 - val_loss: 0.4112 - val_accuracy: 0.9202
Confusion matrix: 
 [[543  30]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.463 0.537]]
Validation f1: 47.31
Validation accuracy: 92.02
Validation recall: 53.66
Validation precision: 42.31
Validation AUC: 0.4599583072013303
Validation class accuracies: [0.9476439790575916, 0.5365853658536586]
The validation tracker metric at 0.56 hasn't increased by 0 in 1 epochs
Epoch 34/65
180/180 - 131s - loss: 0.0113 - accuracy: 0.9955 - val_loss: 0.3432 - val_accuracy: 0.9186
Confusion matrix: 
 [[549  24]
 [ 26  15]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.634 0.366]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.50
Validation accuracy: 91.86
Validation recall: 36.59
Validation precision: 38.46
Validation AUC: 0.45377440755262594
Validation class accuracies: [0.9581151832460733, 0.36585365853658536]
The validation tracker metric at 0.56 hasn't increased by 0 in 2 epochs
Epoch 35/65
180/180 - 131s - loss: 0.0126 - accuracy: 0.9962 - val_loss: 0.4206 - val_accuracy: 0.9088
Confusion matrix: 
 [[545  28]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.683 0.317]]
Validation f1: 31.71
Validation accuracy: 90.88
Validation recall: 31.71
Validation precision: 31.71
Validation AUC: 0.39140802920158446
Validation class accuracies: [0.9511343804537522, 0.3170731707317073]
The validation tracker metric at 0.56 hasn't increased by 0 in 3 epochs
Epoch 36/65
180/180 - 131s - loss: 0.0065 - accuracy: 0.9986 - val_loss: 0.4590 - val_accuracy: 0.9153
Confusion matrix: 
 [[543  30]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.537 0.463]]
Validation f1: 42.22
Validation accuracy: 91.53
Validation recall: 46.34
Validation precision: 38.78
Validation AUC: 0.4305541219205536
Validation class accuracies: [0.9476439790575916, 0.4634146341463415]
The validation tracker metric at 0.56 hasn't increased by 0 in 4 epochs
Epoch 37/65
180/180 - 131s - loss: 0.0087 - accuracy: 0.9986 - val_loss: 0.3958 - val_accuracy: 0.9235
Confusion matrix: 
 [[545  28]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.463 0.537]]
Validation f1: 48.35
Validation accuracy: 92.35
Validation recall: 53.66
Validation precision: 44.00
Validation AUC: 0.4750768143808946
Validation class accuracies: [0.9511343804537522, 0.5365853658536586]
The validation tracker metric at 0.56 hasn't increased by 0 in 5 epochs
Epoch 38/65
180/180 - 131s - loss: 0.0194 - accuracy: 0.9920 - val_loss: 0.5690 - val_accuracy: 0.9088
Confusion matrix: 
 [[532  41]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.366 0.634]]
Validation f1: 48.15
Validation accuracy: 90.88
Validation recall: 63.41
Validation precision: 38.81
Validation AUC: 0.44420993134055803
Validation class accuracies: [0.9284467713787086, 0.6341463414634146]
The validation tracker metric at 0.56 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 39/65
180/180 - 131s - loss: 0.0136 - accuracy: 0.9941 - val_loss: 0.3955 - val_accuracy: 0.9169
Confusion matrix: 
 [[547  26]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.61  0.39 ]]
Validation f1: 38.55
Validation accuracy: 91.69
Validation recall: 39.02
Validation precision: 38.10
Validation AUC: 0.42598959266180064
Validation class accuracies: [0.9546247818499127, 0.3902439024390244]
The validation tracker metric at 0.56 hasn't increased by 0 in 7 epochs
Epoch 40/65
180/180 - 131s - loss: 0.0111 - accuracy: 0.9969 - val_loss: 0.3825 - val_accuracy: 0.9104
Confusion matrix: 
 [[545  28]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.659 0.341]]
Validation f1: 33.73
Validation accuracy: 91.04
Validation recall: 34.15
Validation precision: 33.33
Validation AUC: 0.4086952762504044
Validation class accuracies: [0.9511343804537522, 0.34146341463414637]
The validation tracker metric at 0.56 hasn't increased by 0 in 8 epochs
Epoch 41/65
180/180 - 131s - loss: 0.0058 - accuracy: 0.9990 - val_loss: 0.3900 - val_accuracy: 0.9153
Confusion matrix: 
 [[546  27]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.61  0.39 ]]
Validation f1: 38.10
Validation accuracy: 91.53
Validation recall: 39.02
Validation precision: 37.21
Validation AUC: 0.4294855345183025
Validation class accuracies: [0.9528795811518325, 0.3902439024390244]
The validation tracker metric at 0.56 hasn't increased by 0 in 9 epochs
Epoch 42/65
180/180 - 131s - loss: 0.0056 - accuracy: 0.9986 - val_loss: 0.3854 - val_accuracy: 0.9153
Confusion matrix: 
 [[548  25]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.659 0.341]]
Validation f1: 35.00
Validation accuracy: 91.53
Validation recall: 34.15
Validation precision: 35.90
Validation AUC: 0.41850489308004246
Validation class accuracies: [0.956369982547993, 0.34146341463414637]
The validation tracker metric at 0.56 hasn't increased by 0 in 10 epochs
Epoch 43/65
180/180 - 130s - loss: 0.0063 - accuracy: 0.9993 - val_loss: 0.4053 - val_accuracy: 0.9137
Confusion matrix: 
 [[544  29]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.585 0.415]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.08
Validation accuracy: 91.37
Validation recall: 41.46
Validation precision: 36.96
Validation AUC: 0.427098662520065
Validation class accuracies: [0.9493891797556719, 0.4146341463414634]
The validation tracker metric at 0.56 hasn't increased by 0 in 11 epochs
Epoch 44/65
180/180 - 131s - loss: 0.0065 - accuracy: 0.9990 - val_loss: 0.4401 - val_accuracy: 0.9153
Confusion matrix: 
 [[543  30]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.22
Validation accuracy: 91.53
Validation recall: 46.34
Validation precision: 38.78
Validation AUC: 0.4321722441184081
Validation class accuracies: [0.9476439790575916, 0.4634146341463415]
The validation tracker metric at 0.56 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 45/65
180/180 - 131s - loss: 0.0060 - accuracy: 0.9979 - val_loss: 0.4044 - val_accuracy: 0.9153
Confusion matrix: 
 [[546  27]
 [ 25  16]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.61  0.39 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.10
Validation accuracy: 91.53
Validation recall: 39.02
Validation precision: 37.21
Validation AUC: 0.41695707489151984
Validation class accuracies: [0.9528795811518325, 0.3902439024390244]
The validation tracker metric at 0.56 hasn't increased by 0 in 13 epochs
Epoch 46/65
180/180 - 131s - loss: 0.0054 - accuracy: 0.9983 - val_loss: 0.4193 - val_accuracy: 0.9137
Confusion matrix: 
 [[546  27]
 [ 26  15]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.634 0.366]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.14
Validation accuracy: 91.37
Validation recall: 36.59
Validation precision: 35.71
Validation AUC: 0.41234895201117727
Validation class accuracies: [0.9528795811518325, 0.36585365853658536]
The validation tracker metric at 0.56 hasn't increased by 0 in 14 epochs
Epoch 47/65
180/180 - 130s - loss: 0.0074 - accuracy: 0.9972 - val_loss: 0.4210 - val_accuracy: 0.9121
Confusion matrix: 
 [[543  30]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.585 0.415]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.64
Validation accuracy: 91.21
Validation recall: 41.46
Validation precision: 36.17
Validation AUC: 0.4116459605686187
Validation class accuracies: [0.9476439790575916, 0.4146341463414634]
The validation tracker metric at 0.56 hasn't increased by 0 in 15 epochs
Epoch 48/65
180/180 - 131s - loss: 0.0066 - accuracy: 0.9990 - val_loss: 0.4060 - val_accuracy: 0.9088
Confusion matrix: 
 [[544  29]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.659 0.341]]
Validation f1: 33.33
Validation accuracy: 90.88
Validation recall: 34.15
Validation precision: 32.56
Validation AUC: 0.4111027992505546
Validation class accuracies: [0.9493891797556719, 0.34146341463414637]
The validation tracker metric at 0.56 hasn't increased by 0 in 16 epochs
Epoch 49/65
180/180 - 130s - loss: 0.0039 - accuracy: 0.9993 - val_loss: 0.4017 - val_accuracy: 0.9121
Confusion matrix: 
 [[544  29]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.61  0.39 ]]
Validation f1: 37.21
Validation accuracy: 91.21
Validation recall: 39.02
Validation precision: 35.56
Validation AUC: 0.43214925149748595
Validation class accuracies: [0.9493891797556719, 0.3902439024390244]
The validation tracker metric at 0.56 hasn't increased by 0 in 17 epochs
Epoch 50/65
180/180 - 131s - loss: 0.0041 - accuracy: 0.9997 - val_loss: 0.3985 - val_accuracy: 0.9153
Confusion matrix: 
 [[545  28]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.585 0.415]]
Validation f1: 39.53
Validation accuracy: 91.53
Validation recall: 41.46
Validation precision: 37.78
Validation AUC: 0.4292081640906052
Validation class accuracies: [0.9511343804537522, 0.4146341463414634]
The validation tracker metric at 0.56 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 51/65
180/180 - 131s - loss: 0.0059 - accuracy: 0.9983 - val_loss: 0.4062 - val_accuracy: 0.9153
Confusion matrix: 
 [[545  28]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.585 0.415]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.53
Validation accuracy: 91.53
Validation recall: 41.46
Validation precision: 37.78
Validation AUC: 0.4379080928508233
Validation class accuracies: [0.9511343804537522, 0.4146341463414634]
The validation tracker metric at 0.56 hasn't increased by 0 in 19 epochs
Epoch 52/65
180/180 - 130s - loss: 0.0047 - accuracy: 0.9993 - val_loss: 0.4046 - val_accuracy: 0.9169
Confusion matrix: 
 [[545  28]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.561 0.439]]
Validation f1: 41.38
Validation accuracy: 91.69
Validation recall: 43.90
Validation precision: 39.13
Validation AUC: 0.4385325706014608
Validation class accuracies: [0.9511343804537522, 0.43902439024390244]

The metrics for job 3 with the best target metric are: 
Best cm: [[542  31]
 [ 13  28]]
Best normalized cm: [[0.946 0.054]
 [0.317 0.683]]
Best f1: 0.56
Best accuracy: 0.93
Best recall: 0.68
Best precision: 0.47
Best AUC: 0.44
Best class accuracies: [0.9458987783595113, 0.6829268292682927]
Best epoch: 32
The number of epochs since last 1% equals the patience
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[4.411e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_205_4b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[7.828e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_0.png, [[0.405]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_205_1b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[6.106e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_218_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_204_7p5_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[1.79e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/jordan_EP36_pneumonia,Crep,P R M,36,F_4_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_213_1p2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[8.166e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_207_2b3_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[9.649e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_213_2p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[4.111e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_222_1b1_Lr_sc_Meditron_11_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_213_2p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[7.481e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_218_1b1_Pr_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_218_1b1_Ar_sc_Meditron_13_label_0_pred_0.png, [[0.48]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_207_2b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[8.167e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_204_2b5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.7e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[2.893e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[9.694e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_207_2b4_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[1.779e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_222_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[7.331e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_213_1p5_Tc_mc_AKGC417L_0_label_0_pred_1.png, [[0.971]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_223_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[1.019e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_218_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[6.5e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_211_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.328e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_205_1b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.83e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_213_1p2_Lr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_204_7p5_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[3.22e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_213_2p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_207_2b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_213_1p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[5.301e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_207_2b4_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[8.343e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_203_2p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_0.png, [[0.125]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_218_1b1_Al_sc_Meditron_9_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_205_1b3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/3/icbhi_205_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.009]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 8067
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_031939-266ghw2a/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_031939-266ghw2a/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9993
wandb:         val_accuracy 0.91694
wandb:             _runtime 7151
wandb:           _timestamp 1624684730
wandb:                _step 384
wandb:           train_loss 0.00474
wandb:             val_loss 0.4046
wandb:           val_recall 0.43902
wandb:        val_precision 0.3913
wandb:               val_f1 0.41379
wandb:              val_auc 0.43853
wandb:                   lr 2e-05
wandb:          best_val_f1 0.56
wandb:    best_val_accuracy 0.92834
wandb:   best_val_precision 0.47458
wandb:      best_val_recall 0.68293
wandb:             best_auc 0.441
wandb:           best_epoch 32
wandb: Run history:
wandb:   train_accuracy ▁▃▄▅▆▆▆▆▆▇▇▇▇█▇▇████████████████████████
wandb:     val_accuracy ▁▁▄▆▇▃▇▂▄▆█▇█▇██████████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▄▃▃▃▂▂▃▂▂▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▄▂▂▂▂▆▁█▃▃▁▂▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ██▃▇▇█▃▇██▄▃▅▆▃▁▂▃▃▂▃▄▁▁▅▄▂▃▄▅▂▂▂▃▂▂▂▂▃▃
wandb:    val_precision ▁▁▁▃▄▁▃▁▂▃█▃▆▃▆▇▆▇▆▆▇█▅▅█▇▅▆▇▆▆▆▆▆▆▆▅▆▆▇
wandb:           val_f1 ▁▁▁▄▅▂▄▁▃▃▇▃▆▄▅▅▄▆▅▅▇█▄▄█▇▄▆▇▇▅▅▅▆▅▅▅▅▆▆
wandb:          val_auc ▁▁▁▇▄▅▂▁▆█▇▂▇▆▅▅▆▆▆▆▆▇▅▅▆▆▅▆▆▆▅▆▅▆▅▅▅▆▆▆
wandb:               lr ██████████▄▄▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_031939-266ghw2a

-----------------------
Model 9 with new params
Changing augmentation to time/frequency masking
Audio Augmentation Parameters: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Spec Augmentation Parameters: {'ADD': 1, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_2
Length of training samples after spec augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_3
Length of training samples after spec augmentation: 2716
-----------------------
Number of train recordings: 2716 with pneumonia: 316 and non-pneumonia: 2400
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_5 (InputLayer)                [(None, 64, 1250, 1)]   0                                                 
______________________________________________________________________________________________________________
batch_normalization_24 (BatchNormal (None, 64, 1250, 1)     4            input_5[0][0]                        
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                  (None, 64, 1250, 16)    32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)      (None, 64, 1250, 1)     0            batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                  (None, 64, 1250, 16)    2320         conv2d_20[0][0]                      
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                  (None, 64, 1250, 16)    6416         conv2d_22[0][0]                      
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                  (None, 64, 1250, 16)    32           max_pooling2d_4[0][0]                
______________________________________________________________________________________________________________
concatenate_4 (Concatenate)         (None, 64, 1250, 48)    0            conv2d_21[0][0]                      
                                                                         conv2d_23[0][0]                      
                                                                         conv2d_24[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_20 (AveragePoolin (None, 32, 625, 48)     0            concatenate_4[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_25 (BatchNormal (None, 32, 625, 48)     192          average_pooling2d_20[0][0]           
______________________________________________________________________________________________________________
dropout_20 (Dropout)                (None, 32, 625, 48)     0            batch_normalization_25[0][0]         
______________________________________________________________________________________________________________
inverted_residual_40 (InvertedResid (None, 32, 625, 32)     35840        dropout_20[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_41 (InvertedResid (None, 32, 625, 32)     20864        inverted_residual_40[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_21 (AveragePoolin (None, 16, 312, 32)     0            inverted_residual_41[0][0]           
______________________________________________________________________________________________________________
batch_normalization_26 (BatchNormal (None, 16, 312, 32)     128          average_pooling2d_21[0][0]           
______________________________________________________________________________________________________________
dropout_21 (Dropout)                (None, 16, 312, 32)     0            batch_normalization_26[0][0]         
______________________________________________________________________________________________________________
inverted_residual_42 (InvertedResid (None, 16, 312, 64)     27136        dropout_21[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_43 (InvertedResid (None, 16, 312, 64)     66304        inverted_residual_42[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_22 (AveragePoolin (None, 8, 156, 64)      0            inverted_residual_43[0][0]           
______________________________________________________________________________________________________________
batch_normalization_27 (BatchNormal (None, 8, 156, 64)      256          average_pooling2d_22[0][0]           
______________________________________________________________________________________________________________
dropout_22 (Dropout)                (None, 8, 156, 64)      0            batch_normalization_27[0][0]         
______________________________________________________________________________________________________________
inverted_residual_44 (InvertedResid (None, 8, 156, 128)     91136        dropout_22[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_45 (InvertedResid (None, 8, 156, 128)     230912       inverted_residual_44[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_23 (AveragePoolin (None, 4, 78, 128)      0            inverted_residual_45[0][0]           
______________________________________________________________________________________________________________
batch_normalization_28 (BatchNormal (None, 4, 78, 128)      512          average_pooling2d_23[0][0]           
______________________________________________________________________________________________________________
dropout_23 (Dropout)                (None, 4, 78, 128)      0            batch_normalization_28[0][0]         
______________________________________________________________________________________________________________
inverted_residual_46 (InvertedResid (None, 4, 78, 256)      329728       dropout_23[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_47 (InvertedResid (None, 4, 78, 256)      855040       inverted_residual_46[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_24 (AveragePoolin (None, 2, 39, 256)      0            inverted_residual_47[0][0]           
______________________________________________________________________________________________________________
batch_normalization_29 (BatchNormal (None, 2, 39, 256)      1024         average_pooling2d_24[0][0]           
______________________________________________________________________________________________________________
dropout_24 (Dropout)                (None, 2, 39, 256)      0            batch_normalization_29[0][0]         
______________________________________________________________________________________________________________
inverted_residual_48 (InvertedResid (None, 2, 39, 512)      1249280      dropout_24[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_49 (InvertedResid (None, 2, 39, 512)      3282944      inverted_residual_48[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_4 (GlobalA (None, 512)             0            inverted_residual_49[0][0]           
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 1)               513          global_average_pooling2d_4[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
170/170 - 126s - loss: 0.8945 - accuracy: 0.6127 - val_loss: 1.9084 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.0898460264916963
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
170/170 - 125s - loss: 0.5905 - accuracy: 0.6738 - val_loss: 2.4332 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.14574030341927957
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
170/170 - 125s - loss: 0.5055 - accuracy: 0.7007 - val_loss: 1.4578 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.3009722841529818
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 4/65
170/170 - 124s - loss: 0.3878 - accuracy: 0.7953 - val_loss: 0.2948 - val_accuracy: 0.8827
Confusion matrix: 
 [[507  66]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.146 0.854]]
Validation f1: 49.30
Validation accuracy: 88.27
Validation recall: 85.37
Validation precision: 34.65
Validation AUC: 0.5382051424358966
Validation class accuracies: [0.8848167539267016, 0.8536585365853658]
Saving model...
Epoch 5/65
170/170 - 124s - loss: 0.3898 - accuracy: 0.8082 - val_loss: 0.5111 - val_accuracy: 0.7769
Confusion matrix: 
 [[444 129]
 [  8  33]]
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.195 0.805]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 32.51
Validation accuracy: 77.69
Validation recall: 80.49
Validation precision: 20.37
Validation AUC: 0.3881867231642272
Validation class accuracies: [0.774869109947644, 0.8048780487804879]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 1 epochs
Epoch 6/65
170/170 - 125s - loss: 0.3143 - accuracy: 0.8557 - val_loss: 0.9060 - val_accuracy: 0.7883
Confusion matrix: 
 [[450 123]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.171 0.829]]
Validation f1: 34.34
Validation accuracy: 78.83
Validation recall: 82.93
Validation precision: 21.66
Validation AUC: 0.23352655936662237
Validation class accuracies: [0.7853403141361257, 0.8292682926829268]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 2 epochs
Epoch 7/65
170/170 - 125s - loss: 0.2643 - accuracy: 0.8792 - val_loss: 0.3185 - val_accuracy: 0.8306
Confusion matrix: 
 [[469 104]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.    1.   ]]
Validation f1: 44.09
Validation accuracy: 83.06
Validation recall: 100.00
Validation precision: 28.28
Validation AUC: 0.5716919307571025
Validation class accuracies: [0.8184991273996509, 1.0]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 3 epochs
Epoch 8/65
170/170 - 125s - loss: 0.2783 - accuracy: 0.8553 - val_loss: 0.3167 - val_accuracy: 0.8795
Confusion matrix: 
 [[510  63]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.268 0.732]]
Validation f1: 44.78
Validation accuracy: 87.95
Validation recall: 73.17
Validation precision: 32.26
Validation AUC: 0.507001739307509
Validation class accuracies: [0.8900523560209425, 0.7317073170731707]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 4 epochs
Epoch 9/65
170/170 - 124s - loss: 0.1951 - accuracy: 0.9072 - val_loss: 1.1656 - val_accuracy: 0.5717
Confusion matrix: 
 [[310 263]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.541 0.459]
 [0.    1.   ]]
Validation f1: 23.77
Validation accuracy: 57.17
Validation recall: 100.00
Validation precision: 13.49
Validation AUC: 0.43434064699138664
Validation class accuracies: [0.5410122164048866, 1.0]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 5 epochs
Epoch 10/65
170/170 - 125s - loss: 0.2736 - accuracy: 0.8873 - val_loss: 1.2025 - val_accuracy: 0.7117
Confusion matrix: 
 [[404 169]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.705 0.295]
 [0.195 0.805]]
Validation f1: 27.16
Validation accuracy: 71.17
Validation recall: 80.49
Validation precision: 16.34
Validation AUC: 0.18330741225961836
Validation class accuracies: [0.7050610820244329, 0.8048780487804879]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
170/170 - 125s - loss: 0.1759 - accuracy: 0.9083 - val_loss: 0.4819 - val_accuracy: 0.8681
Confusion matrix: 
 [[499  74]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.171 0.829]]
Validation f1: 45.64
Validation accuracy: 86.81
Validation recall: 82.93
Validation precision: 31.48
Validation AUC: 0.45946987996588406
Validation class accuracies: [0.8708551483420593, 0.8292682926829268]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 7 epochs
Epoch 12/65
170/170 - 125s - loss: 0.1303 - accuracy: 0.9396 - val_loss: 2.7567 - val_accuracy: 0.5163
Confusion matrix: 
 [[276 297]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.482 0.518]
 [0.    1.   ]]
Validation f1: 21.64
Validation accuracy: 51.63
Validation recall: 100.00
Validation precision: 12.13
Validation AUC: 0.2290594114481138
Validation class accuracies: [0.4816753926701571, 1.0]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 8 epochs
Epoch 13/65
170/170 - 124s - loss: 0.1382 - accuracy: 0.9392 - val_loss: 0.5374 - val_accuracy: 0.8550
Confusion matrix: 
 [[485  88]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.024 0.976]]
Validation f1: 47.34
Validation accuracy: 85.50
Validation recall: 97.56
Validation precision: 31.25
Validation AUC: 0.5294165207250767
Validation class accuracies: [0.8464223385689355, 0.975609756097561]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 9 epochs
Epoch 14/65
170/170 - 124s - loss: 0.1485 - accuracy: 0.9341 - val_loss: 2.1188 - val_accuracy: 0.6010
Confusion matrix: 
 [[328 245]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.572 0.428]
 [0.    1.   ]]
Validation f1: 25.08
Validation accuracy: 60.10
Validation recall: 100.00
Validation precision: 14.34
Validation AUC: 0.23614437193916446
Validation class accuracies: [0.5724258289703316, 1.0]
The validation tracker metric at 0.49295774647887325 hasn't increased by 0 in 10 epochs
Epoch 15/65
170/170 - 124s - loss: 0.1210 - accuracy: 0.9455 - val_loss: 0.3092 - val_accuracy: 0.9039
Confusion matrix: 
 [[519  54]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.122 0.878]]
Validation f1: 54.96
Validation accuracy: 90.39
Validation recall: 87.80
Validation precision: 40.00
Validation AUC: 0.7274052711700247
Validation class accuracies: [0.9057591623036649, 0.8780487804878049]
Saving model...
Epoch 16/65
170/170 - 125s - loss: 0.0690 - accuracy: 0.9694 - val_loss: 0.5425 - val_accuracy: 0.8779
Confusion matrix: 
 [[504  69]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.146 0.854]]
Validation f1: 48.28
Validation accuracy: 87.79
Validation recall: 85.37
Validation precision: 33.65
Validation AUC: 0.5159356573333405
Validation class accuracies: [0.8795811518324608, 0.8536585365853658]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 1 epochs
Epoch 17/65
170/170 - 125s - loss: 0.0660 - accuracy: 0.9691 - val_loss: 0.3823 - val_accuracy: 0.9169
Confusion matrix: 
 [[534  39]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.293 0.707]]
Validation f1: 53.21
Validation accuracy: 91.69
Validation recall: 70.73
Validation precision: 42.65
Validation AUC: 0.4332828298575573
Validation class accuracies: [0.9319371727748691, 0.7073170731707317]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 2 epochs
Epoch 18/65
170/170 - 125s - loss: 0.0862 - accuracy: 0.9650 - val_loss: 0.2963 - val_accuracy: 0.9088
Confusion matrix: 
 [[526  47]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.22  0.78 ]]
Validation f1: 53.33
Validation accuracy: 90.88
Validation recall: 78.05
Validation precision: 40.51
Validation AUC: 0.6237705824581457
Validation class accuracies: [0.9179755671902269, 0.7804878048780488]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 3 epochs
Epoch 19/65
170/170 - 122s - loss: 0.0794 - accuracy: 0.9669 - val_loss: 0.5502 - val_accuracy: 0.8111
Confusion matrix: 
 [[462 111]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.122 0.878]]
Validation f1: 38.30
Validation accuracy: 81.11
Validation recall: 87.80
Validation precision: 24.49
Validation AUC: 0.5475408658980429
Validation class accuracies: [0.806282722513089, 0.8780487804878049]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 4 epochs
Epoch 20/65
170/170 - 124s - loss: 0.0550 - accuracy: 0.9801 - val_loss: 1.2863 - val_accuracy: 0.7736
Confusion matrix: 
 [[436 137]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.761 0.239]
 [0.049 0.951]]
Validation f1: 35.94
Validation accuracy: 77.36
Validation recall: 95.12
Validation precision: 22.16
Validation AUC: 0.28811668801439294
Validation class accuracies: [0.7609075043630017, 0.9512195121951219]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 5 epochs
Epoch 21/65
170/170 - 125s - loss: 0.0953 - accuracy: 0.9621 - val_loss: 0.6596 - val_accuracy: 0.8436
Confusion matrix: 
 [[487  86]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85  0.15 ]
 [0.244 0.756]]
Validation f1: 39.24
Validation accuracy: 84.36
Validation recall: 75.61
Validation precision: 26.50
Validation AUC: 0.3393197951831083
Validation class accuracies: [0.849912739965096, 0.7560975609756098]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
170/170 - 125s - loss: 0.0294 - accuracy: 0.9860 - val_loss: 0.4146 - val_accuracy: 0.9055
Confusion matrix: 
 [[524  49]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.22  0.78 ]]
Validation f1: 52.46
Validation accuracy: 90.55
Validation recall: 78.05
Validation precision: 39.51
Validation AUC: 0.4503558046600124
Validation class accuracies: [0.9144851657940664, 0.7804878048780488]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 7 epochs
Epoch 23/65
170/170 - 125s - loss: 0.0340 - accuracy: 0.9864 - val_loss: 0.3003 - val_accuracy: 0.9169
Confusion matrix: 
 [[532  41]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.244 0.756]]
Validation f1: 54.87
Validation accuracy: 91.69
Validation recall: 75.61
Validation precision: 43.06
Validation AUC: 0.5449038632137625
Validation class accuracies: [0.9284467713787086, 0.7560975609756098]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 8 epochs
Epoch 24/65
170/170 - 125s - loss: 0.0517 - accuracy: 0.9794 - val_loss: 0.3613 - val_accuracy: 0.9121
Confusion matrix: 
 [[530  43]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.268 0.732]]
Validation f1: 52.63
Validation accuracy: 91.21
Validation recall: 73.17
Validation precision: 41.10
Validation AUC: 0.44990522404278593
Validation class accuracies: [0.924956369982548, 0.7317073170731707]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 9 epochs
Epoch 25/65
170/170 - 125s - loss: 0.0197 - accuracy: 0.9926 - val_loss: 0.3597 - val_accuracy: 0.9137
Confusion matrix: 
 [[529  44]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.22  0.78 ]]
Validation f1: 54.70
Validation accuracy: 91.37
Validation recall: 78.05
Validation precision: 42.11
Validation AUC: 0.4790047912377933
Validation class accuracies: [0.9232111692844677, 0.7804878048780488]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 10 epochs
Epoch 26/65
170/170 - 125s - loss: 0.0285 - accuracy: 0.9897 - val_loss: 0.3333 - val_accuracy: 0.9072
Confusion matrix: 
 [[532  41]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.39  0.61 ]]
Validation f1: 46.73
Validation accuracy: 90.72
Validation recall: 60.98
Validation precision: 37.88
Validation AUC: 0.44261811045028565
Validation class accuracies: [0.9284467713787086, 0.6097560975609756]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 11 epochs
Epoch 27/65
170/170 - 125s - loss: 0.0182 - accuracy: 0.9948 - val_loss: 0.4114 - val_accuracy: 0.9023
Confusion matrix: 
 [[530  43]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.415 0.585]]
Validation f1: 44.44
Validation accuracy: 90.23
Validation recall: 58.54
Validation precision: 35.82
Validation AUC: 0.4450162168741647
Validation class accuracies: [0.924956369982548, 0.5853658536585366]
The validation tracker metric at 0.549618320610687 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
170/170 - 124s - loss: 0.0132 - accuracy: 0.9945 - val_loss: 0.3355 - val_accuracy: 0.9202
Confusion matrix: 
 [[534  39]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.244 0.756]]
Validation f1: 55.86
Validation accuracy: 92.02
Validation recall: 75.61
Validation precision: 44.29
Validation AUC: 0.493076987793389
Validation class accuracies: [0.9319371727748691, 0.7560975609756098]
Saving model...
Epoch 29/65
170/170 - 124s - loss: 0.0113 - accuracy: 0.9963 - val_loss: 0.3447 - val_accuracy: 0.9186
Confusion matrix: 
 [[535  38]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.293 0.707]]
Validation f1: 53.70
Validation accuracy: 91.86
Validation recall: 70.73
Validation precision: 43.28
Validation AUC: 0.4847783726891622
Validation class accuracies: [0.9336823734729494, 0.7073170731707317]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 1 epochs
Epoch 30/65
170/170 - 125s - loss: 0.0130 - accuracy: 0.9971 - val_loss: 0.5014 - val_accuracy: 0.8974
Confusion matrix: 
 [[520  53]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.244 0.756]]
Validation f1: 49.60
Validation accuracy: 89.74
Validation recall: 75.61
Validation precision: 36.90
Validation AUC: 0.4628462853166357
Validation class accuracies: [0.9075043630017452, 0.7560975609756098]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 2 epochs
Epoch 31/65
170/170 - 124s - loss: 0.0121 - accuracy: 0.9930 - val_loss: 0.3726 - val_accuracy: 0.9169
Confusion matrix: 
 [[532  41]
 [ 10  31]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.244 0.756]]
Validation f1: 54.87
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 91.69
Validation recall: 75.61
Validation precision: 43.06
Validation AUC: 0.4979961204765799
Validation class accuracies: [0.9284467713787086, 0.7560975609756098]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 3 epochs
Epoch 32/65
170/170 - 125s - loss: 0.0099 - accuracy: 0.9978 - val_loss: 0.4913 - val_accuracy: 0.9072
Confusion matrix: 
 [[527  46]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.268 0.732]]
Validation f1: 51.28
Validation accuracy: 90.72
Validation recall: 73.17
Validation precision: 39.47
Validation AUC: 0.3960067796589035
Validation class accuracies: [0.9197207678883071, 0.7317073170731707]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 4 epochs
Epoch 33/65
170/170 - 125s - loss: 0.0112 - accuracy: 0.9974 - val_loss: 0.4896 - val_accuracy: 0.9007
Confusion matrix: 
 [[526  47]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.341 0.659]]
Validation f1: 46.96
Validation accuracy: 90.07
Validation recall: 65.85
Validation precision: 36.49
Validation AUC: 0.4395655924890156
Validation class accuracies: [0.9179755671902269, 0.6585365853658537]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 5 epochs
Epoch 34/65
170/170 - 125s - loss: 0.0109 - accuracy: 0.9971 - val_loss: 0.4245 - val_accuracy: 0.9072
Confusion matrix: 
 [[531  42]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.366 0.634]]
Validation f1: 47.71
Validation accuracy: 90.72
Validation recall: 63.41
Validation precision: 38.24
Validation AUC: 0.4231294202361155
Validation class accuracies: [0.9267015706806283, 0.6341463414634146]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 35/65
170/170 - 125s - loss: 0.0092 - accuracy: 0.9974 - val_loss: 0.3876 - val_accuracy: 0.9121
Confusion matrix: 
 [[533  40]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.341 0.659]]
Validation f1: 50.00
Validation accuracy: 91.21
Validation recall: 65.85
Validation precision: 40.30
Validation AUC: 0.46605327588772794
Validation class accuracies: [0.9301919720767888, 0.6585365853658537]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 7 epochs
Epoch 36/65
170/170 - 125s - loss: 0.0083 - accuracy: 0.9982 - val_loss: 0.3523 - val_accuracy: 0.9202
Confusion matrix: 
 [[534  39]
 [ 10  31]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.244 0.756]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.86
Validation accuracy: 92.02
Validation recall: 75.61
Validation precision: 44.29
Validation AUC: 0.4610745719432122
Validation class accuracies: [0.9319371727748691, 0.7560975609756098]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 8 epochs
Epoch 37/65
170/170 - 125s - loss: 0.0071 - accuracy: 0.9989 - val_loss: 0.4191 - val_accuracy: 0.9121
Confusion matrix: 
 [[532  41]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.317 0.683]]
Validation f1: 50.91
Validation accuracy: 91.21
Validation recall: 68.29
Validation precision: 40.58
Validation AUC: 0.48217473138791456
Validation class accuracies: [0.9284467713787086, 0.6829268292682927]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 9 epochs
Epoch 38/65
170/170 - 125s - loss: 0.0100 - accuracy: 0.9978 - val_loss: 0.4191 - val_accuracy: 0.9121
Confusion matrix: 
 [[532  41]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.91
Validation accuracy: 91.21
Validation recall: 68.29
Validation precision: 40.58
Validation AUC: 0.4751177344166327
Validation class accuracies: [0.9284467713787086, 0.6829268292682927]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 10 epochs
Epoch 39/65
170/170 - 125s - loss: 0.0080 - accuracy: 0.9978 - val_loss: 0.4095 - val_accuracy: 0.9169
Confusion matrix: 
 [[534  39]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.21
Validation accuracy: 91.69
Validation recall: 70.73
Validation precision: 42.65
Validation AUC: 0.5043093472342703
Validation class accuracies: [0.9319371727748691, 0.7073170731707317]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 11 epochs
Epoch 40/65
170/170 - 125s - loss: 0.0071 - accuracy: 0.9974 - val_loss: 0.4045 - val_accuracy: 0.9137
Confusion matrix: 
 [[534  39]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.341 0.659]]
Validation f1: 50.47
Validation accuracy: 91.37
Validation recall: 65.85
Validation precision: 40.91
Validation AUC: 0.4962646247336875
Validation class accuracies: [0.9319371727748691, 0.6585365853658537]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 41/65
170/170 - 125s - loss: 0.0061 - accuracy: 0.9993 - val_loss: 0.3887 - val_accuracy: 0.9202
Confusion matrix: 
 [[536  37]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.293 0.707]]
Validation f1: 54.21
Validation accuracy: 92.02
Validation recall: 70.73
Validation precision: 43.94
Validation AUC: 0.5094270183089737
Validation class accuracies: [0.9354275741710296, 0.7073170731707317]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 13 epochs
Epoch 42/65
170/170 - 125s - loss: 0.0071 - accuracy: 0.9989 - val_loss: 0.4240 - val_accuracy: 0.9186
Confusion matrix: 
 [[534  39]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.268 0.732]]
Validation f1: 54.55
Validation accuracy: 91.86
Validation recall: 73.17
Validation precision: 43.48
Validation AUC: 0.4991324353353184
Validation class accuracies: [0.9319371727748691, 0.7317073170731707]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 14 epochs
Epoch 43/65
170/170 - 125s - loss: 0.0052 - accuracy: 0.9982 - val_loss: 0.4010 - val_accuracy: 0.9169
Confusion matrix: 
 [[536  37]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.341 0.659]]
Validation f1: 51.43
Validation accuracy: 91.69
Validation recall: 65.85
Validation precision: 42.19
Validation AUC: 0.49682044365132894
Validation class accuracies: [0.9354275741710296, 0.6585365853658537]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 15 epochs
Epoch 44/65
170/170 - 125s - loss: 0.0079 - accuracy: 0.9978 - val_loss: 0.3595 - val_accuracy: 0.9186
Confusion matrix: 
 [[538  35]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.366 0.634]]
Validation f1: 50.98
Validation accuracy: 91.86
Validation recall: 63.41
Validation precision: 42.62
Validation AUC: 0.49493473114323816
Validation class accuracies: [0.9389179755671903, 0.6341463414634146]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 16 epochs
Epoch 45/65
170/170 - 125s - loss: 0.0063 - accuracy: 0.9993 - val_loss: 0.3728 - val_accuracy: 0.9137
Confusion matrix: 
 [[535  38]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.366 0.634]]
Validation f1: 49.52
Validation accuracy: 91.37
Validation recall: 63.41
Validation precision: 40.62
Validation AUC: 0.4787364966464008
Validation class accuracies: [0.9336823734729494, 0.6341463414634146]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 17 epochs
Epoch 46/65
170/170 - 125s - loss: 0.0067 - accuracy: 0.9974 - val_loss: 0.3461 - val_accuracy: 0.9186
Confusion matrix: 
 [[539  34]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.39  0.61 ]]
Validation f1: 50.00
Validation accuracy: 91.86
Validation recall: 60.98
Validation precision: 42.37
Validation AUC: 0.5312546349019089
Validation class accuracies: [0.9406631762652705, 0.6097560975609756]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 47/65
170/170 - 125s - loss: 0.0070 - accuracy: 0.9993 - val_loss: 0.3787 - val_accuracy: 0.9153
Confusion matrix: 
 [[536  37]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 91.53
Validation recall: 63.41
Validation precision: 41.27
Validation AUC: 0.5199561679404409
Validation class accuracies: [0.9354275741710296, 0.6341463414634146]
The validation tracker metric at 0.5585585585585585 hasn't increased by 0 in 19 epochs
Epoch 48/65
170/170 - 125s - loss: 0.0072 - accuracy: 0.9974 - val_loss: 0.4174 - val_accuracy: 0.9153
Confusion matrix: 
 [[535  38]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.341 0.659]]
Validation f1: 50.94
Validation accuracy: 91.53
Validation recall: 65.85
Validation precision: 41.54
Validation AUC: 0.527987927336962
Validation class accuracies: [0.9336823734729494, 0.6585365853658537]

The metrics for job 4 with the best target metric are: 
Best cm: [[534  39]
 [ 10  31]]
Best normalized cm: [[0.932 0.068]
 [0.244 0.756]]
Best f1: 0.56
Best accuracy: 0.92
Best recall: 0.76
Best precision: 0.44
Best AUC: 0.49
Best class accuracies: [0.9319371727748691, 0.7560975609756098]
Best epoch: 28
The number of epochs since last 1% equals the patience
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_221_2b3_Ar_mc_LittC2SE_2_label_0_pred_1.png, [[0.984]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_2b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_205_3b4_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[2.124e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_218_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[4.569e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_224_1b1_Tc_sc_Meditron_1_label_0_pred_0.png, [[1.643e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png, [[0.996]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_210_1b1_Al_sc_Meditron_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_203_2p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_223_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[1.699e-06]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_218_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_222_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_3b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_213_2p2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[1.072e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_2b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_213_1p5_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.173e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_205_1b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_211_2p3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[1.182e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_213_1p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[1.411e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_3b2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[6.405e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_205_1b3_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[3.097e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.044]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_205_1b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_221_2b3_Ar_mc_LittC2SE_3_label_0_pred_1.png, [[0.981]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_213_1p3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_222_1b1_Ar_sc_Meditron_7_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_2b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_205_1b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_2b4_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_2b4_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[1.162e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_223_1b1_Ll_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_223_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[2.214e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.383e-05]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_218_1b1_Pr_sc_Meditron_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_223_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_2b3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_2b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.051]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_218_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_203_2p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_211_2p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2255__06_2131__v39__augm_half/4/icbhi_207_2b3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[7.952e-06]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 27770
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_051930-2s7ajy03/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_051930-2s7ajy03/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99742
wandb:         val_accuracy 0.91531
wandb:             _runtime 6669
wandb:           _timestamp 1624691439
wandb:                _step 347
wandb:           train_loss 0.00721
wandb:             val_loss 0.41742
wandb:           val_recall 0.65854
wandb:        val_precision 0.41538
wandb:               val_f1 0.50943
wandb:              val_auc 0.52799
wandb:                   lr 2e-05
wandb:          best_val_f1 0.55856
wandb:    best_val_accuracy 0.9202
wandb:   best_val_precision 0.44286
wandb:      best_val_recall 0.7561
wandb:             best_auc 0.49308
wandb:           best_epoch 28
wandb: Run history:
wandb:   train_accuracy ▁▂▃▄▅▆▅▆▆▆▇▇▇▇▇▇█▇██████████████████████
wandb:     val_accuracy ▁▁▁█▇▇█▅▆█▇▅███▇▇▇██████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▅▄▄▃▃▂▃▂▂▂▂▂▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▆█▅▁▂▁▁▄▄▂▂▇▁▂▁▂▄▂▁▁▁▁▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ███▆▅█▃█▅▅██▆▆▃▆▇▄▄▄▄▁▁▄▃▄▃▂▂▂▃▃▃▂▃▂▂▂▁▂
wandb:    val_precision ▁▁▁▆▄▅▆▂▃▆▆▂▇▆█▄▄▅▇██▇▆███▇▇▇▇▇▇█▇███▇█▇
wandb:           val_f1 ▁▁▁▇▄▆▆▃▃▆▇▃█▇█▅▅▅▇██▇▆███▇▇▇▇▇▇█▇█▇▇▇▇▇
wandb:          val_auc ▁▂▃▆▄▆▆▅▂▅▆▃█▆▅▆▃▄▅▆▅▅▅▅▅▅▄▅▅▅▅▅▆▅▆▅▅▅▆▆
wandb:               lr █████████▄▄▄▄▄▄▄▄▄▃▃▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_051930-2s7ajy03

-----------------------

 See logs at ../../new_cache/conv__2255__06_2131__v39__augm_half/logs/