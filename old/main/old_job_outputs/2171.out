Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v33_augm_v0_cleaned_8000.pkl
File:  conv.train2171
Description:  model9_v33
2021-05-31 18:26:10.286332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-31 18:26:12.976717: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-31 18:26:12.977787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-31 18:26:13.035776: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:13.036534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-05-31 18:26:13.036565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-31 18:26:13.040232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-31 18:26:13.040317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-31 18:26:13.041398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-31 18:26:13.041693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-31 18:26:13.042717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-31 18:26:13.043587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-31 18:26:13.043751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-31 18:26:13.043870: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:13.044621: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:13.045375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2171.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v33_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2171__05_1825__v33__model9_v33/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.31 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2171
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/36jpl4zx
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210531_182613-36jpl4zx
wandb: Run `wandb offline` to turn off syncing.
2021-05-31 18:26:18.433174: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-31 18:26:18.433452: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:18.434581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-05-31 18:26:18.434645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-31 18:26:18.434708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-31 18:26:18.434744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-31 18:26:18.434774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-31 18:26:18.434805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-31 18:26:18.434835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-31 18:26:18.434866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-31 18:26:18.434894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-31 18:26:18.435035: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:18.436192: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:18.437239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-31 18:26:18.437308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-31 18:26:19.297293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-31 18:26:19.297344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-31 18:26:19.297360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-31 18:26:19.297689: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:19.298825: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:19.299835: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-31 18:26:19.300810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:05.0, compute capability: 7.0)
2021-05-31 18:26:59.314493: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-31 18:26:59.316141: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-31 18:27:02.586520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-31 18:27:03.109577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-31 18:27:03.116861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1086
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/80
263/263 - 215s - loss: 0.6574 - accuracy: 0.7050 - val_loss: 0.5018 - val_accuracy: 0.7993
Confusion matrix: 
 [[868   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.93
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23603644822685807
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1086    0]
cm_sum: 1086
The training is defaulting to either class.
Epoch 2/80
263/263 - 204s - loss: 0.5866 - accuracy: 0.7235 - val_loss: 0.4981 - val_accuracy: 0.7993
Confusion matrix: 
 [[868   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.93
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24552665850100214
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1086    0]
cm_sum: 1086
The training is defaulting to either class.
Epoch 3/80
263/263 - 205s - loss: 0.5837 - accuracy: 0.7212 - val_loss: 0.5838 - val_accuracy: 0.6998
Confusion matrix: 
 [[725 143]
 [183  35]]
Validation f1: 17.68
Validation accuracy: 69.98
Validation recall: 16.06
Validation precision: 19.66
Validation AUC: 0.22623008093087252
Validation class accuracies: [0.8352534562211982, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.1767676767676768
column_sums: [908 178]
cm_sum: 1086
inside not defaulting
Saving model...
Epoch 4/80
263/263 - 204s - loss: 0.5804 - accuracy: 0.7212 - val_loss: 0.5097 - val_accuracy: 0.7993
Confusion matrix: 
 [[868   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.93
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2707861158825269
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1086    0]
cm_sum: 1086
The training is defaulting to either class.
Epoch 5/80
263/263 - 205s - loss: 0.5751 - accuracy: 0.7257 - val_loss: 0.6578 - val_accuracy: 0.7937
Confusion matrix: 
 [[856  12]
 [212   6]]
Validation f1: 5.08
Validation accuracy: 79.37
Validation recall: 2.75
Validation precision: 33.33
Validation AUC: 0.2512671604861948
Validation class accuracies: [0.9861751152073732, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.05084745762711865
column_sums: [1068   18]
cm_sum: 1086
The training is defaulting to either class.
Epoch 6/80
263/263 - 205s - loss: 0.5734 - accuracy: 0.7235 - val_loss: 0.5180 - val_accuracy: 0.7956
Confusion matrix: 
 [[861   7]
 [215   3]]
Validation f1: 2.63
Validation accuracy: 79.56
Validation recall: 1.38
Validation precision: 30.00
Validation AUC: 0.20779972131235405
Validation class accuracies: [0.9919354838709677, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.026315789473684216
column_sums: [1076   10]
cm_sum: 1086
The training is defaulting to either class.
Epoch 7/80
263/263 - 202s - loss: 0.5701 - accuracy: 0.7216 - val_loss: 0.5974 - val_accuracy: 0.6851
Confusion matrix: 
 [[701 167]
 [175  43]]
Validation f1: 20.09
Validation accuracy: 68.51
Validation recall: 19.72
Validation precision: 20.48
Validation AUC: 0.23103410362702564
Validation class accuracies: [0.8076036866359447, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.20093457943925236
column_sums: [876 210]
cm_sum: 1086
inside not defaulting
Saving model...
Epoch 8/80
263/263 - 203s - loss: 0.5673 - accuracy: 0.7238 - val_loss: 0.5702 - val_accuracy: 0.7689
Confusion matrix: 
 [[831  37]
 [214   4]]
Validation f1: 3.09
Validation accuracy: 76.89
Validation recall: 1.83
Validation precision: 9.76
Validation AUC: 0.17018404648041255
Validation class accuracies: [0.9573732718894009, 0.01834862385321101]
TARGET: 1
target metric(test f1): 0.03088803088803089
column_sums: [1045   41]
cm_sum: 1086
The training is defaulting to either class.
Epoch 9/80
263/263 - 203s - loss: 0.5711 - accuracy: 0.7286 - val_loss: 0.7416 - val_accuracy: 0.6750
Confusion matrix: 
 [[666 202]
 [151  67]]
Validation f1: 27.52
Validation accuracy: 67.50
Validation recall: 30.73
Validation precision: 24.91
Validation AUC: 0.23407841281212294
Validation class accuracies: [0.7672811059907834, 0.3073394495412844]
TARGET: 1
target metric(test f1): 0.2751540041067762
column_sums: [817 269]
cm_sum: 1086
inside not defaulting
Saving model...
Epoch 10/80
263/263 - 203s - loss: 0.5665 - accuracy: 0.7295 - val_loss: 0.6329 - val_accuracy: 0.7090
Confusion matrix: 
 [[736 132]
 [184  34]]
Validation f1: 17.71
Validation accuracy: 70.90
Validation recall: 15.60
Validation precision: 20.48
Validation AUC: 0.20587459474279135
Validation class accuracies: [0.847926267281106, 0.1559633027522936]
TARGET: 1
target metric(test f1): 0.17708333333333334
column_sums: [920 166]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.2751540041067762 hasn't increased by 0 in 1 epochs
Epoch 11/80
263/263 - 203s - loss: 0.5599 - accuracy: 0.7336 - val_loss: 0.5161 - val_accuracy: 0.7947
Confusion matrix: 
 [[857  11]
 [212   6]]
Validation f1: 5.11
Validation accuracy: 79.47
Validation recall: 2.75
Validation precision: 35.29
Validation AUC: 0.2200487304462756
Validation class accuracies: [0.9873271889400922, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.05106382978723405
column_sums: [1069   17]
cm_sum: 1086
The training is defaulting to either class.
Epoch 12/80
263/263 - 202s - loss: 0.5556 - accuracy: 0.7324 - val_loss: 0.5176 - val_accuracy: 0.7993
Confusion matrix: 
 [[866   2]
 [216   2]]
Validation f1: 1.80
Validation accuracy: 79.93
Validation recall: 0.92
Validation precision: 50.00
Validation AUC: 0.20314365492386827
Validation class accuracies: [0.9976958525345622, 0.009174311926605505]
TARGET: 1
target metric(test f1): 0.01801801801801802
column_sums: [1082    4]
cm_sum: 1086
The training is defaulting to either class.
Epoch 13/80
263/263 - 202s - loss: 0.5530 - accuracy: 0.7333 - val_loss: 0.5046 - val_accuracy: 0.8057
Confusion matrix: 
 [[850  18]
 [193  25]]
Validation f1: 19.16
Validation accuracy: 80.57
Validation recall: 11.47
Validation precision: 58.14
Validation AUC: 0.306230853782281
Validation class accuracies: [0.9792626728110599, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.19157088122605367
column_sums: [1043   43]
cm_sum: 1086
The training is defaulting to either class.
Epoch 14/80
263/263 - 201s - loss: 0.5431 - accuracy: 0.7455 - val_loss: 0.5553 - val_accuracy: 0.7689
Confusion matrix: 
 [[828  40]
 [211   7]]
Validation f1: 5.28
Validation accuracy: 76.89
Validation recall: 3.21
Validation precision: 14.89
Validation AUC: 0.18972721117257668
Validation class accuracies: [0.9539170506912442, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.052830188679245285
column_sums: [1039   47]
cm_sum: 1086
The training is defaulting to either class.
Epoch 15/80
263/263 - 202s - loss: 0.5404 - accuracy: 0.7455 - val_loss: 0.6863 - val_accuracy: 0.6473
Confusion matrix: 
 [[610 258]
 [125  93]]
Validation f1: 32.69
Validation accuracy: 64.73
Validation recall: 42.66
Validation precision: 26.50
Validation AUC: 0.2502364614218574
Validation class accuracies: [0.7027649769585254, 0.42660550458715596]
TARGET: 1
target metric(test f1): 0.32688927943760987
column_sums: [735 351]
cm_sum: 1086
inside not defaulting
Saving model...
Epoch 16/80
263/263 - 202s - loss: 0.5300 - accuracy: 0.7550 - val_loss: 0.5496 - val_accuracy: 0.7735
Confusion matrix: 
 [[829  39]
 [207  11]]
Validation f1: 8.21
Validation accuracy: 77.35
Validation recall: 5.05
Validation precision: 22.00
Validation AUC: 0.19371354619072345
Validation class accuracies: [0.9550691244239631, 0.05045871559633028]
TARGET: 1
target metric(test f1): 0.08208955223880597
column_sums: [1036   50]
cm_sum: 1086
The training is defaulting to either class.
Epoch 17/80
263/263 - 202s - loss: 0.5223 - accuracy: 0.7560 - val_loss: 0.5430 - val_accuracy: 0.7910
Confusion matrix: 
 [[852  16]
 [211   7]]
Validation f1: 5.81
Validation accuracy: 79.10
Validation recall: 3.21
Validation precision: 30.43
Validation AUC: 0.2212150666644937
Validation class accuracies: [0.9815668202764977, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.058091286307053944
column_sums: [1063   23]
cm_sum: 1086
The training is defaulting to either class.
Epoch 18/80
263/263 - 203s - loss: 0.5200 - accuracy: 0.7519 - val_loss: 0.5597 - val_accuracy: 0.7514
Confusion matrix: 
 [[795  73]
 [197  21]]
Validation f1: 13.46
Validation accuracy: 75.14
Validation recall: 9.63
Validation precision: 22.34
Validation AUC: 0.22091854878746303
Validation class accuracies: [0.9158986175115207, 0.0963302752293578]
TARGET: 1
target metric(test f1): 0.1346153846153846
column_sums: [992  94]
cm_sum: 1086
The training is defaulting to either class.
Epoch 19/80
263/263 - 204s - loss: 0.5027 - accuracy: 0.7667 - val_loss: 0.5901 - val_accuracy: 0.7615
Confusion matrix: 
 [[817  51]
 [208  10]]
Validation f1: 7.17
Validation accuracy: 76.15
Validation recall: 4.59
Validation precision: 16.39
Validation AUC: 0.18195913050707135
Validation class accuracies: [0.9412442396313364, 0.045871559633027525]
TARGET: 1
target metric(test f1): 0.07168458781362007
column_sums: [1025   61]
cm_sum: 1086
The training is defaulting to either class.
Epoch 20/80
263/263 - 201s - loss: 0.4972 - accuracy: 0.7695 - val_loss: 0.6471 - val_accuracy: 0.7136
Confusion matrix: 
 [[729 139]
 [172  46]]
Validation f1: 22.83
Validation accuracy: 71.36
Validation recall: 21.10
Validation precision: 24.86
Validation AUC: 0.21590480476963567
Validation class accuracies: [0.8398617511520737, 0.21100917431192662]
TARGET: 1
target metric(test f1): 0.228287841191067
column_sums: [901 185]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.32688927943760987 hasn't increased by 0 in 1 epochs
Epoch 21/80
263/263 - 203s - loss: 0.4795 - accuracy: 0.7784 - val_loss: 0.6553 - val_accuracy: 0.7670
Confusion matrix: 
 [[818  50]
 [203  15]]
Validation f1: 10.60
Validation accuracy: 76.70
Validation recall: 6.88
Validation precision: 23.08
Validation AUC: 0.18264624335644725
Validation class accuracies: [0.9423963133640553, 0.06880733944954129]
TARGET: 1
target metric(test f1): 0.10600706713780919
column_sums: [1021   65]
cm_sum: 1086
The training is defaulting to either class.
Epoch 22/80
263/263 - 204s - loss: 0.4605 - accuracy: 0.7950 - val_loss: 0.6892 - val_accuracy: 0.7118
Confusion matrix: 
 [[727 141]
 [172  46]]
Validation f1: 22.72
Validation accuracy: 71.18
Validation recall: 21.10
Validation precision: 24.60
Validation AUC: 0.21784130593016726
Validation class accuracies: [0.8375576036866359, 0.21100917431192662]
TARGET: 1
target metric(test f1): 0.2271604938271605
column_sums: [899 187]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.32688927943760987 hasn't increased by 0 in 2 epochs
Epoch 23/80
263/263 - 203s - loss: 0.4460 - accuracy: 0.8008 - val_loss: 1.5139 - val_accuracy: 0.4429
Confusion matrix: 
 [[313 555]
 [ 50 168]]
Validation f1: 35.71
Validation accuracy: 44.29
Validation recall: 77.06
Validation precision: 23.24
Validation AUC: 0.24714553677285234
Validation class accuracies: [0.36059907834101385, 0.7706422018348624]
TARGET: 1
target metric(test f1): 0.35706695005313493
column_sums: [363 723]
cm_sum: 1086
inside not defaulting
Saving model...
Epoch 24/80
263/263 - 202s - loss: 0.4326 - accuracy: 0.8062 - val_loss: 0.6987 - val_accuracy: 0.7293
Confusion matrix: 
 [[761 107]
 [187  31]]
Validation f1: 17.42
Validation accuracy: 72.93
Validation recall: 14.22
Validation precision: 22.46
Validation AUC: 0.19671594884155355
Validation class accuracies: [0.8767281105990783, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.17415730337078653
column_sums: [948 138]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 1 epochs
Epoch 25/80
263/263 - 204s - loss: 0.4095 - accuracy: 0.8229 - val_loss: 0.8071 - val_accuracy: 0.6473
Confusion matrix: 
 [[625 243]
 [140  78]]
Validation f1: 28.94
Validation accuracy: 64.73
Validation recall: 35.78
Validation precision: 24.30
Validation AUC: 0.2219362730385942
Validation class accuracies: [0.7200460829493087, 0.3577981651376147]
TARGET: 1
target metric(test f1): 0.2894248608534323
column_sums: [765 321]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 2 epochs
Epoch 26/80
263/263 - 202s - loss: 0.3974 - accuracy: 0.8270 - val_loss: 0.7454 - val_accuracy: 0.7090
Confusion matrix: 
 [[740 128]
 [188  30]]
Validation f1: 15.96
Validation accuracy: 70.90
Validation recall: 13.76
Validation precision: 18.99
Validation AUC: 0.1921295678767807
Validation class accuracies: [0.8525345622119815, 0.13761467889908258]
TARGET: 1
target metric(test f1): 0.1595744680851064
column_sums: [928 158]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 3 epochs
Epoch 27/80
263/263 - 202s - loss: 0.3664 - accuracy: 0.8427 - val_loss: 0.7737 - val_accuracy: 0.7928
Confusion matrix: 
 [[858  10]
 [215   3]]
Validation f1: 2.60
Validation accuracy: 79.28
Validation recall: 1.38
Validation precision: 23.08
Validation AUC: 0.18136530098947756
Validation class accuracies: [0.988479262672811, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.025974025974025976
column_sums: [1073   13]
cm_sum: 1086
The training is defaulting to either class.
Epoch 28/80
263/263 - 204s - loss: 0.3509 - accuracy: 0.8506 - val_loss: 0.9773 - val_accuracy: 0.7836
Confusion matrix: 
 [[850  18]
 [217   1]]
Validation f1: 0.84
Validation accuracy: 78.36
Validation recall: 0.46
Validation precision: 5.26
Validation AUC: 0.16324750345607592
Validation class accuracies: [0.9792626728110599, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.008438818565400843
column_sums: [1067   19]
cm_sum: 1086
The training is defaulting to either class.
Epoch 29/80
263/263 - 203s - loss: 0.3271 - accuracy: 0.8627 - val_loss: 0.8871 - val_accuracy: 0.7044
Confusion matrix: 
 [[727 141]
 [180  38]]
Validation f1: 19.14
Validation accuracy: 70.44
Validation recall: 17.43
Validation precision: 21.23
Validation AUC: 0.20244064952238922
Validation class accuracies: [0.8375576036866359, 0.1743119266055046]
TARGET: 1
target metric(test f1): 0.19143576826196473
column_sums: [907 179]
cm_sum: 1086
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 4 epochs
Epoch 30/80
263/263 - 205s - loss: 0.2595 - accuracy: 0.9004 - val_loss: 0.9750 - val_accuracy: 0.7302
Confusion matrix: 
 [[782  86]
 [207  11]]
Validation f1: 6.98
Validation accuracy: 73.02
Validation recall: 5.05
Validation precision: 11.34
Validation AUC: 0.18780737180221266
Validation class accuracies: [0.9009216589861752, 0.05045871559633028]
TARGET: 1
target metric(test f1): 0.06984126984126984
column_sums: [989  97]
cm_sum: 1086
The training is defaulting to either class.
Epoch 31/80
263/263 - 202s - loss: 0.2402 - accuracy: 0.8973 - val_loss: 0.9295 - val_accuracy: 0.7440
Confusion matrix: 
 [[786  82]
 [196  22]]
Validation f1: 13.66
Validation accuracy: 74.40
Validation recall: 10.09
Validation precision: 21.15
Validation AUC: 0.1913872563664961
Validation class accuracies: [0.9055299539170507, 0.10091743119266056]
TARGET: 1
target metric(test f1): 0.13664596273291926
column_sums: [982 104]
cm_sum: 1086
The training is defaulting to either class.
Epoch 32/80
263/263 - 202s - loss: 0.2291 - accuracy: 0.9082 - val_loss: 1.0544 - val_accuracy: 0.6851
Confusion matrix: 
 [[701 167]
 [175  43]]
Validation f1: 20.09
Validation accuracy: 68.51
Validation recall: 19.72
Validation precision: 20.48
Validation AUC: 0.20438034586484485
Validation class accuracies: [0.8076036866359447, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.20093457943925236
column_sums: [876 210]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 5 epochs
Epoch 33/80
263/263 - 203s - loss: 0.2205 - accuracy: 0.9128 - val_loss: 1.1050 - val_accuracy: 0.6805
Confusion matrix: 
 [[691 177]
 [170  48]]
Validation f1: 21.67
Validation accuracy: 68.05
Validation recall: 22.02
Validation precision: 21.33
Validation AUC: 0.1995409394631454
Validation class accuracies: [0.7960829493087558, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.21670428893905191
column_sums: [861 225]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 6 epochs
Epoch 34/80
263/263 - 202s - loss: 0.2033 - accuracy: 0.9187 - val_loss: 1.1599 - val_accuracy: 0.6924
Confusion matrix: 
 [[719 149]
 [185  33]]
Validation f1: 16.50
Validation accuracy: 69.24
Validation recall: 15.14
Validation precision: 18.13
Validation AUC: 0.19920290974105767
Validation class accuracies: [0.8283410138248848, 0.15137614678899083]
TARGET: 1
target metric(test f1): 0.165
column_sums: [904 182]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 7 epochs
Epoch 35/80
263/263 - 202s - loss: 0.1998 - accuracy: 0.9223 - val_loss: 1.2267 - val_accuracy: 0.7145
Confusion matrix: 
 [[752 116]
 [194  24]]
Validation f1: 13.41
Validation accuracy: 71.45
Validation recall: 11.01
Validation precision: 17.14
Validation AUC: 0.19143491815483205
Validation class accuracies: [0.8663594470046083, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.1340782122905028
column_sums: [946 140]
cm_sum: 1086
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 8 epochs
Epoch 36/80
263/263 - 202s - loss: 0.1916 - accuracy: 0.9235 - val_loss: 1.1980 - val_accuracy: 0.7164
Confusion matrix: 
 [[760 108]
 [200  18]]
Validation f1: 10.47
Validation accuracy: 71.64
Validation recall: 8.26
Validation precision: 14.29
Validation AUC: 0.19172344830438545
Validation class accuracies: [0.8755760368663594, 0.08256880733944955]
TARGET: 1
target metric(test f1): 0.10465116279069768
column_sums: [960 126]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 9 epochs
Epoch 37/80
263/263 - 202s - loss: 0.1765 - accuracy: 0.9302 - val_loss: 1.1977 - val_accuracy: 0.7099
Confusion matrix: 
 [[747 121]
 [194  24]]
Validation f1: 13.22
Validation accuracy: 70.99
Validation recall: 11.01
Validation precision: 16.55
Validation AUC: 0.19540914656393696
Validation class accuracies: [0.8605990783410138, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.1322314049586777
column_sums: [941 145]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 10 epochs
Epoch 38/80
263/263 - 203s - loss: 0.1792 - accuracy: 0.9280 - val_loss: 1.2127 - val_accuracy: 0.7145
Confusion matrix: 
 [[756 112]
 [198  20]]
Validation f1: 11.43
Validation accuracy: 71.45
Validation recall: 9.17
Validation precision: 15.15
Validation AUC: 0.1905844479947628
Validation class accuracies: [0.8709677419354839, 0.09174311926605505]
TARGET: 1
target metric(test f1): 0.1142857142857143
column_sums: [954 132]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 11 epochs
Epoch 39/80
263/263 - 201s - loss: 0.1718 - accuracy: 0.9352 - val_loss: 1.2129 - val_accuracy: 0.7182
Confusion matrix: 
 [[760 108]
 [198  20]]
Validation f1: 11.56
Validation accuracy: 71.82
Validation recall: 9.17
Validation precision: 15.62
Validation AUC: 0.1901109486464778
Validation class accuracies: [0.8755760368663594, 0.09174311926605505]
TARGET: 1
target metric(test f1): 0.11560693641618497
column_sums: [958 128]
cm_sum: 1086
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 12 epochs
Epoch 40/80
263/263 - 202s - loss: 0.1639 - accuracy: 0.9376 - val_loss: 1.2451 - val_accuracy: 0.7118
Confusion matrix: 
 [[751 117]
 [196  22]]
Validation f1: 12.32
Validation accuracy: 71.18
Validation recall: 10.09
Validation precision: 15.83
Validation AUC: 0.1917538708148555
Validation class accuracies: [0.8652073732718893, 0.10091743119266056]
TARGET: 1
target metric(test f1): 0.12324929971988798
column_sums: [947 139]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 13 epochs
Epoch 41/80
263/263 - 201s - loss: 0.1618 - accuracy: 0.9373 - val_loss: 1.2815 - val_accuracy: 0.7201
Confusion matrix: 
 [[765 103]
 [201  17]]
Validation f1: 10.06
Validation accuracy: 72.01
Validation recall: 7.80
Validation precision: 14.17
Validation AUC: 0.1926208528143935
Validation class accuracies: [0.881336405529954, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.10059171597633138
column_sums: [966 120]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 14 epochs
Epoch 42/80
263/263 - 202s - loss: 0.1710 - accuracy: 0.9333 - val_loss: 1.2418 - val_accuracy: 0.7118
Confusion matrix: 
 [[751 117]
 [196  22]]
Validation f1: 12.32
Validation accuracy: 71.18
Validation recall: 10.09
Validation precision: 15.83
Validation AUC: 0.19377633068003797
Validation class accuracies: [0.8652073732718893, 0.10091743119266056]
TARGET: 1
target metric(test f1): 0.12324929971988798
column_sums: [947 139]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 15 epochs
Epoch 43/80
263/263 - 202s - loss: 0.1602 - accuracy: 0.9376 - val_loss: 1.2623 - val_accuracy: 0.7145
Confusion matrix: 
 [[755 113]
 [197  21]]
Validation f1: 11.93
Validation accuracy: 71.45
Validation recall: 9.63
Validation precision: 15.67
Validation AUC: 0.19350799639767363
Validation class accuracies: [0.869815668202765, 0.0963302752293578]
TARGET: 1
target metric(test f1): 0.11931818181818185
column_sums: [952 134]
cm_sum: 1086
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 16 epochs
Epoch 44/80
263/263 - 202s - loss: 0.1641 - accuracy: 0.9402 - val_loss: 1.2464 - val_accuracy: 0.7053
Confusion matrix: 
 [[740 128]
 [192  26]]
Validation f1: 13.98
Validation accuracy: 70.53
Validation recall: 11.93
Validation precision: 16.88
Validation AUC: 0.1943467935899464
Validation class accuracies: [0.8525345622119815, 0.11926605504587157]
TARGET: 1
target metric(test f1): 0.13978494623655915
column_sums: [932 154]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 17 epochs
Epoch 45/80
263/263 - 201s - loss: 0.1558 - accuracy: 0.9411 - val_loss: 1.2840 - val_accuracy: 0.7201
Confusion matrix: 
 [[763 105]
 [199  19]]
Validation f1: 11.11
Validation accuracy: 72.01
Validation recall: 8.72
Validation precision: 15.32
Validation AUC: 0.19181390098849352
Validation class accuracies: [0.8790322580645161, 0.0871559633027523]
TARGET: 1
target metric(test f1): 0.11111111111111112
column_sums: [962 124]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 18 epochs
Epoch 46/80
263/263 - 202s - loss: 0.1612 - accuracy: 0.9397 - val_loss: 1.2864 - val_accuracy: 0.7201
Confusion matrix: 
 [[764 104]
 [200  18]]
Validation f1: 10.59
Validation accuracy: 72.01
Validation recall: 8.26
Validation precision: 14.75
Validation AUC: 0.1921045594986336
Validation class accuracies: [0.880184331797235, 0.08256880733944955]
TARGET: 1
target metric(test f1): 0.10588235294117647
column_sums: [964 122]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 19 epochs
Epoch 47/80
263/263 - 203s - loss: 0.1666 - accuracy: 0.9318 - val_loss: 1.2869 - val_accuracy: 0.7219
Confusion matrix: 
 [[767 101]
 [201  17]]
Validation f1: 10.12
Validation accuracy: 72.19
Validation recall: 7.80
Validation precision: 14.41
Validation AUC: 0.19191661077499175
Validation class accuracies: [0.8836405529953917, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.10119047619047619
column_sums: [968 118]
cm_sum: 1086
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 20 epochs
Epoch 48/80
263/263 - 204s - loss: 0.1648 - accuracy: 0.9376 - val_loss: 1.2681 - val_accuracy: 0.7155
Confusion matrix: 
 [[757 111]
 [198  20]]
Validation f1: 11.46
Validation accuracy: 71.55
Validation recall: 9.17
Validation precision: 15.27
Validation AUC: 0.19248443033750584
Validation class accuracies: [0.8721198156682027, 0.09174311926605505]
TARGET: 1
target metric(test f1): 0.11461318051575932
column_sums: [955 131]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 21 epochs
Epoch 49/80
263/263 - 203s - loss: 0.1604 - accuracy: 0.9361 - val_loss: 1.2806 - val_accuracy: 0.7192
Confusion matrix: 
 [[762 106]
 [199  19]]
Validation f1: 11.08
Validation accuracy: 71.92
Validation recall: 8.72
Validation precision: 15.20
Validation AUC: 0.19216112180046382
Validation class accuracies: [0.8778801843317973, 0.0871559633027523]
TARGET: 1
target metric(test f1): 0.11078717201166181
column_sums: [961 125]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 22 epochs
Epoch 50/80
263/263 - 202s - loss: 0.1679 - accuracy: 0.9342 - val_loss: 1.2765 - val_accuracy: 0.7145
Confusion matrix: 
 [[756 112]
 [198  20]]
Validation f1: 11.43
Validation accuracy: 71.45
Validation recall: 9.17
Validation precision: 15.15
Validation AUC: 0.19263038557077067
Validation class accuracies: [0.8709677419354839, 0.09174311926605505]
TARGET: 1
target metric(test f1): 0.1142857142857143
column_sums: [954 132]
cm_sum: 1086
inside not defaulting
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 23 epochs
Epoch 51/80
263/263 - 204s - loss: 0.1521 - accuracy: 0.9447 - val_loss: 1.2745 - val_accuracy: 0.7173
Confusion matrix: 
 [[760 108]
 [199  19]]
Validation f1: 11.01
Validation accuracy: 71.73
Validation recall: 8.72
Validation precision: 14.96
Validation AUC: 0.19281357845225072
Validation class accuracies: [0.8755760368663594, 0.0871559633027523]
TARGET: 1
target metric(test f1): 0.1101449275362319
column_sums: [959 127]
cm_sum: 1086
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.35706695005313493 hasn't increased by 0 in 24 epochs
Epoch 52/80
263/263 - 201s - loss: 0.1666 - accuracy: 0.9364 - val_loss: 1.2639 - val_accuracy: 0.7109
Confusion matrix: 
 [[750 118]
 [196  22]]
Validation f1: 12.29
Validation accuracy: 71.09
Validation recall: 10.09
Validation precision: 15.71
Validation AUC: 0.1932649684743916
Validation class accuracies: [0.8640552995391705, 0.10091743119266056]

The metrics for the epoch with the best target metric are: 
Best cm: [[313 555]
 [ 50 168]]
Best f1: 0.35706695005313493
Best accuracy: 0.4429097605893186
Best recall: 0.7706422018348624
Best precision: 0.23236514522821577
Best AUC: 0.24714553677285234
Best epoch: 23
TARGET: 1
target metric(test f1): 0.12290502793296089
column_sums: [946 140]
cm_sum: 1086
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[32 28]
 [ 8  7]]
F1: 0.27999999999999997
AUC: 0.38666666666666666
Accuracy: 0.52
Precision: 0.2
Recall: 0.4666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[44 16]
 [13  2]]
F1: 0.1212121212121212
AUC: 0.2088888888888889
Accuracy: 0.6133333333333333
Precision: 0.1111111111111111
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[56  4]
 [14  1]]
F1: 0.1
AUC: 0.22666666666666668
Accuracy: 0.76
Precision: 0.2
Recall: 0.06666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_80.xls...
Done.
Epoch: epoch15
Starting...
CM: [[14 46]
 [ 0 15]]
F1: 0.3947368421052631
AUC: 0.6229508196721312
Accuracy: 0.38666666666666666
Precision: 0.2459016393442623
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch15.xls...
Done.
Epoch: epoch15
Starting...
CM: [[32 28]
 [ 2 13]]
F1: 0.4642857142857143
AUC: 0.6052032520325203
Accuracy: 0.6
Precision: 0.3170731707317073
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch15.xls...
Done.
Epoch: epoch15
Starting...
CM: [[39 21]
 [ 6  9]]
F1: 0.4
AUC: 0.49
Accuracy: 0.64
Precision: 0.3
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch15.xls...
Done.
Epoch: epoch23
Starting...
CM: [[ 2 58]
 [ 0 15]]
F1: 0.3409090909090909
AUC: 0.6027397260273972
Accuracy: 0.22666666666666666
Precision: 0.2054794520547945
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch23.xls...
Done.
Epoch: epoch23
Starting...
CM: [[ 5 55]
 [ 0 15]]
F1: 0.35294117647058826
AUC: 0.6071428571428571
Accuracy: 0.26666666666666666
Precision: 0.21428571428571427
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch23.xls...
Done.
Epoch: epoch23
Starting...
CM: [[12 48]
 [ 1 14]]
F1: 0.36363636363636365
AUC: 0.5862365591397849
Accuracy: 0.3466666666666667
Precision: 0.22580645161290322
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch23.xls...
Done.
Epoch: epoch3
Starting...
CM: [[26 34]
 [ 5 10]]
F1: 0.33898305084745756
AUC: 0.4803030303030303
Accuracy: 0.48
Precision: 0.22727272727272727
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[41 19]
 [12  3]]
F1: 0.16216216216216214
AUC: 0.24818181818181817
Accuracy: 0.5866666666666667
Precision: 0.13636363636363635
Recall: 0.2
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[49 11]
 [14  1]]
F1: 0.07407407407407407
AUC: 0.16833333333333333
Accuracy: 0.6666666666666666
Precision: 0.08333333333333333
Recall: 0.06666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch3.xls...
Done.
Epoch: epoch7
Starting...
CM: [[28 32]
 [ 5 10]]
F1: 0.3508771929824562
AUC: 0.4857142857142857
Accuracy: 0.5066666666666667
Precision: 0.23809523809523808
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch7.xls...
Done.
Epoch: epoch7
Starting...
CM: [[37 23]
 [11  4]]
F1: 0.19047619047619047
AUC: 0.28074074074074074
Accuracy: 0.5466666666666666
Precision: 0.14814814814814814
Recall: 0.26666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch7.xls...
Done.
Epoch: epoch7
Starting...
CM: [[49 11]
 [13  2]]
F1: 0.14285714285714288
AUC: 0.23025641025641025
Accuracy: 0.68
Precision: 0.15384615384615385
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch7.xls...
Done.
Epoch: epoch9
Starting...
CM: [[21 39]
 [ 3 12]]
F1: 0.3636363636363636
AUC: 0.5376470588235294
Accuracy: 0.44
Precision: 0.23529411764705882
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch9.xls...
Done.
Epoch: epoch9
Starting...
CM: [[34 26]
 [ 5 10]]
F1: 0.39215686274509803
AUC: 0.5055555555555555
Accuracy: 0.5866666666666667
Precision: 0.2777777777777778
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch9.xls...
Done.
Epoch: epoch9
Starting...
CM: [[45 15]
 [12  3]]
F1: 0.1818181818181818
AUC: 0.26333333333333336
Accuracy: 0.64
Precision: 0.16666666666666666
Recall: 0.2
Ended. Saving the Excel Sheet ../../new_cache/conv__2171__05_1825__v33__model9_v33/validation_sheet_epoch9.xls...
Done.
wandb: Waiting for W&B process to finish, PID 15838
wandb: Program ended successfully.
wandb: - 0.11MB of 0.11MB uploaded (0.00MB deduped)wandb: \ 0.11MB of 0.11MB uploaded (0.00MB deduped)wandb: | 0.11MB of 0.12MB uploaded (0.00MB deduped)wandb: / 0.12MB of 0.12MB uploaded (0.00MB deduped)wandb: - 0.12MB of 0.12MB uploaded (0.00MB deduped)wandb: \ 0.12MB of 0.12MB uploaded (0.00MB deduped)wandb: | 0.12MB of 0.12MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210531_182613-36jpl4zx/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210531_182613-36jpl4zx/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.93637
wandb:         val_accuracy 0.71087
wandb:             _runtime 11721
wandb:           _timestamp 1622497294
wandb:                _step 381
wandb:           train_loss 0.16662
wandb:             val_loss 1.26386
wandb:           val_recall 0.10092
wandb:        val_precision 0.15714
wandb:               val_f1 0.12291
wandb:              val_auc 0.19326
wandb:                   lr 0.0
wandb:          best_val_f1 0.35707
wandb:    best_val_accuracy 0.44291
wandb:   best_val_precision 0.23237
wandb:      best_val_recall 0.77064
wandb:             best_auc 0.24715
wandb:           best_epoch 23
wandb:           best_bd_f1 0.46429
wandb:          best_bd_auc 0.6052
wandb:     best_bd_accuracy 0.6
wandb:    best_bd_precision 0.31707
wandb:       best_bd_recall 0.86667
wandb:        best_bd_epoch epoch15
wandb: Run history:
wandb:   train_accuracy ▁▂▁▁▂▁▂▂▂▂▂▂▂▂▃▃▃▄▄▄▅▅▆▇▇▇▇▇████████████
wandb:     val_accuracy ██▆██▆▇▆██▇▅▇▇▇▆▇▁▇▅██▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▇▇▇▇▇▇▇▆▆▆▆▆▆▆▅▅▅▄▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▂▁▁▂▁▂▁▁▁▂▁▁▂▂▂█▂▃▃▄▄▄▅▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:       val_recall ▁▁▂▁▁▃▁▂▁▁▁▅▁▂▁▃▂█▂▄▁▁▃▂▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:    val_precision ▁▁▄▁▅▄▂▄▆█▃▅▄▄▃▄▄▄▄▄▄▂▄▄▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_f1 ▁▁▄▁▂▅▂▄▂▁▂▇▃▄▂▅▃█▄▇▂▁▅▄▅▅▄▃▄▃▃▃▃▄▃▃▃▃▃▃
wandb:          val_auc ▆▆▅█▄▅▁▄▅▄▃▇▃▅▂▄▂▆▃▅▂▁▄▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:               lr ███████████████████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 18 media file(s), 13 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2171: https://wandb.ai/arachid1/tensorboard-integration/runs/36jpl4zx


 See logs at ../../new_cache/conv__2171__05_1825__v33__model9_v33/logs/