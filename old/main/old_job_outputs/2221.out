Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2221
Description:  redo
2021-06-15 20:06:10.802332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-15 20:06:16.215257: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-15 20:06:16.216223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-15 20:06:16.263184: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:16.263880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-15 20:06:16.263912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 20:06:16.267397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 20:06:16.267496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-15 20:06:16.268574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-15 20:06:16.268900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-15 20:06:16.270016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-15 20:06:16.270903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-15 20:06:16.271080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 20:06:16.271193: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:16.271906: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:16.272527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2221.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2221__06_2005__v39__redo
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 140, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-15 20:06:21.733525: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-15 20:06:21.733801: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:21.734786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-15 20:06:21.734838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 20:06:21.734901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 20:06:21.734927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-15 20:06:21.734953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-15 20:06:21.734978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-15 20:06:21.735003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-15 20:06:21.735032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-15 20:06:21.735068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 20:06:21.735179: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:21.736140: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:21.737006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-15 20:06:21.737059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 20:06:22.626320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-15 20:06:22.626364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-15 20:06:22.626380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-15 20:06:22.626687: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:22.627761: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:22.628752: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:06:22.629740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 8)    16           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 8)    16           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 8)    584          conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 8)    1608         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 8)    16           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 24)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 24)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 24)     96           average_pooling2d[0][0]              
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 64, 625, 16)     400          batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 64, 625, 16)     400          batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 64, 625, 24)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 64, 625, 16)     2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 64, 625, 16)     6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 64, 625, 16)     400          max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 64, 625, 48)     0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 313, 48)     0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 313, 48)     192          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 32, 313, 32)     1568         batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 32, 313, 32)     1568         batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 32, 313, 48)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 32, 313, 32)     9248         conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 32, 313, 32)     25632        conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 32, 313, 32)     1568         max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_2 (Concatenate)         (None, 32, 313, 96)     0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 157, 96)     0            concatenate_2[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 157, 96)     384          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 16, 157, 64)     6208         batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 16, 157, 64)     6208         batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)      (None, 16, 157, 96)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 16, 157, 64)     36928        conv2d_15[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 16, 157, 64)     102464       conv2d_17[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 16, 157, 64)     6208         max_pooling2d_3[0][0]                
______________________________________________________________________________________________________________
concatenate_3 (Concatenate)         (None, 16, 157, 192)    0            conv2d_16[0][0]                      
                                                                         conv2d_18[0][0]                      
                                                                         conv2d_19[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 79, 192)      0            concatenate_3[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 79, 192)      768          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                  (None, 8, 79, 128)      24704        batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                  (None, 8, 79, 128)      24704        batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)      (None, 8, 79, 192)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                  (None, 8, 79, 128)      147584       conv2d_20[0][0]                      
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                  (None, 8, 79, 128)      409728       conv2d_22[0][0]                      
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                  (None, 8, 79, 128)      24704        max_pooling2d_4[0][0]                
______________________________________________________________________________________________________________
concatenate_4 (Concatenate)         (None, 8, 79, 384)      0            conv2d_21[0][0]                      
                                                                         conv2d_23[0][0]                      
                                                                         conv2d_24[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 40, 384)      0            concatenate_4[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 40, 384)      1536         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
conv2d_25 (Conv2D)                  (None, 4, 40, 256)      98560        batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_27 (Conv2D)                  (None, 4, 40, 256)      98560        batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)      (None, 4, 40, 384)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_26 (Conv2D)                  (None, 4, 40, 256)      590080       conv2d_25[0][0]                      
______________________________________________________________________________________________________________
conv2d_28 (Conv2D)                  (None, 4, 40, 256)      1638656      conv2d_27[0][0]                      
______________________________________________________________________________________________________________
conv2d_29 (Conv2D)                  (None, 4, 40, 256)      98560        max_pooling2d_5[0][0]                
______________________________________________________________________________________________________________
concatenate_5 (Concatenate)         (None, 4, 40, 768)      0            conv2d_26[0][0]                      
                                                                         conv2d_28[0][0]                      
                                                                         conv2d_29[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 2, 20, 768)      0            concatenate_5[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 2, 20, 768)      3072         average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 768)             0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               769          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 3,372,437
Trainable params: 3,369,411
Non-trainable params: 3,026
______________________________________________________________________________________________________________
2021-06-15 20:06:24.168812: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-15 20:06:24.171178: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-15 20:06:24.707924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 20:06:27.149554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 20:06:27.782792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
151/151 - 66s - loss: 0.4846 - accuracy: 0.7281 - val_loss: 0.2527 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.057396226060169045
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
151/151 - 59s - loss: 0.3724 - accuracy: 0.8336 - val_loss: 0.2205 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08805732235137573
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
151/151 - 59s - loss: 0.2997 - accuracy: 0.8634 - val_loss: 0.2555 - val_accuracy: 0.9091
Confusion matrix: 
 [[539  34]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.656 0.344]]
Validation f1: 28.57
Validation accuracy: 90.91
Validation recall: 34.38
Validation precision: 24.44
Validation AUC: 0.3194542520786565
Validation class accuracies: [0.9406631762652705, 0.34375]
Saving model...
Epoch 4/65
151/151 - 57s - loss: 0.2658 - accuracy: 0.8696 - val_loss: 0.2696 - val_accuracy: 0.9289
Confusion matrix: 
 [[556  17]
 [ 26   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.812 0.188]]
Validation f1: 21.82
Validation accuracy: 92.89
Validation recall: 18.75
Validation precision: 26.09
Validation AUC: 0.19459452268384447
Validation class accuracies: [0.9703315881326352, 0.1875]
The validation tracker metric at 0.2857142857142857 hasn't increased by 0 in 1 epochs
Epoch 5/65
151/151 - 57s - loss: 0.2160 - accuracy: 0.9002 - val_loss: 0.1632 - val_accuracy: 0.9455
Confusion matrix: 
 [[555  18]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.469 0.531]]
Validation f1: 50.75
Validation accuracy: 94.55
Validation recall: 53.12
Validation precision: 48.57
Validation AUC: 0.5215253050510587
Validation class accuracies: [0.9685863874345549, 0.53125]
Saving model...
Epoch 6/65
151/151 - 56s - loss: 0.1705 - accuracy: 0.9309 - val_loss: 0.4916 - val_accuracy: 0.9421
Confusion matrix: 
 [[570   3]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 94.21
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0701494073766242
Validation class accuracies: [0.9947643979057592, 0.0]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 1 epochs
Epoch 7/65
151/151 - 55s - loss: 0.1222 - accuracy: 0.9445 - val_loss: 2.6753 - val_accuracy: 0.3521
Confusion matrix: 
 [[181 392]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.316 0.684]
 [0.    1.   ]]
Validation f1: 14.04
Validation accuracy: 35.21
Validation recall: 100.00
Validation precision: 7.55
Validation AUC: 0.3847449527988758
Validation class accuracies: [0.3158813263525305, 1.0]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 2 epochs
Epoch 8/65
151/151 - 54s - loss: 0.1340 - accuracy: 0.9478 - val_loss: 0.5323 - val_accuracy: 0.7967
Confusion matrix: 
 [[463 110]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.808 0.192]
 [0.406 0.594]]
Validation f1: 23.60
Validation accuracy: 79.67
Validation recall: 59.38
Validation precision: 14.73
Validation AUC: 0.4049245233046228
Validation class accuracies: [0.8080279232111692, 0.59375]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 3 epochs
Epoch 9/65
151/151 - 57s - loss: 0.0747 - accuracy: 0.9665 - val_loss: 0.2528 - val_accuracy: 0.9603
Confusion matrix: 
 [[571   2]
 [ 22  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.688 0.312]]
Validation f1: 45.45
Validation accuracy: 96.03
Validation recall: 31.25
Validation precision: 83.33
Validation AUC: 0.43933706306206105
Validation class accuracies: [0.9965095986038395, 0.3125]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 4 epochs
Epoch 10/65
151/151 - 58s - loss: 0.0671 - accuracy: 0.9768 - val_loss: 0.2614 - val_accuracy: 0.9372
Confusion matrix: 
 [[553  20]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.562 0.438]]
Validation f1: 42.42
Validation accuracy: 93.72
Validation recall: 43.75
Validation precision: 41.18
Validation AUC: 0.4739503147872919
Validation class accuracies: [0.9650959860383944, 0.4375]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 5 epochs
Epoch 11/65
151/151 - 59s - loss: 0.0480 - accuracy: 0.9785 - val_loss: 2.1077 - val_accuracy: 0.4033
Confusion matrix: 
 [[216 357]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.377 0.623]
 [0.125 0.875]]
Validation f1: 13.43
Validation accuracy: 40.33
Validation recall: 87.50
Validation precision: 7.27
Validation AUC: 0.42655572254328317
Validation class accuracies: [0.3769633507853403, 0.875]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 12/65
151/151 - 63s - loss: 0.0312 - accuracy: 0.9892 - val_loss: 0.3086 - val_accuracy: 0.9488
Confusion matrix: 
 [[561  12]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.594 0.406]]
Validation f1: 45.61
Validation accuracy: 94.88
Validation recall: 40.62
Validation precision: 52.00
Validation AUC: 0.46262386115122317
Validation class accuracies: [0.9790575916230366, 0.40625]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 7 epochs
Epoch 13/65
151/151 - 62s - loss: 0.0232 - accuracy: 0.9954 - val_loss: 1.1358 - val_accuracy: 0.6198
Confusion matrix: 
 [[352 221]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.614 0.386]
 [0.281 0.719]]
Validation f1: 16.67
Validation accuracy: 61.98
Validation recall: 71.88
Validation precision: 9.43
Validation AUC: 0.4573897744650422
Validation class accuracies: [0.6143106457242583, 0.71875]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 8 epochs
Epoch 14/65
151/151 - 70s - loss: 0.0176 - accuracy: 0.9954 - val_loss: 0.2706 - val_accuracy: 0.9570
Confusion matrix: 
 [[567   6]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.625 0.375]]
Validation f1: 48.00
Validation accuracy: 95.70
Validation recall: 37.50
Validation precision: 66.67
Validation AUC: 0.4791283937198543
Validation class accuracies: [0.9895287958115183, 0.375]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 9 epochs
Epoch 15/65
151/151 - 63s - loss: 0.0187 - accuracy: 0.9959 - val_loss: 3.4398 - val_accuracy: 0.3603
Confusion matrix: 
 [[187 386]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.326 0.674]
 [0.031 0.969]]
Validation f1: 13.81
Validation accuracy: 36.03
Validation recall: 96.88
Validation precision: 7.43
Validation AUC: 0.37916704278052515
Validation class accuracies: [0.3263525305410122, 0.96875]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 10 epochs
Epoch 16/65
151/151 - 66s - loss: 0.0121 - accuracy: 0.9967 - val_loss: 0.3825 - val_accuracy: 0.9025
Confusion matrix: 
 [[530  43]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.5   0.5  ]]
Validation f1: 35.16
Validation accuracy: 90.25
Validation recall: 50.00
Validation precision: 27.12
Validation AUC: 0.4579965829014856
Validation class accuracies: [0.924956369982548, 0.5]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 11 epochs
Epoch 17/65
151/151 - 72s - loss: 0.0219 - accuracy: 0.9946 - val_loss: 0.3062 - val_accuracy: 0.9190
Confusion matrix: 
 [[538  35]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.438 0.562]]
Validation f1: 42.35
Validation accuracy: 91.90
Validation recall: 56.25
Validation precision: 33.96
Validation AUC: 0.5186904697808731
Validation class accuracies: [0.9389179755671903, 0.5625]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 18/65
151/151 - 70s - loss: 0.0092 - accuracy: 0.9992 - val_loss: 0.2972 - val_accuracy: 0.9372
Confusion matrix: 
 [[553  20]
 [ 18  14]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.562 0.438]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.42
Validation accuracy: 93.72
Validation recall: 43.75
Validation precision: 41.18
Validation AUC: 0.4804107272405822
Validation class accuracies: [0.9650959860383944, 0.4375]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 13 epochs
Epoch 19/65
151/151 - 73s - loss: 0.0127 - accuracy: 0.9975 - val_loss: 0.2813 - val_accuracy: 0.9372
Confusion matrix: 
 [[554  19]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.594 0.406]]
Validation f1: 40.62
Validation accuracy: 93.72
Validation recall: 40.62
Validation precision: 40.62
Validation AUC: 0.47824174639433614
Validation class accuracies: [0.9668411867364747, 0.40625]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 14 epochs
Epoch 20/65
151/151 - 74s - loss: 0.0102 - accuracy: 0.9988 - val_loss: 0.3566 - val_accuracy: 0.9140
Confusion matrix: 
 [[539  34]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.562 0.438]]
Validation f1: 35.00
Validation accuracy: 91.40
Validation recall: 43.75
Validation precision: 29.17
Validation AUC: 0.480832360301146
Validation class accuracies: [0.9406631762652705, 0.4375]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 15 epochs
Epoch 21/65
151/151 - 70s - loss: 0.0090 - accuracy: 0.9983 - val_loss: 0.2878 - val_accuracy: 0.9388
Confusion matrix: 
 [[554  19]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.562 0.438]]
Validation f1: 43.08
Validation accuracy: 93.88
Validation recall: 43.75
Validation precision: 42.42
Validation AUC: 0.48137818294341606
Validation class accuracies: [0.9668411867364747, 0.4375]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 16 epochs
Epoch 22/65
151/151 - 74s - loss: 0.0076 - accuracy: 0.9988 - val_loss: 0.2855 - val_accuracy: 0.9372
Confusion matrix: 
 [[554  19]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.594 0.406]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.62
Validation accuracy: 93.72
Validation recall: 40.62
Validation precision: 40.62
Validation AUC: 0.4805451682140762
Validation class accuracies: [0.9668411867364747, 0.40625]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 17 epochs
Epoch 23/65
151/151 - 63s - loss: 0.0097 - accuracy: 0.9988 - val_loss: 0.2834 - val_accuracy: 0.9355
Confusion matrix: 
 [[553  20]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.594 0.406]]
Validation f1: 40.00
Validation accuracy: 93.55
Validation recall: 40.62
Validation precision: 39.39
Validation AUC: 0.47782735339725946
Validation class accuracies: [0.9650959860383944, 0.40625]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 24/65
151/151 - 62s - loss: 0.0052 - accuracy: 0.9996 - val_loss: 0.2928 - val_accuracy: 0.9339
Confusion matrix: 
 [[552  21]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.594 0.406]]
Validation f1: 39.39
Validation accuracy: 93.39
Validation recall: 40.62
Validation precision: 38.24
Validation AUC: 0.47448373335864213
Validation class accuracies: [0.9633507853403142, 0.40625]
The validation tracker metric at 0.5074626865671641 hasn't increased by 0 in 19 epochs
Epoch 25/65
151/151 - 62s - loss: 0.0046 - accuracy: 1.0000 - val_loss: 0.2876 - val_accuracy: 0.9339
Confusion matrix: 
 [[552  21]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.594 0.406]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.39
Validation accuracy: 93.39
Validation recall: 40.62
Validation precision: 38.24
Validation AUC: 0.47313728207258976
Validation class accuracies: [0.9633507853403142, 0.40625]

The metrics for job 0 with the best target metric are: 
Best cm: [[555  18]
 [ 15  17]]
Best normalized cm: [[0.969 0.031]
 [0.469 0.531]]
Best f1: 0.51
Best accuracy: 0.95
Best recall: 0.53
Best precision: 0.49
Best AUC: 0.52
Best class accuracies: [0.9685863874345549, 0.53125]
Best epoch: 5
The number of epochs since last 1% equals the patience
-----------------------
Second model
-----------------------
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_30 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_31 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_32 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_33 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_34 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
151/151 - 64s - loss: 0.4521 - accuracy: 0.6962 - val_loss: 0.4715 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1666190372655463
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
151/151 - 62s - loss: 0.3158 - accuracy: 0.8622 - val_loss: 0.6959 - val_accuracy: 0.2909
Confusion matrix: 
 [[144 429]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.251 0.749]
 [0.    1.   ]]
Validation f1: 12.98
Validation accuracy: 29.09
Validation recall: 100.00
Validation precision: 6.94
Validation AUC: 0.2958669636061089
Validation class accuracies: [0.2513089005235602, 1.0]
Saving model...
Epoch 3/65
151/151 - 64s - loss: 0.2388 - accuracy: 0.8961 - val_loss: 0.3882 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.4357582238431294
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.12981744421906694 hasn't increased by 0 in 1 epochs
Epoch 4/65
151/151 - 62s - loss: 0.1896 - accuracy: 0.9197 - val_loss: 0.4067 - val_accuracy: 0.8777
Confusion matrix: 
 [[507  66]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.25  0.75 ]]
Validation f1: 39.34
Validation accuracy: 87.77
Validation recall: 75.00
Validation precision: 26.67
Validation AUC: 0.6084634170675524
Validation class accuracies: [0.8848167539267016, 0.75]
Saving model...
Epoch 5/65
151/151 - 63s - loss: 0.1454 - accuracy: 0.9404 - val_loss: 0.2412 - val_accuracy: 0.8893
Confusion matrix: 
 [[514  59]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.25  0.75 ]]
Validation f1: 41.74
Validation accuracy: 88.93
Validation recall: 75.00
Validation precision: 28.92
Validation AUC: 0.7049646507120816
Validation class accuracies: [0.8970331588132635, 0.75]
Saving model...
Epoch 6/65
151/151 - 63s - loss: 0.1078 - accuracy: 0.9615 - val_loss: 0.2757 - val_accuracy: 0.8975
Confusion matrix: 
 [[529  44]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.562 0.438]]
Validation f1: 31.11
Validation accuracy: 89.75
Validation recall: 43.75
Validation precision: 24.14
Validation AUC: 0.48804671589542553
Validation class accuracies: [0.9232111692844677, 0.4375]
The validation tracker metric at 0.417391304347826 hasn't increased by 0 in 1 epochs
Epoch 7/65
151/151 - 62s - loss: 0.0696 - accuracy: 0.9756 - val_loss: 0.2858 - val_accuracy: 0.9091
Confusion matrix: 
 [[529  44]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.344 0.656]]
Validation f1: 43.30
Validation accuracy: 90.91
Validation recall: 65.62
Validation precision: 32.31
Validation AUC: 0.5817616973963832
Validation class accuracies: [0.9232111692844677, 0.65625]
Saving model...
Epoch 8/65
151/151 - 62s - loss: 0.0532 - accuracy: 0.9822 - val_loss: 0.5123 - val_accuracy: 0.8198
Confusion matrix: 
 [[471 102]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.219 0.781]]
Validation f1: 31.45
Validation accuracy: 81.98
Validation recall: 78.12
Validation precision: 19.69
Validation AUC: 0.49551172580188335
Validation class accuracies: [0.8219895287958116, 0.78125]
The validation tracker metric at 0.43298969072164956 hasn't increased by 0 in 1 epochs
Epoch 9/65
151/151 - 63s - loss: 0.0336 - accuracy: 0.9925 - val_loss: 0.2585 - val_accuracy: 0.9256
Confusion matrix: 
 [[537  36]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.281 0.719]]
Validation f1: 50.55
Validation accuracy: 92.56
Validation recall: 71.88
Validation precision: 38.98
Validation AUC: 0.6177952480399523
Validation class accuracies: [0.93717277486911, 0.71875]
Saving model...
Epoch 10/65
151/151 - 62s - loss: 0.0214 - accuracy: 0.9954 - val_loss: 0.2104 - val_accuracy: 0.9355
Confusion matrix: 
 [[550  23]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.5  0.5 ]]
Validation f1: 45.07
Validation accuracy: 93.55
Validation recall: 50.00
Validation precision: 41.03
Validation AUC: 0.5571597800762886
Validation class accuracies: [0.9598603839441536, 0.5]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 1 epochs
Epoch 11/65
151/151 - 64s - loss: 0.0206 - accuracy: 0.9959 - val_loss: 0.2635 - val_accuracy: 0.9355
Confusion matrix: 
 [[553  20]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.594 0.406]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.00
Validation accuracy: 93.55
Validation recall: 40.62
Validation precision: 39.39
Validation AUC: 0.4706270704937164
Validation class accuracies: [0.9650959860383944, 0.40625]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 2 epochs
Epoch 12/65
151/151 - 62s - loss: 0.0232 - accuracy: 0.9930 - val_loss: 0.4001 - val_accuracy: 0.9273
Confusion matrix: 
 [[550  23]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.656 0.344]]
Validation f1: 33.33
Validation accuracy: 92.73
Validation recall: 34.38
Validation precision: 32.35
Validation AUC: 0.27140775394794675
Validation class accuracies: [0.9598603839441536, 0.34375]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 3 epochs
Epoch 13/65
151/151 - 62s - loss: 0.0208 - accuracy: 0.9950 - val_loss: 0.2421 - val_accuracy: 0.9273
Confusion matrix: 
 [[545  28]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.5   0.5  ]]
Validation f1: 42.11
Validation accuracy: 92.73
Validation recall: 50.00
Validation precision: 36.36
Validation AUC: 0.5182293422404917
Validation class accuracies: [0.9511343804537522, 0.5]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 4 epochs
Epoch 14/65
151/151 - 65s - loss: 0.0096 - accuracy: 0.9992 - val_loss: 0.2940 - val_accuracy: 0.9207
Confusion matrix: 
 [[542  31]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.531 0.469]]
Validation f1: 38.46
Validation accuracy: 92.07
Validation recall: 46.88
Validation precision: 32.61
Validation AUC: 0.4826736582110233
Validation class accuracies: [0.9458987783595113, 0.46875]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 5 epochs
Epoch 15/65
151/151 - 62s - loss: 0.0146 - accuracy: 0.9979 - val_loss: 1.0567 - val_accuracy: 0.8264
Confusion matrix: 
 [[470 103]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82  0.18 ]
 [0.062 0.938]]
Validation f1: 36.36
Validation accuracy: 82.64
Validation recall: 93.75
Validation precision: 22.56
Validation AUC: 0.47739306140136023
Validation class accuracies: [0.8202443280977313, 0.9375]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
151/151 - 62s - loss: 0.0085 - accuracy: 0.9975 - val_loss: 0.2686 - val_accuracy: 0.9306
Confusion matrix: 
 [[547  26]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.5   0.5  ]]
Validation f1: 43.24
Validation accuracy: 93.06
Validation recall: 50.00
Validation precision: 38.10
Validation AUC: 0.5358345102890051
Validation class accuracies: [0.9546247818499127, 0.5]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 7 epochs
Epoch 17/65
151/151 - 64s - loss: 0.0051 - accuracy: 1.0000 - val_loss: 0.2745 - val_accuracy: 0.9289
Confusion matrix: 
 [[545  28]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.469 0.531]]
Validation f1: 44.16
Validation accuracy: 92.89
Validation recall: 53.12
Validation precision: 37.78
Validation AUC: 0.5576991200669871
Validation class accuracies: [0.9511343804537522, 0.53125]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 8 epochs
Epoch 18/65
151/151 - 62s - loss: 0.0049 - accuracy: 1.0000 - val_loss: 0.3000 - val_accuracy: 0.9190
Confusion matrix: 
 [[539  34]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.469 0.531]]
Validation f1: 40.96
Validation accuracy: 91.90
Validation recall: 53.12
Validation precision: 33.33
Validation AUC: 0.5657476146680331
Validation class accuracies: [0.9406631762652705, 0.53125]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 9 epochs
Epoch 19/65
151/151 - 63s - loss: 0.0068 - accuracy: 0.9988 - val_loss: 0.3416 - val_accuracy: 0.9207
Confusion matrix: 
 [[537  36]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.375 0.625]]
Validation f1: 45.45
Validation accuracy: 92.07
Validation recall: 62.50
Validation precision: 35.71
Validation AUC: 0.6277427789657362
Validation class accuracies: [0.93717277486911, 0.625]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 10 epochs
Epoch 20/65
151/151 - 66s - loss: 0.0051 - accuracy: 1.0000 - val_loss: 0.3191 - val_accuracy: 0.9240
Confusion matrix: 
 [[538  35]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.344 0.656]]
Validation f1: 47.73
Validation accuracy: 92.40
Validation recall: 65.62
Validation precision: 37.50
Validation AUC: 0.6320869737056454
Validation class accuracies: [0.9389179755671903, 0.65625]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 11 epochs
Epoch 21/65
151/151 - 65s - loss: 0.0037 - accuracy: 1.0000 - val_loss: 0.3154 - val_accuracy: 0.9207
Confusion matrix: 
 [[538  35]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.406 0.594]]
Validation f1: 44.19
Validation accuracy: 92.07
Validation recall: 59.38
Validation precision: 35.19
Validation AUC: 0.5868294676014321
Validation class accuracies: [0.9389179755671903, 0.59375]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
151/151 - 63s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.3160 - val_accuracy: 0.9223
Confusion matrix: 
 [[539  34]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.406 0.594]]
Validation f1: 44.71
Validation accuracy: 92.23
Validation recall: 59.38
Validation precision: 35.85
Validation AUC: 0.5856663203927706
Validation class accuracies: [0.9406631762652705, 0.59375]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 13 epochs
Epoch 23/65
151/151 - 64s - loss: 0.0043 - accuracy: 1.0000 - val_loss: 0.3271 - val_accuracy: 0.9207
Confusion matrix: 
 [[537  36]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.45
Validation accuracy: 92.07
Validation recall: 62.50
Validation precision: 35.71
Validation AUC: 0.6103800102591405
Validation class accuracies: [0.93717277486911, 0.625]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 14 epochs
Epoch 24/65
151/151 - 63s - loss: 0.0046 - accuracy: 1.0000 - val_loss: 0.3313 - val_accuracy: 0.9207
Confusion matrix: 
 [[538  35]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.19
Validation accuracy: 92.07
Validation recall: 59.38
Validation precision: 35.19
Validation AUC: 0.5766288649227812
Validation class accuracies: [0.9389179755671903, 0.59375]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 15 epochs
Epoch 25/65
151/151 - 65s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.3334 - val_accuracy: 0.9207
Confusion matrix: 
 [[538  35]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.19
Validation accuracy: 92.07
Validation recall: 59.38
Validation precision: 35.19
Validation AUC: 0.5825639689792108
Validation class accuracies: [0.9389179755671903, 0.59375]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 16 epochs
Epoch 26/65
151/151 - 67s - loss: 0.0032 - accuracy: 1.0000 - val_loss: 0.3592 - val_accuracy: 0.9207
Confusion matrix: 
 [[538  35]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.19
Validation accuracy: 92.07
Validation recall: 59.38
Validation precision: 35.19
Validation AUC: 0.5813319123065454
Validation class accuracies: [0.9389179755671903, 0.59375]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 17 epochs
Epoch 27/65
151/151 - 65s - loss: 0.0025 - accuracy: 1.0000 - val_loss: 0.3335 - val_accuracy: 0.9240
Confusion matrix: 
 [[540  33]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.406 0.594]]
Validation f1: 45.24
Validation accuracy: 92.40
Validation recall: 59.38
Validation precision: 36.54
Validation AUC: 0.5728778562817486
Validation class accuracies: [0.9424083769633508, 0.59375]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
151/151 - 65s - loss: 0.0040 - accuracy: 1.0000 - val_loss: 0.3678 - val_accuracy: 0.9223
Confusion matrix: 
 [[537  36]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.344 0.656]]
Validation f1: 47.19
Validation accuracy: 92.23
Validation recall: 65.62
Validation precision: 36.84
Validation AUC: 0.612573054784035
Validation class accuracies: [0.93717277486911, 0.65625]
The validation tracker metric at 0.5054945054945055 hasn't increased by 0 in 19 epochs
Epoch 29/65
151/151 - 66s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.3382 - val_accuracy: 0.9207
Confusion matrix: 
 [[538  35]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.19
Validation accuracy: 92.07
Validation recall: 59.38
Validation precision: 35.19
Validation AUC: 0.5863931285752435
Validation class accuracies: [0.9389179755671903, 0.59375]

The metrics for job 0 with the best target metric are: 
Best cm: [[537  36]
 [  9  23]]
Best normalized cm: [[0.937 0.063]
 [0.281 0.719]]
Best f1: 0.51
Best accuracy: 0.93
Best recall: 0.72
Best precision: 0.39
Best AUC: 0.62
Best class accuracies: [0.93717277486911, 0.71875]
Best epoch: 9
The number of epochs since last 1% equals the patience
-----------------------
Third model
-----------------------
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_3 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormalization)      (None, 128, 1250, 1)                        4                
______________________________________________________________________________________________________________
conv2d_35 (Conv2D)                               (None, 128, 1250, 4)                        8                
______________________________________________________________________________________________________________
conv2d_36 (Conv2D)                               (None, 128, 1250, 8)                        1160             
______________________________________________________________________________________________________________
conv2d_37 (Conv2D)                               (None, 128, 1250, 16)                       144              
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePooling2D)          (None, 64, 625, 16)                         0                
______________________________________________________________________________________________________________
dropout (Dropout)                                (None, 64, 625, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormalization)      (None, 64, 625, 16)                         64               
______________________________________________________________________________________________________________
conv2d_38 (Conv2D)                               (None, 64, 625, 16)                         9232             
______________________________________________________________________________________________________________
conv2d_39 (Conv2D)                               (None, 64, 625, 32)                         544              
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePooling2D)          (None, 32, 313, 32)                         0                
______________________________________________________________________________________________________________
dropout_1 (Dropout)                              (None, 32, 313, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormalization)      (None, 32, 313, 32)                         128              
______________________________________________________________________________________________________________
conv2d_40 (Conv2D)                               (None, 32, 313, 32)                         36896            
______________________________________________________________________________________________________________
conv2d_41 (Conv2D)                               (None, 32, 313, 64)                         2112             
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePooling2D)          (None, 16, 157, 64)                         0                
______________________________________________________________________________________________________________
dropout_2 (Dropout)                              (None, 16, 157, 64)                         0                
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormalization)      (None, 16, 157, 64)                         256              
______________________________________________________________________________________________________________
conv2d_42 (Conv2D)                               (None, 16, 157, 64)                         147520           
______________________________________________________________________________________________________________
conv2d_43 (Conv2D)                               (None, 16, 157, 128)                        8320             
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePooling2D)          (None, 8, 79, 128)                          0                
______________________________________________________________________________________________________________
dropout_3 (Dropout)                              (None, 8, 79, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormalization)      (None, 8, 79, 128)                          512              
______________________________________________________________________________________________________________
conv2d_44 (Conv2D)                               (None, 8, 79, 128)                          589952           
______________________________________________________________________________________________________________
conv2d_45 (Conv2D)                               (None, 8, 79, 256)                          33024            
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePooling2D)          (None, 4, 40, 256)                          0                
______________________________________________________________________________________________________________
dropout_4 (Dropout)                              (None, 4, 40, 256)                          0                
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormalization)      (None, 4, 40, 256)                          1024             
______________________________________________________________________________________________________________
conv2d_46 (Conv2D)                               (None, 4, 40, 256)                          65792            
______________________________________________________________________________________________________________
conv2d_47 (Conv2D)                               (None, 4, 40, 512)                          1180160          
______________________________________________________________________________________________________________
conv2d_48 (Conv2D)                               (None, 4, 40, 512)                          2359808          
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalAveragePooling (None, 512)                                 0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   513              
==============================================================================================================
Total params: 4,437,173
Trainable params: 4,436,179
Non-trainable params: 994
______________________________________________________________________________________________________________
Epoch 1/65
151/151 - 55s - loss: 0.9948 - accuracy: 0.1221 - val_loss: 0.6959 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.5264462809917355
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
151/151 - 51s - loss: 0.6867 - accuracy: 0.1325 - val_loss: 0.6927 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
151/151 - 56s - loss: 0.6867 - accuracy: 0.7873 - val_loss: 0.6918 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/65
151/151 - 51s - loss: 0.6867 - accuracy: 0.9520 - val_loss: 0.6922 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 3 epochs
Epoch 5/65
151/151 - 52s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6906 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 4 epochs
Epoch 6/65
151/151 - 61s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6908 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 5 epochs
Epoch 7/65
151/151 - 56s - loss: 0.6867 - accuracy: 0.8940 - val_loss: 0.6902 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.026446280991735537
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 8/65
151/151 - 55s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6897 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.026446280991735537
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 7 epochs
Epoch 9/65
151/151 - 61s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6899 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 8 epochs
Epoch 10/65
151/151 - 55s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6896 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 9 epochs
Epoch 11/65
151/151 - 55s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6893 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.026446280991735537
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 10 epochs
Epoch 12/65
151/151 - 56s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6893 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 11 epochs
Epoch 13/65
151/151 - 51s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6891 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 14/65
151/151 - 50s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6892 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 13 epochs
Epoch 15/65
151/151 - 50s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6891 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 14 epochs
Epoch 16/65
151/151 - 60s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6890 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 15 epochs
Epoch 17/65
151/151 - 56s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6889 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.026446280991735537
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 16 epochs
Epoch 18/65
151/151 - 56s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6890 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 17 epochs
Epoch 19/65
151/151 - 62s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6888 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.026446280991735537
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 20/65
151/151 - 55s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6888 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.026446280991735537
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 19 epochs
Epoch 21/65
151/151 - 55s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6888 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]

The metrics for job 0 with the best target metric are: 
Best cm: [[  0 573]
 [  0  32]]
Best normalized cm: [[0. 1.]
 [0. 1.]]
Best f1: 0.10
Best accuracy: 0.05
Best recall: 1.00
Best precision: 0.05
Best AUC: 0.53
Best class accuracies: [0.0, 1.0]
Best epoch: 1
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 23463
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210615_200616-bhzaqjb4/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210615_200616-bhzaqjb4/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.95199
wandb:         val_accuracy 0.94711
wandb:             _runtime 5445
wandb:           _timestamp 1623793022
wandb:                _step 548
wandb:           train_loss 0.68656
wandb:             val_loss 0.68878
wandb:           val_recall 0.0
wandb:        val_precision 0.0
wandb:               val_f1 0.0
wandb:              val_auc 0.52645
wandb:                   lr 0.00013
wandb:          best_val_f1 0.10047
wandb:    best_val_accuracy 0.05289
wandb:   best_val_precision 0.05289
wandb:      best_val_recall 1.0
wandb:             best_auc 0.52645
wandb:           best_epoch 1
wandb: Run history:
wandb:   train_accuracy ▆▇▇▇██████████▇▇█████████████▁▆█▇███████
wandb:     val_accuracy ████▆███▇█████▁▇▇▇███▇██████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ▆▅▄▃▂▂▁▁▁▁▁▁▁▁▄▃▂▂▁▁▁▁▁▁▁▁▁▁▁███████████
wandb:         val_loss ▁▁▁▃▄▁▂▁▂▂▂▂▂▂▅▃▂▃▁▃▁█▂▂▂▂▂▂▂▅▅▅▅▅▅▅▅▅▅▅
wandb:       val_recall ▁▁▂▁▅▄▄▄▅▄▄▄▄▄█▆▄▆▅▃▅█▅▅▅▅▅▅▅▁▁▁▁▁▁▁▁▁▁▁
wandb:    val_precision ▁▁▄▁▃▅▆█▄▅▅▅▅▅▂▄▄▃▅▄▅▃▅▅▅▅▅▅▅▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_f1 ▁▁▄▁▄▇██▆▇▇▇▇▇▃▇▆▆█▆▇▆▇█▇█▇█▇▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_auc ▁▂▃▂▅▆▆▆▆▆▆▆▆▆▄█▆▆▇▄▇▆▇███▇▇█▇▇▇▁▇▁▇▇▁▁▇
wandb:               lr ██████▄▄▄▂▂▂▂▁████████▄▄▄▂▂▂▁████▄▄▄▂▂▂▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210615_200616-bhzaqjb4


 See logs at ../../new_cache/conv__2221__06_2005__v39__redo/logs/