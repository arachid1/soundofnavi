Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v32_augm_v0_cleaned_8000.pkl
File:  conv.train2160
Description:  v32
2021-05-26 07:40:05.221662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 07:40:10.855868: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-26 07:40:10.857652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-26 07:40:10.912100: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:10.912790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-26 07:40:10.912821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 07:40:10.935106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 07:40:10.935196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 07:40:10.946250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-26 07:40:10.949152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-26 07:40:10.954411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-26 07:40:10.959979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-26 07:40:10.961644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-26 07:40:10.961792: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:10.962519: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:10.963180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2160.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v32_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2160__05_0739__v32__v32/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2160
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/30jmjasy
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_074011-30jmjasy
wandb: Run `wandb offline` to turn off syncing.
2021-05-26 07:40:17.210480: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-26 07:40:17.210932: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:17.211946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-26 07:40:17.212039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 07:40:17.212182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 07:40:17.212227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 07:40:17.212268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-26 07:40:17.212308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-26 07:40:17.212347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-26 07:40:17.212385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-26 07:40:17.212422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-26 07:40:17.212562: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:17.213995: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:17.214945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-26 07:40:17.215887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 07:40:18.698627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-26 07:40:18.698670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-26 07:40:18.698679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-26 07:40:18.698979: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:18.699747: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:18.700541: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 07:40:18.701183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-26 07:40:56.067852: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-26 07:40:56.070255: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-26 07:40:59.031353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 07:41:00.487828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 07:41:00.502998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4165...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/80
261/261 - 511s - loss: 0.6670 - accuracy: 0.6538 - val_loss: 0.5013 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2022020775393417
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/80
261/261 - 496s - loss: 0.5911 - accuracy: 0.7162 - val_loss: 0.5013 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20834879532454745
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/80
261/261 - 496s - loss: 0.5804 - accuracy: 0.7241 - val_loss: 0.5175 - val_accuracy: 0.7987
Confusion matrix: 
 [[869   1]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.87
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21182730683634443
Validation class accuracies: [0.9988505747126437, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/80
261/261 - 496s - loss: 0.5691 - accuracy: 0.7246 - val_loss: 0.6100 - val_accuracy: 0.7142
Confusion matrix: 
 [[753 117]
 [194  24]]
Validation f1: 13.37
Validation accuracy: 71.42
Validation recall: 11.01
Validation precision: 17.02
Validation AUC: 0.19482018093010725
Validation class accuracies: [0.8655172413793103, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.13370473537604455
inside not defaulting
Saving model...
Epoch 5/80
261/261 - 497s - loss: 0.5615 - accuracy: 0.7280 - val_loss: 0.5612 - val_accuracy: 0.7858
Confusion matrix: 
 [[852  18]
 [215   3]]
Validation f1: 2.51
Validation accuracy: 78.58
Validation recall: 1.38
Validation precision: 14.29
Validation AUC: 0.19369012504267105
Validation class accuracies: [0.9793103448275862, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.02510460251046025
inside not defaulting
The validation tracker metric at 0.13370473537604455 hasn't increased by 0 in 1 epochs
Epoch 6/80
261/261 - 496s - loss: 0.5507 - accuracy: 0.7292 - val_loss: 0.5567 - val_accuracy: 0.7739
Confusion matrix: 
 [[839  31]
 [215   3]]
Validation f1: 2.38
Validation accuracy: 77.39
Validation recall: 1.38
Validation precision: 8.82
Validation AUC: 0.18243299361335494
Validation class accuracies: [0.964367816091954, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.02380952380952381
inside not defaulting
The validation tracker metric at 0.13370473537604455 hasn't increased by 0 in 2 epochs
Epoch 7/80
261/261 - 496s - loss: 0.5359 - accuracy: 0.7385 - val_loss: 0.5447 - val_accuracy: 0.7914
Confusion matrix: 
 [[861   9]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.14
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21056077370457954
Validation class accuracies: [0.9896551724137931, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0.13370473537604455 hasn't increased by 0 in 3 epochs
Epoch 8/80
261/261 - 497s - loss: 0.5173 - accuracy: 0.7515 - val_loss: 0.5987 - val_accuracy: 0.7574
Confusion matrix: 
 [[817  53]
 [211   7]]
Validation f1: 5.04
Validation accuracy: 75.74
Validation recall: 3.21
Validation precision: 11.67
Validation AUC: 0.18943440591978855
Validation class accuracies: [0.9390804597701149, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.050359712230215826
inside not defaulting
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.13370473537604455 hasn't increased by 0 in 4 epochs
Epoch 9/80
261/261 - 495s - loss: 0.4645 - accuracy: 0.7870 - val_loss: 0.6560 - val_accuracy: 0.7178
Confusion matrix: 
 [[760 110]
 [197  21]]
Validation f1: 12.03
Validation accuracy: 71.78
Validation recall: 9.63
Validation precision: 16.03
Validation AUC: 0.18544698396874423
Validation class accuracies: [0.8735632183908046, 0.0963302752293578]
TARGET: 1
target metric(test f1): 0.12034383954154727
inside not defaulting
The validation tracker metric at 0.13370473537604455 hasn't increased by 0 in 5 epochs
Epoch 10/80
261/261 - 498s - loss: 0.4344 - accuracy: 0.7993 - val_loss: 0.6915 - val_accuracy: 0.6967
Confusion matrix: 
 [[733 137]
 [193  25]]
Validation f1: 13.16
Validation accuracy: 69.67
Validation recall: 11.47
Validation precision: 15.43
Validation AUC: 0.18874905859497737
Validation class accuracies: [0.8425287356321839, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.13157894736842107
inside not defaulting
The validation tracker metric at 0.13370473537604455 hasn't increased by 0 in 6 epochs
Epoch 11/80
261/261 - 496s - loss: 0.4178 - accuracy: 0.8106 - val_loss: 0.7976 - val_accuracy: 0.6103
Confusion matrix: 
 [[603 267]
 [157  61]]
Validation f1: 22.34
Validation accuracy: 61.03
Validation recall: 27.98
Validation precision: 18.60
Validation AUC: 0.17932033865286742
Validation class accuracies: [0.6931034482758621, 0.2798165137614679]
TARGET: 1
target metric(test f1): 0.22344322344322343
inside not defaulting
Saving model...
Epoch 12/80
261/261 - 497s - loss: 0.3920 - accuracy: 0.8262 - val_loss: 1.0537 - val_accuracy: 0.5763
Confusion matrix: 
 [[537 333]
 [128  90]]
Validation f1: 28.08
Validation accuracy: 57.63
Validation recall: 41.28
Validation precision: 21.28
Validation AUC: 0.1977340976818204
Validation class accuracies: [0.6172413793103448, 0.41284403669724773]
TARGET: 1
target metric(test f1): 0.28081123244929795
inside not defaulting
Saving model...
Epoch 13/80
261/261 - 496s - loss: 0.3694 - accuracy: 0.8396 - val_loss: 0.7856 - val_accuracy: 0.6241
Confusion matrix: 
 [[635 235]
 [174  44]]
Validation f1: 17.71
Validation accuracy: 62.41
Validation recall: 20.18
Validation precision: 15.77
Validation AUC: 0.1758514844797724
Validation class accuracies: [0.7298850574712644, 0.2018348623853211]
TARGET: 1
target metric(test f1): 0.17706237424547283
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 1 epochs
Epoch 14/80
261/261 - 498s - loss: 0.3516 - accuracy: 0.8526 - val_loss: 0.7054 - val_accuracy: 0.7399
Confusion matrix: 
 [[789  81]
 [202  16]]
Validation f1: 10.16
Validation accuracy: 73.99
Validation recall: 7.34
Validation precision: 16.49
Validation AUC: 0.19580161620344644
Validation class accuracies: [0.906896551724138, 0.07339449541284404]
TARGET: 1
target metric(test f1): 0.10158730158730159
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 2 epochs
Epoch 15/80
261/261 - 496s - loss: 0.3321 - accuracy: 0.8605 - val_loss: 0.9367 - val_accuracy: 0.5928
Confusion matrix: 
 [[576 294]
 [149  69]]
Validation f1: 23.75
Validation accuracy: 59.28
Validation recall: 31.65
Validation precision: 19.01
Validation AUC: 0.1832611605333573
Validation class accuracies: [0.6620689655172414, 0.3165137614678899]
TARGET: 1
target metric(test f1): 0.23752151462994836
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 3 epochs
Epoch 16/80
261/261 - 495s - loss: 0.3210 - accuracy: 0.8610 - val_loss: 0.8216 - val_accuracy: 0.6461
Confusion matrix: 
 [[666 204]
 [181  37]]
Validation f1: 16.12
Validation accuracy: 64.61
Validation recall: 16.97
Validation precision: 15.35
Validation AUC: 0.17945312673117358
Validation class accuracies: [0.7655172413793103, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.16122004357298478
inside not defaulting
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 4 epochs
Epoch 17/80
261/261 - 496s - loss: 0.3000 - accuracy: 0.8780 - val_loss: 0.8982 - val_accuracy: 0.6140
Confusion matrix: 
 [[617 253]
 [167  51]]
Validation f1: 19.54
Validation accuracy: 61.40
Validation recall: 23.39
Validation precision: 16.78
Validation AUC: 0.17872709578876694
Validation class accuracies: [0.7091954022988506, 0.23394495412844038]
TARGET: 1
target metric(test f1): 0.1954022988505747
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 5 epochs
Epoch 18/80
261/261 - 495s - loss: 0.2895 - accuracy: 0.8812 - val_loss: 0.8132 - val_accuracy: 0.6774
Confusion matrix: 
 [[701 169]
 [182  36]]
Validation f1: 17.02
Validation accuracy: 67.74
Validation recall: 16.51
Validation precision: 17.56
Validation AUC: 0.18149822491815834
Validation class accuracies: [0.8057471264367816, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.1702127659574468
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 6 epochs
Epoch 19/80
261/261 - 496s - loss: 0.2906 - accuracy: 0.8845 - val_loss: 0.8207 - val_accuracy: 0.6811
Confusion matrix: 
 [[709 161]
 [186  32]]
Validation f1: 15.57
Validation accuracy: 68.11
Validation recall: 14.68
Validation precision: 16.58
Validation AUC: 0.1826527716075362
Validation class accuracies: [0.8149425287356322, 0.14678899082568808]
TARGET: 1
target metric(test f1): 0.15571776155717762
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 7 epochs
Epoch 20/80
261/261 - 498s - loss: 0.2803 - accuracy: 0.8857 - val_loss: 0.9466 - val_accuracy: 0.5855
Confusion matrix: 
 [[572 298]
 [153  65]]
Validation f1: 22.38
Validation accuracy: 58.55
Validation recall: 29.82
Validation precision: 17.91
Validation AUC: 0.1840940936864617
Validation class accuracies: [0.6574712643678161, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.22375215146299482
inside not defaulting
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 8 epochs
Epoch 21/80
261/261 - 496s - loss: 0.2784 - accuracy: 0.8915 - val_loss: 0.8715 - val_accuracy: 0.6489
Confusion matrix: 
 [[660 210]
 [172  46]]
Validation f1: 19.41
Validation accuracy: 64.89
Validation recall: 21.10
Validation precision: 17.97
Validation AUC: 0.18136835516559568
Validation class accuracies: [0.7586206896551724, 0.21100917431192662]
TARGET: 1
target metric(test f1): 0.1940928270042194
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 9 epochs
Epoch 22/80
261/261 - 496s - loss: 0.2866 - accuracy: 0.8874 - val_loss: 0.8834 - val_accuracy: 0.6443
Confusion matrix: 
 [[653 217]
 [170  48]]
Validation f1: 19.88
Validation accuracy: 64.43
Validation recall: 22.02
Validation precision: 18.11
Validation AUC: 0.17971985035170193
Validation class accuracies: [0.7505747126436781, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.1987577639751553
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 10 epochs
Epoch 23/80
261/261 - 495s - loss: 0.2857 - accuracy: 0.8845 - val_loss: 0.8489 - val_accuracy: 0.6645
Confusion matrix: 
 [[688 182]
 [183  35]]
Validation f1: 16.09
Validation accuracy: 66.45
Validation recall: 16.06
Validation precision: 16.13
Validation AUC: 0.1805505509808219
Validation class accuracies: [0.7908045977011494, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.16091954022988506
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 11 epochs
Epoch 24/80
261/261 - 497s - loss: 0.2788 - accuracy: 0.8855 - val_loss: 0.8784 - val_accuracy: 0.6425
Confusion matrix: 
 [[651 219]
 [170  48]]
Validation f1: 19.79
Validation accuracy: 64.25
Validation recall: 22.02
Validation precision: 17.98
Validation AUC: 0.18062760243231718
Validation class accuracies: [0.7482758620689656, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.19793814432989693
inside not defaulting
Lr has been adjusted to 3.906249901319825e-07
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 12 epochs
Epoch 25/80
261/261 - 496s - loss: 0.2785 - accuracy: 0.8879 - val_loss: 0.8854 - val_accuracy: 0.6425
Confusion matrix: 
 [[651 219]
 [170  48]]
Validation f1: 19.79
Validation accuracy: 64.25
Validation recall: 22.02
Validation precision: 17.98
Validation AUC: 0.17979927883782493
Validation class accuracies: [0.7482758620689656, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.19793814432989693
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 13 epochs
Epoch 26/80
261/261 - 496s - loss: 0.2781 - accuracy: 0.8956 - val_loss: 0.8749 - val_accuracy: 0.6471
Confusion matrix: 
 [[661 209]
 [175  43]]
Validation f1: 18.30
Validation accuracy: 64.71
Validation recall: 19.72
Validation precision: 17.06
Validation AUC: 0.18063499065104835
Validation class accuracies: [0.7597701149425288, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.18297872340425533
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 14 epochs
Epoch 27/80
261/261 - 496s - loss: 0.2653 - accuracy: 0.9023 - val_loss: 0.8719 - val_accuracy: 0.6489
Confusion matrix: 
 [[662 208]
 [174  44]]
Validation f1: 18.72
Validation accuracy: 64.89
Validation recall: 20.18
Validation precision: 17.46
Validation AUC: 0.18079402291618124
Validation class accuracies: [0.7609195402298851, 0.2018348623853211]
TARGET: 1
target metric(test f1): 0.1872340425531915
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 15 epochs
Epoch 28/80
261/261 - 495s - loss: 0.2742 - accuracy: 0.8874 - val_loss: 0.8841 - val_accuracy: 0.6480
Confusion matrix: 
 [[657 213]
 [170  48]]
Validation f1: 20.04
Validation accuracy: 64.80
Validation recall: 22.02
Validation precision: 18.39
Validation AUC: 0.18055247645419917
Validation class accuracies: [0.7551724137931034, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.20041753653444674
inside not defaulting
Lr has been adjusted to 9.765624753299562e-08
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 16 epochs
Epoch 29/80
261/261 - 495s - loss: 0.2755 - accuracy: 0.8884 - val_loss: 0.8704 - val_accuracy: 0.6544
Confusion matrix: 
 [[670 200]
 [176  42]]
Validation f1: 18.26
Validation accuracy: 65.44
Validation recall: 19.27
Validation precision: 17.36
Validation AUC: 0.18063210800122173
Validation class accuracies: [0.7701149425287356, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.1826086956521739
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 17 epochs
Epoch 30/80
261/261 - 497s - loss: 0.2837 - accuracy: 0.8869 - val_loss: 0.8823 - val_accuracy: 0.6443
Confusion matrix: 
 [[653 217]
 [170  48]]
Validation f1: 19.88
Validation accuracy: 64.43
Validation recall: 22.02
Validation precision: 18.11
Validation AUC: 0.1809372384331665
Validation class accuracies: [0.7505747126436781, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.1987577639751553
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 18 epochs
Epoch 31/80
261/261 - 496s - loss: 0.2720 - accuracy: 0.8939 - val_loss: 0.8737 - val_accuracy: 0.6507
Confusion matrix: 
 [[665 205]
 [175  43]]
Validation f1: 18.45
Validation accuracy: 65.07
Validation recall: 19.72
Validation precision: 17.34
Validation AUC: 0.18127893101963438
Validation class accuracies: [0.764367816091954, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.184549356223176
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 19 epochs
Epoch 32/80
261/261 - 497s - loss: 0.2624 - accuracy: 0.8977 - val_loss: 0.8726 - val_accuracy: 0.6498
Confusion matrix: 
 [[664 206]
 [175  43]]
Validation f1: 18.42
Validation accuracy: 64.98
Validation recall: 19.72
Validation precision: 17.27
Validation AUC: 0.18139441944930368
Validation class accuracies: [0.7632183908045977, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.18415417558886513
inside not defaulting
Lr has been adjusted to 2.4414061883248905e-08
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 20 epochs
Epoch 33/80
261/261 - 496s - loss: 0.2694 - accuracy: 0.8956 - val_loss: 0.8835 - val_accuracy: 0.6406
Confusion matrix: 
 [[649 221]
 [170  48]]
Validation f1: 19.71
Validation accuracy: 64.06
Validation recall: 22.02
Validation precision: 17.84
Validation AUC: 0.18068640512148582
Validation class accuracies: [0.7459770114942529, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.19712525667351127
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 21 epochs
Epoch 34/80
261/261 - 496s - loss: 0.2816 - accuracy: 0.8862 - val_loss: 0.8790 - val_accuracy: 0.6498
Confusion matrix: 
 [[661 209]
 [172  46]]
Validation f1: 19.45
Validation accuracy: 64.98
Validation recall: 21.10
Validation precision: 18.04
Validation AUC: 0.18043603573604158
Validation class accuracies: [0.7597701149425288, 0.21100917431192662]
TARGET: 1
target metric(test f1): 0.19450317124735733
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 22 epochs
Epoch 35/80
261/261 - 496s - loss: 0.2675 - accuracy: 0.8941 - val_loss: 0.8754 - val_accuracy: 0.6480
Confusion matrix: 
 [[661 209]
 [174  44]]
Validation f1: 18.68
Validation accuracy: 64.80
Validation recall: 20.18
Validation precision: 17.39
Validation AUC: 0.18038264816422284
Validation class accuracies: [0.7597701149425288, 0.2018348623853211]
TARGET: 1
target metric(test f1): 0.18683651804670912
inside not defaulting
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 23 epochs
Epoch 36/80
261/261 - 495s - loss: 0.2771 - accuracy: 0.8903 - val_loss: 0.8740 - val_accuracy: 0.6480
Confusion matrix: 
 [[663 207]
 [176  42]]
Validation f1: 17.99
Validation accuracy: 64.80
Validation recall: 19.27
Validation precision: 16.87
Validation AUC: 0.18118142843964277
Validation class accuracies: [0.7620689655172413, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.17987152034261242
inside not defaulting
Lr has been adjusted to 6.103515470812226e-09
The validation tracker metric at 0.28081123244929795 hasn't increased by 0 in 24 epochs
Epoch 37/80
261/261 - 495s - loss: 0.2766 - accuracy: 0.8934 - val_loss: 0.8776 - val_accuracy: 0.6480
Confusion matrix: 
 [[658 212]
 [171  47]]
Validation f1: 19.71
Validation accuracy: 64.80
Validation recall: 21.56
Validation precision: 18.15
Validation AUC: 0.1806776856836446
Validation class accuracies: [0.7563218390804598, 0.21559633027522937]

The metrics for the epoch with the best target metric are: 
Best cm: [[537 333]
 [128  90]]
Best f1: 0.28081123244929795
Best accuracy: 0.5762867647058824
Best recall: 0.41284403669724773
Best precision: 0.2127659574468085
Best AUC: 0.1977340976818204
Best epoch: 12
TARGET: 1
target metric(test f1): 0.19706498951781973
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[15 45]
 [ 1 14]]
F1: 0.37837837837837834
AUC: 0.5919774011299436
Accuracy: 0.38666666666666666
Precision: 0.23728813559322035
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[30 30]
 [ 5 10]]
F1: 0.36363636363636365
AUC: 0.49166666666666664
Accuracy: 0.5333333333333333
Precision: 0.25
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[50 10]
 [13  2]]
F1: 0.14814814814814814
AUC: 0.2366666666666667
Accuracy: 0.6933333333333334
Precision: 0.16666666666666666
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_80.xls...
Done.
Epoch: epoch11
Starting...
CM: [[10 50]
 [ 1 14]]
F1: 0.35443037974683544
AUC: 0.5827083333333333
Accuracy: 0.32
Precision: 0.21875
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch11.xls...
Done.
Epoch: epoch11
Starting...
CM: [[22 38]
 [ 5 10]]
F1: 0.3174603174603175
AUC: 0.4708333333333333
Accuracy: 0.4266666666666667
Precision: 0.20833333333333334
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch11.xls...
Done.
Epoch: epoch11
Starting...
CM: [[41 19]
 [10  5]]
F1: 0.25641025641025644
AUC: 0.3375
Accuracy: 0.6133333333333333
Precision: 0.20833333333333334
Recall: 0.3333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch11.xls...
Done.
Epoch: epoch12
Starting...
CM: [[10 50]
 [ 2 13]]
F1: 0.3333333333333333
AUC: 0.5498412698412698
Accuracy: 0.30666666666666664
Precision: 0.20634920634920634
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch12.xls...
Done.
Epoch: epoch12
Starting...
CM: [[18 42]
 [ 3 12]]
F1: 0.3478260869565218
AUC: 0.5311111111111111
Accuracy: 0.4
Precision: 0.2222222222222222
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch12.xls...
Done.
Epoch: epoch12
Starting...
CM: [[30 30]
 [ 7  8]]
F1: 0.3018867924528302
AUC: 0.4185964912280702
Accuracy: 0.5066666666666667
Precision: 0.21052631578947367
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch12.xls...
Done.
Epoch: epoch4
Starting...
CM: [[30 30]
 [ 6  9]]
F1: 0.33333333333333337
AUC: 0.4553846153846154
Accuracy: 0.52
Precision: 0.23076923076923078
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch4.xls...
Done.
Epoch: epoch4
Starting...
CM: [[46 14]
 [11  4]]
F1: 0.2424242424242424
AUC: 0.3177777777777778
Accuracy: 0.6666666666666666
Precision: 0.2222222222222222
Recall: 0.26666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch4.xls...
Done.
Epoch: epoch4
Starting...
CM: [[53  7]
 [15  0]]
F1: 0.0
AUC: 0.1
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2160__05_0739__v32__v32/validation_sheet_epoch4.xls...
Done.
wandb: Waiting for W&B process to finish, PID 16499
wandb: Program ended successfully.
wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.08MB uploaded (0.00MB deduped)wandb: / 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: - 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: \ 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: | 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: / 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_074011-30jmjasy/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_074011-30jmjasy/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.8934
wandb:         val_accuracy 0.64798
wandb:             _runtime 19298
wandb:           _timestamp 1622034109
wandb:                _step 268
wandb:           train_loss 0.27658
wandb:             val_loss 0.87762
wandb:           val_recall 0.2156
wandb:        val_precision 0.18147
wandb:               val_f1 0.19706
wandb:              val_auc 0.18068
wandb:                   lr 0.0
wandb:          best_val_f1 0.28081
wandb:    best_val_accuracy 0.57629
wandb:   best_val_precision 0.21277
wandb:      best_val_recall 0.41284
wandb:             best_auc 0.19773
wandb:           best_epoch 12
wandb:           best_bd_f1 0.37838
wandb:          best_bd_auc 0.59198
wandb:     best_bd_accuracy 0.38667
wandb:    best_bd_precision 0.23729
wandb:       best_bd_recall 0.93333
wandb:        best_bd_epoch 80
wandb: Run history:
wandb:   train_accuracy ▁▃▃▃▃▃▃▄▅▅▅▆▆▇▇▇▇▇▇███▇██████████████
wandb:     val_accuracy ███▅█▇█▇▅▅▂▁▂▆▂▃▂▄▄▁▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▆▆▆▆▅▄▄▄▃▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▂▂▂▂▂▃▃▅█▅▄▇▅▆▅▅▇▆▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:       val_recall ▁▁▁▃▁▁▁▂▃▃▆█▄▂▆▄▅▄▃▆▅▅▄▅▅▄▄▅▄▅▄▄▅▅▄▄▅
wandb:    val_precision ▁▁▁▇▆▄▁▅▆▆▇█▆▆▇▆▇▇▆▇▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_f1 ▁▁▁▄▂▂▁▂▄▄▇█▅▄▇▅▆▅▅▇▆▆▅▆▆▆▆▆▆▆▆▆▆▆▆▅▆
wandb:          val_auc ▆▇█▅▄▂█▄▃▄▂▅▁▅▂▂▂▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:               lr ████████▃▃▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 10 media file(s), 7 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2160: https://wandb.ai/arachid1/tensorboard-integration/runs/30jmjasy


 See logs at ../../new_cache/conv__2160__05_0739__v32__v32/logs/