Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2244
Description:  mixednet_w_params
2021-06-23 12:22:08.490201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-23 12:22:10.966218: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 12:22:10.967132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-23 12:22:11.013222: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:11.013904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 12:22:11.013929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 12:22:11.017288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 12:22:11.017374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 12:22:11.018418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 12:22:11.018700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 12:22:11.019718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 12:22:11.020607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 12:22:11.020765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 12:22:11.020868: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:11.021585: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:11.022216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2244.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2244__06_1221__v39__mixednet_w_params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-23 12:22:16.240404: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 12:22:16.240724: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:16.241733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 12:22:16.241795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 12:22:16.241874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 12:22:16.241913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 12:22:16.241941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 12:22:16.241981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 12:22:16.242010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 12:22:16.242038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 12:22:16.242070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 12:22:16.242194: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:16.243132: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:16.243834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-23 12:22:16.243892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 12:22:16.977581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-23 12:22:16.977624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-23 12:22:16.977632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-23 12:22:16.977929: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:16.978705: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:16.979429: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 12:22:16.980108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-23 12:22:18.101422: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-23 12:22:18.102901: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-23 12:22:18.475882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 12:22:20.580246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 12:22:21.081394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 68s - loss: 0.4716 - accuracy: 0.7188 - val_loss: 0.3885 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09455790715811088
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 64s - loss: 0.3290 - accuracy: 0.8380 - val_loss: 0.2703 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.4688575845343347
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 63s - loss: 0.2400 - accuracy: 0.8970 - val_loss: 0.2455 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5343763105810034
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 63s - loss: 0.1746 - accuracy: 0.9333 - val_loss: 0.1398 - val_accuracy: 0.9626
Confusion matrix: 
 [[571   2]
 [ 21  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.5   0.5  ]]
Validation f1: 64.62
Validation accuracy: 96.26
Validation recall: 50.00
Validation precision: 91.30
Validation AUC: 0.6817726687843884
Validation class accuracies: [0.9965095986038395, 0.5]
Saving model...
Epoch 5/65
154/154 - 62s - loss: 0.1638 - accuracy: 0.9304 - val_loss: 0.3081 - val_accuracy: 0.9073
Confusion matrix: 
 [[526  47]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.238 0.762]]
Validation f1: 52.89
Validation accuracy: 90.73
Validation recall: 76.19
Validation precision: 40.51
Validation AUC: 0.7247660479554524
Validation class accuracies: [0.9179755671902269, 0.7619047619047619]
The validation tracker metric at 0.6461538461538461 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 65s - loss: 0.0923 - accuracy: 0.9585 - val_loss: 0.2229 - val_accuracy: 0.9285
Confusion matrix: 
 [[541  32]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.286 0.714]]
Validation f1: 57.69
Validation accuracy: 92.85
Validation recall: 71.43
Validation precision: 48.39
Validation AUC: 0.7210804614007097
Validation class accuracies: [0.944153577661431, 0.7142857142857143]
The validation tracker metric at 0.6461538461538461 hasn't increased by 0 in 2 epochs
Epoch 7/65
154/154 - 63s - loss: 0.0588 - accuracy: 0.9837 - val_loss: 0.3159 - val_accuracy: 0.8894
Confusion matrix: 
 [[514  59]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.214 0.786]]
Validation f1: 49.25
Validation accuracy: 88.94
Validation recall: 78.57
Validation precision: 35.87
Validation AUC: 0.7661281629330687
Validation class accuracies: [0.8970331588132635, 0.7857142857142857]
The validation tracker metric at 0.6461538461538461 hasn't increased by 0 in 3 epochs
Epoch 8/65
154/154 - 63s - loss: 0.0412 - accuracy: 0.9890 - val_loss: 0.1562 - val_accuracy: 0.9561
Confusion matrix: 
 [[559  14]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.31  0.69 ]]
Validation f1: 68.24
Validation accuracy: 95.61
Validation recall: 69.05
Validation precision: 67.44
Validation AUC: 0.7157185044774473
Validation class accuracies: [0.9755671902268761, 0.6904761904761905]
Saving model...
Epoch 9/65
154/154 - 63s - loss: 0.0365 - accuracy: 0.9878 - val_loss: 1.2765 - val_accuracy: 0.6000
Confusion matrix: 
 [[330 243]
 [  3  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.576 0.424]
 [0.071 0.929]]
Validation f1: 24.07
Validation accuracy: 60.00
Validation recall: 92.86
Validation precision: 13.83
Validation AUC: 0.7161346652567729
Validation class accuracies: [0.5759162303664922, 0.9285714285714286]
The validation tracker metric at 0.6823529411764705 hasn't increased by 0 in 1 epochs
Epoch 10/65
154/154 - 63s - loss: 0.0462 - accuracy: 0.9858 - val_loss: 0.1832 - val_accuracy: 0.9642
Confusion matrix: 
 [[563  10]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.286 0.714]]
Validation f1: 73.17
Validation accuracy: 96.42
Validation recall: 71.43
Validation precision: 75.00
Validation AUC: 0.7447541938084624
Validation class accuracies: [0.9825479930191972, 0.7142857142857143]
Saving model...
Epoch 11/65
154/154 - 64s - loss: 0.0278 - accuracy: 0.9935 - val_loss: 0.3523 - val_accuracy: 0.9089
Confusion matrix: 
 [[523  50]
 [  6  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.143 0.857]]
Validation f1: 56.25
Validation accuracy: 90.89
Validation recall: 85.71
Validation precision: 41.86
Validation AUC: 0.7686008541871348
Validation class accuracies: [0.912739965095986, 0.8571428571428571]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 1 epochs
Epoch 12/65
154/154 - 62s - loss: 0.0202 - accuracy: 0.9943 - val_loss: 0.1694 - val_accuracy: 0.9561
Confusion matrix: 
 [[558  15]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.286 0.714]]
Validation f1: 68.97
Validation accuracy: 95.61
Validation recall: 71.43
Validation precision: 66.67
Validation AUC: 0.7562850917029691
Validation class accuracies: [0.9738219895287958, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 2 epochs
Epoch 13/65
154/154 - 63s - loss: 0.0105 - accuracy: 0.9988 - val_loss: 0.1827 - val_accuracy: 0.9528
Confusion matrix: 
 [[556  17]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.286 0.714]]
Validation f1: 67.42
Validation accuracy: 95.28
Validation recall: 71.43
Validation precision: 63.83
Validation AUC: 0.7483338053014368
Validation class accuracies: [0.9703315881326352, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 3 epochs
Epoch 14/65
154/154 - 63s - loss: 0.0111 - accuracy: 0.9992 - val_loss: 0.2912 - val_accuracy: 0.9463
Confusion matrix: 
 [[552  21]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.286 0.714]]
Validation f1: 64.52
Validation accuracy: 94.63
Validation recall: 71.43
Validation precision: 58.82
Validation AUC: 0.7200921059559265
Validation class accuracies: [0.9633507853403142, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 4 epochs
Epoch 15/65
154/154 - 64s - loss: 0.0112 - accuracy: 0.9992 - val_loss: 0.2624 - val_accuracy: 0.9350
Confusion matrix: 
 [[545  28]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.286 0.714]]
Validation f1: 60.00
Validation accuracy: 93.50
Validation recall: 71.43
Validation precision: 51.72
Validation AUC: 0.7375577869271822
Validation class accuracies: [0.9511343804537522, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 5 epochs
Epoch 16/65
154/154 - 62s - loss: 0.0093 - accuracy: 0.9992 - val_loss: 0.2662 - val_accuracy: 0.9350
Confusion matrix: 
 [[544  29]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.262 0.738]]
Validation f1: 60.78
Validation accuracy: 93.50
Validation recall: 73.81
Validation precision: 51.67
Validation AUC: 0.7259387122263999
Validation class accuracies: [0.9493891797556719, 0.7380952380952381]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
154/154 - 62s - loss: 0.0081 - accuracy: 0.9988 - val_loss: 0.2044 - val_accuracy: 0.9480
Confusion matrix: 
 [[553  20]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.286 0.714]]
Validation f1: 65.22
Validation accuracy: 94.80
Validation recall: 71.43
Validation precision: 60.00
Validation AUC: 0.7645115028165511
Validation class accuracies: [0.9650959860383944, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 7 epochs
Epoch 18/65
154/154 - 63s - loss: 0.0053 - accuracy: 1.0000 - val_loss: 0.2468 - val_accuracy: 0.9415
Confusion matrix: 
 [[549  24]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.286 0.714]]
Validation f1: 62.50
Validation accuracy: 94.15
Validation recall: 71.43
Validation precision: 55.56
Validation AUC: 0.7614319177428531
Validation class accuracies: [0.9581151832460733, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 8 epochs
Epoch 19/65
154/154 - 63s - loss: 0.0063 - accuracy: 1.0000 - val_loss: 0.3110 - val_accuracy: 0.9285
Confusion matrix: 
 [[539  34]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.238 0.762]]
Validation f1: 59.26
Validation accuracy: 92.85
Validation recall: 76.19
Validation precision: 48.48
Validation AUC: 0.7617302522373864
Validation class accuracies: [0.9406631762652705, 0.7619047619047619]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 9 epochs
Epoch 20/65
154/154 - 64s - loss: 0.0044 - accuracy: 1.0000 - val_loss: 0.2496 - val_accuracy: 0.9463
Confusion matrix: 
 [[552  21]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.52
Validation accuracy: 94.63
Validation recall: 71.43
Validation precision: 58.82
Validation AUC: 0.7560279528830871
Validation class accuracies: [0.9633507853403142, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 10 epochs
Epoch 21/65
154/154 - 62s - loss: 0.0087 - accuracy: 0.9996 - val_loss: 0.1923 - val_accuracy: 0.9528
Confusion matrix: 
 [[556  17]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 67.42
Validation accuracy: 95.28
Validation recall: 71.43
Validation precision: 63.83
Validation AUC: 0.780433931533928
Validation class accuracies: [0.9703315881326352, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 11 epochs
Epoch 22/65
154/154 - 63s - loss: 0.0043 - accuracy: 1.0000 - val_loss: 0.2134 - val_accuracy: 0.9512
Confusion matrix: 
 [[555  18]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.286 0.714]]
Validation f1: 66.67
Validation accuracy: 95.12
Validation recall: 71.43
Validation precision: 62.50
Validation AUC: 0.7724001513370439
Validation class accuracies: [0.9685863874345549, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
154/154 - 63s - loss: 0.0061 - accuracy: 1.0000 - val_loss: 0.2483 - val_accuracy: 0.9447
Confusion matrix: 
 [[551  22]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.286 0.714]]
Validation f1: 63.83
Validation accuracy: 94.47
Validation recall: 71.43
Validation precision: 57.69
Validation AUC: 0.774669717708271
Validation class accuracies: [0.9616055846422339, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 13 epochs
Epoch 24/65
154/154 - 64s - loss: 0.0043 - accuracy: 0.9996 - val_loss: 0.2361 - val_accuracy: 0.9480
Confusion matrix: 
 [[553  20]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 65.22
Validation accuracy: 94.80
Validation recall: 71.43
Validation precision: 60.00
Validation AUC: 0.7738397969962347
Validation class accuracies: [0.9650959860383944, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 14 epochs
Epoch 25/65
154/154 - 63s - loss: 0.0091 - accuracy: 1.0000 - val_loss: 0.7903 - val_accuracy: 0.8390
Confusion matrix: 
 [[479  94]
 [  5  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.836 0.164]
 [0.119 0.881]]
Validation f1: 42.77
Validation accuracy: 83.90
Validation recall: 88.10
Validation precision: 28.24
Validation AUC: 0.7065231110032756
Validation class accuracies: [0.8359511343804538, 0.8809523809523809]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 15 epochs
Epoch 26/65
154/154 - 63s - loss: 0.0051 - accuracy: 0.9992 - val_loss: 0.2537 - val_accuracy: 0.9447
Confusion matrix: 
 [[551  22]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.83
Validation accuracy: 94.47
Validation recall: 71.43
Validation precision: 57.69
Validation AUC: 0.7653279415887722
Validation class accuracies: [0.9616055846422339, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 16 epochs
Epoch 27/65
154/154 - 62s - loss: 0.0033 - accuracy: 1.0000 - val_loss: 0.2591 - val_accuracy: 0.9431
Confusion matrix: 
 [[549  24]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.262 0.738]]
Validation f1: 63.92
Validation accuracy: 94.31
Validation recall: 73.81
Validation precision: 56.36
Validation AUC: 0.7720185023955108
Validation class accuracies: [0.9581151832460733, 0.7380952380952381]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 17 epochs
Epoch 28/65
154/154 - 65s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2563 - val_accuracy: 0.9415
Confusion matrix: 
 [[549  24]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.50
Validation accuracy: 94.15
Validation recall: 71.43
Validation precision: 55.56
Validation AUC: 0.7705513862719581
Validation class accuracies: [0.9581151832460733, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 29/65
154/154 - 63s - loss: 0.0029 - accuracy: 1.0000 - val_loss: 0.2371 - val_accuracy: 0.9463
Confusion matrix: 
 [[552  21]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.52
Validation accuracy: 94.63
Validation recall: 71.43
Validation precision: 58.82
Validation AUC: 0.7713117156315854
Validation class accuracies: [0.9633507853403142, 0.7142857142857143]
The validation tracker metric at 0.7317073170731706 hasn't increased by 0 in 19 epochs
Epoch 30/65
154/154 - 63s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.2466 - val_accuracy: 0.9447
Confusion matrix: 
 [[551  22]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.83
Validation accuracy: 94.47
Validation recall: 71.43
Validation precision: 57.69
Validation AUC: 0.7642491997126145
Validation class accuracies: [0.9616055846422339, 0.7142857142857143]

The metrics for job 0 with the best target metric are: 
Best cm: [[563  10]
 [ 12  30]]
Best normalized cm: [[0.983 0.017]
 [0.286 0.714]]
Best f1: 0.73
Best accuracy: 0.96
Best recall: 0.71
Best precision: 0.75
Best AUC: 0.74
Best class accuracies: [0.9825479930191972, 0.7142857142857143]
Best epoch: 10
The number of epochs since last 1% equals the patience
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_218_1b1_Pl_sc_Meditron_5_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_219_2b1_Ar_mc_LittC2SE_2_label_1_pred_1.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_204_7p5_Ll_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_222_1b1_Lr_sc_Meditron_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_221_2b3_Lr_mc_LittC2SE_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_218_1p1_Ar_sc_Litt3200_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_213_1p5_Pl_mc_AKGC417L_3_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_221_2b3_Al_mc_LittC2SE_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_218_1b1_Al_sc_Meditron_4_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_226_1b1_Ll_sc_Meditron_0_label_1_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_211_1p2_Ar_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_207_2b2_Tc_mc_AKGC417L_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/0/icbhi_213_1p3_Ar_mc_AKGC417L_1_label_0_pred_0.png
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 20957
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_122211-3k29qlx3/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_122211-3k29qlx3/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.94472
wandb:             _runtime 2202
wandb:           _timestamp 1624453133
wandb:                _step 218
wandb:           train_loss 0.00276
wandb:             val_loss 0.24661
wandb:           val_recall 0.71429
wandb:        val_precision 0.57692
wandb:               val_f1 0.6383
wandb:              val_auc 0.76425
wandb:                   lr 0.00013
wandb:          best_val_f1 0.73171
wandb:    best_val_accuracy 0.96423
wandb:   best_val_precision 0.75
wandb:      best_val_recall 0.71429
wandb:             best_auc 0.74475
wandb:           best_epoch 10
wandb: Run history:
wandb:   train_accuracy ▁▄▅▆▆▇████████████████████████
wandb:     val_accuracy ▇▇▇█▇▇▇█▁█▇███▇▇██▇█████▆█████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▅▄▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▂▂▁▂▂▂▁█▁▂▁▁▂▂▂▁▂▂▂▁▁▂▂▅▂▂▂▂▂
wandb:       val_recall ▁▁▁▅▇▆▇▆█▆▇▆▆▆▆▇▆▆▇▆▆▆▆▆█▆▇▆▆▆
wandb:    val_precision ▁▁▁█▄▅▄▆▂▇▄▆▆▆▅▅▆▅▅▆▆▆▅▆▃▅▅▅▆▅
wandb:           val_f1 ▁▁▁▇▆▇▆█▃█▆█▇▇▇▇▇▇▇▇▇▇▇▇▅▇▇▇▇▇
wandb:          val_auc ▁▅▅▇▇▇█▇▇████▇█▇████████▇█████
wandb:               lr ████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_122211-3k29qlx3

-----------------------
Mixednet with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 1e-05, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_5 (MixDepthGroupCo (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_6 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_7 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_8 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_9 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 63s - loss: 0.4907 - accuracy: 0.7066 - val_loss: 0.4125 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08127652879661135
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 65s - loss: 0.3538 - accuracy: 0.8498 - val_loss: 0.2996 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08710216028858836
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 63s - loss: 0.2568 - accuracy: 0.8873 - val_loss: 0.2456 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1359163718701053
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 63s - loss: 0.2433 - accuracy: 0.9145 - val_loss: 0.3440 - val_accuracy: 0.8943
Confusion matrix: 
 [[519  54]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.262 0.738]]
Validation f1: 48.82
Validation accuracy: 89.43
Validation recall: 73.81
Validation precision: 36.47
Validation AUC: 0.6696050512703842
Validation class accuracies: [0.9057591623036649, 0.7380952380952381]
Saving model...
Epoch 5/65
154/154 - 63s - loss: 0.1637 - accuracy: 0.9296 - val_loss: 0.2137 - val_accuracy: 0.9154
Confusion matrix: 
 [[533  40]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.286 0.714]]
Validation f1: 53.57
Validation accuracy: 91.54
Validation recall: 71.43
Validation precision: 42.86
Validation AUC: 0.7610711370506997
Validation class accuracies: [0.9301919720767888, 0.7142857142857143]
Saving model...
Epoch 6/65
154/154 - 63s - loss: 0.1331 - accuracy: 0.9508 - val_loss: 0.2066 - val_accuracy: 0.9333
Confusion matrix: 
 [[547  26]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.357 0.643]]
Validation f1: 56.84
Validation accuracy: 93.33
Validation recall: 64.29
Validation precision: 50.94
Validation AUC: 0.6470806366381595
Validation class accuracies: [0.9546247818499127, 0.6428571428571429]
Saving model...
Epoch 7/65
154/154 - 64s - loss: 0.1353 - accuracy: 0.9426 - val_loss: 1.2119 - val_accuracy: 0.6797
Confusion matrix: 
 [[376 197]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.656 0.344]
 [0.    1.   ]]
Validation f1: 29.89
Validation accuracy: 67.97
Validation recall: 100.00
Validation precision: 17.57
Validation AUC: 0.7163563367052609
Validation class accuracies: [0.6561954624781849, 1.0]
The validation tracker metric at 0.568421052631579 hasn't increased by 0 in 1 epochs
Epoch 8/65
154/154 - 63s - loss: 0.1013 - accuracy: 0.9621 - val_loss: 0.2267 - val_accuracy: 0.9675
Confusion matrix: 
 [[571   2]
 [ 18  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.429 0.571]]
Validation f1: 70.59
Validation accuracy: 96.75
Validation recall: 57.14
Validation precision: 92.31
Validation AUC: 0.7244599562667964
Validation class accuracies: [0.9965095986038395, 0.5714285714285714]
Saving model...
Epoch 9/65
154/154 - 63s - loss: 0.0491 - accuracy: 0.9809 - val_loss: 0.2476 - val_accuracy: 0.9350
Confusion matrix: 
 [[552  21]
 [ 19  23]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.452 0.548]]
Validation f1: 53.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.50
Validation recall: 54.76
Validation precision: 52.27
Validation AUC: 0.626356513151101
Validation class accuracies: [0.9633507853403142, 0.5476190476190477]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 1 epochs
Epoch 10/65
154/154 - 63s - loss: 0.0931 - accuracy: 0.9727 - val_loss: 0.7343 - val_accuracy: 0.8504
Confusion matrix: 
 [[492  81]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.262 0.738]]
Validation f1: 40.26
Validation accuracy: 85.04
Validation recall: 73.81
Validation precision: 27.68
Validation AUC: 0.6739468161360299
Validation class accuracies: [0.8586387434554974, 0.7380952380952381]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 2 epochs
Epoch 11/65
154/154 - 64s - loss: 0.0529 - accuracy: 0.9796 - val_loss: 0.1954 - val_accuracy: 0.9398
Confusion matrix: 
 [[548  25]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.286 0.714]]
Validation f1: 61.86
Validation accuracy: 93.98
Validation recall: 71.43
Validation precision: 54.55
Validation AUC: 0.7623330362465608
Validation class accuracies: [0.956369982547993, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 3 epochs
Epoch 12/65
154/154 - 63s - loss: 0.0295 - accuracy: 0.9910 - val_loss: 0.4230 - val_accuracy: 0.8862
Confusion matrix: 
 [[515  58]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.286 0.714]]
Validation f1: 46.15
Validation accuracy: 88.62
Validation recall: 71.43
Validation precision: 34.09
Validation AUC: 0.7324330947673815
Validation class accuracies: [0.8987783595113438, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 4 epochs
Epoch 13/65
154/154 - 63s - loss: 0.0394 - accuracy: 0.9874 - val_loss: 0.5307 - val_accuracy: 0.8423
Confusion matrix: 
 [[486  87]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.238 0.762]]
Validation f1: 39.75
Validation accuracy: 84.23
Validation recall: 76.19
Validation precision: 26.89
Validation AUC: 0.6927369974420122
Validation class accuracies: [0.8481675392670157, 0.7619047619047619]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 5 epochs
Epoch 14/65
154/154 - 62s - loss: 0.0125 - accuracy: 0.9963 - val_loss: 0.2954 - val_accuracy: 0.9382
Confusion matrix: 
 [[547  26]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.286 0.714]]
Validation f1: 61.22
Validation accuracy: 93.82
Validation recall: 71.43
Validation precision: 53.57
Validation AUC: 0.6925317669038185
Validation class accuracies: [0.9546247818499127, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 15/65
154/154 - 63s - loss: 0.0132 - accuracy: 0.9980 - val_loss: 0.3017 - val_accuracy: 0.9220
Confusion matrix: 
 [[534  39]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.214 0.786]]
Validation f1: 57.89
Validation accuracy: 92.20
Validation recall: 78.57
Validation precision: 45.83
Validation AUC: 0.7564832657935415
Validation class accuracies: [0.9319371727748691, 0.7857142857142857]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 7 epochs
Epoch 16/65
154/154 - 63s - loss: 0.0089 - accuracy: 0.9980 - val_loss: 0.3318 - val_accuracy: 0.9187
Confusion matrix: 
 [[535  38]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.286 0.714]]
Validation f1: 54.55
Validation accuracy: 91.87
Validation recall: 71.43
Validation precision: 44.12
Validation AUC: 0.7237399029877085
Validation class accuracies: [0.9336823734729494, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 8 epochs
Epoch 17/65
154/154 - 63s - loss: 0.0081 - accuracy: 0.9976 - val_loss: 0.2884 - val_accuracy: 0.9333
Confusion matrix: 
 [[544  29]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.286 0.714]]
Validation f1: 59.41
Validation accuracy: 93.33
Validation recall: 71.43
Validation precision: 50.85
Validation AUC: 0.7387528861170145
Validation class accuracies: [0.9493891797556719, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 9 epochs
Epoch 18/65
154/154 - 63s - loss: 0.0068 - accuracy: 0.9992 - val_loss: 0.3566 - val_accuracy: 0.9203
Confusion matrix: 
 [[536  37]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.286 0.714]]
Validation f1: 55.05
Validation accuracy: 92.03
Validation recall: 71.43
Validation precision: 44.78
Validation AUC: 0.6790461453586186
Validation class accuracies: [0.9354275741710296, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 10 epochs
Epoch 19/65
154/154 - 62s - loss: 0.0059 - accuracy: 0.9996 - val_loss: 0.2714 - val_accuracy: 0.9317
Confusion matrix: 
 [[543  30]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.286 0.714]]
Validation f1: 58.82
Validation accuracy: 93.17
Validation recall: 71.43
Validation precision: 50.00
Validation AUC: 0.7604225807376955
Validation class accuracies: [0.9476439790575916, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 11 epochs
Epoch 20/65
154/154 - 64s - loss: 0.0127 - accuracy: 0.9976 - val_loss: 0.5718 - val_accuracy: 0.8618
Confusion matrix: 
 [[500  73]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.286 0.714]]
Validation f1: 41.38
Validation accuracy: 86.18
Validation recall: 71.43
Validation precision: 29.13
Validation AUC: 0.5740998936457544
Validation class accuracies: [0.8726003490401396, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 21/65
154/154 - 63s - loss: 0.0182 - accuracy: 0.9967 - val_loss: 0.7675 - val_accuracy: 0.8179
Confusion matrix: 
 [[468 105]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.167 0.833]]
Validation f1: 38.46
Validation accuracy: 81.79
Validation recall: 83.33
Validation precision: 25.00
Validation AUC: 0.741418984179107
Validation class accuracies: [0.8167539267015707, 0.8333333333333334]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 13 epochs
Epoch 22/65
154/154 - 63s - loss: 0.0166 - accuracy: 0.9939 - val_loss: 0.2904 - val_accuracy: 0.9415
Confusion matrix: 
 [[549  24]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.50
Validation accuracy: 94.15
Validation recall: 71.43
Validation precision: 55.56
Validation AUC: 0.725203851746623
Validation class accuracies: [0.9581151832460733, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 14 epochs
Epoch 23/65
154/154 - 63s - loss: 0.0049 - accuracy: 1.0000 - val_loss: 0.3489 - val_accuracy: 0.9268
Confusion matrix: 
 [[540  33]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.286 0.714]]
Validation f1: 57.14
Validation accuracy: 92.68
Validation recall: 71.43
Validation precision: 47.62
Validation AUC: 0.7233820556898053
Validation class accuracies: [0.9424083769633508, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 15 epochs
Epoch 24/65
154/154 - 65s - loss: 0.0036 - accuracy: 1.0000 - val_loss: 0.3298 - val_accuracy: 0.9333
Confusion matrix: 
 [[544  29]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.41
Validation accuracy: 93.33
Validation recall: 71.43
Validation precision: 50.85
Validation AUC: 0.7275357511367704
Validation class accuracies: [0.9493891797556719, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 16 epochs
Epoch 25/65
154/154 - 63s - loss: 0.0056 - accuracy: 0.9992 - val_loss: 0.3690 - val_accuracy: 0.9317
Confusion matrix: 
 [[543  30]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.82
Validation accuracy: 93.17
Validation recall: 71.43
Validation precision: 50.00
Validation AUC: 0.6979417364245117
Validation class accuracies: [0.9476439790575916, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 17 epochs
Epoch 26/65
154/154 - 63s - loss: 0.0042 - accuracy: 0.9996 - val_loss: 0.3428 - val_accuracy: 0.9333
Confusion matrix: 
 [[544  29]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.41
Validation accuracy: 93.33
Validation recall: 71.43
Validation precision: 50.85
Validation AUC: 0.7044106846434081
Validation class accuracies: [0.9493891797556719, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 27/65
154/154 - 63s - loss: 0.0026 - accuracy: 1.0000 - val_loss: 0.3999 - val_accuracy: 0.9220
Confusion matrix: 
 [[537  36]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.286 0.714]]
Validation f1: 55.56
Validation accuracy: 92.20
Validation recall: 71.43
Validation precision: 45.45
Validation AUC: 0.7048228204269036
Validation class accuracies: [0.93717277486911, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 19 epochs
Epoch 28/65
154/154 - 63s - loss: 0.0045 - accuracy: 0.9996 - val_loss: 0.4319 - val_accuracy: 0.9089
Confusion matrix: 
 [[527  46]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.238 0.762]]
Validation f1: 53.33
Validation accuracy: 90.89
Validation recall: 76.19
Validation precision: 41.03
Validation AUC: 0.7245878984242833
Validation class accuracies: [0.9197207678883071, 0.7619047619047619]

The metrics for job 1 with the best target metric are: 
Best cm: [[571   2]
 [ 18  24]]
Best normalized cm: [[0.997 0.003]
 [0.429 0.571]]
Best f1: 0.71
Best accuracy: 0.97
Best recall: 0.57
Best precision: 0.92
Best AUC: 0.72
Best class accuracies: [0.9965095986038395, 0.5714285714285714]
Best epoch: 8
The number of epochs since last 1% equals the patience
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_205_1b3_Al_mc_AKGC417L_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_205_4b2_Pl_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_215_1b2_Ar_sc_Meditron_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_207_2b3_Tc_mc_AKGC417L_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_213_1p2_Pl_mc_AKGC417L_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_223_1b1_Pl_sc_Meditron_3_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_213_1p5_Tc_mc_AKGC417L_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_218_1p1_Pr_sc_Litt3200_1_label_0_pred_1.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_221_2b3_Ar_mc_LittC2SE_1_label_0_pred_1.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_218_1b1_Ar_sc_Meditron_7_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_211_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/1/icbhi_205_2b4_Pl_mc_AKGC417L_2_label_0_pred_0.png
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/helpers.py:59: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig = plt.figure(figsize=(20, 10))
wandb: Waiting for W&B process to finish, PID 32157
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_125908-rnh9jvwl/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_125908-rnh9jvwl/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99959
wandb:         val_accuracy 0.90894
wandb:             _runtime 2048
wandb:           _timestamp 1624455196
wandb:                _step 207
wandb:           train_loss 0.0045
wandb:             val_loss 0.43189
wandb:           val_recall 0.7619
wandb:        val_precision 0.41026
wandb:               val_f1 0.53333
wandb:              val_auc 0.72459
wandb:                   lr 0.00013
wandb:          best_val_f1 0.70588
wandb:    best_val_accuracy 0.96748
wandb:   best_val_precision 0.92308
wandb:      best_val_recall 0.57143
wandb:             best_auc 0.72446
wandb:           best_epoch 8
wandb: Run history:
wandb:   train_accuracy ▁▄▅▆▆▇▇▇█▇██████████████████
wandb:     val_accuracy ▇▇▇▆▇▇▁█▇▅▇▆▅▇▇▇▇▇▇▅▄▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▅▄▃▃▃▂▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▁▂▁▁█▁▁▅▁▃▃▂▂▂▂▂▂▄▅▂▂▂▂▂▂▃
wandb:       val_recall ▁▁▁▆▆▅█▅▅▆▆▆▆▆▆▆▆▆▆▆▇▆▆▆▆▆▆▆
wandb:    val_precision ▁▁▁▄▄▅▂█▅▃▅▄▃▅▄▄▅▄▅▃▃▅▅▅▅▅▄▄
wandb:           val_f1 ▁▁▁▆▆▇▄█▆▅▇▆▅▇▇▆▇▆▇▅▅▇▇▇▇▇▇▆
wandb:          val_auc ▁▁▂▇█▇██▇▇██▇▇███▇█▆████▇▇▇█
wandb:               lr ██████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_125908-rnh9jvwl

-----------------------
Mixednet with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0.4, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_3 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_10 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_11 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_12 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_13 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_14 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 62s - loss: 0.6929 - accuracy: 0.7525 - val_loss: 0.6145 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.11328687632386156
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 63s - loss: 0.6552 - accuracy: 0.8604 - val_loss: 0.6803 - val_accuracy: 0.8667
Confusion matrix: 
 [[512  61]
 [ 21  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.5   0.5  ]]
Validation f1: 33.87
Validation accuracy: 86.67
Validation recall: 50.00
Validation precision: 25.61
Validation AUC: 0.3356781317078707
Validation class accuracies: [0.893542757417103, 0.5]
Saving model...
Epoch 3/65
154/154 - 62s - loss: 0.6402 - accuracy: 0.8926 - val_loss: 0.8834 - val_accuracy: 0.1951
Confusion matrix: 
 [[ 78 495]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.136 0.864]
 [0.    1.   ]]
Validation f1: 14.51
Validation accuracy: 19.51
Validation recall: 100.00
Validation precision: 7.82
Validation AUC: 0.18565826729274257
Validation class accuracies: [0.13612565445026178, 1.0]
The validation tracker metric at 0.33870967741935487 hasn't increased by 0 in 1 epochs
Epoch 4/65
154/154 - 62s - loss: 0.6340 - accuracy: 0.9149 - val_loss: 0.5934 - val_accuracy: 0.8358
Confusion matrix: 
 [[476  97]
 [  4  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.831 0.169]
 [0.095 0.905]]
Validation f1: 42.94
Validation accuracy: 83.58
Validation recall: 90.48
Validation precision: 28.15
Validation AUC: 0.6115257145729636
Validation class accuracies: [0.8307155322862129, 0.9047619047619048]
Saving model...
Epoch 5/65
154/154 - 64s - loss: 0.6201 - accuracy: 0.9324 - val_loss: 0.5654 - val_accuracy: 0.9057
Confusion matrix: 
 [[527  46]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.286 0.714]]
Validation f1: 50.85
Validation accuracy: 90.57
Validation recall: 71.43
Validation precision: 39.47
Validation AUC: 0.6148898201597016
Validation class accuracies: [0.9197207678883071, 0.7142857142857143]
Saving model...
Epoch 6/65
154/154 - 63s - loss: 0.6107 - accuracy: 0.9646 - val_loss: 0.7739 - val_accuracy: 0.5317
Confusion matrix: 
 [[286 287]
 [  1  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.499 0.501]
 [0.024 0.976]]
Validation f1: 22.16
Validation accuracy: 53.17
Validation recall: 97.62
Validation precision: 12.50
Validation AUC: 0.6495667648507161
Validation class accuracies: [0.49912739965095987, 0.9761904761904762]
The validation tracker metric at 0.5084745762711864 hasn't increased by 0 in 1 epochs
Epoch 7/65
154/154 - 63s - loss: 0.6120 - accuracy: 0.9626 - val_loss: 0.5819 - val_accuracy: 0.8878
Confusion matrix: 
 [[511  62]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.167 0.833]]
Validation f1: 50.36
Validation accuracy: 88.78
Validation recall: 83.33
Validation precision: 36.08
Validation AUC: 0.6627076607053928
Validation class accuracies: [0.8917975567190227, 0.8333333333333334]
The validation tracker metric at 0.5084745762711864 hasn't increased by 0 in 2 epochs
Epoch 8/65
154/154 - 63s - loss: 0.6042 - accuracy: 0.9707 - val_loss: 0.5639 - val_accuracy: 0.9154
Confusion matrix: 
 [[528  45]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.167 0.833]]
Validation f1: 57.38
Validation accuracy: 91.54
Validation recall: 83.33
Validation precision: 43.75
Validation AUC: 0.7659655323905742
Validation class accuracies: [0.9214659685863874, 0.8333333333333334]
Saving model...
Epoch 9/65
154/154 - 65s - loss: 0.5996 - accuracy: 0.9870 - val_loss: 0.5869 - val_accuracy: 0.8618
Confusion matrix: 
 [[494  79]
 [  6  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.143 0.857]]
Validation f1: 45.86
Validation accuracy: 86.18
Validation recall: 85.71
Validation precision: 31.30
Validation AUC: 0.6882581697143736
Validation class accuracies: [0.8621291448516579, 0.8571428571428571]
The validation tracker metric at 0.5737704918032787 hasn't increased by 0 in 1 epochs
Epoch 10/65
154/154 - 63s - loss: 0.5915 - accuracy: 0.9906 - val_loss: 0.6103 - val_accuracy: 0.8293
Confusion matrix: 
 [[475  98]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.167 0.833]]
Validation f1: 40.00
Validation accuracy: 82.93
Validation recall: 83.33
Validation precision: 26.32
Validation AUC: 0.6279326085297384
Validation class accuracies: [0.8289703315881326, 0.8333333333333334]
The validation tracker metric at 0.5737704918032787 hasn't increased by 0 in 2 epochs
Epoch 11/65
154/154 - 63s - loss: 0.5910 - accuracy: 0.9939 - val_loss: 0.5553 - val_accuracy: 0.9496
Confusion matrix: 
 [[555  18]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.31  0.69 ]]
Validation f1: 65.17
Validation accuracy: 94.96
Validation recall: 69.05
Validation precision: 61.70
Validation AUC: 0.7136749147536393
Validation class accuracies: [0.9685863874345549, 0.6904761904761905]
Saving model...
Epoch 12/65
154/154 - 63s - loss: 0.5896 - accuracy: 0.9943 - val_loss: 0.5522 - val_accuracy: 0.9431
Confusion matrix: 
 [[552  21]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.333 0.667]]
Validation f1: 61.54
Validation accuracy: 94.31
Validation recall: 66.67
Validation precision: 57.14
Validation AUC: 0.7279576363647055
Validation class accuracies: [0.9633507853403142, 0.6666666666666666]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 1 epochs
Epoch 13/65
154/154 - 63s - loss: 0.5882 - accuracy: 0.9963 - val_loss: 0.6106 - val_accuracy: 0.8081
Confusion matrix: 
 [[460 113]
 [  5  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.803 0.197]
 [0.119 0.881]]
Validation f1: 38.54
Validation accuracy: 80.81
Validation recall: 88.10
Validation precision: 24.67
Validation AUC: 0.7179859907694999
Validation class accuracies: [0.8027923211169284, 0.8809523809523809]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 2 epochs
Epoch 14/65
154/154 - 63s - loss: 0.5876 - accuracy: 0.9972 - val_loss: 0.5599 - val_accuracy: 0.9122
Confusion matrix: 
 [[525  48]
 [  6  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.143 0.857]]
Validation f1: 57.14
Validation accuracy: 91.22
Validation recall: 85.71
Validation precision: 42.86
Validation AUC: 0.7373764015677035
Validation class accuracies: [0.9162303664921466, 0.8571428571428571]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 3 epochs
Epoch 15/65
154/154 - 63s - loss: 0.5859 - accuracy: 0.9976 - val_loss: 0.5539 - val_accuracy: 0.9366
Confusion matrix: 
 [[549  24]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.357 0.643]]
Validation f1: 58.06
Validation accuracy: 93.66
Validation recall: 64.29
Validation precision: 52.94
Validation AUC: 0.6839941033438484
Validation class accuracies: [0.9581151832460733, 0.6428571428571429]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 4 epochs
Epoch 16/65
154/154 - 63s - loss: 0.5868 - accuracy: 0.9967 - val_loss: 0.5542 - val_accuracy: 0.9187
Confusion matrix: 
 [[537  36]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.333 0.667]]
Validation f1: 52.83
Validation accuracy: 91.87
Validation recall: 66.67
Validation precision: 43.75
Validation AUC: 0.7024218639140541
Validation class accuracies: [0.93717277486911, 0.6666666666666666]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 5 epochs
Epoch 17/65
154/154 - 63s - loss: 0.5854 - accuracy: 0.9976 - val_loss: 0.5439 - val_accuracy: 0.9610
Confusion matrix: 
 [[562  11]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.31  0.69 ]]
Validation f1: 70.73
Validation accuracy: 96.10
Validation recall: 69.05
Validation precision: 72.50
Validation AUC: 0.7395761710734614
Validation class accuracies: [0.9808027923211169, 0.6904761904761905]
Saving model...
Epoch 18/65
154/154 - 64s - loss: 0.5835 - accuracy: 0.9988 - val_loss: 0.5382 - val_accuracy: 0.9593
Confusion matrix: 
 [[561  12]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.31  0.69 ]]
Validation f1: 69.88
Validation accuracy: 95.93
Validation recall: 69.05
Validation precision: 70.73
Validation AUC: 0.7439715228540252
Validation class accuracies: [0.9790575916230366, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 1 epochs
Epoch 19/65
154/154 - 63s - loss: 0.5836 - accuracy: 0.9988 - val_loss: 0.5445 - val_accuracy: 0.9496
Confusion matrix: 
 [[559  14]
 [ 17  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.405 0.595]]
Validation f1: 61.73
Validation accuracy: 94.96
Validation recall: 59.52
Validation precision: 64.10
Validation AUC: 0.6842757258489635
Validation class accuracies: [0.9755671902268761, 0.5952380952380952]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 2 epochs
Epoch 20/65
154/154 - 63s - loss: 0.5820 - accuracy: 0.9996 - val_loss: 0.5478 - val_accuracy: 0.9398
Confusion matrix: 
 [[548  25]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 61.86
Validation accuracy: 93.98
Validation recall: 71.43
Validation precision: 54.55
Validation AUC: 0.7192723027452528
Validation class accuracies: [0.956369982547993, 0.7142857142857143]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 3 epochs
Epoch 21/65
154/154 - 63s - loss: 0.5818 - accuracy: 0.9992 - val_loss: 0.5394 - val_accuracy: 0.9626
Confusion matrix: 
 [[567   6]
 [ 17  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.405 0.595]]
Validation f1: 68.49
Validation accuracy: 96.26
Validation recall: 59.52
Validation precision: 80.65
Validation AUC: 0.7153805388947554
Validation class accuracies: [0.9895287958115183, 0.5952380952380952]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 4 epochs
Epoch 22/65
154/154 - 65s - loss: 0.5812 - accuracy: 0.9992 - val_loss: 0.5579 - val_accuracy: 0.9008
Confusion matrix: 
 [[525  48]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.31  0.69 ]]
Validation f1: 48.74
Validation accuracy: 90.08
Validation recall: 69.05
Validation precision: 37.66
Validation AUC: 0.6612730010953228
Validation class accuracies: [0.9162303664921466, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 5 epochs
Epoch 23/65
154/154 - 63s - loss: 0.5825 - accuracy: 0.9996 - val_loss: 0.5488 - val_accuracy: 0.9187
Confusion matrix: 
 [[535  38]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 54.55
Validation accuracy: 91.87
Validation recall: 71.43
Validation precision: 44.12
Validation AUC: 0.7313085275855798
Validation class accuracies: [0.9336823734729494, 0.7142857142857143]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 24/65
154/154 - 62s - loss: 0.5830 - accuracy: 0.9996 - val_loss: 0.5414 - val_accuracy: 0.9431
Confusion matrix: 
 [[551  22]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.31  0.69 ]]
Validation f1: 62.37
Validation accuracy: 94.31
Validation recall: 69.05
Validation precision: 56.86
Validation AUC: 0.743797390853163
Validation class accuracies: [0.9616055846422339, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 7 epochs
Epoch 25/65
154/154 - 62s - loss: 0.5807 - accuracy: 1.0000 - val_loss: 0.5457 - val_accuracy: 0.9301
Confusion matrix: 
 [[543  30]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.31  0.69 ]]
Validation f1: 57.43
Validation accuracy: 93.01
Validation recall: 69.05
Validation precision: 49.15
Validation AUC: 0.7188985210719723
Validation class accuracies: [0.9476439790575916, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 8 epochs
Epoch 26/65
154/154 - 62s - loss: 0.5795 - accuracy: 0.9996 - val_loss: 0.5440 - val_accuracy: 0.9350
Confusion matrix: 
 [[546  27]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.31  0.69 ]]
Validation f1: 59.18
Validation accuracy: 93.50
Validation recall: 69.05
Validation precision: 51.79
Validation AUC: 0.7499900321233085
Validation class accuracies: [0.9528795811518325, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 9 epochs
Epoch 27/65
154/154 - 64s - loss: 0.5786 - accuracy: 0.9992 - val_loss: 0.5391 - val_accuracy: 0.9496
Confusion matrix: 
 [[555  18]
 [ 13  29]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.31  0.69 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 65.17
Validation accuracy: 94.96
Validation recall: 69.05
Validation precision: 61.70
Validation AUC: 0.7352685692134431
Validation class accuracies: [0.9685863874345549, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 10 epochs
Epoch 28/65
154/154 - 62s - loss: 0.5804 - accuracy: 0.9996 - val_loss: 0.5374 - val_accuracy: 0.9561
Confusion matrix: 
 [[560  13]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.333 0.667]]
Validation f1: 67.47
Validation accuracy: 95.61
Validation recall: 66.67
Validation precision: 68.29
Validation AUC: 0.7196124237122903
Validation class accuracies: [0.9773123909249564, 0.6666666666666666]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 11 epochs
Epoch 29/65
154/154 - 62s - loss: 0.5799 - accuracy: 0.9988 - val_loss: 0.5391 - val_accuracy: 0.9561
Confusion matrix: 
 [[559  14]
 [ 13  29]]
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.31  0.69 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 68.24
Validation accuracy: 95.61
Validation recall: 69.05
Validation precision: 67.44
Validation AUC: 0.7352059959519278
Validation class accuracies: [0.9755671902268761, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 30/65
154/154 - 62s - loss: 0.5777 - accuracy: 0.9996 - val_loss: 0.5403 - val_accuracy: 0.9431
Confusion matrix: 
 [[551  22]
 [ 13  29]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.31  0.69 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.37
Validation accuracy: 94.31
Validation recall: 69.05
Validation precision: 56.86
Validation AUC: 0.7396853757547714
Validation class accuracies: [0.9616055846422339, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 13 epochs
Epoch 31/65
154/154 - 64s - loss: 0.5777 - accuracy: 0.9996 - val_loss: 0.5388 - val_accuracy: 0.9545
Confusion matrix: 
 [[558  15]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.31  0.69 ]]
Validation f1: 67.44
Validation accuracy: 95.45
Validation recall: 69.05
Validation precision: 65.91
Validation AUC: 0.7215052732461391
Validation class accuracies: [0.9738219895287958, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 14 epochs
Epoch 32/65
154/154 - 63s - loss: 0.5780 - accuracy: 1.0000 - val_loss: 0.5479 - val_accuracy: 0.9350
Confusion matrix: 
 [[546  27]
 [ 13  29]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.31  0.69 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 59.18
Validation accuracy: 93.50
Validation recall: 69.05
Validation precision: 51.79
Validation AUC: 0.7225439680093865
Validation class accuracies: [0.9528795811518325, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 15 epochs
Epoch 33/65
154/154 - 62s - loss: 0.5783 - accuracy: 1.0000 - val_loss: 0.5384 - val_accuracy: 0.9528
Confusion matrix: 
 [[558  15]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.333 0.667]]
Validation f1: 65.88
Validation accuracy: 95.28
Validation recall: 66.67
Validation precision: 65.12
Validation AUC: 0.7116482977986321
Validation class accuracies: [0.9738219895287958, 0.6666666666666666]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 16 epochs
Epoch 34/65
154/154 - 62s - loss: 0.5775 - accuracy: 1.0000 - val_loss: 0.5382 - val_accuracy: 0.9528
Confusion matrix: 
 [[557  16]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.31  0.69 ]]
Validation f1: 66.67
Validation accuracy: 95.28
Validation recall: 69.05
Validation precision: 64.44
Validation AUC: 0.7265366717500585
Validation class accuracies: [0.9720767888307156, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 17 epochs
Epoch 35/65
154/154 - 63s - loss: 0.5776 - accuracy: 0.9996 - val_loss: 0.5399 - val_accuracy: 0.9431
Confusion matrix: 
 [[551  22]
 [ 13  29]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.31  0.69 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.37
Validation accuracy: 94.31
Validation recall: 69.05
Validation precision: 56.86
Validation AUC: 0.7323401510483742
Validation class accuracies: [0.9616055846422339, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 36/65
154/154 - 63s - loss: 0.5779 - accuracy: 1.0000 - val_loss: 0.5390 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.31  0.69 ]]
Validation f1: 63.74
Validation accuracy: 94.63
Validation recall: 69.05
Validation precision: 59.18
Validation AUC: 0.7334890005514345
Validation class accuracies: [0.9650959860383944, 0.6904761904761905]
The validation tracker metric at 0.7073170731707318 hasn't increased by 0 in 19 epochs
Epoch 37/65
154/154 - 62s - loss: 0.5792 - accuracy: 1.0000 - val_loss: 0.5404 - val_accuracy: 0.9512
Confusion matrix: 
 [[556  17]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.97 0.03]
 [0.31 0.69]]
Validation f1: 65.91
Validation accuracy: 95.12
Validation recall: 69.05
Validation precision: 63.04
Validation AUC: 0.7216057028073618
Validation class accuracies: [0.9703315881326352, 0.6904761904761905]

The metrics for job 2 with the best target metric are: 
Best cm: [[562  11]
 [ 13  29]]
Best normalized cm: [[0.981 0.019]
 [0.31  0.69 ]]
Best f1: 0.71
Best accuracy: 0.96
Best recall: 0.69
Best precision: 0.72
Best AUC: 0.74
Best class accuracies: [0.9808027923211169, 0.6904761904761905]
Best epoch: 17
The number of epochs since last 1% equals the patience
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_205_3b4_Pl_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_203_2p3_Al_mc_AKGC417L_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_205_1b3_Pl_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_219_2b3_Tc_mc_LittC2SE_1_label_1_pred_1.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_222_1b1_Ar_sc_Meditron_11_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_208_1b1_Ll_sc_Meditron_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_221_2b3_Pr_mc_LittC2SE_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_223_1b1_Pl_sc_Meditron_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_218_1p1_Ar_sc_Litt3200_3_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_222_1b1_Pr_sc_Meditron_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_221_2b2_Pl_mc_LittC2SE_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_207_2b3_Tc_mc_AKGC417L_3_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_207_2b3_Pr_mc_AKGC417L_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/2/icbhi_203_2p3_Al_mc_AKGC417L_3_label_0_pred_0.png
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/helpers.py:59: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig = plt.figure(figsize=(20, 10))
wandb: Waiting for W&B process to finish, PID 10730
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_133332-144e4hg2/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_133332-144e4hg2/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.95122
wandb:             _runtime 2696
wandb:           _timestamp 1624457909
wandb:                _step 276
wandb:           train_loss 0.57925
wandb:             val_loss 0.54038
wandb:           val_recall 0.69048
wandb:        val_precision 0.63043
wandb:               val_f1 0.65909
wandb:              val_auc 0.72161
wandb:                   lr 0.00013
wandb:          best_val_f1 0.70732
wandb:    best_val_accuracy 0.96098
wandb:   best_val_precision 0.725
wandb:      best_val_recall 0.69048
wandb:             best_auc 0.73958
wandb:           best_epoch 17
wandb: Run history:
wandb:   train_accuracy ▁▄▅▆▆▇▇▇█████████████████████████████
wandb:     val_accuracy █▇▁▇▇▄▇█▇▇██▇████████▇███████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▅▄▄▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▄█▂▂▆▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▅█▇▆█▇▇▇▇▆▆▇▇▅▆▆▆▅▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▃▂▃▄▂▄▅▄▃▆▆▃▅▆▅▇▇▇▆█▄▅▆▅▅▆▇▇▆▇▅▇▇▆▆▆
wandb:           val_f1 ▁▄▂▅▆▃▆▇▆▅▇▇▅▇▇▆██▇▇█▆▆▇▇▇▇██▇█▇██▇▇█
wandb:          val_auc ▁▃▂▆▆▇▇█▇▇▇█▇█▇▇██▇▇▇▇██▇███████▇████
wandb:               lr ███████████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_133332-144e4hg2

-----------------------
Mixednet with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 32, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_4 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_15 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_16 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_17 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_18 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_19 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_3 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
77/77 - 67s - loss: 0.5412 - accuracy: 0.6516 - val_loss: 0.5490 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07380879805143753
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
77/77 - 61s - loss: 0.3468 - accuracy: 0.8099 - val_loss: 0.4051 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07231431982938918
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
77/77 - 62s - loss: 0.2541 - accuracy: 0.8751 - val_loss: 0.3209 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.11640022606594186
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
77/77 - 61s - loss: 0.1933 - accuracy: 0.9214 - val_loss: 0.2618 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09160175307229593
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 4 epochs
Epoch 5/65
77/77 - 61s - loss: 0.1926 - accuracy: 0.9316 - val_loss: 0.2467 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.15847419378960226
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 5 epochs
Epoch 6/65
77/77 - 61s - loss: 0.1251 - accuracy: 0.9426 - val_loss: 0.2745 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.44734566865553976
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 7/65
77/77 - 63s - loss: 0.0663 - accuracy: 0.9805 - val_loss: 0.2317 - val_accuracy: 0.9350
Confusion matrix: 
 [[573   0]
 [ 40   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.952 0.048]]
Validation f1: 9.09
Validation accuracy: 93.50
Validation recall: 4.76
Validation precision: 100.00
Validation AUC: 0.6797297655631208
Validation class accuracies: [1.0, 0.047619047619047616]
Saving model...
Epoch 8/65
77/77 - 61s - loss: 0.0568 - accuracy: 0.9845 - val_loss: 0.1692 - val_accuracy: 0.9675
Confusion matrix: 
 [[570   3]
 [ 17  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.405 0.595]]
Validation f1: 71.43
Validation accuracy: 96.75
Validation recall: 59.52
Validation precision: 89.29
Validation AUC: 0.7176909416714071
Validation class accuracies: [0.9947643979057592, 0.5952380952380952]
Saving model...
Epoch 9/65
77/77 - 62s - loss: 0.0416 - accuracy: 0.9915 - val_loss: 0.1993 - val_accuracy: 0.9480
Confusion matrix: 
 [[553  20]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.286 0.714]]
Validation f1: 65.22
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 94.80
Validation recall: 71.43
Validation precision: 60.00
Validation AUC: 0.7202390816459691
Validation class accuracies: [0.9650959860383944, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 1 epochs
Epoch 10/65
77/77 - 61s - loss: 0.0323 - accuracy: 0.9951 - val_loss: 0.3083 - val_accuracy: 0.8846
Confusion matrix: 
 [[513  60]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.262 0.738]]
Validation f1: 46.62
Validation accuracy: 88.46
Validation recall: 73.81
Validation precision: 34.07
Validation AUC: 0.7332519793435314
Validation class accuracies: [0.8952879581151832, 0.7380952380952381]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 2 epochs
Epoch 11/65
77/77 - 61s - loss: 0.0242 - accuracy: 0.9972 - val_loss: 0.2059 - val_accuracy: 0.9350
Confusion matrix: 
 [[545  28]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 60.00
Validation accuracy: 93.50
Validation recall: 71.43
Validation precision: 51.72
Validation AUC: 0.7386533354887694
Validation class accuracies: [0.9511343804537522, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 3 epochs
Epoch 12/65
77/77 - 61s - loss: 0.0215 - accuracy: 0.9976 - val_loss: 0.2134 - val_accuracy: 0.9382
Confusion matrix: 
 [[547  26]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 61.22
Validation accuracy: 93.82
Validation recall: 71.43
Validation precision: 53.57
Validation AUC: 0.7296569062698257
Validation class accuracies: [0.9546247818499127, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 4 epochs
Epoch 13/65
77/77 - 61s - loss: 0.0196 - accuracy: 0.9988 - val_loss: 0.2906 - val_accuracy: 0.9057
Confusion matrix: 
 [[524  49]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.214 0.786]]
Validation f1: 53.23
Validation accuracy: 90.57
Validation recall: 78.57
Validation precision: 40.24
Validation AUC: 0.7438364802312988
Validation class accuracies: [0.9144851657940664, 0.7857142857142857]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 5 epochs
Epoch 14/65
77/77 - 61s - loss: 0.0156 - accuracy: 0.9992 - val_loss: 0.2740 - val_accuracy: 0.9041
Confusion matrix: 
 [[524  49]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.238 0.762]]
Validation f1: 52.03
Validation accuracy: 90.41
Validation recall: 76.19
Validation precision: 39.51
Validation AUC: 0.7387455004933826
Validation class accuracies: [0.9144851657940664, 0.7619047619047619]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 15/65
77/77 - 61s - loss: 0.0147 - accuracy: 0.9988 - val_loss: 0.3055 - val_accuracy: 0.8976
Confusion matrix: 
 [[522  51]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.286 0.714]]
Validation f1: 48.78
Validation accuracy: 89.76
Validation recall: 71.43
Validation precision: 37.04
Validation AUC: 0.7302583320135667
Validation class accuracies: [0.9109947643979057, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 7 epochs
Epoch 16/65
77/77 - 62s - loss: 0.0124 - accuracy: 1.0000 - val_loss: 0.3183 - val_accuracy: 0.8976
Confusion matrix: 
 [[522  51]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 48.78
Validation accuracy: 89.76
Validation recall: 71.43
Validation precision: 37.04
Validation AUC: 0.7190975990189175
Validation class accuracies: [0.9109947643979057, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 8 epochs
Epoch 17/65
77/77 - 61s - loss: 0.0113 - accuracy: 1.0000 - val_loss: 0.3447 - val_accuracy: 0.8862
Confusion matrix: 
 [[515  58]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 46.15
Validation accuracy: 88.62
Validation recall: 71.43
Validation precision: 34.09
Validation AUC: 0.726433259942585
Validation class accuracies: [0.8987783595113438, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 9 epochs
Epoch 18/65
77/77 - 62s - loss: 0.0109 - accuracy: 0.9996 - val_loss: 0.3602 - val_accuracy: 0.8878
Confusion matrix: 
 [[516  57]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.286 0.714]]
Validation f1: 46.51
Validation accuracy: 88.78
Validation recall: 71.43
Validation precision: 34.48
Validation AUC: 0.6963572231215012
Validation class accuracies: [0.900523560209424, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 10 epochs
Epoch 19/65
77/77 - 61s - loss: 0.0108 - accuracy: 0.9996 - val_loss: 0.3280 - val_accuracy: 0.8927
Confusion matrix: 
 [[519  54]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.286 0.714]]
Validation f1: 47.62
Validation accuracy: 89.27
Validation recall: 71.43
Validation precision: 35.71
Validation AUC: 0.7113111457985369
Validation class accuracies: [0.9057591623036649, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 11 epochs
Epoch 20/65
77/77 - 61s - loss: 0.0090 - accuracy: 1.0000 - val_loss: 0.3274 - val_accuracy: 0.9008
Confusion matrix: 
 [[524  49]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.286 0.714]]
Validation f1: 49.59
Validation accuracy: 90.08
Validation recall: 71.43
Validation precision: 37.97
Validation AUC: 0.7142100270673665
Validation class accuracies: [0.9144851657940664, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 21/65
77/77 - 61s - loss: 0.0100 - accuracy: 1.0000 - val_loss: 0.3665 - val_accuracy: 0.8862
Confusion matrix: 
 [[515  58]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 46.15
Validation accuracy: 88.62
Validation recall: 71.43
Validation precision: 34.09
Validation AUC: 0.6956080505514504
Validation class accuracies: [0.8987783595113438, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 13 epochs
Epoch 22/65
77/77 - 61s - loss: 0.0081 - accuracy: 1.0000 - val_loss: 0.3273 - val_accuracy: 0.8976
Confusion matrix: 
 [[522  51]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 48.78
Validation accuracy: 89.76
Validation recall: 71.43
Validation precision: 37.04
Validation AUC: 0.7080228566540157
Validation class accuracies: [0.9109947643979057, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 14 epochs
Epoch 23/65
77/77 - 61s - loss: 0.0084 - accuracy: 0.9996 - val_loss: 0.3224 - val_accuracy: 0.8976
Confusion matrix: 
 [[522  51]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 48.78
Validation accuracy: 89.76
Validation recall: 71.43
Validation precision: 37.04
Validation AUC: 0.7106459248812862
Validation class accuracies: [0.9109947643979057, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 15 epochs
Epoch 24/65
77/77 - 62s - loss: 0.0085 - accuracy: 1.0000 - val_loss: 0.3314 - val_accuracy: 0.8959
Confusion matrix: 
 [[521  52]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.286 0.714]]
Validation f1: 48.39
Validation accuracy: 89.59
Validation recall: 71.43
Validation precision: 36.59
Validation AUC: 0.7132078586652316
Validation class accuracies: [0.9092495636998255, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 16 epochs
Epoch 25/65
77/77 - 62s - loss: 0.0082 - accuracy: 1.0000 - val_loss: 0.3863 - val_accuracy: 0.8829
Confusion matrix: 
 [[513  60]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.286 0.714]]
Validation f1: 45.45
Validation accuracy: 88.29
Validation recall: 71.43
Validation precision: 33.33
Validation AUC: 0.7142974589551039
Validation class accuracies: [0.8952879581151832, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 17 epochs
Epoch 26/65
77/77 - 61s - loss: 0.0080 - accuracy: 1.0000 - val_loss: 0.3563 - val_accuracy: 0.8911
Confusion matrix: 
 [[518  55]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.286 0.714]]
Validation f1: 47.24
Validation accuracy: 89.11
Validation recall: 71.43
Validation precision: 35.29
Validation AUC: 0.704423344660955
Validation class accuracies: [0.9040139616055847, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 27/65
77/77 - 62s - loss: 0.0080 - accuracy: 0.9996 - val_loss: 0.3354 - val_accuracy: 0.8976
Confusion matrix: 
 [[522  51]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.286 0.714]]
Validation f1: 48.78
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 89.76
Validation recall: 71.43
Validation precision: 37.04
Validation AUC: 0.7049283200820798
Validation class accuracies: [0.9109947643979057, 0.7142857142857143]
The validation tracker metric at 0.7142857142857143 hasn't increased by 0 in 19 epochs
Epoch 28/65
77/77 - 62s - loss: 0.0071 - accuracy: 1.0000 - val_loss: 0.3566 - val_accuracy: 0.8878
Confusion matrix: 
 [[516  57]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 46.51
Validation accuracy: 88.78
Validation recall: 71.43
Validation precision: 34.48
Validation AUC: 0.7063743587787756
Validation class accuracies: [0.900523560209424, 0.7142857142857143]

The metrics for job 3 with the best target metric are: 
Best cm: [[570   3]
 [ 17  25]]
Best normalized cm: [[0.995 0.005]
 [0.405 0.595]]
Best f1: 0.71
Best accuracy: 0.97
Best recall: 0.60
Best precision: 0.89
Best AUC: 0.72
Best class accuracies: [0.9947643979057592, 0.5952380952380952]
Best epoch: 8
The number of epochs since last 1% equals the patience
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_213_2p2_Al_mc_AKGC417L_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_226_1b1_Al_sc_Meditron_2_label_1_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_219_2b1_Ar_mc_LittC2SE_1_label_1_pred_1.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_205_4b2_Lr_mc_AKGC417L_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_218_1b1_Pl_sc_Meditron_0_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_208_1b1_Ll_sc_Meditron_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_204_7p5_Al_mc_AKGC417L_3_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_209_1b1_Tc_sc_Meditron_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_221_2b3_Pr_mc_LittC2SE_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_215_1b2_Ar_sc_Meditron_3_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_222_1b1_Lr_sc_Meditron_1_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_211_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png
../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/3/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/helpers.py:59: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig = plt.figure(figsize=(20, 10))
wandb: Waiting for W&B process to finish, PID 24495
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_141843-1kez376m/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_141843-1kez376m/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.8878
wandb:             _runtime 2001
wandb:           _timestamp 1624459925
wandb:                _step 201
wandb:           train_loss 0.00706
wandb:             val_loss 0.35663
wandb:           val_recall 0.71429
wandb:        val_precision 0.34483
wandb:               val_f1 0.46512
wandb:              val_auc 0.70637
wandb:                   lr 6e-05
wandb:          best_val_f1 0.71429
wandb:    best_val_accuracy 0.96748
wandb:   best_val_precision 0.89286
wandb:      best_val_recall 0.59524
wandb:             best_auc 0.71769
wandb:           best_epoch 8
wandb: Run history:
wandb:   train_accuracy ▁▄▅▆▇▇██████████████████████
wandb:     val_accuracy ▅▅▅▅▅▅▅█▆▁▅▆▃▃▂▂▁▁▂▂▁▂▂▂▁▂▂▁
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss █▅▄▃▂▃▂▁▂▄▂▂▃▃▄▄▄▅▄▄▅▄▄▄▅▄▄▄
wandb:       val_recall ▁▁▁▁▁▁▁▆▇█▇▇██▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:    val_precision ▁▁▁▁▁▁█▇▅▃▅▅▄▄▄▄▃▃▄▄▃▄▄▄▃▃▄▃
wandb:           val_f1 ▁▁▁▁▁▁▂█▇▆▇▇▆▆▆▆▆▆▆▆▆▆▆▆▅▆▆▆
wandb:          val_auc ▁▁▁▁▂▅▇█████████████▇███████
wandb:               lr ██████▄▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_141843-1kez376m

-----------------------

 See logs at ../../new_cache/conv__2244__06_1221__v39__mixednet_w_params/logs/