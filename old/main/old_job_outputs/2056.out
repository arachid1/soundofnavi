Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2056
Description:  test
2021-04-14 23:13:27.048534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-14 23:13:30.568033: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-14 23:13:30.569238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-14 23:13:30.658638: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:30.659741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-14 23:13:30.659799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-14 23:13:30.664495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-14 23:13:30.664645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-14 23:13:30.666310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-14 23:13:30.666764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-14 23:13:30.668260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-14 23:13:30.669468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-14 23:13:30.669717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-14 23:13:30.669923: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:30.671078: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:30.672090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-14 23:13:30.674765: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-14 23:13:30.674987: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:30.676007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-14 23:13:30.676069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-14 23:13:30.676127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-14 23:13:30.676150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-14 23:13:30.676172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-14 23:13:30.676194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-14 23:13:30.676230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-14 23:13:30.676252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-14 23:13:30.676286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-14 23:13:30.676408: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:30.677559: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:30.678602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-14 23:13:30.678687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-14 23:13:31.769724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-14 23:13:31.769782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-14 23:13:31.769797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-14 23:13:31.770138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:31.771284: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:31.772322: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-14 23:13:31.773302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:05.0, compute capability: 7.0)
2021-04-14 23:14:31.800846: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-14 23:14:31.800904: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-14 23:14:31.800950: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-14 23:14:31.801252: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-14 23:14:31.802398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-14 23:14:32.020110: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-14 23:14:32.023650: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-14 23:14:32.849273: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-14 23:14:32.850230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-14 23:14:34.717598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-14 23:14:35.532422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-14 23:14:36.661030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-14 23:14:42.559051: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-14 23:14:42.559134: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-14 23:14:43.990253: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-14 23:14:43.992983: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-14 23:14:44.094187: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 508 callback api events and 504 activity events. 
2021-04-14 23:14:44.160925: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2056.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_2312___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___test___2056/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (6, 128, 1250), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 6, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 22, 1.0%
-----------------------
Original number of folders: 453
here
here
here
Actual number of folders: 379
Size of training set: 304
Size of validation set: 75
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 6, 128, 1250)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 8, 128, 1250)      440       
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 128, 1250)      1080      
_________________________________________________________________
average_pooling2d (AveragePo (None, 8, 64, 625)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 8, 64, 625)        2500      
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 16, 64, 625)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 64, 625)       2160      
_________________________________________________________________
average_pooling2d_1 (Average (None, 16, 32, 313)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 16, 32, 313)       1252      
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 32, 313)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 32, 313)       4320      
_________________________________________________________________
average_pooling2d_2 (Average (None, 32, 16, 157)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 32, 16, 157)       628       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 16, 157)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 16, 157)       8640      
_________________________________________________________________
average_pooling2d_3 (Average (None, 64, 8, 79)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 64, 8, 79)         316       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 128, 8, 79)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 8, 79)        17280     
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 4, 40)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 128, 4, 40)        160       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 137,065
Trainable params: 134,637
Non-trainable params: 2,428
_________________________________________________________________
Epoch 1/40
19/19 - 47s - loss: 0.7687 - accuracy: 0.5888 - precision: 0.2561 - recall: 0.2471 - val_loss: 0.6940 - val_accuracy: 0.3200 - val_precision: 0.3200 - val_recall: 1.0000
Epoch 2/40
19/19 - 44s - loss: 0.6997 - accuracy: 0.5592 - precision: 0.3101 - recall: 0.4706 - val_loss: 0.6916 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 3/40
19/19 - 43s - loss: 0.6749 - accuracy: 0.6217 - precision: 0.3636 - recall: 0.4706 - val_loss: 0.6887 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 4/40
19/19 - 42s - loss: 0.6733 - accuracy: 0.5855 - precision: 0.3360 - recall: 0.4941 - val_loss: 0.6844 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 5/40
19/19 - 43s - loss: 0.6696 - accuracy: 0.6579 - precision: 0.4095 - recall: 0.5059 - val_loss: 0.6812 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 6/40
19/19 - 43s - loss: 0.6635 - accuracy: 0.6480 - precision: 0.3878 - recall: 0.4471 - val_loss: 0.6768 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 7/40
19/19 - 43s - loss: 0.6484 - accuracy: 0.6414 - precision: 0.4118 - recall: 0.6588 - val_loss: 0.6738 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 8/40
19/19 - 43s - loss: 0.6417 - accuracy: 0.6776 - precision: 0.4301 - recall: 0.4706 - val_loss: 0.6697 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00

Epoch 00008: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 9/40
19/19 - 34s - loss: 0.6414 - accuracy: 0.6217 - precision: 0.3973 - recall: 0.6824 - val_loss: 0.6673 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 10/40
19/19 - 22s - loss: 0.6382 - accuracy: 0.7171 - precision: 0.4930 - recall: 0.4118 - val_loss: 0.6634 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 11/40
19/19 - 22s - loss: 0.6275 - accuracy: 0.6316 - precision: 0.4029 - recall: 0.6588 - val_loss: 0.6594 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 12/40
19/19 - 23s - loss: 0.6320 - accuracy: 0.6678 - precision: 0.4286 - recall: 0.5647 - val_loss: 0.6549 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 13/40
19/19 - 22s - loss: 0.6101 - accuracy: 0.7039 - precision: 0.4691 - recall: 0.4471 - val_loss: 0.6535 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 14/40
19/19 - 22s - loss: 0.5984 - accuracy: 0.6908 - precision: 0.4609 - recall: 0.6235 - val_loss: 0.6510 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00

Epoch 00014: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 15/40
19/19 - 22s - loss: 0.5738 - accuracy: 0.6974 - precision: 0.4729 - recall: 0.7176 - val_loss: 0.6486 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 16/40
19/19 - 22s - loss: 0.5944 - accuracy: 0.7500 - precision: 0.5464 - recall: 0.6235 - val_loss: 0.6455 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 17/40
19/19 - 22s - loss: 0.5645 - accuracy: 0.6974 - precision: 0.4741 - recall: 0.7529 - val_loss: 0.6413 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 18/40
19/19 - 22s - loss: 0.5343 - accuracy: 0.7664 - precision: 0.5714 - recall: 0.6588 - val_loss: 0.6388 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 19/40
19/19 - 23s - loss: 0.5117 - accuracy: 0.7533 - precision: 0.5410 - recall: 0.7765 - val_loss: 0.6358 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 20/40
19/19 - 22s - loss: 0.4780 - accuracy: 0.8026 - precision: 0.6126 - recall: 0.8000 - val_loss: 0.6335 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00

Epoch 00020: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 21/40
19/19 - 22s - loss: 0.4304 - accuracy: 0.8520 - precision: 0.6923 - recall: 0.8471 - val_loss: 0.6318 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 22/40
19/19 - 22s - loss: 0.3863 - accuracy: 0.8520 - precision: 0.6852 - recall: 0.8706 - val_loss: 0.6301 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 23/40
19/19 - 23s - loss: 0.3579 - accuracy: 0.8882 - precision: 0.7802 - recall: 0.8353 - val_loss: 0.6285 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 24/40
19/19 - 22s - loss: 0.3147 - accuracy: 0.8914 - precision: 0.7453 - recall: 0.9294 - val_loss: 0.6278 - val_accuracy: 0.6800 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 00024: early stopping

 See logs at ../../cache/conv___04_2312___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___test___2056/logs/