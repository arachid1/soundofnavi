Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2141
Description:  mod9_nocw
2021-05-15 16:45:16.808207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-15 16:45:20.216972: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-15 16:45:20.218094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-15 16:45:20.272323: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:20.273120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-15 16:45:20.273155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-15 16:45:20.277218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-15 16:45:20.277336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-15 16:45:20.278539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-15 16:45:20.278875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-15 16:45:20.279973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-15 16:45:20.280918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-15 16:45:20.281079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-15 16:45:20.281227: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:20.282081: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:20.282850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2141.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2141__05_1641__v29__mod9_nocw/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2141
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/3cdrhdi8
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210515_164520-3cdrhdi8
wandb: Run `wandb offline` to turn off syncing.
2021-05-15 16:45:27.108429: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-15 16:45:27.108830: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:27.110042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-15 16:45:27.110142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-15 16:45:27.110236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-15 16:45:27.110286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-15 16:45:27.110322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-15 16:45:27.110355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-15 16:45:27.110389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-15 16:45:27.110422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-15 16:45:27.110454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-15 16:45:27.110617: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:27.111897: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:27.112985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-15 16:45:27.113072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-15 16:45:28.290988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-15 16:45:28.291040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-15 16:45:28.291053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-15 16:45:28.291349: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:28.292198: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:28.292975: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-15 16:45:28.293723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-15 16:46:27.276390: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-15 16:46:27.278314: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-15 16:46:31.042327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-15 16:46:31.880463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-15 16:46:31.890877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
binary
Epoch 1/80
263/263 - 522s - loss: 0.6560 - accuracy: 0.7035 - val_loss: 0.5022 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25166684813887336
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
263/263 - 523s - loss: 0.5873 - accuracy: 0.7240 - val_loss: 0.5221 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1675657551843207
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
263/263 - 527s - loss: 0.5873 - accuracy: 0.7238 - val_loss: 0.5726 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1622404313202475
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
263/263 - 524s - loss: 0.5840 - accuracy: 0.7228 - val_loss: 0.5665 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1737849807340217
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
263/263 - 517s - loss: 0.5804 - accuracy: 0.7238 - val_loss: 0.5017 - val_accuracy: 0.7950
Confusion matrix: 
 [[858  12]
 [211   7]]
Validation f1: 5.91
Validation accuracy: 79.50
Validation recall: 3.21
Validation precision: 36.84
Validation AUC: 0.25393801568970964
Validation class accuracies: [0.9862068965517241, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.05907172995780592
column_sums: [1069   19]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
263/263 - 516s - loss: 0.5832 - accuracy: 0.7238 - val_loss: 0.5444 - val_accuracy: 0.7886
Confusion matrix: 
 [[847  23]
 [207  11]]
Validation f1: 8.73
Validation accuracy: 78.86
Validation recall: 5.05
Validation precision: 32.35
Validation AUC: 0.23736094607293873
Validation class accuracies: [0.9735632183908046, 0.05045871559633028]
TARGET: 1
target metric(test f1): 0.08730158730158731
column_sums: [1054   34]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
263/263 - 510s - loss: 0.5812 - accuracy: 0.7257 - val_loss: 0.5103 - val_accuracy: 0.7950
Confusion matrix: 
 [[863   7]
 [216   2]]
Validation f1: 1.76
Validation accuracy: 79.50
Validation recall: 0.92
Validation precision: 22.22
Validation AUC: 0.24203198903303694
Validation class accuracies: [0.9919540229885058, 0.009174311926605505]
TARGET: 1
target metric(test f1): 0.01762114537444934
column_sums: [1079    9]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
263/263 - 507s - loss: 0.5773 - accuracy: 0.7209 - val_loss: 0.5281 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.21062849402362915
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
263/263 - 507s - loss: 0.5716 - accuracy: 0.7255 - val_loss: 0.5564 - val_accuracy: 0.7803
Confusion matrix: 
 [[842  28]
 [211   7]]
Validation f1: 5.53
Validation accuracy: 78.03
Validation recall: 3.21
Validation precision: 20.00
Validation AUC: 0.2119559525042059
Validation class accuracies: [0.967816091954023, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.05533596837944664
column_sums: [1053   35]
cm_sum: 1088
The training is defaulting to either class.
Epoch 10/80
263/263 - 508s - loss: 0.5720 - accuracy: 0.7266 - val_loss: 0.5505 - val_accuracy: 0.7858
Confusion matrix: 
 [[847  23]
 [210   8]]
Validation f1: 6.43
Validation accuracy: 78.58
Validation recall: 3.67
Validation precision: 25.81
Validation AUC: 0.22239035435260554
Validation class accuracies: [0.9735632183908046, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.06425702811244981
column_sums: [1057   31]
cm_sum: 1088
The training is defaulting to either class.
Epoch 11/80
263/263 - 508s - loss: 0.5671 - accuracy: 0.7266 - val_loss: 0.5258 - val_accuracy: 0.7886
Confusion matrix: 
 [[854  16]
 [214   4]]
Validation f1: 3.36
Validation accuracy: 78.86
Validation recall: 1.83
Validation precision: 20.00
Validation AUC: 0.22192492218009757
Validation class accuracies: [0.9816091954022989, 0.01834862385321101]
TARGET: 1
target metric(test f1): 0.03361344537815126
column_sums: [1068   20]
cm_sum: 1088
The training is defaulting to either class.
Epoch 12/80
263/263 - 509s - loss: 0.5713 - accuracy: 0.7238 - val_loss: 0.5162 - val_accuracy: 0.7960
Confusion matrix: 
 [[865   5]
 [217   1]]
Validation f1: 0.89
Validation accuracy: 79.60
Validation recall: 0.46
Validation precision: 16.67
Validation AUC: 0.20965401642894468
Validation class accuracies: [0.9942528735632183, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.00892857142857143
column_sums: [1082    6]
cm_sum: 1088
The training is defaulting to either class.
Epoch 13/80
263/263 - 508s - loss: 0.5635 - accuracy: 0.7264 - val_loss: 0.5536 - val_accuracy: 0.7960
Confusion matrix: 
 [[863   7]
 [215   3]]
Validation f1: 2.63
Validation accuracy: 79.60
Validation recall: 1.38
Validation precision: 30.00
Validation AUC: 0.1982684391665348
Validation class accuracies: [0.9919540229885058, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.026315789473684216
column_sums: [1078   10]
cm_sum: 1088
The training is defaulting to either class.
Epoch 14/80
263/263 - 507s - loss: 0.5572 - accuracy: 0.7316 - val_loss: 0.5567 - val_accuracy: 0.7693
Confusion matrix: 
 [[829  41]
 [210   8]]
Validation f1: 5.99
Validation accuracy: 76.93
Validation recall: 3.67
Validation precision: 16.33
Validation AUC: 0.2171530376098029
Validation class accuracies: [0.9528735632183908, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.0599250936329588
column_sums: [1039   49]
cm_sum: 1088
The training is defaulting to either class.
Epoch 15/80
263/263 - 507s - loss: 0.5529 - accuracy: 0.7355 - val_loss: 0.5453 - val_accuracy: 0.7665
Confusion matrix: 
 [[822  48]
 [206  12]]
Validation f1: 8.63
Validation accuracy: 76.65
Validation recall: 5.50
Validation precision: 20.00
Validation AUC: 0.21133398380884247
Validation class accuracies: [0.9448275862068966, 0.05504587155963303]
TARGET: 1
target metric(test f1): 0.08633093525179857
column_sums: [1028   60]
cm_sum: 1088
The training is defaulting to either class.
Epoch 16/80
263/263 - 506s - loss: 0.5482 - accuracy: 0.7381 - val_loss: 0.5509 - val_accuracy: 0.7647
Confusion matrix: 
 [[821  49]
 [207  11]]
Validation f1: 7.91
Validation accuracy: 76.47
Validation recall: 5.05
Validation precision: 18.33
Validation AUC: 0.24308621963685678
Validation class accuracies: [0.9436781609195403, 0.05045871559633028]
TARGET: 1
target metric(test f1): 0.07913669064748202
column_sums: [1028   60]
cm_sum: 1088
The training is defaulting to either class.
Epoch 17/80
263/263 - 508s - loss: 0.5442 - accuracy: 0.7371 - val_loss: 0.5200 - val_accuracy: 0.7941
Confusion matrix: 
 [[861   9]
 [215   3]]
Validation f1: 2.61
Validation accuracy: 79.41
Validation recall: 1.38
Validation precision: 25.00
Validation AUC: 0.20790710993866535
Validation class accuracies: [0.9896551724137931, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.02608695652173913
column_sums: [1076   12]
cm_sum: 1088
The training is defaulting to either class.
Epoch 18/80
263/263 - 508s - loss: 0.5381 - accuracy: 0.7393 - val_loss: 0.5232 - val_accuracy: 0.7840
Confusion matrix: 
 [[849  21]
 [214   4]]
Validation f1: 3.29
Validation accuracy: 78.40
Validation recall: 1.83
Validation precision: 16.00
Validation AUC: 0.2087801306215354
Validation class accuracies: [0.9758620689655172, 0.01834862385321101]
TARGET: 1
target metric(test f1): 0.03292181069958848
column_sums: [1063   25]
cm_sum: 1088
The training is defaulting to either class.
Epoch 19/80
263/263 - 507s - loss: 0.5283 - accuracy: 0.7474 - val_loss: 0.7039 - val_accuracy: 0.7151
Confusion matrix: 
 [[751 119]
 [191  27]]
Validation f1: 14.84
Validation accuracy: 71.51
Validation recall: 12.39
Validation precision: 18.49
Validation AUC: 0.2242550081373342
Validation class accuracies: [0.8632183908045977, 0.12385321100917432]
TARGET: 1
target metric(test f1): 0.14835164835164835
column_sums: [942 146]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 20/80
263/263 - 507s - loss: 0.5205 - accuracy: 0.7505 - val_loss: 0.5571 - val_accuracy: 0.7739
Confusion matrix: 
 [[828  42]
 [204  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.22
Validation accuracy: 77.39
Validation recall: 6.42
Validation precision: 25.00
Validation AUC: 0.20730016792144934
Validation class accuracies: [0.9517241379310345, 0.06422018348623854]
TARGET: 1
target metric(test f1): 0.10218978102189781
column_sums: [1032   56]
cm_sum: 1088
The training is defaulting to either class.
Epoch 21/80
263/263 - 506s - loss: 0.5154 - accuracy: 0.7526 - val_loss: 0.9016 - val_accuracy: 0.5386
Confusion matrix: 
 [[466 404]
 [ 98 120]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 32.35
Validation accuracy: 53.86
Validation recall: 55.05
Validation precision: 22.90
Validation AUC: 0.23959120039312726
Validation class accuracies: [0.535632183908046, 0.5504587155963303]
TARGET: 1
target metric(test f1): 0.3234501347708895
column_sums: [564 524]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 22/80
263/263 - 508s - loss: 0.4989 - accuracy: 0.7664 - val_loss: 0.5851 - val_accuracy: 0.7684
Confusion matrix: 
 [[828  42]
 [210   8]]
Validation f1: 5.97
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.84
Validation recall: 3.67
Validation precision: 16.00
Validation AUC: 0.20786972680993204
Validation class accuracies: [0.9517241379310345, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.05970149253731344
column_sums: [1038   50]
cm_sum: 1088
The training is defaulting to either class.
Epoch 23/80
263/263 - 507s - loss: 0.4887 - accuracy: 0.7705 - val_loss: 0.8217 - val_accuracy: 0.6333
Confusion matrix: 
 [[588 282]
 [117 101]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 33.61
Validation accuracy: 63.33
Validation recall: 46.33
Validation precision: 26.37
Validation AUC: 0.24256637801670466
Validation class accuracies: [0.6758620689655173, 0.463302752293578]
TARGET: 1
target metric(test f1): 0.33610648918469216
column_sums: [705 383]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 24/80
263/263 - 507s - loss: 0.4805 - accuracy: 0.7743 - val_loss: 0.6268 - val_accuracy: 0.7858
Confusion matrix: 
 [[847  23]
 [210   8]]
Validation f1: 6.43
Validation accuracy: 78.58
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 3.67
Validation precision: 25.81
Validation AUC: 0.20784960987068885
Validation class accuracies: [0.9735632183908046, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.06425702811244981
column_sums: [1057   31]
cm_sum: 1088
The training is defaulting to either class.
Epoch 25/80
263/263 - 507s - loss: 0.4599 - accuracy: 0.7877 - val_loss: 0.6589 - val_accuracy: 0.6801
Confusion matrix: 
 [[665 205]
 [143  75]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 30.12
Validation accuracy: 68.01
Validation recall: 34.40
Validation precision: 26.79
Validation AUC: 0.2487416957900253
Validation class accuracies: [0.764367816091954, 0.3440366972477064]
TARGET: 1
target metric(test f1): 0.30120481927710846
column_sums: [808 280]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 1 epochs
Epoch 26/80
263/263 - 509s - loss: 0.4419 - accuracy: 0.7989 - val_loss: 0.8171 - val_accuracy: 0.7151
Confusion matrix: 
 [[735 135]
 [175  43]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 21.72
Validation accuracy: 71.51
Validation recall: 19.72
Validation precision: 24.16
Validation AUC: 0.23421374871960426
Validation class accuracies: [0.8448275862068966, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.21717171717171718
column_sums: [910 178]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 2 epochs
Epoch 27/80
263/263 - 508s - loss: 0.4254 - accuracy: 0.8093 - val_loss: 0.6964 - val_accuracy: 0.7730
Confusion matrix: 
 [[827  43]
 [204  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.18
Validation accuracy: 77.30
Validation recall: 6.42
Validation precision: 24.56
Validation AUC: 0.2075055045763822
Validation class accuracies: [0.9505747126436782, 0.06422018348623854]
TARGET: 1
target metric(test f1): 0.10181818181818181
column_sums: [1031   57]
cm_sum: 1088
The training is defaulting to either class.
Epoch 28/80
263/263 - 509s - loss: 0.4096 - accuracy: 0.8124 - val_loss: 0.6349 - val_accuracy: 0.7059
Confusion matrix: 
 [[731 139]
 [181  37]]
Validation f1: 18.78
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 70.59
Validation recall: 16.97
Validation precision: 21.02
Validation AUC: 0.2222173801840423
Validation class accuracies: [0.8402298850574713, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.18781725888324874
column_sums: [912 176]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 3 epochs
Epoch 29/80
263/263 - 507s - loss: 0.3894 - accuracy: 0.8270 - val_loss: 0.7706 - val_accuracy: 0.6443
Confusion matrix: 
 [[640 230]
 [157  61]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.97
Validation accuracy: 64.43
Validation recall: 27.98
Validation precision: 20.96
Validation AUC: 0.21395260773642463
Validation class accuracies: [0.735632183908046, 0.2798165137614679]
TARGET: 1
target metric(test f1): 0.23968565815324164
column_sums: [797 291]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 4 epochs
Epoch 30/80
263/263 - 509s - loss: 0.3166 - accuracy: 0.8603 - val_loss: 0.8428 - val_accuracy: 0.7381
Confusion matrix: 
 [[775  95]
 [190  28]]
Validation f1: 16.42
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 73.81
Validation recall: 12.84
Validation precision: 22.76
Validation AUC: 0.2088204437218047
Validation class accuracies: [0.8908045977011494, 0.12844036697247707]
TARGET: 1
target metric(test f1): 0.16422287390029325
column_sums: [965 123]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 5 epochs
Epoch 31/80
263/263 - 508s - loss: 0.2966 - accuracy: 0.8706 - val_loss: 0.9669 - val_accuracy: 0.6967
Confusion matrix: 
 [[709 161]
 [169  49]]
Validation f1: 22.90
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 69.67
Validation recall: 22.48
Validation precision: 23.33
Validation AUC: 0.22350542849478375
Validation class accuracies: [0.8149425287356322, 0.22477064220183487]
TARGET: 1
target metric(test f1): 0.22897196261682243
column_sums: [878 210]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 6 epochs
Epoch 32/80
263/263 - 509s - loss: 0.2791 - accuracy: 0.8796 - val_loss: 0.9017 - val_accuracy: 0.6912
Confusion matrix: 
 [[700 170]
 [166  52]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.64
Validation accuracy: 69.12
Validation recall: 23.85
Validation precision: 23.42
Validation AUC: 0.22398253709639712
Validation class accuracies: [0.8045977011494253, 0.23853211009174313]
TARGET: 1
target metric(test f1): 0.23636363636363636
column_sums: [866 222]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 7 epochs
Epoch 33/80
263/263 - 509s - loss: 0.2694 - accuracy: 0.8880 - val_loss: 0.9549 - val_accuracy: 0.6976
Confusion matrix: 
 [[703 167]
 [162  56]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.40
Validation accuracy: 69.76
Validation recall: 25.69
Validation precision: 25.11
Validation AUC: 0.23199131359265387
Validation class accuracies: [0.8080459770114943, 0.25688073394495414]
TARGET: 1
target metric(test f1): 0.25396825396825395
column_sums: [865 223]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 8 epochs
Epoch 34/80
263/263 - 509s - loss: 0.2389 - accuracy: 0.9011 - val_loss: 1.0284 - val_accuracy: 0.6939
Confusion matrix: 
 [[698 172]
 [161  57]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.50
Validation accuracy: 69.39
Validation recall: 26.15
Validation precision: 24.89
Validation AUC: 0.2283080091200938
Validation class accuracies: [0.8022988505747126, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.25503355704697983
column_sums: [859 229]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 9 epochs
Epoch 35/80
263/263 - 509s - loss: 0.2407 - accuracy: 0.9037 - val_loss: 1.0763 - val_accuracy: 0.6930
Confusion matrix: 
 [[704 166]
 [168  50]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.04
Validation accuracy: 69.30
Validation recall: 22.94
Validation precision: 23.15
Validation AUC: 0.21658497542575922
Validation class accuracies: [0.8091954022988506, 0.22935779816513763]
TARGET: 1
target metric(test f1): 0.23041474654377883
column_sums: [872 216]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 10 epochs
Epoch 36/80
263/263 - 508s - loss: 0.2405 - accuracy: 0.9013 - val_loss: 1.0263 - val_accuracy: 0.6994
Confusion matrix: 
 [[712 158]
 [169  49]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.06
Validation accuracy: 69.94
Validation recall: 22.48
Validation precision: 23.67
Validation AUC: 0.21653877716737535
Validation class accuracies: [0.8183908045977012, 0.22477064220183487]
TARGET: 1
target metric(test f1): 0.23058823529411762
column_sums: [881 207]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 11 epochs
Epoch 37/80
263/263 - 508s - loss: 0.2343 - accuracy: 0.9004 - val_loss: 1.0587 - val_accuracy: 0.6967
Confusion matrix: 
 [[703 167]
 [163  55]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.00
Validation accuracy: 69.67
Validation recall: 25.23
Validation precision: 24.77
Validation AUC: 0.22324375293150678
Validation class accuracies: [0.8080459770114943, 0.25229357798165136]
TARGET: 1
target metric(test f1): 0.25
column_sums: [866 222]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 12 epochs
Epoch 38/80
263/263 - 507s - loss: 0.2234 - accuracy: 0.9111 - val_loss: 1.0842 - val_accuracy: 0.6884
Confusion matrix: 
 [[696 174]
 [165  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.82
Validation accuracy: 68.84
Validation recall: 24.31
Validation precision: 23.35
Validation AUC: 0.21885215117731893
Validation class accuracies: [0.8, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.23820224719101127
column_sums: [861 227]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 13 epochs
Epoch 39/80
263/263 - 507s - loss: 0.2295 - accuracy: 0.9102 - val_loss: 1.0699 - val_accuracy: 0.6875
Confusion matrix: 
 [[693 177]
 [163  55]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.44
Validation accuracy: 68.75
Validation recall: 25.23
Validation precision: 23.71
Validation AUC: 0.21769354701412
Validation class accuracies: [0.7965517241379311, 0.25229357798165136]
TARGET: 1
target metric(test f1): 0.24444444444444444
column_sums: [856 232]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 14 epochs
Epoch 40/80
263/263 - 507s - loss: 0.2246 - accuracy: 0.9099 - val_loss: 1.1223 - val_accuracy: 0.6857
Confusion matrix: 
 [[686 184]
 [158  60]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.97
Validation accuracy: 68.57
Validation recall: 27.52
Validation precision: 24.59
Validation AUC: 0.22328256695057574
Validation class accuracies: [0.7885057471264367, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.25974025974025977
column_sums: [844 244]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 15 epochs
Epoch 41/80
263/263 - 508s - loss: 0.2184 - accuracy: 0.9109 - val_loss: 1.1400 - val_accuracy: 0.6893
Confusion matrix: 
 [[691 179]
 [159  59]]
Validation f1: 25.88
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.93
Validation recall: 27.06
Validation precision: 24.79
Validation AUC: 0.22343846586512955
Validation class accuracies: [0.7942528735632184, 0.2706422018348624]
TARGET: 1
target metric(test f1): 0.2587719298245614
column_sums: [850 238]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 16 epochs
Epoch 42/80
263/263 - 510s - loss: 0.2221 - accuracy: 0.9102 - val_loss: 1.0924 - val_accuracy: 0.6912
Confusion matrix: 
 [[697 173]
 [163  55]]
Validation f1: 24.66
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 69.12
Validation recall: 25.23
Validation precision: 24.12
Validation AUC: 0.22019150925731784
Validation class accuracies: [0.8011494252873563, 0.25229357798165136]
TARGET: 1
target metric(test f1): 0.24663677130044842
column_sums: [860 228]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 17 epochs
Epoch 43/80
263/263 - 507s - loss: 0.2128 - accuracy: 0.9173 - val_loss: 1.1347 - val_accuracy: 0.6829
Confusion matrix: 
 [[681 189]
 [156  62]]
Validation f1: 26.44
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.29
Validation recall: 28.44
Validation precision: 24.70
Validation AUC: 0.22271316596346497
Validation class accuracies: [0.7827586206896552, 0.28440366972477066]
TARGET: 1
target metric(test f1): 0.2643923240938166
column_sums: [837 251]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 18 epochs
Epoch 44/80
263/263 - 507s - loss: 0.2202 - accuracy: 0.9118 - val_loss: 1.0877 - val_accuracy: 0.6829
Confusion matrix: 
 [[689 181]
 [164  54]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.84
Validation accuracy: 68.29
Validation recall: 24.77
Validation precision: 22.98
Validation AUC: 0.21801051394101656
Validation class accuracies: [0.7919540229885057, 0.24770642201834864]
TARGET: 1
target metric(test f1): 0.23841059602649006
column_sums: [853 235]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 19 epochs
Epoch 45/80
263/263 - 508s - loss: 0.2186 - accuracy: 0.9092 - val_loss: 1.1332 - val_accuracy: 0.6884
Confusion matrix: 
 [[689 181]
 [158  60]]
Validation f1: 26.14
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.84
Validation recall: 27.52
Validation precision: 24.90
Validation AUC: 0.22208235123261527
Validation class accuracies: [0.7919540229885057, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.26143790849673204
column_sums: [847 241]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 20 epochs
Epoch 46/80
263/263 - 510s - loss: 0.2171 - accuracy: 0.9113 - val_loss: 1.1432 - val_accuracy: 0.6884
Confusion matrix: 
 [[691 179]
 [160  58]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.49
Validation accuracy: 68.84
Validation recall: 26.61
Validation precision: 24.47
Validation AUC: 0.22300920708360955
Validation class accuracies: [0.7942528735632184, 0.26605504587155965]
TARGET: 1
target metric(test f1): 0.2549450549450549
column_sums: [851 237]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 21 epochs
Epoch 47/80
263/263 - 509s - loss: 0.2285 - accuracy: 0.9066 - val_loss: 1.1481 - val_accuracy: 0.6857
Confusion matrix: 
 [[686 184]
 [158  60]]
Validation f1: 25.97
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.57
Validation recall: 27.52
Validation precision: 24.59
Validation AUC: 0.22393588021825334
Validation class accuracies: [0.7885057471264367, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.25974025974025977
column_sums: [844 244]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 22 epochs
Epoch 48/80
263/263 - 508s - loss: 0.2210 - accuracy: 0.9104 - val_loss: 1.1072 - val_accuracy: 0.6912
Confusion matrix: 
 [[696 174]
 [162  56]]
Validation f1: 25.00
Validation accuracy: 69.12
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 25.69
Validation precision: 24.35
Validation AUC: 0.21919127918013218
Validation class accuracies: [0.8, 0.25688073394495414]
TARGET: 1
target metric(test f1): 0.25
column_sums: [858 230]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 23 epochs
Epoch 49/80
263/263 - 507s - loss: 0.2112 - accuracy: 0.9135 - val_loss: 1.1497 - val_accuracy: 0.6866
Confusion matrix: 
 [[686 184]
 [157  61]]
Validation f1: 26.35
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.66
Validation recall: 27.98
Validation precision: 24.90
Validation AUC: 0.22309319927169344
Validation class accuracies: [0.7885057471264367, 0.2798165137614679]
TARGET: 1
target metric(test f1): 0.2634989200863931
column_sums: [843 245]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.33610648918469216 hasn't increased by 0 in 24 epochs
Epoch 50/80
263/263 - 507s - loss: 0.2203 - accuracy: 0.9130 - val_loss: 1.1273 - val_accuracy: 0.6820
Confusion matrix: 
 [[683 187]
 [159  59]]
Validation f1: 25.43
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.20
Validation recall: 27.06
Validation precision: 23.98
Validation AUC: 0.22091894909306897
Validation class accuracies: [0.7850574712643679, 0.2706422018348624]

The metrics for the epoch with the best target metric are: 
Best cm: [[588 282]
 [117 101]]
Best f1: 0.33610648918469216
Best accuracy: 0.6332720588235294
Best recall: 0.463302752293578
Best precision: 0.26370757180156656
Best AUC: 0.24256637801670466
Best epoch: 23
TARGET: 1
target metric(test f1): 0.2543103448275862
column_sums: [842 246]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 19
Starting...
CM: [[32 28]
 [ 7  8]]
F1: 0.3137254901960784
AUC: 0.42444444444444446
Accuracy: 0.5333333333333333
Precision: 0.2222222222222222
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2141__05_1641__v29__mod9_nocw/validation_sheet_19.xls...
Done.
Epoch: 21
Starting...
CM: [[ 2 58]
 [ 1 14]]
F1: 0.32183908045977017
AUC: 0.5705555555555555
Accuracy: 0.21333333333333335
Precision: 0.19444444444444445
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2141__05_1641__v29__mod9_nocw/validation_sheet_21.xls...
Done.
Epoch: 23
Starting...
CM: [[ 7 53]
 [ 0 15]]
F1: 0.36144578313253006
AUC: 0.6102941176470589
Accuracy: 0.29333333333333333
Precision: 0.22058823529411764
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2141__05_1641__v29__mod9_nocw/validation_sheet_23.xls...
Done.
Epoch: 80
Starting...
CM: [[11 49]
 [ 5 10]]
F1: 0.27027027027027023
AUC: 0.45141242937853104
Accuracy: 0.28
Precision: 0.1694915254237288
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2141__05_1641__v29__mod9_nocw/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 8862
wandb: Program ended successfully.
wandb: - 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: \ 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: | 0.07MB of 0.08MB uploaded (0.00MB deduped)wandb: / 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: - 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: \ 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: | 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: / 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210515_164520-3cdrhdi8/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210515_164520-3cdrhdi8/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.91301
wandb:         val_accuracy 0.68199
wandb:             _runtime 26986
wandb:           _timestamp 1621124106
wandb:                _step 361
wandb:           train_loss 0.22031
wandb:             val_loss 1.12728
wandb:           val_recall 0.27064
wandb:        val_precision 0.23984
wandb:               val_f1 0.25431
wandb:              val_auc 0.22092
wandb:                   lr 0.0
wandb:          best_val_f1 0.33611
wandb:    best_val_accuracy 0.63327
wandb:   best_val_precision 0.26371
wandb:      best_val_recall 0.4633
wandb:             best_auc 0.24257
wandb:           best_epoch 23
wandb:           best_bd_f1 0.36145
wandb:          best_bd_auc 0.61029
wandb:     best_bd_accuracy 0.29333
wandb:    best_bd_precision 0.22059
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 23
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▃▃▃▄▄▅▅▆▇▇▇▇▇██████████
wandb:     val_accuracy ███████▇███▇▇██▆▁▇▄█▆▇▅▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▇▇▇▇▇▇▇▇▆▆▆▆▆▆▆▅▅▅▄▄▄▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▂▂▁▁▁▂▁▁▂▂▂▁▁▃▅▂▄▂▄▃▂▄▆▅▆▇▇▇▇▇█▇█▇████
wandb:       val_recall ▁▁▁▁▂▁▁▁▁▁▁▁▂▁▁▃█▁▇▁▄▂▃▅▄▄▄▄▄▄▄▄▄▄▅▄▄▅▄▄
wandb:    val_precision ▁▁▁▁█▆▁▅▅▅▇▅▅▆▄▅▆▄▇▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_f1 ▁▁▁▁▃▁▁▂▂▁▂▂▃▂▂▄█▂█▂▆▃▅▆▆▆▆▆▆▆▆▆▆▆▇▆▆▆▆▆
wandb:          val_auc █▁▁▂▇▇▅▅▆▅▄▅▇▅▅▆▇▅▇▅▇▅▆▅▆▆▆▆▅▆▅▅▆▆▆▅▆▆▅▆
wandb:               lr ████████████████████████▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 12 media file(s), 9 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2141: https://wandb.ai/arachid1/tensorboard-integration/runs/3cdrhdi8


 See logs at ../../new_cache/conv__2141__05_1641__v29__mod9_nocw/logs/