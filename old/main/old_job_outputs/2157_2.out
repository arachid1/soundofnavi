Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2157
Description:  attempt_augm
2021-05-25 17:59:47.396310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:18: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-05-25 17:59:53.219495: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-25 17:59:53.222349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-25 17:59:53.289017: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 17:59:53.289725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-25 17:59:53.289756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-25 17:59:53.326319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-25 17:59:53.326426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-25 17:59:53.340944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-25 17:59:53.349654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-25 17:59:53.358194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-25 17:59:53.367308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-25 17:59:53.381420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-25 17:59:53.381587: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 17:59:53.382368: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 17:59:53.384074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
yoo: True
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2157.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2157__05_1758__v29__attempt_augm/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2157
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2kd18qoq
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210525_175953-2kd18qoq
wandb: Run `wandb offline` to turn off syncing.
2021-05-25 18:02:43.787481: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-25 18:02:43.787928: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 18:02:43.788761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-25 18:02:43.788830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-25 18:02:43.788926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-25 18:02:43.788965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-25 18:02:43.789000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-25 18:02:43.789036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-25 18:02:43.789075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-25 18:02:43.789110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-25 18:02:43.789140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-25 18:02:43.789269: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 18:02:43.790101: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 18:02:43.790827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-25 18:02:43.792042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-25 18:02:45.189537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-25 18:02:45.189582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-25 18:02:45.189600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-25 18:02:45.191644: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 18:02:45.192508: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 18:02:45.193290: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 18:02:45.194017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-25 18:02:46.433072: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-05-25 18:02:46.438160: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-25 18:02:46.989555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-25 18:02:51.046583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-25 18:02:52.200454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11

Original number of folders: 453
The parameters for augmentation N: 0 were: [0.1, 0, 1, 0, 0.75, (0, 1)]
Length of augmented samples is: 419 
With concat = False and six = False, size of training set: 4615...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/80
289/289 - 421s - loss: 0.6671 - accuracy: 0.6520 - val_loss: 0.5018 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16257078217999732
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
289/289 - 416s - loss: 0.5922 - accuracy: 0.7155 - val_loss: 0.5020 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21987416473917643
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
289/289 - 416s - loss: 0.5719 - accuracy: 0.7233 - val_loss: 0.5752 - val_accuracy: 0.7730
Confusion matrix: 
 [[823  47]
 [200  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.72
Validation accuracy: 77.30
Validation recall: 8.26
Validation precision: 27.69
Validation AUC: 0.23696460055678353
Validation class accuracies: [0.9459770114942528, 0.08256880733944955]
TARGET: 1
target metric(test f1): 0.127208480565371
column_sums: [1023   65]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
289/289 - 416s - loss: 0.5692 - accuracy: 0.7250 - val_loss: 0.5747 - val_accuracy: 0.7656
Confusion matrix: 
 [[810  60]
 [195  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 15.28
Validation accuracy: 76.56
Validation recall: 10.55
Validation precision: 27.71
Validation AUC: 0.2114147676114354
Validation class accuracies: [0.9310344827586207, 0.10550458715596331]
TARGET: 1
target metric(test f1): 0.15282392026578073
column_sums: [1005   83]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
289/289 - 416s - loss: 0.5625 - accuracy: 0.7239 - val_loss: 0.5931 - val_accuracy: 0.7169
Confusion matrix: 
 [[745 125]
 [183  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 18.52
Validation accuracy: 71.69
Validation recall: 16.06
Validation precision: 21.88
Validation AUC: 0.24177088275062097
Validation class accuracies: [0.8563218390804598, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.18518518518518517
column_sums: [928 160]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 6/80
289/289 - 416s - loss: 0.5479 - accuracy: 0.7372 - val_loss: 0.5861 - val_accuracy: 0.7132
Confusion matrix: 
 [[764 106]
 [206  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 7.14
Validation accuracy: 71.32
Validation recall: 5.50
Validation precision: 10.17
Validation AUC: 0.20099776380400214
Validation class accuracies: [0.8781609195402299, 0.05504587155963303]
TARGET: 1
target metric(test f1): 0.07142857142857144
column_sums: [970 118]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.18518518518518517 hasn't increased by 0 in 1 epochs
Epoch 7/80
289/289 - 416s - loss: 0.5332 - accuracy: 0.7458 - val_loss: 0.5662 - val_accuracy: 0.7950
Confusion matrix: 
 [[864   6]
 [217   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 0.89
Validation accuracy: 79.50
Validation recall: 0.46
Validation precision: 14.29
Validation AUC: 0.19276505432191487
Validation class accuracies: [0.993103448275862, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.008888888888888889
column_sums: [1081    7]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
289/289 - 416s - loss: 0.5139 - accuracy: 0.7532 - val_loss: 0.8237 - val_accuracy: 0.6572
Confusion matrix: 
 [[651 219]
 [154  64]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.55
Validation accuracy: 65.72
Validation recall: 29.36
Validation precision: 22.61
Validation AUC: 0.2319708020659862
Validation class accuracies: [0.7482758620689656, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.2554890219560878
column_sums: [805 283]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 9/80
289/289 - 416s - loss: 0.4996 - accuracy: 0.7590 - val_loss: 0.6006 - val_accuracy: 0.7252
Confusion matrix: 
 [[759 111]
 [188  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 16.71
Validation accuracy: 72.52
Validation recall: 13.76
Validation precision: 21.28
Validation AUC: 0.2091534758422571
Validation class accuracies: [0.8724137931034482, 0.13761467889908258]
TARGET: 1
target metric(test f1): 0.1671309192200557
column_sums: [947 141]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2554890219560878 hasn't increased by 0 in 1 epochs
Epoch 10/80
289/289 - 416s - loss: 0.4600 - accuracy: 0.7876 - val_loss: 0.8225 - val_accuracy: 0.6930
Confusion matrix: 
 [[710 160]
 [174  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.85
Validation accuracy: 69.30
Validation recall: 20.18
Validation precision: 21.57
Validation AUC: 0.22323294507047972
Validation class accuracies: [0.8160919540229885, 0.2018348623853211]
TARGET: 1
target metric(test f1): 0.2085308056872038
column_sums: [884 204]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2554890219560878 hasn't increased by 0 in 2 epochs
Epoch 11/80
289/289 - 416s - loss: 0.4221 - accuracy: 0.8093 - val_loss: 0.6393 - val_accuracy: 0.7426
Confusion matrix: 
 [[779  91]
 [189  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.16
Validation accuracy: 74.26
Validation recall: 13.30
Validation precision: 24.17
Validation AUC: 0.21535554627504666
Validation class accuracies: [0.8954022988505748, 0.13302752293577982]
TARGET: 1
target metric(test f1): 0.17159763313609466
column_sums: [968 120]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2554890219560878 hasn't increased by 0 in 3 epochs
Epoch 12/80
289/289 - 416s - loss: 0.4007 - accuracy: 0.8193 - val_loss: 0.8279 - val_accuracy: 0.6379
Confusion matrix: 
 [[627 243]
 [151  67]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.38
Validation accuracy: 63.79
Validation recall: 30.73
Validation precision: 21.61
Validation AUC: 0.20995668493222158
Validation class accuracies: [0.7206896551724138, 0.3073394495412844]
TARGET: 1
target metric(test f1): 0.2537878787878788
column_sums: [778 310]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.2554890219560878 hasn't increased by 0 in 4 epochs
Epoch 13/80
289/289 - 416s - loss: 0.3067 - accuracy: 0.8745 - val_loss: 0.7845 - val_accuracy: 0.6939
Confusion matrix: 
 [[723 147]
 [186  32]]
Validation f1: 16.12
Validation accuracy: 69.39
Validation recall: 14.68
Validation precision: 17.88
Validation AUC: 0.191464119998266
Validation class accuracies: [0.8310344827586207, 0.14678899082568808]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
TARGET: 1
target metric(test f1): 0.16120906801007556
column_sums: [909 179]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2554890219560878 hasn't increased by 0 in 5 epochs
Epoch 14/80
289/289 - 416s - loss: 0.2770 - accuracy: 0.8884 - val_loss: 1.2268 - val_accuracy: 0.4917
Confusion matrix: 
 [[438 432]
 [121  97]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.97
Validation accuracy: 49.17
Validation recall: 44.50
Validation precision: 18.34
Validation AUC: 0.19088629836959153
Validation class accuracies: [0.503448275862069, 0.44495412844036697]
TARGET: 1
target metric(test f1): 0.2597054886211513
column_sums: [559 529]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 15/80
289/289 - 416s - loss: 0.2587 - accuracy: 0.8934 - val_loss: 1.0313 - val_accuracy: 0.5487
Confusion matrix: 
 [[507 363]
 [128  90]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.83
Validation accuracy: 54.87
Validation recall: 41.28
Validation precision: 19.87
Validation AUC: 0.19852934487243556
Validation class accuracies: [0.5827586206896552, 0.41284403669724773]
TARGET: 1
target metric(test f1): 0.26825633383010433
column_sums: [635 453]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 16/80
289/289 - 416s - loss: 0.2522 - accuracy: 0.8990 - val_loss: 1.0049 - val_accuracy: 0.6131
Confusion matrix: 
 [[604 266]
 [155  63]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.03
Validation accuracy: 61.31
Validation recall: 28.90
Validation precision: 19.15
Validation AUC: 0.19342226937122411
Validation class accuracies: [0.6942528735632184, 0.2889908256880734]
TARGET: 1
target metric(test f1): 0.2303473491773309
column_sums: [759 329]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.26825633383010433 hasn't increased by 0 in 1 epochs
Epoch 17/80
289/289 - 416s - loss: 0.2339 - accuracy: 0.9112 - val_loss: 0.8687 - val_accuracy: 0.6847
Confusion matrix: 
 [[706 164]
 [179  39]]
Validation f1: 18.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 68.47
Validation recall: 17.89
Validation precision: 19.21
Validation AUC: 0.19093351913812517
Validation class accuracies: [0.8114942528735632, 0.17889908256880735]
TARGET: 1
target metric(test f1): 0.1852731591448931
column_sums: [885 203]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.26825633383010433 hasn't increased by 0 in 2 epochs
Epoch 18/80
289/289 - 416s - loss: 0.2216 - accuracy: 0.9099 - val_loss: 0.8540 - val_accuracy: 0.7215
Confusion matrix: 
 [[755 115]
 [188  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 16.53
Validation accuracy: 72.15
Validation recall: 13.76
Validation precision: 20.69
Validation AUC: 0.2005268100811304
Validation class accuracies: [0.867816091954023, 0.13761467889908258]
TARGET: 1
target metric(test f1): 0.16528925619834708
column_sums: [943 145]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.26825633383010433 hasn't increased by 0 in 3 epochs
Epoch 19/80
289/289 - 416s - loss: 0.2118 - accuracy: 0.9142 - val_loss: 0.9089 - val_accuracy: 0.6811
Confusion matrix: 
 [[693 177]
 [170  48]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.67
Validation accuracy: 68.11
Validation recall: 22.02
Validation precision: 21.33
Validation AUC: 0.19907268069762957
Validation class accuracies: [0.7965517241379311, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.21670428893905191
column_sums: [863 225]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.26825633383010433 hasn't increased by 0 in 4 epochs
Epoch 20/80
289/289 - 416s - loss: 0.1979 - accuracy: 0.9265 - val_loss: 0.9404 - val_accuracy: 0.6765
Confusion matrix: 
 [[691 179]
 [173  45]]
Validation f1: 20.36
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 67.65
Validation recall: 20.64
Validation precision: 20.09
Validation AUC: 0.19511661363591487
Validation class accuracies: [0.7942528735632184, 0.20642201834862386]
TARGET: 1
target metric(test f1): 0.20361990950226244
column_sums: [864 224]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.26825633383010433 hasn't increased by 0 in 5 epochs
Epoch 21/80
289/289 - 416s - loss: 0.1986 - accuracy: 0.9231 - val_loss: 0.9750 - val_accuracy: 0.6562
Confusion matrix: 
 [[654 216]
 [158  60]]
Validation f1: 24.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 65.62
Validation recall: 27.52
Validation precision: 21.74
Validation AUC: 0.19970761134849102
Validation class accuracies: [0.7517241379310344, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.24291497975708504
column_sums: [812 276]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.26825633383010433 hasn't increased by 0 in 6 epochs
Epoch 22/80
289/289 - 416s - loss: 0.1895 - accuracy: 0.9322 - val_loss: 1.0722 - val_accuracy: 0.6039
Confusion matrix: 
 [[575 295]
 [136  82]]
Validation f1: 27.56
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 60.39
Validation recall: 37.61
Validation precision: 21.75
Validation AUC: 0.19861296532018424
Validation class accuracies: [0.6609195402298851, 0.3761467889908257]
TARGET: 1
target metric(test f1): 0.2756302521008403
column_sums: [711 377]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 23/80
289/289 - 416s - loss: 0.2019 - accuracy: 0.9235 - val_loss: 0.9675 - val_accuracy: 0.6535
Confusion matrix: 
 [[662 208]
 [169  49]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.63
Validation accuracy: 65.35
Validation recall: 22.48
Validation precision: 19.07
Validation AUC: 0.19096327281113273
Validation class accuracies: [0.7609195402298851, 0.22477064220183487]
TARGET: 1
target metric(test f1): 0.20631578947368423
column_sums: [831 257]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 1 epochs
Epoch 24/80
289/289 - 416s - loss: 0.1838 - accuracy: 0.9311 - val_loss: 1.0415 - val_accuracy: 0.6195
Confusion matrix: 
 [[609 261]
 [153  65]]
Validation f1: 23.90
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 61.95
Validation recall: 29.82
Validation precision: 19.94
Validation AUC: 0.19789215743659233
Validation class accuracies: [0.7, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.2389705882352941
column_sums: [762 326]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 2 epochs
Epoch 25/80
289/289 - 416s - loss: 0.1863 - accuracy: 0.9320 - val_loss: 1.0200 - val_accuracy: 0.6369
Confusion matrix: 
 [[629 241]
 [154  64]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.47
Validation accuracy: 63.69
Validation recall: 29.36
Validation precision: 20.98
Validation AUC: 0.20036452722013506
Validation class accuracies: [0.7229885057471265, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.2447418738049713
column_sums: [783 305]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 3 epochs
Epoch 26/80
289/289 - 416s - loss: 0.1940 - accuracy: 0.9263 - val_loss: 0.9890 - val_accuracy: 0.6572
Confusion matrix: 
 [[660 210]
 [163  55]]
Validation f1: 22.77
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 65.72
Validation recall: 25.23
Validation precision: 20.75
Validation AUC: 0.199851159760371
Validation class accuracies: [0.7586206896551724, 0.25229357798165136]
TARGET: 1
target metric(test f1): 0.2277432712215321
column_sums: [823 265]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 4 epochs
Epoch 27/80
289/289 - 416s - loss: 0.1802 - accuracy: 0.9385 - val_loss: 1.0217 - val_accuracy: 0.6278
Confusion matrix: 
 [[621 249]
 [156  62]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.44
Validation accuracy: 62.78
Validation recall: 28.44
Validation precision: 19.94
Validation AUC: 0.19788242742553935
Validation class accuracies: [0.7137931034482758, 0.28440366972477066]
TARGET: 1
target metric(test f1): 0.2344045368620038
column_sums: [777 311]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 5 epochs
Epoch 28/80
289/289 - 416s - loss: 0.1839 - accuracy: 0.9324 - val_loss: 1.0251 - val_accuracy: 0.6121
Confusion matrix: 
 [[599 271]
 [151  67]]
Validation f1: 24.10
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 61.21
Validation recall: 30.73
Validation precision: 19.82
Validation AUC: 0.19656501510951768
Validation class accuracies: [0.6885057471264368, 0.3073394495412844]
TARGET: 1
target metric(test f1): 0.2410071942446043
column_sums: [750 338]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 6 epochs
Epoch 29/80
289/289 - 416s - loss: 0.1789 - accuracy: 0.9361 - val_loss: 1.0082 - val_accuracy: 0.6287
Confusion matrix: 
 [[621 249]
 [155  63]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.77
Validation accuracy: 62.87
Validation recall: 28.90
Validation precision: 20.19
Validation AUC: 0.1969300090205363
Validation class accuracies: [0.7137931034482758, 0.2889908256880734]
TARGET: 1
target metric(test f1): 0.23773584905660378
column_sums: [776 312]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 7 epochs
Epoch 30/80
289/289 - 416s - loss: 0.1820 - accuracy: 0.9328 - val_loss: 1.0011 - val_accuracy: 0.6388
Confusion matrix: 
 [[634 236]
 [157  61]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.69
Validation accuracy: 63.88
Validation recall: 27.98
Validation precision: 20.54
Validation AUC: 0.1972409668865813
Validation class accuracies: [0.728735632183908, 0.2798165137614679]
TARGET: 1
target metric(test f1): 0.23689320388349513
column_sums: [791 297]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906249901319825e-07
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 8 epochs
Epoch 31/80
289/289 - 416s - loss: 0.1784 - accuracy: 0.9307 - val_loss: 1.0217 - val_accuracy: 0.6259
Confusion matrix: 
 [[615 255]
 [152  66]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.49
Validation accuracy: 62.59
Validation recall: 30.28
Validation precision: 20.56
Validation AUC: 0.1975135535688235
Validation class accuracies: [0.7068965517241379, 0.30275229357798167]
TARGET: 1
target metric(test f1): 0.2448979591836735
column_sums: [767 321]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 9 epochs
Epoch 32/80
289/289 - 416s - loss: 0.1918 - accuracy: 0.9283 - val_loss: 1.0046 - val_accuracy: 0.6342
Confusion matrix: 
 [[631 239]
 [159  59]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.87
Validation accuracy: 63.42
Validation recall: 27.06
Validation precision: 19.80
Validation AUC: 0.19765675326732368
Validation class accuracies: [0.725287356321839, 0.2706422018348624]
TARGET: 1
target metric(test f1): 0.22868217054263562
column_sums: [790 298]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 10 epochs
Epoch 33/80
289/289 - 416s - loss: 0.1785 - accuracy: 0.9350 - val_loss: 0.9799 - val_accuracy: 0.6627
Confusion matrix: 
 [[671 199]
 [168  50]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.41
Validation accuracy: 66.27
Validation recall: 22.94
Validation precision: 20.08
Validation AUC: 0.19722857659266402
Validation class accuracies: [0.771264367816092, 0.22935779816513763]
TARGET: 1
target metric(test f1): 0.21413276231263384
column_sums: [839 249]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 11 epochs
Epoch 34/80
289/289 - 416s - loss: 0.1844 - accuracy: 0.9296 - val_loss: 1.0032 - val_accuracy: 0.6406
Confusion matrix: 
 [[634 236]
 [155  63]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.37
Validation accuracy: 64.06
Validation recall: 28.90
Validation precision: 21.07
Validation AUC: 0.19724052136037803
Validation class accuracies: [0.728735632183908, 0.2889908256880734]
TARGET: 1
target metric(test f1): 0.24371373307543517
column_sums: [789 299]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765624753299562e-08
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 12 epochs
Epoch 35/80
289/289 - 416s - loss: 0.1842 - accuracy: 0.9326 - val_loss: 0.9781 - val_accuracy: 0.6562
Confusion matrix: 
 [[662 208]
 [166  52]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.76
Validation accuracy: 65.62
Validation recall: 23.85
Validation precision: 20.00
Validation AUC: 0.19715593171485532
Validation class accuracies: [0.7609195402298851, 0.23853211009174313]
TARGET: 1
target metric(test f1): 0.2175732217573222
column_sums: [828 260]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 13 epochs
Epoch 36/80
289/289 - 416s - loss: 0.1839 - accuracy: 0.9294 - val_loss: 0.9622 - val_accuracy: 0.6636
Confusion matrix: 
 [[673 197]
 [169  49]]
Validation f1: 21.12
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 66.36
Validation recall: 22.48
Validation precision: 19.92
Validation AUC: 0.1974150634254782
Validation class accuracies: [0.7735632183908046, 0.22477064220183487]
TARGET: 1
target metric(test f1): 0.21120689655172417
column_sums: [842 246]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 14 epochs
Epoch 37/80
289/289 - 416s - loss: 0.1805 - accuracy: 0.9361 - val_loss: 1.0070 - val_accuracy: 0.6351
Confusion matrix: 
 [[629 241]
 [156  62]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.80
Validation accuracy: 63.51
Validation recall: 28.44
Validation precision: 20.46
Validation AUC: 0.1968731761434882
Validation class accuracies: [0.7229885057471265, 0.28440366972477066]
TARGET: 1
target metric(test f1): 0.2380038387715931
column_sums: [785 303]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 15 epochs
Epoch 38/80
289/289 - 416s - loss: 0.1854 - accuracy: 0.9313 - val_loss: 0.9775 - val_accuracy: 0.6535
Confusion matrix: 
 [[658 212]
 [165  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.95
Validation accuracy: 65.35
Validation recall: 24.31
Validation precision: 20.00
Validation AUC: 0.19816497404769517
Validation class accuracies: [0.7563218390804598, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.21946169772256727
column_sums: [823 265]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414061883248905e-08
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 16 epochs
Epoch 39/80
289/289 - 416s - loss: 0.1778 - accuracy: 0.9361 - val_loss: 0.9890 - val_accuracy: 0.6415
Confusion matrix: 
 [[641 229]
 [161  57]]
Validation f1: 22.62
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 64.15
Validation recall: 26.15
Validation precision: 19.93
Validation AUC: 0.19775074690042183
Validation class accuracies: [0.7367816091954023, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.2261904761904762
column_sums: [802 286]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 17 epochs
Epoch 40/80
289/289 - 415s - loss: 0.1819 - accuracy: 0.9317 - val_loss: 0.9843 - val_accuracy: 0.6425
Confusion matrix: 
 [[645 225]
 [164  54]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.73
Validation accuracy: 64.25
Validation recall: 24.77
Validation precision: 19.35
Validation AUC: 0.1975347171300935
Validation class accuracies: [0.7413793103448276, 0.24770642201834864]
TARGET: 1
target metric(test f1): 0.21730382293762576
column_sums: [809 279]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 18 epochs
Epoch 41/80
289/289 - 416s - loss: 0.1811 - accuracy: 0.9372 - val_loss: 1.0051 - val_accuracy: 0.6369
Confusion matrix: 
 [[630 240]
 [155  63]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.18
Validation accuracy: 63.69
Validation recall: 28.90
Validation precision: 20.79
Validation AUC: 0.19756792960719438
Validation class accuracies: [0.7241379310344828, 0.2889908256880734]
TARGET: 1
target metric(test f1): 0.24184261036468327
column_sums: [785 303]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 19 epochs
Epoch 42/80
289/289 - 416s - loss: 0.1881 - accuracy: 0.9291 - val_loss: 0.9862 - val_accuracy: 0.6526
Confusion matrix: 
 [[656 214]
 [164  54]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.22
Validation accuracy: 65.26
Validation recall: 24.77
Validation precision: 20.15
Validation AUC: 0.1974158425322042
Validation class accuracies: [0.7540229885057471, 0.24770642201834864]
TARGET: 1
target metric(test f1): 0.22222222222222224
column_sums: [820 268]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.103515470812226e-09
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 20 epochs
Epoch 43/80
289/289 - 416s - loss: 0.1829 - accuracy: 0.9330 - val_loss: 0.9628 - val_accuracy: 0.6654
Confusion matrix: 
 [[675 195]
 [169  49]]
Validation f1: 21.21
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 66.54
Validation recall: 22.48
Validation precision: 20.08
Validation AUC: 0.19784856908976478
Validation class accuracies: [0.7758620689655172, 0.22477064220183487]
TARGET: 1
target metric(test f1): 0.2121212121212121
column_sums: [844 244]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 21 epochs
Epoch 44/80
289/289 - 415s - loss: 0.1771 - accuracy: 0.9372 - val_loss: 0.9766 - val_accuracy: 0.6544
Confusion matrix: 
 [[659 211]
 [165  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.99
Validation accuracy: 65.44
Validation recall: 24.31
Validation precision: 20.08
Validation AUC: 0.1977784108178377
Validation class accuracies: [0.7574712643678161, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.21991701244813275
column_sums: [824 264]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 22 epochs
Epoch 45/80
289/289 - 415s - loss: 0.1790 - accuracy: 0.9341 - val_loss: 1.0025 - val_accuracy: 0.6388
Confusion matrix: 
 [[635 235]
 [158  60]]
Validation f1: 23.39
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 63.88
Validation recall: 27.52
Validation precision: 20.34
Validation AUC: 0.1979669566505649
Validation class accuracies: [0.7298850574712644, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.23391812865497078
column_sums: [793 295]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 23 epochs
Epoch 46/80
289/289 - 416s - loss: 0.1817 - accuracy: 0.9350 - val_loss: 0.9907 - val_accuracy: 0.6480
Confusion matrix: 
 [[651 219]
 [164  54]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.00
Validation accuracy: 64.80
Validation recall: 24.77
Validation precision: 19.78
Validation AUC: 0.19758760163194256
Validation class accuracies: [0.7482758620689656, 0.24770642201834864]
TARGET: 1
target metric(test f1): 0.219959266802444
column_sums: [815 273]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5258788677030566e-09
The validation tracker metric at 0.2756302521008403 hasn't increased by 0 in 24 epochs
Epoch 47/80
289/289 - 415s - loss: 0.1828 - accuracy: 0.9343 - val_loss: 0.9858 - val_accuracy: 0.6480
Confusion matrix: 
 [[649 221]
 [162  56]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.63
Validation accuracy: 64.80
Validation recall: 25.69
Validation precision: 20.22
Validation AUC: 0.1983543259812984
Validation class accuracies: [0.7459770114942529, 0.25688073394495414]

The metrics for the epoch with the best target metric are: 
Best cm: [[575 295]
 [136  82]]
Best f1: 0.2756302521008403
Best accuracy: 0.6038602941176471
Best recall: 0.3761467889908257
Best precision: 0.21750663129973474
Best AUC: 0.19861296532018424
Best epoch: 22
TARGET: 1
target metric(test f1): 0.22626262626262625
column_sums: [811 277]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: epoch14 & threshold: 1
Starting...
CM: [[ 1 59]
 [ 1 14]]
F1: 0.3181818181818181
AUC: 0.5692237442922373
Accuracy: 0.2
Precision: 0.1917808219178082
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch14.xls...
Done.
Epoch: epoch14 & threshold: 2
Starting...
CM: [[ 6 54]
 [ 3 12]]
F1: 0.2962962962962963
AUC: 0.510909090909091
Accuracy: 0.24
Precision: 0.18181818181818182
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch14.xls...
Done.
Epoch: epoch14 & threshold: 3
Starting...
CM: [[24 36]
 [ 8  7]]
F1: 0.24137931034482765
AUC: 0.368062015503876
Accuracy: 0.41333333333333333
Precision: 0.16279069767441862
Recall: 0.4666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch14.xls...
Done.
Epoch: epoch15 & threshold: 1
Starting...
CM: [[ 4 56]
 [ 2 13]]
F1: 0.30952380952380953
AUC: 0.5408695652173913
Accuracy: 0.22666666666666666
Precision: 0.18840579710144928
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch15.xls...
Done.
Epoch: epoch15 & threshold: 2
Starting...
CM: [[12 48]
 [ 3 12]]
F1: 0.32000000000000006
AUC: 0.52
Accuracy: 0.32
Precision: 0.2
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch15.xls...
Done.
Epoch: epoch15 & threshold: 3
Starting...
CM: [[28 32]
 [ 9  6]]
F1: 0.22641509433962267
AUC: 0.33894736842105266
Accuracy: 0.4533333333333333
Precision: 0.15789473684210525
Recall: 0.4
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch15.xls...
Done.
Epoch: epoch22 & threshold: 1
Starting...
CM: [[ 7 53]
 [ 3 12]]
F1: 0.3
AUC: 0.5123076923076924
Accuracy: 0.25333333333333335
Precision: 0.18461538461538463
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch22.xls...
Done.
Epoch: epoch22 & threshold: 2
Starting...
CM: [[21 39]
 [ 4 11]]
F1: 0.3384615384615385
AUC: 0.5033333333333333
Accuracy: 0.4266666666666667
Precision: 0.22
Recall: 0.7333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch22.xls...
Done.
Epoch: epoch22 & threshold: 3
Starting...
CM: [[41 19]
 [10  5]]
F1: 0.25641025641025644
AUC: 0.3375
Accuracy: 0.6133333333333333
Precision: 0.20833333333333334
Recall: 0.3333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch22.xls...
Done.
Epoch: epoch5 & threshold: 1
Starting...
CM: [[32 28]
 [ 5 10]]
F1: 0.3773584905660377
AUC: 0.4982456140350877
Accuracy: 0.56
Precision: 0.2631578947368421
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch5.xls...
Done.
Epoch: epoch5 & threshold: 2
Starting...
CM: [[45 15]
 [10  5]]
F1: 0.28571428571428575
AUC: 0.35833333333333334
Accuracy: 0.6666666666666666
Precision: 0.25
Recall: 0.3333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch5.xls...
Done.
Epoch: epoch5 & threshold: 3
Starting...
CM: [[51  9]
 [15  0]]
F1: 0.0
AUC: 0.1
Accuracy: 0.68
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch5.xls...
Done.
Epoch: epoch8 & threshold: 1
Starting...
CM: [[17 43]
 [ 2 13]]
F1: 0.3661971830985915
AUC: 0.5627380952380953
Accuracy: 0.4
Precision: 0.23214285714285715
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch8.xls...
Done.
Epoch: epoch8 & threshold: 2
Starting...
CM: [[35 25]
 [ 6  9]]
F1: 0.36734693877551017
AUC: 0.4723529411764706
Accuracy: 0.5866666666666667
Precision: 0.2647058823529412
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch8.xls...
Done.
Epoch: epoch8 & threshold: 3
Starting...
CM: [[44 16]
 [ 9  6]]
F1: 0.3243243243243243
AUC: 0.39636363636363636
Accuracy: 0.6666666666666666
Precision: 0.2727272727272727
Recall: 0.4
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch8.xls...
Done.
Epoch: epoch80 & threshold: 1
Starting...
CM: [[13 47]
 [ 3 12]]
F1: 0.3243243243243243
AUC: 0.5216949152542373
Accuracy: 0.3333333333333333
Precision: 0.2033898305084746
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch80.xls...
Done.
Epoch: epoch80 & threshold: 2
Starting...
CM: [[33 27]
 [ 8  7]]
F1: 0.28571428571428564
AUC: 0.3896078431372549
Accuracy: 0.5333333333333333
Precision: 0.20588235294117646
Recall: 0.4666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch80.xls...
Done.
Epoch: epoch80 & threshold: 3
Starting...
CM: [[50 10]
 [13  2]]
F1: 0.14814814814814814
AUC: 0.2366666666666667
Accuracy: 0.6933333333333334
Precision: 0.16666666666666666
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/0/validation_sheet_epochepoch80.xls...
Done.
The parameters for augmentation N: 1 were: [0.1, 0, 0, 1, 0.75, (0, 1)]
Length of augmented samples is: 416 
With concat = False and six = False, size of training set: 4585...
...and size of validation set: 1115
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_20 (InputLayer)           [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization_114 (BatchN (None, 128, 1250, 3) 12          input_20[0][0]                   
__________________________________________________________________________________________________
conv2d_95 (Conv2D)              (None, 128, 1250, 16 64          batch_normalization_114[0][0]    
__________________________________________________________________________________________________
conv2d_97 (Conv2D)              (None, 128, 1250, 16 64          batch_normalization_114[0][0]    
__________________________________________________________________________________________________
max_pooling2d_19 (MaxPooling2D) (None, 128, 1250, 3) 0           batch_normalization_114[0][0]    
__________________________________________________________________________________________________
conv2d_96 (Conv2D)              (None, 128, 1250, 16 2320        conv2d_95[0][0]                  
__________________________________________________________________________________________________
conv2d_98 (Conv2D)              (None, 128, 1250, 16 6416        conv2d_97[0][0]                  
__________________________________________________________________________________________________
conv2d_99 (Conv2D)              (None, 128, 1250, 16 64          max_pooling2d_19[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 128, 1250, 48 0           conv2d_96[0][0]                  
                                                                 conv2d_98[0][0]                  
                                                                 conv2d_99[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_95 (AveragePo (None, 64, 625, 48)  0           concatenate_19[0][0]             
__________________________________________________________________________________________________
batch_normalization_115 (BatchN (None, 64, 625, 48)  192         average_pooling2d_95[0][0]       
__________________________________________________________________________________________________
dropout_95 (Dropout)            (None, 64, 625, 48)  0           batch_normalization_115[0][0]    
__________________________________________________________________________________________________
inverted_residual_190 (Inverted (None, 64, 625, 32)  35840       dropout_95[0][0]                 
__________________________________________________________________________________________________
inverted_residual_191 (Inverted (None, 64, 625, 32)  20864       inverted_residual_190[0][0]      
__________________________________________________________________________________________________
average_pooling2d_96 (AveragePo (None, 32, 312, 32)  0           inverted_residual_191[0][0]      
__________________________________________________________________________________________________
batch_normalization_116 (BatchN (None, 32, 312, 32)  128         average_pooling2d_96[0][0]       
__________________________________________________________________________________________________
dropout_96 (Dropout)            (None, 32, 312, 32)  0           batch_normalization_116[0][0]    
__________________________________________________________________________________________________
inverted_residual_192 (Inverted (None, 32, 312, 64)  27136       dropout_96[0][0]                 
__________________________________________________________________________________________________
inverted_residual_193 (Inverted (None, 32, 312, 64)  66304       inverted_residual_192[0][0]      
__________________________________________________________________________________________________
average_pooling2d_97 (AveragePo (None, 16, 156, 64)  0           inverted_residual_193[0][0]      
__________________________________________________________________________________________________
batch_normalization_117 (BatchN (None, 16, 156, 64)  256         average_pooling2d_97[0][0]       
__________________________________________________________________________________________________
dropout_97 (Dropout)            (None, 16, 156, 64)  0           batch_normalization_117[0][0]    
__________________________________________________________________________________________________
inverted_residual_194 (Inverted (None, 16, 156, 128) 91136       dropout_97[0][0]                 
__________________________________________________________________________________________________
inverted_residual_195 (Inverted (None, 16, 156, 128) 230912      inverted_residual_194[0][0]      
__________________________________________________________________________________________________
average_pooling2d_98 (AveragePo (None, 8, 78, 128)   0           inverted_residual_195[0][0]      
__________________________________________________________________________________________________
batch_normalization_118 (BatchN (None, 8, 78, 128)   512         average_pooling2d_98[0][0]       
__________________________________________________________________________________________________
dropout_98 (Dropout)            (None, 8, 78, 128)   0           batch_normalization_118[0][0]    
__________________________________________________________________________________________________
inverted_residual_196 (Inverted (None, 8, 78, 256)   329728      dropout_98[0][0]                 
__________________________________________________________________________________________________
inverted_residual_197 (Inverted (None, 8, 78, 256)   855040      inverted_residual_196[0][0]      
__________________________________________________________________________________________________
average_pooling2d_99 (AveragePo (None, 4, 39, 256)   0           inverted_residual_197[0][0]      
__________________________________________________________________________________________________
batch_normalization_119 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_99[0][0]       
__________________________________________________________________________________________________
dropout_99 (Dropout)            (None, 4, 39, 256)   0           batch_normalization_119[0][0]    
__________________________________________________________________________________________________
inverted_residual_198 (Inverted (None, 4, 39, 512)   1249280     dropout_99[0][0]                 
__________________________________________________________________________________________________
inverted_residual_199 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_198[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_19 (Gl (None, 512)          0           inverted_residual_199[0][0]      
__________________________________________________________________________________________________
dense_19 (Dense)                (None, 1)            513         global_average_pooling2d_19[0][0]
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/80
287/287 - 419s - loss: 0.6377 - accuracy: 0.6894 - val_loss: 0.5987 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 71.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3863876756409023
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 2/80
287/287 - 416s - loss: 0.5677 - accuracy: 0.7429 - val_loss: 0.5985 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
Validation accuracy: 71.39
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3949170134773714
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 3/80
287/287 - 417s - loss: 0.5615 - accuracy: 0.7446 - val_loss: 0.6113 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 71.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24504470181527202
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 4/80
287/287 - 416s - loss: 0.5543 - accuracy: 0.7457 - val_loss: 0.6554 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 71.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23165219565293774
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 5/80
287/287 - 416s - loss: 0.5493 - accuracy: 0.7439 - val_loss: 0.6202 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 71.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27654929554359065
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 6/80
287/287 - 417s - loss: 0.5450 - accuracy: 0.7453 - val_loss: 0.6938 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
Validation accuracy: 71.39
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3307539898002252
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 7/80
287/287 - 416s - loss: 0.5410 - accuracy: 0.7501 - val_loss: 0.6360 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 71.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2389894018712312
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 8/80
287/287 - 416s - loss: 0.5344 - accuracy: 0.7544 - val_loss: 0.6061 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
Validation accuracy: 71.39
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.28211304371853296
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 9/80
287/287 - 416s - loss: 0.5277 - accuracy: 0.7590 - val_loss: 0.6063 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 71.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27653017801446467
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 10/80
287/287 - 416s - loss: 0.5191 - accuracy: 0.7592 - val_loss: 0.6301 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 71.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23922000743963434
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 11/80
287/287 - 416s - loss: 0.5154 - accuracy: 0.7599 - val_loss: 0.6203 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
Validation accuracy: 71.39
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.26590261022140604
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 12/80
287/287 - 416s - loss: 0.5061 - accuracy: 0.7658 - val_loss: 0.6017 - val_accuracy: 0.7139
Confusion matrix: 
 [[796   0]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 71.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.28713995860306835
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1115    0]
cm_sum: 1115
The training is defaulting to either class.
Epoch 13/80
287/287 - 416s - loss: 0.4977 - accuracy: 0.7712 - val_loss: 0.6392 - val_accuracy: 0.7130
Confusion matrix: 
 [[795   1]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 71.30
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.254475847092285
Validation class accuracies: [0.9987437185929648, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1114    1]
cm_sum: 1115
The training is defaulting to either class.
Epoch 14/80
287/287 - 416s - loss: 0.4797 - accuracy: 0.7778 - val_loss: 0.6717 - val_accuracy: 0.6197
Confusion matrix: 
 [[652 144]
 [280  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 15.54
Validation accuracy: 61.97
Validation recall: 12.23
Validation precision: 21.31
Validation AUC: 0.23821296826505026
Validation class accuracies: [0.8190954773869347, 0.12225705329153605]
TARGET: 1
target metric(test f1): 0.1553784860557769
column_sums: [932 183]
cm_sum: 1115
inside not defaulting
Saving model...
Epoch 15/80
287/287 - 416s - loss: 0.4716 - accuracy: 0.7832 - val_loss: 0.6828 - val_accuracy: 0.5857
Confusion matrix: 
 [[506 290]
 [172 147]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.89
Validation accuracy: 58.57
Validation recall: 46.08
Validation precision: 33.64
Validation AUC: 0.31946187726989117
Validation class accuracies: [0.635678391959799, 0.4608150470219436]
TARGET: 1
target metric(test f1): 0.38888888888888895
column_sums: [678 437]
cm_sum: 1115
inside not defaulting
Saving model...
Epoch 16/80
287/287 - 416s - loss: 0.4571 - accuracy: 0.7937 - val_loss: 0.6797 - val_accuracy: 0.6475
Confusion matrix: 
 [[614 182]
 [211 108]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.47
Validation accuracy: 64.75
Validation recall: 33.86
Validation precision: 37.24
Validation AUC: 0.3357537915170902
Validation class accuracies: [0.7713567839195979, 0.3385579937304075]
TARGET: 1
target metric(test f1): 0.354679802955665
column_sums: [825 290]
cm_sum: 1115
inside not defaulting
The validation tracker metric at 0.38888888888888895 hasn't increased by 0 in 1 epochs
Epoch 17/80
287/287 - 417s - loss: 0.4475 - accuracy: 0.7952 - val_loss: 0.7240 - val_accuracy: 0.3498
Confusion matrix: 
 [[164 632]
 [ 93 226]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.40
Validation accuracy: 34.98
Validation recall: 70.85
Validation precision: 26.34
Validation AUC: 0.2671254560812753
Validation class accuracies: [0.20603015075376885, 0.7084639498432602]
TARGET: 1
target metric(test f1): 0.38402718776550554
column_sums: [257 858]
cm_sum: 1115
inside not defaulting
The validation tracker metric at 0.38888888888888895 hasn't increased by 0 in 2 epochs
Epoch 18/80
287/287 - 416s - loss: 0.4318 - accuracy: 0.8035 - val_loss: 1.5654 - val_accuracy: 0.2870
Confusion matrix: 
 [[  1 795]
 [  0 319]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.52
Validation accuracy: 28.70
Validation recall: 100.00
Validation precision: 28.64
Validation AUC: 0.26486464902788215
Validation class accuracies: [0.001256281407035176, 1.0]
TARGET: 1
target metric(test f1): 0.4452198185624564
column_sums: [   1 1114]
cm_sum: 1115
The training is defaulting to either class.
Epoch 19/80
287/287 - 416s - loss: 0.4078 - accuracy: 0.8181 - val_loss: 3.8645 - val_accuracy: 0.2879
Confusion matrix: 
 [[  2 794]
 [  0 319]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.55
Validation accuracy: 28.79
Validation recall: 100.00
Validation precision: 28.66
Validation AUC: 0.22941066069288468
Validation class accuracies: [0.002512562814070352, 1.0]
TARGET: 1
target metric(test f1): 0.44553072625698326
column_sums: [   2 1113]
cm_sum: 1115
The training is defaulting to either class.
Epoch 20/80
287/287 - 416s - loss: 0.3875 - accuracy: 0.8253 - val_loss: 2.3048 - val_accuracy: 0.2879
Confusion matrix: 
 [[  2 794]
 [  0 319]]
Validation f1: 44.55
Validation accuracy: 28.79
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.66
Validation AUC: 0.24249020673078592
Validation class accuracies: [0.002512562814070352, 1.0]
TARGET: 1
target metric(test f1): 0.44553072625698326
column_sums: [   2 1113]
cm_sum: 1115
The training is defaulting to either class.
Epoch 21/80
287/287 - 416s - loss: 0.3725 - accuracy: 0.8338 - val_loss: 1.1749 - val_accuracy: 0.2888
Confusion matrix: 
 [[  6 790]
 [  3 316]]
Validation f1: 44.35
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.88
Validation recall: 99.06
Validation precision: 28.57
Validation AUC: 0.25604446874234
Validation class accuracies: [0.007537688442211055, 0.9905956112852664]
TARGET: 1
target metric(test f1): 0.4435087719298245
column_sums: [   9 1106]
cm_sum: 1115
The training is defaulting to either class.
Epoch 22/80
287/287 - 416s - loss: 0.3487 - accuracy: 0.8486 - val_loss: 2.3019 - val_accuracy: 0.2870
Confusion matrix: 
 [[  2 794]
 [  1 318]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.44
Validation accuracy: 28.70
Validation recall: 99.69
Validation precision: 28.60
Validation AUC: 0.24385932009753472
Validation class accuracies: [0.002512562814070352, 0.9968652037617555]
TARGET: 1
target metric(test f1): 0.44444444444444453
column_sums: [   3 1112]
cm_sum: 1115
The training is defaulting to either class.
Epoch 23/80
287/287 - 416s - loss: 0.3340 - accuracy: 0.8576 - val_loss: 1.3587 - val_accuracy: 0.2879
Confusion matrix: 
 [[  3 793]
 [  1 318]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.48
Validation accuracy: 28.79
Validation recall: 99.69
Validation precision: 28.62
Validation AUC: 0.2495847310866365
Validation class accuracies: [0.0037688442211055275, 0.9968652037617555]
TARGET: 1
target metric(test f1): 0.4447552447552448
column_sums: [   4 1111]
cm_sum: 1115
The training is defaulting to either class.
Epoch 24/80
287/287 - 416s - loss: 0.3108 - accuracy: 0.8654 - val_loss: 1.3980 - val_accuracy: 0.2897
Confusion matrix: 
 [[  6 790]
 [  2 317]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.46
Validation accuracy: 28.97
Validation recall: 99.37
Validation precision: 28.64
Validation AUC: 0.2548842901371086
Validation class accuracies: [0.007537688442211055, 0.9937304075235109]
TARGET: 1
target metric(test f1): 0.44460028050490885
column_sums: [   8 1107]
cm_sum: 1115
The training is defaulting to either class.
Epoch 25/80
287/287 - 416s - loss: 0.2987 - accuracy: 0.8685 - val_loss: 0.6303 - val_accuracy: 0.7121
Confusion matrix: 
 [[794   2]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 71.21
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2864368607409249
Validation class accuracies: [0.9974874371859297, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1113    2]
cm_sum: 1115
The training is defaulting to either class.
Epoch 26/80
287/287 - 416s - loss: 0.2732 - accuracy: 0.8853 - val_loss: 0.6086 - val_accuracy: 0.7049
Confusion matrix: 
 [[782  14]
 [315   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 2.37
Validation accuracy: 70.49
Validation recall: 1.25
Validation precision: 22.22
Validation AUC: 0.3175994828515305
Validation class accuracies: [0.9824120603015075, 0.012539184952978056]
TARGET: 1
target metric(test f1): 0.023738872403560828
column_sums: [1097   18]
cm_sum: 1115
The training is defaulting to either class.
Epoch 27/80
287/287 - 416s - loss: 0.2662 - accuracy: 0.8890 - val_loss: 0.6538 - val_accuracy: 0.6457
Confusion matrix: 
 [[646 150]
 [245  74]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.26
Validation accuracy: 64.57
Validation recall: 23.20
Validation precision: 33.04
Validation AUC: 0.30069540351263574
Validation class accuracies: [0.8115577889447236, 0.23197492163009403]
TARGET: 1
target metric(test f1): 0.2725598526703499
column_sums: [891 224]
cm_sum: 1115
inside not defaulting
The validation tracker metric at 0.38888888888888895 hasn't increased by 0 in 3 epochs
Epoch 28/80
287/287 - 416s - loss: 0.2509 - accuracy: 0.8995 - val_loss: 1.0836 - val_accuracy: 0.3247
Confusion matrix: 
 [[ 97 699]
 [ 54 265]]
Validation f1: 41.31
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 32.47
Validation recall: 83.07
Validation precision: 27.49
Validation AUC: 0.25444312929941726
Validation class accuracies: [0.12185929648241206, 0.8307210031347962]
TARGET: 1
target metric(test f1): 0.41309431021044424
column_sums: [151 964]
cm_sum: 1115
inside not defaulting
Saving model...
Epoch 29/80
287/287 - 416s - loss: 0.2394 - accuracy: 0.9075 - val_loss: 0.7123 - val_accuracy: 0.7049
Confusion matrix: 
 [[782  14]
 [315   4]]
Validation f1: 2.37
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 70.49
Validation recall: 1.25
Validation precision: 22.22
Validation AUC: 0.26129788279773347
Validation class accuracies: [0.9824120603015075, 0.012539184952978056]
TARGET: 1
target metric(test f1): 0.023738872403560828
column_sums: [1097   18]
cm_sum: 1115
The training is defaulting to either class.
Epoch 30/80
287/287 - 416s - loss: 0.2145 - accuracy: 0.9178 - val_loss: 0.7764 - val_accuracy: 0.4143
Confusion matrix: 
 [[256 540]
 [113 206]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.69
Validation accuracy: 41.43
Validation recall: 64.58
Validation precision: 27.61
Validation AUC: 0.29165074002434105
Validation class accuracies: [0.32160804020100503, 0.64576802507837]
TARGET: 1
target metric(test f1): 0.38685446009389673
column_sums: [369 746]
cm_sum: 1115
inside not defaulting
The validation tracker metric at 0.41309431021044424 hasn't increased by 0 in 1 epochs
Epoch 31/80
287/287 - 416s - loss: 0.2158 - accuracy: 0.9143 - val_loss: 0.7880 - val_accuracy: 0.7112
Confusion matrix: 
 [[793   3]
 [319   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 71.12
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.29458776919495244
Validation class accuracies: [0.9962311557788944, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1112    3]
cm_sum: 1115
The training is defaulting to either class.
Epoch 32/80
287/287 - 417s - loss: 0.2006 - accuracy: 0.9228 - val_loss: 0.6814 - val_accuracy: 0.6359
Confusion matrix: 
 [[637 159]
 [247  72]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.18
Validation accuracy: 63.59
Validation recall: 22.57
Validation precision: 31.17
Validation AUC: 0.28183574916228227
Validation class accuracies: [0.800251256281407, 0.22570532915360503]
TARGET: 1
target metric(test f1): 0.26181818181818184
column_sums: [884 231]
cm_sum: 1115
inside not defaulting
The validation tracker metric at 0.41309431021044424 hasn't increased by 0 in 2 epochs
Epoch 33/80
287/287 - 415s - loss: 0.1849 - accuracy: 0.9278 - val_loss: 1.1583 - val_accuracy: 0.3166
Confusion matrix: 
 [[ 90 706]
 [ 56 263]]
Validation f1: 40.84
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 31.66
Validation recall: 82.45
Validation precision: 27.14
Validation AUC: 0.23621142196574837
Validation class accuracies: [0.11306532663316583, 0.8244514106583072]
TARGET: 1
target metric(test f1): 0.4083850931677019
column_sums: [146 969]
cm_sum: 1115
inside not defaulting
The validation tracker metric at 0.41309431021044424 hasn't increased by 0 in 3 epochs
Epoch 34/80
287/287 - 416s - loss: 0.1877 - accuracy: 0.9272 - val_loss: 0.6257 - val_accuracy: 0.7112
Confusion matrix: 
 [[781  15]
 [307  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 6.94
Validation accuracy: 71.12
Validation recall: 3.76
Validation precision: 44.44
Validation AUC: 0.3328843938780805
Validation class accuracies: [0.9811557788944724, 0.03761755485893417]
TARGET: 1
target metric(test f1): 0.069364161849711
column_sums: [1088   27]
cm_sum: 1115
The training is defaulting to either class.
Epoch 35/80
287/287 - 415s - loss: 0.1677 - accuracy: 0.9396 - val_loss: 2.6220 - val_accuracy: 0.2870
Confusion matrix: 
 [[  1 795]
 [  0 319]]
Validation f1: 44.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.70
Validation recall: 100.00
Validation precision: 28.64
Validation AUC: 0.2577301647269884
Validation class accuracies: [0.001256281407035176, 1.0]
TARGET: 1
target metric(test f1): 0.4452198185624564
column_sums: [   1 1114]
cm_sum: 1115
The training is defaulting to either class.
Epoch 36/80
287/287 - 416s - loss: 0.1609 - accuracy: 0.9385 - val_loss: 1.1397 - val_accuracy: 0.2969
Confusion matrix: 
 [[ 17 779]
 [  5 314]]
Validation f1: 44.48
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 29.69
Validation recall: 98.43
Validation precision: 28.73
Validation AUC: 0.34760217644809555
Validation class accuracies: [0.02135678391959799, 0.9843260188087775]
TARGET: 1
target metric(test f1): 0.4447592067988669
column_sums: [  22 1093]
cm_sum: 1115
The training is defaulting to either class.
Epoch 37/80
287/287 - 416s - loss: 0.1577 - accuracy: 0.9435 - val_loss: 1.7226 - val_accuracy: 0.2897
Confusion matrix: 
 [[  4 792]
 [  0 319]]
Validation f1: 44.62
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.97
Validation recall: 100.00
Validation precision: 28.71
Validation AUC: 0.348056919034796
Validation class accuracies: [0.005025125628140704, 1.0]
TARGET: 1
target metric(test f1): 0.4461538461538461
column_sums: [   4 1111]
cm_sum: 1115
The training is defaulting to either class.
Epoch 38/80
287/287 - 416s - loss: 0.1554 - accuracy: 0.9407 - val_loss: 1.1828 - val_accuracy: 0.2888
Confusion matrix: 
 [[  5 791]
 [  2 317]]
Validation f1: 44.43
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.88
Validation recall: 99.37
Validation precision: 28.61
Validation AUC: 0.3701756091806483
Validation class accuracies: [0.00628140703517588, 0.9937304075235109]
TARGET: 1
target metric(test f1): 0.4442887175893483
column_sums: [   7 1108]
cm_sum: 1115
The training is defaulting to either class.
Epoch 39/80
287/287 - 416s - loss: 0.1394 - accuracy: 0.9472 - val_loss: 8.1469 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.49
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2725786822424475
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 40/80
287/287 - 416s - loss: 0.1352 - accuracy: 0.9498 - val_loss: 3.6626 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2693786802245328
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 41/80
287/287 - 416s - loss: 0.1229 - accuracy: 0.9566 - val_loss: 1.1623 - val_accuracy: 0.3004
Confusion matrix: 
 [[ 23 773]
 [  7 312]]
Validation f1: 44.44
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 30.04
Validation recall: 97.81
Validation precision: 28.76
Validation AUC: 0.3049244431658319
Validation class accuracies: [0.028894472361809045, 0.9780564263322884]
TARGET: 1
target metric(test f1): 0.4444444444444444
column_sums: [  30 1085]
cm_sum: 1115
The training is defaulting to either class.
Epoch 42/80
287/287 - 416s - loss: 0.1302 - accuracy: 0.9538 - val_loss: 4.0063 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2787776007393129
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 43/80
287/287 - 416s - loss: 0.1126 - accuracy: 0.9581 - val_loss: 6.1107 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.24325661425555534
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 44/80
287/287 - 416s - loss: 0.1287 - accuracy: 0.9525 - val_loss: 5.3815 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2457612752006887
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 45/80
287/287 - 416s - loss: 0.1154 - accuracy: 0.9581 - val_loss: 4.5796 - val_accuracy: 0.2870
Confusion matrix: 
 [[  1 795]
 [  0 319]]
Validation f1: 44.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.70
Validation recall: 100.00
Validation precision: 28.64
Validation AUC: 0.2535561602215492
Validation class accuracies: [0.001256281407035176, 1.0]
TARGET: 1
target metric(test f1): 0.4452198185624564
column_sums: [   1 1114]
cm_sum: 1115
The training is defaulting to either class.
Epoch 46/80
287/287 - 416s - loss: 0.1152 - accuracy: 0.9597 - val_loss: 5.0867 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2636332708549754
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 47/80
287/287 - 416s - loss: 0.1073 - accuracy: 0.9605 - val_loss: 0.8351 - val_accuracy: 0.7103
Confusion matrix: 
 [[777  19]
 [304  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 8.50
Validation accuracy: 71.03
Validation recall: 4.70
Validation precision: 44.12
Validation AUC: 0.37376064791950986
Validation class accuracies: [0.9761306532663316, 0.047021943573667714]
TARGET: 1
target metric(test f1): 0.08498583569405099
column_sums: [1081   34]
cm_sum: 1115
The training is defaulting to either class.
Epoch 48/80
287/287 - 416s - loss: 0.1078 - accuracy: 0.9636 - val_loss: 2.6178 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.35560779914337826
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 49/80
287/287 - 416s - loss: 0.1005 - accuracy: 0.9631 - val_loss: 7.4402 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.49
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2810035880611491
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 50/80
287/287 - 416s - loss: 0.0998 - accuracy: 0.9640 - val_loss: 7.8687 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2524343611338251
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 51/80
287/287 - 416s - loss: 0.1035 - accuracy: 0.9616 - val_loss: 0.7068 - val_accuracy: 0.5892
Confusion matrix: 
 [[499 297]
 [161 158]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.83
Validation accuracy: 58.92
Validation recall: 49.53
Validation precision: 34.73
Validation AUC: 0.35336958920834705
Validation class accuracies: [0.6268844221105527, 0.4952978056426332]
TARGET: 1
target metric(test f1): 0.40826873385012913
column_sums: [660 455]
cm_sum: 1115
inside not defaulting
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.41309431021044424 hasn't increased by 0 in 4 epochs
Epoch 52/80
287/287 - 418s - loss: 0.0931 - accuracy: 0.9692 - val_loss: 0.6509 - val_accuracy: 0.6780
Confusion matrix: 
 [[654 142]
 [217 102]]
Validation f1: 36.23
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 67.80
Validation recall: 31.97
Validation precision: 41.80
Validation AUC: 0.3773272637965388
Validation class accuracies: [0.821608040201005, 0.31974921630094044]
TARGET: 1
target metric(test f1): 0.3623445825932505
column_sums: [871 244]
cm_sum: 1115
inside not defaulting
The validation tracker metric at 0.41309431021044424 hasn't increased by 0 in 5 epochs
Epoch 53/80
287/287 - 416s - loss: 0.0774 - accuracy: 0.9762 - val_loss: 3.5660 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3030484728014475
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 54/80
287/287 - 416s - loss: 0.0844 - accuracy: 0.9736 - val_loss: 4.2337 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.31024513475650484
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 55/80
287/287 - 416s - loss: 0.0840 - accuracy: 0.9732 - val_loss: 4.5189 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3215958509831285
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 56/80
287/287 - 416s - loss: 0.0750 - accuracy: 0.9769 - val_loss: 5.8762 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
Validation recall: 100.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation precision: 28.61
Validation AUC: 0.2770234748607334
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 57/80
287/287 - 416s - loss: 0.0805 - accuracy: 0.9732 - val_loss: 7.4380 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2858037364866124
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 58/80
287/287 - 415s - loss: 0.0818 - accuracy: 0.9734 - val_loss: 3.9531 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.34421711342436856
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 59/80
287/287 - 415s - loss: 0.0733 - accuracy: 0.9778 - val_loss: 8.6467 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2752272842625975
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 60/80
287/287 - 415s - loss: 0.0706 - accuracy: 0.9771 - val_loss: 9.6822 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
Validation recall: 100.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation precision: 28.61
Validation AUC: 0.2640465195954012
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 61/80
287/287 - 415s - loss: 0.0759 - accuracy: 0.9743 - val_loss: 12.3586 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.44712543392243476
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 62/80
287/287 - 416s - loss: 0.0725 - accuracy: 0.9760 - val_loss: 11.3933 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3711090843348684
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 63/80
287/287 - 417s - loss: 0.0749 - accuracy: 0.9747 - val_loss: 10.4112 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3066232713085519
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 64/80
287/287 - 416s - loss: 0.0759 - accuracy: 0.9756 - val_loss: 7.9936 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2858674982010044
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 65/80
287/287 - 416s - loss: 0.0659 - accuracy: 0.9788 - val_loss: 5.7646 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3205916248495555
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 66/80
287/287 - 416s - loss: 0.0665 - accuracy: 0.9782 - val_loss: 2.9825 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.49
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3597005406325091
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 67/80
287/287 - 416s - loss: 0.0698 - accuracy: 0.9749 - val_loss: 4.1922 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3344038487654566
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 68/80
287/287 - 416s - loss: 0.0732 - accuracy: 0.9769 - val_loss: 2.2274 - val_accuracy: 0.2870
Confusion matrix: 
 [[  2 794]
 [  1 318]]
Validation f1: 44.44
Validation accuracy: 28.70
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 99.69
Validation precision: 28.60
Validation AUC: 0.3709018820963815
Validation class accuracies: [0.002512562814070352, 0.9968652037617555]
TARGET: 1
target metric(test f1): 0.44444444444444453
column_sums: [   3 1112]
cm_sum: 1115
The training is defaulting to either class.
Epoch 69/80
287/287 - 416s - loss: 0.0678 - accuracy: 0.9773 - val_loss: 1.1993 - val_accuracy: 0.5175
Confusion matrix: 
 [[331 465]
 [ 73 246]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.77
Validation accuracy: 51.75
Validation recall: 77.12
Validation precision: 34.60
Validation AUC: 0.3758822612963473
Validation class accuracies: [0.4158291457286432, 0.7711598746081505]
TARGET: 1
target metric(test f1): 0.47766990291262135
column_sums: [404 711]
cm_sum: 1115
inside not defaulting
Saving model...
Epoch 70/80
287/287 - 416s - loss: 0.0657 - accuracy: 0.9782 - val_loss: 2.3530 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.49
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.36651706466080264
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 71/80
287/287 - 416s - loss: 0.0688 - accuracy: 0.9791 - val_loss: 4.0068 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.34522931260308315
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 72/80
287/287 - 416s - loss: 0.0706 - accuracy: 0.9751 - val_loss: 2.9766 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.35102154962402815
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 73/80
287/287 - 416s - loss: 0.0667 - accuracy: 0.9769 - val_loss: 11.6051 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3801670249135047
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 74/80
287/287 - 416s - loss: 0.0632 - accuracy: 0.9802 - val_loss: 8.8395 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2637172255336199
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 75/80
287/287 - 416s - loss: 0.0646 - accuracy: 0.9806 - val_loss: 4.2473 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3366834414449182
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 76/80
287/287 - 416s - loss: 0.0635 - accuracy: 0.9806 - val_loss: 9.3413 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.26870587705370264
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 77/80
287/287 - 416s - loss: 0.0742 - accuracy: 0.9751 - val_loss: 5.4211 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
Validation accuracy: 28.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.2682722194768238
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 78/80
287/287 - 416s - loss: 0.0668 - accuracy: 0.9782 - val_loss: 6.2745 - val_accuracy: 0.2870
Confusion matrix: 
 [[  1 795]
 [  0 319]]
Validation f1: 44.52
Validation accuracy: 28.70
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 100.00
Validation precision: 28.64
Validation AUC: 0.27320274281998147
Validation class accuracies: [0.001256281407035176, 1.0]
TARGET: 1
target metric(test f1): 0.4452198185624564
column_sums: [   1 1114]
cm_sum: 1115
The training is defaulting to either class.
Epoch 79/80
287/287 - 416s - loss: 0.0632 - accuracy: 0.9793 - val_loss: 10.8887 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.3285389931291699
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.
Epoch 80/80
287/287 - 416s - loss: 0.0679 - accuracy: 0.9773 - val_loss: 6.6481 - val_accuracy: 0.2861
Confusion matrix: 
 [[  0 796]
 [  0 319]]
Validation f1: 44.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 28.61
Validation recall: 100.00
Validation precision: 28.61
Validation AUC: 0.285781403298067
Validation class accuracies: [0.0, 1.0]

The metrics for the epoch with the best target metric are: 
Best cm: [[331 465]
 [ 73 246]]
Best f1: 0.47766990291262135
Best accuracy: 0.5174887892376682
Best recall: 0.7711598746081505
Best precision: 0.3459915611814346
Best AUC: 0.3758822612963473
Best epoch: 69
TARGET: 1
target metric(test f1): 0.44490934449093444
column_sums: [   0 1115]
cm_sum: 1115
The training is defaulting to either class.

Starting the Bangladesh analysis...
Epoch: epoch14 & threshold: 1
Starting...
CM: [[32 20]
 [16  7]]
F1: 0.27999999999999997
AUC: 0.3884702093397746
Accuracy: 0.52
Precision: 0.25925925925925924
Recall: 0.30434782608695654
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch14.xls...
Done.
Epoch: epoch14 & threshold: 2
Starting...
CM: [[40 12]
 [21  2]]
F1: 0.1081081081081081
AUC: 0.25490683229813665
Accuracy: 0.56
Precision: 0.14285714285714285
Recall: 0.08695652173913043
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch14.xls...
Done.
Epoch: epoch14 & threshold: 3
Starting...
CM: [[45  7]
 [22  1]]
F1: 0.06451612903225806
AUC: 0.23090579710144926
Accuracy: 0.6133333333333333
Precision: 0.125
Recall: 0.043478260869565216
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch14.xls...
Done.
Epoch: epoch15 & threshold: 1
Starting...
CM: [[10 42]
 [ 1 22]]
F1: 0.5057471264367817
AUC: 0.656802536231884
Accuracy: 0.4266666666666667
Precision: 0.34375
Recall: 0.9565217391304348
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch15.xls...
Done.
Epoch: epoch15 & threshold: 2
Starting...
CM: [[19 33]
 [ 3 20]]
F1: 0.5263157894736843
AUC: 0.643461853978671
Accuracy: 0.52
Precision: 0.37735849056603776
Recall: 0.8695652173913043
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch15.xls...
Done.
Epoch: epoch15 & threshold: 3
Starting...
CM: [[28 24]
 [10 13]]
F1: 0.43333333333333335
AUC: 0.5249510379945161
Accuracy: 0.5466666666666666
Precision: 0.35135135135135137
Recall: 0.5652173913043478
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch15.xls...
Done.
Epoch: epoch28 & threshold: 1
Starting...
CM: [[ 0 52]
 [ 0 23]]
F1: 0.4693877551020408
AUC: 0.6533333333333333
Accuracy: 0.30666666666666664
Precision: 0.30666666666666664
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch28.xls...
Done.
Epoch: epoch28 & threshold: 2
Starting...
CM: [[ 0 52]
 [ 0 23]]
F1: 0.4693877551020408
AUC: 0.6533333333333333
Accuracy: 0.30666666666666664
Precision: 0.30666666666666664
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch28.xls...
Done.
Epoch: epoch28 & threshold: 3
Starting...
CM: [[ 1 51]
 [ 1 22]]
F1: 0.45833333333333326
AUC: 0.6356124677387334
Accuracy: 0.30666666666666664
Precision: 0.3013698630136986
Recall: 0.9565217391304348
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch28.xls...
Done.
Epoch: epoch69 & threshold: 1
Starting...
CM: [[ 4 48]
 [ 0 23]]
F1: 0.4893617021276596
AUC: 0.6619718309859155
Accuracy: 0.36
Precision: 0.323943661971831
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch69.xls...
Done.
Epoch: epoch69 & threshold: 2
Starting...
CM: [[ 8 44]
 [ 1 22]]
F1: 0.4943820224719101
AUC: 0.6515942028985506
Accuracy: 0.4
Precision: 0.3333333333333333
Recall: 0.9565217391304348
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch69.xls...
Done.
Epoch: epoch69 & threshold: 3
Starting...
CM: [[14 38]
 [ 2 21]]
F1: 0.5121951219512195
AUC: 0.6478211741586833
Accuracy: 0.4666666666666667
Precision: 0.3559322033898305
Recall: 0.9130434782608695
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch69.xls...
Done.
Epoch: epoch80 & threshold: 1
Starting...
CM: [[ 0 52]
 [ 0 23]]
F1: 0.4693877551020408
AUC: 0.6533333333333333
Accuracy: 0.30666666666666664
Precision: 0.30666666666666664
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch80.xls...
Done.
Epoch: epoch80 & threshold: 2
Starting...
CM: [[ 0 52]
 [ 0 23]]
F1: 0.4693877551020408
AUC: 0.6533333333333333
Accuracy: 0.30666666666666664
Precision: 0.30666666666666664
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch80.xls...
Done.
Epoch: epoch80 & threshold: 3
Starting...
CM: [[ 0 52]
 [ 0 23]]
F1: 0.4693877551020408
AUC: 0.6533333333333333
Accuracy: 0.30666666666666664
Precision: 0.30666666666666664
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1758__v29__attempt_augm/1/validation_sheet_epochepoch80.xls...
Done.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 2939
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210525_175953-2kd18qoq/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210525_175953-2kd18qoq/logs/debug-internal.log
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2157: https://wandb.ai/arachid1/tensorboard-integration/runs/2kd18qoq


 See logs at ../../new_cache/conv__2157__05_1758__v29__attempt_augm/logs/