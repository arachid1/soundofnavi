Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2052
Description:  redo
2021-04-13 13:09:43.328158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 13:09:45.568149: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-13 13:09:45.569029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-13 13:09:45.628765: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:45.629469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-13 13:09:45.629496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 13:09:45.632746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 13:09:45.632829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 13:09:45.633844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-13 13:09:45.634157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-13 13:09:45.635199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-13 13:09:45.636018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-13 13:09:45.636170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 13:09:45.636276: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:45.637025: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:45.637665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-13 13:09:45.639602: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-13 13:09:45.639758: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:45.640482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-13 13:09:45.640507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 13:09:45.640539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 13:09:45.640555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 13:09:45.640571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-13 13:09:45.640599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-13 13:09:45.640627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-13 13:09:45.640642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-13 13:09:45.640658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 13:09:45.640724: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:45.641415: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:45.642044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-13 13:09:45.642079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 13:09:46.412724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-13 13:09:46.412780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-13 13:09:46.412793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-13 13:09:46.413066: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:46.413851: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:46.414629: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 13:09:46.415335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-04-13 13:09:46.845662: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-13 13:09:46.845725: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-13 13:09:46.845766: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-13 13:09:46.846072: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-13 13:09:46.847075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-13 13:09:47.043479: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-13 13:09:47.046961: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-13 13:09:47.904304: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-13 13:09:47.905942: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-13 13:09:50.072080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 13:09:50.550214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 13:09:50.579372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 13:09:54.098243: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-13 13:09:54.098300: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-13 13:09:55.182578: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-13 13:09:55.187504: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-13 13:09:55.238915: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 517 callback api events and 513 activity events. 
2021-04-13 13:09:55.266197: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.2001s vs `on_train_batch_end` time: 0.2629s). Check your callbacks.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2052.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_1308___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___redo___2052/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 6, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 22, 1.0%
-----------------------
Size of training set: 4316
Size of validation set: 1078
Initializing weights...
weights = {0: 0.6776381909547738, 1: 1.9073550212164074}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,967
Trainable params: 105,471
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
270/270 - 159s - loss: 0.6883 - accuracy: 0.5792 - precision: 0.3050 - recall: 0.4884 - val_loss: 0.6505 - val_accuracy: 0.7254 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00
Epoch 2/40
270/270 - 150s - loss: 0.6740 - accuracy: 0.6158 - precision: 0.3381 - recall: 0.5045 - val_loss: 0.6539 - val_accuracy: 0.7180 - val_precision: 0.3667 - val_recall: 0.0372
Epoch 3/40
270/270 - 150s - loss: 0.6635 - accuracy: 0.6172 - precision: 0.3510 - recall: 0.5626 - val_loss: 0.7270 - val_accuracy: 0.4666 - val_precision: 0.3102 - val_recall: 0.7703
Epoch 4/40
270/270 - 151s - loss: 0.6501 - accuracy: 0.6425 - precision: 0.3749 - recall: 0.5698 - val_loss: 0.7747 - val_accuracy: 0.4963 - val_precision: 0.3186 - val_recall: 0.7331
Epoch 5/40
270/270 - 150s - loss: 0.6320 - accuracy: 0.6476 - precision: 0.3817 - recall: 0.5814 - val_loss: 0.5922 - val_accuracy: 0.7171 - val_precision: 0.4563 - val_recall: 0.1588
Epoch 6/40
270/270 - 150s - loss: 0.5985 - accuracy: 0.6911 - precision: 0.4340 - recall: 0.6324 - val_loss: 0.6738 - val_accuracy: 0.5872 - val_precision: 0.3602 - val_recall: 0.6486
Epoch 7/40
270/270 - 150s - loss: 0.5745 - accuracy: 0.7071 - precision: 0.4561 - recall: 0.6780 - val_loss: 0.6174 - val_accuracy: 0.7226 - val_precision: 0.4706 - val_recall: 0.0811

Epoch 00007: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 8/40
270/270 - 150s - loss: 0.5007 - accuracy: 0.7671 - precision: 0.5375 - recall: 0.7245 - val_loss: 0.7326 - val_accuracy: 0.7356 - val_precision: 0.9231 - val_recall: 0.0405
Epoch 9/40
270/270 - 150s - loss: 0.4444 - accuracy: 0.8077 - precision: 0.5996 - recall: 0.7755 - val_loss: 0.6794 - val_accuracy: 0.6735 - val_precision: 0.4172 - val_recall: 0.4764
Epoch 10/40
270/270 - 151s - loss: 0.3953 - accuracy: 0.8362 - precision: 0.6450 - recall: 0.8175 - val_loss: 0.7374 - val_accuracy: 0.6475 - val_precision: 0.3871 - val_recall: 0.4865
Epoch 11/40
270/270 - 150s - loss: 0.3349 - accuracy: 0.8621 - precision: 0.6924 - recall: 0.8417 - val_loss: 0.8902 - val_accuracy: 0.5974 - val_precision: 0.3831 - val_recall: 0.7635
Epoch 12/40
270/270 - 143s - loss: 0.2819 - accuracy: 0.8937 - precision: 0.7533 - recall: 0.8766 - val_loss: 0.9300 - val_accuracy: 0.6030 - val_precision: 0.3842 - val_recall: 0.7399
Epoch 13/40
270/270 - 141s - loss: 0.2513 - accuracy: 0.9013 - precision: 0.7695 - recall: 0.8837 - val_loss: 0.8227 - val_accuracy: 0.7004 - val_precision: 0.4487 - val_recall: 0.3986
Epoch 14/40
270/270 - 141s - loss: 0.2123 - accuracy: 0.9240 - precision: 0.8096 - recall: 0.9240 - val_loss: 0.7740 - val_accuracy: 0.7421 - val_precision: 0.5750 - val_recall: 0.2331
Epoch 15/40
270/270 - 141s - loss: 0.1733 - accuracy: 0.9428 - precision: 0.8549 - recall: 0.9383 - val_loss: 0.7868 - val_accuracy: 0.6763 - val_precision: 0.4361 - val_recall: 0.6115
Epoch 16/40
270/270 - 141s - loss: 0.1415 - accuracy: 0.9581 - precision: 0.8927 - recall: 0.9526 - val_loss: 0.9802 - val_accuracy: 0.6243 - val_precision: 0.3885 - val_recall: 0.6419
Epoch 17/40
270/270 - 141s - loss: 0.1539 - accuracy: 0.9490 - precision: 0.8723 - recall: 0.9410 - val_loss: 1.2444 - val_accuracy: 0.5807 - val_precision: 0.3721 - val_recall: 0.7669
Epoch 18/40
270/270 - 141s - loss: 0.1121 - accuracy: 0.9666 - precision: 0.9127 - recall: 0.9633 - val_loss: 0.9059 - val_accuracy: 0.6327 - val_precision: 0.3936 - val_recall: 0.6250
Epoch 19/40
270/270 - 141s - loss: 0.1072 - accuracy: 0.9673 - precision: 0.9186 - recall: 0.9589 - val_loss: 1.0697 - val_accuracy: 0.6503 - val_precision: 0.4069 - val_recall: 0.5980
Epoch 20/40
270/270 - 141s - loss: 0.1024 - accuracy: 0.9666 - precision: 0.9134 - recall: 0.9624 - val_loss: 1.0183 - val_accuracy: 0.7430 - val_precision: 0.5979 - val_recall: 0.1959
