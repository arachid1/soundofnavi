Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2180
Description:  lowlr_increasing
2021-06-01 18:28:04.082583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:18: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-01 18:28:07.261897: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-01 18:28:07.263184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-01 18:28:07.333709: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:28:07.334848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-01 18:28:07.334910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 18:28:07.340039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 18:28:07.340185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-01 18:28:07.341864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-01 18:28:07.342360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-01 18:28:07.344037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-01 18:28:07.345425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-01 18:28:07.345733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 18:28:07.346010: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:28:07.347302: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:28:07.348433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2180.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 4, 'min_lr': 1e-06}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
Audio augmentations params: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v36'}
Spectrogram augmentations params: {'ADD': 0, 'QUANTITY': 50, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 0, 'LOUDNESS': 0}
-----------------------
wandb: wandb version 0.10.31 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2180
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/29auc5fj
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210601_182807-29auc5fj
wandb: Run `wandb offline` to turn off syncing.
2021-06-01 18:28:59.395873: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-01 18:28:59.396226: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:28:59.397253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-01 18:28:59.397334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 18:28:59.397443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 18:28:59.397505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-01 18:28:59.397539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-01 18:28:59.397568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-01 18:28:59.397596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-01 18:28:59.397624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-01 18:28:59.397651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 18:28:59.397802: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:28:59.398969: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:28:59.399989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-01 18:28:59.400067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 18:29:00.242122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-01 18:29:00.242179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-01 18:29:00.242190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-01 18:29:00.242590: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:29:00.243801: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:29:00.244878: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 18:29:00.245822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:05.0, compute capability: 7.0)
2021-06-01 18:29:01.642569: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-01 18:29:01.645023: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-01 18:29:02.095326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 18:29:03.966084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 18:29:04.331081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11

Original number of folders: 453
4212
With concat = False and six = False, size of training set: 4212...
...and size of validation set: 1072
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/80
264/264 - 135s - loss: 0.6868 - accuracy: 0.6033 - val_loss: 0.5820 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2795376852801775
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/80
264/264 - 134s - loss: 0.5980 - accuracy: 0.7215 - val_loss: 0.6022 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.321723991172837
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/80
264/264 - 134s - loss: 0.5686 - accuracy: 0.7367 - val_loss: 0.7009 - val_accuracy: 0.7090
Confusion matrix: 
 [[748  36]
 [276  12]]
Validation f1: 7.14
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 70.90
Validation recall: 4.17
Validation precision: 25.00
Validation AUC: 0.3162757211388516
Validation class accuracies: [0.9540816326530612, 0.041666666666666664]
TARGET: 1
target metric(test f1): 0.07142857142857142
inside not defaulting
Saving model...
Epoch 4/80
264/264 - 134s - loss: 0.5714 - accuracy: 0.7367 - val_loss: 0.6266 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3074730737800304
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0.07142857142857142 hasn't increased by 0 in 1 epochs
Epoch 5/80
264/264 - 133s - loss: 0.5552 - accuracy: 0.7431 - val_loss: 0.6342 - val_accuracy: 0.7183
Confusion matrix: 
 [[762  22]
 [280   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 5.03
Validation accuracy: 71.83
Validation recall: 2.78
Validation precision: 26.67
Validation AUC: 0.3038534215339246
Validation class accuracies: [0.9719387755102041, 0.027777777777777776]
TARGET: 1
target metric(test f1): 0.05031446540880503
inside not defaulting
The validation tracker metric at 0.07142857142857142 hasn't increased by 0 in 2 epochs
Epoch 6/80
264/264 - 132s - loss: 0.5560 - accuracy: 0.7438 - val_loss: 0.6521 - val_accuracy: 0.7220
Confusion matrix: 
 [[766  18]
 [280   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 5.10
Validation accuracy: 72.20
Validation recall: 2.78
Validation precision: 30.77
Validation AUC: 0.3013468885880259
Validation class accuracies: [0.9770408163265306, 0.027777777777777776]
TARGET: 1
target metric(test f1): 0.050955414012738856
inside not defaulting
The validation tracker metric at 0.07142857142857142 hasn't increased by 0 in 3 epochs
Epoch 7/80
264/264 - 132s - loss: 0.5527 - accuracy: 0.7398 - val_loss: 0.6304 - val_accuracy: 0.7024
Confusion matrix: 
 [[735  49]
 [270  18]]
Validation f1: 10.14
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 70.24
Validation recall: 6.25
Validation precision: 26.87
Validation AUC: 0.30258777244265755
Validation class accuracies: [0.9375, 0.0625]
TARGET: 1
target metric(test f1): 0.10140845070422536
inside not defaulting
Saving model...
Epoch 8/80
264/264 - 133s - loss: 0.5458 - accuracy: 0.7476 - val_loss: 0.6813 - val_accuracy: 0.6175
Confusion matrix: 
 [[507 277]
 [133 155]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.06
Validation accuracy: 61.75
Validation recall: 53.82
Validation precision: 35.88
Validation AUC: 0.3253027649842996
Validation class accuracies: [0.6466836734693877, 0.5381944444444444]
TARGET: 1
target metric(test f1): 0.4305555555555555
inside not defaulting
Saving model...
Epoch 9/80
264/264 - 132s - loss: 0.5400 - accuracy: 0.7434 - val_loss: 0.6472 - val_accuracy: 0.6847
Confusion matrix: 
 [[698  86]
 [252  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.56
Validation accuracy: 68.47
Validation recall: 12.50
Validation precision: 29.51
Validation AUC: 0.2879871217212972
Validation class accuracies: [0.8903061224489796, 0.125]
TARGET: 1
target metric(test f1): 0.17560975609756097
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 1 epochs
Epoch 10/80
264/264 - 132s - loss: 0.5327 - accuracy: 0.7521 - val_loss: 1.2343 - val_accuracy: 0.7267
Confusion matrix: 
 [[768  16]
 [277  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 6.98
Validation accuracy: 72.67
Validation recall: 3.82
Validation precision: 40.74
Validation AUC: 0.31407559336417457
Validation class accuracies: [0.9795918367346939, 0.03819444444444445]
TARGET: 1
target metric(test f1): 0.06984126984126984
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 2 epochs
Epoch 11/80
264/264 - 134s - loss: 0.5417 - accuracy: 0.7407 - val_loss: 0.6914 - val_accuracy: 0.7211
Confusion matrix: 
 [[763  21]
 [278  10]]
Validation f1: 6.27
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 72.11
Validation recall: 3.47
Validation precision: 32.26
Validation AUC: 0.2716257076164062
Validation class accuracies: [0.9732142857142857, 0.034722222222222224]
TARGET: 1
target metric(test f1): 0.06269592476489029
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 3 epochs
Epoch 12/80
264/264 - 135s - loss: 0.5141 - accuracy: 0.7505 - val_loss: 0.6743 - val_accuracy: 0.6772
Confusion matrix: 
 [[676 108]
 [238  50]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.42
Validation accuracy: 67.72
Validation recall: 17.36
Validation precision: 31.65
Validation AUC: 0.2994092764771754
Validation class accuracies: [0.8622448979591837, 0.1736111111111111]
TARGET: 1
target metric(test f1): 0.22421524663677128
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 4 epochs
Epoch 13/80
264/264 - 134s - loss: 0.4934 - accuracy: 0.7645 - val_loss: 0.8039 - val_accuracy: 0.7267
Confusion matrix: 
 [[775   9]
 [284   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 2.66
Validation accuracy: 72.67
Validation recall: 1.39
Validation precision: 30.77
Validation AUC: 0.27625565888289194
Validation class accuracies: [0.9885204081632653, 0.013888888888888888]
TARGET: 1
target metric(test f1): 0.026578073089700997
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 5 epochs
Epoch 14/80
264/264 - 133s - loss: 0.4523 - accuracy: 0.7894 - val_loss: 0.6866 - val_accuracy: 0.7257
Confusion matrix: 
 [[773  11]
 [283   5]]
Validation f1: 3.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 72.57
Validation recall: 1.74
Validation precision: 31.25
Validation AUC: 0.2906755195671889
Validation class accuracies: [0.985969387755102, 0.017361111111111112]
TARGET: 1
target metric(test f1): 0.03289473684210526
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 6 epochs
Epoch 15/80
264/264 - 132s - loss: 0.4060 - accuracy: 0.8141 - val_loss: 0.7848 - val_accuracy: 0.7108
Confusion matrix: 
 [[752  32]
 [278  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 6.06
Validation accuracy: 71.08
Validation recall: 3.47
Validation precision: 23.81
Validation AUC: 0.2872547596463015
Validation class accuracies: [0.9591836734693877, 0.034722222222222224]
TARGET: 1
target metric(test f1): 0.06060606060606061
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 7 epochs
Epoch 16/80
264/264 - 133s - loss: 0.3235 - accuracy: 0.8597 - val_loss: 1.0990 - val_accuracy: 0.7136
Confusion matrix: 
 [[761  23]
 [284   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 2.54
Validation accuracy: 71.36
Validation recall: 1.39
Validation precision: 14.81
Validation AUC: 0.26395272382303236
Validation class accuracies: [0.9706632653061225, 0.013888888888888888]
TARGET: 1
target metric(test f1): 0.025396825396825393
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 8 epochs
Epoch 17/80
264/264 - 132s - loss: 0.2399 - accuracy: 0.9046 - val_loss: 1.0804 - val_accuracy: 0.5476
Confusion matrix: 
 [[432 352]
 [133 155]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.99
Validation accuracy: 54.76
Validation recall: 53.82
Validation precision: 30.57
Validation AUC: 0.29256914801156025
Validation class accuracies: [0.5510204081632653, 0.5381944444444444]
TARGET: 1
target metric(test f1): 0.38993710691823896
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 9 epochs
Epoch 18/80
264/264 - 132s - loss: 0.1524 - accuracy: 0.9461 - val_loss: 1.0811 - val_accuracy: 0.6007
Confusion matrix: 
 [[558 226]
 [202  86]]
Validation f1: 28.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 60.07
Validation recall: 29.86
Validation precision: 27.56
Validation AUC: 0.2927733987501876
Validation class accuracies: [0.7117346938775511, 0.2986111111111111]
TARGET: 1
target metric(test f1): 0.2866666666666667
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 10 epochs
Epoch 19/80
264/264 - 132s - loss: 0.0852 - accuracy: 0.9710 - val_loss: 1.3073 - val_accuracy: 0.6287
Confusion matrix: 
 [[589 195]
 [203  85]]
Validation f1: 29.93
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 62.87
Validation recall: 29.51
Validation precision: 30.36
Validation AUC: 0.285056379004603
Validation class accuracies: [0.7512755102040817, 0.2951388888888889]
TARGET: 1
target metric(test f1): 0.2992957746478873
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 11 epochs
Epoch 20/80
264/264 - 133s - loss: 0.0719 - accuracy: 0.9789 - val_loss: 1.2927 - val_accuracy: 0.6325
Confusion matrix: 
 [[599 185]
 [209  79]]
Validation f1: 28.62
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 63.25
Validation recall: 27.43
Validation precision: 29.92
Validation AUC: 0.2790417833284187
Validation class accuracies: [0.764030612244898, 0.2743055555555556]
TARGET: 1
target metric(test f1): 0.286231884057971
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 12 epochs
Epoch 21/80
264/264 - 133s - loss: 0.0756 - accuracy: 0.9758 - val_loss: 1.3221 - val_accuracy: 0.6259
Confusion matrix: 
 [[604 180]
 [221  67]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.05
Validation accuracy: 62.59
Validation recall: 23.26
Validation precision: 27.13
Validation AUC: 0.27410752921270165
Validation class accuracies: [0.7704081632653061, 0.2326388888888889]
TARGET: 1
target metric(test f1): 0.2504672897196262
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 13 epochs
Epoch 22/80
264/264 - 132s - loss: 0.0633 - accuracy: 0.9824 - val_loss: 1.6431 - val_accuracy: 0.5616
Confusion matrix: 
 [[484 300]
 [170 118]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 33.43
Validation accuracy: 56.16
Validation recall: 40.97
Validation precision: 28.23
Validation AUC: 0.28220807133562853
Validation class accuracies: [0.6173469387755102, 0.4097222222222222]
TARGET: 1
target metric(test f1): 0.3342776203966006
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 14 epochs
Epoch 23/80
264/264 - 134s - loss: 0.0622 - accuracy: 0.9812 - val_loss: 1.5567 - val_accuracy: 0.5942
Confusion matrix: 
 [[550 234]
 [201  87]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.57
Validation accuracy: 59.42
Validation recall: 30.21
Validation precision: 27.10
Validation AUC: 0.2706423116038166
Validation class accuracies: [0.701530612244898, 0.3020833333333333]
TARGET: 1
target metric(test f1): 0.2857142857142857
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 15 epochs
Epoch 24/80
264/264 - 136s - loss: 0.0685 - accuracy: 0.9796 - val_loss: 1.5175 - val_accuracy: 0.6511
Confusion matrix: 
 [[635 149]
 [225  63]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.20
Validation accuracy: 65.11
Validation recall: 21.88
Validation precision: 29.72
Validation AUC: 0.2869421390301381
Validation class accuracies: [0.8099489795918368, 0.21875]
TARGET: 1
target metric(test f1): 0.252
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 16 epochs
Epoch 25/80
264/264 - 136s - loss: 0.0546 - accuracy: 0.9836 - val_loss: 1.5646 - val_accuracy: 0.6185
Confusion matrix: 
 [[581 203]
 [206  82]]
Validation f1: 28.62
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 61.85
Validation recall: 28.47
Validation precision: 28.77
Validation AUC: 0.2768664259121095
Validation class accuracies: [0.7410714285714286, 0.2847222222222222]
TARGET: 1
target metric(test f1): 0.2862129144851658
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 17 epochs
Epoch 26/80
264/264 - 136s - loss: 0.0624 - accuracy: 0.9789 - val_loss: 1.6640 - val_accuracy: 0.6707
Confusion matrix: 
 [[684 100]
 [253  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 16.55
Validation accuracy: 67.07
Validation recall: 12.15
Validation precision: 25.93
Validation AUC: 0.27527839421836675
Validation class accuracies: [0.8724489795918368, 0.12152777777777778]
TARGET: 1
target metric(test f1): 0.16548463356973994
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 18 epochs
Epoch 27/80
264/264 - 135s - loss: 0.0546 - accuracy: 0.9815 - val_loss: 1.8448 - val_accuracy: 0.5569
Confusion matrix: 
 [[473 311]
 [164 124]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.30
Validation accuracy: 55.69
Validation recall: 43.06
Validation precision: 28.51
Validation AUC: 0.27684714244359054
Validation class accuracies: [0.6033163265306123, 0.4305555555555556]
TARGET: 1
target metric(test f1): 0.343015214384509
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 19 epochs
Epoch 28/80
264/264 - 135s - loss: 0.0625 - accuracy: 0.9760 - val_loss: 1.6189 - val_accuracy: 0.6558
Confusion matrix: 
 [[657 127]
 [242  46]]
Validation f1: 19.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 65.58
Validation recall: 15.97
Validation precision: 26.59
Validation AUC: 0.26810028375942496
Validation class accuracies: [0.8380102040816326, 0.1597222222222222]
TARGET: 1
target metric(test f1): 0.19956616052060736
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 20 epochs
Epoch 29/80
264/264 - 135s - loss: 0.0749 - accuracy: 0.9725 - val_loss: 1.5030 - val_accuracy: 0.6567
Confusion matrix: 
 [[668 116]
 [252  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 16.36
Validation accuracy: 65.67
Validation recall: 12.50
Validation precision: 23.68
Validation AUC: 0.2637430250933202
Validation class accuracies: [0.8520408163265306, 0.125]
TARGET: 1
target metric(test f1): 0.16363636363636364
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 21 epochs
Epoch 30/80
264/264 - 135s - loss: 0.0561 - accuracy: 0.9798 - val_loss: 2.7260 - val_accuracy: 0.4925
Confusion matrix: 
 [[345 439]
 [105 183]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.22
Validation accuracy: 49.25
Validation recall: 63.54
Validation precision: 29.42
Validation AUC: 0.27413238886050223
Validation class accuracies: [0.44005102040816324, 0.6354166666666666]
TARGET: 1
target metric(test f1): 0.40219780219780227
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 22 epochs
Epoch 31/80
264/264 - 135s - loss: 0.0538 - accuracy: 0.9829 - val_loss: 1.7503 - val_accuracy: 0.6455
Confusion matrix: 
 [[639 145]
 [235  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.81
Validation accuracy: 64.55
Validation recall: 18.40
Validation precision: 26.77
Validation AUC: 0.2788057374043811
Validation class accuracies: [0.8150510204081632, 0.1840277777777778]
TARGET: 1
target metric(test f1): 0.21810699588477367
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 23 epochs
Epoch 32/80
264/264 - 135s - loss: 0.0532 - accuracy: 0.9836 - val_loss: 1.6051 - val_accuracy: 0.6418
Confusion matrix: 
 [[621 163]
 [221  67]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.87
Validation accuracy: 64.18
Validation recall: 23.26
Validation precision: 29.13
Validation AUC: 0.28762052082793554
Validation class accuracies: [0.7920918367346939, 0.2326388888888889]
TARGET: 1
target metric(test f1): 0.25868725868725867
inside not defaulting
The validation tracker metric at 0.4305555555555555 hasn't increased by 0 in 24 epochs
Epoch 33/80
264/264 - 130s - loss: 0.0437 - accuracy: 0.9855 - val_loss: 1.7839 - val_accuracy: 0.7034
Confusion matrix: 
 [[736  48]
 [270  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.17
Validation accuracy: 70.34
Validation recall: 6.25
Validation precision: 27.27
Validation AUC: 0.27268817968593345
Validation class accuracies: [0.9387755102040817, 0.0625]

The metrics for the epoch with the best target metric are: 
Best cm: [[507 277]
 [133 155]]
Best f1: 0.4305555555555555
Best accuracy: 0.6175373134328358
Best recall: 0.5381944444444444
Best precision: 0.3587962962962963
Best AUC: 0.3253027649842996
Best epoch: 8
TARGET: 1
target metric(test f1): 0.10169491525423728
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[34 19]
 [13  9]]
F1: 0.36000000000000004
AUC: 0.45192640692640695
Accuracy: 0.5733333333333334
Precision: 0.32142857142857145
Recall: 0.4090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[48  5]
 [22  0]]
F1: 0.0
AUC: 0.14666666666666667
Accuracy: 0.64
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[52  1]
 [22  0]]
F1: 0.0
AUC: 0.14666666666666667
Accuracy: 0.6933333333333334
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_80.xls...
Done.
Epoch: epoch3
Starting...
CM: [[44  9]
 [18  4]]
F1: 0.2285714285714286
AUC: 0.36475524475524473
Accuracy: 0.64
Precision: 0.3076923076923077
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[48  5]
 [21  1]]
F1: 0.07142857142857144
AUC: 0.24606060606060606
Accuracy: 0.6533333333333333
Precision: 0.16666666666666666
Recall: 0.045454545454545456
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[50  3]
 [21  1]]
F1: 0.07692307692307693
AUC: 0.2877272727272727
Accuracy: 0.68
Precision: 0.25
Recall: 0.045454545454545456
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch3.xls...
Done.
Epoch: epoch7
Starting...
CM: [[36 17]
 [13  9]]
F1: 0.37500000000000006
AUC: 0.4642890442890443
Accuracy: 0.6
Precision: 0.34615384615384615
Recall: 0.4090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch7.xls...
Done.
Epoch: epoch7
Starting...
CM: [[47  6]
 [21  1]]
F1: 0.06896551724137931
AUC: 0.23415584415584417
Accuracy: 0.64
Precision: 0.14285714285714285
Recall: 0.045454545454545456
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch7.xls...
Done.
Epoch: epoch7
Starting...
CM: [[50  3]
 [22  0]]
F1: 0.0
AUC: 0.14666666666666667
Accuracy: 0.6666666666666666
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch7.xls...
Done.
Epoch: epoch8
Starting...
CM: [[12 41]
 [ 1 21]]
F1: 0.5
AUC: 0.6532942326490714
Accuracy: 0.44
Precision: 0.3387096774193548
Recall: 0.9545454545454546
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch8.xls...
Done.
Epoch: epoch8
Starting...
CM: [[18 35]
 [ 2 20]]
F1: 0.5194805194805195
AUC: 0.6496969696969698
Accuracy: 0.5066666666666667
Precision: 0.36363636363636365
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch8.xls...
Done.
Epoch: epoch8
Starting...
CM: [[34 19]
 [ 5 17]]
F1: 0.5862068965517242
AUC: 0.6558080808080808
Accuracy: 0.68
Precision: 0.4722222222222222
Recall: 0.7727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/validation_sheet_epoch8.xls...
Done.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 18267
wandb: Program ended successfully.
wandb: - 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: \ 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: | 0.07MB of 0.08MB uploaded (0.00MB deduped)wandb: / 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: - 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: \ 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: | 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: / 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210601_182807-29auc5fj/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210601_182807-29auc5fj/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98552
wandb:         val_accuracy 0.70336
wandb:             _runtime 6069
wandb:           _timestamp 1622578156
wandb:                _step 244
wandb:           train_loss 0.04368
wandb:             val_loss 1.78386
wandb:           val_recall 0.0625
wandb:        val_precision 0.27273
wandb:               val_f1 0.10169
wandb:              val_auc 0.27269
wandb:                   lr <tensorflow_addons.o...
wandb:          best_val_f1 0.43056
wandb:    best_val_accuracy 0.61754
wandb:   best_val_precision 0.3588
wandb:      best_val_recall 0.53819
wandb:             best_auc 0.3253
wandb:           best_epoch 8
wandb:           best_bd_f1 0.58621
wandb:          best_bd_auc 0.65581
wandb:     best_bd_accuracy 0.68
wandb:    best_bd_precision 0.47222
wandb:       best_bd_recall 0.77273
wandb:        best_bd_epoch epoch8
wandb: Run history:
wandb:   train_accuracy ▁▃▃▃▄▄▄▄▄▄▄▄▄▄▅▆▇▇███████████████
wandb:     val_accuracy ██▇███▇▅▇██▆██▇▇▃▄▅▅▅▃▄▆▅▆▃▆▆▁▅▅▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇█
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇█
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▇▇▇▇▆▆▆▆▆▆▅▅▄▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▁▁▁▁▁▁▃▁▁▂▁▂▃▃▃▃▃▃▄▄▄▄▅▅▄▄█▅▄▅
wandb:       val_recall ▁▁▁▁▁▁▂▇▂▁▁▃▁▁▁▁▇▄▄▄▄▆▄▃▄▂▆▃▂█▃▄▂
wandb:    val_precision ▁▁▅▁▆▆▆▇▆█▇▆▆▆▅▄▆▆▆▆▆▆▆▆▆▅▆▆▅▆▆▆▆
wandb:           val_f1 ▁▁▂▁▂▂▃█▄▂▂▅▁▂▂▁▇▆▆▆▅▆▆▅▆▄▇▄▄█▅▅▃
wandb:          val_auc ▃█▇▆▆▅▅█▄▇▂▅▂▄▄▁▄▄▃▃▂▃▂▄▂▂▂▁▁▂▃▄▂
wandb: 
wandb: Synced 6 W&B file(s), 14 media file(s), 11 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2180: https://wandb.ai/arachid1/tensorboard-integration/runs/29auc5fj


 See logs at ../../new_cache/conv__2180__06_1827__v29__lowlr_increasing/logs/