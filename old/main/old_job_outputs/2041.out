Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2041
Description:  new_mixednet
2021-04-07 10:19:59.956087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 10:20:01.863891: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-07 10:20:01.864819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-07 10:20:01.915933: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:01.916648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-07 10:20:01.916674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 10:20:01.920105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 10:20:01.920171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 10:20:01.921321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-07 10:20:01.921598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-07 10:20:01.922621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-07 10:20:01.923470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-07 10:20:01.923618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 10:20:01.923713: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:01.924438: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:01.925076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-07 10:20:01.926976: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-07 10:20:01.927126: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:01.927793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-07 10:20:01.927815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 10:20:01.927840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 10:20:01.927854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 10:20:01.927867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-07 10:20:01.927879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-07 10:20:01.927903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-07 10:20:01.927917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-07 10:20:01.927930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 10:20:01.927992: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:01.928682: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:01.929339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-07 10:20:01.929402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 10:20:02.621840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-07 10:20:02.621878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-07 10:20:02.621887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-07 10:20:02.622158: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:02.622934: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:02.623728: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:20:02.624457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-04-07 10:20:03.089688: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-07 10:20:03.089726: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-07 10:20:03.089762: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-07 10:20:03.089952: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-07 10:20:03.090736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-07 10:20:03.277225: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-07 10:20:03.279780: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2041.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_1017___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___new_mixednet___2041/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 4) 16          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 4) 16          input_1[0][0]                    
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 4) 148         conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 4) 404         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 4) 16          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 12 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 128, 1250, 12 156         concatenate[0][0]                
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 12)  0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 64, 625, 12)  48          average_pooling2d[0][0]          
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 64, 625, 12)  1308        batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 64, 625, 12)  156         conv2d_6[0][0]                   
__________________________________________________________________________________________________
mix_depth_group_convolution2d ( (None, 64, 625, 12)  288         conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 64, 625, 12)  1308        mix_depth_group_convolution2d[0][
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 64, 625, 12)  156         conv2d_8[0][0]                   
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 313, 12)  0           conv2d_9[0][0]                   
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 313, 12)  48          average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 313, 16)  1744        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 313, 16)  272         conv2d_10[0][0]                  
__________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (None, 32, 313, 16)  414         conv2d_11[0][0]                  
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 313, 16)  2320        mix_depth_group_convolution2d_1[0
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 313, 16)  272         conv2d_12[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 157, 16)  0           conv2d_13[0][0]                  
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 16, 157, 16)  64          average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 157, 32)  4640        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 16, 157, 32)  1056        conv2d_14[0][0]                  
__________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (None, 16, 157, 32)  828         conv2d_15[0][0]                  
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 16, 157, 32)  9248        mix_depth_group_convolution2d_2[0
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 16, 157, 32)  1056        conv2d_16[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 79, 32)    0           conv2d_17[0][0]                  
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 8, 79, 32)    128         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 79, 64)    18496       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 79, 64)    4160        conv2d_18[0][0]                  
__________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (None, 8, 79, 64)    1656        conv2d_19[0][0]                  2021-04-07 10:20:04.147938: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-07 10:20:04.150088: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-07 10:20:06.670616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 10:20:07.090994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 10:20:07.100500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 10:20:09.846277: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-07 10:20:09.846315: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-07 10:20:10.684119: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-07 10:20:10.688798: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-07 10:20:10.725742: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 904 callback api events and 900 activity events. 
2021-04-07 10:20:10.749806: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.

__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 79, 64)    36928       mix_depth_group_convolution2d_3[0
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 79, 64)    4160        conv2d_20[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 40, 64)    0           conv2d_21[0][0]                  
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 4, 40, 64)    256         average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 4, 40, 128)   73856       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 4, 40, 128)   16512       conv2d_22[0][0]                  
__________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (None, 4, 40, 128)   3402        conv2d_23[0][0]                  
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 4, 40, 128)   147584      mix_depth_group_convolution2d_4[0
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 4, 40, 128)   16512       conv2d_24[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_5 (AveragePoo (None, 2, 20, 128)   0           conv2d_25[0][0]                  
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 2, 20, 128)   512         average_pooling2d_5[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 128)          0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            258         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 350,402
Trainable params: 349,874
Non-trainable params: 528
__________________________________________________________________________________________________
Epoch 1/40
872/872 - 324s - loss: 0.3390 - calc_accuracy: 0.6227 - val_loss: 0.6123 - val_calc_accuracy: 0.5614
Epoch 2/40
872/872 - 397s - loss: 0.2659 - calc_accuracy: 0.7222 - val_loss: 0.3252 - val_calc_accuracy: 0.7461
Epoch 3/40
872/872 - 449s - loss: 0.2455 - calc_accuracy: 0.7463 - val_loss: 0.3030 - val_calc_accuracy: 0.7712
Epoch 4/40
872/872 - 451s - loss: 0.2271 - calc_accuracy: 0.7654 - val_loss: 0.2978 - val_calc_accuracy: 0.7593
Epoch 5/40
872/872 - 454s - loss: 0.2068 - calc_accuracy: 0.7915 - val_loss: 0.2393 - val_calc_accuracy: 0.8276
Epoch 6/40
872/872 - 453s - loss: 0.1911 - calc_accuracy: 0.8136 - val_loss: 0.2621 - val_calc_accuracy: 0.7943
Epoch 7/40
872/872 - 461s - loss: 0.1746 - calc_accuracy: 0.8281 - val_loss: 0.2975 - val_calc_accuracy: 0.7797
Epoch 8/40
872/872 - 457s - loss: 0.1678 - calc_accuracy: 0.8334 - val_loss: 0.2362 - val_calc_accuracy: 0.8385
Epoch 9/40
872/872 - 453s - loss: 0.1584 - calc_accuracy: 0.8458 - val_loss: 0.2047 - val_calc_accuracy: 0.8539
Epoch 10/40
872/872 - 445s - loss: 0.1494 - calc_accuracy: 0.8549 - val_loss: 0.1988 - val_calc_accuracy: 0.8580
Epoch 11/40
872/872 - 455s - loss: 0.1432 - calc_accuracy: 0.8560 - val_loss: 0.1823 - val_calc_accuracy: 0.8721
Epoch 12/40
872/872 - 456s - loss: 0.1318 - calc_accuracy: 0.8727 - val_loss: 0.1812 - val_calc_accuracy: 0.8764
Epoch 13/40
872/872 - 459s - loss: 0.1278 - calc_accuracy: 0.8768 - val_loss: 0.1753 - val_calc_accuracy: 0.8824
Epoch 14/40
872/872 - 450s - loss: 0.1170 - calc_accuracy: 0.8868 - val_loss: 0.2133 - val_calc_accuracy: 0.8562
Epoch 15/40
872/872 - 455s - loss: 0.1127 - calc_accuracy: 0.8864 - val_loss: 0.2084 - val_calc_accuracy: 0.8623
Epoch 16/40
872/872 - 459s - loss: 0.1088 - calc_accuracy: 0.8937 - val_loss: 0.1930 - val_calc_accuracy: 0.8750

Epoch 00016: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 17/40
872/872 - 451s - loss: 0.0906 - calc_accuracy: 0.9088 - val_loss: 0.2236 - val_calc_accuracy: 0.8638
Epoch 18/40
872/872 - 452s - loss: 0.0829 - calc_accuracy: 0.9184 - val_loss: 0.1910 - val_calc_accuracy: 0.8775
Epoch 19/40
872/872 - 459s - loss: 0.0764 - calc_accuracy: 0.9221 - val_loss: 0.1848 - val_calc_accuracy: 0.8887
Epoch 20/40
872/872 - 455s - loss: 0.0712 - calc_accuracy: 0.9295 - val_loss: 0.1924 - val_calc_accuracy: 0.8752
Epoch 21/40
872/872 - 451s - loss: 0.0630 - calc_accuracy: 0.9375 - val_loss: 0.2082 - val_calc_accuracy: 0.8678
Epoch 22/40
872/872 - 455s - loss: 0.0618 - calc_accuracy: 0.9391 - val_loss: 0.2094 - val_calc_accuracy: 0.8757

Epoch 00022: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 00022: early stopping

 See logs at ../../cache/conv___04_1017___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___new_mixednet___2041/logs/