Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v32_augm_v0_cleaned_8000.pkl
File:  conv.train2161
Description:  class_weights
2021-05-27 01:29:34.012366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-27 01:29:36.850742: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-27 01:29:36.851756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-27 01:29:36.897966: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:36.898668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-27 01:29:36.898726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-27 01:29:36.904288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-27 01:29:36.904402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-27 01:29:36.908808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-27 01:29:36.909107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-27 01:29:36.910747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-27 01:29:36.912214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-27 01:29:36.912424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-27 01:29:36.912540: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:36.913274: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:36.913924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2161.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v32_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2161__05_0129__v32__class_weights/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2161
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2ke28fzo
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210527_012937-2ke28fzo
wandb: Run `wandb offline` to turn off syncing.
2021-05-27 01:29:42.348743: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-27 01:29:42.349071: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:42.349802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-27 01:29:42.349855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-27 01:29:42.349920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-27 01:29:42.349955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-27 01:29:42.349985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-27 01:29:42.350013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-27 01:29:42.350040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-27 01:29:42.350066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-27 01:29:42.350093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-27 01:29:42.350209: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:42.350953: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:42.351604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-27 01:29:42.351691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-27 01:29:43.055875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-27 01:29:43.055942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-27 01:29:43.055951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-27 01:29:43.056254: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:43.057019: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:43.057772: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 01:29:43.058429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-27 01:30:19.925676: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-27 01:30:19.927190: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-27 01:30:22.913679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-27 01:30:23.615013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-27 01:30:23.627170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4165...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/80
261/261 - 496s - loss: 0.7300 - accuracy: 0.5563 - val_loss: 0.5414 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17069545021689356
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/80
261/261 - 490s - loss: 0.6846 - accuracy: 0.5724 - val_loss: 0.5388 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.15592148424568208
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/80
261/261 - 491s - loss: 0.6692 - accuracy: 0.5923 - val_loss: 0.7037 - val_accuracy: 0.4632
Confusion matrix: 
 [[396 474]
 [110 108]]
Validation f1: 27.00
Validation accuracy: 46.32
Validation recall: 49.54
Validation precision: 18.56
Validation AUC: 0.18612884917536954
Validation class accuracies: [0.45517241379310347, 0.4954128440366973]
TARGET: 1
target metric(test f1): 0.27
inside not defaulting
Saving model...
Epoch 4/80
261/261 - 490s - loss: 0.6611 - accuracy: 0.6103 - val_loss: 0.8713 - val_accuracy: 0.3189
Confusion matrix: 
 [[194 676]
 [ 65 153]]
Validation f1: 29.23
Validation accuracy: 31.89
Validation recall: 70.18
Validation precision: 18.46
Validation AUC: 0.17254644831567098
Validation class accuracies: [0.22298850574712645, 0.7018348623853211]
TARGET: 1
target metric(test f1): 0.2922636103151862
inside not defaulting
Saving model...
Epoch 5/80
261/261 - 490s - loss: 0.6501 - accuracy: 0.6166 - val_loss: 0.7609 - val_accuracy: 0.4789
Confusion matrix: 
 [[405 465]
 [102 116]]
Validation f1: 29.04
Validation accuracy: 47.89
Validation recall: 53.21
Validation precision: 19.97
Validation AUC: 0.189368244843065
Validation class accuracies: [0.46551724137931033, 0.5321100917431193]
TARGET: 1
target metric(test f1): 0.2903629536921151
inside not defaulting
The validation tracker metric at 0.2922636103151862 hasn't increased by 0 in 1 epochs
Epoch 6/80
261/261 - 489s - loss: 0.6359 - accuracy: 0.6259 - val_loss: 0.9439 - val_accuracy: 0.2353
Confusion matrix: 
 [[ 82 788]
 [ 44 174]]
Validation f1: 29.49
Validation accuracy: 23.53
Validation recall: 79.82
Validation precision: 18.09
Validation AUC: 0.17212802337582803
Validation class accuracies: [0.09425287356321839, 0.7981651376146789]
TARGET: 1
target metric(test f1): 0.29491525423728815
inside not defaulting
Saving model...
Epoch 7/80
261/261 - 490s - loss: 0.6191 - accuracy: 0.6411 - val_loss: 0.5758 - val_accuracy: 0.7500
Confusion matrix: 
 [[794  76]
 [196  22]]
Validation f1: 13.92
Validation accuracy: 75.00
Validation recall: 10.09
Validation precision: 22.45
Validation AUC: 0.21489598480351332
Validation class accuracies: [0.9126436781609195, 0.10091743119266056]
TARGET: 1
target metric(test f1): 0.13924050632911394
inside not defaulting
The validation tracker metric at 0.29491525423728815 hasn't increased by 0 in 1 epochs
Epoch 8/80
261/261 - 490s - loss: 0.6011 - accuracy: 0.6658 - val_loss: 0.7039 - val_accuracy: 0.5836
Confusion matrix: 
 [[574 296]
 [157  61]]
Validation f1: 21.22
Validation accuracy: 58.36
Validation recall: 27.98
Validation precision: 17.09
Validation AUC: 0.17807321800423664
Validation class accuracies: [0.6597701149425287, 0.2798165137614679]
TARGET: 1
target metric(test f1): 0.21217391304347827
inside not defaulting
The validation tracker metric at 0.29491525423728815 hasn't increased by 0 in 2 epochs
Epoch 9/80
261/261 - 492s - loss: 0.5826 - accuracy: 0.6828 - val_loss: 1.0188 - val_accuracy: 0.3750
Confusion matrix: 
 [[282 588]
 [ 92 126]]
Validation f1: 27.04
Validation accuracy: 37.50
Validation recall: 57.80
Validation precision: 17.65
Validation AUC: 0.17044060636933234
Validation class accuracies: [0.32413793103448274, 0.5779816513761468]
TARGET: 1
target metric(test f1): 0.2703862660944206
inside not defaulting
The validation tracker metric at 0.29491525423728815 hasn't increased by 0 in 3 epochs
Epoch 10/80
261/261 - 491s - loss: 0.5476 - accuracy: 0.7126 - val_loss: 0.9103 - val_accuracy: 0.5009
Confusion matrix: 
 [[447 423]
 [120  98]]
Validation f1: 26.52
Validation accuracy: 50.09
Validation recall: 44.95
Validation precision: 18.81
Validation AUC: 0.18171110882285488
Validation class accuracies: [0.5137931034482759, 0.44954128440366975]
TARGET: 1
target metric(test f1): 0.2652232746955345
inside not defaulting
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.29491525423728815 hasn't increased by 0 in 4 epochs
Epoch 11/80
261/261 - 490s - loss: 0.4864 - accuracy: 0.7585 - val_loss: 1.1806 - val_accuracy: 0.3465
Confusion matrix: 
 [[224 646]
 [ 65 153]]
Validation f1: 30.09
Validation accuracy: 34.65
Validation recall: 70.18
Validation precision: 19.15
Validation AUC: 0.17952701460017934
Validation class accuracies: [0.2574712643678161, 0.7018348623853211]
TARGET: 1
target metric(test f1): 0.30088495575221236
inside not defaulting
Saving model...
Epoch 12/80
261/261 - 491s - loss: 0.4399 - accuracy: 0.7777 - val_loss: 0.9898 - val_accuracy: 0.4770
Confusion matrix: 
 [[408 462]
 [107 111]]
Validation f1: 28.07
Validation accuracy: 47.70
Validation recall: 50.92
Validation precision: 19.37
Validation AUC: 0.1851814506616622
Validation class accuracies: [0.4689655172413793, 0.5091743119266054]
TARGET: 1
target metric(test f1): 0.2806573957016435
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 1 epochs
Epoch 13/80
261/261 - 491s - loss: 0.3979 - accuracy: 0.8007 - val_loss: 0.8066 - val_accuracy: 0.6011
Confusion matrix: 
 [[605 265]
 [169  49]]
Validation f1: 18.42
Validation accuracy: 60.11
Validation recall: 22.48
Validation precision: 15.61
Validation AUC: 0.17409882571345497
Validation class accuracies: [0.6954022988505747, 0.22477064220183487]
TARGET: 1
target metric(test f1): 0.18421052631578946
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 2 epochs
Epoch 14/80
261/261 - 490s - loss: 0.3825 - accuracy: 0.8043 - val_loss: 0.7227 - val_accuracy: 0.7105
Confusion matrix: 
 [[749 121]
 [194  24]]
Validation f1: 13.22
Validation accuracy: 71.05
Validation recall: 11.01
Validation precision: 16.55
Validation AUC: 0.1864080247581513
Validation class accuracies: [0.860919540229885, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.1322314049586777
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 3 epochs
Epoch 15/80
261/261 - 490s - loss: 0.3493 - accuracy: 0.8293 - val_loss: 1.0811 - val_accuracy: 0.5083
Confusion matrix: 
 [[447 423]
 [112 106]]
Validation f1: 28.38
Validation accuracy: 50.83
Validation recall: 48.62
Validation precision: 20.04
Validation AUC: 0.18400460785359435
Validation class accuracies: [0.5137931034482759, 0.48623853211009177]
TARGET: 1
target metric(test f1): 0.2838018741633199
inside not defaulting
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 4 epochs
Epoch 16/80
261/261 - 490s - loss: 0.3276 - accuracy: 0.8401 - val_loss: 0.9003 - val_accuracy: 0.5919
Confusion matrix: 
 [[583 287]
 [157  61]]
Validation f1: 21.55
Validation accuracy: 59.19
Validation recall: 27.98
Validation precision: 17.53
Validation AUC: 0.18033632003035355
Validation class accuracies: [0.6701149425287356, 0.2798165137614679]
TARGET: 1
target metric(test f1): 0.215547703180212
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 5 epochs
Epoch 17/80
261/261 - 491s - loss: 0.3192 - accuracy: 0.8471 - val_loss: 0.9870 - val_accuracy: 0.5450
Confusion matrix: 
 [[511 359]
 [136  82]]
Validation f1: 24.89
Validation accuracy: 54.50
Validation recall: 37.61
Validation precision: 18.59
Validation AUC: 0.17928601683822865
Validation class accuracies: [0.5873563218390805, 0.3761467889908257]
TARGET: 1
target metric(test f1): 0.2488619119878604
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 6 epochs
Epoch 18/80
261/261 - 489s - loss: 0.3145 - accuracy: 0.8471 - val_loss: 0.8914 - val_accuracy: 0.5919
Confusion matrix: 
 [[584 286]
 [158  60]]
Validation f1: 21.28
Validation accuracy: 59.19
Validation recall: 27.52
Validation precision: 17.34
Validation AUC: 0.18186857968372191
Validation class accuracies: [0.671264367816092, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.21276595744680848
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 7 epochs
Epoch 19/80
261/261 - 491s - loss: 0.3209 - accuracy: 0.8408 - val_loss: 0.8843 - val_accuracy: 0.6112
Confusion matrix: 
 [[612 258]
 [165  53]]
Validation f1: 20.04
Validation accuracy: 61.12
Validation recall: 24.31
Validation precision: 17.04
Validation AUC: 0.18058003460938565
Validation class accuracies: [0.7034482758620689, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.20037807183364842
inside not defaulting
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 8 epochs
Epoch 20/80
261/261 - 490s - loss: 0.3095 - accuracy: 0.8495 - val_loss: 0.9639 - val_accuracy: 0.5643
Confusion matrix: 
 [[539 331]
 [143  75]]
Validation f1: 24.04
Validation accuracy: 56.43
Validation recall: 34.40
Validation precision: 18.47
Validation AUC: 0.18244846503381235
Validation class accuracies: [0.6195402298850575, 0.3440366972477064]
TARGET: 1
target metric(test f1): 0.2403846153846154
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 9 epochs
Epoch 21/80
261/261 - 490s - loss: 0.3090 - accuracy: 0.8487 - val_loss: 0.9433 - val_accuracy: 0.5763
Confusion matrix: 
 [[559 311]
 [150  68]]
Validation f1: 22.78
Validation accuracy: 57.63
Validation recall: 31.19
Validation precision: 17.94
Validation AUC: 0.18125991644609032
Validation class accuracies: [0.6425287356321839, 0.3119266055045872]
TARGET: 1
target metric(test f1): 0.22780569514237858
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 10 epochs
Epoch 22/80
261/261 - 490s - loss: 0.3112 - accuracy: 0.8492 - val_loss: 0.9434 - val_accuracy: 0.5781
Confusion matrix: 
 [[560 310]
 [149  69]]
Validation f1: 23.12
Validation accuracy: 57.81
Validation recall: 31.65
Validation precision: 18.21
Validation AUC: 0.18084985981378957
Validation class accuracies: [0.6436781609195402, 0.3165137614678899]
TARGET: 1
target metric(test f1): 0.23115577889447236
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 11 epochs
Epoch 23/80
261/261 - 490s - loss: 0.3140 - accuracy: 0.8461 - val_loss: 0.8869 - val_accuracy: 0.6048
Confusion matrix: 
 [[606 264]
 [166  52]]
Validation f1: 19.48
Validation accuracy: 60.48
Validation recall: 23.85
Validation precision: 16.46
Validation AUC: 0.18117892870058283
Validation class accuracies: [0.696551724137931, 0.23853211009174313]
TARGET: 1
target metric(test f1): 0.1947565543071161
inside not defaulting
Lr has been adjusted to 3.906249901319825e-07
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 12 epochs
Epoch 24/80
261/261 - 490s - loss: 0.3056 - accuracy: 0.8495 - val_loss: 0.9460 - val_accuracy: 0.5744
Confusion matrix: 
 [[555 315]
 [148  70]]
Validation f1: 23.22
Validation accuracy: 57.44
Validation recall: 32.11
Validation precision: 18.18
Validation AUC: 0.18178221970181085
Validation class accuracies: [0.6379310344827587, 0.3211009174311927]
TARGET: 1
target metric(test f1): 0.23217247097844115
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 13 epochs
Epoch 25/80
261/261 - 489s - loss: 0.2975 - accuracy: 0.8526 - val_loss: 0.9531 - val_accuracy: 0.5689
Confusion matrix: 
 [[550 320]
 [149  69]]
Validation f1: 22.73
Validation accuracy: 56.89
Validation recall: 31.65
Validation precision: 17.74
Validation AUC: 0.18141726921095885
Validation class accuracies: [0.632183908045977, 0.3165137614678899]
TARGET: 1
target metric(test f1): 0.22734761120263594
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 14 epochs
Epoch 26/80
261/261 - 490s - loss: 0.3072 - accuracy: 0.8490 - val_loss: 0.9378 - val_accuracy: 0.5800
Confusion matrix: 
 [[564 306]
 [151  67]]
Validation f1: 22.67
Validation accuracy: 58.00
Validation recall: 30.73
Validation precision: 17.96
Validation AUC: 0.18189082845143348
Validation class accuracies: [0.6482758620689655, 0.3073394495412844]
TARGET: 1
target metric(test f1): 0.22673434856175975
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 15 epochs
Epoch 27/80
261/261 - 490s - loss: 0.2949 - accuracy: 0.8600 - val_loss: 0.9263 - val_accuracy: 0.5846
Confusion matrix: 
 [[571 299]
 [153  65]]
Validation f1: 22.34
Validation accuracy: 58.46
Validation recall: 29.82
Validation precision: 17.86
Validation AUC: 0.1819243674794489
Validation class accuracies: [0.6563218390804598, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.2233676975945017
inside not defaulting
Lr has been adjusted to 9.765624753299562e-08
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 16 epochs
Epoch 28/80
261/261 - 490s - loss: 0.3009 - accuracy: 0.8552 - val_loss: 0.9386 - val_accuracy: 0.5781
Confusion matrix: 
 [[565 305]
 [154  64]]
Validation f1: 21.81
Validation accuracy: 57.81
Validation recall: 29.36
Validation precision: 17.34
Validation AUC: 0.18139853372606168
Validation class accuracies: [0.6494252873563219, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.21805792163543442
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 17 epochs
Epoch 29/80
261/261 - 489s - loss: 0.3058 - accuracy: 0.8502 - val_loss: 0.9321 - val_accuracy: 0.5818
Confusion matrix: 
 [[569 301]
 [154  64]]
Validation f1: 21.96
Validation accuracy: 58.18
Validation recall: 29.36
Validation precision: 17.53
Validation AUC: 0.18157565353404836
Validation class accuracies: [0.6540229885057471, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.2195540308747856
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 18 epochs
Epoch 30/80
261/261 - 492s - loss: 0.3167 - accuracy: 0.8461 - val_loss: 0.9467 - val_accuracy: 0.5772
Confusion matrix: 
 [[558 312]
 [148  70]]
Validation f1: 23.33
Validation accuracy: 57.72
Validation recall: 32.11
Validation precision: 18.32
Validation AUC: 0.18203023487182912
Validation class accuracies: [0.6413793103448275, 0.3211009174311927]
TARGET: 1
target metric(test f1): 0.23333333333333336
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 19 epochs
Epoch 31/80
261/261 - 489s - loss: 0.3052 - accuracy: 0.8533 - val_loss: 0.9339 - val_accuracy: 0.5864
Confusion matrix: 
 [[571 299]
 [151  67]]
Validation f1: 22.95
Validation accuracy: 58.64
Validation recall: 30.73
Validation precision: 18.31
Validation AUC: 0.18178733314340148
Validation class accuracies: [0.6563218390804598, 0.3073394495412844]
TARGET: 1
target metric(test f1): 0.22945205479452052
inside not defaulting
Lr has been adjusted to 2.4414061883248905e-08
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 20 epochs
Epoch 32/80
261/261 - 490s - loss: 0.2899 - accuracy: 0.8583 - val_loss: 0.9277 - val_accuracy: 0.5855
Confusion matrix: 
 [[573 297]
 [154  64]]
Validation f1: 22.11
Validation accuracy: 58.55
Validation recall: 29.36
Validation precision: 17.73
Validation AUC: 0.18190883749382014
Validation class accuracies: [0.6586206896551724, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.2210708117443869
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 21 epochs
Epoch 33/80
261/261 - 491s - loss: 0.3026 - accuracy: 0.8559 - val_loss: 0.9385 - val_accuracy: 0.5818
Confusion matrix: 
 [[565 305]
 [150  68]]
Validation f1: 23.01
Validation accuracy: 58.18
Validation recall: 31.19
Validation precision: 18.23
Validation AUC: 0.18195610553546648
Validation class accuracies: [0.6494252873563219, 0.3119266055045872]
TARGET: 1
target metric(test f1): 0.23011844331641287
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 22 epochs
Epoch 34/80
261/261 - 490s - loss: 0.3064 - accuracy: 0.8495 - val_loss: 0.9300 - val_accuracy: 0.5818
Confusion matrix: 
 [[570 300]
 [155  63]]
Validation f1: 21.69
Validation accuracy: 58.18
Validation recall: 28.90
Validation precision: 17.36
Validation AUC: 0.18178488504528545
Validation class accuracies: [0.6551724137931034, 0.2889908256880734]
TARGET: 1
target metric(test f1): 0.21686746987951805
inside not defaulting
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 23 epochs
Epoch 35/80
261/261 - 490s - loss: 0.3001 - accuracy: 0.8593 - val_loss: 0.9239 - val_accuracy: 0.5855
Confusion matrix: 
 [[575 295]
 [156  62]]
Validation f1: 21.57
Validation accuracy: 58.55
Validation recall: 28.44
Validation precision: 17.37
Validation AUC: 0.18161327749560774
Validation class accuracies: [0.6609195402298851, 0.28440366972477066]
TARGET: 1
target metric(test f1): 0.21565217391304348
inside not defaulting
Lr has been adjusted to 6.103515470812226e-09
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 24 epochs
Epoch 36/80
261/261 - 491s - loss: 0.3045 - accuracy: 0.8579 - val_loss: 0.9307 - val_accuracy: 0.5846
Confusion matrix: 
 [[570 300]
 [152  66]]
Validation f1: 22.60
Validation accuracy: 58.46
Validation recall: 30.28
Validation precision: 18.03
Validation AUC: 0.1816361469337507
Validation class accuracies: [0.6551724137931034, 0.30275229357798167]

The metrics for the epoch with the best target metric are: 
Best cm: [[224 646]
 [ 65 153]]
Best f1: 0.30088495575221236
Best accuracy: 0.34650735294117646
Best recall: 0.7018348623853211
Best precision: 0.19148936170212766
Best AUC: 0.17952701460017934
Best epoch: 11
TARGET: 1
target metric(test f1): 0.22602739726027396
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[ 5 55]
 [ 0 15]]
F1: 0.35294117647058826
AUC: 0.6071428571428571
Accuracy: 0.26666666666666666
Precision: 0.21428571428571427
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[17 43]
 [ 6  9]]
F1: 0.26865671641791045
AUC: 0.4265384615384616
Accuracy: 0.3466666666666667
Precision: 0.17307692307692307
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[37 23]
 [ 9  6]]
F1: 0.2727272727272727
AUC: 0.36344827586206896
Accuracy: 0.5733333333333334
Precision: 0.20689655172413793
Recall: 0.4
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_80.xls...
Done.
Epoch: epoch11
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch11.xls...
Done.
Epoch: epoch11
Starting...
CM: [[ 1 59]
 [ 0 15]]
F1: 0.3370786516853933
AUC: 0.6013513513513513
Accuracy: 0.21333333333333335
Precision: 0.20270270270270271
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch11.xls...
Done.
Epoch: epoch11
Starting...
CM: [[ 6 54]
 [ 0 15]]
F1: 0.3571428571428571
AUC: 0.6086956521739131
Accuracy: 0.28
Precision: 0.21739130434782608
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch11.xls...
Done.
Epoch: epoch3
Starting...
CM: [[ 1 59]
 [ 1 14]]
F1: 0.3181818181818181
AUC: 0.5692237442922373
Accuracy: 0.2
Precision: 0.1917808219178082
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[10 50]
 [ 2 13]]
F1: 0.3333333333333333
AUC: 0.5498412698412698
Accuracy: 0.30666666666666664
Precision: 0.20634920634920634
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[20 40]
 [ 6  9]]
F1: 0.28125
AUC: 0.43183673469387757
Accuracy: 0.38666666666666666
Precision: 0.1836734693877551
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch3.xls...
Done.
Epoch: epoch4
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch4.xls...
Done.
Epoch: epoch4
Starting...
CM: [[ 1 59]
 [ 0 15]]
F1: 0.3370786516853933
AUC: 0.6013513513513513
Accuracy: 0.21333333333333335
Precision: 0.20270270270270271
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch4.xls...
Done.
Epoch: epoch4
Starting...
CM: [[ 5 55]
 [ 3 12]]
F1: 0.29268292682926833
AUC: 0.5095522388059702
Accuracy: 0.22666666666666666
Precision: 0.1791044776119403
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch4.xls...
Done.
Epoch: epoch6
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch6.xls...
Done.
Epoch: epoch6
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch6.xls...
Done.
Epoch: epoch6
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_0129__v32__class_weights/validation_sheet_epoch6.xls...
Done.
wandb: Waiting for W&B process to finish, PID 7877
wandb: Program ended successfully.
wandb: - 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: \ 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: | 0.08MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: - 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: | 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210527_012937-2ke28fzo/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210527_012937-2ke28fzo/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.85786
wandb:         val_accuracy 0.58456
wandb:             _runtime 18897
wandb:           _timestamp 1622097874
wandb:                _step 265
wandb:           train_loss 0.30451
wandb:             val_loss 0.93069
wandb:           val_recall 0.30275
wandb:        val_precision 0.18033
wandb:               val_f1 0.22603
wandb:              val_auc 0.18164
wandb:                   lr 0.0
wandb:          best_val_f1 0.30088
wandb:    best_val_accuracy 0.34651
wandb:   best_val_precision 0.19149
wandb:      best_val_recall 0.70183
wandb:             best_auc 0.17953
wandb:           best_epoch 11
wandb:           best_bd_f1 0.35714
wandb:          best_bd_auc 0.6087
wandb:     best_bd_accuracy 0.28
wandb:    best_bd_precision 0.21739
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch epoch11
wandb: Run history:
wandb:   train_accuracy ▁▁▂▂▂▃▃▄▄▅▆▆▇▇▇█████████████████████
wandb:     val_accuracy ██▄▂▄▁▇▅▃▄▂▄▆▇▄▅▅▅▆▅▅▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▇▇▇▇▇▆▆▆▅▄▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▃▅▃▅▁▃▆▅█▆▄▃▇▅▆▅▅▆▅▅▅▅▆▅▅▅▅▅▅▅▅▅▅▅
wandb:       val_recall ▁▁▅▇▆█▂▃▆▅▇▅▃▂▅▃▄▃▃▄▄▄▃▄▄▄▄▄▄▄▄▄▄▄▃▄
wandb:    val_precision ▁▁▇▇▇▇█▆▇▇▇▇▆▆▇▆▇▆▆▇▇▇▆▇▇▇▇▆▆▇▇▇▇▆▆▇
wandb:           val_f1 ▁▁▇███▄▆▇▇██▅▄█▆▇▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          val_auc ▃▁▅▃▅▃█▄▃▄▄▄▃▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:               lr ██████████▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 14 media file(s), 10 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2161: https://wandb.ai/arachid1/tensorboard-integration/runs/2ke28fzo


 See logs at ../../new_cache/conv__2161__05_0129__v32__class_weights/logs/