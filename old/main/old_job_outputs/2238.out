Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2238
Description:  newdata_pneumoniaonly
2021-06-22 16:18:31.717169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-22 16:18:33.936243: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-22 16:18:33.937141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-22 16:18:33.950260: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:33.951028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-22 16:18:33.951055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 16:18:33.954669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 16:18:33.954747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-22 16:18:33.955938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-22 16:18:33.956261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-22 16:18:33.957386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-22 16:18:33.958254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-22 16:18:33.958419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 16:18:33.958529: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:33.959306: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:33.959979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2238.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2238__06_1616__v39__newdata_pneumoniaonly
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 300, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-22 16:18:38.629883: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-22 16:18:38.630158: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:38.630933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-22 16:18:38.630987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 16:18:38.631054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 16:18:38.631076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-22 16:18:38.631097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-22 16:18:38.631117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-22 16:18:38.631138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-22 16:18:38.631157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-22 16:18:38.631176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 16:18:38.631265: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:38.632000: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:38.632689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-22 16:18:38.632743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 16:18:39.337463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-22 16:18:39.337511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-22 16:18:39.337520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-22 16:18:39.337843: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:39.338665: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:39.339431: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:18:39.340138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
ICBHI Pneumonia patients: 148, ICBHI Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2614
-----------------------
Number of train recordings: 2614 with pneumonia: 314 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3214
-----------------------
Number of train recordings: 3214 with pneumonia: 314 and non-pneumonia: 2900
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-22 16:18:40.609583: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-22 16:18:40.611362: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-22 16:18:40.958986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 16:18:42.744258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 16:18:43.192409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
201/201 - 290s - loss: 0.9296 - accuracy: 0.6217 - val_loss: 0.5968 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0794167755472958
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
201/201 - 284s - loss: 0.6753 - accuracy: 0.6210 - val_loss: 0.2739 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0904226204141782
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
201/201 - 286s - loss: 0.5464 - accuracy: 0.6571 - val_loss: 0.1848 - val_accuracy: 0.9366
Confusion matrix: 
 [[561  12]
 [ 27  15]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.643 0.357]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.48
Validation accuracy: 93.66
Validation recall: 35.71
Validation precision: 55.56
Validation AUC: 0.4880066098357963
Validation class accuracies: [0.9790575916230366, 0.35714285714285715]
Saving model...
Epoch 4/65
201/201 - 286s - loss: 0.5226 - accuracy: 0.7054 - val_loss: 0.5336 - val_accuracy: 0.7626
Confusion matrix: 
 [[430 143]
 [  3  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.75  0.25 ]
 [0.071 0.929]]
Validation f1: 34.82
Validation accuracy: 76.26
Validation recall: 92.86
Validation precision: 21.43
Validation AUC: 0.524187546060323
Validation class accuracies: [0.7504363001745201, 0.9285714285714286]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 1 epochs
Epoch 5/65
201/201 - 283s - loss: 0.4356 - accuracy: 0.7411 - val_loss: 0.7224 - val_accuracy: 0.7024
Confusion matrix: 
 [[394 179]
 [  4  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.688 0.312]
 [0.095 0.905]]
Validation f1: 29.34
Validation accuracy: 70.24
Validation recall: 90.48
Validation precision: 17.51
Validation AUC: 0.41341280251874707
Validation class accuracies: [0.68760907504363, 0.9047619047619048]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 2 epochs
Epoch 6/65
201/201 - 283s - loss: 0.4458 - accuracy: 0.7663 - val_loss: 2.6614 - val_accuracy: 0.4504
Confusion matrix: 
 [[236 337]
 [  1  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.412 0.588]
 [0.024 0.976]]
Validation f1: 19.52
Validation accuracy: 45.04
Validation recall: 97.62
Validation precision: 10.85
Validation AUC: 0.558092209119429
Validation class accuracies: [0.4118673647469459, 0.9761904761904762]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 3 epochs
Epoch 7/65
201/201 - 284s - loss: 0.3979 - accuracy: 0.7810 - val_loss: 0.5118 - val_accuracy: 0.7870
Confusion matrix: 
 [[451 122]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.214 0.786]]
Validation f1: 33.50
Validation accuracy: 78.70
Validation recall: 78.57
Validation precision: 21.29
Validation AUC: 0.40496879006644076
Validation class accuracies: [0.787085514834206, 0.7857142857142857]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 4 epochs
Epoch 8/65
201/201 - 283s - loss: 0.3701 - accuracy: 0.8077 - val_loss: 0.7429 - val_accuracy: 0.7431
Confusion matrix: 
 [[422 151]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.736 0.264]
 [0.167 0.833]]
Validation f1: 30.70
Validation accuracy: 74.31
Validation recall: 83.33
Validation precision: 18.82
Validation AUC: 0.556812622942248
Validation class accuracies: [0.7364746945898778, 0.8333333333333334]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 5 epochs
Epoch 9/65
201/201 - 283s - loss: 0.3548 - accuracy: 0.8065 - val_loss: 0.4559 - val_accuracy: 0.8358
Confusion matrix: 
 [[481  92]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.214 0.786]]
Validation f1: 39.52
Validation accuracy: 83.58
Validation recall: 78.57
Validation precision: 26.40
Validation AUC: 0.5364668301359331
Validation class accuracies: [0.8394415357766143, 0.7857142857142857]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 10/65
201/201 - 283s - loss: 0.2435 - accuracy: 0.8581 - val_loss: 0.2917 - val_accuracy: 0.9138
Confusion matrix: 
 [[532  41]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.286 0.714]]
Validation f1: 53.10
Validation accuracy: 91.38
Validation recall: 71.43
Validation precision: 42.25
Validation AUC: 0.6999883621599577
Validation class accuracies: [0.9284467713787086, 0.7142857142857143]
Saving model...
Epoch 11/65
201/201 - 284s - loss: 0.2133 - accuracy: 0.8886 - val_loss: 0.3653 - val_accuracy: 0.8520
Confusion matrix: 
 [[493  80]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86  0.14 ]
 [0.262 0.738]]
Validation f1: 40.52
Validation accuracy: 85.20
Validation recall: 73.81
Validation precision: 27.93
Validation AUC: 0.4604530864692234
Validation class accuracies: [0.8603839441535777, 0.7380952380952381]
The validation tracker metric at 0.5309734513274336 hasn't increased by 0 in 1 epochs
Epoch 12/65
201/201 - 283s - loss: 0.1562 - accuracy: 0.9129 - val_loss: 0.1754 - val_accuracy: 0.9350
Confusion matrix: 
 [[544  29]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.262 0.738]]
Validation f1: 60.78
Validation accuracy: 93.50
Validation recall: 73.81
Validation precision: 51.67
Validation AUC: 0.7754408657672455
Validation class accuracies: [0.9493891797556719, 0.7380952380952381]
Saving model...
Epoch 13/65
201/201 - 284s - loss: 0.1608 - accuracy: 0.9101 - val_loss: 0.6092 - val_accuracy: 0.7463
Confusion matrix: 
 [[424 149]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.74  0.26 ]
 [0.167 0.833]]
Validation f1: 30.97
Validation accuracy: 74.63
Validation recall: 83.33
Validation precision: 19.02
Validation AUC: 0.6934309024635457
Validation class accuracies: [0.7399650959860384, 0.8333333333333334]
The validation tracker metric at 0.607843137254902 hasn't increased by 0 in 1 epochs
Epoch 14/65
201/201 - 283s - loss: 0.1452 - accuracy: 0.9300 - val_loss: 0.1781 - val_accuracy: 0.9398
Confusion matrix: 
 [[553  20]
 [ 17  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.405 0.595]]
Validation f1: 57.47
Validation accuracy: 93.98
Validation recall: 59.52
Validation precision: 55.56
Validation AUC: 0.6729820969230828
Validation class accuracies: [0.9650959860383944, 0.5952380952380952]
The validation tracker metric at 0.607843137254902 hasn't increased by 0 in 2 epochs
Epoch 15/65
201/201 - 283s - loss: 0.1655 - accuracy: 0.9278 - val_loss: 0.2266 - val_accuracy: 0.9073
Confusion matrix: 
 [[526  47]
 [ 10  32]]
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.238 0.762]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.89
Validation accuracy: 90.73
Validation recall: 76.19
Validation precision: 40.51
Validation AUC: 0.7341082439467611
Validation class accuracies: [0.9179755671902269, 0.7619047619047619]
The validation tracker metric at 0.607843137254902 hasn't increased by 0 in 3 epochs
Epoch 16/65
201/201 - 283s - loss: 0.1046 - accuracy: 0.9499 - val_loss: 0.5383 - val_accuracy: 0.7902
Confusion matrix: 
 [[452 121]
 [  8  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.19  0.81 ]]
Validation f1: 34.52
Validation accuracy: 79.02
Validation recall: 80.95
Validation precision: 21.94
Validation AUC: 0.6260186764018634
Validation class accuracies: [0.7888307155322862, 0.8095238095238095]
The validation tracker metric at 0.607843137254902 hasn't increased by 0 in 4 epochs
Epoch 17/65
201/201 - 283s - loss: 0.1019 - accuracy: 0.9508 - val_loss: 0.1686 - val_accuracy: 0.9659
Confusion matrix: 
 [[567   6]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.357 0.643]]
Validation f1: 72.00
Validation accuracy: 96.59
Validation recall: 64.29
Validation precision: 81.82
Validation AUC: 0.7214765319592054
Validation class accuracies: [0.9895287958115183, 0.6428571428571429]
Saving model...
Epoch 18/65
201/201 - 283s - loss: 0.1322 - accuracy: 0.9393 - val_loss: 1.5474 - val_accuracy: 0.5285
Confusion matrix: 
 [[289 284]
 [  6  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.504 0.496]
 [0.143 0.857]]
Validation f1: 19.89
Validation accuracy: 52.85
Validation recall: 85.71
Validation precision: 11.25
Validation AUC: 0.27116257385246617
Validation class accuracies: [0.5043630017452007, 0.8571428571428571]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 1 epochs
Epoch 19/65
201/201 - 283s - loss: 0.0870 - accuracy: 0.9589 - val_loss: 0.1759 - val_accuracy: 0.9366
Confusion matrix: 
 [[546  27]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.286 0.714]]
Validation f1: 60.61
Validation accuracy: 93.66
Validation recall: 71.43
Validation precision: 52.63
Validation AUC: 0.7665733677730916
Validation class accuracies: [0.9528795811518325, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 2 epochs
Epoch 20/65
201/201 - 283s - loss: 0.0556 - accuracy: 0.9745 - val_loss: 0.1711 - val_accuracy: 0.9561
Confusion matrix: 
 [[557  16]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.262 0.738]]
Validation f1: 69.66
Validation accuracy: 95.61
Validation recall: 73.81
Validation precision: 65.96
Validation AUC: 0.7601584895873996
Validation class accuracies: [0.9720767888307156, 0.7380952380952381]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 3 epochs
Epoch 21/65
201/201 - 284s - loss: 0.0842 - accuracy: 0.9624 - val_loss: 1.6109 - val_accuracy: 0.6618
Confusion matrix: 
 [[370 203]
 [  5  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.646 0.354]
 [0.119 0.881]]
Validation f1: 26.24
Validation accuracy: 66.18
Validation recall: 88.10
Validation precision: 15.42
Validation AUC: 0.6612321730269253
Validation class accuracies: [0.6457242582897034, 0.8809523809523809]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 4 epochs
Epoch 22/65
201/201 - 283s - loss: 0.0377 - accuracy: 0.9810 - val_loss: 0.1934 - val_accuracy: 0.9350
Confusion matrix: 
 [[551  22]
 [ 18  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.429 0.571]]
Validation f1: 54.55
Validation accuracy: 93.50
Validation recall: 57.14
Validation precision: 52.17
Validation AUC: 0.6466531357287421
Validation class accuracies: [0.9616055846422339, 0.5714285714285714]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 5 epochs
Epoch 23/65
201/201 - 284s - loss: 0.0753 - accuracy: 0.9676 - val_loss: 0.3702 - val_accuracy: 0.8780
Confusion matrix: 
 [[507  66]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.214 0.786]]
Validation f1: 46.81
Validation accuracy: 87.80
Validation recall: 78.57
Validation precision: 33.33
Validation AUC: 0.7220346226068127
Validation class accuracies: [0.8848167539267016, 0.7857142857142857]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 24/65
201/201 - 282s - loss: 0.0291 - accuracy: 0.9860 - val_loss: 0.3143 - val_accuracy: 0.8976
Confusion matrix: 
 [[522  51]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.286 0.714]]
Validation f1: 48.78
Validation accuracy: 89.76
Validation recall: 71.43
Validation precision: 37.04
Validation AUC: 0.6779661906468242
Validation class accuracies: [0.9109947643979057, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 7 epochs
Epoch 25/65
201/201 - 282s - loss: 0.0312 - accuracy: 0.9872 - val_loss: 0.2362 - val_accuracy: 0.9171
Confusion matrix: 
 [[534  39]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.286 0.714]]
Validation f1: 54.05
Validation accuracy: 91.71
Validation recall: 71.43
Validation precision: 43.48
Validation AUC: 0.7004806309715099
Validation class accuracies: [0.9319371727748691, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 8 epochs
Epoch 26/65
201/201 - 282s - loss: 0.0205 - accuracy: 0.9925 - val_loss: 0.2070 - val_accuracy: 0.9366
Confusion matrix: 
 [[546  27]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.61
Validation accuracy: 93.66
Validation recall: 71.43
Validation precision: 52.63
Validation AUC: 0.7206941428940224
Validation class accuracies: [0.9528795811518325, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 9 epochs
Epoch 27/65
201/201 - 282s - loss: 0.0228 - accuracy: 0.9938 - val_loss: 0.2265 - val_accuracy: 0.9285
Confusion matrix: 
 [[542  31]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.31  0.69 ]]
Validation f1: 56.86
Validation accuracy: 92.85
Validation recall: 69.05
Validation precision: 48.33
Validation AUC: 0.7017657598428217
Validation class accuracies: [0.9458987783595113, 0.6904761904761905]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 10 epochs
Epoch 28/65
201/201 - 283s - loss: 0.0152 - accuracy: 0.9966 - val_loss: 0.2878 - val_accuracy: 0.9252
Confusion matrix: 
 [[539  34]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.286 0.714]]
Validation f1: 56.60
Validation accuracy: 92.52
Validation recall: 71.43
Validation precision: 46.88
Validation AUC: 0.7244633713640661
Validation class accuracies: [0.9406631762652705, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 11 epochs
Epoch 29/65
201/201 - 283s - loss: 0.0191 - accuracy: 0.9932 - val_loss: 0.2384 - val_accuracy: 0.9480
Confusion matrix: 
 [[556  17]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.357 0.643]]
Validation f1: 62.79
Validation accuracy: 94.80
Validation recall: 64.29
Validation precision: 61.36
Validation AUC: 0.6717313423802824
Validation class accuracies: [0.9703315881326352, 0.6428571428571429]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 30/65
201/201 - 283s - loss: 0.0124 - accuracy: 0.9956 - val_loss: 0.2568 - val_accuracy: 0.9317
Confusion matrix: 
 [[544  29]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.31  0.69 ]]
Validation f1: 58.00
Validation accuracy: 93.17
Validation recall: 69.05
Validation precision: 50.00
Validation AUC: 0.6923183318066101
Validation class accuracies: [0.9493891797556719, 0.6904761904761905]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 13 epochs
Epoch 31/65
201/201 - 283s - loss: 0.0185 - accuracy: 0.9950 - val_loss: 0.2701 - val_accuracy: 0.9382
Confusion matrix: 
 [[547  26]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.286 0.714]]
Validation f1: 61.22
Validation accuracy: 93.82
Validation recall: 71.43
Validation precision: 53.57
Validation AUC: 0.6802918342669507
Validation class accuracies: [0.9546247818499127, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 14 epochs
Epoch 32/65
201/201 - 283s - loss: 0.0168 - accuracy: 0.9947 - val_loss: 0.3778 - val_accuracy: 0.8992
Confusion matrix: 
 [[523  50]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.286 0.714]]
Validation f1: 49.18
Validation accuracy: 89.92
Validation recall: 71.43
Validation precision: 37.50
Validation AUC: 0.6708538833808139
Validation class accuracies: [0.912739965095986, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 15 epochs
Epoch 33/65
201/201 - 283s - loss: 0.0135 - accuracy: 0.9960 - val_loss: 0.2529 - val_accuracy: 0.9285
Confusion matrix: 
 [[541  32]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.286 0.714]]
Validation f1: 57.69
Validation accuracy: 92.85
Validation recall: 71.43
Validation precision: 48.39
Validation AUC: 0.6989755683904151
Validation class accuracies: [0.944153577661431, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 16 epochs
Epoch 34/65
201/201 - 283s - loss: 0.0102 - accuracy: 0.9978 - val_loss: 0.2193 - val_accuracy: 0.9415
Confusion matrix: 
 [[551  22]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.333 0.667]]
Validation f1: 60.87
Validation accuracy: 94.15
Validation recall: 66.67
Validation precision: 56.00
Validation AUC: 0.6996701281207619
Validation class accuracies: [0.9616055846422339, 0.6666666666666666]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 17 epochs
Epoch 35/65
201/201 - 284s - loss: 0.0148 - accuracy: 0.9960 - val_loss: 0.2624 - val_accuracy: 0.9285
Confusion matrix: 
 [[541  32]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.69
Validation accuracy: 92.85
Validation recall: 71.43
Validation precision: 48.39
Validation AUC: 0.6849115740669385
Validation class accuracies: [0.944153577661431, 0.7142857142857143]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 36/65
201/201 - 283s - loss: 0.0088 - accuracy: 0.9978 - val_loss: 0.2270 - val_accuracy: 0.9382
Confusion matrix: 
 [[549  24]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.333 0.667]]
Validation f1: 59.57
Validation accuracy: 93.82
Validation recall: 66.67
Validation precision: 53.85
Validation AUC: 0.6892679407121958
Validation class accuracies: [0.9581151832460733, 0.6666666666666666]
The validation tracker metric at 0.7200000000000001 hasn't increased by 0 in 19 epochs
Epoch 37/65
201/201 - 284s - loss: 0.0096 - accuracy: 0.9988 - val_loss: 0.2428 - val_accuracy: 0.9366
Confusion matrix: 
 [[548  25]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.333 0.667]]
Validation f1: 58.95
Validation accuracy: 93.66
Validation recall: 66.67
Validation precision: 52.83
Validation AUC: 0.6872741787243826
Validation class accuracies: [0.956369982547993, 0.6666666666666666]

The metrics for job 0 with the best target metric are: 
Best cm: [[567   6]
 [ 15  27]]
Best normalized cm: [[0.99  0.01 ]
 [0.357 0.643]]
Best f1: 0.72
Best accuracy: 0.97
Best recall: 0.64
Best precision: 0.82
Best AUC: 0.72
Best class accuracies: [0.9895287958115183, 0.6428571428571429]
Best epoch: 17
The number of epochs since last 1% equals the patience
-----------------------
Model 9 with new params
Changing augmentation to v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 300, 'WAV_PATH': 'v43'}
Collecting Variables...
All variables have been collected.
ICBHI Pneumonia patients: 148, ICBHI Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2614
-----------------------
Number of train recordings: 2614 with pneumonia: 314 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3214
-----------------------
Number of train recordings: 3214 with pneumonia: 314 and non-pneumonia: 2900
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 64, 625, 48)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 64, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 32, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 16, 156, 128)    91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 8, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 4, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
201/201 - 282s - loss: 0.9686 - accuracy: 0.6497 - val_loss: 0.7071 - val_accuracy: 0.0683
Confusion matrix: 
 [[  0 573]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.79
Validation accuracy: 6.83
Validation recall: 100.00
Validation precision: 6.83
Validation AUC: 0.08924715750856357
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
201/201 - 283s - loss: 0.5059 - accuracy: 0.7517 - val_loss: 0.3817 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06862337631162053
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.1278538812785388 hasn't increased by 0 in 1 epochs
Epoch 3/65
201/201 - 284s - loss: 0.5046 - accuracy: 0.7866 - val_loss: 0.1989 - val_accuracy: 0.9333
Confusion matrix: 
 [[573   0]
 [ 41   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.976 0.024]]
Validation f1: 4.65
Validation accuracy: 93.33
Validation recall: 2.38
Validation precision: 100.00
Validation AUC: 0.510586772956476
Validation class accuracies: [1.0, 0.023809523809523808]
The validation tracker metric at 0.1278538812785388 hasn't increased by 0 in 2 epochs
Epoch 4/65
201/201 - 284s - loss: 0.4344 - accuracy: 0.8015 - val_loss: 0.5056 - val_accuracy: 0.8098
Confusion matrix: 
 [[468 105]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.286 0.714]]
Validation f1: 33.90
Validation accuracy: 80.98
Validation recall: 71.43
Validation precision: 22.22
Validation AUC: 0.645773261787397
Validation class accuracies: [0.8167539267015707, 0.7142857142857143]
Saving model...
Epoch 5/65
201/201 - 284s - loss: 0.3948 - accuracy: 0.8205 - val_loss: 0.3861 - val_accuracy: 0.8065
Confusion matrix: 
 [[475  98]
 [ 21  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.5   0.5  ]]
Validation f1: 26.09
Validation accuracy: 80.65
Validation recall: 50.00
Validation precision: 17.65
Validation AUC: 0.1650546073172453
Validation class accuracies: [0.8289703315881326, 0.5]
The validation tracker metric at 0.3389830508474576 hasn't increased by 0 in 1 epochs
Epoch 6/65
201/201 - 284s - loss: 0.3826 - accuracy: 0.8320 - val_loss: 1.4338 - val_accuracy: 0.6455
Confusion matrix: 
 [[356 217]
 [  1  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.621 0.379]
 [0.024 0.976]]
Validation f1: 27.33
Validation accuracy: 64.55
Validation recall: 97.62
Validation precision: 15.89
Validation AUC: 0.5629716306964815
Validation class accuracies: [0.6212914485165794, 0.9761904761904762]
The validation tracker metric at 0.3389830508474576 hasn't increased by 0 in 2 epochs
Epoch 7/65
201/201 - 284s - loss: 0.3139 - accuracy: 0.8447 - val_loss: 1.1264 - val_accuracy: 0.6602
Confusion matrix: 
 [[373 200]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.651 0.349]
 [0.214 0.786]]
Validation f1: 24.00
Validation accuracy: 66.02
Validation recall: 78.57
Validation precision: 14.16
Validation AUC: 0.523830467868098
Validation class accuracies: [0.6509598603839442, 0.7857142857142857]
The validation tracker metric at 0.3389830508474576 hasn't increased by 0 in 3 epochs
Epoch 8/65
201/201 - 284s - loss: 0.2435 - accuracy: 0.8802 - val_loss: 0.9483 - val_accuracy: 0.7122
Confusion matrix: 
 [[408 165]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.712 0.288]
 [0.286 0.714]]
Validation f1: 25.32
Validation accuracy: 71.22
Validation recall: 71.43
Validation precision: 15.38
Validation AUC: 0.34679353703750926
Validation class accuracies: [0.7120418848167539, 0.7142857142857143]
The validation tracker metric at 0.3389830508474576 hasn't increased by 0 in 4 epochs
Epoch 9/65
201/201 - 284s - loss: 0.2200 - accuracy: 0.8983 - val_loss: 0.5513 - val_accuracy: 0.8341
Confusion matrix: 
 [[483  90]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.286 0.714]]
Validation f1: 37.04
Validation accuracy: 83.41
Validation recall: 71.43
Validation precision: 25.00
Validation AUC: 0.5866428634005211
Validation class accuracies: [0.8429319371727748, 0.7142857142857143]
Saving model...
Epoch 10/65
201/201 - 284s - loss: 0.2008 - accuracy: 0.9073 - val_loss: 1.7369 - val_accuracy: 0.5236
Confusion matrix: 
 [[284 289]
 [  4  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.496 0.504]
 [0.095 0.905]]
Validation f1: 20.60
Validation accuracy: 52.36
Validation recall: 90.48
Validation precision: 11.62
Validation AUC: 0.6458169259066978
Validation class accuracies: [0.4956369982547993, 0.9047619047619048]
The validation tracker metric at 0.37037037037037035 hasn't increased by 0 in 1 epochs
Epoch 11/65
201/201 - 284s - loss: 0.1770 - accuracy: 0.9241 - val_loss: 0.4216 - val_accuracy: 0.8813
Confusion matrix: 
 [[512  61]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.286 0.714]]
Validation f1: 45.11
Validation accuracy: 88.13
Validation recall: 71.43
Validation precision: 32.97
Validation AUC: 0.6254405046353948
Validation class accuracies: [0.893542757417103, 0.7142857142857143]
Saving model...
Epoch 12/65
201/201 - 284s - loss: 0.1321 - accuracy: 0.9428 - val_loss: 1.5981 - val_accuracy: 0.7106
Confusion matrix: 
 [[402 171]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.702 0.298]
 [0.167 0.833]]
Validation f1: 28.23
Validation accuracy: 71.06
Validation recall: 83.33
Validation precision: 16.99
Validation AUC: 0.5964725276615241
Validation class accuracies: [0.7015706806282722, 0.8333333333333334]
The validation tracker metric at 0.45112781954887216 hasn't increased by 0 in 1 epochs
Epoch 13/65
201/201 - 284s - loss: 0.1733 - accuracy: 0.9207 - val_loss: 9.8085 - val_accuracy: 0.1268
Confusion matrix: 
 [[ 36 537]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.063 0.937]
 [0.    1.   ]]
Validation f1: 13.53
Validation accuracy: 12.68
Validation recall: 100.00
Validation precision: 7.25
Validation AUC: 0.2983347065613314
Validation class accuracies: [0.06282722513089005, 1.0]
The validation tracker metric at 0.45112781954887216 hasn't increased by 0 in 2 epochs
Epoch 14/65
201/201 - 284s - loss: 0.1224 - accuracy: 0.9468 - val_loss: 0.4678 - val_accuracy: 0.8520
Confusion matrix: 
 [[492  81]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.238 0.762]]
Validation f1: 41.29
Validation accuracy: 85.20
Validation recall: 76.19
Validation precision: 28.32
Validation AUC: 0.6797446552055092
Validation class accuracies: [0.8586387434554974, 0.7619047619047619]
The validation tracker metric at 0.45112781954887216 hasn't increased by 0 in 3 epochs
Epoch 15/65
201/201 - 284s - loss: 0.0988 - accuracy: 0.9580 - val_loss: 3.5107 - val_accuracy: 0.4699
Confusion matrix: 
 [[253 320]
 [  6  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.442 0.558]
 [0.143 0.857]]
Validation f1: 18.09
Validation accuracy: 46.99
Validation recall: 85.71
Validation precision: 10.11
Validation AUC: 0.45714100830912735
Validation class accuracies: [0.44153577661431065, 0.8571428571428571]
The validation tracker metric at 0.45112781954887216 hasn't increased by 0 in 4 epochs
Epoch 16/65
201/201 - 284s - loss: 0.1577 - accuracy: 0.9272 - val_loss: 1.1653 - val_accuracy: 0.6943
Confusion matrix: 
 [[395 178]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.689 0.311]
 [0.238 0.762]]
Validation f1: 25.40
Validation accuracy: 69.43
Validation recall: 76.19
Validation precision: 15.24
Validation AUC: 0.6949125212160472
Validation class accuracies: [0.6893542757417103, 0.7619047619047619]
The validation tracker metric at 0.45112781954887216 hasn't increased by 0 in 5 epochs
Epoch 17/65
201/201 - 284s - loss: 0.0996 - accuracy: 0.9540 - val_loss: 0.2848 - val_accuracy: 0.9431
Confusion matrix: 
 [[550  23]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.286 0.714]]
Validation f1: 63.16
Validation accuracy: 94.31
Validation recall: 71.43
Validation precision: 56.60
Validation AUC: 0.6409684189315181
Validation class accuracies: [0.9598603839441536, 0.7142857142857143]
Saving model...
Epoch 18/65
201/201 - 284s - loss: 0.1065 - accuracy: 0.9592 - val_loss: 14.5898 - val_accuracy: 0.1187
Confusion matrix: 
 [[ 31 542]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.054 0.946]
 [0.    1.   ]]
Validation f1: 13.42
Validation accuracy: 11.87
Validation recall: 100.00
Validation precision: 7.19
Validation AUC: 0.4944024825518774
Validation class accuracies: [0.05410122164048865, 1.0]
The validation tracker metric at 0.631578947368421 hasn't increased by 0 in 1 epochs
Epoch 19/65
201/201 - 284s - loss: 0.0926 - accuracy: 0.9602 - val_loss: 1.1755 - val_accuracy: 0.7236
Confusion matrix: 
 [[411 162]
 [  8  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.717 0.283]
 [0.19  0.81 ]]
Validation f1: 28.57
Validation accuracy: 72.36
Validation recall: 80.95
Validation precision: 17.35
Validation AUC: 0.6252873864124735
Validation class accuracies: [0.7172774869109948, 0.8095238095238095]
The validation tracker metric at 0.631578947368421 hasn't increased by 0 in 2 epochs
Epoch 20/65
201/201 - 284s - loss: 0.0877 - accuracy: 0.9645 - val_loss: 1.5304 - val_accuracy: 0.6927
Confusion matrix: 
 [[394 179]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.688 0.312]
 [0.238 0.762]]
Validation f1: 25.30
Validation accuracy: 69.27
Validation recall: 76.19
Validation precision: 15.17
Validation AUC: 0.5028446500822795
Validation class accuracies: [0.68760907504363, 0.7619047619047619]
The validation tracker metric at 0.631578947368421 hasn't increased by 0 in 3 epochs
Epoch 21/65
201/201 - 284s - loss: 0.0919 - accuracy: 0.9589 - val_loss: 1.6915 - val_accuracy: 0.6049
Confusion matrix: 
 [[339 234]
 [  9  33]]
Normalized Confusion matrix: 
 [[0.592 0.408]
 [0.214 0.786]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.36
Validation accuracy: 60.49
Validation recall: 78.57
Validation precision: 12.36
Validation AUC: 0.6125589374652458
Validation class accuracies: [0.5916230366492147, 0.7857142857142857]
The validation tracker metric at 0.631578947368421 hasn't increased by 0 in 4 epochs
Epoch 22/65
201/201 - 284s - loss: 0.0706 - accuracy: 0.9689 - val_loss: 1.4068 - val_accuracy: 0.7268
Confusion matrix: 
 [[416 157]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.262 0.738]]
Validation f1: 26.96
Validation accuracy: 72.68
Validation recall: 73.81
Validation precision: 16.49
Validation AUC: 0.5488039120526561
Validation class accuracies: [0.7260034904013961, 0.7380952380952381]
The validation tracker metric at 0.631578947368421 hasn't increased by 0 in 5 epochs
Epoch 23/65
201/201 - 284s - loss: 0.0680 - accuracy: 0.9748 - val_loss: 0.3642 - val_accuracy: 0.8992
Confusion matrix: 
 [[523  50]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.18
Validation accuracy: 89.92
Validation recall: 71.43
Validation precision: 37.50
Validation AUC: 0.5474703662393647
Validation class accuracies: [0.912739965095986, 0.7142857142857143]
The validation tracker metric at 0.631578947368421 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 24/65
201/201 - 284s - loss: 0.0323 - accuracy: 0.9863 - val_loss: 0.2760 - val_accuracy: 0.9382
Confusion matrix: 
 [[550  23]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.357 0.643]]
Validation f1: 58.70
Validation accuracy: 93.82
Validation recall: 64.29
Validation precision: 54.00
Validation AUC: 0.5939230464347055
Validation class accuracies: [0.9598603839441536, 0.6428571428571429]
The validation tracker metric at 0.631578947368421 hasn't increased by 0 in 7 epochs
Epoch 25/65
201/201 - 285s - loss: 0.0375 - accuracy: 0.9851 - val_loss: 0.4988 - val_accuracy: 0.8715
Confusion matrix: 
 [[506  67]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.286 0.714]]
Validation f1: 43.17
Validation accuracy: 87.15
Validation recall: 71.43
Validation precision: 30.93
Validation AUC: 0.5800492327444985
Validation class accuracies: [0.8830715532286213, 0.7142857142857143]
The validation tracker metric at 0.631578947368421 hasn't increased by 0 in 8 epochs
Epoch 26/65
201/201 - 286s - loss: 0.0175 - accuracy: 0.9941 - val_loss: 0.2481 - val_accuracy: 0.9528
Confusion matrix: 
 [[559  14]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.357 0.643]]
Validation f1: 65.06
Validation accuracy: 95.28
Validation recall: 64.29
Validation precision: 65.85
Validation AUC: 0.6277141426396804
Validation class accuracies: [0.9755671902268761, 0.6428571428571429]
Saving model...
Epoch 27/65
201/201 - 286s - loss: 0.0177 - accuracy: 0.9947 - val_loss: 0.3716 - val_accuracy: 0.9268
Confusion matrix: 
 [[542  31]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.333 0.667]]
Validation f1: 55.45
Validation accuracy: 92.68
Validation recall: 66.67
Validation precision: 47.46
Validation AUC: 0.5756760384549311
Validation class accuracies: [0.9458987783595113, 0.6666666666666666]
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 1 epochs
Epoch 28/65
201/201 - 286s - loss: 0.0354 - accuracy: 0.9860 - val_loss: 0.2931 - val_accuracy: 0.9447
Confusion matrix: 
 [[551  22]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.286 0.714]]
Validation f1: 63.83
Validation accuracy: 94.47
Validation recall: 71.43
Validation precision: 57.69
Validation AUC: 0.6868517895811685
Validation class accuracies: [0.9616055846422339, 0.7142857142857143]
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 2 epochs
Epoch 29/65
201/201 - 286s - loss: 0.0217 - accuracy: 0.9907 - val_loss: 0.2611 - val_accuracy: 0.9496
Confusion matrix: 
 [[555  18]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.31  0.69 ]]
Validation f1: 65.17
Validation accuracy: 94.96
Validation recall: 69.05
Validation precision: 61.70
Validation AUC: 0.6621154452722822
Validation class accuracies: [0.9685863874345549, 0.6904761904761905]
Saving model...
Epoch 30/65
201/201 - 286s - loss: 0.0483 - accuracy: 0.9820 - val_loss: 0.3516 - val_accuracy: 0.9317
Confusion matrix: 
 [[546  27]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.357 0.643]]
Validation f1: 56.25
Validation accuracy: 93.17
Validation recall: 64.29
Validation precision: 50.00
Validation AUC: 0.586475204063388
Validation class accuracies: [0.9528795811518325, 0.6428571428571429]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 1 epochs
Epoch 31/65
201/201 - 285s - loss: 0.0161 - accuracy: 0.9925 - val_loss: 0.3164 - val_accuracy: 0.9366
Confusion matrix: 
 [[548  25]
 [ 14  28]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.333 0.667]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.95
Validation accuracy: 93.66
Validation recall: 66.67
Validation precision: 52.83
Validation AUC: 0.6535005528587757
Validation class accuracies: [0.956369982547993, 0.6666666666666666]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 2 epochs
Epoch 32/65
201/201 - 283s - loss: 0.0134 - accuracy: 0.9944 - val_loss: 0.3449 - val_accuracy: 0.9382
Confusion matrix: 
 [[548  25]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.31  0.69 ]]
Validation f1: 60.42
Validation accuracy: 93.82
Validation recall: 69.05
Validation precision: 53.70
Validation AUC: 0.6395957469048339
Validation class accuracies: [0.956369982547993, 0.6904761904761905]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 3 epochs
Epoch 33/65
201/201 - 283s - loss: 0.0186 - accuracy: 0.9932 - val_loss: 0.5154 - val_accuracy: 0.8959
Confusion matrix: 
 [[522  51]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.31  0.69 ]]
Validation f1: 47.54
Validation accuracy: 89.59
Validation recall: 69.05
Validation precision: 36.25
Validation AUC: 0.605801825537466
Validation class accuracies: [0.9109947643979057, 0.6904761904761905]
The validation tracker metric at 0.651685393258427 hasn't increased by 0 in 4 epochs
Epoch 34/65
201/201 - 283s - loss: 0.0103 - accuracy: 0.9969 - val_loss: 0.2441 - val_accuracy: 0.9593
Confusion matrix: 
 [[561  12]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.31  0.69 ]]
Validation f1: 69.88
Validation accuracy: 95.93
Validation recall: 69.05
Validation precision: 70.73
Validation AUC: 0.6872822659920722
Validation class accuracies: [0.9790575916230366, 0.6904761904761905]
Saving model...
Epoch 35/65
201/201 - 283s - loss: 0.0077 - accuracy: 0.9981 - val_loss: 0.2958 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.31  0.69 ]]
Validation f1: 63.74
Validation accuracy: 94.63
Validation recall: 69.05
Validation precision: 59.18
Validation AUC: 0.6644510962351075
Validation class accuracies: [0.9650959860383944, 0.6904761904761905]
The validation tracker metric at 0.6987951807228916 hasn't increased by 0 in 1 epochs
Epoch 36/65
201/201 - 283s - loss: 0.0064 - accuracy: 0.9994 - val_loss: 0.3351 - val_accuracy: 0.9333
Confusion matrix: 
 [[545  28]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.31  0.69 ]]
Validation f1: 58.59
Validation accuracy: 93.33
Validation recall: 69.05
Validation precision: 50.88
Validation AUC: 0.654728664811283
Validation class accuracies: [0.9511343804537522, 0.6904761904761905]
The validation tracker metric at 0.6987951807228916 hasn't increased by 0 in 2 epochs
Epoch 37/65
201/201 - 283s - loss: 0.0096 - accuracy: 0.9975 - val_loss: 0.4305 - val_accuracy: 0.9252
Confusion matrix: 
 [[540  33]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.31  0.69 ]]
Validation f1: 55.77
Validation accuracy: 92.52
Validation recall: 69.05
Validation precision: 46.77
Validation AUC: 0.6342757401381734
Validation class accuracies: [0.9424083769633508, 0.6904761904761905]
The validation tracker metric at 0.6987951807228916 hasn't increased by 0 in 3 epochs
Epoch 38/65
201/201 - 283s - loss: 0.0044 - accuracy: 0.9997 - val_loss: 0.3081 - val_accuracy: 0.9528
Confusion matrix: 
 [[557  16]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.31  0.69 ]]
Validation f1: 66.67
Validation accuracy: 95.28
Validation recall: 69.05
Validation precision: 64.44
Validation AUC: 0.654566377604918
Validation class accuracies: [0.9720767888307156, 0.6904761904761905]
The validation tracker metric at 0.6987951807228916 hasn't increased by 0 in 4 epochs
Epoch 39/65
201/201 - 283s - loss: 0.0087 - accuracy: 0.9972 - val_loss: 0.3237 - val_accuracy: 0.9447
Confusion matrix: 
 [[551  22]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.83
Validation accuracy: 94.47
Validation recall: 71.43
Validation precision: 57.69
Validation AUC: 0.6629698446066684
Validation class accuracies: [0.9616055846422339, 0.7142857142857143]
The validation tracker metric at 0.6987951807228916 hasn't increased by 0 in 5 epochs
Epoch 40/65
201/201 - 283s - loss: 0.0058 - accuracy: 0.9988 - val_loss: 0.3172 - val_accuracy: 0.9496
Confusion matrix: 
 [[555  18]
 [ 13  29]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.31  0.69 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 65.17
Validation accuracy: 94.96
Validation recall: 69.05
Validation precision: 61.70
Validation AUC: 0.6766758619415408
Validation class accuracies: [0.9685863874345549, 0.6904761904761905]
The validation tracker metric at 0.6987951807228916 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 41/65
201/201 - 283s - loss: 0.0051 - accuracy: 0.9981 - val_loss: 0.2747 - val_accuracy: 0.9593
Confusion matrix: 
 [[560  13]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.286 0.714]]
Validation f1: 70.59
Validation accuracy: 95.93
Validation recall: 71.43
Validation precision: 69.77
Validation AUC: 0.6996237026447153
Validation class accuracies: [0.9773123909249564, 0.7142857142857143]
Saving model...
Epoch 42/65
201/201 - 283s - loss: 0.0026 - accuracy: 1.0000 - val_loss: 0.3486 - val_accuracy: 0.9431
Confusion matrix: 
 [[550  23]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.16
Validation accuracy: 94.31
Validation recall: 71.43
Validation precision: 56.60
Validation AUC: 0.6890020395777969
Validation class accuracies: [0.9598603839441536, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 1 epochs
Epoch 43/65
201/201 - 283s - loss: 0.0023 - accuracy: 0.9994 - val_loss: 0.3392 - val_accuracy: 0.9447
Confusion matrix: 
 [[551  22]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.83
Validation accuracy: 94.47
Validation recall: 71.43
Validation precision: 57.69
Validation AUC: 0.7002787310068354
Validation class accuracies: [0.9616055846422339, 0.7142857142857143]
The validation tracker metric at 0.7058823529411765 hasn't increased by 0 in 2 epochs
Epoch 44/65
201/201 - 284s - loss: 0.0028 - accuracy: 0.9994 - val_loss: 0.3148 - val_accuracy: 0.9545
Confusion matrix: 
 [[557  16]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.286 0.714]]
Validation f1: 68.18
Validation accuracy: 95.45
Validation recall: 71.43
Validation precision: 65.22
Validation AUC: 0.6962809135833505
Validation class accuracies: [0.9720767888307156, 0.7142857142857143]
local_gc_exec.sh: line 6: 32626 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2238__06_1616__v39__newdata_pneumoniaonly/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
