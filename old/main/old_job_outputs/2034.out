Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2034
Description:  newmod10
2021-04-03 02:53:51.259198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-03 02:53:53.215948: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-03 02:53:53.216942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-03 02:53:53.255068: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.255756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-03 02:53:53.255791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-03 02:53:53.259227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-03 02:53:53.259292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-03 02:53:53.260450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-03 02:53:53.260791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-03 02:53:53.261947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-03 02:53:53.262841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-03 02:53:53.262996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-03 02:53:53.263099: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.263832: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.264404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-03 02:53:53.266522: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-03 02:53:53.266677: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.267258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-03 02:53:53.267286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-03 02:53:53.267319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-03 02:53:53.267376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-03 02:53:53.267405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-03 02:53:53.267425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-03 02:53:53.267456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-03 02:53:53.267475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-03 02:53:53.267503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-03 02:53:53.267575: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.268191: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.268748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-03 02:53:53.268790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-03 02:53:53.937526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-03 02:53:53.937580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-03 02:53:53.937591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-03 02:53:53.937889: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.938600: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.939208: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-03 02:53:53.939816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-04-03 02:53:54.403838: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-03 02:53:54.403874: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-03 02:53:54.403907: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-03 02:53:54.404113: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-03 02:53:54.404878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-03 02:53:54.595086: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-03 02:53:54.597725: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2034.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_0252___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___newmod10___2034/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 8) 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 8) 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 8) 584         conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 8) 1608        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 8) 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 24 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 24)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 24)  96          average_pooling2d[0][0]          
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 64, 625, 24)  600         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 64, 625, 24)  600         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 64, 625, 24)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 64, 625, 24)  5208        conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 64, 625, 24)  14424       conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 64, 625, 24)  600         max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 64, 625, 72)  0           conv2d_6[0][0]                   
                                                                 conv2d_8[0][0]                   
                                                                 conv2d_9[0][0]                   
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 313, 72)  0           concatenate_1[0][0]              
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 313, 72)  288         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 313, 72)  5256        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 313, 72)  5256        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 32, 313, 72)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 313, 72)  46728       conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 313, 72)  129672      conv2d_12[0][0]                  
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 313, 72)  5256        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 32, 313, 216) 0           conv2d_11[0][0]                  
                                                                 conv2d_13[0][0]                  
                                                                 conv2d_14[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 157, 216) 0           concatenate_2[0][0]              
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 157, 216) 864         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 16, 157, 216) 46872       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 16, 157, 216) 46872       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 16, 157, 216) 0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 16, 157, 216) 420120      conv2d_15[0][0]                  2021-04-03 02:53:55.240059: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-03 02:53:55.242424: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-03 02:53:57.188371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-03 02:53:58.691899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-03 02:53:58.711344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-03 02:54:06.816733: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-03 02:54:06.816775: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-03 02:54:07.522407: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-03 02:54:07.525575: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-03 02:54:07.565891: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 943 callback api events and 939 activity events. 
2021-04-03 02:54:07.605358: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.

__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 16, 157, 216) 1166616     conv2d_17[0][0]                  
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 16, 157, 216) 46872       max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 16, 157, 648) 0           conv2d_16[0][0]                  
                                                                 conv2d_18[0][0]                  
                                                                 conv2d_19[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 79, 648)   0           concatenate_3[0][0]              
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 79, 648)   2592        average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 79, 648)   420552      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 8, 79, 648)   420552      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 8, 79, 648)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 79, 648)   3779784     conv2d_20[0][0]                  
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 8, 79, 648)   10498248    conv2d_22[0][0]                  
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 8, 79, 648)   420552      max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 8, 79, 1944)  0           conv2d_21[0][0]                  
                                                                 conv2d_23[0][0]                  
                                                                 conv2d_24[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 40, 1944)  0           concatenate_4[0][0]              
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 40, 1944)  7776        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 1944)         0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            3890        global_average_pooling2d[0][0]   
==================================================================================================
Total params: 17,498,446
Trainable params: 17,492,632
Non-trainable params: 5,814
__________________________________________________________________________________________________
Epoch 1/40
872/872 - 308s - loss: 0.3286 - calc_accuracy: 0.6528 - val_loss: 0.6100 - val_calc_accuracy: 0.5448
Epoch 2/40
872/872 - 294s - loss: 0.2742 - calc_accuracy: 0.7152 - val_loss: 0.3953 - val_calc_accuracy: 0.6833
Epoch 3/40
872/872 - 293s - loss: 0.2511 - calc_accuracy: 0.7378 - val_loss: 0.4039 - val_calc_accuracy: 0.7147
Epoch 4/40
872/872 - 294s - loss: 0.2320 - calc_accuracy: 0.7571 - val_loss: 0.3298 - val_calc_accuracy: 0.7379
Epoch 5/40
872/872 - 294s - loss: 0.2129 - calc_accuracy: 0.7777 - val_loss: 0.3688 - val_calc_accuracy: 0.7541
Epoch 6/40
872/872 - 294s - loss: 0.1987 - calc_accuracy: 0.7945 - val_loss: 0.3128 - val_calc_accuracy: 0.7596
Epoch 7/40
872/872 - 294s - loss: 0.1803 - calc_accuracy: 0.8138 - val_loss: 0.3239 - val_calc_accuracy: 0.7608
Epoch 8/40
872/872 - 294s - loss: 0.1715 - calc_accuracy: 0.8256 - val_loss: 0.3319 - val_calc_accuracy: 0.7438
Epoch 9/40
872/872 - 293s - loss: 0.1565 - calc_accuracy: 0.8445 - val_loss: 0.2154 - val_calc_accuracy: 0.8516
Epoch 10/40
872/872 - 295s - loss: 0.1433 - calc_accuracy: 0.8556 - val_loss: 0.2452 - val_calc_accuracy: 0.8273
Epoch 11/40
872/872 - 295s - loss: 0.1344 - calc_accuracy: 0.8599 - val_loss: 0.2901 - val_calc_accuracy: 0.7929
Epoch 12/40
872/872 - 294s - loss: 0.1241 - calc_accuracy: 0.8728 - val_loss: 0.2129 - val_calc_accuracy: 0.8511

Epoch 00012: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 13/40
872/872 - 294s - loss: 0.1047 - calc_accuracy: 0.8942 - val_loss: 0.2402 - val_calc_accuracy: 0.8485
Epoch 14/40
872/872 - 294s - loss: 0.0892 - calc_accuracy: 0.9111 - val_loss: 0.4480 - val_calc_accuracy: 0.6908
Epoch 15/40
872/872 - 294s - loss: 0.0845 - calc_accuracy: 0.9109 - val_loss: 0.2769 - val_calc_accuracy: 0.8369

Epoch 00015: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 16/40
872/872 - 295s - loss: 0.0722 - calc_accuracy: 0.9276 - val_loss: 0.1982 - val_calc_accuracy: 0.8787
Epoch 17/40
872/872 - 296s - loss: 0.0598 - calc_accuracy: 0.9416 - val_loss: 0.2352 - val_calc_accuracy: 0.8597
Epoch 18/40
872/872 - 295s - loss: 0.0505 - calc_accuracy: 0.9492 - val_loss: 0.2421 - val_calc_accuracy: 0.8503
Epoch 19/40
872/872 - 294s - loss: 0.0465 - calc_accuracy: 0.9553 - val_loss: 0.2125 - val_calc_accuracy: 0.8783

Epoch 00019: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 20/40
872/872 - 296s - loss: 0.0378 - calc_accuracy: 0.9653 - val_loss: 0.2320 - val_calc_accuracy: 0.8552
Epoch 21/40
872/872 - 296s - loss: 0.0323 - calc_accuracy: 0.9719 - val_loss: 0.2221 - val_calc_accuracy: 0.8749
Epoch 22/40
872/872 - 295s - loss: 0.0300 - calc_accuracy: 0.9728 - val_loss: 0.2168 - val_calc_accuracy: 0.8812
Epoch 23/40
872/872 - 295s - loss: 0.0311 - calc_accuracy: 0.9710 - val_loss: 0.2337 - val_calc_accuracy: 0.8704
Epoch 24/40
872/872 - 294s - loss: 0.0282 - calc_accuracy: 0.9767 - val_loss: 0.3091 - val_calc_accuracy: 0.8244
Epoch 25/40
872/872 - 294s - loss: 0.0266 - calc_accuracy: 0.9772 - val_loss: 0.2344 - val_calc_accuracy: 0.8864
Epoch 00025: early stopping

 See logs at ../../cache/conv___04_0252___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___newmod10___2034/logs/