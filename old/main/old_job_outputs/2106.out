Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2106
Description:  mixednet_newparams
2021-05-08 22:53:07.871520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-08 22:53:10.179752: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-08 22:53:10.180704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-08 22:53:10.194620: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:10.195358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-08 22:53:10.195389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-08 22:53:10.199000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-08 22:53:10.199098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-08 22:53:10.200154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-08 22:53:10.200438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-08 22:53:10.201463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-08 22:53:10.202395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-08 22:53:10.202570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-08 22:53:10.202706: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:10.203575: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:10.204262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2106.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2106__05_2253__v29__mixednet_newparams/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 5, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run divine-haze-201
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2cfoh7qe
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210508_225310-2cfoh7qe
wandb: Run `wandb offline` to turn off syncing.
2021-05-08 22:53:15.404060: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-08 22:53:15.404334: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:15.405052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-08 22:53:15.405099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-08 22:53:15.405160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-08 22:53:15.405183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-08 22:53:15.405211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-08 22:53:15.405232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-08 22:53:15.405253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-08 22:53:15.405274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-08 22:53:15.405293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-08 22:53:15.405380: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:15.406165: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:15.406852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-08 22:53:15.406896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-08 22:53:16.152891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-08 22:53:16.152937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-08 22:53:16.152950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-08 22:53:16.153245: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:16.154150: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:16.154908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-08 22:53:16.155597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-08 22:53:52.699926: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-08 22:53:52.701807: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-08 22:53:54.316668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-08 22:53:55.010465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-08 22:53:55.018423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
263/263 - 152s - loss: 0.6764 - accuracy: 0.6180 - val_loss: 0.6348 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1873894748586646
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
263/263 - 145s - loss: 0.6623 - accuracy: 0.6356 - val_loss: 0.6003 - val_accuracy: 0.7877
Confusion matrix: 
 [[853  17]
 [214   4]]
Validation f1: 3.35
Validation accuracy: 78.77
Validation recall: 1.83
Validation precision: 19.05
Validation AUC: 0.19774605292073974
Validation class accuracies: [0.9804597701149426, 0.01834862385321101]
Epoch 3/40
263/263 - 145s - loss: 0.6424 - accuracy: 0.6592 - val_loss: 0.6088 - val_accuracy: 0.7307
Confusion matrix: 
 [[778  92]
 [201  17]]
Validation f1: 10.40
Validation accuracy: 73.07
Validation recall: 7.80
Validation precision: 15.60
Validation AUC: 0.20578569328569596
Validation class accuracies: [0.8942528735632184, 0.0779816513761468]
Epoch 4/40
263/263 - 146s - loss: 0.6258 - accuracy: 0.6663 - val_loss: 0.7170 - val_accuracy: 0.5542
Confusion matrix: 
 [[508 362]
 [123  95]]
Validation f1: 28.15
Validation accuracy: 55.42
Validation recall: 43.58
Validation precision: 20.79
Validation AUC: 0.21070243482763168
Validation class accuracies: [0.5839080459770115, 0.43577981651376146]
Epoch 5/40
263/263 - 147s - loss: 0.6021 - accuracy: 0.6942 - val_loss: 0.6573 - val_accuracy: 0.6893
Confusion matrix: 
 [[704 166]
 [172  46]]
Validation f1: 21.40
Validation accuracy: 68.93
Validation recall: 21.10
Validation precision: 21.70
Validation AUC: 0.21613846614257465
Validation class accuracies: [0.8091954022988506, 0.21100917431192662]
Saving model...
Epoch 6/40
263/263 - 147s - loss: 0.5702 - accuracy: 0.7178 - val_loss: 0.5659 - val_accuracy: 0.7960
Confusion matrix: 
 [[861   9]
 [213   5]]
Validation f1: 4.31
Validation accuracy: 79.60
Validation recall: 2.29
Validation precision: 35.71
Validation AUC: 0.20458468770864294
Validation class accuracies: [0.9896551724137931, 0.022935779816513763]
The validation tracker metric at 0.21395348837209302 hasn't increased by 0.01 in 1 epochs
Epoch 7/40
263/263 - 147s - loss: 0.5292 - accuracy: 0.7579 - val_loss: 0.5968 - val_accuracy: 0.7270
Confusion matrix: 
 [[755 115]
 [182  36]]
Validation f1: 19.51
Validation accuracy: 72.70
Validation recall: 16.51
Validation precision: 23.84
Validation AUC: 0.22921580735607813
Validation class accuracies: [0.867816091954023, 0.1651376146788991]
The validation tracker metric at 0.21395348837209302 hasn't increased by 0.01 in 2 epochs
Epoch 8/40
263/263 - 146s - loss: 0.4824 - accuracy: 0.7896 - val_loss: 0.6973 - val_accuracy: 0.6765
Confusion matrix: 
 [[687 183]
 [169  49]]
Validation f1: 21.78
Validation accuracy: 67.65
Validation recall: 22.48
Validation precision: 21.12
Validation AUC: 0.2105933166042497
Validation class accuracies: [0.7896551724137931, 0.22477064220183487]
The validation tracker metric at 0.21395348837209302 hasn't increased by 0.01 in 3 epochs
Saving model...
Epoch 9/40
263/263 - 146s - loss: 0.4183 - accuracy: 0.8286 - val_loss: 0.9035 - val_accuracy: 0.5294
Confusion matrix: 
 [[480 390]
 [122  96]]
Validation f1: 27.27
Validation accuracy: 52.94
Validation recall: 44.04
Validation precision: 19.75
Validation AUC: 0.2072094782661973
Validation class accuracies: [0.5517241379310345, 0.44036697247706424]
Saving model...
Epoch 10/40
263/263 - 152s - loss: 0.3671 - accuracy: 0.8575 - val_loss: 0.8178 - val_accuracy: 0.5892
Confusion matrix: 
 [[576 294]
 [153  65]]
Validation f1: 22.53
Validation accuracy: 58.92
Validation recall: 29.82
Validation precision: 18.11
Validation AUC: 0.2104543957561642
Validation class accuracies: [0.6620689655172414, 0.2981651376146789]
The validation tracker metric at 0.27272727272727276 hasn't increased by 0.01 in 1 epochs
Epoch 11/40
263/263 - 149s - loss: 0.3028 - accuracy: 0.8916 - val_loss: 0.7608 - val_accuracy: 0.6939
Confusion matrix: 
 [[714 156]
 [177  41]]
Validation f1: 19.76
Validation accuracy: 69.39
Validation recall: 18.81
Validation precision: 20.81
Validation AUC: 0.20821604388327075
Validation class accuracies: [0.8206896551724138, 0.18807339449541285]
The validation tracker metric at 0.27272727272727276 hasn't increased by 0.01 in 2 epochs
Epoch 12/40
263/263 - 152s - loss: 0.2618 - accuracy: 0.9087 - val_loss: 1.0229 - val_accuracy: 0.5303
Confusion matrix: 
 [[503 367]
 [144  74]]
Validation f1: 22.46
Validation accuracy: 53.03
Validation recall: 33.94
Validation precision: 16.78
Validation AUC: 0.19285286056844728
Validation class accuracies: [0.5781609195402299, 0.3394495412844037]
The validation tracker metric at 0.27272727272727276 hasn't increased by 0.01 in 3 epochs
Epoch 13/40
263/263 - 149s - loss: 0.2197 - accuracy: 0.9261 - val_loss: 1.5820 - val_accuracy: 0.4430
Confusion matrix: 
 [[345 525]
 [ 81 137]]
Validation f1: 31.14
Validation accuracy: 44.30
Validation recall: 62.84
Validation precision: 20.69
Validation AUC: 0.2281229448586714
Validation class accuracies: [0.39655172413793105, 0.6284403669724771]
Saving model...
Epoch 14/40
263/263 - 153s - loss: 0.1972 - accuracy: 0.9304 - val_loss: 2.3146 - val_accuracy: 0.2840
Confusion matrix: 
 [[136 734]
 [ 45 173]]
Validation f1: 30.76
Validation accuracy: 28.40
Validation recall: 79.36
Validation precision: 19.07
Validation AUC: 0.2192508909745784
Validation class accuracies: [0.15632183908045977, 0.7935779816513762]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 1 epochs
Epoch 15/40
263/263 - 151s - loss: 0.1559 - accuracy: 0.9557 - val_loss: 1.1525 - val_accuracy: 0.5579
Confusion matrix: 
 [[518 352]
 [129  89]]
Validation f1: 27.01
Validation accuracy: 55.79
Validation recall: 40.83
Validation precision: 20.18
Validation AUC: 0.21829379788283773
Validation class accuracies: [0.5954022988505747, 0.40825688073394495]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 2 epochs
Epoch 16/40
263/263 - 153s - loss: 0.1391 - accuracy: 0.9569 - val_loss: 1.0536 - val_accuracy: 0.6029
Confusion matrix: 
 [[597 273]
 [159  59]]
Validation f1: 21.45
Validation accuracy: 60.29
Validation recall: 27.06
Validation precision: 17.77
Validation AUC: 0.20429078194369293
Validation class accuracies: [0.6862068965517242, 0.2706422018348624]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 3 epochs
Epoch 17/40
263/263 - 152s - loss: 0.1211 - accuracy: 0.9676 - val_loss: 1.0022 - val_accuracy: 0.7426
Confusion matrix: 
 [[780  90]
 [190  28]]
Validation f1: 16.67
Validation accuracy: 74.26
Validation recall: 12.84
Validation precision: 23.73
Validation AUC: 0.21587311559703454
Validation class accuracies: [0.896551724137931, 0.12844036697247707]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 4 epochs
Epoch 18/40
263/263 - 153s - loss: 0.1146 - accuracy: 0.9645 - val_loss: 1.0466 - val_accuracy: 0.6388
Confusion matrix: 
 [[633 237]
 [156  62]]
Validation f1: 23.98
Validation accuracy: 63.88
Validation recall: 28.44
Validation precision: 20.74
Validation AUC: 0.22282846865769795
Validation class accuracies: [0.7275862068965517, 0.28440366972477066]
Lr has been adjusted to 0.0005000000237487257
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 5 epochs
Epoch 19/40
263/263 - 150s - loss: 0.0855 - accuracy: 0.9759 - val_loss: 1.4304 - val_accuracy: 0.5312
Confusion matrix: 
 [[493 377]
 [133  85]]
Validation f1: 25.00
Validation accuracy: 53.12
Validation recall: 38.99
Validation precision: 18.40
Validation AUC: 0.2218993369125506
Validation class accuracies: [0.5666666666666667, 0.38990825688073394]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 6 epochs
Epoch 20/40
263/263 - 153s - loss: 0.0774 - accuracy: 0.9812 - val_loss: 1.0958 - val_accuracy: 0.6406
Confusion matrix: 
 [[645 225]
 [166  52]]
Validation f1: 21.01
Validation accuracy: 64.06
Validation recall: 23.85
Validation precision: 18.77
Validation AUC: 0.21266971169928062
Validation class accuracies: [0.7413793103448276, 0.23853211009174313]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 7 epochs
Epoch 21/40
263/263 - 151s - loss: 0.0726 - accuracy: 0.9812 - val_loss: 1.2939 - val_accuracy: 0.5643
Confusion matrix: 
 [[533 337]
 [137  81]]
Validation f1: 25.47
Validation accuracy: 56.43
Validation recall: 37.16
Validation precision: 19.38
Validation AUC: 0.22141359092910154
Validation class accuracies: [0.6126436781609196, 0.37155963302752293]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 8 epochs
Epoch 22/40
263/263 - 150s - loss: 0.0681 - accuracy: 0.9840 - val_loss: 1.0520 - val_accuracy: 0.7086
Confusion matrix: 
 [[730 140]
 [177  41]]
Validation f1: 20.55
Validation accuracy: 70.86
Validation recall: 18.81
Validation precision: 22.65
Validation AUC: 0.21320999664836338
Validation class accuracies: [0.8390804597701149, 0.18807339449541285]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 9 epochs
Epoch 23/40
263/263 - 151s - loss: 0.0603 - accuracy: 0.9852 - val_loss: 1.2419 - val_accuracy: 0.5956
Confusion matrix: 
 [[577 293]
 [147  71]]
Validation f1: 24.40
Validation accuracy: 59.56
Validation recall: 32.57
Validation precision: 19.51
Validation AUC: 0.22213532325328045
Validation class accuracies: [0.6632183908045977, 0.3256880733944954]
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 10 epochs
Epoch 24/40
263/263 - 151s - loss: 0.0605 - accuracy: 0.9836 - val_loss: 1.2030 - val_accuracy: 0.6259
Confusion matrix: 
 [[617 253]
 [154  64]]
Validation f1: 23.93
Validation accuracy: 62.59
Validation recall: 29.36
Validation precision: 20.19
Validation AUC: 0.22085223910240606
Validation class accuracies: [0.7091954022988506, 0.29357798165137616]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 11 epochs
Epoch 25/40
263/263 - 151s - loss: 0.0621 - accuracy: 0.9845 - val_loss: 1.1610 - val_accuracy: 0.6507
Confusion matrix: 
 [[652 218]
 [162  56]]
Validation f1: 22.76
Validation accuracy: 65.07
Validation recall: 25.69
Validation precision: 20.44
Validation AUC: 0.21584795087805803
Validation class accuracies: [0.7494252873563219, 0.25688073394495414]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 12 epochs
Epoch 26/40
263/263 - 154s - loss: 0.0507 - accuracy: 0.9895 - val_loss: 1.1272 - val_accuracy: 0.6783
Confusion matrix: 
 [[690 180]
 [170  48]]
Validation f1: 21.52
Validation accuracy: 67.83
Validation recall: 22.02
Validation precision: 21.05
Validation AUC: 0.2110340511833291
Validation class accuracies: [0.7931034482758621, 0.22018348623853212]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 13 epochs
Epoch 27/40
263/263 - 154s - loss: 0.0465 - accuracy: 0.9926 - val_loss: 1.1175 - val_accuracy: 0.7289
Confusion matrix: 
 [[757 113]
 [182  36]]
Validation f1: 19.62
Validation accuracy: 72.89
Validation recall: 16.51
Validation precision: 24.16
Validation AUC: 0.2158954408651974
Validation class accuracies: [0.8701149425287357, 0.1651376146788991]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 14 epochs
Epoch 28/40
263/263 - 153s - loss: 0.0477 - accuracy: 0.9888 - val_loss: 1.1604 - val_accuracy: 0.6673
Confusion matrix: 
 [[678 192]
 [170  48]]
Validation f1: 20.96
Validation accuracy: 66.73
Validation recall: 22.02
Validation precision: 20.00
Validation AUC: 0.2156363541129941
Validation class accuracies: [0.7793103448275862, 0.22018348623853212]
Lr has been adjusted to 0.0001250000059371814
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 15 epochs
Epoch 29/40
263/263 - 152s - loss: 0.0460 - accuracy: 0.9902 - val_loss: 1.1509 - val_accuracy: 0.6700
Confusion matrix: 
 [[680 190]
 [169  49]]
Validation f1: 21.44
Validation accuracy: 67.00
Validation recall: 22.48
Validation precision: 20.50
Validation AUC: 0.218429916824871
Validation class accuracies: [0.7816091954022989, 0.22477064220183487]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 16 epochs
Epoch 30/40
263/263 - 153s - loss: 0.0459 - accuracy: 0.9907 - val_loss: 1.2099 - val_accuracy: 0.6397
Confusion matrix: 
 [[635 235]
 [157  61]]
Validation f1: 23.74
Validation accuracy: 63.97
Validation recall: 27.98
Validation precision: 20.61
Validation AUC: 0.22128920424134663
Validation class accuracies: [0.7298850574712644, 0.2798165137614679]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 17 epochs
Epoch 31/40
263/263 - 153s - loss: 0.0485 - accuracy: 0.9883 - val_loss: 1.1566 - val_accuracy: 0.6765
Confusion matrix: 
 [[686 184]
 [168  50]]
Validation f1: 22.12
Validation accuracy: 67.65
Validation recall: 22.94
Validation precision: 21.37
Validation AUC: 0.21776949710304933
Validation class accuracies: [0.7885057471264367, 0.22935779816513763]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 18 epochs
Epoch 32/40
263/263 - 152s - loss: 0.0483 - accuracy: 0.9909 - val_loss: 1.2262 - val_accuracy: 0.6425
Confusion matrix: 
 [[638 232]
 [157  61]]
Validation f1: 23.87
Validation accuracy: 64.25
Validation recall: 27.98
Validation precision: 20.82
Validation AUC: 0.22094944872737354
Validation class accuracies: [0.7333333333333333, 0.2798165137614679]
The validation tracker metric at 0.31136363636363634 hasn't increased by 0.01 in 19 epochs
Epoch 33/40
263/263 - 153s - loss: 0.0486 - accuracy: 0.9902 - val_loss: 1.1804 - val_accuracy: 0.6590
Confusion matrix: 
 [[667 203]
 [168  50]]
Validation f1: 21.23
Validation accuracy: 65.90
Validation recall: 22.94
Validation precision: 19.76
Validation AUC: 0.21921459311217853
Validation class accuracies: [0.7666666666666667, 0.22935779816513763]

The metrics for the epoch with the best target metric are: 
Best cm: [[345 525]
 [ 81 137]]
Best f1: 0.31136363636363634
Best accuracy: 0.4430147058823529
Best recall: 0.6284403669724771
Best precision: 0.20694864048338368
Best AUC: 0.2281229448586714
Best epoch: 12
Lr has been adjusted to 6.25000029685907e-05
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 4
Starting...
F1: 0.39344262295081966
Accuracy: 0.5066666666666667
Precision: 0.2608695652173913
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2106__05_2253__v29__mixednet_newparams/validation_sheet_4.xls...
Done.
Epoch: 8
Starting...
F1: 0.3409090909090909
Accuracy: 0.22666666666666666
Precision: 0.2054794520547945
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2106__05_2253__v29__mixednet_newparams/validation_sheet_8.xls...
Done.
Epoch: 40
Starting...
F1: 0.3188405797101449
Accuracy: 0.37333333333333335
Precision: 0.2037037037037037
Recall: 0.7333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2106__05_2253__v29__mixednet_newparams/validation_sheet_40.xls...
Done.
Epoch: 12
Starting...
F1: 0.3370786516853933
Accuracy: 0.21333333333333335
Precision: 0.20270270270270271
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2106__05_2253__v29__mixednet_newparams/validation_sheet_12.xls...
Done.
Epoch: 7
Starting...
F1: 0.3384615384615385
Accuracy: 0.4266666666666667
Precision: 0.22
Recall: 0.7333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2106__05_2253__v29__mixednet_newparams/validation_sheet_7.xls...
Done.
wandb: Waiting for W&B process to finish, PID 25618
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210508_225310-2cfoh7qe/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210508_225310-2cfoh7qe/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99023
wandb:         val_accuracy 0.65901
wandb:             _runtime 5729
wandb:           _timestamp 1620520119
wandb:                _step 234
wandb:           train_loss 0.04864
wandb:             val_loss 1.18037
wandb:           val_recall 0.22936
wandb:        val_precision 0.19763
wandb:               val_f1 0.21231
wandb:              val_auc 0.21921
wandb:                   lr 0.00013
wandb:          best_val_f1 0.31136
wandb:    best_val_accuracy 0.44301
wandb:   best_val_precision 0.20695
wandb:      best_val_recall 0.62844
wandb:             best_auc 0.22812
wandb:           best_epoch 12
wandb:           best_bd_f1 0.39344
wandb:     best_bd_accuracy 0.50667
wandb:    best_bd_precision 0.26087
wandb:       best_bd_recall 0.8
wandb:        best_bd_epoch 4
wandb: Run history:
wandb:   train_accuracy ▁▁▂▂▂▃▄▄▅▅▆▆▇▇▇▇█▇███████████████
wandb:     val_accuracy ██▇▅▇█▇▆▄▅▇▄▃▁▅▅▇▆▄▆▅▇▅▆▆▆▇▆▆▆▆▆▆
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ███▇▇▇▆▆▅▅▄▃▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▂▁▁▁▂▂▂▂▃▅█▃▃▃▃▄▃▄▃▄▄▃▃▃▃▃▄▃▄▃
wandb:       val_recall ▁▁▂▅▃▁▂▃▅▄▃▄▇█▅▃▂▄▄▃▄▃▄▄▃▃▂▃▃▃▃▃▃
wandb:    val_precision ▁▅▄▅▅█▆▅▅▅▅▄▅▅▅▄▆▅▅▅▅▅▅▅▅▅▆▅▅▅▅▅▅
wandb:           val_f1 ▁▂▃▇▆▂▅▆▇▆▅▆██▇▆▅▆▇▆▇▆▆▆▆▆▅▆▆▆▆▆▆
wandb:          val_auc ▁▃▄▅▆▄█▅▄▅▄▂█▆▆▄▆▇▇▅▇▅▇▇▆▅▆▆▆▇▆▇▆
wandb:               lr ██████████████████▄▄▄▄▄▂▂▂▂▂▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 4 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced divine-haze-201: https://wandb.ai/arachid1/tensorboard-integration/runs/2cfoh7qe


 See logs at ../../new_cache/conv__2106__05_2253__v29__mixednet_newparams/logs/