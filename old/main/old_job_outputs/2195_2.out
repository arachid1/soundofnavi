Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2195
Description:  redoingcyclical_with_6steps
2021-06-07 02:23:31.781231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-07 02:23:34.138949: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-07 02:23:34.139930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-07 02:23:34.186308: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:23:34.187005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-07 02:23:34.187038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 02:23:34.190585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 02:23:34.190682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-07 02:23:34.191787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-07 02:23:34.192116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-07 02:23:34.193152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-07 02:23:34.194032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-07 02:23:34.194198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 02:23:34.194304: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:23:34.195028: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:23:34.195675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2195.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 20, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 80, 'FACTOR': 0.25, 'PATIENCE': 8, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 35, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-07 02:25:01.297005: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-07 02:25:01.297333: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:25:01.298769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-07 02:25:01.298821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 02:25:01.298910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 02:25:01.298940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-07 02:25:01.298961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-07 02:25:01.298982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-07 02:25:01.299003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-07 02:25:01.299023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-07 02:25:01.299042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 02:25:01.299177: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:25:01.300032: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:25:01.300724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-07 02:25:01.300774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 02:25:02.026342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-07 02:25:02.026388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-07 02:25:02.026396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-07 02:25:02.026682: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:25:02.027481: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:25:02.028160: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 02:25:02.028821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Length of training samples after audio augmentation: 4712
Length of training samples after spec augmentation: 4862
-----------------------
Number of train recordings: 4862 with pneumonia: 1730 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
With concat = False and six = False, size of training set: 4862...
...and size of validation set: 1072
Initializing weights...
weights = {0: 0.7761813537675607, 1: 1.4052023121387283}
The step size for cyclical LR is 1458
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
2021-06-07 02:25:03.344598: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-07 02:25:03.347018: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-07 02:25:03.886082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 02:25:05.842995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 02:25:06.362432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/80
244/244 - 436s - loss: 0.6057 - accuracy: 0.6940 - val_loss: 0.5820 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2635358167694798
Validation class accuracies: [1.0, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 2/80
244/244 - 437s - loss: 0.5096 - accuracy: 0.7861 - val_loss: 0.6096 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24963223234473567
Validation class accuracies: [1.0, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 3/80
244/244 - 437s - loss: 0.4548 - accuracy: 0.8202 - val_loss: 0.7067 - val_accuracy: 0.6082
Confusion matrix: 
 [[607 177]
 [243  45]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77423469 0.22576531]
 [0.84375    0.15625   ]]
Validation f1: 17.65
Validation accuracy: 60.82
Validation recall: 15.62
Validation precision: 20.27
Validation AUC: 0.2424177456205329
Validation class accuracies: [0.7742346938775511, 0.15625]
The clause is activated.
Not defaulting.
Saving model...
Epoch 4/80
244/244 - 437s - loss: 0.4430 - accuracy: 0.8264 - val_loss: 0.8580 - val_accuracy: 0.7313
Confusion matrix: 
 [[783   1]
 [287   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99872449 0.00127551]
 [0.99652778 0.00347222]]
Validation f1: 0.69
Validation accuracy: 73.13
Validation recall: 0.35
Validation precision: 50.00
Validation AUC: 0.24704537510960556
Validation class accuracies: [0.9987244897959183, 0.003472222222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 5/80
244/244 - 437s - loss: 0.4313 - accuracy: 0.8278 - val_loss: 1.2335 - val_accuracy: 0.2780
Confusion matrix: 
 [[ 10 774]
 [  0 288]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.0127551 0.9872449]
 [0.        1.       ]]
Validation f1: 42.67
Validation accuracy: 27.80
Validation recall: 100.00
Validation precision: 27.12
Validation AUC: 0.2878851056225194
Validation class accuracies: [0.012755102040816327, 1.0]
The clause is activated.
The training is defaulting to either class.
Epoch 6/80
244/244 - 437s - loss: 0.4315 - accuracy: 0.8276 - val_loss: 1.8886 - val_accuracy: 0.2910
Confusion matrix: 
 [[ 31 753]
 [  7 281]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.03954082 0.96045918]
 [0.02430556 0.97569444]]
Validation f1: 42.51
Validation accuracy: 29.10
Validation recall: 97.57
Validation precision: 27.18
Validation AUC: 0.2634366741807103
Validation class accuracies: [0.039540816326530615, 0.9756944444444444]
The clause is activated.
The training is defaulting to either class.
Epoch 7/80
244/244 - 437s - loss: 0.4066 - accuracy: 0.8355 - val_loss: 0.6196 - val_accuracy: 0.6614
Confusion matrix: 
 [[645 139]
 [224  64]]
Normalized Confusion matrix: 
 [[0.82270408 0.17729592]
 [0.77777778 0.22222222]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.07
Validation accuracy: 66.14
Validation recall: 22.22
Validation precision: 31.53
Validation AUC: 0.29675725486837673
Validation class accuracies: [0.8227040816326531, 0.2222222222222222]
The clause is activated.
Not defaulting.
Saving model...
Epoch 8/80
244/244 - 437s - loss: 0.3869 - accuracy: 0.8427 - val_loss: 0.7887 - val_accuracy: 0.5196
Confusion matrix: 
 [[372 412]
 [103 185]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.4744898  0.5255102 ]
 [0.35763889 0.64236111]]
Validation f1: 41.81
Validation accuracy: 51.96
Validation recall: 64.24
Validation precision: 30.99
Validation AUC: 0.2940971686024373
Validation class accuracies: [0.4744897959183674, 0.6423611111111112]
The clause is activated.
Not defaulting.
Saving model...
Epoch 9/80
244/244 - 437s - loss: 0.3493 - accuracy: 0.8616 - val_loss: 0.6964 - val_accuracy: 0.6390
Confusion matrix: 
 [[615 169]
 [218  70]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78443878 0.21556122]
 [0.75694444 0.24305556]]
Validation f1: 26.57
Validation accuracy: 63.90
Validation recall: 24.31
Validation precision: 29.29
Validation AUC: 0.29407241870958906
Validation class accuracies: [0.7844387755102041, 0.24305555555555555]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 1 epochs
Epoch 10/80
244/244 - 436s - loss: 0.2931 - accuracy: 0.8801 - val_loss: 0.7533 - val_accuracy: 0.7183
Confusion matrix: 
 [[737  47]
 [255  33]]
Normalized Confusion matrix: 
 [[0.94005102 0.05994898]
 [0.88541667 0.11458333]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.93
Validation accuracy: 71.83
Validation recall: 11.46
Validation precision: 41.25
Validation AUC: 0.3176733220048342
Validation class accuracies: [0.9400510204081632, 0.11458333333333333]
The clause is activated.
The training is defaulting to either class.
Epoch 11/80
244/244 - 437s - loss: 0.1920 - accuracy: 0.9280 - val_loss: 1.0533 - val_accuracy: 0.7127
Confusion matrix: 
 [[751  33]
 [275  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.95790816 0.04209184]
 [0.95486111 0.04513889]]
Validation f1: 7.78
Validation accuracy: 71.27
Validation recall: 4.51
Validation precision: 28.26
Validation AUC: 0.27952722496544996
Validation class accuracies: [0.9579081632653061, 0.04513888888888889]
The clause is activated.
The training is defaulting to either class.
Epoch 12/80
244/244 - 444s - loss: 0.0999 - accuracy: 0.9663 - val_loss: 1.2020 - val_accuracy: 0.6474
Confusion matrix: 
 [[642 142]
 [236  52]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81887755 0.18112245]
 [0.81944444 0.18055556]]
Validation f1: 21.58
Validation accuracy: 64.74
Validation recall: 18.06
Validation precision: 26.80
Validation AUC: 0.2766397282629941
Validation class accuracies: [0.8188775510204082, 0.18055555555555555]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 2 epochs
Epoch 13/80
244/244 - 442s - loss: 0.0592 - accuracy: 0.9807 - val_loss: 1.3374 - val_accuracy: 0.6399
Confusion matrix: 
 [[602 182]
 [204  84]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.76785714 0.23214286]
 [0.70833333 0.29166667]]
Validation f1: 30.32
Validation accuracy: 63.99
Validation recall: 29.17
Validation precision: 31.58
Validation AUC: 0.28761829690598334
Validation class accuracies: [0.7678571428571429, 0.2916666666666667]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 3 epochs
Epoch 14/80
244/244 - 444s - loss: 0.0698 - accuracy: 0.9759 - val_loss: 2.6871 - val_accuracy: 0.7257
Confusion matrix: 
 [[776   8]
 [286   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98979592 0.01020408]
 [0.99305556 0.00694444]]
Validation f1: 1.34
Validation accuracy: 72.57
Validation recall: 0.69
Validation precision: 20.00
Validation AUC: 0.27036623900470774
Validation class accuracies: [0.9897959183673469, 0.006944444444444444]
The clause is activated.
The training is defaulting to either class.
Epoch 15/80
244/244 - 443s - loss: 0.0989 - accuracy: 0.9644 - val_loss: 1.3355 - val_accuracy: 0.5625
Confusion matrix: 
 [[481 303]
 [166 122]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.61352041 0.38647959]
 [0.57638889 0.42361111]]
Validation f1: 34.22
Validation accuracy: 56.25
Validation recall: 42.36
Validation precision: 28.71
Validation AUC: 0.28364884468292295
Validation class accuracies: [0.6135204081632653, 0.4236111111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 4 epochs
Epoch 16/80
244/244 - 442s - loss: 0.0804 - accuracy: 0.9712 - val_loss: 1.3199 - val_accuracy: 0.6735
Confusion matrix: 
 [[642 142]
 [208  80]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81887755 0.18112245]
 [0.72222222 0.27777778]]
Validation f1: 31.37
Validation accuracy: 67.35
Validation recall: 27.78
Validation precision: 36.04
Validation AUC: 0.3132104080858301
Validation class accuracies: [0.8188775510204082, 0.2777777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 5 epochs
Epoch 17/80
244/244 - 439s - loss: 0.1295 - accuracy: 0.9480 - val_loss: 1.1966 - val_accuracy: 0.6828
Confusion matrix: 
 [[688  96]
 [244  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87755102 0.12244898]
 [0.84722222 0.15277778]]
Validation f1: 20.56
Validation accuracy: 68.28
Validation recall: 15.28
Validation precision: 31.43
Validation AUC: 0.3096354988552374
Validation class accuracies: [0.8775510204081632, 0.1527777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 6 epochs
Epoch 18/80
244/244 - 439s - loss: 0.0926 - accuracy: 0.9665 - val_loss: 1.3398 - val_accuracy: 0.6735
Confusion matrix: 
 [[638 146]
 [204  84]]
Normalized Confusion matrix: 
 [[0.81377551 0.18622449]
 [0.70833333 0.29166667]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 32.43
Validation accuracy: 67.35
Validation recall: 29.17
Validation precision: 36.52
Validation AUC: 0.3094185067363925
Validation class accuracies: [0.8137755102040817, 0.2916666666666667]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 7 epochs
Epoch 19/80
244/244 - 437s - loss: 0.0790 - accuracy: 0.9726 - val_loss: 1.3509 - val_accuracy: 0.6623
Confusion matrix: 
 [[641 143]
 [219  69]]
Normalized Confusion matrix: 
 [[0.81760204 0.18239796]
 [0.76041667 0.23958333]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.60
Validation accuracy: 66.23
Validation recall: 23.96
Validation precision: 32.55
Validation AUC: 0.30343050172403613
Validation class accuracies: [0.8176020408163265, 0.23958333333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 8 epochs
Epoch 20/80
244/244 - 437s - loss: 0.0579 - accuracy: 0.9782 - val_loss: 1.6329 - val_accuracy: 0.6735
Confusion matrix: 
 [[686  98]
 [252  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.875 0.125]
 [0.875 0.125]]
Validation f1: 17.06
Validation accuracy: 67.35
Validation recall: 12.50
Validation precision: 26.87
Validation AUC: 0.28252375989329964
Validation class accuracies: [0.875, 0.125]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 9 epochs
Epoch 21/80
244/244 - 437s - loss: 0.0386 - accuracy: 0.9850 - val_loss: 1.7987 - val_accuracy: 0.5737
Confusion matrix: 
 [[504 280]
 [177 111]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.64285714 0.35714286]
 [0.61458333 0.38541667]]
Validation f1: 32.70
Validation accuracy: 57.37
Validation recall: 38.54
Validation precision: 28.39
Validation AUC: 0.2774070791887209
Validation class accuracies: [0.6428571428571429, 0.3854166666666667]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 10 epochs
Epoch 22/80
244/244 - 436s - loss: 0.0198 - accuracy: 0.9942 - val_loss: 1.7761 - val_accuracy: 0.6110
Confusion matrix: 
 [[564 220]
 [197  91]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.71938776 0.28061224]
 [0.68402778 0.31597222]]
Validation f1: 30.38
Validation accuracy: 61.10
Validation recall: 31.60
Validation precision: 29.26
Validation AUC: 0.2827014997431555
Validation class accuracies: [0.7193877551020408, 0.3159722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 11 epochs
Epoch 23/80
244/244 - 436s - loss: 0.0174 - accuracy: 0.9949 - val_loss: 1.9895 - val_accuracy: 0.6754
Confusion matrix: 
 [[684 100]
 [248  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87244898 0.12755102]
 [0.86111111 0.13888889]]
Validation f1: 18.69
Validation accuracy: 67.54
Validation recall: 13.89
Validation precision: 28.57
Validation AUC: 0.2871213890504588
Validation class accuracies: [0.8724489795918368, 0.1388888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 12 epochs
Epoch 24/80
244/244 - 439s - loss: 0.0142 - accuracy: 0.9957 - val_loss: 1.9096 - val_accuracy: 0.6642
Confusion matrix: 
 [[654 130]
 [230  58]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.83418367 0.16581633]
 [0.79861111 0.20138889]]
Validation f1: 24.37
Validation accuracy: 66.42
Validation recall: 20.14
Validation precision: 30.85
Validation AUC: 0.28746671172303795
Validation class accuracies: [0.8341836734693877, 0.2013888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 13 epochs
Epoch 25/80
244/244 - 431s - loss: 0.0098 - accuracy: 0.9971 - val_loss: 2.0233 - val_accuracy: 0.6744
Confusion matrix: 
 [[679 105]
 [244  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86607143 0.13392857]
 [0.84722222 0.15277778]]
Validation f1: 20.14
Validation accuracy: 67.44
Validation recall: 15.28
Validation precision: 29.53
Validation AUC: 0.28367912201914397
Validation class accuracies: [0.8660714285714286, 0.1527777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 14 epochs
Epoch 26/80
244/244 - 431s - loss: 0.0157 - accuracy: 0.9944 - val_loss: 2.0742 - val_accuracy: 0.6800
Confusion matrix: 
 [[691  93]
 [250  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88137755 0.11862245]
 [0.86805556 0.13194444]]
Validation f1: 18.14
Validation accuracy: 68.00
Validation recall: 13.19
Validation precision: 29.01
Validation AUC: 0.28576023704811904
Validation class accuracies: [0.8813775510204082, 0.13194444444444445]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 15 epochs
Epoch 27/80
244/244 - 430s - loss: 0.0127 - accuracy: 0.9957 - val_loss: 1.8919 - val_accuracy: 0.6549
Confusion matrix: 
 [[634 150]
 [220  68]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.80867347 0.19132653]
 [0.76388889 0.23611111]]
Validation f1: 26.88
Validation accuracy: 65.49
Validation recall: 23.61
Validation precision: 31.19
Validation AUC: 0.2972870390735967
Validation class accuracies: [0.8086734693877551, 0.2361111111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 16 epochs
Epoch 28/80
244/244 - 431s - loss: 0.0180 - accuracy: 0.9949 - val_loss: 2.2430 - val_accuracy: 0.6959
Confusion matrix: 
 [[722  62]
 [264  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92091837 0.07908163]
 [0.91666667 0.08333333]]
Validation f1: 12.83
Validation accuracy: 69.59
Validation recall: 8.33
Validation precision: 27.91
Validation AUC: 0.2899346881719189
Validation class accuracies: [0.9209183673469388, 0.08333333333333333]
The clause is activated.
The training is defaulting to either class.
Epoch 29/80
244/244 - 431s - loss: 0.0207 - accuracy: 0.9924 - val_loss: 2.0111 - val_accuracy: 0.6222
Confusion matrix: 
 [[595 189]
 [216  72]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.75892857 0.24107143]
 [0.75       0.25      ]]
Validation f1: 26.23
Validation accuracy: 62.22
Validation recall: 25.00
Validation precision: 27.59
Validation AUC: 0.28167716366234763
Validation class accuracies: [0.7589285714285714, 0.25]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 17 epochs
Epoch 30/80
244/244 - 430s - loss: 0.0238 - accuracy: 0.9928 - val_loss: 1.9019 - val_accuracy: 0.6651
Confusion matrix: 
 [[664 120]
 [239  49]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.84693878 0.15306122]
 [0.82986111 0.17013889]]
Validation f1: 21.44
Validation accuracy: 66.51
Validation recall: 17.01
Validation precision: 28.99
Validation AUC: 0.27247079553175557
Validation class accuracies: [0.8469387755102041, 0.1701388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 18 epochs
Epoch 31/80
244/244 - 432s - loss: 0.0259 - accuracy: 0.9918 - val_loss: 1.8846 - val_accuracy: 0.6698
Confusion matrix: 
 [[674 110]
 [244  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85969388 0.14030612]
 [0.84722222 0.15277778]]
Validation f1: 19.91
Validation accuracy: 66.98
Validation recall: 15.28
Validation precision: 28.57
Validation AUC: 0.2797920076150173
Validation class accuracies: [0.8596938775510204, 0.1527777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 19 epochs
Epoch 32/80
244/244 - 430s - loss: 0.0155 - accuracy: 0.9959 - val_loss: 1.9410 - val_accuracy: 0.6670
Confusion matrix: 
 [[666 118]
 [239  49]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.8494898  0.1505102 ]
 [0.82986111 0.17013889]]
Validation f1: 21.54
Validation accuracy: 66.70
Validation recall: 17.01
Validation precision: 29.34
Validation AUC: 0.2785478092304151
Validation class accuracies: [0.8494897959183674, 0.1701388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 20 epochs
Epoch 33/80
244/244 - 431s - loss: 0.0197 - accuracy: 0.9926 - val_loss: 1.7974 - val_accuracy: 0.6567
Confusion matrix: 
 [[643 141]
 [227  61]]
Normalized Confusion matrix: 
 [[0.82015306 0.17984694]
 [0.78819444 0.21180556]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.90
Validation accuracy: 65.67
Validation recall: 21.18
Validation precision: 30.20
Validation AUC: 0.2854255661719348
Validation class accuracies: [0.8201530612244898, 0.21180555555555555]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 21 epochs
Epoch 34/80
244/244 - 431s - loss: 0.0142 - accuracy: 0.9963 - val_loss: 1.8805 - val_accuracy: 0.6800
Confusion matrix: 
 [[685  99]
 [244  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87372449 0.12627551]
 [0.84722222 0.15277778]]
Validation f1: 20.42
Validation accuracy: 68.00
Validation recall: 15.28
Validation precision: 30.77
Validation AUC: 0.28047612657049437
Validation class accuracies: [0.8737244897959183, 0.1527777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 22 epochs
Epoch 35/80
244/244 - 431s - loss: 0.0085 - accuracy: 0.9975 - val_loss: 1.8551 - val_accuracy: 0.6660
Confusion matrix: 
 [[660 124]
 [234  54]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.84183673 0.15816327]
 [0.8125     0.1875    ]]
Validation f1: 23.18
Validation accuracy: 66.60
Validation recall: 18.75
Validation precision: 30.34
Validation AUC: 0.2787424324505735
Validation class accuracies: [0.8418367346938775, 0.1875]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 23 epochs
Epoch 36/80
244/244 - 430s - loss: 0.0079 - accuracy: 0.9975 - val_loss: 1.8949 - val_accuracy: 0.6726
Confusion matrix: 
 [[672 112]
 [239  49]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85714286 0.14285714]
 [0.82986111 0.17013889]]
Validation f1: 21.83
Validation accuracy: 67.26
Validation recall: 17.01
Validation precision: 30.43
Validation AUC: 0.2796346235775082
Validation class accuracies: [0.8571428571428571, 0.1701388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 24 epochs
Epoch 37/80
244/244 - 430s - loss: 0.0079 - accuracy: 0.9981 - val_loss: 1.8919 - val_accuracy: 0.6744
Confusion matrix: 
 [[670 114]
 [235  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85459184 0.14540816]
 [0.81597222 0.18402778]]
Validation f1: 23.30
Validation accuracy: 67.44
Validation recall: 18.40
Validation precision: 31.74
Validation AUC: 0.2784409989705261
Validation class accuracies: [0.8545918367346939, 0.1840277777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 25 epochs
Epoch 38/80
244/244 - 430s - loss: 0.0102 - accuracy: 0.9973 - val_loss: 1.8921 - val_accuracy: 0.6698
Confusion matrix: 
 [[663 121]
 [233  55]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.84566327 0.15433673]
 [0.80902778 0.19097222]]
Validation f1: 23.71
Validation accuracy: 66.98
Validation recall: 19.10
Validation precision: 31.25
Validation AUC: 0.2800521662270943
Validation class accuracies: [0.8456632653061225, 0.1909722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 26 epochs
Epoch 39/80
244/244 - 431s - loss: 0.0128 - accuracy: 0.9971 - val_loss: 1.8934 - val_accuracy: 0.6707
Confusion matrix: 
 [[668 116]
 [237  51]]
Normalized Confusion matrix: 
 [[0.85204082 0.14795918]
 [0.82291667 0.17708333]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.42
Validation accuracy: 67.07
Validation recall: 17.71
Validation precision: 30.54
Validation AUC: 0.2827397773975304
Validation class accuracies: [0.8520408163265306, 0.17708333333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 27 epochs
Epoch 40/80
244/244 - 430s - loss: 0.0108 - accuracy: 0.9967 - val_loss: 1.8343 - val_accuracy: 0.6539
Confusion matrix: 
 [[638 146]
 [225  63]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81377551 0.18622449]
 [0.78125    0.21875   ]]
Validation f1: 25.35
Validation accuracy: 65.39
Validation recall: 21.88
Validation precision: 30.14
Validation AUC: 0.2860758665626411
Validation class accuracies: [0.8137755102040817, 0.21875]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 28 epochs
Epoch 41/80
244/244 - 430s - loss: 0.0124 - accuracy: 0.9967 - val_loss: 1.8810 - val_accuracy: 0.6623
Confusion matrix: 
 [[653 131]
 [231  57]]
Normalized Confusion matrix: 
 [[0.83290816 0.16709184]
 [0.80208333 0.19791667]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.95
Validation accuracy: 66.23
Validation recall: 19.79
Validation precision: 30.32
Validation AUC: 0.2856965937725082
Validation class accuracies: [0.8329081632653061, 0.19791666666666666]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 29 epochs
Epoch 42/80
244/244 - 430s - loss: 0.0100 - accuracy: 0.9975 - val_loss: 1.9625 - val_accuracy: 0.6670
Confusion matrix: 
 [[659 125]
 [232  56]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.84056122 0.15943878]
 [0.80555556 0.19444444]]
Validation f1: 23.88
Validation accuracy: 66.70
Validation recall: 19.44
Validation precision: 30.94
Validation AUC: 0.28446736750592877
Validation class accuracies: [0.8405612244897959, 0.19444444444444445]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 30 epochs
Epoch 43/80
244/244 - 430s - loss: 0.0098 - accuracy: 0.9969 - val_loss: 1.9846 - val_accuracy: 0.6707
Confusion matrix: 
 [[667 117]
 [236  52]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85076531 0.14923469]
 [0.81944444 0.18055556]]
Validation f1: 22.76
Validation accuracy: 67.07
Validation recall: 18.06
Validation precision: 30.77
Validation AUC: 0.28161294388299873
Validation class accuracies: [0.8507653061224489, 0.18055555555555555]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 31 epochs
Epoch 44/80
244/244 - 430s - loss: 0.0139 - accuracy: 0.9951 - val_loss: 1.9694 - val_accuracy: 0.6782
Confusion matrix: 
 [[674 110]
 [235  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85969388 0.14030612]
 [0.81597222 0.18402778]]
Validation f1: 23.50
Validation accuracy: 67.82
Validation recall: 18.40
Validation precision: 32.52
Validation AUC: 0.2870231034639474
Validation class accuracies: [0.8596938775510204, 0.1840277777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 32 epochs
Epoch 45/80
244/244 - 429s - loss: 0.0088 - accuracy: 0.9969 - val_loss: 1.9042 - val_accuracy: 0.6688
Confusion matrix: 
 [[666 118]
 [237  51]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.8494898  0.1505102 ]
 [0.82291667 0.17708333]]
Validation f1: 22.32
Validation accuracy: 66.88
Validation recall: 17.71
Validation precision: 30.18
Validation AUC: 0.2848419306840547
Validation class accuracies: [0.8494897959183674, 0.17708333333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 33 epochs
Epoch 46/80
244/244 - 430s - loss: 0.0103 - accuracy: 0.9965 - val_loss: 1.9971 - val_accuracy: 0.6819
Confusion matrix: 
 [[684 100]
 [241  47]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87244898 0.12755102]
 [0.83680556 0.16319444]]
Validation f1: 21.61
Validation accuracy: 68.19
Validation recall: 16.32
Validation precision: 31.97
Validation AUC: 0.28555326939863407
Validation class accuracies: [0.8724489795918368, 0.16319444444444445]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4180790960451977 hasn't increased by 0 in 34 epochs
Epoch 47/80
244/244 - 429s - loss: 0.0062 - accuracy: 0.9981 - val_loss: 1.9572 - val_accuracy: 0.6651
Confusion matrix: 
 [[659 125]
 [234  54]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.84056122 0.15943878]
 [0.8125     0.1875    ]]
Validation f1: 23.13
Validation accuracy: 66.51
Validation recall: 18.75
Validation precision: 30.17
Validation AUC: 0.28490756221160335
Validation class accuracies: [0.8405612244897959, 0.1875]

The metrics for job 0 with the best target metric are: 
Best cm: [[372 412]
 [103 185]]
Best normalized cm: [[0.4744898  0.5255102 ]
 [0.35763889 0.64236111]]
Best f1: 0.42
Best accuracy: 0.52
Best recall: 0.64
Best precision: 0.31
Best AUC: 0.29
Best class accuracies: [0.4744897959183674, 0.6423611111111112]
Best epoch: 8
The clause is activated.
Not defaulting.
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[ 6 47]
 [ 5 17]]
F1: 0.39534883720930236
AUC: 0.5525094696969697
Accuracy: 0.30666666666666664
Precision: 0.265625
Recall: 0.7727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[20 33]
 [ 8 14]]
F1: 0.40579710144927533
AUC: 0.5204513217279174
Accuracy: 0.4533333333333333
Precision: 0.2978723404255319
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[31 22]
 [10 12]]
F1: 0.42857142857142855
AUC: 0.5158645276292335
Accuracy: 0.5733333333333334
Precision: 0.35294117647058826
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_80.xls...
Done.
Epoch: epoch3
Starting...
CM: [[27 26]
 [ 9 13]]
F1: 0.4262295081967213
AUC: 0.5221212121212121
Accuracy: 0.5333333333333333
Precision: 0.3333333333333333
Recall: 0.5909090909090909
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[37 16]
 [14  8]]
F1: 0.34782608695652173
AUC: 0.44181818181818183
Accuracy: 0.6
Precision: 0.3333333333333333
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[41 12]
 [18  4]]
F1: 0.2105263157894737
AUC: 0.33590909090909093
Accuracy: 0.6
Precision: 0.25
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch3.xls...
Done.
Epoch: epoch7
Starting...
CM: [[ 0 53]
 [ 1 21]]
F1: 0.43749999999999994
AUC: 0.6258312858312859
Accuracy: 0.28
Precision: 0.28378378378378377
Recall: 0.9545454545454546
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch7.xls...
Done.
Epoch: epoch7
Starting...
CM: [[ 3 50]
 [ 1 21]]
F1: 0.45161290322580644
AUC: 0.6318267178830559
Accuracy: 0.32
Precision: 0.29577464788732394
Recall: 0.9545454545454546
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch7.xls...
Done.
Epoch: epoch7
Starting...
CM: [[10 43]
 [ 2 20]]
F1: 0.4705882352941177
AUC: 0.6266089466089466
Accuracy: 0.4
Precision: 0.31746031746031744
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch7.xls...
Done.
Epoch: epoch8
Starting...
CM: [[14 39]
 [ 5 17]]
F1: 0.43589743589743585
AUC: 0.571482683982684
Accuracy: 0.41333333333333333
Precision: 0.30357142857142855
Recall: 0.7727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch8.xls...
Done.
Epoch: epoch8
Starting...
CM: [[31 22]
 [ 7 15]]
F1: 0.5084745762711864
AUC: 0.5902784602784603
Accuracy: 0.6133333333333333
Precision: 0.40540540540540543
Recall: 0.6818181818181818
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch8.xls...
Done.
Epoch: epoch8
Starting...
CM: [[42 11]
 [11 11]]
F1: 0.5
AUC: 0.5733333333333334
Accuracy: 0.7066666666666667
Precision: 0.5
Recall: 0.5
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/validation_sheet_epoch8.xls...
Done.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 13177
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_022334-22yllltu/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_022334-22yllltu/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99815
wandb:         val_accuracy 0.66511
wandb:             _runtime 22537
wandb:           _timestamp 1623055151
wandb:                _step 344
wandb:           train_loss 0.00619
wandb:             val_loss 1.95719
wandb:           val_recall 0.1875
wandb:        val_precision 0.30168
wandb:               val_f1 0.23126
wandb:              val_auc 0.28491
wandb:                   lr <tensorflow_addons.o...
wandb:          best_val_f1 0.41808
wandb:    best_val_accuracy 0.51959
wandb:   best_val_precision 0.30988
wandb:      best_val_recall 0.64236
wandb:             best_auc 0.2941
wandb:           best_epoch 8
wandb:           best_bd_f1 0.50847
wandb:          best_bd_auc 0.59028
wandb:     best_bd_accuracy 0.61333
wandb:    best_bd_precision 0.40541
wandb:       best_bd_recall 0.68182
wandb:        best_bd_epoch epoch8
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_022334-22yllltu


 See logs at ../../new_cache/conv__2195__06_0154__v29__redoingcyclical_with_6steps/logs/