Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2048
Description:  mod10_pneu
2021-04-13 00:42:37.562751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 00:42:39.710075: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-13 00:42:39.711019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-13 00:42:39.783579: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:39.784347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-13 00:42:39.784379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 00:42:39.787883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 00:42:39.787991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 00:42:39.789153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-13 00:42:39.789487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-13 00:42:39.790622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-13 00:42:39.791584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-13 00:42:39.791761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 00:42:39.791910: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:39.792764: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:39.793449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-13 00:42:39.795539: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-13 00:42:39.795729: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:39.796826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-13 00:42:39.796869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 00:42:39.796913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 00:42:39.796934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 00:42:39.796953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-13 00:42:39.796972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-13 00:42:39.797004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-13 00:42:39.797024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-13 00:42:39.797043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 00:42:39.797147: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:39.798283: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:39.799216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-13 00:42:39.799275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 00:42:40.538151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-13 00:42:40.538209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-13 00:42:40.538229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-13 00:42:40.538541: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:40.539685: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:40.540928: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 00:42:40.541916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:05.0, compute capability: 7.0)
2021-04-13 00:42:40.974489: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-13 00:42:40.974543: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-13 00:42:40.974580: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-13 00:42:40.974825: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-13 00:42:40.975683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-13 00:42:41.180092: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-13 00:42:41.182813: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2048.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_0040___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___mod10_pneu___2048/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 4316
Size of validation set: 1078
Initializing weights...
weights = {0: 0.6776381909547738, 1: 1.9073550212164074}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 8) 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 8) 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 8) 584         conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 8) 1608        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 8) 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 24 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 24)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 24)  96          average_pooling2d[0][0]          
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 64, 625, 16)  400         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 64, 625, 16)  400         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 64, 625, 24)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 64, 625, 16)  2320        conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 64, 625, 16)  6416        conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 64, 625, 16)  400         max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 64, 625, 48)  0           conv2d_6[0][0]                   
                                                                 conv2d_8[0][0]                   
                                                                 conv2d_9[0][0]                   
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 313, 48)  0           concatenate_1[0][0]              
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 313, 48)  192         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 313, 32)  1568        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 313, 32)  1568        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 32, 313, 48)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 313, 32)  9248        conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 313, 32)  25632       conv2d_12[0][0]                  
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 313, 32)  1568        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 32, 313, 96)  0           conv2d_11[0][0]                  
                                                                 conv2d_13[0][0]                  
                                                                 conv2d_14[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 157, 96)  0           concatenate_2[0][0]              
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 157, 96)  384         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 16, 157, 64)  6208        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 16, 157, 64)  6208        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 16, 157, 96)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 16, 157, 64)  36928       conv2d_15[0][0]                  2021-04-13 00:42:41.926544: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-13 00:42:41.928856: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-13 00:42:44.020596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 00:42:44.495018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 00:42:44.507614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 00:42:47.984917: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-13 00:42:47.984966: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-13 00:42:48.674408: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-13 00:42:48.679267: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-13 00:42:48.754779: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 741 callback api events and 737 activity events. 
2021-04-13 00:42:48.799577: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
WARNING:tensorflow:Callback method `on_train_batch_begin` is slow compared to the batch time (batch time: 0.0612s vs `on_train_batch_begin` time: 0.1020s). Check your callbacks.
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0612s vs `on_train_batch_end` time: 0.0915s). Check your callbacks.

__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 16, 157, 64)  102464      conv2d_17[0][0]                  
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 16, 157, 64)  6208        max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 16, 157, 192) 0           conv2d_16[0][0]                  
                                                                 conv2d_18[0][0]                  
                                                                 conv2d_19[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 79, 192)   0           concatenate_3[0][0]              
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 79, 192)   768         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 79, 128)   24704       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 8, 79, 128)   24704       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 8, 79, 192)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 79, 128)   147584      conv2d_20[0][0]                  
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 8, 79, 128)   409728      conv2d_22[0][0]                  
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 8, 79, 128)   24704       max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 8, 79, 384)   0           conv2d_21[0][0]                  
                                                                 conv2d_23[0][0]                  
                                                                 conv2d_24[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 40, 384)   0           concatenate_4[0][0]              
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 40, 384)   1536        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 4, 40, 256)   98560       batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 4, 40, 256)   98560       batch_normalization_5[0][0]      
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 4, 40, 384)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 4, 40, 256)   590080      conv2d_25[0][0]                  
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 4, 40, 256)   1638656     conv2d_27[0][0]                  
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 4, 40, 256)   98560       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 4, 40, 768)   0           conv2d_26[0][0]                  
                                                                 conv2d_28[0][0]                  
                                                                 conv2d_29[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_5 (AveragePoo (None, 2, 20, 768)   0           concatenate_5[0][0]              
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 2, 20, 768)   3072        average_pooling2d_5[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 768)          0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            769         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 3,372,493
Trainable params: 3,369,463
Non-trainable params: 3,030
__________________________________________________________________________________________________
Epoch 1/40
270/270 - 116s - loss: 0.7204 - accuracy: 0.5570 - val_loss: 0.8849 - val_accuracy: 0.2755
Epoch 2/40
270/270 - 107s - loss: 0.6922 - accuracy: 0.5667 - val_loss: 0.6602 - val_accuracy: 0.6224
Epoch 3/40
270/270 - 109s - loss: 0.6803 - accuracy: 0.5697 - val_loss: 0.7586 - val_accuracy: 0.3618
Epoch 4/40
270/270 - 107s - loss: 0.6769 - accuracy: 0.5890 - val_loss: 0.6512 - val_accuracy: 0.6373
Epoch 5/40
270/270 - 108s - loss: 0.6739 - accuracy: 0.5809 - val_loss: 0.6303 - val_accuracy: 0.7013
Epoch 6/40
270/270 - 107s - loss: 0.6617 - accuracy: 0.6198 - val_loss: 0.8510 - val_accuracy: 0.3692
Epoch 7/40
270/270 - 108s - loss: 0.6643 - accuracy: 0.5920 - val_loss: 0.6659 - val_accuracy: 0.6011
Epoch 8/40
270/270 - 106s - loss: 0.6570 - accuracy: 0.6142 - val_loss: 0.5877 - val_accuracy: 0.7273
Epoch 9/40
270/270 - 108s - loss: 0.6477 - accuracy: 0.6300 - val_loss: 0.8445 - val_accuracy: 0.5788
Epoch 10/40
270/270 - 106s - loss: 0.6449 - accuracy: 0.6392 - val_loss: 0.6314 - val_accuracy: 0.6725
Epoch 11/40
270/270 - 107s - loss: 0.6342 - accuracy: 0.6423 - val_loss: 0.6903 - val_accuracy: 0.6902

Epoch 00011: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 12/40
270/270 - 110s - loss: 0.5972 - accuracy: 0.6791 - val_loss: 0.6718 - val_accuracy: 0.6429
Epoch 13/40
270/270 - 108s - loss: 0.5805 - accuracy: 0.6946 - val_loss: 0.7419 - val_accuracy: 0.6336
Epoch 14/40
270/270 - 107s - loss: 0.5565 - accuracy: 0.7108 - val_loss: 0.7140 - val_accuracy: 0.6976

Epoch 00014: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 15/40
270/270 - 108s - loss: 0.4933 - accuracy: 0.7644 - val_loss: 0.7358 - val_accuracy: 0.5891
Epoch 16/40
270/270 - 107s - loss: 0.4338 - accuracy: 0.7940 - val_loss: 1.9940 - val_accuracy: 0.3006
Epoch 17/40
270/270 - 107s - loss: 0.3947 - accuracy: 0.8156 - val_loss: 0.9882 - val_accuracy: 0.5622

Epoch 00017: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 00017: early stopping

 See logs at ../../cache/conv___04_0040___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___mod10_pneu___2048/logs/