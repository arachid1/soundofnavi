Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2259
Description:  lstm
2021-06-27 17:29:27.027037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-27 17:29:29.367962: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 17:29:29.368959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-27 17:29:29.415641: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:29.416419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 17:29:29.416455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 17:29:29.419996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 17:29:29.420097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 17:29:29.421213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 17:29:29.421499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 17:29:29.422533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 17:29:29.423448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 17:29:29.423617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 17:29:29.423726: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:29.424449: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:29.425147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2259.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2259__06_1729__v39__lstm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-27 17:29:34.471459: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 17:29:34.471691: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:34.472391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 17:29:34.472429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 17:29:34.472474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 17:29:34.472493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 17:29:34.472512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 17:29:34.472530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 17:29:34.472548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 17:29:34.472566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 17:29:34.472583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 17:29:34.472665: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:34.473352: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:34.473976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-27 17:29:34.474017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 17:29:35.189199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-27 17:29:35.189246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-27 17:29:35.189258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-27 17:29:35.189558: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:35.190389: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:35.191162: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 17:29:35.191816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-27 17:29:36.997307: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-27 17:29:36.999693: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-27 17:29:37.397074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 17:29:39.795430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 17:29:40.292824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 10, 125, 128, 1)]                   0                
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed)             (None, 10, 125, 128, 32)                    320              
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed)             (None, 10, 125, 128, 32)                    828              
______________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed)             (None, 10, 125, 128, 32)                    128              
______________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed)             (None, 10, 63, 64, 32)                      0                
______________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed)             (None, 10, 32)                              0                
______________________________________________________________________________________________________________
bidirectional (Bidirectional)                    (None, 10, 256)                             164864           
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)                  (None, 10, 256)                             394240           
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 10, 128)                             32896            
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 10, 1)                               129              
______________________________________________________________________________________________________________
flatten (Flatten)                                (None, 10)                                  0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   11               
==============================================================================================================
Total params: 593,416
Trainable params: 593,352
Non-trainable params: 64
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 95s - loss: 0.7295 - accuracy: 0.6554 - val_loss: 0.4294 - val_accuracy: 0.9397
Confusion matrix: 
 [[573   0]
 [ 37   4]]
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.902 0.098]]
Validation f1: 17.78
Validation accuracy: 93.97
Validation recall: 9.76
Validation precision: 100.00
Validation AUC: 0.5136258042130422
Validation class accuracies: [1.0, 0.0975609756097561]
Saving model...
Epoch 2/65
154/154 - 91s - loss: 0.6703 - accuracy: 0.6400 - val_loss: 0.9928 - val_accuracy: 0.2606
Confusion matrix: 
 [[122 451]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.213 0.787]
 [0.073 0.927]]
Validation f1: 14.34
Validation accuracy: 26.06
Validation recall: 92.68
Validation precision: 7.77
Validation AUC: 0.3708745276502047
Validation class accuracies: [0.21291448516579406, 0.926829268292683]
The validation tracker metric at 0.17777777777777776 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 94s - loss: 0.7176 - accuracy: 0.3222 - val_loss: 0.5531 - val_accuracy: 0.8143
Confusion matrix: 
 [[466 107]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.813 0.187]
 [0.171 0.829]]
Validation f1: 37.36
Validation accuracy: 81.43
Validation recall: 82.93
Validation precision: 24.11
Validation AUC: 0.30991463688554327
Validation class accuracies: [0.8132635253054101, 0.8292682926829268]
Saving model...
Epoch 4/65
154/154 - 93s - loss: 0.5333 - accuracy: 0.7689 - val_loss: 0.6875 - val_accuracy: 0.6873
Confusion matrix: 
 [[382 191]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.667 0.333]
 [0.024 0.976]]
Validation f1: 29.41
Validation accuracy: 68.73
Validation recall: 97.56
Validation precision: 17.32
Validation AUC: 0.3563970673146912
Validation class accuracies: [0.6666666666666666, 0.975609756097561]
The validation tracker metric at 0.3736263736263736 hasn't increased by 0 in 1 epochs
Epoch 5/65
154/154 - 91s - loss: 0.4822 - accuracy: 0.8100 - val_loss: 0.3460 - val_accuracy: 0.9251
Confusion matrix: 
 [[552  21]
 [ 25  16]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.61  0.39 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.03
Validation accuracy: 92.51
Validation recall: 39.02
Validation precision: 43.24
Validation AUC: 0.3660382629848513
Validation class accuracies: [0.9633507853403142, 0.3902439024390244]
Saving model...
Epoch 6/65
154/154 - 91s - loss: 0.4610 - accuracy: 0.7974 - val_loss: 0.8666 - val_accuracy: 0.5733
Confusion matrix: 
 [[311 262]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.543 0.457]
 [0.    1.   ]]
Validation f1: 23.84
Validation accuracy: 57.33
Validation recall: 100.00
Validation precision: 13.53
Validation AUC: 0.48348424063008355
Validation class accuracies: [0.5427574171029669, 1.0]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 1 epochs
Epoch 7/65
154/154 - 89s - loss: 0.4748 - accuracy: 0.7950 - val_loss: 0.4009 - val_accuracy: 0.8779
Confusion matrix: 
 [[507  66]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.22  0.78 ]]
Validation f1: 46.04
Validation accuracy: 87.79
Validation recall: 78.05
Validation precision: 32.65
Validation AUC: 0.4910826834460267
Validation class accuracies: [0.8848167539267016, 0.7804878048780488]
Saving model...
Epoch 8/65
154/154 - 94s - loss: 0.4253 - accuracy: 0.8377 - val_loss: 0.9442 - val_accuracy: 0.5489
Confusion matrix: 
 [[296 277]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.517 0.483]
 [0.    1.   ]]
Validation f1: 22.84
Validation accuracy: 54.89
Validation recall: 100.00
Validation precision: 12.89
Validation AUC: 0.4331483617436356
Validation class accuracies: [0.5165794066317626, 1.0]
The validation tracker metric at 0.460431654676259 hasn't increased by 0 in 1 epochs
Epoch 9/65
154/154 - 95s - loss: 0.4472 - accuracy: 0.7897 - val_loss: 0.3081 - val_accuracy: 0.9121
Confusion matrix: 
 [[528  45]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.22  0.78 ]]
Validation f1: 54.24
Validation accuracy: 91.21
Validation recall: 78.05
Validation precision: 41.56
Validation AUC: 0.4962786194932548
Validation class accuracies: [0.9214659685863874, 0.7804878048780488]
Saving model...
Epoch 10/65
154/154 - 90s - loss: 0.4352 - accuracy: 0.8112 - val_loss: 0.8190 - val_accuracy: 0.5912
Confusion matrix: 
 [[322 251]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.562 0.438]
 [0.    1.   ]]
Validation f1: 24.62
Validation accuracy: 59.12
Validation recall: 100.00
Validation precision: 14.04
Validation AUC: 0.3600456973403507
Validation class accuracies: [0.5619546247818499, 1.0]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 1 epochs
Epoch 11/65
154/154 - 91s - loss: 0.4106 - accuracy: 0.8576 - val_loss: 0.5335 - val_accuracy: 0.7980
Confusion matrix: 
 [[453 120]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.791 0.209]
 [0.098 0.902]]
Validation f1: 37.37
Validation accuracy: 79.80
Validation recall: 90.24
Validation precision: 23.57
Validation AUC: 0.3479159949063121
Validation class accuracies: [0.7905759162303665, 0.9024390243902439]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 2 epochs
Epoch 12/65
154/154 - 96s - loss: 0.4104 - accuracy: 0.8381 - val_loss: 0.8793 - val_accuracy: 0.5603
Confusion matrix: 
 [[303 270]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.529 0.471]
 [0.    1.   ]]
Validation f1: 23.30
Validation accuracy: 56.03
Validation recall: 100.00
Validation precision: 13.18
Validation AUC: 0.39530626046584405
Validation class accuracies: [0.5287958115183246, 1.0]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 3 epochs
Epoch 13/65
154/154 - 90s - loss: 0.4222 - accuracy: 0.8556 - val_loss: 0.5347 - val_accuracy: 0.8046
Confusion matrix: 
 [[458 115]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.799 0.201]
 [0.122 0.878]]
Validation f1: 37.50
Validation accuracy: 80.46
Validation recall: 87.80
Validation precision: 23.84
Validation AUC: 0.4387183637753572
Validation class accuracies: [0.7993019197207679, 0.8780487804878049]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 4 epochs
Epoch 14/65
154/154 - 91s - loss: 0.4097 - accuracy: 0.8495 - val_loss: 0.3295 - val_accuracy: 0.9039
Confusion matrix: 
 [[523  50]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.22  0.78 ]]
Validation f1: 52.03
Validation accuracy: 90.39
Validation recall: 78.05
Validation precision: 39.02
Validation AUC: 0.34825737933564244
Validation class accuracies: [0.912739965095986, 0.7804878048780488]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 5 epochs
Epoch 15/65
154/154 - 90s - loss: 0.4153 - accuracy: 0.8401 - val_loss: 0.4364 - val_accuracy: 0.8404
Confusion matrix: 
 [[481  92]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.146 0.854]]
Validation f1: 41.67
Validation accuracy: 84.04
Validation recall: 85.37
Validation precision: 27.56
Validation AUC: 0.41688115389637825
Validation class accuracies: [0.8394415357766143, 0.8536585365853658]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
154/154 - 94s - loss: 0.4097 - accuracy: 0.8576 - val_loss: 0.4299 - val_accuracy: 0.8518
Confusion matrix: 
 [[489  84]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.853 0.147]
 [0.171 0.829]]
Validation f1: 42.77
Validation accuracy: 85.18
Validation recall: 82.93
Validation precision: 28.81
Validation AUC: 0.36181367797698516
Validation class accuracies: [0.8534031413612565, 0.8292682926829268]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 7 epochs
Epoch 17/65
154/154 - 94s - loss: 0.3811 - accuracy: 0.8588 - val_loss: 0.4568 - val_accuracy: 0.8404
Confusion matrix: 
 [[481  92]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.67
Validation accuracy: 84.04
Validation recall: 85.37
Validation precision: 27.56
Validation AUC: 0.44406534535219483
Validation class accuracies: [0.8394415357766143, 0.8536585365853658]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 8 epochs
Epoch 18/65
154/154 - 89s - loss: 0.4049 - accuracy: 0.8434 - val_loss: 0.5615 - val_accuracy: 0.7850
Confusion matrix: 
 [[445 128]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.777 0.223]
 [0.098 0.902]]
Validation f1: 35.92
Validation accuracy: 78.50
Validation recall: 90.24
Validation precision: 22.42
Validation AUC: 0.36758238196676535
Validation class accuracies: [0.7766143106457243, 0.9024390243902439]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 9 epochs
Epoch 19/65
154/154 - 89s - loss: 0.4050 - accuracy: 0.8421 - val_loss: 0.5090 - val_accuracy: 0.8160
Confusion matrix: 
 [[464 109]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.098 0.902]]
Validation f1: 39.57
Validation accuracy: 81.60
Validation recall: 90.24
Validation precision: 25.34
Validation AUC: 0.3830748291003648
Validation class accuracies: [0.8097731239092496, 0.9024390243902439]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 10 epochs
Epoch 20/65
154/154 - 89s - loss: 0.4022 - accuracy: 0.8544 - val_loss: 0.5193 - val_accuracy: 0.8176
Confusion matrix: 
 [[465 108]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.812 0.188]
 [0.098 0.902]]
Validation f1: 39.78
Validation accuracy: 81.76
Validation recall: 90.24
Validation precision: 25.52
Validation AUC: 0.364792279120281
Validation class accuracies: [0.8115183246073299, 0.9024390243902439]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 11 epochs
Epoch 21/65
154/154 - 88s - loss: 0.4015 - accuracy: 0.8430 - val_loss: 0.3956 - val_accuracy: 0.8648
Confusion matrix: 
 [[498  75]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.195 0.805]]
Validation f1: 44.30
Validation accuracy: 86.48
Validation recall: 80.49
Validation precision: 30.56
Validation AUC: 0.3885661735250924
Validation class accuracies: [0.8691099476439791, 0.8048780487804879]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
154/154 - 88s - loss: 0.3844 - accuracy: 0.8539 - val_loss: 0.4804 - val_accuracy: 0.8290
Confusion matrix: 
 [[473 100]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.122 0.878]]
Validation f1: 40.68
Validation accuracy: 82.90
Validation recall: 87.80
Validation precision: 26.47
Validation AUC: 0.34618972457284175
Validation class accuracies: [0.8254799301919721, 0.8780487804878049]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 13 epochs
Epoch 23/65
154/154 - 89s - loss: 0.3867 - accuracy: 0.8487 - val_loss: 0.4615 - val_accuracy: 0.8339
Confusion matrix: 
 [[478  95]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.834 0.166]
 [0.171 0.829]]
Validation f1: 40.00
Validation accuracy: 83.39
Validation recall: 82.93
Validation precision: 26.36
Validation AUC: 0.35400127507050877
Validation class accuracies: [0.8342059336823735, 0.8292682926829268]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 14 epochs
Epoch 24/65
154/154 - 88s - loss: 0.3914 - accuracy: 0.8527 - val_loss: 0.5346 - val_accuracy: 0.8029
Confusion matrix: 
 [[455 118]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.794 0.206]
 [0.073 0.927]]
Validation f1: 38.58
Validation accuracy: 80.29
Validation recall: 92.68
Validation precision: 24.36
Validation AUC: 0.37068130887429857
Validation class accuracies: [0.794066317626527, 0.926829268292683]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 15 epochs
Epoch 25/65
154/154 - 86s - loss: 0.3876 - accuracy: 0.8491 - val_loss: 0.5135 - val_accuracy: 0.8127
Confusion matrix: 
 [[462 111]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.098 0.902]]
Validation f1: 39.15
Validation accuracy: 81.27
Validation recall: 90.24
Validation precision: 25.00
Validation AUC: 0.37474330716565035
Validation class accuracies: [0.806282722513089, 0.9024390243902439]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 16 epochs
Epoch 26/65
154/154 - 88s - loss: 0.3818 - accuracy: 0.8572 - val_loss: 0.4703 - val_accuracy: 0.8257
Confusion matrix: 
 [[471 102]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.122 0.878]]
Validation f1: 40.22
Validation accuracy: 82.57
Validation recall: 87.80
Validation precision: 26.09
Validation AUC: 0.35768197735610197
Validation class accuracies: [0.8219895287958116, 0.8780487804878049]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 17 epochs
Epoch 27/65
154/154 - 88s - loss: 0.3786 - accuracy: 0.8503 - val_loss: 0.4549 - val_accuracy: 0.8355
Confusion matrix: 
 [[477  96]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.122 0.878]]
Validation f1: 41.62
Validation accuracy: 83.55
Validation recall: 87.80
Validation precision: 27.27
Validation AUC: 0.3490503170094228
Validation class accuracies: [0.8324607329842932, 0.8780487804878049]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
154/154 - 89s - loss: 0.3769 - accuracy: 0.8666 - val_loss: 0.4496 - val_accuracy: 0.8371
Confusion matrix: 
 [[478  95]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.834 0.166]
 [0.122 0.878]]
Validation f1: 41.86
Validation accuracy: 83.71
Validation recall: 87.80
Validation precision: 27.48
Validation AUC: 0.3571002320847132
Validation class accuracies: [0.8342059336823735, 0.8780487804878049]
The validation tracker metric at 0.5423728813559323 hasn't increased by 0 in 19 epochs
Epoch 29/65
154/154 - 87s - loss: 0.3772 - accuracy: 0.8535 - val_loss: 0.4555 - val_accuracy: 0.8355
Confusion matrix: 
 [[477  96]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.62
Validation accuracy: 83.55
Validation recall: 87.80
Validation precision: 27.27
Validation AUC: 0.37013846007164297
Validation class accuracies: [0.8324607329842932, 0.8780487804878049]

The metrics for job 0 with the best target metric are: 
Best cm: [[528  45]
 [  9  32]]
Best normalized cm: [[0.921 0.079]
 [0.22  0.78 ]]
Best f1: 0.54
Best accuracy: 0.91
Best recall: 0.78
Best precision: 0.42
Best AUC: 0.50
Best class accuracies: [0.9214659685863874, 0.7804878048780488]
Best epoch: 9
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 13876
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_172929-19fumpov/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_172929-19fumpov/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.85354
wandb:         val_accuracy 0.8355
wandb:             _runtime 2914
wandb:           _timestamp 1624817884
wandb:                _step 217
wandb:           train_loss 0.37716
wandb:             val_loss 0.45548
wandb:           val_recall 0.87805
wandb:        val_precision 0.27273
wandb:               val_f1 0.41618
wandb:              val_auc 0.37014
wandb:                   lr 0.00013
wandb:          best_val_f1 0.54237
wandb:    best_val_accuracy 0.91205
wandb:   best_val_precision 0.41558
wandb:      best_val_recall 0.78049
wandb:             best_auc 0.49628
wandb:           best_epoch 9
wandb: Run history:
wandb:   train_accuracy ▅▅▁▇▇▇▇█▇▇███████████████████
wandb:     val_accuracy █▁▇▅█▄▇▄█▄▇▄▇█▇▇▇▆▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇█▄▃▃▃▂▂▂▂▂▂▂▂▂▁▂▂▂▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂█▄▅▁▇▂█▁▆▃▇▃▁▂▂▃▄▃▃▂▃▃▃▃▃▃▂▃
wandb:       val_recall ▁▇▇█▃█▆█▆█▇█▇▆▇▇▇▇▇▇▆▇▇▇▇▇▇▇▇
wandb:    val_precision █▁▂▂▄▁▃▁▄▁▂▁▂▃▃▃▃▂▂▂▃▂▂▂▂▂▂▂▂
wandb:           val_f1 ▂▁▅▄▆▃▇▂█▃▅▃▅█▆▆▆▅▅▅▆▆▆▅▅▆▆▆▆
wandb:          val_auc █▃▁▃▃▇▇▅▇▃▂▄▅▂▅▃▆▃▄▃▄▂▃▃▃▃▂▃▃
wandb:               lr ███████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_172929-19fumpov


 See logs at ../../new_cache/conv__2259__06_1729__v39__lstm/logs/