Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2199
Description:  newshape_and_rnn
2021-06-07 15:32:25.562057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-07 15:32:27.867447: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-07 15:32:27.868486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-07 15:32:27.926172: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:32:27.927163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-07 15:32:27.927222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 15:32:27.931905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 15:32:27.932030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-07 15:32:27.933482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-07 15:32:27.933882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-07 15:32:27.935375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-07 15:32:27.936625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-07 15:32:27.936835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 15:32:27.937013: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:32:27.938077: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:32:27.938992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2199.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2199__06_1531__v29__newshape_and_rnn
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 80, 'FACTOR': 0.25, 'PATIENCE': 8, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 30, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-07 15:33:08.296047: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-07 15:33:08.296357: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:33:08.297078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-07 15:33:08.297146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 15:33:08.297206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 15:33:08.297228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-07 15:33:08.297245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-07 15:33:08.297265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-07 15:33:08.297283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-07 15:33:08.297301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-07 15:33:08.297319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 15:33:08.297412: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:33:08.298126: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:33:08.298751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-07 15:33:08.298795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 15:33:08.973410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-07 15:33:08.973456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-07 15:33:08.973464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-07 15:33:08.973745: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:33:08.974501: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:33:08.975218: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 15:33:08.975856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-06-07 15:33:10.770564: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-07 15:33:10.772389: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-07 15:33:11.134029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 15:33:13.076485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 15:33:13.533672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
The initial learning rate for this job is: 0.001
With concat = False and six = False, size of training set: 4212...
...and size of validation set: 1072
Initializing weights...
weights = {0: 0.6724137931034483, 1: 1.95}
Model: "conv2d"
____________________________________________________________________________________________________________________________________________
Layer (type)                                  Output Shape                   Param #         Connected to                                   
============================================================================================================================================
input_1 (InputLayer)                          [(None, 1, 1250, 128, 1)]      0                                                              
____________________________________________________________________________________________________________________________________________
batch_normalization (BatchNormalization)      (None, 1, 1250, 128, 1)        4               input_1[0][0]                                  
____________________________________________________________________________________________________________________________________________
time_distributed (TimeDistributed)            (None, 1, 1250, 128, 16)       32              batch_normalization[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed)          (None, 1, 1250, 128, 16)       32              batch_normalization[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed)          (None, 1, 1250, 128, 1)        0               batch_normalization[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed)          (None, 1, 1250, 128, 16)       2320            time_distributed[0][0]                         
____________________________________________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed)          (None, 1, 1250, 128, 16)       6416            time_distributed_2[0][0]                       
____________________________________________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed)          (None, 1, 1250, 128, 16)       32              time_distributed_4[0][0]                       
____________________________________________________________________________________________________________________________________________
concatenate (Concatenate)                     (None, 1, 1250, 128, 48)       0               time_distributed_1[0][0]                       
                                                                                             time_distributed_3[0][0]                       
                                                                                             time_distributed_5[0][0]                       
____________________________________________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed)          (None, 1, 625, 64, 48)         0               concatenate[0][0]                              
____________________________________________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)    (None, 1, 625, 64, 48)         192             time_distributed_6[0][0]                       
____________________________________________________________________________________________________________________________________________
dropout (Dropout)                             (None, 1, 625, 64, 48)         0               batch_normalization_1[0][0]                    
____________________________________________________________________________________________________________________________________________
time_distributed_inverted_residual (TimeDistr (None, 1, 625, 64, 48)         40512           dropout[0][0]                                  
____________________________________________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed)          (None, 1, 313, 32, 48)         0               time_distributed_inverted_residual[0][0]       
____________________________________________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)    (None, 1, 313, 32, 48)         192             time_distributed_7[0][0]                       
____________________________________________________________________________________________________________________________________________
dropout_1 (Dropout)                           (None, 1, 313, 32, 48)         0               batch_normalization_2[0][0]                    
____________________________________________________________________________________________________________________________________________
time_distributed_8 (TimeDistributed)          (None, 1, 48)                  0               dropout_1[0][0]                                
____________________________________________________________________________________________________________________________________________
bidirectional (Bidirectional)                 (None, 1, 256)                 181248          time_distributed_8[0][0]                       
____________________________________________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)               (None, 1, 256)                 394240          bidirectional[0][0]                            
____________________________________________________________________________________________________________________________________________
dense (Dense)                                 (None, 1, 128)                 32896           bidirectional_1[0][0]                          
____________________________________________________________________________________________________________________________________________
dense_1 (Dense)                               (None, 1, 1)                   129             dense[0][0]                                    
____________________________________________________________________________________________________________________________________________
flatten (Flatten)                             (None, 1)                      0               dense_1[0][0]                                  
____________________________________________________________________________________________________________________________________________
dense_2 (Dense)                               (None, 1)                      2               flatten[0][0]                                  
============================================================================================================================================
Total params: 658,247
Trainable params: 656,805
Non-trainable params: 1,442
____________________________________________________________________________________________________________________________________________
Epoch 1/80
264/264 - 225s - loss: 0.6928 - accuracy: 0.4530 - val_loss: 0.6797 - val_accuracy: 0.7323
Confusion matrix: 
 [[784   0]
 [287   1]]
Normalized Confusion matrix: 
 [[1.         0.        ]
 [0.99652778 0.00347222]]
Validation f1: 0.69
Validation accuracy: 73.23
Validation recall: 0.35
Validation precision: 100.00
Validation AUC: 0.34056313524987947
Validation class accuracies: [1.0, 0.003472222222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 2/80
264/264 - 230s - loss: 0.6891 - accuracy: 0.5275 - val_loss: 0.6814 - val_accuracy: 0.6940
Confusion matrix: 
 [[711  73]
 [255  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90688776 0.09311224]
 [0.88541667 0.11458333]]
Validation f1: 16.75
Validation accuracy: 69.40
Validation recall: 11.46
Validation precision: 31.13
Validation AUC: 0.3331117152683739
Validation class accuracies: [0.9068877551020408, 0.11458333333333333]
The clause is activated.
The training is defaulting to either class.
Epoch 3/80
264/264 - 231s - loss: 0.6886 - accuracy: 0.5969 - val_loss: 0.7180 - val_accuracy: 0.4366
Confusion matrix: 
 [[232 552]
 [ 52 236]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.29591837 0.70408163]
 [0.18055556 0.81944444]]
Validation f1: 43.87
Validation accuracy: 43.66
Validation recall: 81.94
Validation precision: 29.95
Validation AUC: 0.31884934593676645
Validation class accuracies: [0.29591836734693877, 0.8194444444444444]
The clause is activated.
Not defaulting.
Lr has been adjusted to 0.0002500000118743628
Saving model...
Epoch 4/80
264/264 - 230s - loss: 0.6873 - accuracy: 0.5399 - val_loss: 0.6819 - val_accuracy: 0.6856
Confusion matrix: 
 [[654 130]
 [207  81]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.83418367 0.16581633]
 [0.71875    0.28125   ]]
Validation f1: 32.46
Validation accuracy: 68.56
Validation recall: 28.12
Validation precision: 38.39
Validation AUC: 0.325101811608287
Validation class accuracies: [0.8341836734693877, 0.28125]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 1 epochs
Epoch 5/80
264/264 - 230s - loss: 0.6857 - accuracy: 0.5883 - val_loss: 0.6803 - val_accuracy: 0.6959
Confusion matrix: 
 [[684 100]
 [226  62]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87244898 0.12755102]
 [0.78472222 0.21527778]]
Validation f1: 27.56
Validation accuracy: 69.59
Validation recall: 21.53
Validation precision: 38.27
Validation AUC: 0.3289655410522514
Validation class accuracies: [0.8724489795918368, 0.2152777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 2 epochs
Epoch 6/80
264/264 - 232s - loss: 0.6849 - accuracy: 0.6009 - val_loss: 0.6876 - val_accuracy: 0.6604
Confusion matrix: 
 [[602 182]
 [182 106]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.76785714 0.23214286]
 [0.63194444 0.36805556]]
Validation f1: 36.81
Validation accuracy: 66.04
Validation recall: 36.81
Validation precision: 36.81
Validation AUC: 0.32052835094044835
Validation class accuracies: [0.7678571428571429, 0.3680555555555556]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 3 epochs
Epoch 7/80
264/264 - 232s - loss: 0.6840 - accuracy: 0.5978 - val_loss: 0.6797 - val_accuracy: 0.6866
Confusion matrix: 
 [[676 108]
 [228  60]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.8622449  0.1377551 ]
 [0.79166667 0.20833333]]
Validation f1: 26.32
Validation accuracy: 68.66
Validation recall: 20.83
Validation precision: 35.71
Validation AUC: 0.3248280033480312
Validation class accuracies: [0.8622448979591837, 0.20833333333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 4 epochs
Epoch 8/80
264/264 - 230s - loss: 0.6834 - accuracy: 0.5990 - val_loss: 0.6812 - val_accuracy: 0.6931
Confusion matrix: 
 [[669 115]
 [214  74]]
Normalized Confusion matrix: 
 [[0.85331633 0.14668367]
 [0.74305556 0.25694444]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 31.03
Validation accuracy: 69.31
Validation recall: 25.69
Validation precision: 39.15
Validation AUC: 0.3334062529207539
Validation class accuracies: [0.8533163265306123, 0.2569444444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 5 epochs
Epoch 9/80
264/264 - 231s - loss: 0.6829 - accuracy: 0.5935 - val_loss: 0.6849 - val_accuracy: 0.6595
Confusion matrix: 
 [[615 169]
 [196  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78443878 0.21556122]
 [0.68055556 0.31944444]]
Validation f1: 33.52
Validation accuracy: 65.95
Validation recall: 31.94
Validation precision: 35.25
Validation AUC: 0.33132581884628276
Validation class accuracies: [0.7844387755102041, 0.3194444444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 6 epochs
Epoch 10/80
264/264 - 231s - loss: 0.6828 - accuracy: 0.5985 - val_loss: 0.6833 - val_accuracy: 0.6679
Confusion matrix: 
 [[631 153]
 [203  85]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.80484694 0.19515306]
 [0.70486111 0.29513889]]
Validation f1: 32.32
Validation accuracy: 66.79
Validation recall: 29.51
Validation precision: 35.71
Validation AUC: 0.3334917861596248
Validation class accuracies: [0.8048469387755102, 0.2951388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 7 epochs
Epoch 11/80
264/264 - 230s - loss: 0.6841 - accuracy: 0.5950 - val_loss: 0.6861 - val_accuracy: 0.6558
Confusion matrix: 
 [[607 177]
 [192  96]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77423469 0.22576531]
 [0.66666667 0.33333333]]
Validation f1: 34.22
Validation accuracy: 65.58
Validation recall: 33.33
Validation precision: 35.16
Validation AUC: 0.33550394436613007
Validation class accuracies: [0.7742346938775511, 0.3333333333333333]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 12/80
264/264 - 229s - loss: 0.6832 - accuracy: 0.6042 - val_loss: 0.6893 - val_accuracy: 0.6390
Confusion matrix: 
 [[578 206]
 [181 107]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.7372449  0.2627551 ]
 [0.62847222 0.37152778]]
Validation f1: 35.61
Validation accuracy: 63.90
Validation recall: 37.15
Validation precision: 34.19
Validation AUC: 0.3356961510059817
Validation class accuracies: [0.7372448979591837, 0.3715277777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 9 epochs
Epoch 13/80
264/264 - 230s - loss: 0.6824 - accuracy: 0.6047 - val_loss: 0.6862 - val_accuracy: 0.6623
Confusion matrix: 
 [[612 172]
 [190  98]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78061224 0.21938776]
 [0.65972222 0.34027778]]
Validation f1: 35.13
Validation accuracy: 66.23
Validation recall: 34.03
Validation precision: 36.30
Validation AUC: 0.33566308008017465
Validation class accuracies: [0.7806122448979592, 0.3402777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 10 epochs
Epoch 14/80
264/264 - 233s - loss: 0.6810 - accuracy: 0.6068 - val_loss: 0.6858 - val_accuracy: 0.6623
Confusion matrix: 
 [[614 170]
 [192  96]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78316327 0.21683673]
 [0.66666667 0.33333333]]
Validation f1: 34.66
Validation accuracy: 66.23
Validation recall: 33.33
Validation precision: 36.09
Validation AUC: 0.33440241933544057
Validation class accuracies: [0.7831632653061225, 0.3333333333333333]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 11 epochs
Epoch 15/80
264/264 - 233s - loss: 0.6826 - accuracy: 0.5969 - val_loss: 0.6893 - val_accuracy: 0.6362
Confusion matrix: 
 [[575 209]
 [181 107]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.73341837 0.26658163]
 [0.62847222 0.37152778]]
Validation f1: 35.43
Validation accuracy: 63.62
Validation recall: 37.15
Validation precision: 33.86
Validation AUC: 0.3338048131757271
Validation class accuracies: [0.7334183673469388, 0.3715277777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 12 epochs
Epoch 16/80
264/264 - 233s - loss: 0.6826 - accuracy: 0.6026 - val_loss: 0.6833 - val_accuracy: 0.6642
Confusion matrix: 
 [[627 157]
 [203  85]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.7997449  0.2002551 ]
 [0.70486111 0.29513889]]
Validation f1: 32.08
Validation accuracy: 66.42
Validation recall: 29.51
Validation precision: 35.12
Validation AUC: 0.3337790893408674
Validation class accuracies: [0.7997448979591837, 0.2951388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 13 epochs
Epoch 17/80
264/264 - 231s - loss: 0.6824 - accuracy: 0.6030 - val_loss: 0.6835 - val_accuracy: 0.6614
Confusion matrix: 
 [[624 160]
 [203  85]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.79591837 0.20408163]
 [0.70486111 0.29513889]]
Validation f1: 31.89
Validation accuracy: 66.14
Validation recall: 29.51
Validation precision: 34.69
Validation AUC: 0.3345205471046396
Validation class accuracies: [0.7959183673469388, 0.2951388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 14 epochs
Epoch 18/80
264/264 - 232s - loss: 0.6825 - accuracy: 0.6068 - val_loss: 0.6859 - val_accuracy: 0.6521
Confusion matrix: 
 [[605 179]
 [194  94]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77168367 0.22831633]
 [0.67361111 0.32638889]]
Validation f1: 33.51
Validation accuracy: 65.21
Validation recall: 32.64
Validation precision: 34.43
Validation AUC: 0.3338430419853373
Validation class accuracies: [0.7716836734693877, 0.3263888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 15 epochs
Epoch 19/80
264/264 - 228s - loss: 0.6814 - accuracy: 0.6002 - val_loss: 0.6863 - val_accuracy: 0.6483
Confusion matrix: 
 [[599 185]
 [192  96]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.76403061 0.23596939]
 [0.66666667 0.33333333]]
Validation f1: 33.74
Validation accuracy: 64.83
Validation recall: 33.33
Validation precision: 34.16
Validation AUC: 0.33319943308776867
Validation class accuracies: [0.764030612244898, 0.3333333333333333]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 20/80
264/264 - 228s - loss: 0.6813 - accuracy: 0.6059 - val_loss: 0.6852 - val_accuracy: 0.6549
Confusion matrix: 
 [[609 175]
 [195  93]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77678571 0.22321429]
 [0.67708333 0.32291667]]
Validation f1: 33.45
Validation accuracy: 65.49
Validation recall: 32.29
Validation precision: 34.70
Validation AUC: 0.3336613041700631
Validation class accuracies: [0.7767857142857143, 0.3229166666666667]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 17 epochs
Epoch 21/80
264/264 - 229s - loss: 0.6807 - accuracy: 0.6066 - val_loss: 0.6854 - val_accuracy: 0.6558
Confusion matrix: 
 [[609 175]
 [194  94]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77678571 0.22321429]
 [0.67361111 0.32638889]]
Validation f1: 33.75
Validation accuracy: 65.58
Validation recall: 32.64
Validation precision: 34.94
Validation AUC: 0.3332494332442893
Validation class accuracies: [0.7767857142857143, 0.3263888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 18 epochs
Epoch 22/80
264/264 - 231s - loss: 0.6837 - accuracy: 0.5947 - val_loss: 0.6843 - val_accuracy: 0.6586
Confusion matrix: 
 [[618 166]
 [200  88]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78826531 0.21173469]
 [0.69444444 0.30555556]]
Validation f1: 32.47
Validation accuracy: 65.86
Validation recall: 30.56
Validation precision: 34.65
Validation AUC: 0.3338060877632707
Validation class accuracies: [0.7882653061224489, 0.3055555555555556]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 19 epochs
Epoch 23/80
264/264 - 229s - loss: 0.6811 - accuracy: 0.6078 - val_loss: 0.6854 - val_accuracy: 0.6549
Confusion matrix: 
 [[608 176]
 [194  94]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.7755102  0.2244898 ]
 [0.67361111 0.32638889]]
Validation f1: 33.69
Validation accuracy: 65.49
Validation recall: 32.64
Validation precision: 34.81
Validation AUC: 0.33334628962796503
Validation class accuracies: [0.7755102040816326, 0.3263888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 20 epochs
Epoch 24/80
264/264 - 229s - loss: 0.6815 - accuracy: 0.6047 - val_loss: 0.6859 - val_accuracy: 0.6530
Confusion matrix: 
 [[606 178]
 [194  94]]
Normalized Confusion matrix: 
 [[0.77295918 0.22704082]
 [0.67361111 0.32638889]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 33.57
Validation accuracy: 65.30
Validation recall: 32.64
Validation precision: 34.56
Validation AUC: 0.33304397445598105
Validation class accuracies: [0.7729591836734694, 0.3263888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 21 epochs
Epoch 25/80
264/264 - 228s - loss: 0.6812 - accuracy: 0.6045 - val_loss: 0.6846 - val_accuracy: 0.6558
Confusion matrix: 
 [[615 169]
 [200  88]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78443878 0.21556122]
 [0.69444444 0.30555556]]
Validation f1: 32.29
Validation accuracy: 65.58
Validation recall: 30.56
Validation precision: 34.24
Validation AUC: 0.3335607879496541
Validation class accuracies: [0.7844387755102041, 0.3055555555555556]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 22 epochs
Epoch 26/80
264/264 - 230s - loss: 0.6810 - accuracy: 0.6094 - val_loss: 0.6849 - val_accuracy: 0.6567
Confusion matrix: 
 [[612 172]
 [196  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78061224 0.21938776]
 [0.68055556 0.31944444]]
Validation f1: 33.33
Validation accuracy: 65.67
Validation recall: 31.94
Validation precision: 34.85
Validation AUC: 0.3334247426117931
Validation class accuracies: [0.7806122448979592, 0.3194444444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 23 epochs
Epoch 27/80
264/264 - 231s - loss: 0.6812 - accuracy: 0.6123 - val_loss: 0.6860 - val_accuracy: 0.6530
Confusion matrix: 
 [[606 178]
 [194  94]]
Normalized Confusion matrix: 
 [[0.77295918 0.22704082]
 [0.67361111 0.32638889]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 33.57
Validation accuracy: 65.30
Validation recall: 32.64
Validation precision: 34.56
Validation AUC: 0.3329430874819376
Validation class accuracies: [0.7729591836734694, 0.3263888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 24 epochs
Lr has been adjusted to 3.906250185536919e-06
Epoch 28/80
264/264 - 229s - loss: 0.6815 - accuracy: 0.6009 - val_loss: 0.6846 - val_accuracy: 0.6558
Confusion matrix: 
 [[615 169]
 [200  88]]
Normalized Confusion matrix: 
 [[0.78443878 0.21556122]
 [0.69444444 0.30555556]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 32.29
Validation accuracy: 65.58
Validation recall: 30.56
Validation precision: 34.24
Validation AUC: 0.33319004551723186
Validation class accuracies: [0.7844387755102041, 0.3055555555555556]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 25 epochs
Epoch 29/80
264/264 - 229s - loss: 0.6826 - accuracy: 0.5981 - val_loss: 0.6850 - val_accuracy: 0.6549
Confusion matrix: 
 [[610 174]
 [196  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77806122 0.22193878]
 [0.68055556 0.31944444]]
Validation f1: 33.21
Validation accuracy: 65.49
Validation recall: 31.94
Validation precision: 34.59
Validation AUC: 0.33321980359124903
Validation class accuracies: [0.7780612244897959, 0.3194444444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 26 epochs
Epoch 30/80
264/264 - 230s - loss: 0.6812 - accuracy: 0.5997 - val_loss: 0.6851 - val_accuracy: 0.6549
Confusion matrix: 
 [[610 174]
 [196  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77806122 0.22193878]
 [0.68055556 0.31944444]]
Validation f1: 33.21
Validation accuracy: 65.49
Validation recall: 31.94
Validation precision: 34.59
Validation AUC: 0.3332394510321053
Validation class accuracies: [0.7780612244897959, 0.3194444444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 27 epochs
Epoch 31/80
264/264 - 231s - loss: 0.6819 - accuracy: 0.6007 - val_loss: 0.6854 - val_accuracy: 0.6539
Confusion matrix: 
 [[608 176]
 [195  93]]
Normalized Confusion matrix: 
 [[0.7755102  0.2244898 ]
 [0.67708333 0.32291667]]
Validation f1: 33.39
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 65.39
Validation recall: 32.29
Validation precision: 34.57
Validation AUC: 0.33336477639650297
Validation class accuracies: [0.7755102040816326, 0.3229166666666667]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 28 epochs
Epoch 32/80
264/264 - 229s - loss: 0.6824 - accuracy: 0.6009 - val_loss: 0.6848 - val_accuracy: 0.6539
Confusion matrix: 
 [[611 173]
 [198  90]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77933673 0.22066327]
 [0.6875     0.3125    ]]
Validation f1: 32.67
Validation accuracy: 65.39
Validation recall: 31.25
Validation precision: 34.22
Validation AUC: 0.33326755183422163
Validation class accuracies: [0.7793367346938775, 0.3125]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4386617100371747 hasn't increased by 0 in 29 epochs
Epoch 33/80
264/264 - 231s - loss: 0.6828 - accuracy: 0.6021 - val_loss: 0.6851 - val_accuracy: 0.6530
Confusion matrix: 
 [[608 176]
 [196  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.7755102  0.2244898 ]
 [0.68055556 0.31944444]]
Validation f1: 33.09
Validation accuracy: 65.30
Validation recall: 31.94
Validation precision: 34.33
Validation AUC: 0.33312235886607705
Validation class accuracies: [0.7755102040816326, 0.3194444444444444]

The metrics for job 0 with the best target metric are: 
Best cm: [[232 552]
 [ 52 236]]
Best normalized cm: [[0.29591837 0.70408163]
 [0.18055556 0.81944444]]
Best f1: 0.44
Best accuracy: 0.44
Best recall: 0.82
Best precision: 0.30
Best AUC: 0.32
Best class accuracies: [0.29591836734693877, 0.8194444444444444]
Best epoch: 3
The clause is activated.
Not defaulting.
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[21 32]
 [ 8 14]]
F1: 0.411764705882353
AUC: 0.5236890645586297
Accuracy: 0.4666666666666667
Precision: 0.30434782608695654
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2199__06_1531__v29__newshape_and_rnn/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[38 15]
 [14  8]]
F1: 0.3555555555555555
AUC: 0.449064558629776
Accuracy: 0.6133333333333333
Precision: 0.34782608695652173
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2199__06_1531__v29__newshape_and_rnn/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[43 10]
 [19  3]]
F1: 0.1714285714285714
AUC: 0.31023310023310025
Accuracy: 0.6133333333333333
Precision: 0.23076923076923078
Recall: 0.13636363636363635
Ended. Saving the Excel Sheet ../../new_cache/conv__2199__06_1531__v29__newshape_and_rnn/validation_sheet_80.xls...
Done.
Epoch: epoch3
Starting...
CM: [[20 33]
 [ 5 17]]
F1: 0.47222222222222227
AUC: 0.5896969696969697
Accuracy: 0.49333333333333335
Precision: 0.34
Recall: 0.7727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2199__06_1531__v29__newshape_and_rnn/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[34 19]
 [ 7 15]]
F1: 0.5357142857142857
AUC: 0.6081639928698752
Accuracy: 0.6533333333333333
Precision: 0.4411764705882353
Recall: 0.6818181818181818
Ended. Saving the Excel Sheet ../../new_cache/conv__2199__06_1531__v29__newshape_and_rnn/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[39 14]
 [15  7]]
F1: 0.3255813953488372
AUC: 0.4257575757575758
Accuracy: 0.6133333333333333
Precision: 0.3333333333333333
Recall: 0.3181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2199__06_1531__v29__newshape_and_rnn/validation_sheet_epoch3.xls...
Done.
-----------------------
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 80, 'FACTOR': 0.25, 'PATIENCE': 8, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 30, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
-----------------------
Collecting Variables...
All variables have been collected.
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4275 with pneumonia: 1100 and non-pneumonia: 3175
Length of training samples after audio augmentation: 4775
Length of training samples after spec augmentation: 4925
-----------------------
Number of train recordings: 4925 with pneumonia: 1750 and non-pneumonia: 3175
Number of val recordings: 1009 with pneumonia: 268 and non-pneumonia: 741
-----------------------
The initial learning rate for this job is: 0.000868020304568528
With concat = False and six = False, size of training set: 4925...
...and size of validation set: 1009
Initializing weights...
weights = {0: 0.7755905511811023, 1: 1.4071428571428573}
Model: "conv2d"
____________________________________________________________________________________________________________________________________________
Layer (type)                                  Output Shape                   Param #         Connected to                                   
============================================================================================================================================
input_8 (InputLayer)                          [(None, 1, 1250, 128, 1)]      0                                                              
____________________________________________________________________________________________________________________________________________
batch_normalization_21 (BatchNormalization)   (None, 1, 1250, 128, 1)        4               input_8[0][0]                                  
____________________________________________________________________________________________________________________________________________
time_distributed_63 (TimeDistributed)         (None, 1, 1250, 128, 16)       32              batch_normalization_21[0][0]                   
____________________________________________________________________________________________________________________________________________
time_distributed_65 (TimeDistributed)         (None, 1, 1250, 128, 16)       32              batch_normalization_21[0][0]                   
____________________________________________________________________________________________________________________________________________
time_distributed_67 (TimeDistributed)         (None, 1, 1250, 128, 1)        0               batch_normalization_21[0][0]                   
____________________________________________________________________________________________________________________________________________
time_distributed_64 (TimeDistributed)         (None, 1, 1250, 128, 16)       2320            time_distributed_63[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_66 (TimeDistributed)         (None, 1, 1250, 128, 16)       6416            time_distributed_65[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_68 (TimeDistributed)         (None, 1, 1250, 128, 16)       32              time_distributed_67[0][0]                      
____________________________________________________________________________________________________________________________________________
concatenate_7 (Concatenate)                   (None, 1, 1250, 128, 48)       0               time_distributed_64[0][0]                      
                                                                                             time_distributed_66[0][0]                      
                                                                                             time_distributed_68[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_69 (TimeDistributed)         (None, 1, 625, 64, 48)         0               concatenate_7[0][0]                            
____________________________________________________________________________________________________________________________________________
batch_normalization_22 (BatchNormalization)   (None, 1, 625, 64, 48)         192             time_distributed_69[0][0]                      
____________________________________________________________________________________________________________________________________________
dropout_14 (Dropout)                          (None, 1, 625, 64, 48)         0               batch_normalization_22[0][0]                   
____________________________________________________________________________________________________________________________________________
time_distributed_inverted_residual_7 (TimeDis (None, 1, 625, 64, 48)         40512           dropout_14[0][0]                               
____________________________________________________________________________________________________________________________________________
time_distributed_70 (TimeDistributed)         (None, 1, 313, 32, 48)         0               time_distributed_inverted_residual_7[0][0]     
____________________________________________________________________________________________________________________________________________
batch_normalization_23 (BatchNormalization)   (None, 1, 313, 32, 48)         192             time_distributed_70[0][0]                      
____________________________________________________________________________________________________________________________________________
dropout_15 (Dropout)                          (None, 1, 313, 32, 48)         0               batch_normalization_23[0][0]                   
____________________________________________________________________________________________________________________________________________
time_distributed_71 (TimeDistributed)         (None, 1, 48)                  0               dropout_15[0][0]                               
____________________________________________________________________________________________________________________________________________
bidirectional_14 (Bidirectional)              (None, 1, 256)                 181248          time_distributed_71[0][0]                      
____________________________________________________________________________________________________________________________________________
bidirectional_15 (Bidirectional)              (None, 1, 256)                 394240          bidirectional_14[0][0]                         
____________________________________________________________________________________________________________________________________________
dense_21 (Dense)                              (None, 1, 128)                 32896           bidirectional_15[0][0]                         
____________________________________________________________________________________________________________________________________________
dense_22 (Dense)                              (None, 1, 1)                   129             dense_21[0][0]                                 
____________________________________________________________________________________________________________________________________________
flatten_7 (Flatten)                           (None, 1)                      0               dense_22[0][0]                                 
____________________________________________________________________________________________________________________________________________
dense_23 (Dense)                              (None, 1)                      2               flatten_7[0][0]                                
============================================================================================================================================
Total params: 658,247
Trainable params: 656,805
Non-trainable params: 1,442
____________________________________________________________________________________________________________________________________________
Epoch 1/80
308/308 - 264s - loss: 0.6595 - accuracy: 0.7165 - val_loss: 0.7254 - val_accuracy: 0.2765
Confusion matrix: 
 [[ 18 723]
 [  7 261]]
Normalized Confusion matrix: 
 [[0.0242915 0.9757085]
 [0.0261194 0.9738806]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.69
Validation accuracy: 27.65
Validation recall: 97.39
Validation precision: 26.52
Validation AUC: 0.35849640618906015
Validation class accuracies: [0.024291497975708502, 0.9738805970149254]
The clause is activated.
The training is defaulting to either class.
Epoch 2/80
308/308 - 266s - loss: 0.6198 - accuracy: 0.7734 - val_loss: 0.5923 - val_accuracy: 0.6759
Confusion matrix: 
 [[609 132]
 [195  73]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82186235 0.17813765]
 [0.72761194 0.27238806]]
Validation f1: 30.87
Validation accuracy: 67.59
Validation recall: 27.24
Validation precision: 35.61
Validation AUC: 0.3462546064140826
Validation class accuracies: [0.8218623481781376, 0.27238805970149255]
The clause is activated.
Not defaulting.
Lr has been adjusted to 0.0002500000118743628
Saving model...
Epoch 3/80
308/308 - 264s - loss: 0.6014 - accuracy: 0.7939 - val_loss: 0.6298 - val_accuracy: 0.6065
Confusion matrix: 
 [[522 219]
 [178  90]]
Normalized Confusion matrix: 
 [[0.70445344 0.29554656]
 [0.6641791  0.3358209 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 31.20
Validation accuracy: 60.65
Validation recall: 33.58
Validation precision: 29.13
Validation AUC: 0.2968656789441172
Validation class accuracies: [0.7044534412955465, 0.3358208955223881]
The clause is activated.
Not defaulting.
Lr has been adjusted to 6.25000029685907e-05
Saving model...
Epoch 4/80
308/308 - 264s - loss: 0.5951 - accuracy: 0.8126 - val_loss: 0.5978 - val_accuracy: 0.6789
Confusion matrix: 
 [[654  87]
 [237  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88259109 0.11740891]
 [0.88432836 0.11567164]]
Validation f1: 16.06
Validation accuracy: 67.89
Validation recall: 11.57
Validation precision: 26.27
Validation AUC: 0.28959613154820524
Validation class accuracies: [0.8825910931174089, 0.11567164179104478]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 1 epochs
Epoch 5/80
308/308 - 265s - loss: 0.5955 - accuracy: 0.8114 - val_loss: 0.5870 - val_accuracy: 0.7027
Confusion matrix: 
 [[682  59]
 [241  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92037787 0.07962213]
 [0.89925373 0.10074627]]
Validation f1: 15.25
Validation accuracy: 70.27
Validation recall: 10.07
Validation precision: 31.40
Validation AUC: 0.3026853896566174
Validation class accuracies: [0.9203778677462888, 0.10074626865671642]
The clause is activated.
The training is defaulting to either class.
Epoch 6/80
308/308 - 265s - loss: 0.5930 - accuracy: 0.8148 - val_loss: 0.5958 - val_accuracy: 0.6838
Confusion matrix: 
 [[655  86]
 [233  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88394062 0.11605938]
 [0.86940299 0.13059701]]
Validation f1: 17.99
Validation accuracy: 68.38
Validation recall: 13.06
Validation precision: 28.93
Validation AUC: 0.295046110507992
Validation class accuracies: [0.8839406207827261, 0.13059701492537312]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 2 epochs
Epoch 7/80
308/308 - 265s - loss: 0.5921 - accuracy: 0.8156 - val_loss: 0.5945 - val_accuracy: 0.6868
Confusion matrix: 
 [[662  79]
 [237  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89338731 0.10661269]
 [0.88432836 0.11567164]]
Validation f1: 16.40
Validation accuracy: 68.68
Validation recall: 11.57
Validation precision: 28.18
Validation AUC: 0.29372887197003195
Validation class accuracies: [0.893387314439946, 0.11567164179104478]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 3 epochs
Epoch 8/80
308/308 - 264s - loss: 0.5889 - accuracy: 0.8193 - val_loss: 0.5996 - val_accuracy: 0.6759
Confusion matrix: 
 [[641 100]
 [227  41]]
Normalized Confusion matrix: 
 [[0.86504723 0.13495277]
 [0.84701493 0.15298507]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.05
Validation accuracy: 67.59
Validation recall: 15.30
Validation precision: 29.08
Validation AUC: 0.2922974758953042
Validation class accuracies: [0.865047233468286, 0.15298507462686567]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 4 epochs
Epoch 9/80
308/308 - 262s - loss: 0.5886 - accuracy: 0.8179 - val_loss: 0.5930 - val_accuracy: 0.6918
Confusion matrix: 
 [[667  74]
 [237  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90013495 0.09986505]
 [0.88432836 0.11567164]]
Validation f1: 16.62
Validation accuracy: 69.18
Validation recall: 11.57
Validation precision: 29.52
Validation AUC: 0.29516898387606844
Validation class accuracies: [0.9001349527665317, 0.11567164179104478]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 5 epochs
Epoch 10/80
308/308 - 262s - loss: 0.5893 - accuracy: 0.8162 - val_loss: 0.5971 - val_accuracy: 0.6868
Confusion matrix: 
 [[659  82]
 [234  34]]
Normalized Confusion matrix: 
 [[0.88933873 0.11066127]
 [0.87313433 0.12686567]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.71
Validation accuracy: 68.68
Validation recall: 12.69
Validation precision: 29.31
Validation AUC: 0.29025792276923035
Validation class accuracies: [0.8893387314439946, 0.12686567164179105]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 6 epochs
Epoch 11/80
308/308 - 263s - loss: 0.5875 - accuracy: 0.8177 - val_loss: 0.5912 - val_accuracy: 0.6957
Confusion matrix: 
 [[672  69]
 [238  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90688259 0.09311741]
 [0.8880597  0.1119403 ]]
Validation f1: 16.35
Validation accuracy: 69.57
Validation recall: 11.19
Validation precision: 30.30
Validation AUC: 0.2992929535916451
Validation class accuracies: [0.9068825910931174, 0.11194029850746269]
The clause is activated.
The training is defaulting to either class.
Epoch 12/80
308/308 - 263s - loss: 0.5886 - accuracy: 0.8213 - val_loss: 0.5970 - val_accuracy: 0.6829
Confusion matrix: 
 [[653  88]
 [232  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88124157 0.11875843]
 [0.86567164 0.13432836]]
Validation f1: 18.37
Validation accuracy: 68.29
Validation recall: 13.43
Validation precision: 29.03
Validation AUC: 0.2920850487480461
Validation class accuracies: [0.8812415654520918, 0.13432835820895522]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 7 epochs
Epoch 13/80
308/308 - 262s - loss: 0.5861 - accuracy: 0.8209 - val_loss: 0.5942 - val_accuracy: 0.6908
Confusion matrix: 
 [[667  74]
 [238  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90013495 0.09986505]
 [0.8880597  0.1119403 ]]
Validation f1: 16.13
Validation accuracy: 69.08
Validation recall: 11.19
Validation precision: 28.85
Validation AUC: 0.2915056778545297
Validation class accuracies: [0.9001349527665317, 0.11194029850746269]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 14/80
308/308 - 262s - loss: 0.5865 - accuracy: 0.8205 - val_loss: 0.5933 - val_accuracy: 0.6938
Confusion matrix: 
 [[670  71]
 [238  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90418354 0.09581646]
 [0.8880597  0.1119403 ]]
Validation f1: 16.26
Validation accuracy: 69.38
Validation recall: 11.19
Validation precision: 29.70
Validation AUC: 0.29322843691817735
Validation class accuracies: [0.9041835357624831, 0.11194029850746269]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 9 epochs
Epoch 15/80
308/308 - 262s - loss: 0.5879 - accuracy: 0.8199 - val_loss: 0.5942 - val_accuracy: 0.6918
Confusion matrix: 
 [[667  74]
 [237  31]]
Normalized Confusion matrix: 
 [[0.90013495 0.09986505]
 [0.88432836 0.11567164]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 16.62
Validation accuracy: 69.18
Validation recall: 11.57
Validation precision: 29.52
Validation AUC: 0.29269636487076006
Validation class accuracies: [0.9001349527665317, 0.11567164179104478]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 10 epochs
Epoch 16/80
308/308 - 263s - loss: 0.5871 - accuracy: 0.8193 - val_loss: 0.5937 - val_accuracy: 0.6928
Confusion matrix: 
 [[668  73]
 [237  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90148448 0.09851552]
 [0.88432836 0.11567164]]
Validation f1: 16.67
Validation accuracy: 69.28
Validation recall: 11.57
Validation precision: 29.81
Validation AUC: 0.29262272426259633
Validation class accuracies: [0.9014844804318488, 0.11567164179104478]
2021-06-07 19:17:23.281783: W tensorflow/core/framework/op_kernel.cc:1763] OP_REQUIRES failed at whole_file_read_ops.cc:116 : Not found: ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000/augmented_3/0270719_170801_003-1_F_1___1_v36_138.txt; No such file or directory
The clause is activated.
Not defaulting.
The validation tracker metric at 0.3119584055459272 hasn't increased by 0 in 11 epochs
Epoch 17/80
2021-06-07 19:17:23.807734: W tensorflow/core/framework/op_kernel.cc:1763] OP_REQUIRES failed at whole_file_read_ops.cc:116 : Not found: ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000/augmented_3/0271146_170812-001-4_F_3___1_v36_107.txt; No such file or directory
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/context.py", line 2113, in execution_mode
    yield
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/iterator_ops.py", line 733, in _next_internal
    output_shapes=self._flat_output_shapes)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/ops/gen_dataset_ops.py", line 2579, in iterator_get_next
    _ops.raise_from_not_ok_status(e, name)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 6862, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.NotFoundError: ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000/augmented_3/0270719_170801_003-1_F_1___1_v36_138.txt; No such file or directory
	 [[{{node ReadFile}}]] [Op:IteratorGetNext]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2199.py", line 588, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2199.py", line 489, in train_model
    callbacks=[metrics_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/integration/keras/keras.py", line 124, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1100, in fit
    tmp_logs = self.train_function(iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 805, in train_function
    return step_function(self, iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 794, in step_function
    data = next(iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/iterator_ops.py", line 747, in __next__
    return self._next_internal()
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/iterator_ops.py", line 739, in _next_internal
    return structure.from_compatible_tensor_list(self._element_spec, ret)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/context.py", line 2116, in execution_mode
    executor_new.wait()
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/executor.py", line 69, in wait
    pywrap_tfe.TFE_ExecutorWaitForAllPendingNodes(self._handle)
tensorflow.python.framework.errors_impl.NotFoundError: ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000/augmented_3/0270719_170801_003-1_F_1___1_v36_138.txt; No such file or directory
	 [[{{node ReadFile}}]]
wandb: Waiting for W&B process to finish, PID 10243
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_153228-12685qgb/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_153228-12685qgb/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.81929
wandb:         val_accuracy 0.69277
wandb:             _runtime 13494
wandb:           _timestamp 1623093443
wandb:                _step 354
wandb:           train_loss 0.58713
wandb:             val_loss 0.59371
wandb:           val_recall 0.11567
wandb:        val_precision 0.29808
wandb:               val_f1 0.16667
wandb:              val_auc 0.29262
wandb:                   lr 2e-05
wandb:          best_val_f1 0.43866
wandb:    best_val_accuracy 0.43657
wandb:   best_val_precision 0.29949
wandb:      best_val_recall 0.81944
wandb:             best_auc 0.31885
wandb:           best_epoch 3
wandb:           best_bd_f1 0.53571
wandb:          best_bd_auc 0.60816
wandb:     best_bd_accuracy 0.65333
wandb:    best_bd_precision 0.44118
wandb:       best_bd_recall 0.68182
wandb:        best_bd_epoch epoch3
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_153228-12685qgb


 See logs at ../../new_cache/conv__2199__06_1531__v29__newshape_and_rnn/logs/