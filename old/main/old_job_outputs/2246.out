Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2246
Description:  icbhi_pneumoniajordan_seaprated
2021-06-23 18:11:20.853714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-23 18:11:23.533089: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 18:11:23.534025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-23 18:11:23.546785: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:23.547493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 18:11:23.547521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 18:11:23.550900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 18:11:23.550992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 18:11:23.552073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 18:11:23.552351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 18:11:23.553297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 18:11:23.554209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 18:11:23.554377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 18:11:23.554482: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:23.555218: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:23.555846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2246.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-23 18:11:28.853606: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 18:11:28.853908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:28.854649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 18:11:28.854704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 18:11:28.854769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 18:11:28.854797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 18:11:28.854825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 18:11:28.854855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 18:11:28.854889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 18:11:28.854915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 18:11:28.854940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 18:11:28.855067: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:28.855817: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:28.856487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-23 18:11:28.856540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 18:11:29.698952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-23 18:11:29.699005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-23 18:11:29.699014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-23 18:11:29.699271: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:29.700060: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:29.700783: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 18:11:29.701461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-23 18:11:30.986197: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-23 18:11:30.988239: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-23 18:11:31.406582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 18:11:33.889782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 18:11:34.422725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 74s - loss: 0.4862 - accuracy: 0.6961 - val_loss: 0.4773 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.10381711279908383
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 67s - loss: 0.3514 - accuracy: 0.8352 - val_loss: 0.3376 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.10051889972798037
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 68s - loss: 0.2546 - accuracy: 0.8885 - val_loss: 0.2565 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12771497184114744
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 67s - loss: 0.1863 - accuracy: 0.9243 - val_loss: 0.2186 - val_accuracy: 0.9414
Confusion matrix: 
 [[573   0]
 [ 36   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.878 0.122]]
Validation f1: 21.74
Validation accuracy: 94.14
Validation recall: 12.20
Validation precision: 100.00
Validation AUC: 0.5702221570579112
Validation class accuracies: [1.0, 0.12195121951219512]
Saving model...
Epoch 5/65
154/154 - 67s - loss: 0.1491 - accuracy: 0.9378 - val_loss: 1.3532 - val_accuracy: 0.4381
Confusion matrix: 
 [[228 345]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.398 0.602]
 [0.    1.   ]]
Validation f1: 19.20
Validation accuracy: 43.81
Validation recall: 100.00
Validation precision: 10.62
Validation AUC: 0.704170647425666
Validation class accuracies: [0.39790575916230364, 1.0]
The validation tracker metric at 0.21739130434782605 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 68s - loss: 0.0972 - accuracy: 0.9565 - val_loss: 0.2100 - val_accuracy: 0.9349
Confusion matrix: 
 [[555  18]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.537 0.463]]
Validation f1: 48.72
Validation accuracy: 93.49
Validation recall: 46.34
Validation precision: 51.35
Validation AUC: 0.580023260535179
Validation class accuracies: [0.9685863874345549, 0.4634146341463415]
Saving model...
Epoch 7/65
154/154 - 67s - loss: 0.0656 - accuracy: 0.9736 - val_loss: 0.4128 - val_accuracy: 0.8827
Confusion matrix: 
 [[511  62]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.244 0.756]]
Validation f1: 46.27
Validation accuracy: 88.27
Validation recall: 75.61
Validation precision: 33.33
Validation AUC: 0.5862304505713953
Validation class accuracies: [0.8917975567190227, 0.7560975609756098]
The validation tracker metric at 0.48717948717948717 hasn't increased by 0 in 1 epochs
Epoch 8/65
154/154 - 67s - loss: 0.0598 - accuracy: 0.9825 - val_loss: 1.8879 - val_accuracy: 0.4837
Confusion matrix: 
 [[256 317]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.447 0.553]
 [0.    1.   ]]
Validation f1: 20.55
Validation accuracy: 48.37
Validation recall: 100.00
Validation precision: 11.45
Validation AUC: 0.6396225306974885
Validation class accuracies: [0.4467713787085515, 1.0]
The validation tracker metric at 0.48717948717948717 hasn't increased by 0 in 2 epochs
Epoch 9/65
154/154 - 67s - loss: 0.0663 - accuracy: 0.9764 - val_loss: 0.2597 - val_accuracy: 0.9186
Confusion matrix: 
 [[534  39]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.268 0.732]]
Validation f1: 54.55
Validation accuracy: 91.86
Validation recall: 73.17
Validation precision: 43.48
Validation AUC: 0.6166457795098319
Validation class accuracies: [0.9319371727748691, 0.7317073170731707]
Saving model...
Epoch 10/65
154/154 - 67s - loss: 0.0416 - accuracy: 0.9841 - val_loss: 0.3130 - val_accuracy: 0.9267
Confusion matrix: 
 [[544  29]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.39  0.61 ]]
Validation f1: 52.63
Validation accuracy: 92.67
Validation recall: 60.98
Validation precision: 46.30
Validation AUC: 0.559954153276565
Validation class accuracies: [0.9493891797556719, 0.6097560975609756]
The validation tracker metric at 0.5454545454545455 hasn't increased by 0 in 1 epochs
Epoch 11/65
154/154 - 67s - loss: 0.0444 - accuracy: 0.9833 - val_loss: 0.4248 - val_accuracy: 0.8941
Confusion matrix: 
 [[516  57]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.195 0.805]]
Validation f1: 50.38
Validation accuracy: 89.41
Validation recall: 80.49
Validation precision: 36.67
Validation AUC: 0.6312471289621266
Validation class accuracies: [0.900523560209424, 0.8048780487804879]
The validation tracker metric at 0.5454545454545455 hasn't increased by 0 in 2 epochs
Epoch 12/65
154/154 - 67s - loss: 0.0289 - accuracy: 0.9910 - val_loss: 0.2392 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.6258566979108184
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
Saving model...
Epoch 13/65
154/154 - 67s - loss: 0.0474 - accuracy: 0.9862 - val_loss: 0.2821 - val_accuracy: 0.9300
Confusion matrix: 
 [[544  29]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.341 0.659]]
Validation f1: 55.67
Validation accuracy: 93.00
Validation recall: 65.85
Validation precision: 48.21
Validation AUC: 0.6780026764487056
Validation class accuracies: [0.9493891797556719, 0.6585365853658537]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 1 epochs
Epoch 14/65
154/154 - 67s - loss: 0.0271 - accuracy: 0.9906 - val_loss: 0.3037 - val_accuracy: 0.9186
Confusion matrix: 
 [[535  38]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.293 0.707]]
Validation f1: 53.70
Validation accuracy: 91.86
Validation recall: 70.73
Validation precision: 43.28
Validation AUC: 0.6383375415172305
Validation class accuracies: [0.9336823734729494, 0.7073170731707317]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 2 epochs
Epoch 15/65
154/154 - 67s - loss: 0.0154 - accuracy: 0.9959 - val_loss: 0.2732 - val_accuracy: 0.9381
Confusion matrix: 
 [[548  25]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.317 0.683]]
Validation f1: 59.57
Validation accuracy: 93.81
Validation recall: 68.29
Validation precision: 52.83
Validation AUC: 0.6372108233669674
Validation class accuracies: [0.956369982547993, 0.6829268292682927]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 3 epochs
Epoch 16/65
154/154 - 67s - loss: 0.0267 - accuracy: 0.9906 - val_loss: 0.4414 - val_accuracy: 0.9104
Confusion matrix: 
 [[527  46]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92 0.08]
 [0.22 0.78]]
Validation f1: 53.78
Validation accuracy: 91.04
Validation recall: 78.05
Validation precision: 41.03
Validation AUC: 0.6056112511415066
Validation class accuracies: [0.9197207678883071, 0.7804878048780488]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 4 epochs
Epoch 17/65
154/154 - 67s - loss: 0.0100 - accuracy: 0.9984 - val_loss: 0.3392 - val_accuracy: 0.9283
Confusion matrix: 
 [[541  32]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.293 0.707]]
Validation f1: 56.86
Validation accuracy: 92.83
Validation recall: 70.73
Validation precision: 47.54
Validation AUC: 0.614614235623399
Validation class accuracies: [0.944153577661431, 0.7073170731707317]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 5 epochs
Epoch 18/65
154/154 - 67s - loss: 0.0217 - accuracy: 0.9931 - val_loss: 0.2833 - val_accuracy: 0.9169
Confusion matrix: 
 [[533  40]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.268 0.732]]
Validation f1: 54.05
Validation accuracy: 91.69
Validation recall: 73.17
Validation precision: 42.86
Validation AUC: 0.6632862550580287
Validation class accuracies: [0.9301919720767888, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 19/65
154/154 - 67s - loss: 0.0067 - accuracy: 0.9996 - val_loss: 0.3322 - val_accuracy: 0.9153
Confusion matrix: 
 [[532  41]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.268 0.732]]
Validation f1: 53.57
Validation accuracy: 91.53
Validation recall: 73.17
Validation precision: 42.25
Validation AUC: 0.6471819158395167
Validation class accuracies: [0.9284467713787086, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 7 epochs
Epoch 20/65
154/154 - 67s - loss: 0.0087 - accuracy: 0.9992 - val_loss: 0.3938 - val_accuracy: 0.9121
Confusion matrix: 
 [[528  45]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.22  0.78 ]]
Validation f1: 54.24
Validation accuracy: 91.21
Validation recall: 78.05
Validation precision: 41.56
Validation AUC: 0.6386925066791449
Validation class accuracies: [0.9214659685863874, 0.7804878048780488]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 8 epochs
Epoch 21/65
154/154 - 67s - loss: 0.0053 - accuracy: 0.9996 - val_loss: 0.4441 - val_accuracy: 0.9007
Confusion matrix: 
 [[521  52]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.22  0.78 ]]
Validation f1: 51.20
Validation accuracy: 90.07
Validation recall: 78.05
Validation precision: 38.10
Validation AUC: 0.6137132252737819
Validation class accuracies: [0.9092495636998255, 0.7804878048780488]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 9 epochs
Epoch 22/65
154/154 - 67s - loss: 0.0061 - accuracy: 1.0000 - val_loss: 0.4233 - val_accuracy: 0.8958
Confusion matrix: 
 [[521  52]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.293 0.707]]
Validation f1: 47.54
Validation accuracy: 89.58
Validation recall: 70.73
Validation precision: 35.80
Validation AUC: 0.6531085490679185
Validation class accuracies: [0.9092495636998255, 0.7073170731707317]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 10 epochs
Epoch 23/65
154/154 - 67s - loss: 0.0044 - accuracy: 1.0000 - val_loss: 0.3786 - val_accuracy: 0.9088
Confusion matrix: 
 [[528  45]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.268 0.732]]
Validation f1: 51.72
Validation accuracy: 90.88
Validation recall: 73.17
Validation precision: 40.00
Validation AUC: 0.6705308136056971
Validation class accuracies: [0.9214659685863874, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 11 epochs
Epoch 24/65
154/154 - 68s - loss: 0.0037 - accuracy: 1.0000 - val_loss: 0.3369 - val_accuracy: 0.9186
Confusion matrix: 
 [[535  38]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.70
Validation accuracy: 91.86
Validation recall: 70.73
Validation precision: 43.28
Validation AUC: 0.6642207943526528
Validation class accuracies: [0.9336823734729494, 0.7073170731707317]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 25/65
154/154 - 67s - loss: 0.0046 - accuracy: 1.0000 - val_loss: 0.3847 - val_accuracy: 0.9153
Confusion matrix: 
 [[532  41]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.57
Validation accuracy: 91.53
Validation recall: 73.17
Validation precision: 42.25
Validation AUC: 0.6401281813545008
Validation class accuracies: [0.9284467713787086, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 13 epochs
Epoch 26/65
154/154 - 67s - loss: 0.0037 - accuracy: 1.0000 - val_loss: 0.3828 - val_accuracy: 0.9104
Confusion matrix: 
 [[529  44]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.268 0.732]]
Validation f1: 52.17
Validation accuracy: 91.04
Validation recall: 73.17
Validation precision: 40.54
Validation AUC: 0.637732728549174
Validation class accuracies: [0.9232111692844677, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 14 epochs
Epoch 27/65
154/154 - 67s - loss: 0.0035 - accuracy: 1.0000 - val_loss: 0.4085 - val_accuracy: 0.9104
Confusion matrix: 
 [[528  45]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.244 0.756]]
Validation f1: 52.99
Validation accuracy: 91.04
Validation recall: 75.61
Validation precision: 40.79
Validation AUC: 0.6402644062616633
Validation class accuracies: [0.9214659685863874, 0.7560975609756098]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 15 epochs
Epoch 28/65
154/154 - 67s - loss: 0.0031 - accuracy: 1.0000 - val_loss: 0.3853 - val_accuracy: 0.9104
Confusion matrix: 
 [[529  44]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.17
Validation accuracy: 91.04
Validation recall: 73.17
Validation precision: 40.54
Validation AUC: 0.6433545816659889
Validation class accuracies: [0.9232111692844677, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 16 epochs
Epoch 29/65
154/154 - 67s - loss: 0.0047 - accuracy: 0.9992 - val_loss: 0.5139 - val_accuracy: 0.9007
Confusion matrix: 
 [[522  51]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.244 0.756]]
Validation f1: 50.41
Validation accuracy: 90.07
Validation recall: 75.61
Validation precision: 37.80
Validation AUC: 0.6199772784785177
Validation class accuracies: [0.9109947643979057, 0.7560975609756098]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 17 epochs
Epoch 30/65
154/154 - 67s - loss: 0.0036 - accuracy: 1.0000 - val_loss: 0.3745 - val_accuracy: 0.9202
Confusion matrix: 
 [[536  37]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.293 0.707]]
Validation f1: 54.21
Validation accuracy: 92.02
Validation recall: 70.73
Validation precision: 43.94
Validation AUC: 0.6235476576486809
Validation class accuracies: [0.9354275741710296, 0.7073170731707317]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 31/65
154/154 - 67s - loss: 0.0033 - accuracy: 1.0000 - val_loss: 0.3992 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.6216932659637849
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 19 epochs
Epoch 32/65
154/154 - 67s - loss: 0.0032 - accuracy: 1.0000 - val_loss: 0.3931 - val_accuracy: 0.9153
Confusion matrix: 
 [[533  40]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.293 0.707]]
Validation f1: 52.73
Validation accuracy: 91.53
Validation recall: 70.73
Validation precision: 42.03
Validation AUC: 0.6268751033317624
Validation class accuracies: [0.9301919720767888, 0.7073170731707317]

The metrics for job 0 with the best target metric are: 
Best cm: [[555  18]
 [ 14  27]]
Best normalized cm: [[0.969 0.031]
 [0.341 0.659]]
Best f1: 0.63
Best accuracy: 0.95
Best recall: 0.66
Best precision: 0.60
Best AUC: 0.63
Best class accuracies: [0.9685863874345549, 0.6585365853658537]
Best epoch: 12
The number of epochs since last 1% equals the patience
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.454]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[6.605e-05]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.087]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.357]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.007e-05]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.037]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.999]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[9.825e-05]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[4.83e-05]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.375]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.041]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[9.213e-05]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.324]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_1.png, [[0.674]]
../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.582]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 28069
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_181123-1hpoai27/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_181123-1hpoai27/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.91531
wandb:             _runtime 2537
wandb:           _timestamp 1624474421
wandb:                _step 235
wandb:           train_loss 0.00316
wandb:             val_loss 0.39313
wandb:           val_recall 0.70732
wandb:        val_precision 0.42029
wandb:               val_f1 0.52727
wandb:              val_auc 0.62688
wandb:                   lr 0.00013
wandb:          best_val_f1 0.62791
wandb:    best_val_accuracy 0.94788
wandb:   best_val_precision 0.6
wandb:      best_val_recall 0.65854
wandb:             best_auc 0.62586
wandb:           best_epoch 12
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_181123-1hpoai27

-----------------------
Model
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate_37345 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_37345[0][0]              
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 224s - loss: 0.7872 - accuracy: 0.6570 - val_loss: 0.4524 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08368744836891825
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 220s - loss: 0.4872 - accuracy: 0.7482 - val_loss: 0.3934 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19571538651411674
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 220s - loss: 0.5170 - accuracy: 0.7551 - val_loss: 0.2948 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3343840073961577
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 219s - loss: 0.4243 - accuracy: 0.8080 - val_loss: 0.3123 - val_accuracy: 0.9007
Confusion matrix: 
 [[528  45]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.39  0.61 ]]
Validation f1: 45.05
Validation accuracy: 90.07
Validation recall: 60.98
Validation precision: 35.71
Validation AUC: 0.36067813870696486
Validation class accuracies: [0.9214659685863874, 0.6097560975609756]
Saving model...
Epoch 5/65
154/154 - 219s - loss: 0.4119 - accuracy: 0.8149 - val_loss: 0.4689 - val_accuracy: 0.7980
Confusion matrix: 
 [[452 121]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.073 0.927]]
Validation f1: 38.00
Validation accuracy: 79.80
Validation recall: 92.68
Validation precision: 23.90
Validation AUC: 0.3021362966036449
Validation class accuracies: [0.7888307155322862, 0.926829268292683]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 219s - loss: 0.3673 - accuracy: 0.8316 - val_loss: 0.5614 - val_accuracy: 0.7655
Confusion matrix: 
 [[441 132]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77  0.23 ]
 [0.293 0.707]]
Validation f1: 28.71
Validation accuracy: 76.55
Validation recall: 70.73
Validation precision: 18.01
Validation AUC: 0.2378088587368493
Validation class accuracies: [0.7696335078534031, 0.7073170731707317]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 2 epochs
Epoch 7/65
154/154 - 219s - loss: 0.3799 - accuracy: 0.8275 - val_loss: 0.3259 - val_accuracy: 0.8599
Confusion matrix: 
 [[499  74]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.293 0.707]]
Validation f1: 40.28
Validation accuracy: 85.99
Validation recall: 70.73
Validation precision: 28.16
Validation AUC: 0.6044689835504641
Validation class accuracies: [0.8708551483420593, 0.7073170731707317]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 3 epochs
Epoch 8/65
154/154 - 219s - loss: 0.3261 - accuracy: 0.8430 - val_loss: 1.0579 - val_accuracy: 0.7671
Confusion matrix: 
 [[433 140]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.756 0.244]
 [0.073 0.927]]
Validation f1: 34.70
Validation accuracy: 76.71
Validation recall: 92.68
Validation precision: 21.35
Validation AUC: 0.5481792694928855
Validation class accuracies: [0.7556719022687609, 0.926829268292683]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 4 epochs
Epoch 9/65
154/154 - 218s - loss: 0.3199 - accuracy: 0.8653 - val_loss: 0.4629 - val_accuracy: 0.8583
Confusion matrix: 
 [[518  55]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.78  0.22 ]]
Validation f1: 17.14
Validation accuracy: 85.83
Validation recall: 21.95
Validation precision: 14.06
Validation AUC: 0.11563991863812478
Validation class accuracies: [0.9040139616055847, 0.21951219512195122]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 5 epochs
Epoch 10/65
154/154 - 219s - loss: 0.2900 - accuracy: 0.8629 - val_loss: 0.7915 - val_accuracy: 0.7085
Confusion matrix: 
 [[399 174]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.696 0.304]
 [0.122 0.878]]
Validation f1: 28.69
Validation accuracy: 70.85
Validation recall: 87.80
Validation precision: 17.14
Validation AUC: 0.5294804206833282
Validation class accuracies: [0.6963350785340314, 0.8780487804878049]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
154/154 - 218s - loss: 0.2285 - accuracy: 0.8865 - val_loss: 0.7220 - val_accuracy: 0.8046
Confusion matrix: 
 [[456 117]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.073 0.927]]
Validation f1: 38.78
Validation accuracy: 80.46
Validation recall: 92.68
Validation precision: 24.52
Validation AUC: 0.5258033355702839
Validation class accuracies: [0.7958115183246073, 0.926829268292683]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 7 epochs
Epoch 12/65
154/154 - 219s - loss: 0.2138 - accuracy: 0.8971 - val_loss: 0.4675 - val_accuracy: 0.8029
Confusion matrix: 
 [[464 109]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.293 0.707]]
Validation f1: 32.40
Validation accuracy: 80.29
Validation recall: 70.73
Validation precision: 21.01
Validation AUC: 0.6163043919151223
Validation class accuracies: [0.8097731239092496, 0.7073170731707317]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 8 epochs
Epoch 13/65
154/154 - 219s - loss: 0.2067 - accuracy: 0.9076 - val_loss: 0.4371 - val_accuracy: 0.8599
Confusion matrix: 
 [[499  74]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.28
Validation accuracy: 85.99
Validation recall: 70.73
Validation precision: 28.16
Validation AUC: 0.5679892379011535
Validation class accuracies: [0.8708551483420593, 0.7073170731707317]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 9 epochs
Epoch 14/65
154/154 - 219s - loss: 0.1738 - accuracy: 0.9178 - val_loss: 0.4767 - val_accuracy: 0.8322
Confusion matrix: 
 [[481  92]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.268 0.732]]
Validation f1: 36.81
Validation accuracy: 83.22
Validation recall: 73.17
Validation precision: 24.59
Validation AUC: 0.4307757341924626
Validation class accuracies: [0.8394415357766143, 0.7317073170731707]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 10 epochs
Epoch 15/65
154/154 - 219s - loss: 0.1639 - accuracy: 0.9349 - val_loss: 1.4578 - val_accuracy: 0.5375
Confusion matrix: 
 [[289 284]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.504 0.496]
 [0.    1.   ]]
Validation f1: 22.40
Validation accuracy: 53.75
Validation recall: 100.00
Validation precision: 12.62
Validation AUC: 0.6009391000637221
Validation class accuracies: [0.5043630017452007, 1.0]
The validation tracker metric at 0.45045045045045046 hasn't increased by 0 in 11 epochs
Epoch 16/65
154/154 - 219s - loss: 0.3028 - accuracy: 0.8759 - val_loss: 0.2656 - val_accuracy: 0.9283
Confusion matrix: 
 [[550  23]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.512 0.488]]
Validation f1: 47.62
Validation accuracy: 92.83
Validation recall: 48.78
Validation precision: 46.51
Validation AUC: 0.5224567074306383
Validation class accuracies: [0.9598603839441536, 0.4878048780487805]
Saving model...
Epoch 17/65
154/154 - 219s - loss: 0.1954 - accuracy: 0.9007 - val_loss: 0.5762 - val_accuracy: 0.7655
Confusion matrix: 
 [[444 129]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.366 0.634]]
Validation f1: 26.53
Validation accuracy: 76.55
Validation recall: 63.41
Validation precision: 16.77
Validation AUC: 0.29425989917496875
Validation class accuracies: [0.774869109947644, 0.6341463414634146]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 1 epochs
Epoch 18/65
154/154 - 219s - loss: 0.1594 - accuracy: 0.9329 - val_loss: 2.8642 - val_accuracy: 0.5537
Confusion matrix: 
 [[299 274]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.522 0.478]
 [0.    1.   ]]
Validation f1: 23.03
Validation accuracy: 55.37
Validation recall: 100.00
Validation precision: 13.02
Validation AUC: 0.5234879901890943
Validation class accuracies: [0.5218150087260035, 1.0]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 2 epochs
Epoch 19/65
154/154 - 218s - loss: 0.1249 - accuracy: 0.9410 - val_loss: 0.7721 - val_accuracy: 0.7752
Confusion matrix: 
 [[439 134]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.766 0.234]
 [0.098 0.902]]
Validation f1: 34.91
Validation accuracy: 77.52
Validation recall: 90.24
Validation precision: 21.64
Validation AUC: 0.6598996377444406
Validation class accuracies: [0.7661431064572426, 0.9024390243902439]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 3 epochs
Epoch 20/65
154/154 - 219s - loss: 0.1345 - accuracy: 0.9398 - val_loss: 0.5999 - val_accuracy: 0.8111
Confusion matrix: 
 [[463 110]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.808 0.192]
 [0.146 0.854]]
Validation f1: 37.63
Validation accuracy: 81.11
Validation recall: 85.37
Validation precision: 24.14
Validation AUC: 0.5549804034507566
Validation class accuracies: [0.8080279232111692, 0.8536585365853658]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 4 epochs
Epoch 21/65
154/154 - 218s - loss: 0.1071 - accuracy: 0.9540 - val_loss: 0.8521 - val_accuracy: 0.7638
Confusion matrix: 
 [[433 140]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.756 0.244]
 [0.122 0.878]]
Validation f1: 33.18
Validation accuracy: 76.38
Validation recall: 87.80
Validation precision: 20.45
Validation AUC: 0.6430740600677161
Validation class accuracies: [0.7556719022687609, 0.8780487804878049]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 5 epochs
Epoch 22/65
154/154 - 219s - loss: 0.0960 - accuracy: 0.9630 - val_loss: 2.9247 - val_accuracy: 0.4088
Confusion matrix: 
 [[210 363]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.366 0.634]
 [0.    1.   ]]
Validation f1: 18.43
Validation accuracy: 40.88
Validation recall: 100.00
Validation precision: 10.15
Validation AUC: 0.5759858222350035
Validation class accuracies: [0.36649214659685864, 1.0]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
154/154 - 219s - loss: 0.0791 - accuracy: 0.9605 - val_loss: 0.4545 - val_accuracy: 0.8746
Confusion matrix: 
 [[504  69]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.195 0.805]]
Validation f1: 46.15
Validation accuracy: 87.46
Validation recall: 80.49
Validation precision: 32.35
Validation AUC: 0.6179559273104436
Validation class accuracies: [0.8795811518324608, 0.8048780487804879]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 7 epochs
Epoch 24/65
154/154 - 219s - loss: 0.0571 - accuracy: 0.9793 - val_loss: 0.7657 - val_accuracy: 0.8143
Confusion matrix: 
 [[466 107]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.813 0.187]
 [0.171 0.829]]
Validation f1: 37.36
Validation accuracy: 81.43
Validation recall: 82.93
Validation precision: 24.11
Validation AUC: 0.6082048730772359
Validation class accuracies: [0.8132635253054101, 0.8292682926829268]
The validation tracker metric at 0.4761904761904762 hasn't increased by 0 in 8 epochs
Epoch 25/65
154/154 - 219s - loss: 0.0688 - accuracy: 0.9731 - val_loss: 0.3994 - val_accuracy: 0.8893
Confusion matrix: 
 [[513  60]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.195 0.805]]
Validation f1: 49.25
Validation accuracy: 88.93
Validation recall: 80.49
Validation precision: 35.48
Validation AUC: 0.6143580357404318
Validation class accuracies: [0.8952879581151832, 0.8048780487804879]
Saving model...
Epoch 26/65
154/154 - 219s - loss: 0.0809 - accuracy: 0.9687 - val_loss: 0.3586 - val_accuracy: 0.8827
Confusion matrix: 
 [[508  65]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.171 0.829]]
Validation f1: 48.57
Validation accuracy: 88.27
Validation recall: 82.93
Validation precision: 34.34
Validation AUC: 0.6555589848500643
Validation class accuracies: [0.8865619546247818, 0.8292682926829268]
The validation tracker metric at 0.4925373134328359 hasn't increased by 0 in 1 epochs
Epoch 27/65
154/154 - 219s - loss: 0.0703 - accuracy: 0.9662 - val_loss: 0.3869 - val_accuracy: 0.8844
Confusion matrix: 
 [[510  63]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.195 0.805]]
Validation f1: 48.18
Validation accuracy: 88.44
Validation recall: 80.49
Validation precision: 34.38
Validation AUC: 0.6370413632982753
Validation class accuracies: [0.8900523560209425, 0.8048780487804879]
The validation tracker metric at 0.4925373134328359 hasn't increased by 0 in 2 epochs
Epoch 28/65
154/154 - 219s - loss: 0.0516 - accuracy: 0.9805 - val_loss: 0.8550 - val_accuracy: 0.7850
Confusion matrix: 
 [[447 126]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.146 0.854]]
Validation f1: 34.65
Validation accuracy: 78.50
Validation recall: 85.37
Validation precision: 21.74
Validation AUC: 0.5846340053524275
Validation class accuracies: [0.7801047120418848, 0.8536585365853658]
The validation tracker metric at 0.4925373134328359 hasn't increased by 0 in 3 epochs
Epoch 29/65
154/154 - 219s - loss: 0.0484 - accuracy: 0.9805 - val_loss: 0.7445 - val_accuracy: 0.8274
Confusion matrix: 
 [[473 100]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.146 0.854]]
Validation f1: 39.77
Validation accuracy: 82.74
Validation recall: 85.37
Validation precision: 25.93
Validation AUC: 0.5996993780463015
Validation class accuracies: [0.8254799301919721, 0.8536585365853658]
The validation tracker metric at 0.4925373134328359 hasn't increased by 0 in 4 epochs
Epoch 30/65
154/154 - 219s - loss: 0.0605 - accuracy: 0.9776 - val_loss: 0.6108 - val_accuracy: 0.8632
Confusion matrix: 
 [[495  78]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.146 0.854]]
Validation f1: 45.45
Validation accuracy: 86.32
Validation recall: 85.37
Validation precision: 30.97
Validation AUC: 0.6128241600626277
Validation class accuracies: [0.8638743455497382, 0.8536585365853658]
The validation tracker metric at 0.4925373134328359 hasn't increased by 0 in 5 epochs
Epoch 31/65
154/154 - 219s - loss: 0.0320 - accuracy: 0.9878 - val_loss: 0.5804 - val_accuracy: 0.8583
Confusion matrix: 
 [[494  79]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.195 0.805]]
Validation f1: 43.14
Validation accuracy: 85.83
Validation recall: 80.49
Validation precision: 29.46
Validation AUC: 0.5923622272120715
Validation class accuracies: [0.8621291448516579, 0.8048780487804879]
The validation tracker metric at 0.4925373134328359 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 32/65
154/154 - 219s - loss: 0.0350 - accuracy: 0.9866 - val_loss: 0.4511 - val_accuracy: 0.8762
Confusion matrix: 
 [[505  68]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.195 0.805]]
Validation f1: 46.48
Validation accuracy: 87.62
Validation recall: 80.49
Validation precision: 32.67
Validation AUC: 0.6003018644671007
Validation class accuracies: [0.881326352530541, 0.8048780487804879]
The validation tracker metric at 0.4925373134328359 hasn't increased by 0 in 7 epochs
Epoch 33/65
154/154 - 219s - loss: 0.0277 - accuracy: 0.9898 - val_loss: 0.3949 - val_accuracy: 0.9055
Confusion matrix: 
 [[523  50]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.195 0.805]]
Validation f1: 53.23
Validation accuracy: 90.55
Validation recall: 80.49
Validation precision: 39.76
Validation AUC: 0.5964333857808338
Validation class accuracies: [0.912739965095986, 0.8048780487804879]
Saving model...
Epoch 34/65
154/154 - 219s - loss: 0.0234 - accuracy: 0.9931 - val_loss: 0.5997 - val_accuracy: 0.8599
Confusion matrix: 
 [[495  78]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.195 0.805]]
Validation f1: 43.42
Validation accuracy: 85.99
Validation recall: 80.49
Validation precision: 29.73
Validation AUC: 0.6228416318937506
Validation class accuracies: [0.8638743455497382, 0.8048780487804879]
The validation tracker metric at 0.532258064516129 hasn't increased by 0 in 1 epochs
Epoch 35/65
154/154 - 219s - loss: 0.0227 - accuracy: 0.9923 - val_loss: 0.5401 - val_accuracy: 0.8648
Confusion matrix: 
 [[498  75]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.195 0.805]]
Validation f1: 44.30
Validation accuracy: 86.48
Validation recall: 80.49
Validation precision: 30.56
Validation AUC: 0.6286895791856986
Validation class accuracies: [0.8691099476439791, 0.8048780487804879]
The validation tracker metric at 0.532258064516129 hasn't increased by 0 in 2 epochs
Epoch 36/65
154/154 - 219s - loss: 0.0311 - accuracy: 0.9898 - val_loss: 0.7632 - val_accuracy: 0.8648
Confusion matrix: 
 [[497  76]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.867 0.133]
 [0.171 0.829]]
Validation f1: 45.03
Validation accuracy: 86.48
Validation recall: 82.93
Validation precision: 30.91
Validation AUC: 0.5482958809281959
Validation class accuracies: [0.8673647469458988, 0.8292682926829268]
The validation tracker metric at 0.532258064516129 hasn't increased by 0 in 3 epochs
Epoch 37/65
154/154 - 219s - loss: 0.0238 - accuracy: 0.9906 - val_loss: 0.4713 - val_accuracy: 0.8925
Confusion matrix: 
 [[515  58]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.195 0.805]]
Validation f1: 50.00
Validation accuracy: 89.25
Validation recall: 80.49
Validation precision: 36.26
Validation AUC: 0.610775264153982
Validation class accuracies: [0.8987783595113438, 0.8048780487804879]
The validation tracker metric at 0.532258064516129 hasn't increased by 0 in 4 epochs
Epoch 38/65
154/154 - 219s - loss: 0.0200 - accuracy: 0.9939 - val_loss: 0.5387 - val_accuracy: 0.8811
Confusion matrix: 
 [[508  65]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.195 0.805]]
Validation f1: 47.48
Validation accuracy: 88.11
Validation recall: 80.49
Validation precision: 33.67
Validation AUC: 0.5978377654816169
Validation class accuracies: [0.8865619546247818, 0.8048780487804879]
The validation tracker metric at 0.532258064516129 hasn't increased by 0 in 5 epochs
Epoch 39/65
154/154 - 219s - loss: 0.0193 - accuracy: 0.9935 - val_loss: 0.7536 - val_accuracy: 0.8567
Confusion matrix: 
 [[493  80]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86  0.14 ]
 [0.195 0.805]]
Validation f1: 42.86
Validation accuracy: 85.67
Validation recall: 80.49
Validation precision: 29.20
Validation AUC: 0.5510502621810407
Validation class accuracies: [0.8603839441535777, 0.8048780487804879]
The validation tracker metric at 0.532258064516129 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 40/65
154/154 - 219s - loss: 0.0174 - accuracy: 0.9931 - val_loss: 0.5314 - val_accuracy: 0.8827
Confusion matrix: 
 [[509  64]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.195 0.805]]
Validation f1: 47.83
Validation accuracy: 88.27
Validation recall: 80.49
Validation precision: 34.02
Validation AUC: 0.5994362282739223
Validation class accuracies: [0.8883071553228621, 0.8048780487804879]
local_gc_exec.sh: line 6: 28038 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2246__06_1810__v39__icbhi_pneumoniajordan_seaprated/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 12 leaked semaphores to clean up at shutdown
  len(cache))
