Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2271
Description:  mixup
2021-06-29 17:59:14.978865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-29 17:59:17.634908: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 17:59:17.635943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-29 17:59:17.688405: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:17.689254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 17:59:17.689302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 17:59:17.693375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 17:59:17.693487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 17:59:17.694722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 17:59:17.695049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 17:59:17.696172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 17:59:17.697150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 17:59:17.697357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 17:59:17.697523: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:17.698360: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:17.699087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2271.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2271__06_1759__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 17:59:22.957364: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 17:59:22.957687: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:22.958519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 17:59:22.958580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 17:59:22.958638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 17:59:22.958659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 17:59:22.958681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 17:59:22.958704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 17:59:22.958724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 17:59:22.958745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 17:59:22.958764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 17:59:22.958856: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:22.959637: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:22.960329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-29 17:59:22.960417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 17:59:23.735225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-29 17:59:23.735278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-29 17:59:23.735288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-29 17:59:23.735605: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:23.736487: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:23.737319: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 17:59:23.738069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-06-29 17:59:24.753425: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-29 17:59:24.755171: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-29 18:00:22.017259: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-29 18:00:32.051659: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-29 18:00:42.096815: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-29 18:00:52.194455: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-29 18:00:57.296187: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-06-29 18:00:57.617263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 18:00:59.203760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 18:00:59.694939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 2858
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
179/179 - 121s - loss: 0.3168 - accuracy: 0.8933 - val_loss: 0.2480 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6827363511131526
Validation class accuracies: [1.0, 0.0]
2021-06-29 18:02:32.807472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2858
2021-06-29 18:02:42.744243: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 2858
2021-06-29 18:02:52.660737: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 2858
2021-06-29 18:03:02.779934: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 2858
2021-06-29 18:03:05.686863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
179/179 - 113s - loss: 0.1370 - accuracy: 0.9444 - val_loss: 0.2603 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.50773785182984
Validation class accuracies: [1.0, 0.0]
2021-06-29 18:04:34.549670: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 2858
2021-06-29 18:04:44.321152: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 2858
2021-06-29 18:04:54.436245: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 2858
2021-06-29 18:05:04.480387: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2747 of 2858
2021-06-29 18:05:06.238197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
179/179 - 112s - loss: 0.0994 - accuracy: 0.9500 - val_loss: 0.2612 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6633353890330145
Validation class accuracies: [1.0, 0.0]
2021-06-29 18:06:36.617963: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-29 18:06:46.550482: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-29 18:06:56.545696: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-29 18:07:06.500104: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 2858
2021-06-29 18:07:12.506773: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
179/179 - 117s - loss: 0.0722 - accuracy: 0.9671 - val_loss: 0.1311 - val_accuracy: 0.9430
Confusion matrix: 
 [[554  19]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.39  0.61 ]]
Validation f1: 58.82
Validation accuracy: 94.30
Validation recall: 60.98
Validation precision: 56.82
Validation AUC: 0.6393477986091985
Validation class accuracies: [0.9668411867364747, 0.6097560975609756]
2021-06-29 18:08:44.988842: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-29 18:08:55.160515: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 2858
2021-06-29 18:09:05.021837: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 2858
2021-06-29 18:09:14.944876: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 2858
2021-06-29 18:09:25.368388: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 2858
2021-06-29 18:09:31.762831: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
179/179 - 131s - loss: 0.0503 - accuracy: 0.9731 - val_loss: 0.7064 - val_accuracy: 0.7818
Confusion matrix: 
 [[442 131]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.771 0.229]
 [0.073 0.927]]
Validation f1: 36.19
Validation accuracy: 78.18
Validation recall: 92.68
Validation precision: 22.49
Validation AUC: 0.6147241422089234
Validation class accuracies: [0.7713787085514834, 0.926829268292683]
2021-06-29 18:11:08.919791: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 2858
2021-06-29 18:11:18.797457: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1041 of 2858
2021-06-29 18:11:28.739604: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 2858
2021-06-29 18:11:38.691497: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 2858
2021-06-29 18:11:48.667798: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-29 18:11:55.711519: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 1 epochs
Epoch 6/65
179/179 - 127s - loss: 0.0353 - accuracy: 0.9801 - val_loss: 0.6747 - val_accuracy: 0.8322
Confusion matrix: 
 [[474  99]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.827 0.173]
 [0.098 0.902]]
Validation f1: 41.81
Validation accuracy: 83.22
Validation recall: 90.24
Validation precision: 27.21
Validation AUC: 0.5797391316548495
Validation class accuracies: [0.8272251308900523, 0.9024390243902439]
2021-06-29 18:13:24.962878: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 2858
2021-06-29 18:13:34.791752: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 2858
2021-06-29 18:13:44.897477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 2858
2021-06-29 18:13:54.800540: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-29 18:13:57.035727: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 2 epochs
Epoch 7/65
179/179 - 116s - loss: 0.0241 - accuracy: 0.9836 - val_loss: 0.1835 - val_accuracy: 0.9186
Confusion matrix: 
 [[534  39]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.268 0.732]]
Validation f1: 54.55
Validation accuracy: 91.86
Validation recall: 73.17
Validation precision: 43.48
Validation AUC: 0.678702606451119
Validation class accuracies: [0.9319371727748691, 0.7317073170731707]
2021-06-29 18:15:34.829180: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 2858
2021-06-29 18:15:44.704879: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 961 of 2858
2021-06-29 18:15:54.748912: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 2858
2021-06-29 18:16:04.661130: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 2858
2021-06-29 18:16:14.754835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 2858
2021-06-29 18:16:24.594037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2764 of 2858
2021-06-29 18:16:26.955965: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 3 epochs
Epoch 8/65
179/179 - 138s - loss: 0.0257 - accuracy: 0.9825 - val_loss: 0.3053 - val_accuracy: 0.9251
Confusion matrix: 
 [[547  26]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.488 0.512]]
Validation f1: 47.73
Validation accuracy: 92.51
Validation recall: 51.22
Validation precision: 44.68
Validation AUC: 0.5465061953664165
Validation class accuracies: [0.9546247818499127, 0.5121951219512195]
2021-06-29 18:18:03.010698: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-29 18:18:12.947256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 2858
2021-06-29 18:18:23.057392: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 2858
2021-06-29 18:18:32.840489: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 2858
2021-06-29 18:18:41.376393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 4 epochs
Epoch 9/65
179/179 - 123s - loss: 0.0302 - accuracy: 0.9808 - val_loss: 0.2811 - val_accuracy: 0.9153
Confusion matrix: 
 [[538  35]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.415 0.585]]
Validation f1: 48.00
Validation accuracy: 91.53
Validation recall: 58.54
Validation precision: 40.68
Validation AUC: 0.534696363760289
Validation class accuracies: [0.9389179755671903, 0.5853658536585366]
2021-06-29 18:20:19.007227: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 2858
2021-06-29 18:20:29.044842: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 2858
2021-06-29 18:20:38.890523: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1521 of 2858
2021-06-29 18:20:49.002910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 2858
2021-06-29 18:20:58.997578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2763 of 2858
2021-06-29 18:21:00.503480: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 5 epochs
Epoch 10/65
179/179 - 124s - loss: 0.0236 - accuracy: 0.9801 - val_loss: 0.2080 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.5866369885409188
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]
2021-06-29 18:22:35.291106: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 2858
2021-06-29 18:22:45.322158: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1041 of 2858
2021-06-29 18:22:55.252082: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 2858
2021-06-29 18:23:05.399544: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 2858
2021-06-29 18:23:15.466598: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-29 18:23:22.102735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 11/65
179/179 - 130s - loss: 0.0283 - accuracy: 0.9815 - val_loss: 0.2131 - val_accuracy: 0.9365
Confusion matrix: 
 [[568   5]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.829 0.171]]
Validation f1: 26.42
Validation accuracy: 93.65
Validation recall: 17.07
Validation precision: 58.33
Validation AUC: 0.5248379602129596
Validation class accuracies: [0.9912739965095986, 0.17073170731707318]
2021-06-29 18:24:58.619102: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 2858
2021-06-29 18:25:08.524073: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 2858
2021-06-29 18:25:18.554403: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 2858
2021-06-29 18:25:28.693452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2858
2021-06-29 18:25:39.288849: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-29 18:25:48.536997: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2790 of 2858
2021-06-29 18:25:50.214384: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.594059405940594 hasn't increased by 0 in 1 epochs
Epoch 12/65
179/179 - 134s - loss: 0.0201 - accuracy: 0.9822 - val_loss: 0.1454 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.7332690858439607
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-29 18:27:23.692365: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 2858
2021-06-29 18:27:33.902377: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 2858
2021-06-29 18:27:43.885192: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 2858
2021-06-29 18:27:53.629989: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-29 18:28:03.963867: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-29 18:28:13.589737: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2804 of 2858
2021-06-29 18:28:14.921624: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 13/65
179/179 - 134s - loss: 0.0202 - accuracy: 0.9836 - val_loss: 0.1598 - val_accuracy: 0.9381
Confusion matrix: 
 [[554  19]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.463 0.537]]
Validation f1: 53.66
Validation accuracy: 93.81
Validation recall: 53.66
Validation precision: 53.66
Validation AUC: 0.6690071527521321
Validation class accuracies: [0.9668411867364747, 0.5365853658536586]
2021-06-29 18:29:47.827149: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-29 18:29:57.699702: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 2858
2021-06-29 18:30:07.712725: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 2858
2021-06-29 18:30:17.861251: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 2858
2021-06-29 18:30:27.695657: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2685 of 2858
2021-06-29 18:30:32.110501: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 1 epochs
Epoch 14/65
179/179 - 128s - loss: 0.0215 - accuracy: 0.9850 - val_loss: 0.1962 - val_accuracy: 0.9267
Confusion matrix: 
 [[544  29]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.39  0.61 ]]
Validation f1: 52.63
Validation accuracy: 92.67
Validation recall: 60.98
Validation precision: 46.30
Validation AUC: 0.6197520474529312
Validation class accuracies: [0.9493891797556719, 0.6097560975609756]
2021-06-29 18:32:06.777275: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 18:32:16.592032: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2858
2021-06-29 18:32:26.622249: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 2858
2021-06-29 18:32:36.770370: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 2858
2021-06-29 18:32:40.566147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 2 epochs
Epoch 15/65
179/179 - 118s - loss: 0.0147 - accuracy: 0.9846 - val_loss: 0.2043 - val_accuracy: 0.9495
Confusion matrix: 
 [[565   8]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.561 0.439]]
Validation f1: 53.73
Validation accuracy: 94.95
Validation recall: 43.90
Validation precision: 69.23
Validation AUC: 0.601329704408764
Validation class accuracies: [0.9860383944153578, 0.43902439024390244]
2021-06-29 18:34:16.656425: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 2858
2021-06-29 18:34:26.556782: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1057 of 2858
2021-06-29 18:34:36.551187: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 2858
2021-06-29 18:34:46.688506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 2858
2021-06-29 18:34:55.240325: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 3 epochs
Epoch 16/65
179/179 - 122s - loss: 0.0167 - accuracy: 0.9829 - val_loss: 0.1857 - val_accuracy: 0.9381
Confusion matrix: 
 [[556  17]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.512 0.488]]
Validation f1: 51.28
Validation accuracy: 93.81
Validation recall: 48.78
Validation precision: 54.05
Validation AUC: 0.6505444792739398
Validation class accuracies: [0.9703315881326352, 0.4878048780487805]
2021-06-29 18:36:30.195171: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 2858
2021-06-29 18:36:40.160605: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1057 of 2858
2021-06-29 18:36:49.958724: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 2858
2021-06-29 18:37:00.077382: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 2858
2021-06-29 18:37:10.023645: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-29 18:37:17.678215: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 4 epochs
Epoch 17/65
179/179 - 132s - loss: 0.0163 - accuracy: 0.9836 - val_loss: 0.2088 - val_accuracy: 0.9365
Confusion matrix: 
 [[555  18]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.512 0.488]]
Validation f1: 50.63
Validation accuracy: 93.65
Validation recall: 48.78
Validation precision: 52.63
Validation AUC: 0.5811662012580342
Validation class accuracies: [0.9685863874345549, 0.4878048780487805]
2021-06-29 18:38:55.388642: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 2858
2021-06-29 18:39:05.233880: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 2858
2021-06-29 18:39:15.142249: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 2858
2021-06-29 18:39:25.254513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2858
2021-06-29 18:39:35.902309: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-29 18:39:45.199470: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 2858
2021-06-29 18:39:47.261234: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 5 epochs
Epoch 18/65
179/179 - 134s - loss: 0.0172 - accuracy: 0.9808 - val_loss: 0.1933 - val_accuracy: 0.9414
Confusion matrix: 
 [[558  15]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.512 0.488]]
Validation f1: 52.63
Validation accuracy: 94.14
Validation recall: 48.78
Validation precision: 57.14
Validation AUC: 0.6337455874210758
Validation class accuracies: [0.9738219895287958, 0.4878048780487805]
2021-06-29 18:41:20.100857: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 2858
2021-06-29 18:41:30.166210: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 2858
2021-06-29 18:41:40.237561: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 2858
2021-06-29 18:41:50.144051: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2858
2021-06-29 18:42:00.347158: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2858
2021-06-29 18:42:10.173953: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2827 of 2858
2021-06-29 18:42:10.770225: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 19/65
179/179 - 133s - loss: 0.0152 - accuracy: 0.9836 - val_loss: 0.1523 - val_accuracy: 0.9430
Confusion matrix: 
 [[555  18]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.83
Validation accuracy: 94.30
Validation recall: 58.54
Validation precision: 57.14
Validation AUC: 0.6954469878733675
Validation class accuracies: [0.9685863874345549, 0.5853658536585366]
2021-06-29 18:43:43.145120: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-29 18:43:53.085255: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-29 18:44:03.119485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-29 18:44:13.386697: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 2858
2021-06-29 18:44:22.554754: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 7 epochs
Epoch 20/65
179/179 - 123s - loss: 0.0141 - accuracy: 0.9864 - val_loss: 0.1845 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
Validation f1: 58.54
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6696944055701092
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]
2021-06-29 18:45:58.731448: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-29 18:46:08.782526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-29 18:46:18.684302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 2858
2021-06-29 18:46:28.774346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2651 of 2858
2021-06-29 18:46:32.475618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 8 epochs
Epoch 21/65
179/179 - 118s - loss: 0.0165 - accuracy: 0.9811 - val_loss: 0.1641 - val_accuracy: 0.9446
Confusion matrix: 
 [[556  17]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.54
Validation accuracy: 94.46
Validation recall: 58.54
Validation precision: 58.54
Validation AUC: 0.6858998502750692
Validation class accuracies: [0.9703315881326352, 0.5853658536585366]
2021-06-29 18:48:10.857293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 2858
2021-06-29 18:48:20.737139: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 961 of 2858
2021-06-29 18:48:30.591799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 2858
2021-06-29 18:48:40.746591: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 2858
2021-06-29 18:48:50.770114: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 2858
2021-06-29 18:48:57.730764: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 9 epochs
Epoch 22/65
179/179 - 131s - loss: 0.0120 - accuracy: 0.9853 - val_loss: 0.1882 - val_accuracy: 0.9300
Confusion matrix: 
 [[544  29]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.341 0.659]]
Validation f1: 55.67
Validation accuracy: 93.00
Validation recall: 65.85
Validation precision: 48.21
Validation AUC: 0.686843251237969
Validation class accuracies: [0.9493891797556719, 0.6585365853658537]
2021-06-29 18:50:35.196416: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 2858
2021-06-29 18:50:45.090232: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 2858
2021-06-29 18:50:55.072114: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 2858
2021-06-29 18:51:05.180418: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-29 18:51:15.158964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 2858
2021-06-29 18:51:25.010765: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2763 of 2858
2021-06-29 18:51:27.177626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 10 epochs
Epoch 23/65
179/179 - 134s - loss: 0.0163 - accuracy: 0.9825 - val_loss: 0.1971 - val_accuracy: 0.9300
Confusion matrix: 
 [[544  29]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.67
Validation accuracy: 93.00
Validation recall: 65.85
Validation precision: 48.21
Validation AUC: 0.6983683275780048
Validation class accuracies: [0.9493891797556719, 0.6585365853658537]
2021-06-29 18:53:01.321567: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 2858
2021-06-29 18:53:11.206928: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 2858
2021-06-29 18:53:21.084526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 2858
2021-06-29 18:53:31.271744: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 2858
2021-06-29 18:53:41.104145: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 2858
2021-06-29 18:53:46.823702: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 11 epochs
Epoch 24/65
179/179 - 127s - loss: 0.0179 - accuracy: 0.9853 - val_loss: 0.1516 - val_accuracy: 0.9430
Confusion matrix: 
 [[550  23]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.293 0.707]]
Validation f1: 62.37
Validation accuracy: 94.30
Validation recall: 70.73
Validation precision: 55.77
Validation AUC: 0.7381411937259338
Validation class accuracies: [0.9598603839441536, 0.7073170731707317]
2021-06-29 18:55:17.406494: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2858
2021-06-29 18:55:27.370472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2858
2021-06-29 18:55:37.416318: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 2858
2021-06-29 18:55:47.209803: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 2858
2021-06-29 18:55:57.582385: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2747 of 2858
2021-06-29 18:56:00.062656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 25/65
179/179 - 124s - loss: 0.0135 - accuracy: 0.9825 - val_loss: 0.1565 - val_accuracy: 0.9463
Confusion matrix: 
 [[558  15]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.439 0.561]]
Validation f1: 58.23
Validation accuracy: 94.63
Validation recall: 56.10
Validation precision: 60.53
Validation AUC: 0.6896643201297497
Validation class accuracies: [0.9738219895287958, 0.5609756097560976]
2021-06-29 18:57:30.992988: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 678 of 2858
2021-06-29 18:57:41.024231: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-29 18:57:51.163859: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 2858
2021-06-29 18:58:01.279981: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2651 of 2858
2021-06-29 18:58:06.230786: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 13 epochs
Epoch 26/65
179/179 - 119s - loss: 0.0116 - accuracy: 0.9867 - val_loss: 0.1542 - val_accuracy: 0.9495
Confusion matrix: 
 [[557  16]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.366 0.634]]
Validation f1: 62.65
Validation accuracy: 94.95
Validation recall: 63.41
Validation precision: 61.90
Validation AUC: 0.7002779366724934
Validation class accuracies: [0.9720767888307156, 0.6341463414634146]
2021-06-29 18:59:42.540036: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 2858
2021-06-29 18:59:52.481592: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1201 of 2858
2021-06-29 19:00:02.480278: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-29 19:00:12.372888: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2858
2021-06-29 19:00:18.543038: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 14 epochs
Epoch 27/65
179/179 - 119s - loss: 0.0134 - accuracy: 0.9867 - val_loss: 0.1868 - val_accuracy: 0.9316
Confusion matrix: 
 [[545  28]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.341 0.659]]
Validation f1: 56.25
Validation accuracy: 93.16
Validation recall: 65.85
Validation precision: 49.09
Validation AUC: 0.6964823567047934
Validation class accuracies: [0.9511343804537522, 0.6585365853658537]
2021-06-29 19:01:53.796662: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 2858
2021-06-29 19:02:03.765039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1057 of 2858
2021-06-29 19:02:13.589353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 2858
2021-06-29 19:02:23.794204: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 2858
2021-06-29 19:02:33.839739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 2858
2021-06-29 19:02:36.515112: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 15 epochs
Epoch 28/65
179/179 - 127s - loss: 0.0195 - accuracy: 0.9829 - val_loss: 0.1775 - val_accuracy: 0.9397
Confusion matrix: 
 [[552  21]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.39  0.61 ]]
Validation f1: 57.47
Validation accuracy: 93.97
Validation recall: 60.98
Validation precision: 54.35
Validation AUC: 0.6658411931607991
Validation class accuracies: [0.9633507853403142, 0.6097560975609756]
2021-06-29 19:04:13.738029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 2858
2021-06-29 19:04:23.638655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 2858
2021-06-29 19:04:33.739968: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 2858
2021-06-29 19:04:43.660980: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2858
2021-06-29 19:04:53.569971: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 2858
2021-06-29 19:05:03.668042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2763 of 2858
2021-06-29 19:05:06.163329: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 16 epochs
Epoch 29/65
179/179 - 134s - loss: 0.0140 - accuracy: 0.9839 - val_loss: 0.1693 - val_accuracy: 0.9397
Confusion matrix: 
 [[552  21]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.39  0.61 ]]
Validation f1: 57.47
Validation accuracy: 93.97
Validation recall: 60.98
Validation precision: 54.35
Validation AUC: 0.6739331441689014
Validation class accuracies: [0.9633507853403142, 0.6097560975609756]
2021-06-29 19:06:41.149464: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 2858
2021-06-29 19:06:51.222459: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 2858
2021-06-29 19:07:01.018342: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 2858
2021-06-29 19:07:11.221520: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 2858
2021-06-29 19:07:21.419169: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-29 19:07:31.277544: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2811 of 2858
2021-06-29 19:07:32.350504: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 17 epochs
Epoch 30/65
179/179 - 133s - loss: 0.0147 - accuracy: 0.9850 - val_loss: 0.1666 - val_accuracy: 0.9446
Confusion matrix: 
 [[558  15]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.463 0.537]]
Validation f1: 56.41
Validation accuracy: 94.46
Validation recall: 53.66
Validation precision: 59.46
Validation AUC: 0.6691039334184075
Validation class accuracies: [0.9738219895287958, 0.5365853658536586]
2021-06-29 19:09:03.961491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-29 19:09:13.816710: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1320 of 2858
2021-06-29 19:09:23.921428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-29 19:09:34.051954: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 2858
2021-06-29 19:09:43.922886: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 2858
2021-06-29 19:09:45.635436: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 31/65
179/179 - 125s - loss: 0.0137 - accuracy: 0.9818 - val_loss: 0.1639 - val_accuracy: 0.9397
Confusion matrix: 
 [[551  22]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.366 0.634]]
Validation f1: 58.43
Validation accuracy: 93.97
Validation recall: 63.41
Validation precision: 54.17
Validation AUC: 0.6803526763312355
Validation class accuracies: [0.9616055846422339, 0.6341463414634146]
2021-06-29 19:11:18.656092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2858
2021-06-29 19:11:28.541958: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-29 19:11:38.525430: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 2858
2021-06-29 19:11:48.721108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2651 of 2858
2021-06-29 19:11:52.230415: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 19 epochs
Epoch 32/65
179/179 - 117s - loss: 0.0139 - accuracy: 0.9853 - val_loss: 0.1585 - val_accuracy: 0.9430
Confusion matrix: 
 [[555  18]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.83
Validation accuracy: 94.30
Validation recall: 58.54
Validation precision: 57.14
Validation AUC: 0.6796960885736608
Validation class accuracies: [0.9685863874345549, 0.5853658536585366]

The metrics for job 0 with the best target metric are: 
Best cm: [[558  15]
 [ 15  26]]
Best normalized cm: [[0.974 0.026]
 [0.366 0.634]]
Best f1: 0.63
Best accuracy: 0.95
Best recall: 0.63
Best precision: 0.63
Best AUC: 0.73
Best class accuracies: [0.9738219895287958, 0.6341463414634146]
Best epoch: 12
The number of epochs since last 1% equals the patience
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[8.358e-05]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.029]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.261]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[1.226e-05]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[1.253e-06]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[3.697e-05]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[4.313e-05]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[1.072e-05]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[3.326e-05]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[4.045e-05]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.276]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_1.png, [[0.509]]
../../new_cache/conv__2271__06_1759__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.133]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 16547
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_175917-1hfub6yt/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_175917-1hfub6yt/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9853
wandb:         val_accuracy 0.943
wandb:             _runtime 4439
wandb:           _timestamp 1624993997
wandb:                _step 232
wandb:           train_loss 0.01393
wandb:             val_loss 0.1585
wandb:           val_recall 0.58537
wandb:        val_precision 0.57143
wandb:               val_f1 0.57831
wandb:              val_auc 0.6797
wandb:                   lr 0.00013
wandb:          best_val_f1 0.63415
wandb:    best_val_accuracy 0.95114
wandb:   best_val_precision 0.63415
wandb:      best_val_recall 0.63415
wandb:             best_auc 0.73327
wandb:           best_epoch 12
wandb: Run history:
wandb:   train_accuracy ▁▅▅▇▇███████████████████████████
wandb:     val_accuracy ▇▇▇█▁▃▇▇▇▇▇█▇▇█▇▇████▇▇███▇█████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▃▃▁██▂▃▃▂▂▁▁▂▂▂▂▂▁▂▁▂▂▁▁▁▂▂▁▁▁▁
wandb:       val_recall ▁▁▁▆██▇▅▅▇▂▆▅▆▄▅▅▅▅▅▅▆▆▆▅▆▆▆▆▅▆▅
wandb:    val_precision ▁▁▁▇▃▄▅▆▅▆▇▇▆▆█▆▆▇▇▇▇▆▆▇▇▇▆▆▆▇▆▇
wandb:           val_f1 ▁▁▁▇▅▆▇▆▆█▄█▇▇▇▇▇▇▇▇▇▇▇█▇█▇▇▇▇▇▇
wandb:          val_auc ▆▁▆▅▄▃▆▂▂▃▂█▆▄▄▅▃▅▇▆▆▆▇█▇▇▇▆▆▆▆▆
wandb:               lr ██████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_175917-1hfub6yt


 See logs at ../../new_cache/conv__2271__06_1759__v39__mixup/logs/