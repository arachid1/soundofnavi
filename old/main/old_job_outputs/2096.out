Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2096
Description:  test
2021-05-04 21:27:19.969285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-04 21:27:22.168440: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-04 21:27:22.169364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-04 21:27:22.211280: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:22.211908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-04 21:27:22.211940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-04 21:27:22.215397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-04 21:27:22.215475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-04 21:27:22.216547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-04 21:27:22.216830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-04 21:27:22.217783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-04 21:27:22.218619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-04 21:27:22.218774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-04 21:27:22.218872: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:22.219474: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:22.220031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2096.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___05_2015___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___test___2096/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-08}
Early Stopping Patience and Delta: 12, 5.0%
-----------------------
wandb: wandb version 0.10.29 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.28
wandb: Syncing run restful-night-67
wandb: ‚≠êÔ∏è View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: üöÄ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/9w05ea5r
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210504_212722-9w05ea5r
wandb: Run `wandb offline` to turn off syncing.
2021-05-04 21:27:27.148729: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-04 21:27:27.148971: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:27.149610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-04 21:27:27.149656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-04 21:27:27.149710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-04 21:27:27.149738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-04 21:27:27.149767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-04 21:27:27.149797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-04 21:27:27.149823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-04 21:27:27.149850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-04 21:27:27.149875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-04 21:27:27.149977: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:27.150624: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:27.151173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-04 21:27:27.151223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-04 21:27:27.841162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-04 21:27:27.841206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-04 21:27:27.841214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-04 21:27:27.841468: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:27.842142: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:27.842772: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-04 21:27:27.843314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-04 21:27:29.098178: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-04 21:27:29.099717: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-04 21:27:32.043106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-04 21:27:32.776153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-04 21:27:32.784834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Size of training set: 4316
Size of validation set: 1078
Initializing weights...
weights = {0: 0.6776381909547738, 1: 1.9073550212164074}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/30
270/270 - 523s - loss: 0.7220 - accuracy: 0.5480 - val_loss: 0.6564 - val_accuracy: 0.7254
{'loss': 0.7220078110694885, 'accuracy': 0.5479610562324524, 'val_loss': 0.6564032435417175, 'val_accuracy': 0.72541743516922}
Confusion matrix: 
 [[782   0]
 [296   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 0.725417439703154
Validation recall: 
 0.0
Validation precision: 
 0.0
Validation f1: 
 0.0
Validation AUC: 
 0.2661806505069097
Validation class accuracies: 
 [1.0, 0.0]
Epoch 2/30
270/270 - 508s - loss: 0.6990 - accuracy: 0.5544 - val_loss: 0.6569 - val_accuracy: 0.7254
{'loss': 0.6989973783493042, 'accuracy': 0.5544485449790955, 'val_loss': 0.6568766832351685, 'val_accuracy': 0.72541743516922}
Confusion matrix: 
 [[781   1]
 [295   1]]
Validation accuracy: 0.725417439703154
Validation recall: 
 0.0033783783783783786
Validation precision: 
 0.5
Validation f1: 
 0.006711409395973154
Validation AUC: 
 0.30792326503384393
Validation class accuracies: 
 [0.9987212276214834, 0.0033783783783783786]
The validation AUC hasn't increased by 1% in 1 epochs
Epoch 3/30
270/270 - 508s - loss: 0.6866 - accuracy: 0.5751 - val_loss: 0.6540 - val_accuracy: 0.7245
{'loss': 0.6866297125816345, 'accuracy': 0.5750694870948792, 'val_loss': 0.6539937257766724, 'val_accuracy': 0.7244898080825806}
Confusion matrix: 
 [[620 162]
 [210  86]]
Validation accuracy: 0.6549165120593692
Validation recall: 
 0.2905405405405405
Validation precision: 
 0.3467741935483871
Validation f1: 
 0.31617647058823534
Validation AUC: 
 0.35013539730260335
Validation class accuracies: 
 [0.7928388746803069, 0.2905405405405405]
Epoch 4/30
270/270 - 507s - loss: 0.6831 - accuracy: 0.5959 - val_loss: 0.6722 - val_accuracy: 0.6809
{'loss': 0.6831154823303223, 'accuracy': 0.5959221720695496, 'val_loss': 0.6721799969673157, 'val_accuracy': 0.6808905601501465}
Confusion matrix: 
 [[201 581]
 [ 40 256]]
Validation accuracy: 0.42393320964749537
Validation recall: 
 0.8648648648648649
Validation precision: 
 0.3058542413381123
Validation f1: 
 0.4518976169461607
Validation AUC: 
 0.36299607459284566
Validation class accuracies: 
 [0.2570332480818414, 0.8648648648648649]
The validation AUC hasn't increased by 1% in 1 epochs
Epoch 5/30
270/270 - 508s - loss: 0.6816 - accuracy: 0.6013 - val_loss: 0.7029 - val_accuracy: 0.4954
{'loss': 0.6816089749336243, 'accuracy': 0.6012511849403381, 'val_loss': 0.7029095888137817, 'val_accuracy': 0.4953617751598358}
Confusion matrix: 
 [[ 51 731]
 [ 13 283]]
Validation accuracy: 0.3098330241187384
Validation recall: 
 0.956081081081081
Validation precision: 
 0.27909270216962523
Validation f1: 
 0.4320610687022901
Validation AUC: 
 0.3474901759643241
Validation class accuracies: 
 [0.06521739130434782, 0.956081081081081]
The validation AUC hasn't increased by 1% in 2 epochs
Epoch 6/30
270/270 - 510s - loss: 0.6763 - accuracy: 0.6223 - val_loss: 0.6866 - val_accuracy: 0.5983
{'loss': 0.6762754321098328, 'accuracy': 0.6223354935646057, 'val_loss': 0.6865844130516052, 'val_accuracy': 0.5983302593231201}
Confusion matrix: 
 [[180 602]
 [ 46 250]]
Validation accuracy: 0.39888682745825604
Validation recall: 
 0.8445945945945946
Validation precision: 
 0.2934272300469484
Validation f1: 
 0.4355400696864112
Validation AUC: 
 0.3685472927694968
Validation class accuracies: 
 [0.23017902813299232, 0.8445945945945946]
The validation AUC hasn't increased by 1% in 3 epochs
Epoch 7/30
270/270 - 508s - loss: 0.6749 - accuracy: 0.6244 - val_loss: 0.6656 - val_accuracy: 0.6939
{'loss': 0.6748685240745544, 'accuracy': 0.6244207620620728, 'val_loss': 0.665553867816925, 'val_accuracy': 0.6938775777816772}
Confusion matrix: 
 [[335 447]
 [ 97 199]]
Validation accuracy: 0.49536178107606677
Validation recall: 
 0.6722972972972973
Validation precision: 
 0.3080495356037152
Validation f1: 
 0.42250530785562634
Validation AUC: 
 0.34576337664917295
Validation class accuracies: 
 [0.42838874680306904, 0.6722972972972973]
Lr has been adjusted to 7.499999628635123e-05
The validation AUC hasn't increased by 1% in 4 epochs
Epoch 8/30
270/270 - 506s - loss: 0.6673 - accuracy: 0.6501 - val_loss: 0.6702 - val_accuracy: 0.7273
{'loss': 0.6673108339309692, 'accuracy': 0.6501390337944031, 'val_loss': 0.6702441573143005, 'val_accuracy': 0.7272727489471436}
Confusion matrix: 
 [[583 199]
 [188 108]]
Validation accuracy: 0.6410018552875696
Validation recall: 
 0.36486486486486486
Validation precision: 
 0.3517915309446254
Validation f1: 
 0.3582089552238806
Validation AUC: 
 0.3506237839152487
Validation class accuracies: 
 [0.7455242966751918, 0.36486486486486486]
The validation AUC hasn't increased by 1% in 5 epochs
Epoch 9/30
270/270 - 507s - loss: 0.6639 - accuracy: 0.6571 - val_loss: 0.7760 - val_accuracy: 0.5501
{'loss': 0.6638942956924438, 'accuracy': 0.65708988904953, 'val_loss': 0.7760352492332458, 'val_accuracy': 0.5500927567481995}
Confusion matrix: 
 [[ 67 715]
 [  6 290]]
Validation accuracy: 0.33116883116883117
Validation recall: 
 0.9797297297297297
Validation precision: 
 0.2885572139303483
Validation f1: 
 0.44581091468101464
Validation AUC: 
 0.3755934226419866
Validation class accuracies: 
 [0.08567774936061381, 0.9797297297297297]
The validation AUC hasn't increased by 1% in 6 epochs
Epoch 10/30
270/270 - 508s - loss: 0.6604 - accuracy: 0.6682 - val_loss: 0.6811 - val_accuracy: 0.6512
{'loss': 0.6603507399559021, 'accuracy': 0.6682112812995911, 'val_loss': 0.6810817122459412, 'val_accuracy': 0.6512059569358826}
Confusion matrix: 
 [[277 505]
 [ 56 240]]
Validation accuracy: 0.47959183673469385
Validation recall: 
 0.8108108108108109
Validation precision: 
 0.3221476510067114
Validation f1: 
 0.46109510086455324
Validation AUC: 
 0.41804152881163514
Validation class accuracies: 
 [0.35421994884910485, 0.8108108108108109]
Epoch 11/30
270/270 - 508s - loss: 0.6520 - accuracy: 0.6925 - val_loss: 0.6803 - val_accuracy: 0.6688
{'loss': 0.6519729495048523, 'accuracy': 0.692539393901825, 'val_loss': 0.6802836656570435, 'val_accuracy': 0.6688311696052551}
Confusion matrix: 
 [[333 449]
 [ 68 228]]
Validation accuracy: 0.5204081632653061
Validation recall: 
 0.7702702702702703
Validation precision: 
 0.33677991137370755
Validation f1: 
 0.46865364850976365
Validation AUC: 
 0.41424600046847404
Validation class accuracies: 
 [0.4258312020460358, 0.7702702702702703]
The validation AUC hasn't increased by 1% in 1 epochs
Epoch 12/30
270/270 - 508s - loss: 0.6474 - accuracy: 0.7032 - val_loss: 0.7928 - val_accuracy: 0.3766
{'loss': 0.6473731994628906, 'accuracy': 0.7031974196434021, 'val_loss': 0.7927908301353455, 'val_accuracy': 0.37662336230278015}
Confusion matrix: 
 [[ 38 744]
 [  4 292]]
Validation accuracy: 0.30612244897959184
Validation recall: 
 0.9864864864864865
Validation precision: 
 0.28185328185328185
Validation f1: 
 0.4384384384384384
Validation AUC: 
 0.4435189502862573
Validation class accuracies: 
 [0.04859335038363171, 0.9864864864864865]
The validation AUC hasn't increased by 1% in 2 epochs
Epoch 13/30
270/270 - 506s - loss: 0.6391 - accuracy: 0.7259 - val_loss: 0.6730 - val_accuracy: 0.6633
{'loss': 0.6391251683235168, 'accuracy': 0.7259036302566528, 'val_loss': 0.6730323433876038, 'val_accuracy': 0.6632652878761292}
Confusion matrix: 
 [[383 399]
 [ 68 228]]
Validation accuracy: 0.5667903525046383
Validation recall: 
 0.7702702702702703
Validation precision: 
 0.36363636363636365
Validation f1: 
 0.4940411700975082
Validation AUC: 
 0.46144408248817126
Validation class accuracies: 
 [0.489769820971867, 0.7702702702702703]
The validation AUC hasn't increased by 1% in 3 epochs
Epoch 14/30
270/270 - 508s - loss: 0.6314 - accuracy: 0.7384 - val_loss: 0.6677 - val_accuracy: 0.7319
{'loss': 0.6314246654510498, 'accuracy': 0.7384151816368103, 'val_loss': 0.6676571369171143, 'val_accuracy': 0.7319109439849854}
Confusion matrix: 
 [[511 271]
 [114 182]]
Validation accuracy: 0.6428571428571429
Validation recall: 
 0.6148648648648649
Validation precision: 
 0.40176600441501104
Validation f1: 
 0.48598130841121495
Validation AUC: 
 0.4659648225340973
Validation class accuracies: 
 [0.6534526854219949, 0.6148648648648649]
Lr has been adjusted to 5.624999903375283e-05
The validation AUC hasn't increased by 1% in 4 epochs
Epoch 15/30
270/270 - 507s - loss: 0.6152 - accuracy: 0.7739 - val_loss: 0.7259 - val_accuracy: 0.5761
{'loss': 0.6151655912399292, 'accuracy': 0.7738646864891052, 'val_loss': 0.7259246110916138, 'val_accuracy': 0.576066792011261}
Confusion matrix: 
 [[277 505]
 [ 58 238]]
Validation accuracy: 0.4777365491651206
Validation recall: 
 0.8040540540540541
Validation precision: 
 0.3203230148048452
Validation f1: 
 0.45813282001924927
Validation AUC: 
 0.4384368996229298
Validation class accuracies: 
 [0.35421994884910485, 0.8040540540540541]
The validation AUC hasn't increased by 1% in 5 epochs
Epoch 16/30
270/270 - 507s - loss: 0.6108 - accuracy: 0.7866 - val_loss: 0.8136 - val_accuracy: 0.4787
{'loss': 0.6107768416404724, 'accuracy': 0.7866079807281494, 'val_loss': 0.8136013150215149, 'val_accuracy': 0.47866418957710266}
Confusion matrix: 
 [[147 635]
 [ 16 280]]
Validation accuracy: 0.3961038961038961
Validation recall: 
 0.9459459459459459
Validation precision: 
 0.30601092896174864
Validation f1: 
 0.4624277456647399
Validation AUC: 
 0.47749954798790706
Validation class accuracies: 
 [0.18797953964194372, 0.9459459459459459]
Epoch 17/30
270/270 - 507s - loss: 0.6053 - accuracy: 0.8100 - val_loss: 0.6743 - val_accuracy: 0.6809
{'loss': 0.6053246259689331, 'accuracy': 0.810009241104126, 'val_loss': 0.6742628216743469, 'val_accuracy': 0.6808905601501465}
Confusion matrix: 
 [[361 421]
 [ 64 232]]
Validation accuracy: 0.5500927643784786
Validation recall: 
 0.7837837837837838
Validation precision: 
 0.3552833078101072
Validation f1: 
 0.4889357218124341
Validation AUC: 
 0.4935451377803869
Validation class accuracies: 
 [0.4616368286445013, 0.7837837837837838]
The validation AUC hasn't increased by 1% in 1 epochs
Epoch 18/30
270/270 - 507s - loss: 0.5981 - accuracy: 0.8188 - val_loss: 0.7118 - val_accuracy: 0.5918
{'loss': 0.5981445908546448, 'accuracy': 0.8188137412071228, 'val_loss': 0.7117965817451477, 'val_accuracy': 0.5918367505073547}
Confusion matrix: 
 [[293 489]
 [ 49 247]]
Validation accuracy: 0.5009276437847866
Validation recall: 
 0.8344594594594594
Validation precision: 
 0.33559782608695654
Validation f1: 
 0.4786821705426357
Validation AUC: 
 0.4857916292578145
Validation class accuracies: 
 [0.37468030690537085, 0.8344594594594594]
The validation AUC hasn't increased by 1% in 2 epochs
Epoch 19/30
270/270 - 507s - loss: 0.5919 - accuracy: 0.8420 - val_loss: 0.6938 - val_accuracy: 0.6633
{'loss': 0.5919075012207031, 'accuracy': 0.8419833183288574, 'val_loss': 0.6937846541404724, 'val_accuracy': 0.6632652878761292}
Confusion matrix: 
 [[370 412]
 [ 51 245]]
Validation accuracy: 0.5705009276437848
Validation recall: 
 0.8277027027027027
Validation precision: 
 0.3729071537290715
Validation f1: 
 0.5141657922350472
Validation AUC: 
 0.5151699763775153
Validation class accuracies: 
 [0.4731457800511509, 0.8277027027027027]
The validation AUC hasn't increased by 1% in 3 epochs
Epoch 20/30
270/270 - 508s - loss: 0.5884 - accuracy: 0.8466 - val_loss: 0.6715 - val_accuracy: 0.7069
{'loss': 0.5883947610855103, 'accuracy': 0.8466172218322754, 'val_loss': 0.6715457439422607, 'val_accuracy': 0.7068645358085632}
Confusion matrix: 
 [[499 283]
 [104 192]]
Validation accuracy: 0.6410018552875696
Validation recall: 
 0.6486486486486487
Validation precision: 
 0.40421052631578946
Validation f1: 
 0.4980544747081711
Validation AUC: 
 0.4691927746139819
Validation class accuracies: 
 [0.6381074168797954, 0.6486486486486487]
Lr has been adjusted to 4.2187501094304025e-05
The validation AUC hasn't increased by 1% in 4 epochs
Epoch 21/30
270/270 - 505s - loss: 0.5805 - accuracy: 0.8670 - val_loss: 0.6724 - val_accuracy: 0.7375
{'loss': 0.5805040597915649, 'accuracy': 0.8670064806938171, 'val_loss': 0.6724043488502502, 'val_accuracy': 0.7374768257141113}
Confusion matrix: 
 [[522 260]
 [108 188]]
Validation accuracy: 0.6586270871985158
Validation recall: 
 0.6351351351351351
Validation precision: 
 0.41964285714285715
Validation f1: 
 0.5053763440860215
Validation AUC: 
 0.496382917100631
Validation class accuracies: 
 [0.6675191815856778, 0.6351351351351351]
The validation AUC hasn't increased by 1% in 5 epochs
Epoch 22/30
270/270 - 506s - loss: 0.5790 - accuracy: 0.8700 - val_loss: 0.6619 - val_accuracy: 0.7468
{'loss': 0.5789893269538879, 'accuracy': 0.8700185418128967, 'val_loss': 0.6618747115135193, 'val_accuracy': 0.7467532753944397}
Confusion matrix: 
 [[528 254]
 [ 99 197]]
Validation accuracy: 0.6725417439703154
Validation recall: 
 0.6655405405405406
Validation precision: 
 0.43680709534368073
Validation f1: 
 0.5274431057563588
Validation AUC: 
 0.5347765337474161
Validation class accuracies: 
 [0.6751918158567775, 0.6655405405405406]
Epoch 23/30
270/270 - 507s - loss: 0.5754 - accuracy: 0.8791 - val_loss: 0.7340 - val_accuracy: 0.6030
{'loss': 0.5753660798072815, 'accuracy': 0.8790546655654907, 'val_loss': 0.7339509725570679, 'val_accuracy': 0.6029684543609619}
Confusion matrix: 
 [[265 517]
 [ 20 276]]
Validation accuracy: 0.5018552875695733
Validation recall: 
 0.9324324324324325
Validation precision: 
 0.3480453972257251
Validation f1: 
 0.5068870523415978
Validation AUC: 
 0.531164467621084
Validation class accuracies: 
 [0.3388746803069054, 0.9324324324324325]
The validation AUC hasn't increased by 1% in 1 epochs
Epoch 24/30
270/270 - 508s - loss: 0.5684 - accuracy: 0.8883 - val_loss: 0.6771 - val_accuracy: 0.7597
{'loss': 0.5684316754341125, 'accuracy': 0.8883225321769714, 'val_loss': 0.6771174669265747, 'val_accuracy': 0.7597402334213257}
Confusion matrix: 
 [[624 158]
 [144 152]]
Validation accuracy: 0.7198515769944341
Validation recall: 
 0.5135135135135135
Validation precision: 
 0.49032258064516127
Validation f1: 
 0.5016501650165015
Validation AUC: 
 0.5466052661761938
Validation class accuracies: 
 [0.7979539641943734, 0.5135135135135135]
The validation AUC hasn't increased by 1% in 2 epochs
Epoch 25/30
270/270 - 507s - loss: 0.5663 - accuracy: 0.9011 - val_loss: 0.6984 - val_accuracy: 0.6447
{'loss': 0.5663184523582458, 'accuracy': 0.9010658264160156, 'val_loss': 0.6983706951141357, 'val_accuracy': 0.6447124481201172}
Confusion matrix: 
 [[319 463]
 [ 39 257]]
Validation accuracy: 0.5343228200371057
Validation recall: 
 0.8682432432432432
Validation precision: 
 0.35694444444444445
Validation f1: 
 0.5059055118110236
Validation AUC: 
 0.5604797683134057
Validation class accuracies: 
 [0.4079283887468031, 0.8682432432432432]
The validation AUC hasn't increased by 1% in 3 epochs
Epoch 26/30
270/270 - 508s - loss: 0.5634 - accuracy: 0.9124 - val_loss: 0.7142 - val_accuracy: 0.7597
{'loss': 0.5633968114852905, 'accuracy': 0.9124189019203186, 'val_loss': 0.714187502861023, 'val_accuracy': 0.7597402334213257}
Confusion matrix: 
 [[665 117]
 [172 124]]
Validation accuracy: 0.7319109461966605
Validation recall: 
 0.4189189189189189
Validation precision: 
 0.5145228215767634
Validation f1: 
 0.4618249534450652
Validation AUC: 
 0.5143258205574349
Validation class accuracies: 
 [0.850383631713555, 0.4189189189189189]
Lr has been adjusted to 3.164062582072802e-05
The validation AUC hasn't increased by 1% in 4 epochs
Epoch 27/30
270/270 - 507s - loss: 0.5642 - accuracy: 0.9027 - val_loss: 0.6821 - val_accuracy: 0.6790
{'loss': 0.5641849040985107, 'accuracy': 0.902687668800354, 'val_loss': 0.6821078658103943, 'val_accuracy': 0.6790352463722229}
Confusion matrix: 
 [[412 370]
 [ 55 241]]
Validation accuracy: 0.6057513914656771
Validation recall: 
 0.8141891891891891
Validation precision: 
 0.3944353518821604
Validation f1: 
 0.5314222712238148
Validation AUC: 
 0.5435640286261346
Validation class accuracies: 
 [0.5268542199488491, 0.8141891891891891]
The validation AUC hasn't increased by 1% in 5 epochs
Epoch 28/30
270/270 - 507s - loss: 0.5624 - accuracy: 0.9085 - val_loss: 0.6700 - val_accuracy: 0.7041
{'loss': 0.5624418258666992, 'accuracy': 0.9084800481796265, 'val_loss': 0.669972836971283, 'val_accuracy': 0.704081654548645}
Confusion matrix: 
 [[462 320]
 [ 65 231]]
Validation accuracy: 0.6428571428571429
Validation recall: 
 0.7804054054054054
Validation precision: 
 0.4192377495462795
Validation f1: 
 0.5454545454545454
Validation AUC: 
 0.5535018807135645
Validation class accuracies: 
 [0.5907928388746803, 0.7804054054054054]
The validation AUC hasn't increased by 1% in 6 epochs
Epoch 29/30
270/270 - 508s - loss: 0.5599 - accuracy: 0.9177 - val_loss: 0.6635 - val_accuracy: 0.7384
{'loss': 0.5598798990249634, 'accuracy': 0.9177479147911072, 'val_loss': 0.6635032296180725, 'val_accuracy': 0.7384044528007507}
Confusion matrix: 
 [[546 236]
 [109 187]]
Validation accuracy: 0.6799628942486086
Validation recall: 
 0.6317567567567568
Validation precision: 
 0.44208037825059104
Validation f1: 
 0.5201668984700973
Validation AUC: 
 0.5540792189580711
Validation class accuracies: 
 [0.6982097186700768, 0.6317567567567568]
The validation AUC hasn't increased by 1% in 7 epochs
Epoch 30/30
270/270 - 508s - loss: 0.5575 - accuracy: 0.9203 - val_loss: 0.6622 - val_accuracy: 0.7180
{'loss': 0.5575443506240845, 'accuracy': 0.9202965497970581, 'val_loss': 0.6621668934822083, 'val_accuracy': 0.7179962992668152}
Confusion matrix: 
 [[480 302]
 [ 83 213]]
Validation accuracy: 0.6428571428571429
Validation recall: 
 0.7195945945945946
Validation precision: 
 0.41359223300970877
Validation f1: 
 0.525277435265105
Validation AUC: 
 0.5677412900771371
Validation class accuracies: 
 [0.6138107416879796, 0.7195945945945946]
Lr has been adjusted to 2.3730470275040716e-05
The validation AUC hasn't increased by 1% in 8 epochs
wandb: Waiting for W&B process to finish, PID 19192
wandb: Program ended successfully.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: / 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: - 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: \ 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: / 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210504_212722-9w05ea5r/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210504_212722-9w05ea5r/logs/debug-internal.log
wandb: Run summary:
wandb:             _runtime 15899
wandb:           _timestamp 1620179541
wandb:                _step 239
wandb:       train_accuracy 0.9203
wandb:         val_accuracy 0.718
wandb:           train_loss 0.55754
wandb:             val_loss 0.66217
wandb:           val_recall 0.71959
wandb:        val_precision 0.41359
wandb:               val_f1 0.52528
wandb:              val_auc 0.56774
wandb:                   lr 3e-05
wandb:          best_val_f1 0.52528
wandb:    best_val_accuracy 0.64286
wandb:   best_val_precision 0.41359
wandb:      best_val_recall 0.71959
wandb:             best_auc 0.56774
wandb: Run history:
wandb:         _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:       _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:            _step ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:   train_accuracy ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:     val_accuracy ‚ñá‚ñá‚ñá‚ñá‚ñÉ‚ñÖ‚ñá‚ñá‚ñÑ‚ñÜ‚ñÜ‚ñÅ‚ñÜ‚ñá‚ñÖ‚ñÉ‚ñá‚ñÖ‚ñÜ‚ñá‚ñà‚ñà‚ñÖ‚ñà‚ñÜ‚ñà‚ñá‚ñá‚ñà‚ñá
wandb:       train_loss ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:         val_loss ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÜ‚ñÇ‚ñÇ‚ñá‚ñÇ‚ñÇ‚ñÑ‚ñà‚ñÇ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÖ‚ñÇ‚ñÉ‚ñÑ‚ñÇ‚ñÇ‚ñÅ‚ñÅ
wandb:       val_recall ‚ñÅ‚ñÅ‚ñÉ‚ñá‚ñà‚ñá‚ñÜ‚ñÑ‚ñà‚ñá‚ñÜ‚ñà‚ñÜ‚ñÖ‚ñá‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñÖ‚ñá‚ñÑ‚ñá‚ñá‚ñÖ‚ñÜ
wandb:    val_precision ‚ñÅ‚ñà‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñÜ‚ñà‚ñÜ‚ñà‚ñÜ‚ñá‚ñá‚ñá
wandb:           val_f1 ‚ñÅ‚ñÅ‚ñÖ‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñá‚ñá‚ñà‚ñà‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:          val_auc ‚ñÅ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÖ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:               lr ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Synced 6 W&B file(s), 30 media file(s), 30 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced restful-night-67: https://wandb.ai/arachid1/tensorboard-integration/runs/9w05ea5r


 See logs at ../../cache/conv___05_2015___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___test___2096/logs/