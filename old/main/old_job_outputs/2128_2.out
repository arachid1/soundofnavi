Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2128
Description:  model9_undersampled
2021-05-11 17:26:36.182197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 17:26:38.407517: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 17:26:38.408407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-11 17:26:38.457447: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:38.458157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 17:26:38.458189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 17:26:38.461560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 17:26:38.461649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 17:26:38.462739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 17:26:38.463032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 17:26:38.464007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 17:26:38.464826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 17:26:38.464971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 17:26:38.465079: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:38.465870: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:38.466541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2128.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2128__05_1726__v29__model9_undersampled/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.8}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 22, 1.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2128
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1xuk2lg0
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_172638-1xuk2lg0
wandb: Run `wandb offline` to turn off syncing.
2021-05-11 17:26:43.512964: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 17:26:43.513253: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:43.514341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 17:26:43.514404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 17:26:43.514469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 17:26:43.514506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 17:26:43.514543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 17:26:43.514575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 17:26:43.514608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 17:26:43.514640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 17:26:43.514670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 17:26:43.514816: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:43.515981: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:43.516996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-11 17:26:43.517079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 17:26:44.243583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-11 17:26:44.243630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-11 17:26:44.243639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-11 17:26:44.243937: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:44.244771: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:44.245652: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 17:26:44.246396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-11 17:27:21.114666: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-11 17:27:21.116371: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-11 17:27:24.225649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 17:27:24.940511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 17:27:24.954125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
1150
1150
With concat = False and six = False, size of training set: 2300...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/50
144/144 - 305s - loss: 0.7577 - accuracy: 0.5065 - val_loss: 0.7130 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.18889305826437738
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.18889305826437738
Epoch 2/50
144/144 - 291s - loss: 0.6952 - accuracy: 0.5235 - val_loss: 0.7025 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24572905208063955
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.24572905208063955
Epoch 3/50
144/144 - 290s - loss: 0.6944 - accuracy: 0.5187 - val_loss: 0.6892 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2169615872874559
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.2169615872874559
Epoch 4/50
144/144 - 290s - loss: 0.6936 - accuracy: 0.5522 - val_loss: 0.6933 - val_accuracy: 0.7739
Confusion matrix: 
 [[831  39]
 [207  11]]
Validation f1: 8.21
Validation accuracy: 77.39
Validation recall: 5.05
Validation precision: 22.00
Validation AUC: 0.22599461733780088
Validation class accuracies: [0.9551724137931035, 0.05045871559633028]
TARGET: 0
target metric(test auc): 0.22599461733780088
Epoch 5/50
144/144 - 290s - loss: 0.6936 - accuracy: 0.5478 - val_loss: 0.6918 - val_accuracy: 0.7748
Confusion matrix: 
 [[831  39]
 [206  12]]
Validation f1: 8.92
Validation accuracy: 77.48
Validation recall: 5.50
Validation precision: 23.53
Validation AUC: 0.2256354093625168
Validation class accuracies: [0.9551724137931035, 0.05504587155963303]
TARGET: 0
target metric(test auc): 0.2256354093625168
Epoch 6/50
144/144 - 291s - loss: 0.6941 - accuracy: 0.5670 - val_loss: 0.6880 - val_accuracy: 0.7932
Confusion matrix: 
 [[858  12]
 [213   5]]
Validation f1: 4.26
Validation accuracy: 79.32
Validation recall: 2.29
Validation precision: 29.41
Validation AUC: 0.18872433955169757
Validation class accuracies: [0.9862068965517241, 0.022935779816513763]
TARGET: 0
target metric(test auc): 0.18872433955169757
Saving model...
Epoch 7/50
144/144 - 290s - loss: 0.6931 - accuracy: 0.5722 - val_loss: 0.6947 - val_accuracy: 0.5322
Confusion matrix: 
 [[476 394]
 [115 103]]
Validation f1: 28.81
Validation accuracy: 53.22
Validation recall: 47.25
Validation precision: 20.72
Validation AUC: 0.21685933128460896
Validation class accuracies: [0.5471264367816092, 0.4724770642201835]
TARGET: 0
target metric(test auc): 0.21685933128460896
Saving model...
Epoch 8/50
144/144 - 290s - loss: 0.6936 - accuracy: 0.5809 - val_loss: 0.6907 - val_accuracy: 0.7528
Confusion matrix: 
 [[804  66]
 [203  15]]
Validation f1: 10.03
Validation accuracy: 75.28
Validation recall: 6.88
Validation precision: 18.52
Validation AUC: 0.24988010785225231
Validation class accuracies: [0.9241379310344827, 0.06880733944954129]
TARGET: 0
target metric(test auc): 0.24988010785225231
Saving model...
Epoch 9/50
144/144 - 290s - loss: 0.6927 - accuracy: 0.5774 - val_loss: 0.6876 - val_accuracy: 0.7877
Confusion matrix: 
 [[852  18]
 [213   5]]
Validation f1: 4.15
Validation accuracy: 78.77
Validation recall: 2.29
Validation precision: 21.74
Validation AUC: 0.21690394038777355
Validation class accuracies: [0.9793103448275862, 0.022935779816513763]
TARGET: 0
target metric(test auc): 0.21690394038777355
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 1 epochs
Epoch 10/50
144/144 - 291s - loss: 0.6923 - accuracy: 0.5857 - val_loss: 0.6984 - val_accuracy: 0.7160
Confusion matrix: 
 [[728 142]
 [167  51]]
Validation f1: 24.82
Validation accuracy: 71.60
Validation recall: 23.39
Validation precision: 26.42
Validation AUC: 0.23997991767309645
Validation class accuracies: [0.8367816091954023, 0.23394495412844038]
TARGET: 0
target metric(test auc): 0.23997991767309645
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 2 epochs
Epoch 11/50
144/144 - 291s - loss: 0.6925 - accuracy: 0.5830 - val_loss: 0.6939 - val_accuracy: 0.5496
Confusion matrix: 
 [[459 411]
 [ 79 139]]
Validation f1: 36.20
Validation accuracy: 54.96
Validation recall: 63.76
Validation precision: 25.27
Validation AUC: 0.24744217066346824
Validation class accuracies: [0.5275862068965518, 0.6376146788990825]
TARGET: 0
target metric(test auc): 0.24744217066346824
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 3 epochs
Epoch 12/50
144/144 - 290s - loss: 0.6921 - accuracy: 0.6026 - val_loss: 0.6913 - val_accuracy: 0.7721
Confusion matrix: 
 [[839  31]
 [217   1]]
Validation f1: 0.80
Validation accuracy: 77.21
Validation recall: 0.46
Validation precision: 3.12
Validation AUC: 0.20859487867547788
Validation class accuracies: [0.964367816091954, 0.0045871559633027525]
TARGET: 0
target metric(test auc): 0.20859487867547788
Lr has been adjusted to 0.000750000006519258
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 4 epochs
Epoch 13/50
144/144 - 291s - loss: 0.6918 - accuracy: 0.6026 - val_loss: 0.6899 - val_accuracy: 0.6866
Confusion matrix: 
 [[688 182]
 [159  59]]
Validation f1: 25.71
Validation accuracy: 68.66
Validation recall: 27.06
Validation precision: 24.48
Validation AUC: 0.23616477037364747
Validation class accuracies: [0.7908045977011494, 0.2706422018348624]
TARGET: 0
target metric(test auc): 0.23616477037364747
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 5 epochs
Epoch 14/50
144/144 - 290s - loss: 0.6917 - accuracy: 0.6196 - val_loss: 0.6937 - val_accuracy: 0.6397
Confusion matrix: 
 [[604 266]
 [126  92]]
Validation f1: 31.94
Validation accuracy: 63.97
Validation recall: 42.20
Validation precision: 25.70
Validation AUC: 0.24319409088973118
Validation class accuracies: [0.6942528735632184, 0.42201834862385323]
TARGET: 0
target metric(test auc): 0.24319409088973118
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 6 epochs
Epoch 15/50
144/144 - 292s - loss: 0.6913 - accuracy: 0.6200 - val_loss: 0.6887 - val_accuracy: 0.7491
Confusion matrix: 
 [[798  72]
 [201  17]]
Validation f1: 11.07
Validation accuracy: 74.91
Validation recall: 7.80
Validation precision: 19.10
Validation AUC: 0.23314642604752356
Validation class accuracies: [0.9172413793103448, 0.0779816513761468]
TARGET: 0
target metric(test auc): 0.23314642604752356
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 7 epochs
Epoch 16/50
144/144 - 291s - loss: 0.6913 - accuracy: 0.6261 - val_loss: 0.7012 - val_accuracy: 0.5009
Confusion matrix: 
 [[403 467]
 [ 76 142]]
Validation f1: 34.34
Validation accuracy: 50.09
Validation recall: 65.14
Validation precision: 23.32
Validation AUC: 0.24260337580749372
Validation class accuracies: [0.4632183908045977, 0.6513761467889908]
TARGET: 0
target metric(test auc): 0.24260337580749372
Lr has been adjusted to 0.0005624999757856131
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 8 epochs
Epoch 17/50
144/144 - 294s - loss: 0.6907 - accuracy: 0.6396 - val_loss: 0.6921 - val_accuracy: 0.5836
Confusion matrix: 
 [[510 360]
 [ 93 125]]
Validation f1: 35.56
Validation accuracy: 58.36
Validation recall: 57.34
Validation precision: 25.77
Validation AUC: 0.23455874571222024
Validation class accuracies: [0.5862068965517241, 0.573394495412844]
TARGET: 0
target metric(test auc): 0.23455874571222024
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 9 epochs
Epoch 18/50
144/144 - 291s - loss: 0.6907 - accuracy: 0.6348 - val_loss: 0.7155 - val_accuracy: 0.3438
Confusion matrix: 
 [[184 686]
 [ 28 190]]
Validation f1: 34.73
Validation accuracy: 34.38
Validation recall: 87.16
Validation precision: 21.69
Validation AUC: 0.24557678866368376
Validation class accuracies: [0.21149425287356322, 0.8715596330275229]
TARGET: 0
target metric(test auc): 0.24557678866368376
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 10 epochs
Epoch 19/50
144/144 - 291s - loss: 0.6904 - accuracy: 0.6535 - val_loss: 0.7115 - val_accuracy: 0.3879
Confusion matrix: 
 [[265 605]
 [ 61 157]]
Validation f1: 32.04
Validation accuracy: 38.79
Validation recall: 72.02
Validation precision: 20.60
Validation AUC: 0.2124680850431639
Validation class accuracies: [0.3045977011494253, 0.7201834862385321]
TARGET: 0
target metric(test auc): 0.2124680850431639
The validation tracker metric at 0.24988010785225231 hasn't increased by 0.01 in 11 epochs
Epoch 20/50
144/144 - 292s - loss: 0.6898 - accuracy: 0.6622 - val_loss: 0.6961 - val_accuracy: 0.5193
Confusion matrix: 
 [[463 407]
 [116 102]]
Validation f1: 28.06
Validation accuracy: 51.93
Validation recall: 46.79
Validation precision: 20.04
Validation AUC: 0.19625361366334187
Validation class accuracies: [0.532183908045977, 0.46788990825688076]
local_gc_exec.sh: line 6: 25992 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS"

 See logs at ../../new_cache/conv__2128__05_1726__v29__model9_undersampled/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
