Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2197
Description:  redo
2021-06-08 18:43:34.791266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-08 18:43:37.217690: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-08 18:43:37.218658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-08 18:43:37.227580: E tensorflow/stream_executor/cuda/cuda_driver.cc:328] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-08 18:43:37.227623: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: classification
2021-06-08 18:43:37.227632: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: classification
2021-06-08 18:43:37.227769: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 460.32.3
2021-06-08 18:43:37.227797: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 460.32.3
2021-06-08 18:43:37.227805: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 460.32.3
Tensorflow Version: 2.4.0
Num GPUs Available:  0
-----------------------
Using module: nv/train2197.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2197__06_1709__v29__redo
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 32, 'LR': 1e-07, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 50, 'FACTOR': 0.5, 'PATIENCE': 4, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 40, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-08 18:44:28.281385: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
The initial learning rate for this job is: 0.001
With concat = False and six = False, size of training set: 4212...
...and size of validation set: 1072
Initializing weights...
weights = {0: 0.6724137931034483, 1: 1.95}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250)]  0                                            
__________________________________________________________________________________________________
gru_2 (GRU)                     (None, 128, 64)      252672      input_1[0][0]                    
__________________________________________________________________________________________________
gru (GRU)                       (None, 128, 32)      123264      input_1[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_2 (LeakyReLU)       (None, 128, 64)      0           gru_2[0][0]                      
__________________________________________________________________________________________________
leaky_re_lu (LeakyReLU)         (None, 128, 32)      0           gru[0][0]                        
__________________________________________________________________________________________________
gru_3 (GRU)                     (None, 128, 128)     74496       leaky_re_lu_2[0][0]              
__________________________________________________________________________________________________
gru_1 (GRU)                     (None, 128, 128)     62208       leaky_re_lu[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_3 (LeakyReLU)       (None, 128, 128)     0           gru_3[0][0]                      
__________________________________________________________________________________________________
leaky_re_lu_1 (LeakyReLU)       (None, 128, 128)     0           gru_1[0][0]                      
__________________________________________________________________________________________________
add (Add)                       (None, 128, 128)     0           leaky_re_lu_3[0][0]              
                                                                 leaky_re_lu_1[0][0]              
__________________________________________________________________________________________________
gru_4 (GRU)                     (None, 128, 128)     99072       add[0][0]                        
__________________________________________________________________________________________________
gru_6 (GRU)                     (None, 128, 64)      37248       add[0][0]                        
__________________________________________________________________________________________________
leaky_re_lu_4 (LeakyReLU)       (None, 128, 128)     0           gru_4[0][0]                      
__________________________________________________________________________________________________
leaky_re_lu_6 (LeakyReLU)       (None, 128, 64)      0           gru_6[0][0]                      
__________________________________________________________________________________________________
gru_5 (GRU)                     (None, 128, 32)      15552       leaky_re_lu_4[0][0]              
__________________________________________________________________________________________________
gru_7 (GRU)                     (None, 128, 32)      9408        leaky_re_lu_6[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_5 (LeakyReLU)       (None, 128, 32)      0           gru_5[0][0]                      
__________________________________________________________________________________________________
leaky_re_lu_7 (LeakyReLU)       (None, 128, 32)      0           gru_7[0][0]                      
__________________________________________________________________________________________________
add_1 (Add)                     (None, 128, 32)      0           leaky_re_lu_5[0][0]              
                                                                 leaky_re_lu_7[0][0]              
                                                                 gru[0][0]                        
__________________________________________________________________________________________________
dense (Dense)                   (None, 128, 64)      2112        add_1[0][0]                      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 128, 32)      1056        add_1[0][0]                      
__________________________________________________________________________________________________
leaky_re_lu_8 (LeakyReLU)       (None, 128, 64)      0           dense[0][0]                      
__________________________________________________________________________________________________
leaky_re_lu_10 (LeakyReLU)      (None, 128, 32)      0           dense_2[0][0]                    
__________________________________________________________________________________________________
dropout (Dropout)               (None, 128, 64)      0           leaky_re_lu_8[0][0]              
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 128, 32)      0           leaky_re_lu_10[0][0]             
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 128, 16)      1040        dropout[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 128, 16)      528         dropout_1[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_9 (LeakyReLU)       (None, 128, 16)      0           dense_1[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_11 (LeakyReLU)      (None, 128, 16)      0           dense_3[0][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 128, 16)      0           leaky_re_lu_9[0][0]              
                                                                 leaky_re_lu_11[0][0]             
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 128, 16)      272         add_2[0][0]                      
__________________________________________________________________________________________________
leaky_re_lu_12 (LeakyReLU)      (None, 128, 16)      0           dense_4[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 128, 16)      0           leaky_re_lu_12[0][0]             
__________________________________________________________________________________________________
flatten (Flatten)               (None, 2048)         0           dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 1)            2049        flatten[0][0]                    
==================================================================================================
Total params: 680,977
Trainable params: 680,977
Non-trainable params: 0
__________________________________________________________________________________________________
2021-06-08 18:44:29.540628: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-08 18:44:29.542016: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
Epoch 1/50
132/132 - 477s - loss: 0.7192 - accuracy: 0.2564 - val_loss: 0.6839 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
Lr has been adjusted to 1.3999999737279722e-07
Saving model...
Epoch 2/50
132/132 - 505s - loss: 0.7169 - accuracy: 0.2564 - val_loss: 0.6846 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 1 epochs
Lr has been adjusted to 1.9599998779540329e-07
Epoch 3/50
132/132 - 459s - loss: 0.7208 - accuracy: 0.2564 - val_loss: 0.6853 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 2 epochs
Lr has been adjusted to 2.7439998007139366e-07
Epoch 4/50
132/132 - 441s - loss: 0.7174 - accuracy: 0.2564 - val_loss: 0.6865 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 3 epochs
Lr has been adjusted to 3.8415996073126735e-07
Epoch 5/50
132/132 - 508s - loss: 0.7159 - accuracy: 0.2564 - val_loss: 0.6873 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 4 epochs
Lr has been adjusted to 5.378239507081162e-07
Epoch 6/50
132/132 - 506s - loss: 0.7158 - accuracy: 0.2564 - val_loss: 0.6888 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 7.529534968853113e-07
Epoch 7/50
132/132 - 505s - loss: 0.7127 - accuracy: 0.2564 - val_loss: 0.6903 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 1.0541348274273332e-06
Epoch 8/50
132/132 - 513s - loss: 0.7110 - accuracy: 0.2564 - val_loss: 0.6922 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 7 epochs
Lr has been adjusted to 1.475788735660899e-06
Epoch 9/50
132/132 - 459s - loss: 0.7140 - accuracy: 0.2564 - val_loss: 0.6949 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 2.066104116238421e-06
Epoch 10/50
132/132 - 400s - loss: 0.7086 - accuracy: 0.2564 - val_loss: 0.6978 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 9 epochs
Lr has been adjusted to 2.8925458082085242e-06
Epoch 11/50
132/132 - 436s - loss: 0.7128 - accuracy: 0.2564 - val_loss: 0.7011 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 4.049564267916139e-06
Epoch 12/50
132/132 - 495s - loss: 0.7047 - accuracy: 0.2564 - val_loss: 0.7034 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 11 epochs
Lr has been adjusted to 5.6693897931836545e-06
Epoch 13/50
132/132 - 493s - loss: 0.7103 - accuracy: 0.2564 - val_loss: 0.7058 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 7.937145710457116e-06
Epoch 14/50
132/132 - 428s - loss: 0.7083 - accuracy: 0.2564 - val_loss: 0.7082 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 13 epochs
Lr has been adjusted to 1.1112003448943142e-05
Epoch 15/50
132/132 - 391s - loss: 0.7059 - accuracy: 0.2564 - val_loss: 0.7124 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 14 epochs
Lr has been adjusted to 1.555680501041934e-05
Epoch 16/50
132/132 - 378s - loss: 0.6979 - accuracy: 0.2564 - val_loss: 0.7094 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 2.1779525923193432e-05
Epoch 17/50
132/132 - 378s - loss: 0.7009 - accuracy: 0.2564 - val_loss: 0.7102 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 3.0491335564875044e-05
Epoch 18/50
132/132 - 377s - loss: 0.6977 - accuracy: 0.2564 - val_loss: 0.7085 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 17 epochs
Lr has been adjusted to 4.268786869943142e-05
Epoch 19/50
132/132 - 377s - loss: 0.6988 - accuracy: 0.2564 - val_loss: 0.7080 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 5.976301690679975e-05
Epoch 20/50
132/132 - 373s - loss: 0.6967 - accuracy: 0.2564 - val_loss: 0.7066 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 19 epochs
Lr has been adjusted to 8.366822294192389e-05
Epoch 21/50
132/132 - 368s - loss: 0.6966 - accuracy: 0.2564 - val_loss: 0.7055 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 20 epochs
Lr has been adjusted to 0.00011713551066350192
Epoch 22/50
132/132 - 366s - loss: 0.6929 - accuracy: 0.2564 - val_loss: 0.7023 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 21 epochs
Lr has been adjusted to 0.0001639897091081366
Epoch 23/50
132/132 - 368s - loss: 0.6930 - accuracy: 0.2564 - val_loss: 0.6964 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 22 epochs
Lr has been adjusted to 0.00022958559566177428
Epoch 24/50
132/132 - 366s - loss: 0.6875 - accuracy: 0.2564 - val_loss: 0.6877 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 23 epochs
Lr has been adjusted to 0.0003214198222849518
Epoch 25/50
132/132 - 366s - loss: 0.6870 - accuracy: 0.2564 - val_loss: 0.7234 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 24 epochs
Lr has been adjusted to 0.00044998773955740035
Epoch 26/50
132/132 - 368s - loss: 0.6845 - accuracy: 0.2564 - val_loss: 0.6821 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 25 epochs
Lr has been adjusted to 0.0006299828528426588
Epoch 27/50
132/132 - 388s - loss: 0.6770 - accuracy: 0.2564 - val_loss: 0.6749 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 26 epochs
Lr has been adjusted to 0.0008819759823381901
Epoch 28/50
132/132 - 397s - loss: 0.6710 - accuracy: 0.2564 - val_loss: 0.6923 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 27 epochs
Lr has been adjusted to 0.0012347663287073374
Epoch 29/50
132/132 - 397s - loss: 0.6635 - accuracy: 0.2564 - val_loss: 0.6935 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 28 epochs
Lr has been adjusted to 0.0017286728834733367
Epoch 30/50
132/132 - 403s - loss: 0.6512 - accuracy: 0.2564 - val_loss: 0.7214 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 29 epochs
Lr has been adjusted to 0.0024201420601457357
Epoch 31/50
132/132 - 400s - loss: 0.6209 - accuracy: 0.2564 - val_loss: 0.7154 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 30 epochs
Lr has been adjusted to 0.0033881987910717726
Epoch 32/50
132/132 - 399s - loss: 0.5905 - accuracy: 0.2564 - val_loss: 0.6678 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 31 epochs
Lr has been adjusted to 0.004743478260934353
Epoch 33/50
132/132 - 395s - loss: 0.5370 - accuracy: 0.2564 - val_loss: 0.7356 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 32 epochs
Lr has been adjusted to 0.0066408696584403515
Epoch 34/50
132/132 - 393s - loss: 0.4792 - accuracy: 0.2564 - val_loss: 0.8065 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 33 epochs
Lr has been adjusted to 0.00929721724241972
Epoch 35/50
132/132 - 383s - loss: 0.4674 - accuracy: 0.2564 - val_loss: 0.8559 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 34 epochs
Lr has been adjusted to 0.013016103766858578
Epoch 36/50
132/132 - 378s - loss: 0.4104 - accuracy: 0.2564 - val_loss: 1.0592 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 35 epochs
Lr has been adjusted to 0.018222544342279434
Epoch 37/50
132/132 - 377s - loss: 0.5177 - accuracy: 0.2564 - val_loss: 0.8474 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 36 epochs
Lr has been adjusted to 0.02551156096160412
Epoch 38/50
132/132 - 373s - loss: 0.4859 - accuracy: 0.2564 - val_loss: 0.9217 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6343283582089552
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.42352941176470593 hasn't increased by 0 in 37 epochs
Lr has been adjusted to 0.035716183483600616
Epoch 39/50
132/132 - 374s - loss: nan - accuracy: 0.7127 - val_loss: nan - val_accuracy: 0.7313
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2197.py", line 590, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2197.py", line 497, in train_model
    callbacks=[metrics_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/integration/keras/keras.py", line 124, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1145, in fit
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/callbacks.py", line 432, in on_epoch_end
    callback.on_epoch_end(epoch, numpy_logs)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2197.py", line 108, in on_epoch_end
    precisions, recalls, thresholds = precision_recall_curve(y_true_all, preds_all)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_ranking.py", line 673, in precision_recall_curve
    sample_weight=sample_weight)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_ranking.py", line 542, in _binary_clf_curve
    assert_all_finite(y_score)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/utils/validation.py", line 77, in assert_all_finite
    _assert_all_finite(X.data if sp.issparse(X) else X, allow_nan)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/utils/validation.py", line 60, in _assert_all_finite
    msg_dtype if msg_dtype is not None else X.dtype)
ValueError: Input contains NaN, infinity or a value too large for dtype('float32').
wandb: Waiting for W&B process to finish, PID 5455
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210608_184337-68x4cqj2/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210608_184337-68x4cqj2/logs/debug-internal.log
wandb: Run summary:
wandb:   train_accuracy 0.25641
wandb:     val_accuracy 0.26866
wandb:         _runtime 17638
wandb:       _timestamp 1623195455
wandb:            _step 268
wandb:       train_loss 0.48595
wandb:         val_loss 0.92173
wandb:       val_recall 1.0
wandb:    val_precision 0.26866
wandb:           val_f1 0.42353
wandb:          val_auc 0.63433
wandb:               lr 0.02551
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210608_184337-68x4cqj2


 See logs at ../../new_cache/conv__2197__06_1709__v29__redo/logs/