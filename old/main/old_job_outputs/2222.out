Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2222
Description:  redo
2021-06-15 20:18:16.099874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-15 20:18:19.664245: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-15 20:18:19.665396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-15 20:18:19.730229: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:19.731128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-15 20:18:19.731165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 20:18:19.735061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 20:18:19.735194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-15 20:18:19.736578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-15 20:18:19.736964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-15 20:18:19.738338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-15 20:18:19.739481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-15 20:18:19.739699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 20:18:19.739892: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:19.740925: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:19.741746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2222.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2222__06_2017__v39__redo
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 140, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-15 20:18:25.110835: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-15 20:18:25.111170: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:25.112139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-15 20:18:25.112230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 20:18:25.112322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 20:18:25.112352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-15 20:18:25.112382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-15 20:18:25.112411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-15 20:18:25.112444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-15 20:18:25.112492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-15 20:18:25.112522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 20:18:25.112671: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:25.113806: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:25.114780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-15 20:18:25.114848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 20:18:26.185155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-15 20:18:26.185206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-15 20:18:26.185221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-15 20:18:26.185546: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:26.186614: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:26.187591: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 20:18:26.188474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-15 20:18:28.893096: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-15 20:18:28.899328: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-15 20:18:29.564797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 20:18:32.395108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 20:18:33.011857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 1250, 128, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 1250, 128, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 1250, 128, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 1250, 128, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 1250, 128, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 1250, 128, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 1250, 128, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 1250, 128, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 1250, 128, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 625, 64, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 625, 64, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 625, 64, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 625, 64, 48)     40512        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 625, 64, 48)     40512        inverted_residual[0][0]              
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 625, 64, 48)     192          inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 625, 64, 48)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 625, 48)         0            dropout_1[0][0]                      
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 625, 256)        181248       time_distributed[0][0]               
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 625, 256)        394240       bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 625, 1)          257          bidirectional_1[0][0]                
______________________________________________________________________________________________________________
flatten (Flatten)                   (None, 625)             0            dense[0][0]                          
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               626          flatten[0][0]                        
==============================================================================================================
Total params: 666,615
Trainable params: 663,925
Non-trainable params: 2,690
______________________________________________________________________________________________________________
Epoch 1/65
151/151 - 209s - loss: 0.6954 - accuracy: 0.5373 - val_loss: 0.6251 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.047419548709162276
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
151/151 - 209s - loss: 0.7158 - accuracy: 0.5161 - val_loss: 0.8917 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.06340836163088337
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 3/65
151/151 - 212s - loss: 0.6855 - accuracy: 0.6958 - val_loss: 0.9226 - val_accuracy: 0.2446
Confusion matrix: 
 [[125 448]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.218 0.782]
 [0.281 0.719]]
Validation f1: 9.15
Validation accuracy: 24.46
Validation recall: 71.88
Validation precision: 4.88
Validation AUC: 0.048305973466208005
Validation class accuracies: [0.2181500872600349, 0.71875]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 4/65
151/151 - 212s - loss: 0.6798 - accuracy: 0.6502 - val_loss: 0.6839 - val_accuracy: 0.7901
Confusion matrix: 
 [[473 100]
 [ 27   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.844 0.156]]
Validation f1: 7.30
Validation accuracy: 79.01
Validation recall: 15.62
Validation precision: 4.76
Validation AUC: 0.05042752416267218
Validation class accuracies: [0.8254799301919721, 0.15625]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 5/65
151/151 - 207s - loss: 0.6776 - accuracy: 0.7798 - val_loss: 0.6758 - val_accuracy: 0.7620
Confusion matrix: 
 [[453 120]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.791 0.209]
 [0.75  0.25 ]]
Validation f1: 10.00
Validation accuracy: 76.20
Validation recall: 25.00
Validation precision: 6.25
Validation AUC: 0.0664752353546427
Validation class accuracies: [0.7905759162303665, 0.25]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 3 epochs
Epoch 6/65
151/151 - 197s - loss: 0.6750 - accuracy: 0.7372 - val_loss: 0.6719 - val_accuracy: 0.8215
Confusion matrix: 
 [[493  80]
 [ 28   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86  0.14 ]
 [0.875 0.125]]
Validation f1: 6.90
Validation accuracy: 82.15
Validation recall: 12.50
Validation precision: 4.76
Validation AUC: 0.05498446987657614
Validation class accuracies: [0.8603839441535777, 0.125]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 4 epochs
Epoch 7/65
151/151 - 197s - loss: 0.6721 - accuracy: 0.7546 - val_loss: 0.6642 - val_accuracy: 0.8050
Confusion matrix: 
 [[484  89]
 [ 29   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.845 0.155]
 [0.906 0.094]]
Validation f1: 4.84
Validation accuracy: 80.50
Validation recall: 9.38
Validation precision: 3.26
Validation AUC: 0.060240443355921075
Validation class accuracies: [0.8446771378708552, 0.09375]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 5 epochs
Epoch 8/65
151/151 - 196s - loss: 0.6687 - accuracy: 0.8435 - val_loss: 0.6516 - val_accuracy: 0.9273
Confusion matrix: 
 [[561  12]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 92.73
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07429665678780098
Validation class accuracies: [0.9790575916230366, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 9/65
151/151 - 196s - loss: 0.6639 - accuracy: 0.8613 - val_loss: 0.6526 - val_accuracy: 0.8562
Confusion matrix: 
 [[513  60]
 [ 27   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.844 0.156]]
Validation f1: 10.31
Validation accuracy: 85.62
Validation recall: 15.62
Validation precision: 7.69
Validation AUC: 0.07920471854783864
Validation class accuracies: [0.8952879581151832, 0.15625]
Saving model...
Epoch 10/65
151/151 - 196s - loss: 0.6608 - accuracy: 0.7777 - val_loss: 0.6563 - val_accuracy: 0.6248
Confusion matrix: 
 [[360 213]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.628 0.372]
 [0.438 0.562]]
Validation f1: 13.69
Validation accuracy: 62.48
Validation recall: 56.25
Validation precision: 7.79
Validation AUC: 0.07387983644314805
Validation class accuracies: [0.6282722513089005, 0.5625]
Saving model...
Epoch 11/65
151/151 - 196s - loss: 0.6536 - accuracy: 0.4499 - val_loss: 0.7544 - val_accuracy: 0.4066
Confusion matrix: 
 [[220 353]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.384 0.616]
 [0.188 0.812]]
Validation f1: 12.65
Validation accuracy: 40.66
Validation recall: 81.25
Validation precision: 6.86
Validation AUC: 0.12396220080732318
Validation class accuracies: [0.38394415357766143, 0.8125]
The validation tracker metric at 0.13688212927756654 hasn't increased by 0 in 1 epochs
Epoch 12/65
151/151 - 199s - loss: 0.5803 - accuracy: 0.4925 - val_loss: 0.6712 - val_accuracy: 0.7124
Confusion matrix: 
 [[403 170]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.703 0.297]
 [0.125 0.875]]
Validation f1: 24.35
Validation accuracy: 71.24
Validation recall: 87.50
Validation precision: 14.14
Validation AUC: 0.36809462439314045
Validation class accuracies: [0.7033158813263525, 0.875]
Saving model...
Epoch 13/65
151/151 - 199s - loss: 0.5151 - accuracy: 0.7045 - val_loss: 0.8545 - val_accuracy: 0.6066
Confusion matrix: 
 [[335 238]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.585 0.415]
 [0.    1.   ]]
Validation f1: 21.19
Validation accuracy: 60.66
Validation recall: 100.00
Validation precision: 11.85
Validation AUC: 0.37280445351236713
Validation class accuracies: [0.5846422338568935, 1.0]
The validation tracker metric at 0.2434782608695652 hasn't increased by 0 in 1 epochs
Epoch 14/65
151/151 - 201s - loss: 0.4460 - accuracy: 0.8377 - val_loss: 0.9378 - val_accuracy: 0.6331
Confusion matrix: 
 [[353 220]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.616 0.384]
 [0.062 0.938]]
Validation f1: 21.28
Validation accuracy: 63.31
Validation recall: 93.75
Validation precision: 12.00
Validation AUC: 0.37348178013158456
Validation class accuracies: [0.6160558464223386, 0.9375]
The validation tracker metric at 0.2434782608695652 hasn't increased by 0 in 2 epochs
Epoch 15/65
151/151 - 202s - loss: 0.4212 - accuracy: 0.8887 - val_loss: 1.1898 - val_accuracy: 0.5438
Confusion matrix: 
 [[297 276]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.518 0.482]
 [0.    1.   ]]
Validation f1: 18.82
Validation accuracy: 54.38
Validation recall: 100.00
Validation precision: 10.39
Validation AUC: 0.36781086996610973
Validation class accuracies: [0.518324607329843, 1.0]
The validation tracker metric at 0.2434782608695652 hasn't increased by 0 in 3 epochs
Epoch 16/65
151/151 - 200s - loss: 0.3891 - accuracy: 0.8953 - val_loss: 0.6101 - val_accuracy: 0.8364
Confusion matrix: 
 [[482  91]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.25  0.75 ]]
Validation f1: 32.65
Validation accuracy: 83.64
Validation recall: 75.00
Validation precision: 20.87
Validation AUC: 0.5172951568471247
Validation class accuracies: [0.8411867364746946, 0.75]
Saving model...
Epoch 17/65
151/151 - 200s - loss: 0.3795 - accuracy: 0.9031 - val_loss: 0.3851 - val_accuracy: 0.9174
Confusion matrix: 
 [[538  35]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.469 0.531]]
Validation f1: 40.48
Validation accuracy: 91.74
Validation recall: 53.12
Validation precision: 32.69
Validation AUC: 0.5289160616650657
Validation class accuracies: [0.9389179755671903, 0.53125]
Saving model...
Epoch 18/65
151/151 - 203s - loss: 0.3646 - accuracy: 0.9127 - val_loss: 0.4366 - val_accuracy: 0.8893
Confusion matrix: 
 [[523  50]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.531 0.469]]
Validation f1: 30.93
Validation accuracy: 88.93
Validation recall: 46.88
Validation precision: 23.08
Validation AUC: 0.4480479506275312
Validation class accuracies: [0.912739965095986, 0.46875]
The validation tracker metric at 0.40476190476190477 hasn't increased by 0 in 1 epochs
Epoch 19/65
151/151 - 201s - loss: 0.3477 - accuracy: 0.9094 - val_loss: 1.1187 - val_accuracy: 0.5769
Confusion matrix: 
 [[317 256]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.553 0.447]
 [0.    1.   ]]
Validation f1: 20.00
Validation accuracy: 57.69
Validation recall: 100.00
Validation precision: 11.11
Validation AUC: 0.27826261167444505
Validation class accuracies: [0.5532286212914486, 1.0]
The validation tracker metric at 0.40476190476190477 hasn't increased by 0 in 2 epochs
Epoch 20/65
151/151 - 199s - loss: 0.3387 - accuracy: 0.9189 - val_loss: 0.5707 - val_accuracy: 0.8413
Confusion matrix: 
 [[484  89]
 [  7  25]]
Normalized Confusion matrix: 
 [[0.845 0.155]
 [0.219 0.781]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.25
Validation accuracy: 84.13
Validation recall: 78.12
Validation precision: 21.93
Validation AUC: 0.39327956162614014
Validation class accuracies: [0.8446771378708552, 0.78125]
The validation tracker metric at 0.40476190476190477 hasn't increased by 0 in 3 epochs
Epoch 21/65
151/151 - 202s - loss: 0.3231 - accuracy: 0.9085 - val_loss: 0.3982 - val_accuracy: 0.8975
Confusion matrix: 
 [[524  49]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.406 0.594]]
Validation f1: 38.00
Validation accuracy: 89.75
Validation recall: 59.38
Validation precision: 27.94
Validation AUC: 0.48222219412394446
Validation class accuracies: [0.9144851657940664, 0.59375]
The validation tracker metric at 0.40476190476190477 hasn't increased by 0 in 4 epochs
Epoch 22/65
151/151 - 198s - loss: 0.3044 - accuracy: 0.9272 - val_loss: 0.3762 - val_accuracy: 0.9025
Confusion matrix: 
 [[533  40]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.594 0.406]]
Validation f1: 30.59
Validation accuracy: 90.25
Validation recall: 40.62
Validation precision: 24.53
Validation AUC: 0.39956212532870217
Validation class accuracies: [0.9301919720767888, 0.40625]
The validation tracker metric at 0.40476190476190477 hasn't increased by 0 in 5 epochs
Epoch 23/65
151/151 - 193s - loss: 0.3120 - accuracy: 0.9205 - val_loss: 0.3541 - val_accuracy: 0.9157
Confusion matrix: 
 [[535  38]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.406 0.594]]
Validation f1: 42.70
Validation accuracy: 91.57
Validation recall: 59.38
Validation precision: 33.33
Validation AUC: 0.5359864804333021
Validation class accuracies: [0.9336823734729494, 0.59375]
Saving model...
Epoch 24/65
151/151 - 193s - loss: 0.2907 - accuracy: 0.9300 - val_loss: 0.2896 - val_accuracy: 0.9504
Confusion matrix: 
 [[561  12]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.562 0.438]]
Validation f1: 48.28
Validation accuracy: 95.04
Validation recall: 43.75
Validation precision: 53.85
Validation AUC: 0.46462436338768975
Validation class accuracies: [0.9790575916230366, 0.4375]
Saving model...
Epoch 25/65
151/151 - 193s - loss: 0.2794 - accuracy: 0.9296 - val_loss: 0.3843 - val_accuracy: 0.9091
Confusion matrix: 
 [[530  43]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.375 0.625]]
Validation f1: 42.11
Validation accuracy: 90.91
Validation recall: 62.50
Validation precision: 31.75
Validation AUC: 0.4949486113648212
Validation class accuracies: [0.924956369982548, 0.625]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 1 epochs
Epoch 26/65
151/151 - 193s - loss: 0.2803 - accuracy: 0.9346 - val_loss: 0.8491 - val_accuracy: 0.7157
Confusion matrix: 
 [[406 167]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.709 0.291]
 [0.156 0.844]]
Validation f1: 23.89
Validation accuracy: 71.57
Validation recall: 84.38
Validation precision: 13.92
Validation AUC: 0.34108870255880863
Validation class accuracies: [0.7085514834205934, 0.84375]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 2 epochs
Epoch 27/65
151/151 - 193s - loss: 0.2912 - accuracy: 0.9193 - val_loss: 0.3443 - val_accuracy: 0.9306
Confusion matrix: 
 [[545  28]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.438 0.562]]
Validation f1: 46.15
Validation accuracy: 93.06
Validation recall: 56.25
Validation precision: 39.13
Validation AUC: 0.4566657857077423
Validation class accuracies: [0.9511343804537522, 0.5625]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 3 epochs
Epoch 28/65
151/151 - 193s - loss: 0.2702 - accuracy: 0.9313 - val_loss: 2.1637 - val_accuracy: 0.2992
Confusion matrix: 
 [[149 424]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.26 0.74]
 [0.   1.  ]]
Validation f1: 13.11
Validation accuracy: 29.92
Validation recall: 100.00
Validation precision: 7.02
Validation AUC: 0.17388465523980834
Validation class accuracies: [0.2600349040139616, 1.0]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 4 epochs
Epoch 29/65
151/151 - 193s - loss: 0.2703 - accuracy: 0.9296 - val_loss: 0.3686 - val_accuracy: 0.9008
Confusion matrix: 
 [[532  41]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.594 0.406]]
Validation f1: 30.23
Validation accuracy: 90.08
Validation recall: 40.62
Validation precision: 24.07
Validation AUC: 0.3492136496871748
Validation class accuracies: [0.9284467713787086, 0.40625]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 5 epochs
Epoch 30/65
151/151 - 193s - loss: 0.2514 - accuracy: 0.9503 - val_loss: 0.4115 - val_accuracy: 0.8860
Confusion matrix: 
 [[519  54]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 33.01
Validation accuracy: 88.60
Validation recall: 53.12
Validation precision: 23.94
Validation AUC: 0.33465580909646636
Validation class accuracies: [0.9057591623036649, 0.53125]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 31/65
151/151 - 193s - loss: 0.2374 - accuracy: 0.9450 - val_loss: 0.4195 - val_accuracy: 0.8926
Confusion matrix: 
 [[519  54]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.344 0.656]]
Validation f1: 39.25
Validation accuracy: 89.26
Validation recall: 65.62
Validation precision: 28.00
Validation AUC: 0.4033011745825724
Validation class accuracies: [0.9057591623036649, 0.65625]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 7 epochs
Epoch 32/65
151/151 - 193s - loss: 0.2390 - accuracy: 0.9462 - val_loss: 0.4032 - val_accuracy: 0.8975
Confusion matrix: 
 [[522  51]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.344 0.656]]
Validation f1: 40.38
Validation accuracy: 89.75
Validation recall: 65.62
Validation precision: 29.17
Validation AUC: 0.4056416525235538
Validation class accuracies: [0.9109947643979057, 0.65625]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 8 epochs
Epoch 33/65
151/151 - 193s - loss: 0.2258 - accuracy: 0.9470 - val_loss: 0.4219 - val_accuracy: 0.8893
Confusion matrix: 
 [[516  57]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.312 0.688]]
Validation f1: 39.64
Validation accuracy: 88.93
Validation recall: 68.75
Validation precision: 27.85
Validation AUC: 0.37889109051331094
Validation class accuracies: [0.900523560209424, 0.6875]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 9 epochs
Epoch 34/65
151/151 - 193s - loss: 0.2081 - accuracy: 0.9487 - val_loss: 0.3647 - val_accuracy: 0.9074
Confusion matrix: 
 [[530  43]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.406 0.594]]
Validation f1: 40.43
Validation accuracy: 90.74
Validation recall: 59.38
Validation precision: 30.65
Validation AUC: 0.3581617489240448
Validation class accuracies: [0.924956369982548, 0.59375]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 10 epochs
Epoch 35/65
151/151 - 193s - loss: 0.2013 - accuracy: 0.9582 - val_loss: 0.3940 - val_accuracy: 0.8992
Confusion matrix: 
 [[524  49]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.375 0.625]]
Validation f1: 39.60
Validation accuracy: 89.92
Validation recall: 62.50
Validation precision: 28.99
Validation AUC: 0.3739048790802383
Validation class accuracies: [0.9144851657940664, 0.625]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 11 epochs
Epoch 36/65
151/151 - 193s - loss: 0.1949 - accuracy: 0.9607 - val_loss: 0.4049 - val_accuracy: 0.9008
Confusion matrix: 
 [[528  45]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.469 0.531]]
Validation f1: 36.17
Validation accuracy: 90.08
Validation recall: 53.12
Validation precision: 27.42
Validation AUC: 0.3789581289498166
Validation class accuracies: [0.9214659685863874, 0.53125]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 37/65
151/151 - 193s - loss: 0.2090 - accuracy: 0.9433 - val_loss: 0.3721 - val_accuracy: 0.9107
Confusion matrix: 
 [[534  39]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.469 0.531]]
Validation f1: 38.64
Validation accuracy: 91.07
Validation recall: 53.12
Validation precision: 30.36
Validation AUC: 0.36045520780066587
Validation class accuracies: [0.9319371727748691, 0.53125]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 13 epochs
Epoch 38/65
151/151 - 193s - loss: 0.1939 - accuracy: 0.9611 - val_loss: 0.3838 - val_accuracy: 0.9041
Confusion matrix: 
 [[530  43]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.469 0.531]]
Validation f1: 36.96
Validation accuracy: 90.41
Validation recall: 53.12
Validation precision: 28.33
Validation AUC: 0.38227092946681007
Validation class accuracies: [0.924956369982548, 0.53125]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 14 epochs
Epoch 39/65
151/151 - 193s - loss: 0.1825 - accuracy: 0.9673 - val_loss: 0.3852 - val_accuracy: 0.9058
Confusion matrix: 
 [[532  41]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.5   0.5  ]]
Validation f1: 35.96
Validation accuracy: 90.58
Validation recall: 50.00
Validation precision: 28.07
Validation AUC: 0.38657294904278394
Validation class accuracies: [0.9284467713787086, 0.5]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 15 epochs
Epoch 40/65
151/151 - 193s - loss: 0.1899 - accuracy: 0.9553 - val_loss: 0.4148 - val_accuracy: 0.8942
Confusion matrix: 
 [[524  49]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.469 0.531]]
Validation f1: 34.69
Validation accuracy: 89.42
Validation recall: 53.12
Validation precision: 25.76
Validation AUC: 0.3416370880344115
Validation class accuracies: [0.9144851657940664, 0.53125]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 16 epochs
Epoch 41/65
151/151 - 193s - loss: 0.1819 - accuracy: 0.9648 - val_loss: 0.3858 - val_accuracy: 0.8926
Confusion matrix: 
 [[525  48]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.531 0.469]]
Validation f1: 31.58
Validation accuracy: 89.26
Validation recall: 46.88
Validation precision: 23.81
Validation AUC: 0.3465290506391603
Validation class accuracies: [0.9162303664921466, 0.46875]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 17 epochs
Epoch 42/65
151/151 - 193s - loss: 0.1890 - accuracy: 0.9590 - val_loss: 0.4217 - val_accuracy: 0.8876
Confusion matrix: 
 [[521  52]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.5   0.5  ]]
Validation f1: 32.00
Validation accuracy: 88.76
Validation recall: 50.00
Validation precision: 23.53
Validation AUC: 0.3299182005165665
Validation class accuracies: [0.9092495636998255, 0.5]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 43/65
151/151 - 193s - loss: 0.1719 - accuracy: 0.9685 - val_loss: 0.4004 - val_accuracy: 0.8959
Confusion matrix: 
 [[526  47]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.5   0.5  ]]
Validation f1: 33.68
Validation accuracy: 89.59
Validation recall: 50.00
Validation precision: 25.40
Validation AUC: 0.35899807366939723
Validation class accuracies: [0.9179755671902269, 0.5]
The validation tracker metric at 0.4827586206896552 hasn't increased by 0 in 19 epochs
Epoch 44/65
151/151 - 193s - loss: 0.1788 - accuracy: 0.9644 - val_loss: 0.3971 - val_accuracy: 0.8926
Confusion matrix: 
 [[525  48]
 [ 17  15]]
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.531 0.469]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 31.58
Validation accuracy: 89.26
Validation recall: 46.88
Validation precision: 23.81
Validation AUC: 0.3573632878018239
Validation class accuracies: [0.9162303664921466, 0.46875]

The metrics for job 0 with the best target metric are: 
Best cm: [[561  12]
 [ 18  14]]
Best normalized cm: [[0.979 0.021]
 [0.562 0.438]]
Best f1: 0.48
Best accuracy: 0.95
Best recall: 0.44
Best precision: 0.54
Best AUC: 0.46
Best class accuracies: [0.9790575916230366, 0.4375]
Best epoch: 24
The number of epochs since last 1% equals the patience
-----------------------
Second model
-----------------------
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 1250, 128, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 1250, 128, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 1250, 128, 16)   32           batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 1250, 128, 16)   32           batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 1250, 128, 1)    0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 1250, 128, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 1250, 128, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 1250, 128, 16)   32           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 1250, 128, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 625, 64, 48)     0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 625, 64, 48)     192          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 625, 64, 32)     13856        batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixD (None, 625, 64, 32)     828          conv2d_10[0][0]                      
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 625, 64, 32)     128          mix_depth_group_convolution2d[0][0]  
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 625, 64, 64)     11104        batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 625, 64, 64)     28096        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 313, 32, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 313, 32, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 313, 32, 128)    40640        batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 313, 32, 128)    105344       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 157, 16, 128)    0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 157, 16, 128)    512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 157, 16, 256)    155008       batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 157, 16, 256)    407296       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 79, 8, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 79, 8, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed (None, 79, 256)         0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
bidirectional_2 (Bidirectional)     (None, 79, 32)          34944        time_distributed_1[0][0]             
______________________________________________________________________________________________________________
bidirectional_3 (Bidirectional)     (None, 79, 64)          16640        bidirectional_2[0][0]                
______________________________________________________________________________________________________________
bidirectional_4 (Bidirectional)     (None, 79, 128)         66048        bidirectional_3[0][0]                
______________________________________________________________________________________________________________
bidirectional_5 (Bidirectional)     (None, 79, 256)         263168       bidirectional_4[0][0]                
______________________________________________________________________________________________________________
bidirectional_6 (Bidirectional)     (None, 79, 512)         1050624      bidirectional_5[0][0]                
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed (None, 79, 16)          8208         bidirectional_6[0][0]                
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 79, 1)           17           time_distributed_2[0][0]             
______________________________________________________________________________________________________________
flatten_1 (Flatten)                 (None, 79)              0            dense_3[0][0]                        
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 1)               80           flatten_1[0][0]                      
==============================================================================================================
Total params: 2,212,849
Trainable params: 2,201,935
Non-trainable params: 10,914
______________________________________________________________________________________________________________
Epoch 1/65
151/151 - 169s - loss: 0.6835 - accuracy: 0.2007 - val_loss: 0.6921 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
151/151 - 170s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6893 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5264462809917355
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
151/151 - 170s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6887 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.04897945664396128
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
151/151 - 169s - loss: 0.6872 - accuracy: 0.6573 - val_loss: 0.6795 - val_accuracy: 0.8430
Confusion matrix: 
 [[509  64]
 [ 31   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.969 0.031]]
Validation f1: 2.06
Validation accuracy: 84.30
Validation recall: 3.12
Validation precision: 1.54
Validation AUC: 0.04542308009344174
Validation class accuracies: [0.8883071553228621, 0.03125]
Saving model...
Epoch 5/65
151/151 - 169s - loss: 0.6866 - accuracy: 0.9507 - val_loss: 0.6880 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08469492612844483
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.020618556701030927 hasn't increased by 0 in 1 epochs
Epoch 6/65
151/151 - 170s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6882 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.11292459154788276
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.020618556701030927 hasn't increased by 0 in 2 epochs
Epoch 7/65
151/151 - 169s - loss: 0.6866 - accuracy: 0.9512 - val_loss: 0.6881 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09959789590588088
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.020618556701030927 hasn't increased by 0 in 3 epochs
Epoch 8/65
151/151 - 169s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6882 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2058655332729107
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.020618556701030927 hasn't increased by 0 in 4 epochs
Epoch 9/65
151/151 - 170s - loss: 0.6865 - accuracy: 0.9516 - val_loss: 0.6875 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19980601317633206
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.020618556701030927 hasn't increased by 0 in 5 epochs
Epoch 10/65
151/151 - 169s - loss: 0.6769 - accuracy: 0.8394 - val_loss: 1.3455 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.07826246322072136
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 11/65
151/151 - 169s - loss: 0.6874 - accuracy: 0.4036 - val_loss: 0.7738 - val_accuracy: 0.2248
Confusion matrix: 
 [[112 461]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.195 0.805]
 [0.25  0.75 ]]
Validation f1: 9.28
Validation accuracy: 22.48
Validation recall: 75.00
Validation precision: 4.95
Validation AUC: 0.044278788360857094
Validation class accuracies: [0.19546247818499127, 0.75]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 12/65
151/151 - 169s - loss: 0.6703 - accuracy: 0.5791 - val_loss: 0.6008 - val_accuracy: 0.5917
Confusion matrix: 
 [[341 232]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.595 0.405]
 [0.469 0.531]]
Validation f1: 12.10
Validation accuracy: 59.17
Validation recall: 53.12
Validation precision: 6.83
Validation AUC: 0.07351017545405092
Validation class accuracies: [0.5951134380453752, 0.53125]
Saving model...
Epoch 13/65
151/151 - 170s - loss: 0.6324 - accuracy: 0.4135 - val_loss: 0.7540 - val_accuracy: 0.6612
Confusion matrix: 
 [[375 198]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.654 0.346]
 [0.219 0.781]]
Validation f1: 19.61
Validation accuracy: 66.12
Validation recall: 78.12
Validation precision: 11.21
Validation AUC: 0.1711129414260381
Validation class accuracies: [0.6544502617801047, 0.78125]
Saving model...
Epoch 14/65
151/151 - 168s - loss: 0.6575 - accuracy: 0.5956 - val_loss: 0.8484 - val_accuracy: 0.4562
Confusion matrix: 
 [[244 329]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.426 0.574]
 [0.    1.   ]]
Validation f1: 16.28
Validation accuracy: 45.62
Validation recall: 100.00
Validation precision: 8.86
Validation AUC: 0.1030275286906719
Validation class accuracies: [0.4258289703315881, 1.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 1 epochs
Epoch 15/65
151/151 - 169s - loss: 0.6843 - accuracy: 0.4151 - val_loss: 0.5726 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.057254854218082865
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 2 epochs
Epoch 16/65
151/151 - 170s - loss: 0.6918 - accuracy: 0.4267 - val_loss: 0.6658 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06718461815620086
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 3 epochs
Epoch 17/65
151/151 - 169s - loss: 0.6905 - accuracy: 0.6573 - val_loss: 0.6462 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06981096370662625
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 4 epochs
Epoch 18/65
151/151 - 170s - loss: 0.6904 - accuracy: 0.4888 - val_loss: 0.6579 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0696888239930324
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 5 epochs
Epoch 19/65
151/151 - 170s - loss: 0.6899 - accuracy: 0.5985 - val_loss: 0.7159 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.07140210858014275
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 20/65
151/151 - 169s - loss: 0.6887 - accuracy: 0.3216 - val_loss: 0.6845 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07075614588690309
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 7 epochs
Epoch 21/65
151/151 - 168s - loss: 0.6884 - accuracy: 0.9520 - val_loss: 0.6768 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07217281931086944
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 8 epochs
Epoch 22/65
151/151 - 169s - loss: 0.6891 - accuracy: 0.8419 - val_loss: 0.6978 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.07149309624514244
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 9 epochs
Epoch 23/65
151/151 - 169s - loss: 0.6908 - accuracy: 0.5224 - val_loss: 0.6710 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07242856214112672
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 10 epochs
Epoch 24/65
151/151 - 169s - loss: 0.6888 - accuracy: 0.8618 - val_loss: 0.7031 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.07312482070366133
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 11 epochs
Epoch 25/65
151/151 - 169s - loss: 0.6884 - accuracy: 0.6966 - val_loss: 0.6936 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07356577307059056
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 26/65
151/151 - 170s - loss: 0.6877 - accuracy: 0.9272 - val_loss: 0.6928 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07294281803271861
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 13 epochs
Epoch 27/65
151/151 - 169s - loss: 0.6879 - accuracy: 0.4698 - val_loss: 0.6941 - val_accuracy: 0.0661
Confusion matrix: 
 [[  8 565]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.014 0.986]
 [0.    1.   ]]
Validation f1: 10.17
Validation accuracy: 6.61
Validation recall: 100.00
Validation precision: 5.36
Validation AUC: 0.07426914269216536
Validation class accuracies: [0.013961605584642234, 1.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 14 epochs
Epoch 28/65
151/151 - 169s - loss: 0.6878 - accuracy: 0.4632 - val_loss: 0.6857 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07477156938083546
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 15 epochs
Epoch 29/65
151/151 - 169s - loss: 0.6877 - accuracy: 0.7285 - val_loss: 0.6861 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07460525215008587
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 16 epochs
Epoch 30/65
151/151 - 169s - loss: 0.6881 - accuracy: 0.9520 - val_loss: 0.6838 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07443092525958034
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 17 epochs
Epoch 31/65
151/151 - 169s - loss: 0.6877 - accuracy: 0.7260 - val_loss: 0.6825 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07633869330889013
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 32/65
151/151 - 170s - loss: 0.6875 - accuracy: 0.9520 - val_loss: 0.6852 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07598905945170037
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.19607843137254904 hasn't increased by 0 in 19 epochs
Epoch 33/65
151/151 - 169s - loss: 0.6875 - accuracy: 0.9520 - val_loss: 0.6828 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07629560745160001
Validation class accuracies: [1.0, 0.0]

The metrics for job 0 with the best target metric are: 
Best cm: [[375 198]
 [  7  25]]
Best normalized cm: [[0.654 0.346]
 [0.219 0.781]]
Best f1: 0.20
Best accuracy: 0.66
Best recall: 0.78
Best precision: 0.11
Best AUC: 0.17
Best class accuracies: [0.6544502617801047, 0.78125]
Best epoch: 13
The number of epochs since last 1% equals the patience
-----------------------
Third model
-----------------------
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 1250, 128, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 1250, 128, 1)    4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 1250, 128, 16)   32           batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 1250, 128, 16)   32           batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 1250, 128, 1)    0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 1250, 128, 16)   2320         conv2d_11[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 1250, 128, 16)   6416         conv2d_13[0][0]                      
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 1250, 128, 16)   32           max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_7493 (Concatenate)      (None, 1250, 128, 48)   0            conv2d_12[0][0]                      
                                                                         conv2d_14[0][0]                      
                                                                         conv2d_15[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 625, 64, 48)     0            concatenate_7493[0][0]               
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 625, 64, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 625, 64, 48)     0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 625, 64, 48)     2352         dropout_2[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 625, 64, 48)     2352         dropout_2[0][0]                      
______________________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)      (None, 625, 64, 48)     0            dropout_2[0][0]                      
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 625, 64, 48)     20784        conv2d_16[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 625, 64, 48)     57648        conv2d_18[0][0]                      
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                  (None, 625, 64, 48)     2352         max_pooling2d_3[0][0]                
______________________________________________________________________________________________________________
concatenate_7494 (Concatenate)      (None, 625, 64, 144)    0            conv2d_17[0][0]                      
                                                                         conv2d_19[0][0]                      
                                                                         conv2d_20[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 313, 32, 144)    0            concatenate_7494[0][0]               
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 313, 32, 144)    576          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 313, 32, 144)    0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed (None, 313, 144)        0            dropout_3[0][0]                      
______________________________________________________________________________________________________________
bidirectional_7 (Bidirectional)     (None, 313, 256)        279552       time_distributed_3[0][0]             
______________________________________________________________________________________________________________
bidirectional_8 (Bidirectional)     (None, 256)             394240       bidirectional_7[0][0]                
______________________________________________________________________________________________________________
dense_5 (Dense)                     (None, 1)               257          bidirectional_8[0][0]                
==============================================================================================================
Total params: 769,141
Trainable params: 768,755
Non-trainable params: 386
______________________________________________________________________________________________________________
Epoch 1/65
151/151 - 84s - loss: 0.6660 - accuracy: 0.6341 - val_loss: 0.8979 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.11598376756173104
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
151/151 - 83s - loss: 0.5227 - accuracy: 0.7223 - val_loss: 2.0901 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.21304737396071372
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
151/151 - 83s - loss: 0.4771 - accuracy: 0.8286 - val_loss: 1.3501 - val_accuracy: 0.2661
Confusion matrix: 
 [[129 444]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.225 0.775]
 [0.    1.   ]]
Validation f1: 12.60
Validation accuracy: 26.61
Validation recall: 100.00
Validation precision: 6.72
Validation AUC: 0.21991916282882107
Validation class accuracies: [0.225130890052356, 1.0]
Saving model...
Epoch 4/65
151/151 - 83s - loss: 0.4072 - accuracy: 0.7810 - val_loss: 1.7140 - val_accuracy: 0.2033
Confusion matrix: 
 [[ 91 482]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.159 0.841]
 [0.    1.   ]]
Validation f1: 11.72
Validation accuracy: 20.33
Validation recall: 100.00
Validation precision: 6.23
Validation AUC: 0.0539049903304579
Validation class accuracies: [0.15881326352530542, 1.0]
The validation tracker metric at 0.12598425196850394 hasn't increased by 0 in 1 epochs
Epoch 5/65
151/151 - 83s - loss: 0.4199 - accuracy: 0.8059 - val_loss: 0.6018 - val_accuracy: 0.6496
Confusion matrix: 
 [[364 209]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.635 0.365]
 [0.094 0.906]]
Validation f1: 21.48
Validation accuracy: 64.96
Validation recall: 90.62
Validation precision: 12.18
Validation AUC: 0.28573105705205426
Validation class accuracies: [0.6352530541012217, 0.90625]
Saving model...
Epoch 6/65
151/151 - 83s - loss: 0.4125 - accuracy: 0.7670 - val_loss: 0.2160 - val_accuracy: 0.9190
Confusion matrix: 
 [[553  20]
 [ 29   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.906 0.094]]
Validation f1: 10.91
Validation accuracy: 91.90
Validation recall: 9.38
Validation precision: 13.04
Validation AUC: 0.17198540049286903
Validation class accuracies: [0.9650959860383944, 0.09375]
The validation tracker metric at 0.2148148148148148 hasn't increased by 0 in 1 epochs
Epoch 7/65
151/151 - 82s - loss: 0.4027 - accuracy: 0.8108 - val_loss: 0.4784 - val_accuracy: 0.7835
Confusion matrix: 
 [[446 127]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.778 0.222]
 [0.125 0.875]]
Validation f1: 29.95
Validation accuracy: 78.35
Validation recall: 87.50
Validation precision: 18.06
Validation AUC: 0.257975822783606
Validation class accuracies: [0.7783595113438045, 0.875]
Saving model...
Epoch 8/65
151/151 - 83s - loss: 0.3301 - accuracy: 0.8638 - val_loss: 0.3148 - val_accuracy: 0.8893
Confusion matrix: 
 [[516  57]
 [ 10  22]]
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.312 0.688]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.64
Validation accuracy: 88.93
Validation recall: 68.75
Validation precision: 27.85
Validation AUC: 0.3179787721861327
Validation class accuracies: [0.900523560209424, 0.6875]
Saving model...
Epoch 9/65
151/151 - 83s - loss: 0.2780 - accuracy: 0.8870 - val_loss: 0.2783 - val_accuracy: 0.8777
Confusion matrix: 
 [[511  62]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.375 0.625]]
Validation f1: 35.09
Validation accuracy: 87.77
Validation recall: 62.50
Validation precision: 24.39
Validation AUC: 0.2763972397681819
Validation class accuracies: [0.8917975567190227, 0.625]
The validation tracker metric at 0.3963963963963964 hasn't increased by 0 in 1 epochs
Epoch 10/65
151/151 - 84s - loss: 0.2931 - accuracy: 0.8911 - val_loss: 0.3961 - val_accuracy: 0.8777
Confusion matrix: 
 [[506  67]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.219 0.781]]
Validation f1: 40.32
Validation accuracy: 87.77
Validation recall: 78.12
Validation precision: 27.17
Validation AUC: 0.25104272738527006
Validation class accuracies: [0.8830715532286213, 0.78125]
Saving model...
Epoch 11/65
151/151 - 83s - loss: 0.3216 - accuracy: 0.8804 - val_loss: 0.3984 - val_accuracy: 0.8331
Confusion matrix: 
 [[481  92]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.281 0.719]]
Validation f1: 31.29
Validation accuracy: 83.31
Validation recall: 71.88
Validation precision: 20.00
Validation AUC: 0.32998333564871646
Validation class accuracies: [0.8394415357766143, 0.71875]
The validation tracker metric at 0.4032258064516128 hasn't increased by 0 in 1 epochs
Epoch 12/65
151/151 - 82s - loss: 0.3126 - accuracy: 0.8373 - val_loss: 0.3821 - val_accuracy: 0.8347
Confusion matrix: 
 [[480  93]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.219 0.781]]
Validation f1: 33.33
Validation accuracy: 83.47
Validation recall: 78.12
Validation precision: 21.19
Validation AUC: 0.24405177988397084
Validation class accuracies: [0.837696335078534, 0.78125]
The validation tracker metric at 0.4032258064516128 hasn't increased by 0 in 2 epochs
Epoch 13/65
151/151 - 82s - loss: 0.2748 - accuracy: 0.8779 - val_loss: 0.3768 - val_accuracy: 0.8579
Confusion matrix: 
 [[494  79]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.219 0.781]]
Validation f1: 36.76
Validation accuracy: 85.79
Validation recall: 78.12
Validation precision: 24.04
Validation AUC: 0.2923537271777427
Validation class accuracies: [0.8621291448516579, 0.78125]
The validation tracker metric at 0.4032258064516128 hasn't increased by 0 in 3 epochs
Epoch 14/65
151/151 - 83s - loss: 0.2808 - accuracy: 0.8733 - val_loss: 0.5260 - val_accuracy: 0.7719
Confusion matrix: 
 [[438 135]
 [  3  29]]
Normalized Confusion matrix: 
 [[0.764 0.236]
 [0.094 0.906]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 29.59
Validation accuracy: 77.19
Validation recall: 90.62
Validation precision: 17.68
Validation AUC: 0.276670094854142
Validation class accuracies: [0.7643979057591623, 0.90625]
The validation tracker metric at 0.4032258064516128 hasn't increased by 0 in 4 epochs
Epoch 15/65
151/151 - 83s - loss: 0.2278 - accuracy: 0.8932 - val_loss: 0.4370 - val_accuracy: 0.8397
Confusion matrix: 
 [[482  91]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.188 0.812]]
Validation f1: 34.90
Validation accuracy: 83.97
Validation recall: 81.25
Validation precision: 22.22
Validation AUC: 0.2770714514212265
Validation class accuracies: [0.8411867364746946, 0.8125]
The validation tracker metric at 0.4032258064516128 hasn't increased by 0 in 5 epochs
Epoch 16/65
151/151 - 83s - loss: 0.2275 - accuracy: 0.8895 - val_loss: 0.4547 - val_accuracy: 0.8380
Confusion matrix: 
 [[481  92]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.188 0.812]]
Validation f1: 34.67
Validation accuracy: 83.80
Validation recall: 81.25
Validation precision: 22.03
Validation AUC: 0.22125176028982116
Validation class accuracies: [0.8394415357766143, 0.8125]
The validation tracker metric at 0.4032258064516128 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
151/151 - 83s - loss: 0.2028 - accuracy: 0.9040 - val_loss: 0.3986 - val_accuracy: 0.8678
Confusion matrix: 
 [[500  73]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.219 0.781]]
Validation f1: 38.46
Validation accuracy: 86.78
Validation recall: 78.12
Validation precision: 25.51
Validation AUC: 0.30340801779481363
Validation class accuracies: [0.8726003490401396, 0.78125]
The validation tracker metric at 0.4032258064516128 hasn't increased by 0 in 7 epochs
Epoch 18/65
151/151 - 82s - loss: 0.1988 - accuracy: 0.9193 - val_loss: 0.3615 - val_accuracy: 0.8760
Confusion matrix: 
 [[504  69]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.188 0.812]]
Validation f1: 40.94
Validation accuracy: 87.60
Validation recall: 81.25
Validation precision: 27.37
Validation AUC: 0.2825324004974573
Validation class accuracies: [0.8795811518324608, 0.8125]
Saving model...
Epoch 19/65
151/151 - 82s - loss: 0.2034 - accuracy: 0.9060 - val_loss: 0.3911 - val_accuracy: 0.8562
Confusion matrix: 
 [[492  81]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.188 0.812]]
Validation f1: 37.41
Validation accuracy: 85.62
Validation recall: 81.25
Validation precision: 24.30
Validation AUC: 0.22377203688936959
Validation class accuracies: [0.8586387434554974, 0.8125]
The validation tracker metric at 0.40944881889763785 hasn't increased by 0 in 1 epochs
Epoch 20/65
151/151 - 83s - loss: 0.1645 - accuracy: 0.9288 - val_loss: 0.5504 - val_accuracy: 0.7901
Confusion matrix: 
 [[449 124]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.784 0.216]
 [0.094 0.906]]
Validation f1: 31.35
Validation accuracy: 79.01
Validation recall: 90.62
Validation precision: 18.95
Validation AUC: 0.23311060678304807
Validation class accuracies: [0.7835951134380453, 0.90625]
The validation tracker metric at 0.40944881889763785 hasn't increased by 0 in 2 epochs
Epoch 21/65
151/151 - 83s - loss: 0.1999 - accuracy: 0.9011 - val_loss: 0.6853 - val_accuracy: 0.7025
Confusion matrix: 
 [[394 179]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.688 0.312]
 [0.031 0.969]]
Validation f1: 25.62
Validation accuracy: 70.25
Validation recall: 96.88
Validation precision: 14.76
Validation AUC: 0.2188843066412949
Validation class accuracies: [0.68760907504363, 0.96875]
The validation tracker metric at 0.40944881889763785 hasn't increased by 0 in 3 epochs
Epoch 22/65
151/151 - 84s - loss: 0.1949 - accuracy: 0.9081 - val_loss: 0.2798 - val_accuracy: 0.9074
Confusion matrix: 
 [[528  45]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.344 0.656]]
Validation f1: 42.86
Validation accuracy: 90.74
Validation recall: 65.62
Validation precision: 31.82
Validation AUC: 0.3204434733944072
Validation class accuracies: [0.9214659685863874, 0.65625]
Saving model...
Epoch 23/65
151/151 - 83s - loss: 0.1570 - accuracy: 0.9193 - val_loss: 0.3564 - val_accuracy: 0.8777
Confusion matrix: 
 [[507  66]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.25  0.75 ]]
Validation f1: 39.34
Validation accuracy: 87.77
Validation recall: 75.00
Validation precision: 26.67
Validation AUC: 0.2962915241248041
Validation class accuracies: [0.8848167539267016, 0.75]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 1 epochs
Epoch 24/65
151/151 - 82s - loss: 0.1517 - accuracy: 0.9226 - val_loss: 0.3802 - val_accuracy: 0.8678
Confusion matrix: 
 [[499  74]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.188 0.812]]
Validation f1: 39.39
Validation accuracy: 86.78
Validation recall: 81.25
Validation precision: 26.00
Validation AUC: 0.2430343448342142
Validation class accuracies: [0.8708551483420593, 0.8125]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 2 epochs
Epoch 25/65
151/151 - 82s - loss: 0.1609 - accuracy: 0.9255 - val_loss: 0.5655 - val_accuracy: 0.7818
Confusion matrix: 
 [[444 129]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.094 0.906]]
Validation f1: 30.53
Validation accuracy: 78.18
Validation recall: 90.62
Validation precision: 18.35
Validation AUC: 0.23439803643256185
Validation class accuracies: [0.774869109947644, 0.90625]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 3 epochs
Epoch 26/65
151/151 - 83s - loss: 0.1501 - accuracy: 0.9251 - val_loss: 0.3575 - val_accuracy: 0.8694
Confusion matrix: 
 [[502  71]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.25  0.75 ]]
Validation f1: 37.80
Validation accuracy: 86.94
Validation recall: 75.00
Validation precision: 25.26
Validation AUC: 0.26949991302864784
Validation class accuracies: [0.8760907504363001, 0.75]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 4 epochs
Epoch 27/65
151/151 - 83s - loss: 0.1356 - accuracy: 0.9396 - val_loss: 0.3819 - val_accuracy: 0.8579
Confusion matrix: 
 [[495  78]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.25  0.75 ]]
Validation f1: 35.82
Validation accuracy: 85.79
Validation recall: 75.00
Validation precision: 23.53
Validation AUC: 0.2598315496887731
Validation class accuracies: [0.8638743455497382, 0.75]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 5 epochs
Epoch 28/65
151/151 - 83s - loss: 0.1402 - accuracy: 0.9334 - val_loss: 0.4129 - val_accuracy: 0.8628
Confusion matrix: 
 [[496  77]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.866 0.134]
 [0.188 0.812]]
Validation f1: 38.52
Validation accuracy: 86.28
Validation recall: 81.25
Validation precision: 25.24
Validation AUC: 0.2636508895363797
Validation class accuracies: [0.8656195462478184, 0.8125]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 29/65
151/151 - 83s - loss: 0.1405 - accuracy: 0.9350 - val_loss: 0.3373 - val_accuracy: 0.8860
Confusion matrix: 
 [[512  61]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.25  0.75 ]]
Validation f1: 41.03
Validation accuracy: 88.60
Validation recall: 75.00
Validation precision: 28.24
Validation AUC: 0.2829944173901833
Validation class accuracies: [0.893542757417103, 0.75]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 7 epochs
Epoch 30/65
151/151 - 82s - loss: 0.1167 - accuracy: 0.9396 - val_loss: 0.4047 - val_accuracy: 0.8661
Confusion matrix: 
 [[498  75]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.188 0.812]]
Validation f1: 39.10
Validation accuracy: 86.61
Validation recall: 81.25
Validation precision: 25.74
Validation AUC: 0.2547343976380333
Validation class accuracies: [0.8691099476439791, 0.8125]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 8 epochs
Epoch 31/65
151/151 - 82s - loss: 0.1383 - accuracy: 0.9404 - val_loss: 0.5050 - val_accuracy: 0.8248
Confusion matrix: 
 [[472 101]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.824 0.176]
 [0.156 0.844]]
Validation f1: 33.75
Validation accuracy: 82.48
Validation recall: 84.38
Validation precision: 21.09
Validation AUC: 0.23667662038923554
Validation class accuracies: [0.8237347294938918, 0.84375]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 9 epochs
Epoch 32/65
151/151 - 83s - loss: 0.1281 - accuracy: 0.9458 - val_loss: 0.4496 - val_accuracy: 0.8479
Confusion matrix: 
 [[489  84]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.853 0.147]
 [0.25  0.75 ]]
Validation f1: 34.29
Validation accuracy: 84.79
Validation recall: 75.00
Validation precision: 22.22
Validation AUC: 0.24797697202180946
Validation class accuracies: [0.8534031413612565, 0.75]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 10 epochs
Epoch 33/65
151/151 - 83s - loss: 0.1100 - accuracy: 0.9454 - val_loss: 0.3813 - val_accuracy: 0.8678
Confusion matrix: 
 [[499  74]
 [  6  26]]
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.188 0.812]]
Validation f1: 39.39
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 86.78
Validation recall: 81.25
Validation precision: 26.00
Validation AUC: 0.2891017858844467
Validation class accuracies: [0.8708551483420593, 0.8125]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 11 epochs
Epoch 34/65
151/151 - 83s - loss: 0.1199 - accuracy: 0.9487 - val_loss: 0.4399 - val_accuracy: 0.8314
Confusion matrix: 
 [[476  97]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.831 0.169]
 [0.156 0.844]]
Validation f1: 34.62
Validation accuracy: 83.14
Validation recall: 84.38
Validation precision: 21.77
Validation AUC: 0.24860673623059257
Validation class accuracies: [0.8307155322862129, 0.84375]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 35/65
151/151 - 83s - loss: 0.1286 - accuracy: 0.9338 - val_loss: 0.3311 - val_accuracy: 0.8777
Confusion matrix: 
 [[509  64]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.312 0.688]]
Validation f1: 37.29
Validation accuracy: 87.77
Validation recall: 68.75
Validation precision: 25.58
Validation AUC: 0.2834494966137026
Validation class accuracies: [0.8883071553228621, 0.6875]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 13 epochs
Epoch 36/65
151/151 - 82s - loss: 0.1172 - accuracy: 0.9503 - val_loss: 0.3547 - val_accuracy: 0.8727
Confusion matrix: 
 [[506  67]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.312 0.688]]
Validation f1: 36.36
Validation accuracy: 87.27
Validation recall: 68.75
Validation precision: 24.72
Validation AUC: 0.26665253652594034
Validation class accuracies: [0.8830715532286213, 0.6875]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 14 epochs
Epoch 37/65
151/151 - 82s - loss: 0.1038 - accuracy: 0.9491 - val_loss: 0.3431 - val_accuracy: 0.8760
Confusion matrix: 
 [[508  65]
 [ 10  22]]
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.312 0.688]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.97
Validation accuracy: 87.60
Validation recall: 68.75
Validation precision: 25.29
Validation AUC: 0.27267858604848755
Validation class accuracies: [0.8865619546247818, 0.6875]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 15 epochs
Epoch 38/65
151/151 - 83s - loss: 0.1171 - accuracy: 0.9450 - val_loss: 0.3433 - val_accuracy: 0.8793
Confusion matrix: 
 [[510  63]
 [ 10  22]]
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.312 0.688]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.61
Validation accuracy: 87.93
Validation recall: 68.75
Validation precision: 25.88
Validation AUC: 0.2770298562660536
Validation class accuracies: [0.8900523560209425, 0.6875]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 16 epochs
Epoch 39/65
151/151 - 83s - loss: 0.0903 - accuracy: 0.9561 - val_loss: 0.3726 - val_accuracy: 0.8744
Confusion matrix: 
 [[507  66]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.312 0.688]]
Validation f1: 36.67
Validation accuracy: 87.44
Validation recall: 68.75
Validation precision: 25.00
Validation AUC: 0.2710010226229844
Validation class accuracies: [0.8848167539267016, 0.6875]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 17 epochs
Epoch 40/65
151/151 - 83s - loss: 0.0996 - accuracy: 0.9557 - val_loss: 0.3641 - val_accuracy: 0.8744
Confusion matrix: 
 [[507  66]
 [ 10  22]]
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.312 0.688]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.67
Validation accuracy: 87.44
Validation recall: 68.75
Validation precision: 25.00
Validation AUC: 0.25204035748210135
Validation class accuracies: [0.8848167539267016, 0.6875]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 41/65
151/151 - 83s - loss: 0.0957 - accuracy: 0.9561 - val_loss: 0.3626 - val_accuracy: 0.8744
Confusion matrix: 
 [[507  66]
 [ 10  22]]
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.312 0.688]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.67
Validation accuracy: 87.44
Validation recall: 68.75
Validation precision: 25.00
Validation AUC: 0.2581341032051024
Validation class accuracies: [0.8848167539267016, 0.6875]
The validation tracker metric at 0.4285714285714286 hasn't increased by 0 in 19 epochs
Epoch 42/65
151/151 - 82s - loss: 0.0983 - accuracy: 0.9512 - val_loss: 0.3563 - val_accuracy: 0.8777
Confusion matrix: 
 [[509  64]
 [ 10  22]]
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.312 0.688]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.29
Validation accuracy: 87.77
Validation recall: 68.75
Validation precision: 25.58
Validation AUC: 0.2557256256237691
Validation class accuracies: [0.8883071553228621, 0.6875]

The metrics for job 0 with the best target metric are: 
Best cm: [[528  45]
 [ 11  21]]
Best normalized cm: [[0.921 0.079]
 [0.344 0.656]]
Best f1: 0.43
Best accuracy: 0.91
Best recall: 0.66
Best precision: 0.32
Best AUC: 0.32
Best class accuracies: [0.9214659685863874, 0.65625]
Best epoch: 22
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 31096
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210615_201819-w4aq37nm/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210615_201819-w4aq37nm/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.95116
wandb:         val_accuracy 0.87769
wandb:             _runtime 19168
wandb:           _timestamp 1623807468
wandb:                _step 892
wandb:           train_loss 0.09834
wandb:             val_loss 0.35628
wandb:           val_recall 0.6875
wandb:        val_precision 0.25581
wandb:               val_f1 0.37288
wandb:              val_auc 0.25573
wandb:                   lr 6e-05
wandb:          best_val_f1 0.42857
wandb:    best_val_accuracy 0.90744
wandb:   best_val_precision 0.31818
wandb:      best_val_recall 0.65625
wandb:             best_auc 0.32044
wandb:           best_epoch 22
wandb: Run history:
wandb:   train_accuracy ▃▅▆▆▅▇▇███████████▂▄▅▁▃█▅█▅▆▇▇▇▇█▇██████
wandb:     val_accuracy █▇▇▅▅▇▅██▃████████▂▄██████▁▆█▇▇▇▇▇▇█▇▇▇▇
wandb:         _runtime ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇█████
wandb:       _timestamp ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇█████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ████▆▄▄▃▃▃▃▂▂▂▂███████████▆▅▄▄▃▂▂▂▂▁▁▁▁▁
wandb:         val_loss ▂▂▂▂▃▂▄▁▁█▁▁▁▁▁▂▂▂▃▃▂▂▂▂▂▂█▂▁▁▂▁▂▁▁▁▂▁▁▁
wandb:       val_recall ▁▂▂▅█▆█▄▅█▆▅▅▅▅▁▁▁▆█▁▁▁▁▁▁█▇▆▆▇▆▇▆▆▆▆▆▆▆
wandb:    val_precision ▁▂▂▃▄▆▃▆█▃▇██▇▇▁▁▁▂▃▁▁▁▁▁▁▂▄▇▅▅▇▅▇▇▇▆▇▇▇
wandb:           val_f1 ▁▂▂▃▅▆▄▆█▃██▇▇▇▁▁▁▃▄▁▁▁▁▁▁▃▅█▆▆▇▆█▇█▇▇▇▇
wandb:          val_auc ▁▁▁▁▆█▄▆█▃▆▆▆▅▆█▂▃▁▂▁▁▁▁▁▁▃▅▅▅▄▅▄▅▄▄▄▄▄▄
wandb:               lr ███▄▄▄▄▄▄▄▂▂▁▁▁██████▄▄▂▂▁█████▄▄▄▄▂▂▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210615_201819-w4aq37nm


 See logs at ../../new_cache/conv__2222__06_2017__v39__redo/logs/