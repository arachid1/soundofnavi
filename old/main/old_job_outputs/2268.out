Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2268
Description:  mixup_augm
2021-06-29 03:27:07.819536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-29 03:27:10.016051: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 03:27:10.017026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-29 03:27:10.063145: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:10.063831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 03:27:10.063860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 03:27:10.067302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 03:27:10.067389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 03:27:10.068436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 03:27:10.068734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 03:27:10.069804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 03:27:10.070786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 03:27:10.070939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 03:27:10.071049: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:10.071763: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:10.072365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2268.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2268__06_0326__v39__mixup_augm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 03:27:14.811024: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 03:27:14.811290: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:14.811991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 03:27:14.812032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 03:27:14.812084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 03:27:14.812104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 03:27:14.812122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 03:27:14.812140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 03:27:14.812158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 03:27:14.812176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 03:27:14.812192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 03:27:14.812285: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:14.812975: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:14.813630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-29 03:27:14.813685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 03:27:15.503325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-29 03:27:15.503371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-29 03:27:15.503379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-29 03:27:15.503644: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:15.504419: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:15.505132: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 03:27:15.505775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-29 03:27:16.363471: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-29 03:27:16.365634: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-29 03:28:20.171657: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 03:28:30.177163: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 03:28:40.017690: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3616
2021-06-29 03:28:50.028857: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2849 of 3616
2021-06-29 03:29:00.154095: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 3616
2021-06-29 03:29:02.186069: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-06-29 03:29:02.408412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 03:29:03.870839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 03:29:04.288827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3216
-----------------------
Number of train recordings: 3216 with pneumonia: 316 and non-pneumonia: 2900
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3616
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
226/226 - 140s - loss: 0.3219 - accuracy: 0.8811 - val_loss: 0.2487 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0728879882743403
Validation class accuracies: [1.0, 0.0]
2021-06-29 03:30:48.510948: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 03:30:58.577071: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 03:31:08.523709: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 03:31:18.434613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 3616
2021-06-29 03:31:28.467056: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3329 of 3616
2021-06-29 03:31:35.763334: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
226/226 - 146s - loss: 0.1621 - accuracy: 0.9275 - val_loss: 0.2482 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1792163196543039
Validation class accuracies: [1.0, 0.0]
2021-06-29 03:33:23.398721: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 03:33:33.204345: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1435 of 3616
2021-06-29 03:33:43.409716: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 03:33:53.255368: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 03:34:03.204276: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3503 of 3616
2021-06-29 03:34:05.188631: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
226/226 - 135s - loss: 0.0895 - accuracy: 0.9546 - val_loss: 0.1885 - val_accuracy: 0.9381
Confusion matrix: 
 [[573   0]
 [ 38   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.927 0.073]]
Validation f1: 13.64
Validation accuracy: 93.81
Validation recall: 7.32
Validation precision: 100.00
Validation AUC: 0.5862068606302794
Validation class accuracies: [1.0, 0.07317073170731707]
2021-06-29 03:35:47.670111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 03:35:57.813938: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 03:36:07.695791: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 03:36:17.632756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 03:36:27.764853: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 03:36:29.425324: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
226/226 - 135s - loss: 0.0478 - accuracy: 0.9735 - val_loss: 0.2597 - val_accuracy: 0.9430
Confusion matrix: 
 [[573   0]
 [ 35   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.854 0.146]]
Validation f1: 25.53
Validation accuracy: 94.30
Validation recall: 14.63
Validation precision: 100.00
Validation AUC: 0.6371463171112219
Validation class accuracies: [1.0, 0.14634146341463414]
2021-06-29 03:38:12.241518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 03:38:22.348920: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 03:38:32.302369: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 03:38:42.309502: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 03:38:52.343995: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 03:38:54.010215: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
226/226 - 138s - loss: 0.0343 - accuracy: 0.9748 - val_loss: 0.3418 - val_accuracy: 0.8893
Confusion matrix: 
 [[521  52]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.39  0.61 ]]
Validation f1: 42.37
Validation accuracy: 88.93
Validation recall: 60.98
Validation precision: 32.47
Validation AUC: 0.5751169575711699
Validation class accuracies: [0.9092495636998255, 0.6097560975609756]
2021-06-29 03:40:41.572894: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-29 03:40:51.517316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 3616
2021-06-29 03:41:01.709701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3616
2021-06-29 03:41:11.650043: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1777 of 3616
2021-06-29 03:41:21.410848: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 03:41:31.675577: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2545 of 3616
2021-06-29 03:41:41.531375: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3185 of 3616
2021-06-29 03:41:49.110663: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
226/226 - 162s - loss: 0.0275 - accuracy: 0.9801 - val_loss: 0.1908 - val_accuracy: 0.9463
Confusion matrix: 
 [[560  13]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.488 0.512]]
Validation f1: 56.00
Validation accuracy: 94.63
Validation recall: 51.22
Validation precision: 61.76
Validation AUC: 0.625852008771932
Validation class accuracies: [0.9773123909249564, 0.5121951219512195]
2021-06-29 03:43:32.142416: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 03:43:42.209890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 03:43:52.213983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 03:44:02.157551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 03:44:12.073568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 03:44:13.727097: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 7/65
226/226 - 136s - loss: 0.0231 - accuracy: 0.9784 - val_loss: 0.1785 - val_accuracy: 0.9625
Confusion matrix: 
 [[569   4]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.463 0.537]]
Validation f1: 65.67
Validation accuracy: 96.25
Validation recall: 53.66
Validation precision: 84.62
Validation AUC: 0.6695843042211034
Validation class accuracies: [0.9930191972076788, 0.5365853658536586]
2021-06-29 03:45:56.731074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 03:46:06.647424: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 03:46:16.672485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 03:46:26.776981: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 03:46:36.765754: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 03:46:38.109321: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 8/65
226/226 - 135s - loss: 0.0154 - accuracy: 0.9809 - val_loss: 0.2723 - val_accuracy: 0.9463
Confusion matrix: 
 [[567   6]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.659 0.341]]
Validation f1: 45.90
Validation accuracy: 94.63
Validation recall: 34.15
Validation precision: 70.00
Validation AUC: 0.4687899451125268
Validation class accuracies: [0.9895287958115183, 0.34146341463414637]
2021-06-29 03:48:20.458894: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3616
2021-06-29 03:48:30.560286: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3616
2021-06-29 03:48:40.541574: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 3616
2021-06-29 03:48:50.391461: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3616
2021-06-29 03:49:00.417388: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 03:49:10.364328: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3441 of 3616
2021-06-29 03:49:14.273830: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6567164179104478 hasn't increased by 0 in 1 epochs
Epoch 9/65
226/226 - 153s - loss: 0.0165 - accuracy: 0.9826 - val_loss: 0.1496 - val_accuracy: 0.9593
Confusion matrix: 
 [[563  10]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.366 0.634]]
Validation f1: 67.53
Validation accuracy: 95.93
Validation recall: 63.41
Validation precision: 72.22
Validation AUC: 0.7268775148702615
Validation class accuracies: [0.9825479930191972, 0.6341463414634146]
2021-06-29 03:51:02.477949: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 03:51:12.437666: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 03:51:22.485807: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 03:51:32.356001: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 03:51:42.363544: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 03:51:44.032516: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 10/65
226/226 - 135s - loss: 0.0141 - accuracy: 0.9801 - val_loss: 0.1599 - val_accuracy: 0.9625
Confusion matrix: 
 [[572   1]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.537 0.463]]
Validation f1: 62.30
Validation accuracy: 96.25
Validation recall: 46.34
Validation precision: 95.00
Validation AUC: 0.6730551072351073
Validation class accuracies: [0.9982547993019197, 0.4634146341463415]
2021-06-29 03:53:26.488627: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 03:53:36.606486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 03:53:46.572156: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 03:53:56.560421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 03:54:06.504357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 03:54:08.196111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 1 epochs
Epoch 11/65
226/226 - 135s - loss: 0.0161 - accuracy: 0.9812 - val_loss: 0.2939 - val_accuracy: 0.9479
Confusion matrix: 
 [[573   0]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.   0.  ]
 [0.78 0.22]]
Validation f1: 36.00
Validation accuracy: 94.79
Validation recall: 21.95
Validation precision: 100.00
Validation AUC: 0.6918180335361819
Validation class accuracies: [1.0, 0.21951219512195122]
2021-06-29 03:55:50.662705: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 03:56:00.683742: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 03:56:10.833853: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 03:56:20.744038: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 03:56:30.802253: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 03:56:32.541616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 2 epochs
Epoch 12/65
226/226 - 144s - loss: 0.0163 - accuracy: 0.9798 - val_loss: 0.2602 - val_accuracy: 0.9479
Confusion matrix: 
 [[573   0]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.   0.  ]
 [0.78 0.22]]
Validation f1: 36.00
Validation accuracy: 94.79
Validation recall: 21.95
Validation precision: 100.00
Validation AUC: 0.6965897444724555
Validation class accuracies: [1.0, 0.21951219512195122]
2021-06-29 03:58:32.675448: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 369 of 3616
2021-06-29 03:58:42.313106: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1041 of 3616
2021-06-29 03:58:52.334734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1777 of 3616
2021-06-29 03:59:02.411593: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2513 of 3616
2021-06-29 03:59:12.475066: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3217 of 3616
2021-06-29 03:59:19.062811: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 3 epochs
Epoch 13/65
226/226 - 141s - loss: 0.0186 - accuracy: 0.9817 - val_loss: 0.2347 - val_accuracy: 0.9577
Confusion matrix: 
 [[571   2]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.585 0.415]]
Validation f1: 56.67
Validation accuracy: 95.77
Validation recall: 41.46
Validation precision: 89.47
Validation AUC: 0.639158541978665
Validation class accuracies: [0.9965095986038395, 0.4146341463414634]
2021-06-29 04:01:01.756339: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:01:11.939628: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 04:01:21.804115: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 04:01:31.842478: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 04:01:41.859334: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 04:01:43.181848: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 4 epochs
Epoch 14/65
226/226 - 135s - loss: 0.0143 - accuracy: 0.9784 - val_loss: 0.2490 - val_accuracy: 0.9479
Confusion matrix: 
 [[572   1]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.756 0.244]]
Validation f1: 38.46
Validation accuracy: 94.79
Validation recall: 24.39
Validation precision: 90.91
Validation AUC: 0.6870971834383921
Validation class accuracies: [0.9982547993019197, 0.24390243902439024]
2021-06-29 04:03:25.661767: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:03:35.657594: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 04:03:45.709902: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:03:55.757618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 04:04:05.689964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 04:04:07.080449: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 5 epochs
Epoch 15/65
226/226 - 137s - loss: 0.0139 - accuracy: 0.9815 - val_loss: 0.5282 - val_accuracy: 0.9365
Confusion matrix: 
 [[573   0]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.951 0.049]]
Validation f1: 9.30
Validation accuracy: 93.65
Validation recall: 4.88
Validation precision: 100.00
Validation AUC: 0.5224725705041346
Validation class accuracies: [1.0, 0.04878048780487805]
2021-06-29 04:05:53.407961: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 593 of 3616
2021-06-29 04:06:03.450964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1185 of 3616
2021-06-29 04:06:13.273468: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 3616
2021-06-29 04:06:23.339578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 3616
2021-06-29 04:06:33.315756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2801 of 3616
2021-06-29 04:06:43.565104: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3201 of 3616
2021-06-29 04:06:53.329302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 3616
2021-06-29 04:06:57.579454: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
226/226 - 161s - loss: 0.0110 - accuracy: 0.9812 - val_loss: 0.1824 - val_accuracy: 0.9511
Confusion matrix: 
 [[556  17]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.317 0.683]]
Validation f1: 65.12
Validation accuracy: 95.11
Validation recall: 68.29
Validation precision: 62.22
Validation AUC: 0.6977637910936159
Validation class accuracies: [0.9703315881326352, 0.6829268292682927]
2021-06-29 04:08:43.246982: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:08:53.280462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 04:09:03.190750: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 04:09:13.347197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 04:09:23.346541: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 04:09:24.748208: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 7 epochs
Epoch 17/65
226/226 - 135s - loss: 0.0114 - accuracy: 0.9817 - val_loss: 0.1893 - val_accuracy: 0.9511
Confusion matrix: 
 [[565   8]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.537 0.463]]
Validation f1: 55.88
Validation accuracy: 95.11
Validation recall: 46.34
Validation precision: 70.37
Validation AUC: 0.6503198196741006
Validation class accuracies: [0.9860383944153578, 0.4634146341463415]
2021-06-29 04:11:07.392973: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:11:17.338364: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 04:11:27.260097: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:11:37.386382: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 04:11:47.417644: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 04:11:48.844698: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 8 epochs
Epoch 18/65
226/226 - 135s - loss: 0.0128 - accuracy: 0.9815 - val_loss: 0.2189 - val_accuracy: 0.9577
Confusion matrix: 
 [[571   2]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.585 0.415]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.67
Validation accuracy: 95.77
Validation recall: 41.46
Validation precision: 89.47
Validation AUC: 0.6796332036743254
Validation class accuracies: [0.9965095986038395, 0.4146341463414634]
2021-06-29 04:13:31.141840: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:13:41.105531: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 04:13:51.171650: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 04:14:01.065236: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2801 of 3616
2021-06-29 04:14:11.154547: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3329 of 3616
2021-06-29 04:14:18.286493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 9 epochs
Epoch 19/65
226/226 - 146s - loss: 0.0125 - accuracy: 0.9815 - val_loss: 0.1863 - val_accuracy: 0.9397
Confusion matrix: 
 [[550  23]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.341 0.659]]
Validation f1: 59.34
Validation accuracy: 93.97
Validation recall: 65.85
Validation precision: 54.00
Validation AUC: 0.6750590686756831
Validation class accuracies: [0.9598603839441536, 0.6585365853658537]
2021-06-29 04:16:06.197935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:16:16.140067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 04:16:26.088562: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 04:16:36.214109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 04:16:46.079773: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3525 of 3616
2021-06-29 04:16:47.402219: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 10 epochs
Epoch 20/65
226/226 - 135s - loss: 0.0144 - accuracy: 0.9787 - val_loss: 0.1769 - val_accuracy: 0.9544
Confusion matrix: 
 [[565   8]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.488 0.512]]
Validation f1: 60.00
Validation accuracy: 95.44
Validation recall: 51.22
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation precision: 72.41
Validation AUC: 0.6818320464080291
Validation class accuracies: [0.9860383944153578, 0.5121951219512195]
2021-06-29 04:18:29.856607: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:18:39.970866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 04:18:49.927567: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:18:59.846991: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 04:19:10.016841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 04:19:11.449958: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 11 epochs
Epoch 21/65
226/226 - 136s - loss: 0.0116 - accuracy: 0.9806 - val_loss: 0.2075 - val_accuracy: 0.9430
Confusion matrix: 
 [[556  17]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.79
Validation accuracy: 94.30
Validation recall: 56.10
Validation precision: 57.50
Validation AUC: 0.6387414622503664
Validation class accuracies: [0.9703315881326352, 0.5609756097560976]
2021-06-29 04:20:54.207611: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:21:04.309518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 04:21:14.273962: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 04:21:24.291906: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 04:21:34.353293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3537 of 3616
2021-06-29 04:21:35.469041: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
226/226 - 137s - loss: 0.0126 - accuracy: 0.9806 - val_loss: 0.2074 - val_accuracy: 0.9544
Confusion matrix: 
 [[567   6]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.537 0.463]]
Validation f1: 57.58
Validation accuracy: 95.44
Validation recall: 46.34
Validation precision: 76.00
Validation AUC: 0.6335988759496355
Validation class accuracies: [0.9895287958115183, 0.4634146341463415]
2021-06-29 04:23:22.676639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-29 04:23:32.898395: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 3616
2021-06-29 04:23:42.923135: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3616
2021-06-29 04:23:52.901879: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1777 of 3616
2021-06-29 04:24:02.830274: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:24:12.889305: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2545 of 3616
2021-06-29 04:24:22.867910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3217 of 3616
2021-06-29 04:24:29.555373: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 13 epochs
Epoch 23/65
226/226 - 160s - loss: 0.0109 - accuracy: 0.9812 - val_loss: 0.1669 - val_accuracy: 0.9560
Confusion matrix: 
 [[565   8]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.463 0.537]]
Validation f1: 61.97
Validation accuracy: 95.60
Validation recall: 53.66
Validation precision: 73.33
Validation AUC: 0.6926763514167182
Validation class accuracies: [0.9860383944153578, 0.5365853658536586]
2021-06-29 04:26:11.517239: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:26:21.476788: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 04:26:31.434916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 04:26:41.600623: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 04:26:51.603655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3537 of 3616
2021-06-29 04:26:52.674654: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 14 epochs
Epoch 24/65
226/226 - 135s - loss: 0.0110 - accuracy: 0.9840 - val_loss: 0.2032 - val_accuracy: 0.9528
Confusion matrix: 
 [[566   7]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.537 0.463]]
Validation f1: 56.72
Validation accuracy: 95.28
Validation recall: 46.34
Validation precision: 73.08
Validation AUC: 0.6474927519147746
Validation class accuracies: [0.987783595113438, 0.4634146341463415]
2021-06-29 04:28:35.070763: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:28:44.953475: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 04:28:55.052655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:29:04.910326: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 04:29:15.079433: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 04:29:16.751868: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 15 epochs
Epoch 25/65
226/226 - 136s - loss: 0.0114 - accuracy: 0.9782 - val_loss: 0.1938 - val_accuracy: 0.9544
Confusion matrix: 
 [[568   5]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.561 0.439]]
Validation f1: 56.25
Validation accuracy: 95.44
Validation recall: 43.90
Validation precision: 78.26
Validation AUC: 0.6653880672440812
Validation class accuracies: [0.9912739965095986, 0.43902439024390244]
2021-06-29 04:30:59.646510: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3616
2021-06-29 04:31:09.702283: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 3616
2021-06-29 04:31:19.740976: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 3616
2021-06-29 04:31:29.686730: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 3616
2021-06-29 04:31:39.768724: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3041 of 3616
2021-06-29 04:31:49.622467: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 3616
2021-06-29 04:31:52.831699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 16 epochs
Epoch 26/65
226/226 - 153s - loss: 0.0109 - accuracy: 0.9793 - val_loss: 0.1710 - val_accuracy: 0.9560
Confusion matrix: 
 [[567   6]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.512 0.488]]
Validation f1: 59.70
Validation accuracy: 95.60
Validation recall: 48.78
Validation precision: 76.92
Validation AUC: 0.6686514229885852
Validation class accuracies: [0.9895287958115183, 0.4878048780487805]
2021-06-29 04:33:41.122963: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:33:51.156712: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 04:34:01.103969: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:34:11.281979: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 04:34:21.231869: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 04:34:22.918145: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 17 epochs
Epoch 27/65
226/226 - 135s - loss: 0.0097 - accuracy: 0.9834 - val_loss: 0.1867 - val_accuracy: 0.9544
Confusion matrix: 
 [[568   5]
 [ 23  18]]
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.561 0.439]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.25
Validation accuracy: 95.44
Validation recall: 43.90
Validation precision: 78.26
Validation AUC: 0.6636030815684448
Validation class accuracies: [0.9912739965095986, 0.43902439024390244]
2021-06-29 04:36:05.822625: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:36:15.783281: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 04:36:25.670213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:36:35.797518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 04:36:45.676799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 04:36:47.336203: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
226/226 - 136s - loss: 0.0117 - accuracy: 0.9776 - val_loss: 0.2022 - val_accuracy: 0.9544
Confusion matrix: 
 [[569   4]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.585 0.415]]
Validation f1: 54.84
Validation accuracy: 95.44
Validation recall: 41.46
Validation precision: 80.95
Validation AUC: 0.6547571993145306
Validation class accuracies: [0.9930191972076788, 0.4146341463414634]
2021-06-29 04:38:29.964523: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:38:40.174779: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 04:38:50.191829: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:38:59.983204: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 04:39:10.213132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 04:39:11.583924: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 19 epochs
Epoch 29/65
226/226 - 144s - loss: 0.0109 - accuracy: 0.9826 - val_loss: 0.2207 - val_accuracy: 0.9577
Confusion matrix: 
 [[571   2]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.585 0.415]]
Validation f1: 56.67
Validation accuracy: 95.77
Validation recall: 41.46
Validation precision: 89.47
Validation AUC: 0.6583212136550666
Validation class accuracies: [0.9965095986038395, 0.4146341463414634]

The metrics for job 0 with the best target metric are: 
Best cm: [[563  10]
 [ 15  26]]
Best normalized cm: [[0.983 0.017]
 [0.366 0.634]]
Best f1: 0.68
Best accuracy: 0.96
Best recall: 0.63
Best precision: 0.72
Best AUC: 0.73
Best class accuracies: [0.9825479930191972, 0.6341463414634146]
Best epoch: 9
The number of epochs since last 1% equals the patience
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[6.547e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.048]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.793e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[3.086e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[2.736e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.145e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[8.71e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.059]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.52e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.818e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[3.407e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[1.14e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.058e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[2.462e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[4.029e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.567e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[9.691e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[3.651e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[7.886e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[1.397e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.366e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[1.888e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.048]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.02]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 12803
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_032710-2rxk0u7o/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_032710-2rxk0u7o/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98258
wandb:         val_accuracy 0.95765
wandb:             _runtime 4430
wandb:           _timestamp 1624941660
wandb:                _step 220
wandb:           train_loss 0.01088
wandb:             val_loss 0.22068
wandb:           val_recall 0.41463
wandb:        val_precision 0.89474
wandb:               val_f1 0.56667
wandb:              val_auc 0.65832
wandb:                   lr 0.00013
wandb:          best_val_f1 0.67532
wandb:    best_val_accuracy 0.95928
wandb:   best_val_precision 0.72222
wandb:      best_val_recall 0.63415
wandb:             best_auc 0.72688
wandb:           best_epoch 9
wandb: Run history:
wandb:   train_accuracy ▁▄▆▇▇████████████████████████
wandb:     val_accuracy ▅▅▆▆▁▆█▆██▇▇█▇▆▇▇█▆▇▆▇▇▇▇▇▇▇█
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▃▂▃▅▂▂▃▁▁▄▃▃▃█▂▂▂▂▂▂▂▁▂▂▁▂▂▂
wandb:       val_recall ▁▁▂▂▇▆▇▅▇▆▃▃▅▄▁█▆▅█▆▇▆▇▆▅▆▅▅▅
wandb:    val_precision ▁▁██▃▅▇▆▆███▇▇█▅▆▇▅▆▅▆▆▆▆▆▆▇▇
wandb:           val_f1 ▁▁▂▄▅▇█▆█▇▅▅▇▅▂█▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▂▆▇▆▇▇▅█▇██▇█▆█▇▇▇█▇▇█▇▇▇▇▇▇
wandb:               lr ███████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_032710-2rxk0u7o

-----------------------
Changing augmentation to v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 04:42:47.125993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:42:57.138513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 04:43:07.258231: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 3616
2021-06-29 04:43:17.103201: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 04:43:27.277636: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3537 of 3616
2021-06-29 04:43:28.398971: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3216
-----------------------
Number of train recordings: 3216 with pneumonia: 316 and non-pneumonia: 2900
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3616
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_5 (MixDepthGroupCo (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_6 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_7 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_8 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_9 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
226/226 - 135s - loss: 0.2691 - accuracy: 0.8982 - val_loss: 0.2510 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06083285936127032
Validation class accuracies: [1.0, 0.0]
2021-06-29 04:45:11.195428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:45:21.217266: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 04:45:31.312578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 04:45:41.309285: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 04:45:51.324798: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 04:45:53.003002: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
226/226 - 136s - loss: 0.1023 - accuracy: 0.9535 - val_loss: 0.2328 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6377263519442125
Validation class accuracies: [1.0, 0.0]
2021-06-29 04:47:36.391565: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:47:46.393570: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 04:47:56.351311: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 3616
2021-06-29 04:48:06.487711: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2689 of 3616
2021-06-29 04:48:16.315284: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3218 of 3616
2021-06-29 04:48:25.413746: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
226/226 - 149s - loss: 0.0681 - accuracy: 0.9624 - val_loss: 0.1793 - val_accuracy: 0.9479
Confusion matrix: 
 [[561  12]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.488 0.512]]
Validation f1: 56.76
Validation accuracy: 94.79
Validation recall: 51.22
Validation precision: 63.64
Validation AUC: 0.5829623971711675
Validation class accuracies: [0.9790575916230366, 0.5121951219512195]
2021-06-29 04:50:14.281416: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 04:50:24.148114: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 04:50:34.330635: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 3616
2021-06-29 04:50:44.293473: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 04:50:54.235812: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 04:50:55.649554: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
226/226 - 136s - loss: 0.0390 - accuracy: 0.9726 - val_loss: 0.2532 - val_accuracy: 0.9365
Confusion matrix: 
 [[551  22]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.415 0.585]]
Validation f1: 55.17
Validation accuracy: 93.65
Validation recall: 58.54
Validation precision: 52.17
Validation AUC: 0.6087796403321786
Validation class accuracies: [0.9616055846422339, 0.5853658536585366]
2021-06-29 04:52:39.061646: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:52:49.095424: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 04:52:59.228652: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 04:53:09.212743: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 04:53:19.067672: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3516 of 3616
2021-06-29 04:53:20.718708: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5675675675675675 hasn't increased by 0 in 1 epochs
Epoch 5/65
226/226 - 135s - loss: 0.0285 - accuracy: 0.9773 - val_loss: 0.3006 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
Validation f1: 56.84
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.6179514697129976
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
2021-06-29 04:55:03.940299: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 04:55:13.785926: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 04:55:23.781493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 04:55:33.849983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 04:55:43.880978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 04:55:45.611811: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
226/226 - 138s - loss: 0.0232 - accuracy: 0.9773 - val_loss: 0.2492 - val_accuracy: 0.9544
Confusion matrix: 
 [[557  16]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.293 0.707]]
Validation f1: 67.44
Validation accuracy: 95.44
Validation recall: 70.73
Validation precision: 64.44
Validation AUC: 0.651717221615668
Validation class accuracies: [0.9720767888307156, 0.7073170731707317]
2021-06-29 04:57:35.053587: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 369 of 3616
2021-06-29 04:57:44.989911: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 3616
2021-06-29 04:57:54.686148: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 3616
2021-06-29 04:58:04.710486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3616
2021-06-29 04:58:14.848869: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 3616
2021-06-29 04:58:24.771882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2785 of 3616
2021-06-29 04:58:34.779318: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3425 of 3616
2021-06-29 04:58:37.991016: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 7/65
226/226 - 157s - loss: 0.0231 - accuracy: 0.9751 - val_loss: 0.2346 - val_accuracy: 0.9511
Confusion matrix: 
 [[563  10]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.488 0.512]]
Validation f1: 58.33
Validation accuracy: 95.11
Validation recall: 51.22
Validation precision: 67.74
Validation AUC: 0.6356799461916541
Validation class accuracies: [0.9825479930191972, 0.5121951219512195]
2021-06-29 05:00:21.108197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:00:30.998416: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:00:41.127993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 05:00:51.099061: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 05:01:01.187267: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 05:01:02.973152: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 1 epochs
Epoch 8/65
226/226 - 136s - loss: 0.0168 - accuracy: 0.9804 - val_loss: 0.2693 - val_accuracy: 0.9560
Confusion matrix: 
 [[567   6]
 [ 21  20]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.512 0.488]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.70
Validation accuracy: 95.60
Validation recall: 48.78
Validation precision: 76.92
Validation AUC: 0.6617283603278613
Validation class accuracies: [0.9895287958115183, 0.4878048780487805]
2021-06-29 05:02:45.605507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 05:02:55.529890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 05:03:05.460435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 05:03:15.550146: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 05:03:25.519236: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 05:03:27.275476: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 2 epochs
Epoch 9/65
226/226 - 136s - loss: 0.0153 - accuracy: 0.9829 - val_loss: 0.2057 - val_accuracy: 0.9577
Confusion matrix: 
 [[564   9]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.415 0.585]]
Validation f1: 64.86
Validation accuracy: 95.77
Validation recall: 58.54
Validation precision: 72.73
Validation AUC: 0.6608791709187369
Validation class accuracies: [0.9842931937172775, 0.5853658536585366]
2021-06-29 05:05:12.702861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 593 of 3616
2021-06-29 05:05:22.601210: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1201 of 3616
2021-06-29 05:05:32.471522: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1777 of 3616
2021-06-29 05:05:42.704181: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2369 of 3616
2021-06-29 05:05:52.703494: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 05:06:02.476115: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3421 of 3616
2021-06-29 05:06:07.786116: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 3 epochs
Epoch 10/65
226/226 - 154s - loss: 0.0152 - accuracy: 0.9770 - val_loss: 0.2546 - val_accuracy: 0.9479
Confusion matrix: 
 [[558  15]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.415 0.585]]
Validation f1: 60.00
Validation accuracy: 94.79
Validation recall: 58.54
Validation precision: 61.54
Validation AUC: 0.6336095644797773
Validation class accuracies: [0.9738219895287958, 0.5853658536585366]
2021-06-29 05:07:55.762660: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:08:05.958797: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 05:08:15.905656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 05:08:25.752672: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2884 of 3616
2021-06-29 05:08:35.900718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 05:08:37.519471: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 4 epochs
Epoch 11/65
226/226 - 136s - loss: 0.0141 - accuracy: 0.9845 - val_loss: 0.2259 - val_accuracy: 0.9544
Confusion matrix: 
 [[559  14]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.341 0.659]]
Validation f1: 65.85
Validation accuracy: 95.44
Validation recall: 65.85
Validation precision: 65.85
Validation AUC: 0.6762190019157612
Validation class accuracies: [0.9755671902268761, 0.6585365853658537]
2021-06-29 05:10:20.227845: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:10:30.302167: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:10:40.183040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 05:10:50.316305: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 05:11:00.369972: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 05:11:02.086691: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 5 epochs
Epoch 12/65
226/226 - 136s - loss: 0.0130 - accuracy: 0.9804 - val_loss: 0.2491 - val_accuracy: 0.9577
Confusion matrix: 
 [[564   9]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.86
Validation accuracy: 95.77
Validation recall: 58.54
Validation precision: 72.73
Validation AUC: 0.6511767137816269
Validation class accuracies: [0.9842931937172775, 0.5853658536585366]
2021-06-29 05:12:44.843114: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 05:12:54.675875: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:13:04.660930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 05:13:14.689302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 05:13:24.990827: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 05:13:27.444774: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
226/226 - 147s - loss: 0.0124 - accuracy: 0.9815 - val_loss: 0.2158 - val_accuracy: 0.9609
Confusion matrix: 
 [[566   7]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.415 0.585]]
Validation f1: 66.67
Validation accuracy: 96.09
Validation recall: 58.54
Validation precision: 77.42
Validation AUC: 0.6849206631381095
Validation class accuracies: [0.987783595113438, 0.5853658536585366]
2021-06-29 05:15:23.797302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 05:15:33.718906: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:15:43.677572: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 05:15:53.716126: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 3616
2021-06-29 05:16:03.770789: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 3616
2021-06-29 05:16:05.747173: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 7 epochs
Epoch 14/65
226/226 - 136s - loss: 0.0098 - accuracy: 0.9790 - val_loss: 0.2477 - val_accuracy: 0.9593
Confusion matrix: 
 [[565   8]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.415 0.585]]
Validation f1: 65.75
Validation accuracy: 95.93
Validation recall: 58.54
Validation precision: 75.00
Validation AUC: 0.6529663289131282
Validation class accuracies: [0.9860383944153578, 0.5853658536585366]
2021-06-29 05:17:48.897166: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:17:58.782291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:18:08.816377: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 05:18:18.879586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 05:18:28.848158: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 05:18:30.278632: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 8 epochs
Epoch 15/65
226/226 - 136s - loss: 0.0116 - accuracy: 0.9809 - val_loss: 0.2331 - val_accuracy: 0.9577
Confusion matrix: 
 [[565   8]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.439 0.561]]
Validation f1: 63.89
Validation accuracy: 95.77
Validation recall: 56.10
Validation precision: 74.19
Validation AUC: 0.6927932292432311
Validation class accuracies: [0.9860383944153578, 0.5609756097560976]
2021-06-29 05:20:13.822111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 05:20:23.769389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 05:20:33.817131: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 05:20:43.848248: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 05:20:53.848929: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 05:20:55.216387: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 9 epochs
Epoch 16/65
226/226 - 137s - loss: 0.0120 - accuracy: 0.9817 - val_loss: 0.2146 - val_accuracy: 0.9560
Confusion matrix: 
 [[564   9]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.439 0.561]]
Validation f1: 63.01
Validation accuracy: 95.60
Validation recall: 56.10
Validation precision: 71.88
Validation AUC: 0.6860125050881228
Validation class accuracies: [0.9842931937172775, 0.5609756097560976]
2021-06-29 05:22:42.499833: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-29 05:22:52.530989: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 3616
2021-06-29 05:23:02.411269: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 3616
2021-06-29 05:23:12.464217: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 3616
2021-06-29 05:23:22.517601: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2481 of 3616
2021-06-29 05:23:32.556874: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 3616
2021-06-29 05:23:42.850118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3217 of 3616
2021-06-29 05:23:52.523602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 05:23:53.926431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 10 epochs
Epoch 17/65
226/226 - 166s - loss: 0.0149 - accuracy: 0.9746 - val_loss: 0.2252 - val_accuracy: 0.9560
Confusion matrix: 
 [[563  10]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.415 0.585]]
Validation f1: 64.00
Validation accuracy: 95.60
Validation recall: 58.54
Validation precision: 70.59
Validation AUC: 0.6663154810645678
Validation class accuracies: [0.9825479930191972, 0.5853658536585366]
2021-06-29 05:25:37.109961: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 05:25:47.258388: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 05:25:57.267969: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 3616
2021-06-29 05:26:07.082707: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 05:26:17.224349: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3537 of 3616
2021-06-29 05:26:18.388558: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 11 epochs
Epoch 18/65
226/226 - 135s - loss: 0.0105 - accuracy: 0.9826 - val_loss: 0.2228 - val_accuracy: 0.9495
Confusion matrix: 
 [[555  18]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.317 0.683]]
Validation f1: 64.37
Validation accuracy: 94.95
Validation recall: 68.29
Validation precision: 60.87
Validation AUC: 0.6885722081535003
Validation class accuracies: [0.9685863874345549, 0.6829268292682927]
2021-06-29 05:28:01.349694: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 05:28:11.284781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 05:28:21.210820: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 05:28:31.345776: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-29 05:28:41.236429: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 05:28:42.677493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6744186046511628 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 19/65
226/226 - 135s - loss: 0.0073 - accuracy: 0.9842 - val_loss: 0.2126 - val_accuracy: 0.9625
Confusion matrix: 
 [[566   7]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.39  0.61 ]]
Validation f1: 68.49
Validation accuracy: 96.25
Validation recall: 60.98
Validation precision: 78.12
Validation AUC: 0.6942658964643916
Validation class accuracies: [0.987783595113438, 0.6097560975609756]
2021-06-29 05:30:25.469425: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 05:30:35.416206: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:30:45.456012: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3616
2021-06-29 05:30:55.361431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2593 of 3616
2021-06-29 05:31:05.396370: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3201 of 3616
2021-06-29 05:31:15.327019: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 05:31:15.766978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 20/65
226/226 - 150s - loss: 0.0107 - accuracy: 0.9790 - val_loss: 0.2082 - val_accuracy: 0.9625
Confusion matrix: 
 [[566   7]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 68.49
Validation accuracy: 96.25
Validation recall: 60.98
Validation precision: 78.12
Validation AUC: 0.6870903412460022
Validation class accuracies: [0.987783595113438, 0.6097560975609756]
2021-06-29 05:33:03.865939: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 05:33:13.840073: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 05:33:23.954357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 05:33:33.861042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 05:33:43.924389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 05:33:45.562125: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 1 epochs
Epoch 21/65
226/226 - 136s - loss: 0.0112 - accuracy: 0.9815 - val_loss: 0.2129 - val_accuracy: 0.9609
Confusion matrix: 
 [[564   9]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.366 0.634]]
Validation f1: 68.42
Validation accuracy: 96.09
Validation recall: 63.41
Validation precision: 74.29
Validation AUC: 0.6765821742030736
Validation class accuracies: [0.9842931937172775, 0.6341463414634146]
2021-06-29 05:35:28.416793: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:35:38.401013: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:35:48.338964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 05:35:58.331658: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 3616
2021-06-29 05:36:08.273687: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 3616
2021-06-29 05:36:10.181903: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 2 epochs
Epoch 22/65
226/226 - 136s - loss: 0.0106 - accuracy: 0.9823 - val_loss: 0.2190 - val_accuracy: 0.9593
Confusion matrix: 
 [[566   7]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.439 0.561]]
Validation f1: 64.79
Validation accuracy: 95.93
Validation recall: 56.10
Validation precision: 76.67
Validation AUC: 0.6802991436791135
Validation class accuracies: [0.987783595113438, 0.5609756097560976]
2021-06-29 05:37:53.290557: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:38:03.293121: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:38:13.283792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 05:38:23.310189: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 3616
2021-06-29 05:38:33.343226: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 3616
2021-06-29 05:38:35.271893: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 3 epochs
Epoch 23/65
226/226 - 138s - loss: 0.0103 - accuracy: 0.9820 - val_loss: 0.2089 - val_accuracy: 0.9609
Confusion matrix: 
 [[565   8]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.39  0.61 ]]
Validation f1: 67.57
Validation accuracy: 96.09
Validation recall: 60.98
Validation precision: 75.76
Validation AUC: 0.6820445925902872
Validation class accuracies: [0.9860383944153578, 0.6097560975609756]
2021-06-29 05:40:28.158870: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 385 of 3616
2021-06-29 05:40:37.841450: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 3616
2021-06-29 05:40:48.152944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3616
2021-06-29 05:40:57.979365: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 3616
2021-06-29 05:41:07.894595: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 3616
2021-06-29 05:41:17.852001: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3137 of 3616
2021-06-29 05:41:26.137489: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 4 epochs
Epoch 24/65
226/226 - 153s - loss: 0.0146 - accuracy: 0.9779 - val_loss: 0.1961 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6841571200926173
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 05:43:09.585980: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:43:19.562488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 05:43:29.699849: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-29 05:43:39.655819: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 05:43:49.681249: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 3616
2021-06-29 05:43:51.058918: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 5 epochs
Epoch 25/65
226/226 - 135s - loss: 0.0118 - accuracy: 0.9784 - val_loss: 0.2083 - val_accuracy: 0.9609
Confusion matrix: 
 [[565   8]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 67.57
Validation accuracy: 96.09
Validation recall: 60.98
Validation precision: 75.76
Validation AUC: 0.6868345067618411
Validation class accuracies: [0.9860383944153578, 0.6097560975609756]
2021-06-29 05:45:33.608932: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:45:43.693765: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-29 05:45:53.598440: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3616
2021-06-29 05:46:03.753595: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3616
2021-06-29 05:46:13.615989: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 05:46:15.307566: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 26/65
226/226 - 137s - loss: 0.0080 - accuracy: 0.9848 - val_loss: 0.2082 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6831996516965799
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 05:48:01.774265: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-29 05:48:11.876569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1185 of 3616
2021-06-29 05:48:21.690691: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 3616
2021-06-29 05:48:31.773138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 3616
2021-06-29 05:48:41.764341: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 3616
2021-06-29 05:48:51.705114: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3329 of 3616
2021-06-29 05:49:00.813705: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 7 epochs
Epoch 27/65
226/226 - 157s - loss: 0.0108 - accuracy: 0.9815 - val_loss: 0.2110 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6861897546637274
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 05:50:48.138264: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 05:50:58.182442: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 05:51:08.042120: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 05:51:18.205725: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3616
2021-06-29 05:51:28.159430: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3616
2021-06-29 05:51:29.775829: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 8 epochs
Epoch 28/65
226/226 - 136s - loss: 0.0093 - accuracy: 0.9806 - val_loss: 0.2061 - val_accuracy: 0.9609
Confusion matrix: 
 [[564   9]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 68.42
Validation accuracy: 96.09
Validation recall: 63.41
Validation precision: 74.29
Validation AUC: 0.6844141687590134
Validation class accuracies: [0.9842931937172775, 0.6341463414634146]
2021-06-29 05:53:14.035283: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3616
2021-06-29 05:53:24.091103: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 3616
2021-06-29 05:53:34.141085: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 3616
2021-06-29 05:53:44.156690: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2593 of 3616
2021-06-29 05:53:54.194774: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3233 of 3616
2021-06-29 05:54:01.271521: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 9 epochs
Epoch 29/65
226/226 - 143s - loss: 0.0116 - accuracy: 0.9809 - val_loss: 0.2112 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6816840274242052
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 05:55:46.506099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3616
2021-06-29 05:55:56.619733: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3616
2021-06-29 05:56:06.705814: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 3616
2021-06-29 05:56:16.511661: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2545 of 3616
2021-06-29 05:56:26.460117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3073 of 3616
2021-06-29 05:56:36.662663: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 05:56:40.177645: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 10 epochs
Epoch 30/65
226/226 - 156s - loss: 0.0109 - accuracy: 0.9823 - val_loss: 0.2015 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6938383477056895
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 05:58:31.822698: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3616
2021-06-29 05:58:41.815931: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 3616
2021-06-29 05:58:51.866961: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 3616
2021-06-29 05:59:01.769937: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2721 of 3616
2021-06-29 05:59:11.968430: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3329 of 3616
2021-06-29 05:59:17.279386: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 11 epochs
Epoch 31/65
226/226 - 141s - loss: 0.0111 - accuracy: 0.9829 - val_loss: 0.2108 - val_accuracy: 0.9577
Confusion matrix: 
 [[564   9]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.415 0.585]]
Validation f1: 64.86
Validation accuracy: 95.77
Validation recall: 58.54
Validation precision: 72.73
Validation AUC: 0.6873882851997551
Validation class accuracies: [0.9842931937172775, 0.5853658536585366]
2021-06-29 06:01:02.882413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3616
2021-06-29 06:01:12.802699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3616
2021-06-29 06:01:22.851876: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3616
2021-06-29 06:01:32.751094: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2609 of 3616
2021-06-29 06:01:42.902543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3233 of 3616
2021-06-29 06:01:49.931689: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 32/65
226/226 - 142s - loss: 0.0091 - accuracy: 0.9820 - val_loss: 0.2099 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6836070619770995
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 06:03:35.527477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3616
2021-06-29 06:03:45.430854: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3616
2021-06-29 06:03:55.403261: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3616
2021-06-29 06:04:05.419846: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2609 of 3616
2021-06-29 06:04:15.400306: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3249 of 3616
2021-06-29 06:04:22.035132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 13 epochs
Epoch 33/65
226/226 - 147s - loss: 0.0104 - accuracy: 0.9801 - val_loss: 0.2150 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6787252556514036
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 06:06:20.329601: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 353 of 3616
2021-06-29 06:06:30.447213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 06:06:40.191445: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 3616
2021-06-29 06:06:50.288530: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3616
2021-06-29 06:07:00.191444: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2641 of 3616
2021-06-29 06:07:10.464781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3297 of 3616
2021-06-29 06:07:16.079995: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 14 epochs
Epoch 34/65
226/226 - 151s - loss: 0.0139 - accuracy: 0.9743 - val_loss: 0.2126 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
Validation f1: 66.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.68253090766755
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 06:09:00.905264: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3616
2021-06-29 06:09:11.054691: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 3616
2021-06-29 06:09:20.909526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 3616
2021-06-29 06:09:30.989291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2705 of 3616
2021-06-29 06:09:40.952149: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3329 of 3616
2021-06-29 06:09:46.010118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 15 epochs
Epoch 35/65
226/226 - 140s - loss: 0.0077 - accuracy: 0.9831 - val_loss: 0.2123 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6830521777466358
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 06:11:30.083342: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3616
2021-06-29 06:11:40.085254: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 3616
2021-06-29 06:11:50.124589: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 3616
2021-06-29 06:12:00.125425: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2753 of 3616
2021-06-29 06:12:10.120064: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3361 of 3616
2021-06-29 06:12:14.475423: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 16 epochs
Epoch 36/65
226/226 - 142s - loss: 0.0108 - accuracy: 0.9826 - val_loss: 0.2125 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6819019164629657
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 06:14:03.457802: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 3616
2021-06-29 06:14:13.388611: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 3616
2021-06-29 06:14:23.522005: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 3616
2021-06-29 06:14:33.605443: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 06:14:43.537485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2497 of 3616
2021-06-29 06:14:53.429531: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2849 of 3616
2021-06-29 06:15:03.455352: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3201 of 3616
2021-06-29 06:15:13.431284: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 06:15:18.655350: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 17 epochs
Epoch 37/65
226/226 - 171s - loss: 0.0094 - accuracy: 0.9820 - val_loss: 0.2128 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.681179843463094
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 06:17:04.341151: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3616
2021-06-29 06:17:14.236980: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3616
2021-06-29 06:17:24.357187: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3616
2021-06-29 06:17:34.341908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2673 of 3616
2021-06-29 06:17:44.252742: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3291 of 3616
2021-06-29 06:17:50.315557: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 38/65
226/226 - 141s - loss: 0.0116 - accuracy: 0.9793 - val_loss: 0.2115 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.684683635111175
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 06:19:35.485777: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3616
2021-06-29 06:19:45.674940: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 3616
2021-06-29 06:19:55.691550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 3616
2021-06-29 06:20:05.559535: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2673 of 3616
2021-06-29 06:20:15.667197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3297 of 3616
2021-06-29 06:20:21.512750: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.684931506849315 hasn't increased by 0 in 19 epochs
Epoch 39/65
226/226 - 142s - loss: 0.0092 - accuracy: 0.9815 - val_loss: 0.2095 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.6873989713504387
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]

The metrics for job 1 with the best target metric are: 
Best cm: [[566   7]
 [ 16  25]]
Best normalized cm: [[0.988 0.012]
 [0.39  0.61 ]]
Best f1: 0.68
Best accuracy: 0.96
Best recall: 0.61
Best precision: 0.78
Best AUC: 0.69
Best class accuracies: [0.987783595113438, 0.6097560975609756]
Best epoch: 19
The number of epochs since last 1% equals the patience
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_207_2b4_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_218_1b1_Pl_sc_Meditron_7_label_0_pred_0.png, [[1.157e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_218_1b1_Pl_sc_Meditron_6_label_0_pred_0.png, [[3.993e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_222_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[1.151e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_222_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_203_2p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[1.087e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_226_1b1_Al_sc_Meditron_1_label_1_pred_0.png, [[5.679e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_213_1p5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_211_1p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[9.245e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png, [[0.932]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_205_4b2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_203_2p3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_222_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[6.204e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_204_2b5_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_205_3b4_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[8.788e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[3.601e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_207_2b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[1.989e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[1.642e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[7.443e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_213_1p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[3.926e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_221_2b2_Pl_mc_LittC2SE_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_221_2b1_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[8.39e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_218_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[3.19e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_218_1p1_Ar_sc_Litt3200_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_211_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[3.245e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_213_1p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[9.417e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_223_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_207_2b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.222e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_3_label_1_pred_1.png, [[0.61]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_219_2b2_Ar_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_204_7p5_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[1.962e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[4.336e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_203_2p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[8.419e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_222_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[4.843e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_221_2b3_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_207_2b4_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.15e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/jordan_EP36_pneumonia,Crep,P R M,36,F_5_label_1_pred_0.png, [[0.087]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_205_2b3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/1/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[1.737e-06]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 23305
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_044138-f308bh1z/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_044138-f308bh1z/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98147
wandb:         val_accuracy 0.95928
wandb:             _runtime 6017
wandb:           _timestamp 1624947716
wandb:                _step 284
wandb:           train_loss 0.00924
wandb:             val_loss 0.20946
wandb:           val_recall 0.60976
wandb:        val_precision 0.73529
wandb:               val_f1 0.66667
wandb:              val_auc 0.6874
wandb:                   lr 3e-05
wandb:          best_val_f1 0.68493
wandb:    best_val_accuracy 0.96254
wandb:   best_val_precision 0.78125
wandb:      best_val_recall 0.60976
wandb:             best_auc 0.69427
wandb:           best_epoch 19
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇▇▇▇██▇██████▇██████▇▇████████▇█████
wandb:     val_accuracy ▁▁▄▂▁▆▅▆▇▄▆▇█▇▇▆▆▅███▇█▇█▇▇█▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▅▄▁▅█▅▄▆▃▅▄▅▃▅▄▃▄▄▃▃▃▃▃▂▃▃▃▃▃▂▃▃▃▃▃▃▃▃▃
wandb:       val_recall ▁▁▆▇██▆▆▇▇█▇▇▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:    val_precision ▁▁▇▆▅▇▇██▇▇████▇▇▆█████████████████████
wandb:           val_f1 ▁▁▇▇▇█▇▇█▇█████▇███████████████████████
wandb:          val_auc ▁▇▇▇▇█▇██▇█████████████████████████████
wandb:               lr ████████████▄▄▄▄▄▄▃▃▃▃▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_044138-f308bh1z

-----------------------
Changing augmentation to v48
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v48'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 06:24:27.435987: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3616
2021-06-29 06:24:37.466509: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 3616
2021-06-29 06:24:47.446712: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 3616
2021-06-29 06:24:57.407637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2737 of 3616
2021-06-29 06:25:07.552390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3361 of 3616
2021-06-29 06:25:12.201064: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3216
-----------------------
Number of train recordings: 3216 with pneumonia: 316 and non-pneumonia: 2900
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3616
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_3 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_10 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_11 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_12 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_13 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_14 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
226/226 - 140s - loss: 0.3120 - accuracy: 0.8800 - val_loss: 0.2500 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08878779528783001
Validation class accuracies: [1.0, 0.0]
2021-06-29 06:26:56.604466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3616
2021-06-29 06:27:06.675234: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 06:27:16.595792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3616
2021-06-29 06:27:26.669436: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2849 of 3616
2021-06-29 06:27:36.578656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 06:27:39.262998: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
226/226 - 137s - loss: 0.1445 - accuracy: 0.9328 - val_loss: 0.2496 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07058437736465731
Validation class accuracies: [1.0, 0.0]
2021-06-29 06:29:22.844143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 06:29:32.705339: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 06:29:42.878683: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3616
2021-06-29 06:29:52.880092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 3616
2021-06-29 06:30:02.691844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3441 of 3616
2021-06-29 06:30:05.449178: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
226/226 - 139s - loss: 0.0970 - accuracy: 0.9499 - val_loss: 0.2056 - val_accuracy: 0.9397
Confusion matrix: 
 [[573   0]
 [ 37   4]]
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.902 0.098]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.78
Validation accuracy: 93.97
Validation recall: 9.76
Validation precision: 100.00
Validation AUC: 0.6062518618328672
Validation class accuracies: [1.0, 0.0975609756097561]
2021-06-29 06:31:53.061042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3616
2021-06-29 06:32:03.138440: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3616
2021-06-29 06:32:13.086754: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 3616
2021-06-29 06:32:23.232633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3616
2021-06-29 06:32:33.083344: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2305 of 3616
2021-06-29 06:32:43.169887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2673 of 3616
2021-06-29 06:32:53.323389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3041 of 3616
2021-06-29 06:33:03.147438: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3537 of 3616
2021-06-29 06:33:04.317142: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
226/226 - 165s - loss: 0.0535 - accuracy: 0.9704 - val_loss: 0.1749 - val_accuracy: 0.9674
Confusion matrix: 
 [[572   1]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.463 0.537]]
Validation f1: 68.75
Validation accuracy: 96.74
Validation recall: 53.66
Validation precision: 95.65
Validation AUC: 0.7028031621119126
Validation class accuracies: [0.9982547993019197, 0.5365853658536586]
2021-06-29 06:34:47.608687: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 06:34:57.646408: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 06:35:07.619669: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3616
2021-06-29 06:35:17.528383: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 3616
2021-06-29 06:35:27.500024: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 06:35:30.000689: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
226/226 - 137s - loss: 0.0345 - accuracy: 0.9776 - val_loss: 0.1611 - val_accuracy: 0.9593
Confusion matrix: 
 [[566   7]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.439 0.561]]
Validation f1: 64.79
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.93
Validation recall: 56.10
Validation precision: 76.67
Validation AUC: 0.6976317882588435
Validation class accuracies: [0.987783595113438, 0.5609756097560976]
2021-06-29 06:37:13.518502: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 06:37:23.488168: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 06:37:33.350513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3616
2021-06-29 06:37:43.516977: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 3616
2021-06-29 06:37:53.354844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 3616
2021-06-29 06:37:55.674435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 1 epochs
Epoch 6/65
226/226 - 136s - loss: 0.0267 - accuracy: 0.9784 - val_loss: 0.1623 - val_accuracy: 0.9593
Confusion matrix: 
 [[566   7]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.79
Validation accuracy: 95.93
Validation recall: 56.10
Validation precision: 76.67
Validation AUC: 0.6801025046438879
Validation class accuracies: [0.987783595113438, 0.5609756097560976]
2021-06-29 06:39:38.867959: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 06:39:48.748411: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 3616
2021-06-29 06:39:58.836988: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 3616
2021-06-29 06:40:08.691261: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3616
2021-06-29 06:40:18.709743: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 06:40:28.946050: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3441 of 3616
2021-06-29 06:40:33.065919: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 2 epochs
Epoch 7/65
226/226 - 154s - loss: 0.0204 - accuracy: 0.9801 - val_loss: 0.1680 - val_accuracy: 0.9495
Confusion matrix: 
 [[560  13]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.439 0.561]]
Validation f1: 59.74
Validation accuracy: 94.95
Validation recall: 56.10
Validation precision: 63.89
Validation AUC: 0.6844350534501679
Validation class accuracies: [0.9773123909249564, 0.5609756097560976]
2021-06-29 06:42:21.459017: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3616
2021-06-29 06:42:31.528740: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 06:42:41.466007: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3616
2021-06-29 06:42:51.438978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2801 of 3616
2021-06-29 06:43:01.405843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3425 of 3616
2021-06-29 06:43:04.568662: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 3 epochs
Epoch 8/65
226/226 - 137s - loss: 0.0175 - accuracy: 0.9823 - val_loss: 0.2065 - val_accuracy: 0.9609
Confusion matrix: 
 [[564   9]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 68.42
Validation accuracy: 96.09
Validation recall: 63.41
Validation precision: 74.29
Validation AUC: 0.676958219023367
Validation class accuracies: [0.9842931937172775, 0.6341463414634146]
2021-06-29 06:44:47.686291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 06:44:57.680646: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 06:45:07.643486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3616
2021-06-29 06:45:17.612697: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 3616
2021-06-29 06:45:27.550162: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 06:45:30.119746: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 4 epochs
Epoch 9/65
226/226 - 137s - loss: 0.0184 - accuracy: 0.9776 - val_loss: 0.2517 - val_accuracy: 0.9251
Confusion matrix: 
 [[540  33]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.317 0.683]]
Validation f1: 54.90
Validation accuracy: 92.51
Validation recall: 68.29
Validation precision: 45.90
Validation AUC: 0.6594024460748078
Validation class accuracies: [0.9424083769633508, 0.6829268292682927]
2021-06-29 06:47:13.114270: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 06:47:23.107648: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 06:47:33.101037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3616
2021-06-29 06:47:43.140248: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2849 of 3616
2021-06-29 06:47:53.157412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 06:47:55.685127: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 5 epochs
Epoch 10/65
226/226 - 145s - loss: 0.0150 - accuracy: 0.9806 - val_loss: 0.2013 - val_accuracy: 0.9479
Confusion matrix: 
 [[561  12]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.488 0.512]]
Validation f1: 56.76
Validation accuracy: 94.79
Validation recall: 51.22
Validation precision: 63.64
Validation AUC: 0.6194561492401317
Validation class accuracies: [0.9790575916230366, 0.5121951219512195]
2021-06-29 06:49:56.219531: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 369 of 3616
2021-06-29 06:50:06.123102: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3616
2021-06-29 06:50:15.977390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1681 of 3616
2021-06-29 06:50:26.097655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3616
2021-06-29 06:50:35.956632: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3105 of 3616
2021-06-29 06:50:44.899304: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
226/226 - 143s - loss: 0.0130 - accuracy: 0.9793 - val_loss: 0.1816 - val_accuracy: 0.9609
Confusion matrix: 
 [[565   8]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 67.57
Validation accuracy: 96.09
Validation recall: 60.98
Validation precision: 75.76
Validation AUC: 0.6813019943828944
Validation class accuracies: [0.9860383944153578, 0.6097560975609756]
2021-06-29 06:52:28.629296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 06:52:38.481912: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 06:52:48.518400: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 06:52:58.459317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2849 of 3616
2021-06-29 06:53:08.576828: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 3616
2021-06-29 06:53:10.655637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 7 epochs
Epoch 12/65
226/226 - 136s - loss: 0.0117 - accuracy: 0.9795 - val_loss: 0.2225 - val_accuracy: 0.9625
Confusion matrix: 
 [[570   3]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.488 0.512]]
Validation f1: 64.62
Validation accuracy: 96.25
Validation recall: 51.22
Validation precision: 87.50
Validation AUC: 0.6895559294992276
Validation class accuracies: [0.9947643979057592, 0.5121951219512195]
2021-06-29 06:54:53.602092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 06:55:03.516244: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3616
2021-06-29 06:55:13.500597: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 3616
2021-06-29 06:55:23.528745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2849 of 3616
2021-06-29 06:55:33.537148: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 06:55:36.071408: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 8 epochs
Epoch 13/65
226/226 - 139s - loss: 0.0119 - accuracy: 0.9793 - val_loss: 0.2137 - val_accuracy: 0.9593
Confusion matrix: 
 [[570   3]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.537 0.463]]
Validation f1: 60.32
Validation accuracy: 95.93
Validation recall: 46.34
Validation precision: 86.36
Validation AUC: 0.6852575712141576
Validation class accuracies: [0.9947643979057592, 0.4634146341463415]
2021-06-29 06:57:23.335013: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3616
2021-06-29 06:57:33.332161: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3616
2021-06-29 06:57:43.351588: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 3616
2021-06-29 06:57:53.525611: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3616
2021-06-29 06:58:03.430757: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2625 of 3616
2021-06-29 06:58:13.319249: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 06:58:23.273245: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3297 of 3616
2021-06-29 06:58:33.322413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 06:58:33.389282: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 9 epochs
Epoch 14/65
226/226 - 166s - loss: 0.0116 - accuracy: 0.9837 - val_loss: 0.2086 - val_accuracy: 0.9609
Confusion matrix: 
 [[571   2]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.537 0.463]]
Validation f1: 61.29
Validation accuracy: 96.09
Validation recall: 46.34
Validation precision: 90.48
Validation AUC: 0.7026200296037941
Validation class accuracies: [0.9965095986038395, 0.4634146341463415]
2021-06-29 07:00:18.358240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3616
2021-06-29 07:00:28.427738: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3616
2021-06-29 07:00:38.383133: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 3616
2021-06-29 07:00:48.543517: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2817 of 3616
2021-06-29 07:00:58.434570: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3441 of 3616
2021-06-29 07:01:01.366456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 10 epochs
Epoch 15/65
226/226 - 137s - loss: 0.0095 - accuracy: 0.9823 - val_loss: 0.2043 - val_accuracy: 0.9609
Confusion matrix: 
 [[571   2]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.29
Validation accuracy: 96.09
Validation recall: 46.34
Validation precision: 90.48
Validation AUC: 0.7075972713870182
Validation class accuracies: [0.9965095986038395, 0.4634146341463415]
2021-06-29 07:02:44.527167: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3616
2021-06-29 07:02:54.578006: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 07:03:04.505509: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3616
2021-06-29 07:03:14.527480: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2817 of 3616
2021-06-29 07:03:24.591203: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3441 of 3616
2021-06-29 07:03:27.492791: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6875000000000001 hasn't increased by 0 in 11 epochs
Epoch 16/65
226/226 - 137s - loss: 0.0106 - accuracy: 0.9804 - val_loss: 0.1870 - val_accuracy: 0.9642
Confusion matrix: 
 [[567   6]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99 0.01]
 [0.39 0.61]]
Validation f1: 69.44
Validation accuracy: 96.42
Validation recall: 60.98
Validation precision: 80.65
Validation AUC: 0.700383738401468
Validation class accuracies: [0.9895287958115183, 0.6097560975609756]
2021-06-29 07:05:10.696762: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 07:05:20.568174: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 07:05:30.586201: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 3616
2021-06-29 07:05:40.498726: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2577 of 3616
2021-06-29 07:05:50.632199: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3153 of 3616
2021-06-29 07:06:00.519330: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 07:06:01.425537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 17/65
226/226 - 151s - loss: 0.0108 - accuracy: 0.9801 - val_loss: 0.2004 - val_accuracy: 0.9642
Confusion matrix: 
 [[570   3]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.463 0.537]]
Validation f1: 66.67
Validation accuracy: 96.42
Validation recall: 53.66
Validation precision: 88.00
Validation AUC: 0.7078483132204486
Validation class accuracies: [0.9947643979057592, 0.5365853658536586]
2021-06-29 07:07:50.311062: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 07:08:00.176633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 07:08:10.392917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3616
2021-06-29 07:08:20.368905: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 3616
2021-06-29 07:08:30.386968: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 07:08:32.973096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 1 epochs
Epoch 18/65
226/226 - 137s - loss: 0.0106 - accuracy: 0.9837 - val_loss: 0.1902 - val_accuracy: 0.9625
Confusion matrix: 
 [[567   6]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.415 0.585]]
Validation f1: 67.61
Validation accuracy: 96.25
Validation recall: 58.54
Validation precision: 80.00
Validation AUC: 0.703574039382502
Validation class accuracies: [0.9895287958115183, 0.5853658536585366]
2021-06-29 07:10:16.284638: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3616
2021-06-29 07:10:26.222509: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3616
2021-06-29 07:10:36.243201: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3616
2021-06-29 07:10:46.374513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 3616
2021-06-29 07:10:56.385884: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3616
2021-06-29 07:10:58.974315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 2 epochs
Epoch 19/65
226/226 - 137s - loss: 0.0102 - accuracy: 0.9801 - val_loss: 0.1789 - val_accuracy: 0.9528
Confusion matrix: 
 [[559  14]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.366 0.634]]
Validation f1: 64.20
Validation accuracy: 95.28
Validation recall: 63.41
Validation precision: 65.00
Validation AUC: 0.6808385255514212
Validation class accuracies: [0.9755671902268761, 0.6341463414634146]
2021-06-29 07:12:42.219772: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3616
2021-06-29 07:12:52.069132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3616
2021-06-29 07:13:02.122120: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3616
2021-06-29 07:13:12.136597: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2849 of 3616
2021-06-29 07:13:22.190391: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 3616
2021-06-29 07:13:24.487749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 3 epochs
Epoch 20/65
226/226 - 136s - loss: 0.0115 - accuracy: 0.9809 - val_loss: 0.1823 - val_accuracy: 0.9593
Confusion matrix: 
 [[567   6]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.463 0.537]]
Validation f1: 63.77
Validation accuracy: 95.93
Validation recall: 53.66
Validation precision: 78.57
Validation AUC: 0.6669715235262554
Validation class accuracies: [0.9895287958115183, 0.5365853658536586]
2021-06-29 07:15:07.861179: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:15:17.629586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:15:27.617817: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 07:15:37.718664: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 07:15:47.615755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 07:15:47.922183: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 4 epochs
Epoch 21/65
226/226 - 135s - loss: 0.0163 - accuracy: 0.9793 - val_loss: 0.3055 - val_accuracy: 0.9528
Confusion matrix: 
 [[573   0]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.707 0.293]]
Validation f1: 45.28
Validation accuracy: 95.28
Validation recall: 29.27
Validation precision: 100.00
Validation AUC: 0.6944387320180829
Validation class accuracies: [1.0, 0.2926829268292683]
2021-06-29 07:17:31.214866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:17:41.177762: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:17:51.092364: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 07:18:01.124716: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 07:18:11.261532: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 07:18:11.563647: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 5 epochs
Epoch 22/65
226/226 - 135s - loss: 0.0110 - accuracy: 0.9790 - val_loss: 0.1921 - val_accuracy: 0.9609
Confusion matrix: 
 [[570   3]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.512 0.488]]
Validation f1: 62.50
Validation accuracy: 96.09
Validation recall: 48.78
Validation precision: 86.96
Validation AUC: 0.699676323227552
Validation class accuracies: [0.9947643979057592, 0.4878048780487805]
2021-06-29 07:19:54.988688: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 07:20:05.010619: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:20:15.043029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 07:20:25.068698: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 07:20:34.918297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3598 of 3616
2021-06-29 07:20:35.195014: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
226/226 - 135s - loss: 0.0131 - accuracy: 0.9762 - val_loss: 0.2016 - val_accuracy: 0.9609
Confusion matrix: 
 [[569   4]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.488 0.512]]
Validation f1: 63.64
Validation accuracy: 96.09
Validation recall: 51.22
Validation precision: 84.00
Validation AUC: 0.6927875761076
Validation class accuracies: [0.9930191972076788, 0.5121951219512195]
2021-06-29 07:22:18.640800: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:22:28.517558: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:22:38.599913: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 07:22:48.620242: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 07:22:58.504472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 07:22:58.508456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 7 epochs
Epoch 24/65
226/226 - 135s - loss: 0.0104 - accuracy: 0.9820 - val_loss: 0.2250 - val_accuracy: 0.9609
Confusion matrix: 
 [[572   1]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.561 0.439]]
Validation f1: 60.00
Validation accuracy: 96.09
Validation recall: 43.90
Validation precision: 94.74
Validation AUC: 0.706753475960542
Validation class accuracies: [0.9982547993019197, 0.43902439024390244]
2021-06-29 07:24:41.932925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:24:51.968939: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:25:01.871935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 07:25:11.888406: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 07:25:21.932472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 07:25:22.235441: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 8 epochs
Epoch 25/65
226/226 - 135s - loss: 0.0116 - accuracy: 0.9793 - val_loss: 0.2111 - val_accuracy: 0.9609
Confusion matrix: 
 [[571   2]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.29
Validation accuracy: 96.09
Validation recall: 46.34
Validation precision: 90.48
Validation AUC: 0.7092017690567339
Validation class accuracies: [0.9965095986038395, 0.4634146341463415]
2021-06-29 07:27:05.715334: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:27:15.725535: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 07:27:25.681130: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 07:27:35.587606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 07:27:45.554377: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3587 of 3616
2021-06-29 07:27:45.862483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 9 epochs
Epoch 26/65
226/226 - 135s - loss: 0.0110 - accuracy: 0.9817 - val_loss: 0.2056 - val_accuracy: 0.9577
Confusion matrix: 
 [[568   5]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.512 0.488]]
Validation f1: 60.61
Validation accuracy: 95.77
Validation recall: 48.78
Validation precision: 80.00
Validation AUC: 0.7025275128704019
Validation class accuracies: [0.9912739965095986, 0.4878048780487805]
2021-06-29 07:29:29.199628: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:29:39.223960: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 07:29:49.200421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 07:29:59.220556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 07:30:09.346103: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 07:30:09.397506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 10 epochs
Epoch 27/65
226/226 - 135s - loss: 0.0111 - accuracy: 0.9801 - val_loss: 0.1874 - val_accuracy: 0.9593
Confusion matrix: 
 [[567   6]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.77
Validation accuracy: 95.93
Validation recall: 53.66
Validation precision: 78.57
Validation AUC: 0.7029951165799551
Validation class accuracies: [0.9895287958115183, 0.5365853658536586]
2021-06-29 07:31:52.990864: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 07:32:02.955640: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 07:32:13.008259: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 07:32:22.916974: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 3616
2021-06-29 07:32:32.893879: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3553 of 3616
2021-06-29 07:32:33.671639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 11 epochs
Epoch 28/65
226/226 - 136s - loss: 0.0111 - accuracy: 0.9809 - val_loss: 0.1818 - val_accuracy: 0.9544
Confusion matrix: 
 [[558  15]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.317 0.683]]
Validation f1: 66.67
Validation accuracy: 95.44
Validation recall: 68.29
Validation precision: 65.12
Validation AUC: 0.6884875225591542
Validation class accuracies: [0.9738219895287958, 0.6829268292682927]
2021-06-29 07:34:17.388028: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:34:27.218620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1464 of 3616
2021-06-29 07:34:37.407874: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 07:34:47.322855: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 3616
2021-06-29 07:34:57.229669: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3570 of 3616
2021-06-29 07:34:57.803670: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 29/65
226/226 - 135s - loss: 0.0113 - accuracy: 0.9795 - val_loss: 0.1996 - val_accuracy: 0.9609
Confusion matrix: 
 [[568   5]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.463 0.537]]
Validation f1: 64.71
Validation accuracy: 96.09
Validation recall: 53.66
Validation precision: 81.48
Validation AUC: 0.7052557406804227
Validation class accuracies: [0.9912739965095986, 0.5365853658536586]
2021-06-29 07:36:41.375345: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:36:51.448297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 07:37:01.389217: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 07:37:11.439507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 07:37:21.329044: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 07:37:21.649656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 13 epochs
Epoch 30/65
226/226 - 135s - loss: 0.0074 - accuracy: 0.9848 - val_loss: 0.1945 - val_accuracy: 0.9593
Confusion matrix: 
 [[567   6]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.77
Validation accuracy: 95.93
Validation recall: 53.66
Validation precision: 78.57
Validation AUC: 0.7006497220338015
Validation class accuracies: [0.9895287958115183, 0.5365853658536586]
2021-06-29 07:39:04.739602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 07:39:14.743116: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:39:24.816328: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 07:39:34.618536: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2952 of 3616
2021-06-29 07:39:44.655686: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3579 of 3616
2021-06-29 07:39:45.159288: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 14 epochs
Epoch 31/65
226/226 - 135s - loss: 0.0099 - accuracy: 0.9790 - val_loss: 0.1926 - val_accuracy: 0.9593
Confusion matrix: 
 [[567   6]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.77
Validation accuracy: 95.93
Validation recall: 53.66
Validation precision: 78.57
Validation AUC: 0.7042208252204905
Validation class accuracies: [0.9895287958115183, 0.5365853658536586]
2021-06-29 07:41:28.505229: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:41:38.560881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 07:41:48.490980: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 07:41:58.533643: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 07:42:08.691678: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 07:42:08.991562: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 15 epochs
Epoch 32/65
226/226 - 135s - loss: 0.0091 - accuracy: 0.9837 - val_loss: 0.2019 - val_accuracy: 0.9609
Confusion matrix: 
 [[569   4]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.64
Validation accuracy: 96.09
Validation recall: 51.22
Validation precision: 84.00
Validation AUC: 0.7086896655629004
Validation class accuracies: [0.9930191972076788, 0.5121951219512195]
2021-06-29 07:43:52.067456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:44:02.112308: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:44:12.142727: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 07:44:21.975812: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 3616
2021-06-29 07:44:32.069118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 07:44:32.620589: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 16 epochs
Epoch 33/65
226/226 - 135s - loss: 0.0100 - accuracy: 0.9798 - val_loss: 0.1840 - val_accuracy: 0.9609
Confusion matrix: 
 [[567   6]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.439 0.561]]
Validation f1: 65.71
Validation accuracy: 96.09
Validation recall: 56.10
Validation precision: 79.31
Validation AUC: 0.7070814959170201
Validation class accuracies: [0.9895287958115183, 0.5609756097560976]
2021-06-29 07:46:16.121383: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:46:26.201843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 07:46:36.116511: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 07:46:46.081749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 07:46:56.208983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 07:46:56.217588: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 17 epochs
Epoch 34/65
226/226 - 134s - loss: 0.0113 - accuracy: 0.9806 - val_loss: 0.1977 - val_accuracy: 0.9593
Confusion matrix: 
 [[569   4]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.512 0.488]]
Validation f1: 61.54
Validation accuracy: 95.93
Validation recall: 48.78
Validation precision: 83.33
Validation AUC: 0.7044933105414706
Validation class accuracies: [0.9930191972076788, 0.4878048780487805]
2021-06-29 07:48:38.969097: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:48:48.954124: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:48:59.066935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 07:49:09.022336: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 07:49:19.047035: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 07:49:19.358512: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 35/65
226/226 - 135s - loss: 0.0100 - accuracy: 0.9826 - val_loss: 0.1907 - val_accuracy: 0.9593
Confusion matrix: 
 [[568   5]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.488 0.512]]
Validation f1: 62.69
Validation accuracy: 95.93
Validation recall: 51.22
Validation precision: 80.77
Validation AUC: 0.7084106005726715
Validation class accuracies: [0.9912739965095986, 0.5121951219512195]
2021-06-29 07:51:02.551517: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 07:51:12.448770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 07:51:22.373039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 07:51:32.438746: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 3616
2021-06-29 07:51:42.305155: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3554 of 3616
2021-06-29 07:51:43.086412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6944444444444445 hasn't increased by 0 in 19 epochs
Epoch 36/65
226/226 - 135s - loss: 0.0087 - accuracy: 0.9826 - val_loss: 0.1851 - val_accuracy: 0.9593
Confusion matrix: 
 [[568   5]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.488 0.512]]
Validation f1: 62.69
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.93
Validation recall: 51.22
Validation precision: 80.77
Validation AUC: 0.7082229887565938
Validation class accuracies: [0.9912739965095986, 0.5121951219512195]

The metrics for job 2 with the best target metric are: 
Best cm: [[567   6]
 [ 16  25]]
Best normalized cm: [[0.99 0.01]
 [0.39 0.61]]
Best f1: 0.69
Best accuracy: 0.96
Best recall: 0.61
Best precision: 0.81
Best AUC: 0.70
Best class accuracies: [0.9895287958115183, 0.6097560975609756]
Best epoch: 16
The number of epochs since last 1% equals the patience
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_226_1b1_Ll_sc_Meditron_2_label_1_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_207_2b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_211_2p4_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[2.243e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_213_1p5_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[1.381e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_222_1b1_Ar_sc_Meditron_11_label_0_pred_0.png, [[4.623e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_222_1b1_Lr_sc_Meditron_10_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_204_7p5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_211_2p3_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_221_2b2_Ar_mc_LittC2SE_3_label_0_pred_0.png, [[0.156]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1b1_Ar_sc_Meditron_6_label_0_pred_0.png, [[5.029e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_213_1p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[3.713e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[3.69e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[4.295e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1b1_Pl_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1b1_Ar_sc_Meditron_9_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1b1_Ar_sc_Meditron_10_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_207_3b2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1p1_Ar_sc_Litt3200_4_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_213_2p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[2.596e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_205_3b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.424e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1p1_Pl_sc_Litt3200_2_label_0_pred_0.png, [[4.625e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_222_1b1_Lr_sc_Meditron_8_label_0_pred_0.png, [[0.072]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_205_2b3_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[5.656e-08]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.028]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_222_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_221_2b3_Pr_mc_LittC2SE_1_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.02]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_207_2b2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[6.89e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_218_1b1_Ar_sc_Meditron_11_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_221_2b1_Pl_mc_LittC2SE_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[6.157e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[8.467e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_211_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.306]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_210_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[8.711e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_204_2b5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_221_2b1_Lr_mc_LittC2SE_3_label_0_pred_0.png, [[0.061]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_219_2b1_Ar_mc_LittC2SE_2_label_1_pred_1.png, [[0.917]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_222_1b1_Ar_sc_Meditron_12_label_0_pred_0.png, [[9.297e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_223_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[2.566e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_219_2b3_Tc_mc_LittC2SE_3_label_1_pred_0.png, [[0.369]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/2/icbhi_217_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 30350
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_062240-2cf49cw6/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_062240-2cf49cw6/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98258
wandb:         val_accuracy 0.95928
wandb:             _runtime 5436
wandb:           _timestamp 1624953196
wandb:                _step 260
wandb:           train_loss 0.00867
wandb:             val_loss 0.18506
wandb:           val_recall 0.5122
wandb:        val_precision 0.80769
wandb:               val_f1 0.62687
wandb:              val_auc 0.70822
wandb:                   lr 6e-05
wandb:          best_val_f1 0.69444
wandb:    best_val_accuracy 0.96417
wandb:   best_val_precision 0.80645
wandb:      best_val_recall 0.60976
wandb:             best_auc 0.70038
wandb:           best_epoch 16
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇██████████████████▇█████████████
wandb:     val_accuracy ▂▂▃█▇▇▅▇▁▅▇▇▇▇▇▇▇▇▆▇▆▇▇▇▇▆▇▆▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▅▅▃▂▁▁▁▃▅▃▂▄▄▃▃▂▃▂▂▂█▃▃▄▃▃▂▂▃▃▃▃▂▃▂▂
wandb:       val_recall ▁▁▂▇▇▇▇▇█▆▇▆▆▆▆▇▇▇▇▇▄▆▆▅▆▆▇█▇▇▇▆▇▆▆▆
wandb:    val_precision ▁▁██▆▆▅▆▄▅▆▇▇▇▇▇▇▇▆▆█▇▇█▇▇▆▆▇▆▆▇▇▇▇▇
wandb:           val_f1 ▁▁▃███▇█▇▇██▇▇▇███▇▇▆▇▇▇▇▇▇██▇▇▇█▇▇▇
wandb:          val_auc ▁▁▇█████▇▇██████████████████████████
wandb:               lr ██████████▄▄▄▄▄▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_062240-2cf49cw6

-----------------------
Changing augmentation to v42, v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 07:55:07.392941: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 07:55:17.339487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 4374
2021-06-29 07:55:27.417479: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 4374
2021-06-29 07:55:37.428818: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 4374
2021-06-29 07:55:47.353415: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3665 of 4374
2021-06-29 07:55:57.323856: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4295 of 4374
2021-06-29 07:55:58.423487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3974
-----------------------
Number of train recordings: 3974 with pneumonia: 474 and non-pneumonia: 3500
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 4374
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_4 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_15 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_16 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_17 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_18 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_19 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_3 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
274/274 - 162s - loss: 0.2991 - accuracy: 0.8795 - val_loss: 0.2452 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.14278383503027864
Validation class accuracies: [1.0, 0.0]
2021-06-29 07:57:58.326852: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 07:58:08.463319: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 07:58:18.323214: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 4374
2021-06-29 07:58:28.446057: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 4374
2021-06-29 07:58:38.367429: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 07:58:48.452836: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4343 of 4374
2021-06-29 07:58:48.738769: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
274/274 - 161s - loss: 0.1424 - accuracy: 0.9328 - val_loss: 0.2696 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.613650105472956
Validation class accuracies: [1.0, 0.0]
2021-06-29 08:00:47.809325: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 08:00:57.837394: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 4374
2021-06-29 08:01:07.834637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 4374
2021-06-29 08:01:17.818082: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 4374
2021-06-29 08:01:27.854439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3697 of 4374
2021-06-29 08:01:37.726998: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4311 of 4374
2021-06-29 08:01:38.603430: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
274/274 - 162s - loss: 0.0693 - accuracy: 0.9641 - val_loss: 0.2762 - val_accuracy: 0.9463
Confusion matrix: 
 [[572   1]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.78  0.22 ]]
Validation f1: 35.29
Validation accuracy: 94.63
Validation recall: 21.95
Validation precision: 90.00
Validation AUC: 0.4925053826984555
Validation class accuracies: [0.9982547993019197, 0.21951219512195122]
2021-06-29 08:03:38.683079: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:03:48.721705: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:03:58.674789: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:04:08.766776: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 08:04:18.551124: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3697 of 4374
2021-06-29 08:04:28.690528: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4327 of 4374
2021-06-29 08:04:29.238064: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
274/274 - 162s - loss: 0.0464 - accuracy: 0.9723 - val_loss: 0.2608 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.6977032583408284
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
2021-06-29 08:06:29.553492: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:06:39.621027: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:06:49.640648: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:06:59.644290: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 4374
2021-06-29 08:07:09.616256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 08:07:19.710499: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4343 of 4374
2021-06-29 08:07:20.014957: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
274/274 - 161s - loss: 0.0269 - accuracy: 0.9765 - val_loss: 0.1868 - val_accuracy: 0.9593
Confusion matrix: 
 [[569   4]
 [ 21  20]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.512 0.488]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.54
Validation accuracy: 95.93
Validation recall: 48.78
Validation precision: 83.33
Validation AUC: 0.6366016272815838
Validation class accuracies: [0.9930191972076788, 0.4878048780487805]
2021-06-29 08:09:19.395412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 08:09:29.294781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 08:09:39.250201: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2230 of 4374
2021-06-29 08:09:49.389076: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 08:09:59.443031: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3729 of 4374
2021-06-29 08:10:09.370212: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4343 of 4374
2021-06-29 08:10:09.680448: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
274/274 - 162s - loss: 0.0234 - accuracy: 0.9783 - val_loss: 0.1615 - val_accuracy: 0.9511
Confusion matrix: 
 [[561  12]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.439 0.561]]
Validation f1: 60.53
Validation accuracy: 95.11
Validation recall: 56.10
Validation precision: 65.71
Validation AUC: 0.6693933602214862
Validation class accuracies: [0.9790575916230366, 0.5609756097560976]
2021-06-29 08:12:10.067825: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:12:20.189478: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:12:30.087576: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:12:40.011982: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 08:12:50.021536: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3729 of 4374
2021-06-29 08:13:00.026585: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4352 of 4374
2021-06-29 08:13:00.237297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 1 epochs
Epoch 7/65
274/274 - 161s - loss: 0.0208 - accuracy: 0.9803 - val_loss: 0.2187 - val_accuracy: 0.9316
Confusion matrix: 
 [[543  30]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.293 0.707]]
Validation f1: 58.00
Validation accuracy: 93.16
Validation recall: 70.73
Validation precision: 49.15
Validation AUC: 0.6638127761717795
Validation class accuracies: [0.9476439790575916, 0.7073170731707317]
2021-06-29 08:14:59.507917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:15:09.360238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 08:15:19.393138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:15:29.510466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 08:15:39.366927: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 08:15:49.568183: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4343 of 4374
2021-06-29 08:15:49.891488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 2 epochs
Epoch 8/65
274/274 - 161s - loss: 0.0157 - accuracy: 0.9803 - val_loss: 0.2171 - val_accuracy: 0.9593
Confusion matrix: 
 [[573   0]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.   0.  ]
 [0.61 0.39]]
Validation f1: 56.14
Validation accuracy: 95.93
Validation recall: 39.02
Validation precision: 100.00
Validation AUC: 0.7291127601896813
Validation class accuracies: [1.0, 0.3902439024390244]
2021-06-29 08:17:49.686465: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4374
2021-06-29 08:17:59.622529: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:18:09.730368: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4374
2021-06-29 08:18:19.596392: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 4374
2021-06-29 08:18:29.608747: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3697 of 4374
2021-06-29 08:18:39.695933: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4327 of 4374
2021-06-29 08:18:40.277703: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6153846153846153 hasn't increased by 0 in 3 epochs
Epoch 9/65
274/274 - 162s - loss: 0.0169 - accuracy: 0.9810 - val_loss: 0.1608 - val_accuracy: 0.9642
Confusion matrix: 
 [[568   5]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.415 0.585]]
Validation f1: 68.57
Validation accuracy: 96.42
Validation recall: 58.54
Validation precision: 82.76
Validation AUC: 0.7321026566013252
Validation class accuracies: [0.9912739965095986, 0.5853658536585366]
2021-06-29 08:20:40.566379: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:20:50.481773: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 08:21:00.638927: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:21:10.533348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 4374
2021-06-29 08:21:20.449303: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3681 of 4374
2021-06-29 08:21:30.467903: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4311 of 4374
2021-06-29 08:21:31.273896: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 10/65
274/274 - 162s - loss: 0.0140 - accuracy: 0.9826 - val_loss: 0.2092 - val_accuracy: 0.9349
Confusion matrix: 
 [[544  29]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.268 0.732]]
Validation f1: 60.00
Validation accuracy: 93.49
Validation recall: 73.17
Validation precision: 50.85
Validation AUC: 0.6890094432341057
Validation class accuracies: [0.9493891797556719, 0.7317073170731707]
2021-06-29 08:23:31.277452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 08:23:41.236941: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 4374
2021-06-29 08:23:51.213549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 4374
2021-06-29 08:24:01.319092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 4374
2021-06-29 08:24:11.207553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3649 of 4374
2021-06-29 08:24:21.233635: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4295 of 4374
2021-06-29 08:24:22.332090: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 1 epochs
Epoch 11/65
274/274 - 163s - loss: 0.0132 - accuracy: 0.9803 - val_loss: 0.1876 - val_accuracy: 0.9349
Confusion matrix: 
 [[546  27]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.317 0.683]]
Validation f1: 58.33
Validation accuracy: 93.49
Validation recall: 68.29
Validation precision: 50.91
Validation AUC: 0.6874114376180157
Validation class accuracies: [0.9528795811518325, 0.6829268292682927]
2021-06-29 08:26:22.359362: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 08:26:32.485550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 08:26:42.550750: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4374
2021-06-29 08:26:52.391865: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 4374
2021-06-29 08:27:02.512059: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3745 of 4374
2021-06-29 08:27:12.428888: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4359 of 4374
2021-06-29 08:27:12.440226: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 2 epochs
Epoch 12/65
274/274 - 161s - loss: 0.0115 - accuracy: 0.9831 - val_loss: 0.1542 - val_accuracy: 0.9593
Confusion matrix: 
 [[564   9]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.93
Validation recall: 60.98
Validation precision: 73.53
Validation AUC: 0.7221900825499306
Validation class accuracies: [0.9842931937172775, 0.6097560975609756]
2021-06-29 08:29:12.225213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:29:22.268781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:29:32.322695: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:29:42.277886: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 4374
2021-06-29 08:29:52.231887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 08:30:02.233643: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4343 of 4374
2021-06-29 08:30:02.512250: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 3 epochs
Epoch 13/65
274/274 - 161s - loss: 0.0132 - accuracy: 0.9822 - val_loss: 0.1625 - val_accuracy: 0.9625
Confusion matrix: 
 [[568   5]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.439 0.561]]
Validation f1: 66.67
Validation accuracy: 96.25
Validation recall: 56.10
Validation precision: 82.14
Validation AUC: 0.7274780182658546
Validation class accuracies: [0.9912739965095986, 0.5609756097560976]
2021-06-29 08:32:02.017100: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:32:12.130423: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 4374
2021-06-29 08:32:22.095340: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 4374
2021-06-29 08:32:31.998456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 4374
2021-06-29 08:32:41.992766: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3745 of 4374
2021-06-29 08:32:51.971745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4361 of 4374
2021-06-29 08:32:51.982277: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 4 epochs
Epoch 14/65
274/274 - 161s - loss: 0.0138 - accuracy: 0.9838 - val_loss: 0.1613 - val_accuracy: 0.9593
Confusion matrix: 
 [[566   7]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.79
Validation accuracy: 95.93
Validation recall: 56.10
Validation precision: 76.67
Validation AUC: 0.6680313107377057
Validation class accuracies: [0.987783595113438, 0.5609756097560976]
2021-06-29 08:34:51.760454: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4374
2021-06-29 08:35:01.614483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:35:11.703873: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4374
2021-06-29 08:35:21.612185: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 08:35:31.610331: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 08:35:41.532737: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4339 of 4374
2021-06-29 08:35:42.039414: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 5 epochs
Epoch 15/65
274/274 - 162s - loss: 0.0124 - accuracy: 0.9824 - val_loss: 0.2087 - val_accuracy: 0.9544
Confusion matrix: 
 [[566   7]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.512 0.488]]
Validation f1: 58.82
Validation accuracy: 95.44
Validation recall: 48.78
Validation precision: 74.07
Validation AUC: 0.6449732722010018
Validation class accuracies: [0.987783595113438, 0.4878048780487805]
2021-06-29 08:37:42.432062: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:37:52.477937: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:38:02.429048: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4374
2021-06-29 08:38:12.476970: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 4374
2021-06-29 08:38:22.345864: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3729 of 4374
2021-06-29 08:38:32.349039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4352 of 4374
2021-06-29 08:38:32.615189: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
274/274 - 161s - loss: 0.0121 - accuracy: 0.9797 - val_loss: 0.1835 - val_accuracy: 0.9577
Confusion matrix: 
 [[566   7]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.463 0.537]]
Validation f1: 62.86
Validation accuracy: 95.77
Validation recall: 53.66
Validation precision: 75.86
Validation AUC: 0.7034429659128282
Validation class accuracies: [0.987783595113438, 0.5365853658536586]
2021-06-29 08:40:32.233585: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:40:42.196796: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 08:40:52.194523: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:41:02.134345: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 08:41:12.080996: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 08:41:22.267995: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4343 of 4374
2021-06-29 08:41:22.539525: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 7 epochs
Epoch 17/65
274/274 - 163s - loss: 0.0103 - accuracy: 0.9817 - val_loss: 0.2070 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.84
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.6474072911244415
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
2021-06-29 08:43:23.334718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 08:43:33.394023: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 08:43:43.460849: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:43:53.348296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 4374
2021-06-29 08:44:03.410568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3697 of 4374
2021-06-29 08:44:13.393428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4311 of 4374
2021-06-29 08:44:14.255049: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 8 epochs
Epoch 18/65
274/274 - 163s - loss: 0.0116 - accuracy: 0.9806 - val_loss: 0.2297 - val_accuracy: 0.9593
Confusion matrix: 
 [[569   4]
 [ 21  20]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.512 0.488]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.54
Validation accuracy: 95.93
Validation recall: 48.78
Validation precision: 83.33
Validation AUC: 0.650029465094912
Validation class accuracies: [0.9930191972076788, 0.4878048780487805]
2021-06-29 08:46:15.187791: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 08:46:25.366139: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:46:35.210874: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:46:45.387143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 08:46:55.266461: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 08:47:05.424745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4343 of 4374
2021-06-29 08:47:05.702117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 9 epochs
Epoch 19/65
274/274 - 163s - loss: 0.0128 - accuracy: 0.9803 - val_loss: 0.2237 - val_accuracy: 0.9528
Confusion matrix: 
 [[570   3]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.634 0.366]]
Validation f1: 50.85
Validation accuracy: 95.28
Validation recall: 36.59
Validation precision: 83.33
Validation AUC: 0.6808379534935936
Validation class accuracies: [0.9947643979057592, 0.36585365853658536]
2021-06-29 08:49:06.981024: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-29 08:49:16.984884: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 4374
2021-06-29 08:49:27.186836: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-29 08:49:37.116684: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-29 08:49:47.073393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 4374
2021-06-29 08:49:57.050983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4215 of 4374
2021-06-29 08:49:59.509968: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 10 epochs
Epoch 20/65
274/274 - 165s - loss: 0.0106 - accuracy: 0.9824 - val_loss: 0.2086 - val_accuracy: 0.9593
Confusion matrix: 
 [[570   3]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.32
Validation accuracy: 95.93
Validation recall: 46.34
Validation precision: 86.36
Validation AUC: 0.6828894707590925
Validation class accuracies: [0.9947643979057592, 0.4634146341463415]
2021-06-29 08:52:00.977626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 08:52:10.941533: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-29 08:52:20.978466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 4374
2021-06-29 08:52:30.863201: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2900 of 4374
2021-06-29 08:52:40.942889: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3649 of 4374
2021-06-29 08:52:50.892645: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4279 of 4374
2021-06-29 08:52:52.273925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 11 epochs
Epoch 21/65
274/274 - 164s - loss: 0.0105 - accuracy: 0.9819 - val_loss: 0.1811 - val_accuracy: 0.9479
Confusion matrix: 
 [[561  12]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.76
Validation accuracy: 94.79
Validation recall: 51.22
Validation precision: 63.64
Validation AUC: 0.6496825421027507
Validation class accuracies: [0.9790575916230366, 0.5121951219512195]
2021-06-29 08:54:53.581653: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 08:55:03.614363: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:55:13.711365: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:55:23.640693: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 4374
2021-06-29 08:55:33.783645: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3681 of 4374
2021-06-29 08:55:43.796718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4295 of 4374
2021-06-29 08:55:44.901714: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
274/274 - 162s - loss: 0.0106 - accuracy: 0.9819 - val_loss: 0.1980 - val_accuracy: 0.9511
Confusion matrix: 
 [[568   5]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.61  0.39 ]]
Validation f1: 51.61
Validation accuracy: 95.11
Validation recall: 39.02
Validation precision: 76.19
Validation AUC: 0.6525607822126502
Validation class accuracies: [0.9912739965095986, 0.3902439024390244]
2021-06-29 08:57:44.668807: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4374
2021-06-29 08:57:54.675739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 08:58:04.649516: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 08:58:14.620925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 08:58:24.598221: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3729 of 4374
2021-06-29 08:58:34.704836: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4359 of 4374
2021-06-29 08:58:34.708261: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 13 epochs
Epoch 23/65
274/274 - 162s - loss: 0.0126 - accuracy: 0.9797 - val_loss: 0.1784 - val_accuracy: 0.9511
Confusion matrix: 
 [[566   7]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.561 0.439]]
Validation f1: 54.55
Validation accuracy: 95.11
Validation recall: 43.90
Validation precision: 72.00
Validation AUC: 0.6862613081023116
Validation class accuracies: [0.987783595113438, 0.43902439024390244]
2021-06-29 09:00:34.867684: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 09:00:45.027801: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 09:00:54.870332: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-29 09:01:04.847951: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 09:01:15.009668: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3729 of 4374
2021-06-29 09:01:24.807090: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4354 of 4374
2021-06-29 09:01:25.096212: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 14 epochs
Epoch 24/65
274/274 - 161s - loss: 0.0125 - accuracy: 0.9787 - val_loss: 0.1840 - val_accuracy: 0.9560
Confusion matrix: 
 [[566   7]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.488 0.512]]
Validation f1: 60.87
Validation accuracy: 95.60
Validation recall: 51.22
Validation precision: 75.00
Validation AUC: 0.6785222573557793
Validation class accuracies: [0.987783595113438, 0.5121951219512195]
2021-06-29 09:03:24.660502: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-29 09:03:34.838471: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 09:03:44.691928: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 4374
2021-06-29 09:03:54.661157: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 4374
2021-06-29 09:04:04.756523: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3681 of 4374
2021-06-29 09:04:14.777538: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4311 of 4374
2021-06-29 09:04:15.663637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 15 epochs
Epoch 25/65
274/274 - 162s - loss: 0.0102 - accuracy: 0.9797 - val_loss: 0.1540 - val_accuracy: 0.9544
Confusion matrix: 
 [[565   8]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.00
Validation accuracy: 95.44
Validation recall: 51.22
Validation precision: 72.41
Validation AUC: 0.6840904307978056
Validation class accuracies: [0.9860383944153578, 0.5121951219512195]
2021-06-29 09:06:15.313495: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 09:06:25.231766: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 09:06:35.283456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4374
2021-06-29 09:06:45.339469: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 4374
2021-06-29 09:06:55.352598: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3745 of 4374
2021-06-29 09:07:05.252051: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4360 of 4374
2021-06-29 09:07:05.264469: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 16 epochs
Epoch 26/65
274/274 - 162s - loss: 0.0074 - accuracy: 0.9842 - val_loss: 0.1626 - val_accuracy: 0.9593
Confusion matrix: 
 [[566   7]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.79
Validation accuracy: 95.93
Validation recall: 56.10
Validation precision: 76.67
Validation AUC: 0.6877885661266624
Validation class accuracies: [0.987783595113438, 0.5609756097560976]
2021-06-29 09:09:06.269852: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 09:09:16.253481: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4374
2021-06-29 09:09:26.273678: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4374
2021-06-29 09:09:36.228962: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 09:09:46.193383: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 09:09:56.335357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4343 of 4374
2021-06-29 09:09:56.634611: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 17 epochs
Epoch 27/65
274/274 - 162s - loss: 0.0130 - accuracy: 0.9762 - val_loss: 0.1808 - val_accuracy: 0.9593
Confusion matrix: 
 [[567   6]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.463 0.537]]
Validation f1: 63.77
Validation accuracy: 95.93
Validation recall: 53.66
Validation precision: 78.57
Validation AUC: 0.6950695122906025
Validation class accuracies: [0.9895287958115183, 0.5365853658536586]
2021-06-29 09:11:57.283482: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 09:12:07.389259: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 4374
2021-06-29 09:12:17.267317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4374
2021-06-29 09:12:27.197324: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-29 09:12:37.223754: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-29 09:12:47.182129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4336 of 4374
2021-06-29 09:12:47.714358: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
274/274 - 163s - loss: 0.0097 - accuracy: 0.9845 - val_loss: 0.1731 - val_accuracy: 0.9560
Confusion matrix: 
 [[564   9]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.01
Validation accuracy: 95.60
Validation recall: 56.10
Validation precision: 71.88
Validation AUC: 0.6886649685138804
Validation class accuracies: [0.9842931937172775, 0.5609756097560976]
2021-06-29 09:14:48.384065: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4374
2021-06-29 09:14:58.480778: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 4374
2021-06-29 09:15:08.358239: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 4374
2021-06-29 09:15:18.335088: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 4374
2021-06-29 09:15:28.381460: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3697 of 4374
2021-06-29 09:15:38.482991: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4327 of 4374
2021-06-29 09:15:39.084741: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6857142857142856 hasn't increased by 0 in 19 epochs
Epoch 29/65
274/274 - 163s - loss: 0.0103 - accuracy: 0.9790 - val_loss: 0.1746 - val_accuracy: 0.9544
Confusion matrix: 
 [[565   8]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.00
Validation accuracy: 95.44
Validation recall: 51.22
Validation precision: 72.41
Validation AUC: 0.6877445271783252
Validation class accuracies: [0.9860383944153578, 0.5121951219512195]

The metrics for job 3 with the best target metric are: 
Best cm: [[568   5]
 [ 17  24]]
Best normalized cm: [[0.991 0.009]
 [0.415 0.585]]
Best f1: 0.69
Best accuracy: 0.96
Best recall: 0.59
Best precision: 0.83
Best AUC: 0.73
Best class accuracies: [0.9912739965095986, 0.5853658536585366]
Best epoch: 9
The number of epochs since last 1% equals the patience
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[2.976e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_205_4b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[9.176e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_1.png, [[0.966]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_205_1b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_218_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_204_7p5_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[5.595e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/jordan_EP36_pneumonia,Crep,P R M,36,F_4_label_1_pred_0.png, [[0.387]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_213_1p2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[1.981e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_207_2b3_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[2.412e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_213_2p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_222_1b1_Lr_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_213_2p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[1.47e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_218_1b1_Pr_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_218_1b1_Ar_sc_Meditron_13_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_207_2b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_204_2b5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[3.128e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[8.344e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.451e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[2.069e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_207_2b4_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[1.303e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_222_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_213_1p5_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[4.394e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_223_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[1.269e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_218_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_211_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[8.39e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_205_1b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[4.64e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_213_1p2_Lr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_204_7p5_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[1.656e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_213_2p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_207_2b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_213_1p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[6.531e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_207_2b4_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[3.004e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_203_2p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[3.487e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png, [[0.993]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_218_1b1_Al_sc_Meditron_9_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_205_1b3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[3.98e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/3/icbhi_205_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 4153
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_075348-16v63m4l/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_075348-16v63m4l/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.97897
wandb:         val_accuracy 0.9544
wandb:             _runtime 5021
wandb:           _timestamp 1624958250
wandb:                _step 214
wandb:           train_loss 0.01032
wandb:             val_loss 0.17458
wandb:           val_recall 0.5122
wandb:        val_precision 0.72414
wandb:               val_f1 0.6
wandb:              val_auc 0.68774
wandb:                   lr 0.00013
wandb:          best_val_f1 0.68571
wandb:    best_val_accuracy 0.96417
wandb:   best_val_precision 0.82759
wandb:      best_val_recall 0.58537
wandb:             best_auc 0.7321
wandb:           best_epoch 9
wandb: Run history:
wandb:   train_accuracy ▁▅▇▇▇█████████████████████▇██
wandb:     val_accuracy ▃▃▅▁▇▆▂▇█▃▃▇█▇▆▇▃▇▆▇▅▆▆▇▆▇▇▇▆
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▆██▇▃▁▅▅▁▄▃▁▁▁▄▃▄▅▅▄▃▄▂▃▁▁▃▂▂
wandb:       val_recall ▁▁▃█▆▆█▅▇██▇▆▆▆▆▇▆▅▅▆▅▅▆▆▆▆▆▆
wandb:    val_precision ▁▁▇▄▇▆▄█▇▅▅▆▇▆▆▆▅▇▇▇▅▆▆▆▆▆▆▆▆
wandb:           val_f1 ▁▁▅▇▇▇▇▇█▇▇███▇▇▇▇▆▇▇▆▇▇▇██▇▇
wandb:          val_auc ▁▇▅█▇▇▇██▇▇██▇▇█▇▇▇▇▇▇▇▇▇▇█▇▇
wandb:               lr ███████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_075348-16v63m4l

-----------------------
Model 9 with new params
Changing augmentation to time/frequency masking
Audio Augmentation Parameters: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Spec Augmentation Parameters: {'ADD': 1, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 09:22:56.579352: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:23:06.630148: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:23:16.646568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 09:23:26.619883: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 09:23:36.595899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 09:23:36.602614: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_16
Length of training samples after spec augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_17
Length of training samples after spec augmentation: 3216
-----------------------
Number of train recordings: 3216 with pneumonia: 316 and non-pneumonia: 2900
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3616
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_5 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_20 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_20 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_21 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_21 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_22 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_22 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_23 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_23 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_24 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_24 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_24 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_4 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_4 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
226/226 - 134s - loss: 0.2899 - accuracy: 0.8838 - val_loss: 0.2455 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20912178173624804
Validation class accuracies: [1.0, 0.0]
2021-06-29 09:25:19.746254: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 09:25:29.838141: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 09:25:39.887347: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 09:25:49.729116: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 3616
2021-06-29 09:25:59.862984: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 09:26:00.467575: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
226/226 - 135s - loss: 0.1167 - accuracy: 0.9461 - val_loss: 0.2434 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2125051320150746
Validation class accuracies: [1.0, 0.0]
2021-06-29 09:27:43.333262: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 746 of 3616
2021-06-29 09:27:53.527499: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3616
2021-06-29 09:28:03.559786: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3616
2021-06-29 09:28:13.533160: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 3616
2021-06-29 09:28:23.180509: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
226/226 - 134s - loss: 0.0749 - accuracy: 0.9582 - val_loss: 0.2566 - val_accuracy: 0.9349
Confusion matrix: 
 [[573   0]
 [ 40   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.976 0.024]]
Validation f1: 4.76
Validation accuracy: 93.49
Validation recall: 2.44
Validation precision: 100.00
Validation AUC: 0.358891703184212
Validation class accuracies: [1.0, 0.024390243902439025]
2021-06-29 09:30:06.294985: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:30:16.343571: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:30:26.299574: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 09:30:36.340388: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 09:30:46.189935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 09:30:46.475046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
226/226 - 134s - loss: 0.0520 - accuracy: 0.9718 - val_loss: 0.1715 - val_accuracy: 0.9544
Confusion matrix: 
 [[567   6]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.58
Validation accuracy: 95.44
Validation recall: 46.34
Validation precision: 76.00
Validation AUC: 0.6480210875949182
Validation class accuracies: [0.9895287958115183, 0.4634146341463415]
2021-06-29 09:32:29.359140: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 09:32:39.226547: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 09:32:49.269532: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 09:32:59.214069: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 3616
2021-06-29 09:33:09.250550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 09:33:09.804540: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
226/226 - 136s - loss: 0.0288 - accuracy: 0.9815 - val_loss: 0.2789 - val_accuracy: 0.9577
Confusion matrix: 
 [[570   3]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.561 0.439]]
Validation f1: 58.06
Validation accuracy: 95.77
Validation recall: 43.90
Validation precision: 85.71
Validation AUC: 0.6359129182501857
Validation class accuracies: [0.9947643979057592, 0.43902439024390244]
2021-06-29 09:34:53.948741: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:35:03.804348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 09:35:13.984027: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 09:35:23.808093: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 09:35:33.791973: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 09:35:33.802748: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
226/226 - 134s - loss: 0.0274 - accuracy: 0.9762 - val_loss: 0.3382 - val_accuracy: 0.8827
Confusion matrix: 
 [[520  53]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.463 0.537]]
Validation f1: 37.93
Validation accuracy: 88.27
Validation recall: 53.66
Validation precision: 29.33
Validation AUC: 0.5246448443732192
Validation class accuracies: [0.9075043630017452, 0.5365853658536586]
2021-06-29 09:37:16.191193: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:37:26.253214: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:37:36.358877: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 09:37:46.275586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 09:37:56.317276: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 09:37:56.321016: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5806451612903225 hasn't increased by 0 in 1 epochs
Epoch 7/65
226/226 - 135s - loss: 0.0227 - accuracy: 0.9746 - val_loss: 0.5082 - val_accuracy: 0.8404
Confusion matrix: 
 [[484  89]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.845 0.155]
 [0.22  0.78 ]]
Validation f1: 39.51
Validation accuracy: 84.04
Validation recall: 78.05
Validation precision: 26.45
Validation AUC: 0.5278262641070381
Validation class accuracies: [0.8446771378708552, 0.7804878048780488]
2021-06-29 09:39:39.648240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:39:49.620909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 09:39:59.660434: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 09:40:09.706229: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 09:40:19.644369: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 09:40:19.995734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5806451612903225 hasn't increased by 0 in 2 epochs
Epoch 8/65
226/226 - 135s - loss: 0.0240 - accuracy: 0.9784 - val_loss: 0.2233 - val_accuracy: 0.9349
Confusion matrix: 
 [[549  24]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.39  0.61 ]]
Validation f1: 55.56
Validation accuracy: 93.49
Validation recall: 60.98
Validation precision: 51.02
Validation AUC: 0.5957491012662508
Validation class accuracies: [0.9581151832460733, 0.6097560975609756]
2021-06-29 09:42:03.424809: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:42:13.391629: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 09:42:23.327725: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 3616
2021-06-29 09:42:33.435252: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 09:42:43.440606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 09:42:43.746120: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5806451612903225 hasn't increased by 0 in 3 epochs
Epoch 9/65
226/226 - 135s - loss: 0.0167 - accuracy: 0.9823 - val_loss: 0.2309 - val_accuracy: 0.9381
Confusion matrix: 
 [[553  20]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.439 0.561]]
Validation f1: 54.76
Validation accuracy: 93.81
Validation recall: 56.10
Validation precision: 53.49
Validation AUC: 0.617995170319928
Validation class accuracies: [0.9650959860383944, 0.5609756097560976]
2021-06-29 09:44:27.270776: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:44:37.227406: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 09:44:47.197189: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 09:44:57.270237: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 09:45:07.254739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 09:45:07.545432: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5806451612903225 hasn't increased by 0 in 4 epochs
Epoch 10/65
226/226 - 136s - loss: 0.0128 - accuracy: 0.9842 - val_loss: 0.3256 - val_accuracy: 0.8876
Confusion matrix: 
 [[523  50]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.463 0.537]]
Validation f1: 38.94
Validation accuracy: 88.76
Validation recall: 53.66
Validation precision: 30.56
Validation AUC: 0.553509369530234
Validation class accuracies: [0.912739965095986, 0.5365853658536586]
2021-06-29 09:46:51.823086: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:47:01.864945: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:47:11.873325: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 09:47:21.912907: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 09:47:31.820217: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3610 of 3616
2021-06-29 09:47:31.820299: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5806451612903225 hasn't increased by 0 in 5 epochs
Epoch 11/65
226/226 - 135s - loss: 0.0156 - accuracy: 0.9790 - val_loss: 0.2255 - val_accuracy: 0.9397
Confusion matrix: 
 [[550  23]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.34
Validation accuracy: 93.97
Validation recall: 65.85
Validation precision: 54.00
Validation AUC: 0.6541239179403874
Validation class accuracies: [0.9598603839441536, 0.6585365853658537]
2021-06-29 09:49:15.399143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:49:25.433398: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:49:35.311553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 09:49:45.488197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 09:49:55.415487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 09:49:55.445974: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 12/65
226/226 - 134s - loss: 0.0175 - accuracy: 0.9820 - val_loss: 0.2070 - val_accuracy: 0.9463
Confusion matrix: 
 [[560  13]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.00
Validation accuracy: 94.63
Validation recall: 51.22
Validation precision: 61.76
Validation AUC: 0.6173558758283244
Validation class accuracies: [0.9773123909249564, 0.5121951219512195]
2021-06-29 09:51:38.323176: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:51:48.337257: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:51:58.310094: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 09:52:08.332010: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 09:52:18.293890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 09:52:18.300342: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5934065934065934 hasn't increased by 0 in 1 epochs
Epoch 13/65
226/226 - 134s - loss: 0.0164 - accuracy: 0.9768 - val_loss: 0.3228 - val_accuracy: 0.9609
Confusion matrix: 
 [[570   3]
 [ 21  20]]
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.512 0.488]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.50
Validation accuracy: 96.09
Validation recall: 48.78
Validation precision: 86.96
Validation AUC: 0.5814210816894325
Validation class accuracies: [0.9947643979057592, 0.4878048780487805]
2021-06-29 09:54:01.249098: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:54:11.277756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:54:21.255607: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 09:54:31.259198: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 09:54:41.266099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 09:54:41.275459: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 14/65
226/226 - 134s - loss: 0.0155 - accuracy: 0.9768 - val_loss: 0.2812 - val_accuracy: 0.9039
Confusion matrix: 
 [[530  43]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.39  0.61 ]]
Validation f1: 45.87
Validation accuracy: 90.39
Validation recall: 60.98
Validation precision: 36.76
Validation AUC: 0.5652555285834845
Validation class accuracies: [0.924956369982548, 0.6097560975609756]
2021-06-29 09:56:24.379577: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 3616
2021-06-29 09:56:34.338453: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:56:44.241017: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 09:56:54.474219: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 09:57:04.292580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 09:57:04.343807: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 1 epochs
Epoch 15/65
226/226 - 134s - loss: 0.0144 - accuracy: 0.9793 - val_loss: 0.3344 - val_accuracy: 0.9528
Confusion matrix: 
 [[564   9]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.488 0.512]]
Validation f1: 59.15
Validation accuracy: 95.28
Validation recall: 51.22
Validation precision: 70.00
Validation AUC: 0.5661809461059805
Validation class accuracies: [0.9842931937172775, 0.5121951219512195]
2021-06-29 09:58:47.134468: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 09:58:57.084284: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 09:59:07.151596: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3616
2021-06-29 09:59:17.193055: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 3616
2021-06-29 09:59:26.944538: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 2 epochs
Epoch 16/65
226/226 - 134s - loss: 0.0136 - accuracy: 0.9779 - val_loss: 0.2612 - val_accuracy: 0.9446
Confusion matrix: 
 [[557  16]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.439 0.561]]
Validation f1: 57.50
Validation accuracy: 94.46
Validation recall: 56.10
Validation precision: 58.97
Validation AUC: 0.6057584219585139
Validation class accuracies: [0.9720767888307156, 0.5609756097560976]
2021-06-29 10:01:10.311206: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:01:20.206140: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 10:01:30.291247: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 10:01:40.372650: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 10:01:50.333887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 10:01:50.624072: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 3 epochs
Epoch 17/65
226/226 - 135s - loss: 0.0122 - accuracy: 0.9815 - val_loss: 0.2805 - val_accuracy: 0.9544
Confusion matrix: 
 [[567   6]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.58
Validation accuracy: 95.44
Validation recall: 46.34
Validation precision: 76.00
Validation AUC: 0.6328937451376763
Validation class accuracies: [0.9895287958115183, 0.4634146341463415]
2021-06-29 10:03:33.726871: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 3616
2021-06-29 10:03:43.867751: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3616
2021-06-29 10:03:53.709426: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 10:04:03.710769: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 10:04:13.674485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 10:04:13.727272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 4 epochs
Epoch 18/65
226/226 - 134s - loss: 0.0101 - accuracy: 0.9834 - val_loss: 0.2285 - val_accuracy: 0.9495
Confusion matrix: 
 [[563  10]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.512 0.488]]
Validation f1: 56.34
Validation accuracy: 94.95
Validation recall: 48.78
Validation precision: 66.67
Validation AUC: 0.5986695469756601
Validation class accuracies: [0.9825479930191972, 0.4878048780487805]
2021-06-29 10:05:56.759680: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:06:06.751664: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 10:06:16.756567: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 10:06:26.716907: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-29 10:06:36.701220: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 10:06:37.285434: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 5 epochs
Epoch 19/65
226/226 - 135s - loss: 0.0145 - accuracy: 0.9801 - val_loss: 0.2297 - val_accuracy: 0.9414
Confusion matrix: 
 [[552  21]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.366 0.634]]
Validation f1: 59.09
Validation accuracy: 94.14
Validation recall: 63.41
Validation precision: 55.32
Validation AUC: 0.626836709748095
Validation class accuracies: [0.9633507853403142, 0.6341463414634146]
2021-06-29 10:08:20.045173: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:08:30.063349: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 10:08:39.988711: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 10:08:49.997494: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 10:09:00.034324: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 10:09:00.083342: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 20/65
226/226 - 136s - loss: 0.0145 - accuracy: 0.9759 - val_loss: 0.2693 - val_accuracy: 0.9300
Confusion matrix: 
 [[545  28]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.366 0.634]]
Validation f1: 54.74
Validation accuracy: 93.00
Validation recall: 63.41
Validation precision: 48.15
Validation AUC: 0.6011068171523289
Validation class accuracies: [0.9511343804537522, 0.6341463414634146]
2021-06-29 10:10:44.752461: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:10:54.860108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 10:11:04.726190: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 10:11:14.883088: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 10:11:24.753506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 10:11:25.360545: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 7 epochs
Epoch 21/65
226/226 - 136s - loss: 0.0104 - accuracy: 0.9823 - val_loss: 0.2205 - val_accuracy: 0.9495
Confusion matrix: 
 [[561  12]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.463 0.537]]
Validation f1: 58.67
Validation accuracy: 94.95
Validation recall: 53.66
Validation precision: 64.71
Validation AUC: 0.6304569776917148
Validation class accuracies: [0.9790575916230366, 0.5365853658536586]
2021-06-29 10:13:09.582885: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 10:13:19.651224: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 10:13:29.540380: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 3616
2021-06-29 10:13:39.553861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 3616
2021-06-29 10:13:49.492345: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 10:13:50.036705: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 8 epochs
Epoch 22/65
226/226 - 136s - loss: 0.0128 - accuracy: 0.9812 - val_loss: 0.1909 - val_accuracy: 0.9528
Confusion matrix: 
 [[561  12]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.415 0.585]]
Validation f1: 62.34
Validation accuracy: 95.28
Validation recall: 58.54
Validation precision: 66.67
Validation AUC: 0.646851497351454
Validation class accuracies: [0.9790575916230366, 0.5853658536585366]
2021-06-29 10:15:34.505944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:15:44.541930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 10:15:54.411082: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 10:16:04.449647: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 10:16:14.510569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 10:16:14.514085: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 9 epochs
Epoch 23/65
226/226 - 135s - loss: 0.0110 - accuracy: 0.9834 - val_loss: 0.2346 - val_accuracy: 0.9560
Confusion matrix: 
 [[566   7]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.87
Validation accuracy: 95.60
Validation recall: 51.22
Validation precision: 75.00
Validation AUC: 0.653833636751404
Validation class accuracies: [0.987783595113438, 0.5121951219512195]
2021-06-29 10:17:57.927562: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:18:08.018981: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 10:18:17.884389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 10:18:27.916808: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 10:18:37.894341: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 10:18:37.899770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 10 epochs
Epoch 24/65
226/226 - 135s - loss: 0.0119 - accuracy: 0.9809 - val_loss: 0.2165 - val_accuracy: 0.9381
Confusion matrix: 
 [[553  20]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.439 0.561]]
Validation f1: 54.76
Validation accuracy: 93.81
Validation recall: 56.10
Validation precision: 53.49
Validation AUC: 0.615986557656094
Validation class accuracies: [0.9650959860383944, 0.5609756097560976]
2021-06-29 10:20:22.100404: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:20:32.221392: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 10:20:42.066052: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 10:20:52.194383: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 10:21:02.160485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 10:21:02.166074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 11 epochs
Epoch 25/65
226/226 - 136s - loss: 0.0132 - accuracy: 0.9801 - val_loss: 0.2202 - val_accuracy: 0.9577
Confusion matrix: 
 [[568   5]
 [ 21  20]]
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.512 0.488]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.61
Validation accuracy: 95.77
Validation recall: 48.78
Validation precision: 80.00
Validation AUC: 0.6313856004954448
Validation class accuracies: [0.9912739965095986, 0.4878048780487805]
2021-06-29 10:22:46.993897: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:22:57.023259: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 10:23:07.006903: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 10:23:17.009710: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 10:23:26.824938: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 26/65
226/226 - 135s - loss: 0.0102 - accuracy: 0.9823 - val_loss: 0.2214 - val_accuracy: 0.9349
Confusion matrix: 
 [[549  24]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.39  0.61 ]]
Validation f1: 55.56
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.49
Validation recall: 60.98
Validation precision: 51.02
Validation AUC: 0.629967703167463
Validation class accuracies: [0.9581151832460733, 0.6097560975609756]
2021-06-29 10:25:10.332386: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 10:25:20.380388: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 10:25:30.378413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 10:25:40.370619: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 10:25:50.317067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3596 of 3616
2021-06-29 10:25:50.546509: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 13 epochs
Epoch 27/65
226/226 - 136s - loss: 0.0095 - accuracy: 0.9817 - val_loss: 0.2297 - val_accuracy: 0.9511
Confusion matrix: 
 [[564   9]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.512 0.488]]
Validation f1: 57.14
Validation accuracy: 95.11
Validation recall: 48.78
Validation precision: 68.97
Validation AUC: 0.6164472425786313
Validation class accuracies: [0.9842931937172775, 0.4878048780487805]
2021-06-29 10:27:35.267995: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 10:27:45.251029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 10:27:55.294157: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 10:28:05.190295: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2960 of 3616
2021-06-29 10:28:15.375630: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 3616
2021-06-29 10:28:15.669338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 14 epochs
Epoch 28/65
226/226 - 136s - loss: 0.0120 - accuracy: 0.9782 - val_loss: 0.2163 - val_accuracy: 0.9463
Confusion matrix: 
 [[556  17]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97 0.03]
 [0.39 0.61]]
Validation f1: 60.24
Validation accuracy: 94.63
Validation recall: 60.98
Validation precision: 59.52
Validation AUC: 0.6295232183897858
Validation class accuracies: [0.9703315881326352, 0.6097560975609756]
2021-06-29 10:30:00.127545: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:30:10.026346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 10:30:20.141075: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 10:30:30.082852: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 10:30:40.042489: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 3616
2021-06-29 10:30:40.090470: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 15 epochs
Epoch 29/65
226/226 - 136s - loss: 0.0098 - accuracy: 0.9804 - val_loss: 0.2066 - val_accuracy: 0.9479
Confusion matrix: 
 [[557  16]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.39  0.61 ]]
Validation f1: 60.98
Validation accuracy: 94.79
Validation recall: 60.98
Validation precision: 60.98
Validation AUC: 0.6481781433528307
Validation class accuracies: [0.9720767888307156, 0.6097560975609756]
2021-06-29 10:32:24.490735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3616
2021-06-29 10:32:34.418185: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3616
2021-06-29 10:32:44.555518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 10:32:54.560333: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 3616
2021-06-29 10:33:04.577713: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 10:33:05.119227: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 16 epochs
Epoch 30/65
226/226 - 136s - loss: 0.0119 - accuracy: 0.9782 - val_loss: 0.2288 - val_accuracy: 0.9397
Confusion matrix: 
 [[551  22]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.366 0.634]]
Validation f1: 58.43
Validation accuracy: 93.97
Validation recall: 63.41
Validation precision: 54.17
Validation AUC: 0.6294232232847452
Validation class accuracies: [0.9616055846422339, 0.6341463414634146]
2021-06-29 10:34:49.266421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:34:59.268520: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-29 10:35:09.199275: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-29 10:35:19.321355: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-29 10:35:29.189701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3587 of 3616
2021-06-29 10:35:29.386167: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 17 epochs
Epoch 31/65
226/226 - 136s - loss: 0.0117 - accuracy: 0.9795 - val_loss: 0.2137 - val_accuracy: 0.9495
Confusion matrix: 
 [[561  12]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.463 0.537]]
Validation f1: 58.67
Validation accuracy: 94.95
Validation recall: 53.66
Validation precision: 64.71
Validation AUC: 0.6469952049556157
Validation class accuracies: [0.9790575916230366, 0.5365853658536586]
2021-06-29 10:37:13.843714: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:37:23.958868: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3616
2021-06-29 10:37:33.880086: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3616
2021-06-29 10:37:43.983937: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 3616
2021-06-29 10:37:53.983850: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 3616
2021-06-29 10:37:54.518132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 32/65
226/226 - 136s - loss: 0.0118 - accuracy: 0.9820 - val_loss: 0.2055 - val_accuracy: 0.9495
Confusion matrix: 
 [[559  14]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.415 0.585]]
Validation f1: 60.76
Validation accuracy: 94.95
Validation recall: 58.54
Validation precision: 63.16
Validation AUC: 0.6648632243340227
Validation class accuracies: [0.9755671902268761, 0.5853658536585366]
2021-06-29 10:39:39.035982: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-29 10:39:49.033301: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3616
2021-06-29 10:39:58.913829: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 3616
2021-06-29 10:40:08.904822: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-29 10:40:18.765067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.625 hasn't increased by 0 in 19 epochs
Epoch 33/65
226/226 - 135s - loss: 0.0087 - accuracy: 0.9820 - val_loss: 0.2028 - val_accuracy: 0.9511
Confusion matrix: 
 [[560  13]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.415 0.585]]
Validation f1: 61.54
Validation accuracy: 95.11
Validation recall: 58.54
Validation precision: 64.86
Validation AUC: 0.6604172353585049
Validation class accuracies: [0.9773123909249564, 0.5853658536585366]

The metrics for job 4 with the best target metric are: 
Best cm: [[570   3]
 [ 21  20]]
Best normalized cm: [[0.995 0.005]
 [0.512 0.488]]
Best f1: 0.62
Best accuracy: 0.96
Best recall: 0.49
Best precision: 0.87
Best AUC: 0.58
Best class accuracies: [0.9947643979057592, 0.4878048780487805]
Best epoch: 13
The number of epochs since last 1% equals the patience
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_221_2b3_Ar_mc_LittC2SE_2_label_0_pred_0.png, [[0.281]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_2b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_205_3b4_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[3.985e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[2.695e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_218_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[9.136e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_224_1b1_Tc_sc_Meditron_1_label_0_pred_0.png, [[1.149e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png, [[0.99]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_210_1b1_Al_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_203_2p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[5.418e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_223_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_218_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_222_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.031]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_3b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_213_2p2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[3.112e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_2b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_213_1p5_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.919e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_205_1b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_211_2p3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[2.251e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_213_1p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_3b2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_205_1b3_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_205_1b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_221_2b3_Ar_mc_LittC2SE_3_label_0_pred_0.png, [[0.056]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_213_1p3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_222_1b1_Ar_sc_Meditron_7_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_2b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_205_1b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_2b4_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_2b4_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[7.124e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_223_1b1_Ll_sc_Meditron_5_label_0_pred_0.png, [[3.282e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_223_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[6.701e-07]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[3.549e-05]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_218_1b1_Pr_sc_Meditron_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_223_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[6.969e-06]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_2b3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_2b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_218_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_203_2p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_211_2p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2268__06_0326__v39__mixup_augm/4/icbhi_207_2b3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[8.268e-06]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 8216
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_091802-1b4qm14v/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_091802-1b4qm14v/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98202
wandb:         val_accuracy 0.95114
wandb:             _runtime 5029
wandb:           _timestamp 1624963312
wandb:                _step 245
wandb:           train_loss 0.00867
wandb:             val_loss 0.20276
wandb:           val_recall 0.58537
wandb:        val_precision 0.64865
wandb:               val_f1 0.61538
wandb:              val_auc 0.66042
wandb:                   lr 0.00013
wandb:          best_val_f1 0.625
wandb:    best_val_accuracy 0.96091
wandb:   best_val_precision 0.86957
wandb:      best_val_recall 0.4878
wandb:             best_auc 0.58142
wandb:           best_epoch 13
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇█▇▇█████▇▇█████▇█████████████
wandb:     val_accuracy ▆▆▆██▃▁▆▇▄▇▇█▅█▇█▇▇▆▇██▇█▆▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▂▃▁▃▄█▂▂▄▂▂▄▃▄▃▃▂▂▃▂▁▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ▁▁▁▅▅▆█▆▆▆▇▆▅▆▆▆▅▅▇▇▆▆▆▆▅▆▅▆▆▇▆▆▆
wandb:    val_precision ▁▁█▆▇▃▃▅▅▃▅▅▇▄▆▅▆▆▅▄▆▆▆▅▇▅▆▅▅▅▆▅▆
wandb:           val_f1 ▁▁▂▇█▅▅▇▇▅█▇█▆█▇▇▇█▇███▇█▇▇██████
wandb:          val_auc ▁▁▃██▆▆▇▇▆█▇▇▆▆▇█▇▇▇▇██▇▇▇▇▇█▇███
wandb:               lr ███████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_091802-1b4qm14v

-----------------------

 See logs at ../../new_cache/conv__2268__06_0326__v39__mixup_augm/logs/