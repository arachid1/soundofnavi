Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2270
Description:  mixup
2021-06-29 13:59:10.780321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-29 13:59:13.478056: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 13:59:13.479174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-29 13:59:13.536446: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:13.537140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 13:59:13.537170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 13:59:13.541470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 13:59:13.541650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 13:59:13.543122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 13:59:13.543506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 13:59:13.544844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 13:59:13.545978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 13:59:13.546189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 13:59:13.546372: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:13.547514: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:13.548379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2270.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2270__06_1358__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 13:59:18.819261: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 13:59:18.819619: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:18.820639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 13:59:18.820753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 13:59:18.820868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 13:59:18.820917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 13:59:18.820959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 13:59:18.820998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 13:59:18.821037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 13:59:18.821076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 13:59:18.821112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 13:59:18.821275: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:18.822363: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:18.823270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-29 13:59:18.823340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 13:59:19.635231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-29 13:59:19.635281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-29 13:59:19.635299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-29 13:59:19.635584: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:19.636320: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:19.637009: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 13:59:19.637650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-29 13:59:20.816283: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-29 13:59:20.818971: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-29 14:00:27.834748: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3058
2021-06-29 14:00:37.735666: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3058
2021-06-29 14:00:47.839156: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3058
2021-06-29 14:00:57.782451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 3058
2021-06-29 14:01:03.731171: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-06-29 14:01:04.075616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 14:01:05.758628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 14:01:06.272853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3058
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
192/192 - 125s - loss: 0.3097 - accuracy: 0.8954 - val_loss: 0.2474 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3336394159895495
Validation class accuracies: [1.0, 0.0]
2021-06-29 14:02:41.507559: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3058
2021-06-29 14:02:51.472240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3058
2021-06-29 14:03:01.639287: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3058
2021-06-29 14:03:11.608411: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 3058
2021-06-29 14:03:21.857195: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3019 of 3058
2021-06-29 14:03:22.628281: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
192/192 - 125s - loss: 0.1224 - accuracy: 0.9434 - val_loss: 0.2461 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5291780030742228
Validation class accuracies: [1.0, 0.0]
2021-06-29 14:04:56.068984: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3058
2021-06-29 14:05:06.162196: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3058
2021-06-29 14:05:16.188211: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 3058
2021-06-29 14:05:26.174494: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 3058
2021-06-29 14:05:36.230787: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2971 of 3058
2021-06-29 14:05:38.303038: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
192/192 - 126s - loss: 0.1039 - accuracy: 0.9451 - val_loss: 0.1830 - val_accuracy: 0.9349
Confusion matrix: 
 [[573   0]
 [ 40   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.976 0.024]]
Validation f1: 4.76
Validation accuracy: 93.49
Validation recall: 2.44
Validation precision: 100.00
Validation AUC: 0.6916936941228469
Validation class accuracies: [1.0, 0.024390243902439025]
2021-06-29 14:07:11.903347: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3058
2021-06-29 14:07:21.960722: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3058
2021-06-29 14:07:31.997536: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3058
2021-06-29 14:07:42.074470: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 3058
2021-06-29 14:07:52.131153: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2907 of 3058
2021-06-29 14:07:55.707267: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
192/192 - 128s - loss: 0.0774 - accuracy: 0.9585 - val_loss: 0.1870 - val_accuracy: 0.9397
Confusion matrix: 
 [[551  22]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.366 0.634]]
Validation f1: 58.43
Validation accuracy: 93.97
Validation recall: 63.41
Validation precision: 54.17
Validation AUC: 0.514458301103532
Validation class accuracies: [0.9616055846422339, 0.6341463414634146]
2021-06-29 14:09:29.356331: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3058
2021-06-29 14:09:39.645121: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 3058
2021-06-29 14:09:49.367243: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 3058
2021-06-29 14:09:59.843992: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 14:10:09.407619: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2827 of 3058
2021-06-29 14:10:15.049259: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
192/192 - 131s - loss: 0.0535 - accuracy: 0.9634 - val_loss: 0.1768 - val_accuracy: 0.9381
Confusion matrix: 
 [[555  18]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.488 0.512]]
Validation f1: 52.50
Validation accuracy: 93.81
Validation recall: 51.22
Validation precision: 53.85
Validation AUC: 0.5867969634134312
Validation class accuracies: [0.9685863874345549, 0.5121951219512195]
2021-06-29 14:11:49.103335: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3058
2021-06-29 14:11:59.121459: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 3058
2021-06-29 14:12:09.179356: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 3058
2021-06-29 14:12:19.169686: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 3058
2021-06-29 14:12:29.291415: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 3058
2021-06-29 14:12:36.127454: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 1 epochs
Epoch 6/65
192/192 - 131s - loss: 0.0396 - accuracy: 0.9696 - val_loss: 0.1991 - val_accuracy: 0.9414
Confusion matrix: 
 [[553  20]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.39  0.61 ]]
Validation f1: 58.14
Validation accuracy: 94.14
Validation recall: 60.98
Validation precision: 55.56
Validation AUC: 0.5647697905751882
Validation class accuracies: [0.9650959860383944, 0.6097560975609756]
2021-06-29 14:14:09.646581: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3058
2021-06-29 14:14:19.664850: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1185 of 3058
2021-06-29 14:14:29.530326: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 3058
2021-06-29 14:14:39.721053: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 3058
2021-06-29 14:14:49.668633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2763 of 3058
2021-06-29 14:14:56.720748: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 2 epochs
Epoch 7/65
192/192 - 132s - loss: 0.0310 - accuracy: 0.9755 - val_loss: 0.7386 - val_accuracy: 0.7492
Confusion matrix: 
 [[421 152]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.735 0.265]
 [0.049 0.951]]
Validation f1: 33.62
Validation accuracy: 74.92
Validation recall: 95.12
Validation precision: 20.42
Validation AUC: 0.6635672273748205
Validation class accuracies: [0.7347294938917975, 0.9512195121951219]
2021-06-29 14:16:30.578193: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3058
2021-06-29 14:16:40.551709: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 3058
2021-06-29 14:16:50.456862: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1681 of 3058
2021-06-29 14:17:00.559366: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3058
2021-06-29 14:17:10.519841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 3058
2021-06-29 14:17:19.375786: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 3 epochs
Epoch 8/65
192/192 - 134s - loss: 0.0387 - accuracy: 0.9702 - val_loss: 0.2290 - val_accuracy: 0.9544
Confusion matrix: 
 [[569   4]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.585 0.415]]
Validation f1: 54.84
Validation accuracy: 95.44
Validation recall: 41.46
Validation precision: 80.95
Validation AUC: 0.64825479497945
Validation class accuracies: [0.9930191972076788, 0.4146341463414634]
2021-06-29 14:18:55.261276: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 3058
2021-06-29 14:19:05.341592: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 3058
2021-06-29 14:19:15.435408: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 3058
2021-06-29 14:19:25.255995: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3058
2021-06-29 14:19:35.258650: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 3058
2021-06-29 14:19:43.862147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 4 epochs
Epoch 9/65
192/192 - 135s - loss: 0.0379 - accuracy: 0.9725 - val_loss: 0.2259 - val_accuracy: 0.9381
Confusion matrix: 
 [[549  24]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.341 0.659]]
Validation f1: 58.70
Validation accuracy: 93.81
Validation recall: 65.85
Validation precision: 52.94
Validation AUC: 0.5930971002812333
Validation class accuracies: [0.9581151832460733, 0.6585365853658537]
2021-06-29 14:21:21.738777: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 556 of 3058
2021-06-29 14:21:31.872096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3058
2021-06-29 14:21:41.891764: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 3058
2021-06-29 14:21:51.863450: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 3058
2021-06-29 14:22:02.052621: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 3058
2021-06-29 14:22:11.672695: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 10/65
192/192 - 137s - loss: 0.0249 - accuracy: 0.9761 - val_loss: 0.2029 - val_accuracy: 0.9463
Confusion matrix: 
 [[556  17]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97 0.03]
 [0.39 0.61]]
Validation f1: 60.24
Validation accuracy: 94.63
Validation recall: 60.98
Validation precision: 59.52
Validation AUC: 0.5381424143082065
Validation class accuracies: [0.9703315881326352, 0.6097560975609756]
2021-06-29 14:23:50.681530: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3058
2021-06-29 14:24:00.674458: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 3058
2021-06-29 14:24:10.729100: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 3058
2021-06-29 14:24:20.545033: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3058
2021-06-29 14:24:30.808838: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 3058
2021-06-29 14:24:40.511665: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3012 of 3058
2021-06-29 14:24:41.347220: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 11/65
192/192 - 137s - loss: 0.0282 - accuracy: 0.9771 - val_loss: 0.1938 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.317 0.683]]
Validation f1: 62.92
Validation accuracy: 94.63
Validation recall: 68.29
Validation precision: 58.33
Validation AUC: 0.6663134924875866
Validation class accuracies: [0.9650959860383944, 0.6829268292682927]
2021-06-29 14:26:19.187462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3058
2021-06-29 14:26:29.231569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3058
2021-06-29 14:26:39.182944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 3058
2021-06-29 14:26:49.148543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3058
2021-06-29 14:26:59.409914: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 3058
2021-06-29 14:27:05.886394: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 12/65
192/192 - 132s - loss: 0.0258 - accuracy: 0.9751 - val_loss: 0.2741 - val_accuracy: 0.9300
Confusion matrix: 
 [[544  29]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.341 0.659]]
Validation f1: 55.67
Validation accuracy: 93.00
Validation recall: 65.85
Validation precision: 48.21
Validation AUC: 0.5547305900187066
Validation class accuracies: [0.9493891797556719, 0.6585365853658537]
2021-06-29 14:28:42.668278: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3058
2021-06-29 14:28:52.693428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3058
2021-06-29 14:29:02.812735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 3058
2021-06-29 14:29:12.744442: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3058
2021-06-29 14:29:22.610635: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 3058
2021-06-29 14:29:27.427742: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 1 epochs
Epoch 13/65
192/192 - 131s - loss: 0.0185 - accuracy: 0.9774 - val_loss: 0.2447 - val_accuracy: 0.9332
Confusion matrix: 
 [[545  28]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.317 0.683]]
Validation f1: 57.73
Validation accuracy: 93.32
Validation recall: 68.29
Validation precision: 50.00
Validation AUC: 0.5853272139834912
Validation class accuracies: [0.9511343804537522, 0.6829268292682927]
2021-06-29 14:31:04.536730: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3058
2021-06-29 14:31:14.593571: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1025 of 3058
2021-06-29 14:31:24.531460: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 3058
2021-06-29 14:31:34.628298: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 3058
2021-06-29 14:31:44.621735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2875 of 3058
2021-06-29 14:31:47.733376: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 2 epochs
Epoch 14/65
192/192 - 129s - loss: 0.0228 - accuracy: 0.9778 - val_loss: 0.2436 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
Validation f1: 56.84
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.5423512122455806
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
2021-06-29 14:33:25.028110: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3058
2021-06-29 14:33:34.788091: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3058
2021-06-29 14:33:44.879445: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 3058
2021-06-29 14:33:54.759771: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 3058
2021-06-29 14:34:04.683420: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2955 of 3058
2021-06-29 14:34:06.453669: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 3 epochs
Epoch 15/65
192/192 - 128s - loss: 0.0242 - accuracy: 0.9768 - val_loss: 0.2082 - val_accuracy: 0.9446
Confusion matrix: 
 [[554  19]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.366 0.634]]
Validation f1: 60.47
Validation accuracy: 94.46
Validation recall: 63.41
Validation precision: 57.78
Validation AUC: 0.5682562464718031
Validation class accuracies: [0.9668411867364747, 0.6341463414634146]
2021-06-29 14:35:46.514422: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 593 of 3058
2021-06-29 14:35:56.458036: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 3058
2021-06-29 14:36:06.527686: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 3058
2021-06-29 14:36:16.526504: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 3058
2021-06-29 14:36:24.260074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 4 epochs
Epoch 16/65
192/192 - 126s - loss: 0.0199 - accuracy: 0.9745 - val_loss: 0.2535 - val_accuracy: 0.9349
Confusion matrix: 
 [[546  27]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.317 0.683]]
Validation f1: 58.33
Validation accuracy: 93.49
Validation recall: 68.29
Validation precision: 50.91
Validation AUC: 0.5733014468962008
Validation class accuracies: [0.9528795811518325, 0.6829268292682927]
2021-06-29 14:38:03.630088: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3058
2021-06-29 14:38:13.747119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3058
2021-06-29 14:38:23.817106: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3058
2021-06-29 14:38:33.695335: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 3058
2021-06-29 14:38:39.335543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 5 epochs
Epoch 17/65
192/192 - 123s - loss: 0.0205 - accuracy: 0.9765 - val_loss: 0.2377 - val_accuracy: 0.9332
Confusion matrix: 
 [[544  29]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.293 0.707]]
Validation f1: 58.59
Validation accuracy: 93.32
Validation recall: 70.73
Validation precision: 50.00
Validation AUC: 0.59570580006311
Validation class accuracies: [0.9493891797556719, 0.7073170731707317]
2021-06-29 14:40:15.920861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3058
2021-06-29 14:40:26.005174: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3058
2021-06-29 14:40:35.891301: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 3058
2021-06-29 14:40:45.955686: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 3058
2021-06-29 14:40:52.082743: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 18/65
192/192 - 121s - loss: 0.0213 - accuracy: 0.9722 - val_loss: 0.2009 - val_accuracy: 0.9463
Confusion matrix: 
 [[554  19]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.341 0.659]]
Validation f1: 62.07
Validation accuracy: 94.63
Validation recall: 65.85
Validation precision: 58.70
Validation AUC: 0.6084897206681732
Validation class accuracies: [0.9668411867364747, 0.6585365853658537]
2021-06-29 14:42:25.931222: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3058
2021-06-29 14:42:35.874546: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3058
2021-06-29 14:42:45.878193: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3058
2021-06-29 14:42:55.828505: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 3058
2021-06-29 14:43:04.141905: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 7 epochs
Epoch 19/65
192/192 - 123s - loss: 0.0191 - accuracy: 0.9765 - val_loss: 0.2138 - val_accuracy: 0.9479
Confusion matrix: 
 [[556  17]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.366 0.634]]
Validation f1: 61.90
Validation accuracy: 94.79
Validation recall: 63.41
Validation precision: 60.47
Validation AUC: 0.5842257462682033
Validation class accuracies: [0.9703315881326352, 0.6341463414634146]
2021-06-29 14:44:38.641851: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 14:44:48.704974: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 3058
2021-06-29 14:44:58.692568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 3058
2021-06-29 14:45:08.723220: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 3058
2021-06-29 14:45:18.489299: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2942 of 3058
2021-06-29 14:45:21.624011: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 8 epochs
Epoch 20/65
192/192 - 129s - loss: 0.0154 - accuracy: 0.9817 - val_loss: 0.2179 - val_accuracy: 0.9397
Confusion matrix: 
 [[550  23]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.341 0.659]]
Validation f1: 59.34
Validation accuracy: 93.97
Validation recall: 65.85
Validation precision: 54.00
Validation AUC: 0.587009096099682
Validation class accuracies: [0.9598603839441536, 0.6585365853658537]
2021-06-29 14:46:56.734375: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3058
2021-06-29 14:47:06.819143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 3058
2021-06-29 14:47:16.702867: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3058
2021-06-29 14:47:26.749108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 14:47:36.823018: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2843 of 3058
2021-06-29 14:47:42.331341: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 9 epochs
Epoch 21/65
192/192 - 131s - loss: 0.0162 - accuracy: 0.9771 - val_loss: 0.2742 - val_accuracy: 0.9349
Confusion matrix: 
 [[547  26]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.341 0.659]]
Validation f1: 57.45
Validation accuracy: 93.49
Validation recall: 65.85
Validation precision: 50.94
Validation AUC: 0.5691989542143902
Validation class accuracies: [0.9546247818499127, 0.6585365853658537]
2021-06-29 14:49:16.357176: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3058
2021-06-29 14:49:26.509842: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3058
2021-06-29 14:49:36.408476: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3058
2021-06-29 14:49:46.649755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 3058
2021-06-29 14:49:56.631389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2875 of 3058
2021-06-29 14:50:01.076238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 10 epochs
Epoch 22/65
192/192 - 129s - loss: 0.0177 - accuracy: 0.9791 - val_loss: 0.2090 - val_accuracy: 0.9463
Confusion matrix: 
 [[555  18]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.366 0.634]]
Validation f1: 61.18
Validation accuracy: 94.63
Validation recall: 63.41
Validation precision: 59.09
Validation AUC: 0.5951386976505896
Validation class accuracies: [0.9685863874345549, 0.6341463414634146]
2021-06-29 14:51:35.052572: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3058
2021-06-29 14:51:45.055130: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3058
2021-06-29 14:51:55.059883: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 3058
2021-06-29 14:52:05.015305: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 3058
2021-06-29 14:52:14.874669: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2806 of 3058
2021-06-29 14:52:21.200770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 11 epochs
Epoch 23/65
192/192 - 131s - loss: 0.0209 - accuracy: 0.9768 - val_loss: 0.2081 - val_accuracy: 0.9495
Confusion matrix: 
 [[557  16]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.366 0.634]]
Validation f1: 62.65
Validation accuracy: 94.95
Validation recall: 63.41
Validation precision: 61.90
Validation AUC: 0.5821505177445301
Validation class accuracies: [0.9720767888307156, 0.6341463414634146]
2021-06-29 14:53:54.945344: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 14:54:04.958626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 14:54:14.780221: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1777 of 3058
2021-06-29 14:54:24.903425: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 3058
2021-06-29 14:54:34.715639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2748 of 3058
2021-06-29 14:54:42.381008: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 24/65
192/192 - 133s - loss: 0.0177 - accuracy: 0.9807 - val_loss: 0.2126 - val_accuracy: 0.9479
Confusion matrix: 
 [[556  17]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.90
Validation accuracy: 94.79
Validation recall: 63.41
Validation precision: 60.47
Validation AUC: 0.5936997261002528
Validation class accuracies: [0.9703315881326352, 0.6341463414634146]
2021-06-29 14:56:18.177482: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 3058
2021-06-29 14:56:28.237846: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 3058
2021-06-29 14:56:37.923254: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1512 of 3058
2021-06-29 14:56:48.062563: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 3058
2021-06-29 14:56:57.985456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 3058
2021-06-29 14:57:08.277138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2859 of 3058
2021-06-29 14:57:13.521451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 13 epochs
Epoch 25/65
192/192 - 141s - loss: 0.0197 - accuracy: 0.9755 - val_loss: 0.2985 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.575421485737045
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
2021-06-29 14:58:49.408897: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 3058
2021-06-29 14:58:59.564909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1089 of 3058
2021-06-29 14:59:09.539338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1649 of 3058
2021-06-29 14:59:19.516005: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3058
2021-06-29 14:59:29.434376: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 3058
2021-06-29 14:59:39.576946: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3035 of 3058
2021-06-29 14:59:40.019752: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6292134831460675 hasn't increased by 0 in 14 epochs
Epoch 26/65
192/192 - 138s - loss: 0.0165 - accuracy: 0.9801 - val_loss: 0.2026 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.6022959568596625
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-29 15:01:20.551072: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 3058
2021-06-29 15:01:30.692819: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3058
2021-06-29 15:01:40.532612: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3058
2021-06-29 15:01:50.689026: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3058
2021-06-29 15:02:00.486037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2468 of 3058
2021-06-29 15:02:10.707385: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2811 of 3058
2021-06-29 15:02:18.158129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 27/65
192/192 - 146s - loss: 0.0176 - accuracy: 0.9797 - val_loss: 0.2100 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.5932593369850511
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-29 15:04:00.002411: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3058
2021-06-29 15:04:09.969700: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1185 of 3058
2021-06-29 15:04:20.125796: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 3058
2021-06-29 15:04:29.957979: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3058
2021-06-29 15:04:39.974293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2859 of 3058
2021-06-29 15:04:44.064464: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6341463414634146 hasn't increased by 0 in 1 epochs
Epoch 28/65
192/192 - 133s - loss: 0.0187 - accuracy: 0.9748 - val_loss: 0.2107 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.5974028452511481
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 15:06:26.309245: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3058
2021-06-29 15:06:36.349453: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 785 of 3058
2021-06-29 15:06:46.365404: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 3058
2021-06-29 15:06:56.353993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3058
2021-06-29 15:07:06.320575: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 3058
2021-06-29 15:07:16.405576: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3051 of 3058
2021-06-29 15:07:16.405674: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 29/65
192/192 - 134s - loss: 0.0183 - accuracy: 0.9774 - val_loss: 0.2083 - val_accuracy: 0.9463
Confusion matrix: 
 [[554  19]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.07
Validation accuracy: 94.63
Validation recall: 65.85
Validation precision: 58.70
Validation AUC: 0.5990080813424319
Validation class accuracies: [0.9668411867364747, 0.6585365853658537]
2021-06-29 15:08:49.955956: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 15:08:59.950594: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 3058
2021-06-29 15:09:10.123531: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 3058
2021-06-29 15:09:20.014081: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2667 of 3058
2021-06-29 15:09:26.878419: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 1 epochs
Epoch 30/65
192/192 - 120s - loss: 0.0170 - accuracy: 0.9784 - val_loss: 0.1941 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.6108974654956811
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-29 15:10:59.072717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3058
2021-06-29 15:11:09.282676: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1201 of 3058
2021-06-29 15:11:19.117661: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 3058
2021-06-29 15:11:29.325863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 3058
2021-06-29 15:11:39.340949: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 3058
2021-06-29 15:11:48.421813: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 2 epochs
Epoch 31/65
192/192 - 136s - loss: 0.0176 - accuracy: 0.9768 - val_loss: 0.1983 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.6160075171770202
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
2021-06-29 15:13:25.617187: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 15:13:35.615533: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 15:13:45.584434: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3058
2021-06-29 15:13:55.641570: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:14:05.629828: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2939 of 3058
2021-06-29 15:14:07.888844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 3 epochs
Epoch 32/65
192/192 - 127s - loss: 0.0171 - accuracy: 0.9794 - val_loss: 0.1852 - val_accuracy: 0.9511
Confusion matrix: 
 [[559  14]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.39  0.61 ]]
Validation f1: 62.50
Validation accuracy: 95.11
Validation recall: 60.98
Validation precision: 64.10
Validation AUC: 0.6200094951067608
Validation class accuracies: [0.9755671902268761, 0.6097560975609756]
2021-06-29 15:15:42.247109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 15:15:52.132255: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 3058
2021-06-29 15:16:02.199237: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 3058
2021-06-29 15:16:12.687340: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:16:22.399072: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2939 of 3058
2021-06-29 15:16:24.739254: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 4 epochs
Epoch 33/65
192/192 - 129s - loss: 0.0183 - accuracy: 0.9751 - val_loss: 0.1876 - val_accuracy: 0.9495
Confusion matrix: 
 [[558  15]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.39  0.61 ]]
Validation f1: 61.73
Validation accuracy: 94.95
Validation recall: 60.98
Validation precision: 62.50
Validation AUC: 0.6132626597829609
Validation class accuracies: [0.9738219895287958, 0.6097560975609756]
2021-06-29 15:18:03.628488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 337 of 3058
2021-06-29 15:18:13.478119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3058
2021-06-29 15:18:23.519813: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1681 of 3058
2021-06-29 15:18:33.579659: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 3058
2021-06-29 15:18:43.537357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2891 of 3058
2021-06-29 15:18:46.604212: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 5 epochs
Epoch 34/65
192/192 - 126s - loss: 0.0191 - accuracy: 0.9771 - val_loss: 0.2185 - val_accuracy: 0.9414
Confusion matrix: 
 [[551  22]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.341 0.659]]
Validation f1: 60.00
Validation accuracy: 94.14
Validation recall: 65.85
Validation precision: 55.10
Validation AUC: 0.6152157037211522
Validation class accuracies: [0.9616055846422339, 0.6585365853658537]
2021-06-29 15:20:19.357135: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3058
2021-06-29 15:20:29.187355: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3058
2021-06-29 15:20:39.227066: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3058
2021-06-29 15:20:49.227564: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 3058
2021-06-29 15:20:59.316899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3019 of 3058
2021-06-29 15:20:59.945451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 35/65
192/192 - 125s - loss: 0.0154 - accuracy: 0.9797 - val_loss: 0.1890 - val_accuracy: 0.9495
Confusion matrix: 
 [[557  16]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.65
Validation accuracy: 94.95
Validation recall: 63.41
Validation precision: 61.90
Validation AUC: 0.6130575347982006
Validation class accuracies: [0.9720767888307156, 0.6341463414634146]
2021-06-29 15:22:35.766349: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3058
2021-06-29 15:22:45.738708: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 945 of 3058
2021-06-29 15:22:55.672819: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3058
2021-06-29 15:23:05.835376: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3058
2021-06-29 15:23:16.292390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:23:25.673209: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2795 of 3058
2021-06-29 15:23:32.805310: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 7 epochs
Epoch 36/65
192/192 - 143s - loss: 0.0169 - accuracy: 0.9748 - val_loss: 0.2001 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6085276303096758
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 15:25:08.816304: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 593 of 3058
2021-06-29 15:25:18.757373: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1201 of 3058
2021-06-29 15:25:28.924715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 3058
2021-06-29 15:25:39.299195: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:25:48.823357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2923 of 3058
2021-06-29 15:25:51.417437: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 8 epochs
Epoch 37/65
192/192 - 126s - loss: 0.0200 - accuracy: 0.9748 - val_loss: 0.1974 - val_accuracy: 0.9528
Confusion matrix: 
 [[558  15]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.341 0.659]]
Validation f1: 65.06
Validation accuracy: 95.28
Validation recall: 65.85
Validation precision: 64.29
Validation AUC: 0.6059529597101747
Validation class accuracies: [0.9738219895287958, 0.6585365853658537]
2021-06-29 15:27:24.977376: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3058
2021-06-29 15:27:34.825415: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3058
2021-06-29 15:27:44.837142: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3058
2021-06-29 15:27:55.058042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 3058
2021-06-29 15:28:03.131930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 38/65
192/192 - 123s - loss: 0.0155 - accuracy: 0.9745 - val_loss: 0.1916 - val_accuracy: 0.9528
Confusion matrix: 
 [[558  15]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 65.06
Validation accuracy: 95.28
Validation recall: 65.85
Validation precision: 64.29
Validation AUC: 0.614928218480057
Validation class accuracies: [0.9738219895287958, 0.6585365853658537]
2021-06-29 15:29:42.341339: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3058
2021-06-29 15:29:52.341668: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3058
2021-06-29 15:30:02.348455: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3058
2021-06-29 15:30:12.143867: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 3058
2021-06-29 15:30:18.458872: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 1 epochs
Epoch 39/65
192/192 - 118s - loss: 0.0202 - accuracy: 0.9716 - val_loss: 0.1985 - val_accuracy: 0.9528
Confusion matrix: 
 [[558  15]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 65.06
Validation accuracy: 95.28
Validation recall: 65.85
Validation precision: 64.29
Validation AUC: 0.6007645502376083
Validation class accuracies: [0.9738219895287958, 0.6585365853658537]
2021-06-29 15:31:50.110026: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 15:32:00.154643: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 3058
2021-06-29 15:32:10.197871: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2081 of 3058
2021-06-29 15:32:20.166093: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 3058
2021-06-29 15:32:26.870202: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 2 epochs
Epoch 40/65
192/192 - 121s - loss: 0.0178 - accuracy: 0.9709 - val_loss: 0.1921 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.6243899415298648
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-29 15:34:02.645963: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3058
2021-06-29 15:34:12.677544: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 945 of 3058
2021-06-29 15:34:22.735477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3058
2021-06-29 15:34:32.591238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3058
2021-06-29 15:34:43.182103: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:34:52.580920: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2795 of 3058
2021-06-29 15:34:59.841492: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 3 epochs
Epoch 41/65
192/192 - 144s - loss: 0.0176 - accuracy: 0.9778 - val_loss: 0.1865 - val_accuracy: 0.9528
Confusion matrix: 
 [[558  15]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 65.06
Validation accuracy: 95.28
Validation recall: 65.85
Validation precision: 64.29
Validation AUC: 0.6340553482595912
Validation class accuracies: [0.9738219895287958, 0.6585365853658537]
2021-06-29 15:36:36.675376: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 15:36:46.572839: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 15:36:56.656283: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 3058
2021-06-29 15:37:06.565833: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:37:16.696937: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2955 of 3058
2021-06-29 15:37:18.661009: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 4 epochs
Epoch 42/65
192/192 - 126s - loss: 0.0186 - accuracy: 0.9735 - val_loss: 0.1989 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
Validation f1: 63.41
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.6214027123687081
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-29 15:38:53.257172: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3058
2021-06-29 15:39:03.200929: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 3058
2021-06-29 15:39:13.161416: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3058
2021-06-29 15:39:23.174239: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 3058
2021-06-29 15:39:32.635696: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 5 epochs
Epoch 43/65
192/192 - 127s - loss: 0.0185 - accuracy: 0.9738 - val_loss: 0.1999 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.6104087821467375
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
2021-06-29 15:41:10.882435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3058
2021-06-29 15:41:20.829316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 3058
2021-06-29 15:41:30.978976: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3058
2021-06-29 15:41:40.912584: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 3058
2021-06-29 15:41:51.003427: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3019 of 3058
2021-06-29 15:41:51.627777: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 44/65
192/192 - 125s - loss: 0.0198 - accuracy: 0.9742 - val_loss: 0.2001 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6132705740578436
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 15:43:26.546490: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 15:43:36.513917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 3058
2021-06-29 15:43:46.519976: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 3058
2021-06-29 15:43:56.989803: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:44:06.446768: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2936 of 3058
2021-06-29 15:44:08.985933: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 7 epochs
Epoch 45/65
192/192 - 130s - loss: 0.0197 - accuracy: 0.9761 - val_loss: 0.1967 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6179888217125965
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 15:45:49.340266: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 3058
2021-06-29 15:45:59.272447: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1057 of 3058
2021-06-29 15:46:09.318128: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 3058
2021-06-29 15:46:19.483259: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3058
2021-06-29 15:46:29.559053: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 3058
2021-06-29 15:46:39.445698: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2843 of 3058
2021-06-29 15:46:44.957595: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 8 epochs
Epoch 46/65
192/192 - 139s - loss: 0.0195 - accuracy: 0.9761 - val_loss: 0.1941 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.6175974275459961
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-29 15:48:18.503247: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3058
2021-06-29 15:48:28.646677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3058
2021-06-29 15:48:38.464668: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3058
2021-06-29 15:48:48.458607: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 3058
2021-06-29 15:48:57.277898: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 9 epochs
Epoch 47/65
192/192 - 122s - loss: 0.0165 - accuracy: 0.9738 - val_loss: 0.1918 - val_accuracy: 0.9511
Confusion matrix: 
 [[557  16]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.29
Validation accuracy: 95.11
Validation recall: 65.85
Validation precision: 62.79
Validation AUC: 0.615313981659192
Validation class accuracies: [0.9720767888307156, 0.6585365853658537]
2021-06-29 15:50:29.832110: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3058
2021-06-29 15:50:39.875235: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 3058
2021-06-29 15:50:49.761654: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 3058
2021-06-29 15:50:59.894792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 3058
2021-06-29 15:51:09.898009: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3035 of 3058
2021-06-29 15:51:10.447382: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 10 epochs
Epoch 48/65
192/192 - 130s - loss: 0.0174 - accuracy: 0.9745 - val_loss: 0.1910 - val_accuracy: 0.9511
Confusion matrix: 
 [[557  16]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.341 0.659]]
Validation f1: 64.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.11
Validation recall: 65.85
Validation precision: 62.79
Validation AUC: 0.6169809054708085
Validation class accuracies: [0.9720767888307156, 0.6585365853658537]
2021-06-29 15:52:49.534507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 15:52:59.535729: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 15:53:09.685245: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3058
2021-06-29 15:53:19.859421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:53:29.757135: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2955 of 3058
2021-06-29 15:53:31.720091: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 11 epochs
Epoch 49/65
192/192 - 127s - loss: 0.0182 - accuracy: 0.9768 - val_loss: 0.1929 - val_accuracy: 0.9511
Confusion matrix: 
 [[557  16]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.341 0.659]]
Validation f1: 64.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.11
Validation recall: 65.85
Validation precision: 62.79
Validation AUC: 0.6193332427747253
Validation class accuracies: [0.9720767888307156, 0.6585365853658537]
2021-06-29 15:55:06.880620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3058
2021-06-29 15:55:16.675706: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 15:55:26.767857: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3058
2021-06-29 15:55:37.104860: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:55:46.743796: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2923 of 3058
2021-06-29 15:55:49.351263: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 50/65
192/192 - 129s - loss: 0.0188 - accuracy: 0.9784 - val_loss: 0.1916 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6205573241055837
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 15:57:28.173910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 3058
2021-06-29 15:57:38.297599: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 3058
2021-06-29 15:57:48.113789: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 3058
2021-06-29 15:57:58.136856: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3058
2021-06-29 15:58:08.531029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 15:58:18.256468: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2971 of 3058
2021-06-29 15:58:19.839483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 13 epochs
Epoch 51/65
192/192 - 135s - loss: 0.0167 - accuracy: 0.9755 - val_loss: 0.1960 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6219747736966875
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 15:59:52.372597: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 16:00:02.267928: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 3058
2021-06-29 16:00:12.429049: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3058
2021-06-29 16:00:22.261048: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 3058
2021-06-29 16:00:32.474644: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3003 of 3058
2021-06-29 16:00:33.479292: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 14 epochs
Epoch 52/65
192/192 - 125s - loss: 0.0171 - accuracy: 0.9765 - val_loss: 0.1945 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6181210908582878
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 16:02:07.974203: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 16:02:17.887060: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 3058
2021-06-29 16:02:27.966491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 3058
2021-06-29 16:02:37.854056: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 3058
2021-06-29 16:02:47.915654: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2651 of 3058
2021-06-29 16:02:58.037553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2987 of 3058
2021-06-29 16:02:59.800026: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 15 epochs
Epoch 53/65
192/192 - 138s - loss: 0.0187 - accuracy: 0.9771 - val_loss: 0.1943 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6206978747363708
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 16:04:36.638564: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 16:04:46.686109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 16:04:56.554193: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 3058
2021-06-29 16:05:06.892864: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 16:05:16.512362: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2939 of 3058
2021-06-29 16:05:18.709731: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 16 epochs
Epoch 54/65
192/192 - 125s - loss: 0.0184 - accuracy: 0.9755 - val_loss: 0.1913 - val_accuracy: 0.9511
Confusion matrix: 
 [[557  16]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.29
Validation accuracy: 95.11
Validation recall: 65.85
Validation precision: 62.79
Validation AUC: 0.6217442497621405
Validation class accuracies: [0.9720767888307156, 0.6585365853658537]
2021-06-29 16:06:51.503462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3058
2021-06-29 16:07:01.460773: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3058
2021-06-29 16:07:11.470517: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3058
2021-06-29 16:07:21.466372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 3058
2021-06-29 16:07:29.323808: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 17 epochs
Epoch 55/65
192/192 - 124s - loss: 0.0177 - accuracy: 0.9768 - val_loss: 0.1916 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6236643217708103
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 16:09:09.155273: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 3058
2021-06-29 16:09:18.952984: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3058
2021-06-29 16:09:29.165446: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3058
2021-06-29 16:09:39.042701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 3058
2021-06-29 16:09:48.908255: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 3058
2021-06-29 16:09:59.054899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2923 of 3058
2021-06-29 16:10:01.643643: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 56/65
192/192 - 137s - loss: 0.0189 - accuracy: 0.9768 - val_loss: 0.1910 - val_accuracy: 0.9511
Confusion matrix: 
 [[557  16]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.29
Validation accuracy: 95.11
Validation recall: 65.85
Validation precision: 62.79
Validation AUC: 0.623976076756158
Validation class accuracies: [0.9720767888307156, 0.6585365853658537]
2021-06-29 16:11:37.025393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3058
2021-06-29 16:11:46.895779: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 16:11:56.845568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3058
2021-06-29 16:12:07.014658: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 16:12:17.093263: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2955 of 3058
2021-06-29 16:12:19.084854: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6506024096385543 hasn't increased by 0 in 19 epochs
Epoch 57/65
192/192 - 127s - loss: 0.0156 - accuracy: 0.9814 - val_loss: 0.1932 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6246547810185837
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]

The metrics for job 0 with the best target metric are: 
Best cm: [[558  15]
 [ 14  27]]
Best normalized cm: [[0.974 0.026]
 [0.341 0.659]]
Best f1: 0.65
Best accuracy: 0.95
Best recall: 0.66
Best precision: 0.64
Best AUC: 0.61
Best class accuracies: [0.9738219895287958, 0.6585365853658537]
Best epoch: 37
The number of epochs since last 1% equals the patience
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[3.777e-05]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.036]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[6.269e-05]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[9.685e-05]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[8.304e-05]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.882]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.021]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[5.653e-05]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[2.796e-05]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[9.683e-05]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[6.675e-05]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.024]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.213]]
../../new_cache/conv__2270__06_1358__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.094]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 18730
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_135913-1js4auam/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_135913-1js4auam/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98136
wandb:         val_accuracy 0.94951
wandb:             _runtime 8070
wandb:           _timestamp 1624983223
wandb:                _step 422
wandb:           train_loss 0.0156
wandb:             val_loss 0.19319
wandb:           val_recall 0.65854
wandb:        val_precision 0.61364
wandb:               val_f1 0.63529
wandb:              val_auc 0.62465
wandb:                   lr 2e-05
wandb:          best_val_f1 0.6506
wandb:    best_val_accuracy 0.95277
wandb:   best_val_precision 0.64286
wandb:      best_val_recall 0.65854
wandb:             best_auc 0.60595
wandb:           best_epoch 37
wandb: Run history:
wandb:   train_accuracy ▁▅▅▇▇▇▇█▇██▇▇██████▇█████▇▇▇█▇▇██▇██████
wandb:     val_accuracy ▃▃▄▄▅█▄▆▂▃▆▄▆▇▄▆▇▁▇▇▆▇▇▅▇▇███▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▅▅▁▁▂▄▄▂▇▅▃▅▂▃▇▃▃█▂▃▃▂▁▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ▁▁▁▆▇▅████▇██▇█▇▇█▇███▇█▇████▇██▇███████
wandb:    val_precision ▁▁█▅▅▇▅▅▄▅▅▅▅▅▅▅▅▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_f1 ▁▁▂▇▇▇▇█▇▇█▇██▇██▇█████▇████████████████
wandb:          val_auc ▁▅█▆▆▇▆█▅▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▆▆▆▆▇▇▆▇▇▇▇▇▇▇▇▇
wandb:               lr ████████████▄▄▄▄▄▃▃▃▃▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_135913-1js4auam

-----------------------
model 9
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3058
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate_77175 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_77175[0][0]              
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-29 16:15:49.761606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 634 of 3058
2021-06-29 16:15:59.791921: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 3058
2021-06-29 16:16:09.975656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3058
2021-06-29 16:16:20.034368: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 3058
2021-06-29 16:16:29.402083: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Epoch 1/65
192/192 - 327s - loss: 0.3704 - accuracy: 0.8767 - val_loss: 0.2546 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1417016615442692
Validation class accuracies: [1.0, 0.0]
2021-06-29 16:21:31.280138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 16:21:41.131619: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 3058
2021-06-29 16:21:51.072353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 3058
2021-06-29 16:22:01.111618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 3058
2021-06-29 16:22:11.276835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2923 of 3058
2021-06-29 16:22:13.917425: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
192/192 - 332s - loss: 0.1728 - accuracy: 0.9232 - val_loss: 0.2510 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.37801047991568015
Validation class accuracies: [1.0, 0.0]
2021-06-29 16:27:17.381334: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 16:27:27.389381: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 3058
2021-06-29 16:27:37.196771: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 3058
2021-06-29 16:27:47.198752: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 3058
2021-06-29 16:27:55.089518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
192/192 - 328s - loss: 0.1854 - accuracy: 0.9215 - val_loss: 0.1857 - val_accuracy: 0.9446
Confusion matrix: 
 [[572   1]
 [ 33   8]]
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.805 0.195]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 32.00
Validation accuracy: 94.46
Validation recall: 19.51
Validation precision: 88.89
Validation AUC: 0.5020705715807114
Validation class accuracies: [0.9982547993019197, 0.1951219512195122]
2021-06-29 16:32:59.719640: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3058
2021-06-29 16:33:09.588020: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 16:33:19.699437: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3058
2021-06-29 16:33:29.855685: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 16:33:39.513038: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2939 of 3058
2021-06-29 16:33:41.800923: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
192/192 - 332s - loss: 0.1589 - accuracy: 0.9274 - val_loss: 0.2360 - val_accuracy: 0.9300
Confusion matrix: 
 [[553  20]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.561 0.439]]
Validation f1: 45.57
Validation accuracy: 93.00
Validation recall: 43.90
Validation precision: 47.37
Validation AUC: 0.4889447817787725
Validation class accuracies: [0.9650959860383944, 0.43902439024390244]
2021-06-29 16:38:45.238463: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 16:38:55.245559: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 3058
2021-06-29 16:39:05.358218: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 3058
2021-06-29 16:39:15.178794: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2644 of 3058
2021-06-29 16:39:22.804414: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
192/192 - 327s - loss: 0.1474 - accuracy: 0.9317 - val_loss: 0.6942 - val_accuracy: 0.6759
Confusion matrix: 
 [[385 188]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.672 0.328]
 [0.268 0.732]]
Validation f1: 23.17
Validation accuracy: 67.59
Validation recall: 73.17
Validation precision: 13.76
Validation AUC: 0.45361709695331504
Validation class accuracies: [0.6719022687609075, 0.7317073170731707]
2021-06-29 16:44:26.081040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 16:44:36.204450: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3058
2021-06-29 16:44:46.132346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3058
2021-06-29 16:44:56.220933: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 16:45:06.056057: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2939 of 3058
2021-06-29 16:45:08.309125: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.4556962025316456 hasn't increased by 0 in 1 epochs
Epoch 6/65
192/192 - 331s - loss: 0.1393 - accuracy: 0.9336 - val_loss: 0.3570 - val_accuracy: 0.8599
Confusion matrix: 
 [[499  74]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.293 0.707]]
Validation f1: 40.28
Validation accuracy: 85.99
Validation recall: 70.73
Validation precision: 28.16
Validation AUC: 0.5290118641114949
Validation class accuracies: [0.8708551483420593, 0.7073170731707317]
2021-06-29 16:50:11.191701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 16:50:21.125050: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 3058
2021-06-29 16:50:31.164438: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 3058
2021-06-29 16:50:41.056271: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 3058
2021-06-29 16:50:49.348898: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.4556962025316456 hasn't increased by 0 in 2 epochs
Epoch 7/65
192/192 - 327s - loss: 0.1179 - accuracy: 0.9474 - val_loss: 0.1860 - val_accuracy: 0.9528
Confusion matrix: 
 [[565   8]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.512 0.488]]
Validation f1: 57.97
Validation accuracy: 95.28
Validation recall: 48.78
Validation precision: 71.43
Validation AUC: 0.5903067333252302
Validation class accuracies: [0.9860383944153578, 0.4878048780487805]
2021-06-29 16:55:52.551232: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 16:56:02.475493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 3058
2021-06-29 16:56:12.560096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 3058
2021-06-29 16:56:22.895486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 16:56:32.488022: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2939 of 3058
2021-06-29 16:56:34.743654: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 8/65
192/192 - 331s - loss: 0.1047 - accuracy: 0.9536 - val_loss: 0.2958 - val_accuracy: 0.9088
Confusion matrix: 
 [[535  38]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.439 0.561]]
Validation f1: 45.10
Validation accuracy: 90.88
Validation recall: 56.10
Validation precision: 37.70
Validation AUC: 0.47319901885465665
Validation class accuracies: [0.9336823734729494, 0.5609756097560976]
2021-06-29 17:01:37.462908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3058
2021-06-29 17:01:47.431709: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 3058
2021-06-29 17:01:57.294398: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 3058
2021-06-29 17:02:08.015334: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 17:02:17.476004: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2923 of 3058
2021-06-29 17:02:20.139633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 1 epochs
Epoch 9/65
192/192 - 331s - loss: 0.1187 - accuracy: 0.9431 - val_loss: 0.2288 - val_accuracy: 0.9235
Confusion matrix: 
 [[540  33]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.341 0.659]]
Validation f1: 53.47
Validation accuracy: 92.35
Validation recall: 65.85
Validation precision: 45.00
Validation AUC: 0.5719546266643266
Validation class accuracies: [0.9424083769633508, 0.6585365853658537]
2021-06-29 17:07:22.154777: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3058
2021-06-29 17:07:32.115367: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 3058
2021-06-29 17:07:42.147775: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 3058
2021-06-29 17:07:52.095256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2667 of 3058
2021-06-29 17:07:59.222613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 2 epochs
Epoch 10/65
192/192 - 326s - loss: 0.1019 - accuracy: 0.9496 - val_loss: 0.3086 - val_accuracy: 0.9039
Confusion matrix: 
 [[548  25]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.829 0.171]]
Validation f1: 19.18
Validation accuracy: 90.39
Validation recall: 17.07
Validation precision: 21.88
Validation AUC: 0.2369466739857756
Validation class accuracies: [0.956369982547993, 0.17073170731707318]
2021-06-29 17:13:01.903288: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3058
2021-06-29 17:13:12.054075: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 3058
2021-06-29 17:13:21.991759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 3058
2021-06-29 17:13:31.959235: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 3058
2021-06-29 17:13:41.955129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3019 of 3058
2021-06-29 17:13:42.696028: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 3 epochs
Epoch 11/65
192/192 - 330s - loss: 0.0849 - accuracy: 0.9559 - val_loss: 0.2838 - val_accuracy: 0.9104
Confusion matrix: 
 [[535  38]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.415 0.585]]
Validation f1: 46.60
Validation accuracy: 91.04
Validation recall: 58.54
Validation precision: 38.71
Validation AUC: 0.5682593274421399
Validation class accuracies: [0.9336823734729494, 0.5853658536585366]
2021-06-29 17:18:45.657348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3058
2021-06-29 17:18:55.583455: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3058
2021-06-29 17:19:05.702572: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3058
2021-06-29 17:19:15.562014: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 3058
2021-06-29 17:19:23.961956: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 4 epochs
Epoch 12/65
192/192 - 328s - loss: 0.0954 - accuracy: 0.9542 - val_loss: 0.4227 - val_accuracy: 0.8893
Confusion matrix: 
 [[523  50]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.439 0.561]]
Validation f1: 40.35
Validation accuracy: 88.93
Validation recall: 56.10
Validation precision: 31.51
Validation AUC: 0.45601340440785665
Validation class accuracies: [0.912739965095986, 0.5609756097560976]
2021-06-29 17:24:27.819581: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3058
2021-06-29 17:24:37.864538: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 3058
2021-06-29 17:24:47.808439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3058
2021-06-29 17:24:57.896018: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 3058
2021-06-29 17:25:07.765872: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2827 of 3058
2021-06-29 17:25:13.854632: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 5 epochs
Epoch 13/65
192/192 - 336s - loss: 0.0880 - accuracy: 0.9614 - val_loss: 0.5159 - val_accuracy: 0.8844
Confusion matrix: 
 [[519  54]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.415 0.585]]
Validation f1: 40.34
Validation accuracy: 88.44
Validation recall: 58.54
Validation precision: 30.77
Validation AUC: 0.4706092375988301
Validation class accuracies: [0.9057591623036649, 0.5853658536585366]
2021-06-29 17:30:18.556387: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 3058
2021-06-29 17:30:28.565523: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3058
2021-06-29 17:30:38.445213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3058
2021-06-29 17:30:48.357452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3058
2021-06-29 17:30:58.551719: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 3058
2021-06-29 17:31:08.259978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2813 of 3058
2021-06-29 17:31:15.122238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 14/65
192/192 - 348s - loss: 0.0732 - accuracy: 0.9624 - val_loss: 0.2897 - val_accuracy: 0.9137
Confusion matrix: 
 [[537  36]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.415 0.585]]
Validation f1: 47.52
Validation accuracy: 91.37
Validation recall: 58.54
Validation precision: 40.00
Validation AUC: 0.5126188797073024
Validation class accuracies: [0.93717277486911, 0.5853658536585366]
2021-06-29 17:36:21.953977: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 3058
2021-06-29 17:36:32.079677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 3058
2021-06-29 17:36:42.141542: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 3058
2021-06-29 17:36:52.114874: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3058
2021-06-29 17:37:01.902551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2652 of 3058
2021-06-29 17:37:11.881654: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3014 of 3058
2021-06-29 17:37:13.471113: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 7 epochs
Epoch 15/65
192/192 - 345s - loss: 0.0572 - accuracy: 0.9686 - val_loss: 0.2577 - val_accuracy: 0.9251
Confusion matrix: 
 [[544  29]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.415 0.585]]
Validation f1: 51.06
Validation accuracy: 92.51
Validation recall: 58.54
Validation precision: 45.28
Validation AUC: 0.4697366289464636
Validation class accuracies: [0.9493891797556719, 0.5853658536585366]
2021-06-29 17:42:21.843437: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 3058
2021-06-29 17:42:31.724725: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3058
2021-06-29 17:42:41.760959: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3058
2021-06-29 17:42:51.692162: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3058
2021-06-29 17:43:01.807435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 3058
2021-06-29 17:43:11.677375: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2811 of 3058
2021-06-29 17:43:16.678353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 8 epochs
Epoch 16/65
192/192 - 347s - loss: 0.0566 - accuracy: 0.9653 - val_loss: 0.3114 - val_accuracy: 0.9202
Confusion matrix: 
 [[541  32]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.415 0.585]]
Validation f1: 49.48
Validation accuracy: 92.02
Validation recall: 58.54
Validation precision: 42.86
Validation AUC: 0.4838009244343055
Validation class accuracies: [0.944153577661431, 0.5853658536585366]
2021-06-29 17:48:24.691478: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 3058
2021-06-29 17:48:35.049573: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 929 of 3058
2021-06-29 17:48:44.818173: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 3058
2021-06-29 17:48:54.684949: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3058
2021-06-29 17:49:04.575067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 3058
2021-06-29 17:49:14.767799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3003 of 3058
2021-06-29 17:49:15.759205: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 9 epochs
Epoch 17/65
192/192 - 343s - loss: 0.0530 - accuracy: 0.9621 - val_loss: 0.3631 - val_accuracy: 0.9039
Confusion matrix: 
 [[531  42]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.415 0.585]]
Validation f1: 44.86
Validation accuracy: 90.39
Validation recall: 58.54
Validation precision: 36.36
Validation AUC: 0.4201012282057991
Validation class accuracies: [0.9267015706806283, 0.5853658536585366]
2021-06-29 17:54:23.600713: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3058
2021-06-29 17:54:33.660110: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3058
2021-06-29 17:54:43.541308: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 3058
2021-06-29 17:54:53.487745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 3058
2021-06-29 17:55:02.170616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
local_gc_exec.sh: line 6: 18690 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2270__06_1358__v39__mixup/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 12 leaked semaphores to clean up at shutdown
  len(cache))
