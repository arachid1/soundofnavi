Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2247
Description:  icbhi_pneumoniajordan_seaprated
2021-06-23 21:35:42.871810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-23 21:35:45.507857: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 21:35:45.508958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-23 21:35:45.561732: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:45.562551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 21:35:45.562586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 21:35:45.566594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 21:35:45.566719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 21:35:45.567924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 21:35:45.568241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 21:35:45.569337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 21:35:45.570295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 21:35:45.570464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 21:35:45.570615: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:45.571515: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:45.572252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2247.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 0, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-23 21:35:50.844872: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 21:35:50.845195: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:50.846007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 21:35:50.846055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 21:35:50.846118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 21:35:50.846141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 21:35:50.846162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 21:35:50.846183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 21:35:50.846203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 21:35:50.846223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 21:35:50.846263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 21:35:50.846356: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:50.847215: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:50.847949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-23 21:35:50.848004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 21:35:51.628885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-23 21:35:51.628936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-23 21:35:51.628946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-23 21:35:51.629287: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:51.630189: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:51.631017: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 21:35:51.631772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 937
-----------------------
Number of train recordings: 3208 with pneumonia: 162 and non-pneumonia: 3046
Length of training samples after audio augmentation: 3370
-----------------------
Number of train recordings: 3370 with pneumonia: 324 and non-pneumonia: 3046
Length of training samples after audio augmentation: 3970
-----------------------
Number of train recordings: 3970 with pneumonia: 324 and non-pneumonia: 3646
Number of val recordings: 801 with pneumonia: 37 and non-pneumonia: 764
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-23 21:35:53.156814: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-23 21:35:53.158801: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-23 21:35:53.524317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 21:35:55.566269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 21:35:56.096833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
249/249 - 384s - loss: 1.1013 - accuracy: 0.4713 - val_loss: 0.2802 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06074275375122446
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
249/249 - 378s - loss: 0.7173 - accuracy: 0.5373 - val_loss: 0.4461 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.052221317045568205
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
249/249 - 378s - loss: 0.6774 - accuracy: 0.5693 - val_loss: 0.6288 - val_accuracy: 0.5830
Confusion matrix: 
 [[436 328]
 [  6  31]]
Normalized Confusion matrix: 
 [[0.571 0.429]
 [0.162 0.838]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 15.66
Validation accuracy: 58.30
Validation recall: 83.78
Validation precision: 8.64
Validation AUC: 0.5156155528475831
Validation class accuracies: [0.5706806282722513, 0.8378378378378378]
Saving model...
Epoch 4/65
249/249 - 378s - loss: 0.6212 - accuracy: 0.6310 - val_loss: 0.6666 - val_accuracy: 0.6305
Confusion matrix: 
 [[474 290]
 [  6  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.62  0.38 ]
 [0.162 0.838]]
Validation f1: 17.32
Validation accuracy: 63.05
Validation recall: 83.78
Validation precision: 9.66
Validation AUC: 0.4028008597804863
Validation class accuracies: [0.6204188481675392, 0.8378378378378378]
Saving model...
Epoch 5/65
249/249 - 377s - loss: 0.5327 - accuracy: 0.6778 - val_loss: 0.3467 - val_accuracy: 0.8777
Confusion matrix: 
 [[686  78]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.898 0.102]
 [0.541 0.459]]
Validation f1: 25.76
Validation accuracy: 87.77
Validation recall: 45.95
Validation precision: 17.89
Validation AUC: 0.39512992238076466
Validation class accuracies: [0.8979057591623036, 0.4594594594594595]
Saving model...
Epoch 6/65
249/249 - 378s - loss: 0.4853 - accuracy: 0.7383 - val_loss: 0.2690 - val_accuracy: 0.9126
Confusion matrix: 
 [[708  56]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.378 0.622]]
Validation f1: 39.66
Validation accuracy: 91.26
Validation recall: 62.16
Validation precision: 29.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation AUC: 0.5575346263887445
Validation class accuracies: [0.9267015706806283, 0.6216216216216216]
Saving model...
Epoch 7/65
249/249 - 378s - loss: 0.4835 - accuracy: 0.7277 - val_loss: 1.3400 - val_accuracy: 0.4669
Confusion matrix: 
 [[341 423]
 [  4  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.446 0.554]
 [0.108 0.892]]
Validation f1: 13.39
Validation accuracy: 46.69
Validation recall: 89.19
Validation precision: 7.24
Validation AUC: 0.411930569555023
Validation class accuracies: [0.4463350785340314, 0.8918918918918919]
The validation tracker metric at 0.396551724137931 hasn't increased by 0 in 1 epochs
Epoch 8/65
249/249 - 378s - loss: 0.3800 - accuracy: 0.7899 - val_loss: 3.4911 - val_accuracy: 0.2434
Confusion matrix: 
 [[160 604]
 [  2  35]]
Normalized Confusion matrix: 
 [[0.209 0.791]
 [0.054 0.946]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.36
Validation accuracy: 24.34
Validation recall: 94.59
Validation precision: 5.48
Validation AUC: 0.04387072828521815
Validation class accuracies: [0.2094240837696335, 0.9459459459459459]
The validation tracker metric at 0.396551724137931 hasn't increased by 0 in 2 epochs
Epoch 9/65
249/249 - 377s - loss: 0.3413 - accuracy: 0.8189 - val_loss: 0.7612 - val_accuracy: 0.6979
Confusion matrix: 
 [[527 237]
 [  5  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.69  0.31 ]
 [0.135 0.865]]
Validation f1: 20.92
Validation accuracy: 69.79
Validation recall: 86.49
Validation precision: 11.90
Validation AUC: 0.3573818293374891
Validation class accuracies: [0.6897905759162304, 0.8648648648648649]
The validation tracker metric at 0.396551724137931 hasn't increased by 0 in 3 epochs
Epoch 10/65
249/249 - 376s - loss: 0.3216 - accuracy: 0.8403 - val_loss: 0.2224 - val_accuracy: 0.9426
Confusion matrix: 
 [[743  21]
 [ 25  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.973 0.027]
 [0.676 0.324]]
Validation f1: 34.29
Validation accuracy: 94.26
Validation recall: 32.43
Validation precision: 36.36
Validation AUC: 0.24657884658336776
Validation class accuracies: [0.9725130890052356, 0.32432432432432434]
The validation tracker metric at 0.396551724137931 hasn't increased by 0 in 4 epochs
Epoch 11/65
249/249 - 375s - loss: 0.2666 - accuracy: 0.8627 - val_loss: 0.4458 - val_accuracy: 0.8489
Confusion matrix: 
 [[658 106]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.861 0.139]
 [0.405 0.595]]
Validation f1: 26.67
Validation accuracy: 84.89
Validation recall: 59.46
Validation precision: 17.19
Validation AUC: 0.37405665610580857
Validation class accuracies: [0.8612565445026178, 0.5945945945945946]
The validation tracker metric at 0.396551724137931 hasn't increased by 0 in 5 epochs
Epoch 12/65
249/249 - 376s - loss: 0.2656 - accuracy: 0.8746 - val_loss: 1.4584 - val_accuracy: 0.5843
Confusion matrix: 
 [[437 327]
 [  6  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.572 0.428]
 [0.162 0.838]]
Validation f1: 15.70
Validation accuracy: 58.43
Validation recall: 83.78
Validation precision: 8.66
Validation AUC: 0.5181132697797416
Validation class accuracies: [0.5719895287958116, 0.8378378378378378]
The validation tracker metric at 0.396551724137931 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
249/249 - 375s - loss: 0.1928 - accuracy: 0.9010 - val_loss: 0.4241 - val_accuracy: 0.8614
Confusion matrix: 
 [[669  95]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.432 0.568]]
Validation f1: 27.45
Validation accuracy: 86.14
Validation recall: 56.76
Validation precision: 18.10
Validation AUC: 0.49370025419227137
Validation class accuracies: [0.8756544502617801, 0.5675675675675675]
The validation tracker metric at 0.396551724137931 hasn't increased by 0 in 7 epochs
Epoch 14/65
249/249 - 375s - loss: 0.1585 - accuracy: 0.9146 - val_loss: 0.2165 - val_accuracy: 0.9263
Confusion matrix: 
 [[721  43]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.432 0.568]]
Validation f1: 41.58
Validation accuracy: 92.63
Validation recall: 56.76
Validation precision: 32.81
Validation AUC: 0.5598209425870734
Validation class accuracies: [0.943717277486911, 0.5675675675675675]
Saving model...
Epoch 15/65
249/249 - 376s - loss: 0.1226 - accuracy: 0.9406 - val_loss: 0.3033 - val_accuracy: 0.9114
Confusion matrix: 
 [[709  55]
 [ 16  21]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.432 0.568]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.17
Validation accuracy: 91.14
Validation recall: 56.76
Validation precision: 27.63
Validation AUC: 0.5324753123616703
Validation class accuracies: [0.9280104712041884, 0.5675675675675675]
The validation tracker metric at 0.4158415841584159 hasn't increased by 0 in 1 epochs
Epoch 16/65
249/249 - 376s - loss: 0.1531 - accuracy: 0.9247 - val_loss: 1.5931 - val_accuracy: 0.5231
Confusion matrix: 
 [[385 379]
 [  3  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.504 0.496]
 [0.081 0.919]]
Validation f1: 15.11
Validation accuracy: 52.31
Validation recall: 91.89
Validation precision: 8.23
Validation AUC: 0.4995298219210585
Validation class accuracies: [0.5039267015706806, 0.918918918918919]
The validation tracker metric at 0.4158415841584159 hasn't increased by 0 in 2 epochs
Epoch 17/65
249/249 - 377s - loss: 0.0865 - accuracy: 0.9569 - val_loss: 0.3016 - val_accuracy: 0.8964
Confusion matrix: 
 [[696  68]
 [ 15  22]]
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.405 0.595]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.65
Validation accuracy: 89.64
Validation recall: 59.46
Validation precision: 24.44
Validation AUC: 0.46257825335564423
Validation class accuracies: [0.9109947643979057, 0.5945945945945946]
The validation tracker metric at 0.4158415841584159 hasn't increased by 0 in 3 epochs
Epoch 18/65
249/249 - 375s - loss: 0.1160 - accuracy: 0.9476 - val_loss: 0.1580 - val_accuracy: 0.9563
Confusion matrix: 
 [[757   7]
 [ 28   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.757 0.243]]
Validation f1: 33.96
Validation accuracy: 95.63
Validation recall: 24.32
Validation precision: 56.25
Validation AUC: 0.4301096007753264
Validation class accuracies: [0.9908376963350786, 0.24324324324324326]
The validation tracker metric at 0.4158415841584159 hasn't increased by 0 in 4 epochs
Epoch 19/65
249/249 - 376s - loss: 0.1715 - accuracy: 0.9224 - val_loss: 0.4390 - val_accuracy: 0.8552
Confusion matrix: 
 [[662 102]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.866 0.134]
 [0.378 0.622]]
Validation f1: 28.40
Validation accuracy: 85.52
Validation recall: 62.16
Validation precision: 18.40
Validation AUC: 0.49882119140406694
Validation class accuracies: [0.8664921465968587, 0.6216216216216216]
The validation tracker metric at 0.4158415841584159 hasn't increased by 0 in 5 epochs
Epoch 20/65
249/249 - 375s - loss: 0.0767 - accuracy: 0.9622 - val_loss: 0.2016 - val_accuracy: 0.9338
Confusion matrix: 
 [[728  36]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.459 0.541]]
Validation f1: 43.01
Validation accuracy: 93.38
Validation recall: 54.05
Validation precision: 35.71
Validation AUC: 0.4795583783166191
Validation class accuracies: [0.9528795811518325, 0.5405405405405406]
Saving model...
Epoch 21/65
249/249 - 376s - loss: 0.0772 - accuracy: 0.9635 - val_loss: 0.2746 - val_accuracy: 0.9189
Confusion matrix: 
 [[721  43]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.595 0.405]]
Validation f1: 31.58
Validation accuracy: 91.89
Validation recall: 40.54
Validation precision: 25.86
Validation AUC: 0.42994671202568324
Validation class accuracies: [0.943717277486911, 0.40540540540540543]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 1 epochs
Epoch 22/65
249/249 - 376s - loss: 0.1744 - accuracy: 0.9207 - val_loss: 0.2248 - val_accuracy: 0.9251
Confusion matrix: 
 [[720  44]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.432 0.568]]
Validation f1: 41.18
Validation accuracy: 92.51
Validation recall: 56.76
Validation precision: 32.31
Validation AUC: 0.5354732019984991
Validation class accuracies: [0.9424083769633508, 0.5675675675675675]
The validation tracker metric at 0.4301075268817204 hasn't increased by 0 in 2 epochs
Epoch 23/65
249/249 - 376s - loss: 0.0792 - accuracy: 0.9562 - val_loss: 0.1933 - val_accuracy: 0.9463
Confusion matrix: 
 [[738  26]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.966 0.034]
 [0.459 0.541]]
Validation f1: 48.19
Validation accuracy: 94.63
Validation recall: 54.05
Validation precision: 43.48
Validation AUC: 0.5341417365008926
Validation class accuracies: [0.9659685863874345, 0.5405405405405406]
Saving model...
Epoch 24/65
249/249 - 375s - loss: 0.0508 - accuracy: 0.9776 - val_loss: 0.1986 - val_accuracy: 0.9376
Confusion matrix: 
 [[728  36]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.378 0.622]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.92
Validation accuracy: 93.76
Validation recall: 62.16
Validation precision: 38.98
Validation AUC: 0.5514917332682098
Validation class accuracies: [0.9528795811518325, 0.6216216216216216]
The validation tracker metric at 0.4819277108433735 hasn't increased by 0 in 1 epochs
Epoch 25/65
249/249 - 376s - loss: 0.0486 - accuracy: 0.9796 - val_loss: 0.1447 - val_accuracy: 0.9625
Confusion matrix: 
 [[749  15]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.405 0.595]]
Validation f1: 59.46
Validation accuracy: 96.25
Validation recall: 59.46
Validation precision: 59.46
Validation AUC: 0.5887812249513311
Validation class accuracies: [0.9803664921465969, 0.5945945945945946]
Saving model...
Epoch 26/65
249/249 - 376s - loss: 0.0507 - accuracy: 0.9776 - val_loss: 0.2925 - val_accuracy: 0.9076
Confusion matrix: 
 [[704  60]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.378 0.622]]
Validation f1: 38.33
Validation accuracy: 90.76
Validation recall: 62.16
Validation precision: 27.71
Validation AUC: 0.5611716748808859
Validation class accuracies: [0.9214659685863874, 0.6216216216216216]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 1 epochs
Epoch 27/65
249/249 - 376s - loss: 0.0303 - accuracy: 0.9869 - val_loss: 0.2425 - val_accuracy: 0.9238
Confusion matrix: 
 [[722  42]
 [ 19  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.945 0.055]
 [0.514 0.486]]
Validation f1: 37.11
Validation accuracy: 92.38
Validation recall: 48.65
Validation precision: 30.00
Validation AUC: 0.4412059265133193
Validation class accuracies: [0.9450261780104712, 0.4864864864864865]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 2 epochs
Epoch 28/65
249/249 - 375s - loss: 0.0256 - accuracy: 0.9897 - val_loss: 0.1866 - val_accuracy: 0.9551
Confusion matrix: 
 [[747  17]
 [ 19  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.978 0.022]
 [0.514 0.486]]
Validation f1: 50.00
Validation accuracy: 95.51
Validation recall: 48.65
Validation precision: 51.43
Validation AUC: 0.5281655810853292
Validation class accuracies: [0.9777486910994765, 0.4864864864864865]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 3 epochs
Epoch 29/65
249/249 - 375s - loss: 0.0377 - accuracy: 0.9851 - val_loss: 0.1989 - val_accuracy: 0.9501
Confusion matrix: 
 [[745  19]
 [ 21  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.975 0.025]
 [0.568 0.432]]
Validation f1: 44.44
Validation accuracy: 95.01
Validation recall: 43.24
Validation precision: 45.71
Validation AUC: 0.48947971286477077
Validation class accuracies: [0.975130890052356, 0.43243243243243246]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 4 epochs
Epoch 30/65
249/249 - 375s - loss: 0.0319 - accuracy: 0.9866 - val_loss: 0.2379 - val_accuracy: 0.9413
Confusion matrix: 
 [[738  26]
 [ 21  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.966 0.034]
 [0.568 0.432]]
Validation f1: 40.51
Validation accuracy: 94.13
Validation recall: 43.24
Validation precision: 38.10
Validation AUC: 0.4631779815474928
Validation class accuracies: [0.9659685863874345, 0.43243243243243246]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 5 epochs
Epoch 31/65
249/249 - 375s - loss: 0.0383 - accuracy: 0.9831 - val_loss: 0.3478 - val_accuracy: 0.9189
Confusion matrix: 
 [[716  48]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.10
Validation accuracy: 91.89
Validation recall: 54.05
Validation precision: 29.41
Validation AUC: 0.48093112281313083
Validation class accuracies: [0.93717277486911, 0.5405405405405406]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 32/65
249/249 - 376s - loss: 0.0319 - accuracy: 0.9864 - val_loss: 0.2351 - val_accuracy: 0.9451
Confusion matrix: 
 [[741  23]
 [ 21  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.568 0.432]]
Validation f1: 42.11
Validation accuracy: 94.51
Validation recall: 43.24
Validation precision: 41.03
Validation AUC: 0.43499124216286095
Validation class accuracies: [0.9698952879581152, 0.43243243243243246]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 7 epochs
Epoch 33/65
249/249 - 376s - loss: 0.0262 - accuracy: 0.9899 - val_loss: 0.2327 - val_accuracy: 0.9476
Confusion matrix: 
 [[741  23]
 [ 19  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.514 0.486]]
Validation f1: 46.15
Validation accuracy: 94.76
Validation recall: 48.65
Validation precision: 43.90
Validation AUC: 0.4734605887155547
Validation class accuracies: [0.9698952879581152, 0.4864864864864865]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 8 epochs
Epoch 34/65
249/249 - 376s - loss: 0.0146 - accuracy: 0.9965 - val_loss: 0.2339 - val_accuracy: 0.9413
Confusion matrix: 
 [[739  25]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.595 0.405]]
Validation f1: 38.96
Validation accuracy: 94.13
Validation recall: 40.54
Validation precision: 37.50
Validation AUC: 0.4372956994167898
Validation class accuracies: [0.9672774869109948, 0.40540540540540543]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 9 epochs
Epoch 35/65
249/249 - 376s - loss: 0.0196 - accuracy: 0.9927 - val_loss: 0.2323 - val_accuracy: 0.9463
Confusion matrix: 
 [[741  23]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.541 0.459]]
Validation f1: 44.16
Validation accuracy: 94.63
Validation recall: 45.95
Validation precision: 42.50
Validation AUC: 0.4878203012683819
Validation class accuracies: [0.9698952879581152, 0.4594594594594595]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 10 epochs
Epoch 36/65
249/249 - 376s - loss: 0.0124 - accuracy: 0.9980 - val_loss: 0.2443 - val_accuracy: 0.9451
Confusion matrix: 
 [[740  24]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.541 0.459]]
Validation f1: 43.59
Validation accuracy: 94.51
Validation recall: 45.95
Validation precision: 41.46
Validation AUC: 0.495294343901546
Validation class accuracies: [0.9685863874345549, 0.4594594594594595]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 11 epochs
Epoch 37/65
249/249 - 376s - loss: 0.0093 - accuracy: 0.9972 - val_loss: 0.2409 - val_accuracy: 0.9476
Confusion matrix: 
 [[742  22]
 [ 20  17]]
Normalized Confusion matrix: 
 [[0.971 0.029]
 [0.541 0.459]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.74
Validation accuracy: 94.76
Validation recall: 45.95
Validation precision: 43.59
Validation AUC: 0.4939441639243284
Validation class accuracies: [0.9712041884816754, 0.4594594594594595]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 38/65
249/249 - 376s - loss: 0.0092 - accuracy: 0.9982 - val_loss: 0.2742 - val_accuracy: 0.9401
Confusion matrix: 
 [[734  30]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.486 0.514]]
Validation f1: 44.19
Validation accuracy: 94.01
Validation recall: 51.35
Validation precision: 38.78
Validation AUC: 0.5366267015089404
Validation class accuracies: [0.9607329842931938, 0.5135135135135135]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 13 epochs
Epoch 39/65
249/249 - 375s - loss: 0.0104 - accuracy: 0.9975 - val_loss: 0.2608 - val_accuracy: 0.9476
Confusion matrix: 
 [[742  22]
 [ 20  17]]
Normalized Confusion matrix: 
 [[0.971 0.029]
 [0.541 0.459]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.74
Validation accuracy: 94.76
Validation recall: 45.95
Validation precision: 43.59
Validation AUC: 0.46850013308345684
Validation class accuracies: [0.9712041884816754, 0.4594594594594595]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 14 epochs
Epoch 40/65
249/249 - 377s - loss: 0.0133 - accuracy: 0.9957 - val_loss: 0.2767 - val_accuracy: 0.9438
Confusion matrix: 
 [[736  28]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.459 0.541]]
Validation f1: 47.06
Validation accuracy: 94.38
Validation recall: 54.05
Validation precision: 41.67
Validation AUC: 0.52630015045324
Validation class accuracies: [0.9633507853403142, 0.5405405405405406]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 15 epochs
Epoch 41/65
249/249 - 376s - loss: 0.0071 - accuracy: 0.9985 - val_loss: 0.2443 - val_accuracy: 0.9488
Confusion matrix: 
 [[742  22]
 [ 19  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.971 0.029]
 [0.514 0.486]]
Validation f1: 46.75
Validation accuracy: 94.88
Validation recall: 48.65
Validation precision: 45.00
Validation AUC: 0.5024414280170629
Validation class accuracies: [0.9712041884816754, 0.4864864864864865]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 16 epochs
Epoch 42/65
249/249 - 376s - loss: 0.0092 - accuracy: 0.9985 - val_loss: 0.2932 - val_accuracy: 0.9376
Confusion matrix: 
 [[732  32]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.486 0.514]]
Validation f1: 43.18
Validation accuracy: 93.76
Validation recall: 51.35
Validation precision: 37.25
Validation AUC: 0.5163849522205708
Validation class accuracies: [0.9581151832460733, 0.5135135135135135]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 17 epochs
Epoch 43/65
249/249 - 376s - loss: 0.0084 - accuracy: 0.9975 - val_loss: 0.2866 - val_accuracy: 0.9388
Confusion matrix: 
 [[733  31]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.959 0.041]
 [0.486 0.514]]
Validation f1: 43.68
Validation accuracy: 93.88
Validation recall: 51.35
Validation precision: 38.00
Validation AUC: 0.5007352518108246
Validation class accuracies: [0.9594240837696335, 0.5135135135135135]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 44/65
249/249 - 376s - loss: 0.0056 - accuracy: 0.9990 - val_loss: 0.2599 - val_accuracy: 0.9426
Confusion matrix: 
 [[736  28]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.486 0.514]]
Validation f1: 45.24
Validation accuracy: 94.26
Validation recall: 51.35
Validation precision: 40.43
Validation AUC: 0.5067731889284636
Validation class accuracies: [0.9633507853403142, 0.5135135135135135]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 19 epochs
Epoch 45/65
249/249 - 376s - loss: 0.0073 - accuracy: 0.9982 - val_loss: 0.2774 - val_accuracy: 0.9376
Confusion matrix: 
 [[734  30]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.541 0.459]]
Validation f1: 40.48
Validation accuracy: 93.76
Validation recall: 45.95
Validation precision: 36.17
Validation AUC: 0.4821340150544895
Validation class accuracies: [0.9607329842931938, 0.4594594594594595]

The metrics for job 0 with the best target metric are: 
Best cm: [[749  15]
 [ 15  22]]
Best normalized cm: [[0.98  0.02 ]
 [0.405 0.595]]
Best f1: 0.59
Best accuracy: 0.96
Best recall: 0.59
Best precision: 0.59
Best AUC: 0.59
Best class accuracies: [0.9803664921465969, 0.5945945945945946]
Best epoch: 25
The number of epochs since last 1% equals the patience
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_4b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[5.679e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP6_Plueral Effusion,I C B,P L R,81,M_3_label_0_pred_0.png, [[0.051]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP78_Asthma,E W,P R M,20,M_2_label_0_pred_0.png, [[6.361e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_204_7p5_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[3.25e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_2b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[2.97e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP82_N,N,P L U,38,M_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Al_sc_Meditron_12_label_0_pred_0.png, [[6.783e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_204_2b5_Ar_mc_AKGC417L_1_label_0_pred_1.png, [[0.73]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_223_1b1_Al_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_222_1b1_Ar_sc_Meditron_9_label_0_pred_0.png, [[1.905e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP47_asthma,E W,P L M,60,M_0_label_0_pred_0.png, [[1.523e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_3b4_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_223_1b1_Pl_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_1.png, [[0.687]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b2_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.023]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_208_1b1_Ll_sc_Meditron_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_219_2b2_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_2b3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1p1_Pr_sc_Litt3200_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_223_1b1_Ll_sc_Meditron_5_label_0_pred_0.png, [[0.055]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Ar_sc_Meditron_4_label_0_pred_0.png, [[1.364e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP80_asthma,E W,A L U,38,M_2_label_0_pred_0.png, [[4.534e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_221_2b2_Al_mc_LittC2SE_0_label_0_pred_1.png, [[0.775]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_204_7p5_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[8.097e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP4_Heart Failure + Lung Fibrosis ,I C,P L R,72,F_1_label_0_pred_0.png, [[0.043]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_1b3_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[3.385e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_2p2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[3.258e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.19]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP79_asthma,E W,A R U,46,M_0_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_213_1p5_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.011]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_1b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_225_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[2.281e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP94_N,N,P L L,24,M_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_205_1b3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.048e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_210_1b1_Al_sc_Meditron_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Pl_sc_Meditron_7_label_0_pred_0.png, [[3.784e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/jordan_EP66_heart failure,Crep,P R L ,43,M_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_211_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[7.851e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/0/icbhi_218_1b1_Pr_sc_Meditron_4_label_0_pred_0.png, [[0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 20438
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_213545-v0pae1w8/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_213545-v0pae1w8/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99824
wandb:         val_accuracy 0.93758
wandb:             _runtime 17814
wandb:           _timestamp 1624501960
wandb:                _step 338
wandb:           train_loss 0.0073
wandb:             val_loss 0.27738
wandb:           val_recall 0.45946
wandb:        val_precision 0.3617
wandb:               val_f1 0.40476
wandb:              val_auc 0.48213
wandb:                   lr 6e-05
wandb:          best_val_f1 0.59459
wandb:    best_val_accuracy 0.96255
wandb:   best_val_precision 0.59459
wandb:      best_val_recall 0.59459
wandb:             best_auc 0.58878
wandb:           best_epoch 25
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_213545-v0pae1w8

-----------------------
Changing augmentation to v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 937
-----------------------
Number of train recordings: 3208 with pneumonia: 162 and non-pneumonia: 3046
Length of training samples after audio augmentation: 3370
-----------------------
Number of train recordings: 3370 with pneumonia: 324 and non-pneumonia: 3046
Length of training samples after audio augmentation: 3970
-----------------------
Number of train recordings: 3970 with pneumonia: 324 and non-pneumonia: 3646
Number of val recordings: 801 with pneumonia: 37 and non-pneumonia: 764
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 64, 625, 48)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 64, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 32, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 16, 156, 128)    91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 8, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 4, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
249/249 - 377s - loss: 1.2147 - accuracy: 0.5307 - val_loss: 0.4506 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06098596491542818
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
249/249 - 377s - loss: 0.6512 - accuracy: 0.6174 - val_loss: 0.1941 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12037451778456693
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
249/249 - 376s - loss: 0.5567 - accuracy: 0.7272 - val_loss: 0.5757 - val_accuracy: 0.7066
Confusion matrix: 
 [[542 222]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.709 0.291]
 [0.351 0.649]]
Validation f1: 16.96
Validation accuracy: 70.66
Validation recall: 64.86
Validation precision: 9.76
Validation AUC: 0.4382500788643682
Validation class accuracies: [0.7094240837696335, 0.6486486486486487]
Saving model...
Epoch 4/65
249/249 - 376s - loss: 0.4491 - accuracy: 0.7786 - val_loss: 0.9349 - val_accuracy: 0.7416
Confusion matrix: 
 [[570 194]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.746 0.254]
 [0.351 0.649]]
Validation f1: 18.82
Validation accuracy: 74.16
Validation recall: 64.86
Validation precision: 11.01
Validation AUC: 0.3077617906901964
Validation class accuracies: [0.7460732984293194, 0.6486486486486487]
Saving model...
Epoch 5/65
249/249 - 376s - loss: 0.3699 - accuracy: 0.8098 - val_loss: 0.2995 - val_accuracy: 0.9189
Confusion matrix: 
 [[715  49]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.936 0.064]
 [0.432 0.568]]
Validation f1: 39.25
Validation accuracy: 91.89
Validation recall: 56.76
Validation precision: 30.00
Validation AUC: 0.5466123967690645
Validation class accuracies: [0.9358638743455497, 0.5675675675675675]
Saving model...
Epoch 6/65
249/249 - 376s - loss: 0.3658 - accuracy: 0.8237 - val_loss: 0.3870 - val_accuracy: 0.8789
Confusion matrix: 
 [[683  81]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.432 0.568]]
Validation f1: 30.22
Validation accuracy: 87.89
Validation recall: 56.76
Validation precision: 20.59
Validation AUC: 0.42136145275867404
Validation class accuracies: [0.893979057591623, 0.5675675675675675]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 1 epochs
Epoch 7/65
249/249 - 376s - loss: 0.3271 - accuracy: 0.8300 - val_loss: 0.1890 - val_accuracy: 0.9576
Confusion matrix: 
 [[761   3]
 [ 31   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.996 0.004]
 [0.838 0.162]]
Validation f1: 26.09
Validation accuracy: 95.76
Validation recall: 16.22
Validation precision: 66.67
Validation AUC: 0.2669648217896029
Validation class accuracies: [0.9960732984293194, 0.16216216216216217]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 2 epochs
Epoch 8/65
249/249 - 376s - loss: 0.3285 - accuracy: 0.8302 - val_loss: 1.5653 - val_accuracy: 0.5156
Confusion matrix: 
 [[392 372]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.513 0.487]
 [0.432 0.568]]
Validation f1: 9.77
Validation accuracy: 51.56
Validation recall: 56.76
Validation precision: 5.34
Validation AUC: 0.3297195051303812
Validation class accuracies: [0.5130890052356021, 0.5675675675675675]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 3 epochs
Epoch 9/65
249/249 - 375s - loss: 0.4927 - accuracy: 0.7491 - val_loss: 0.8019 - val_accuracy: 0.6367
Confusion matrix: 
 [[485 279]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.635 0.365]
 [0.324 0.676]]
Validation f1: 14.66
Validation accuracy: 63.67
Validation recall: 67.57
Validation precision: 8.22
Validation AUC: 0.547380865847868
Validation class accuracies: [0.6348167539267016, 0.6756756756756757]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 4 epochs
Epoch 10/65
249/249 - 376s - loss: 0.3563 - accuracy: 0.8098 - val_loss: 0.4989 - val_accuracy: 0.7790
Confusion matrix: 
 [[599 165]
 [ 12  25]]
Normalized Confusion matrix: 
 [[0.784 0.216]
 [0.324 0.676]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.03
Validation accuracy: 77.90
Validation recall: 67.57
Validation precision: 13.16
Validation AUC: 0.4651093299020251
Validation class accuracies: [0.7840314136125655, 0.6756756756756757]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 5 epochs
Epoch 11/65
249/249 - 376s - loss: 0.3123 - accuracy: 0.8534 - val_loss: 0.7036 - val_accuracy: 0.7041
Confusion matrix: 
 [[540 224]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.707 0.293]
 [0.351 0.649]]
Validation f1: 16.84
Validation accuracy: 70.41
Validation recall: 64.86
Validation precision: 9.68
Validation AUC: 0.48016356499731083
Validation class accuracies: [0.7068062827225131, 0.6486486486486487]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 12/65
249/249 - 376s - loss: 0.2319 - accuracy: 0.8688 - val_loss: 0.2040 - val_accuracy: 0.9263
Confusion matrix: 
 [[733  31]
 [ 28   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.959 0.041]
 [0.757 0.243]]
Validation f1: 23.38
Validation accuracy: 92.63
Validation recall: 24.32
Validation precision: 22.50
Validation AUC: 0.19532321175574868
Validation class accuracies: [0.9594240837696335, 0.24324324324324326]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 7 epochs
Epoch 13/65
249/249 - 376s - loss: 0.2045 - accuracy: 0.8992 - val_loss: 0.2794 - val_accuracy: 0.8989
Confusion matrix: 
 [[704  60]
 [ 21  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.568 0.432]]
Validation f1: 28.32
Validation accuracy: 89.89
Validation recall: 43.24
Validation precision: 21.05
Validation AUC: 0.43864132532122097
Validation class accuracies: [0.9214659685863874, 0.43243243243243246]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 8 epochs
Epoch 14/65
249/249 - 376s - loss: 0.1800 - accuracy: 0.9161 - val_loss: 0.3354 - val_accuracy: 0.8864
Confusion matrix: 
 [[690  74]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.903 0.097]
 [0.459 0.541]]
Validation f1: 30.53
Validation accuracy: 88.64
Validation recall: 54.05
Validation precision: 21.28
Validation AUC: 0.5360453611044232
Validation class accuracies: [0.9031413612565445, 0.5405405405405406]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 9 epochs
Epoch 15/65
249/249 - 376s - loss: 0.1714 - accuracy: 0.9144 - val_loss: 0.1992 - val_accuracy: 0.9563
Confusion matrix: 
 [[760   4]
 [ 31   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.838 0.162]]
Validation f1: 25.53
Validation accuracy: 95.63
Validation recall: 16.22
Validation precision: 60.00
Validation AUC: 0.2628332640795411
Validation class accuracies: [0.9947643979057592, 0.16216216216216217]
The validation tracker metric at 0.39252336448598124 hasn't increased by 0 in 10 epochs
Epoch 16/65
249/249 - 377s - loss: 0.1717 - accuracy: 0.9164 - val_loss: 0.1981 - val_accuracy: 0.9238
Confusion matrix: 
 [[717  47]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.938 0.062]
 [0.378 0.622]]
Validation f1: 42.99
Validation accuracy: 92.38
Validation recall: 62.16
Validation precision: 32.86
Validation AUC: 0.5728008943478471
Validation class accuracies: [0.9384816753926701, 0.6216216216216216]
Saving model...
Epoch 17/65
249/249 - 376s - loss: 0.1513 - accuracy: 0.9325 - val_loss: 0.8078 - val_accuracy: 0.7628
Confusion matrix: 
 [[587 177]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.768 0.232]
 [0.351 0.649]]
Validation f1: 20.17
Validation accuracy: 76.28
Validation recall: 64.86
Validation precision: 11.94
Validation AUC: 0.3527034554808576
Validation class accuracies: [0.768324607329843, 0.6486486486486487]
The validation tracker metric at 0.42990654205607476 hasn't increased by 0 in 1 epochs
Epoch 18/65
249/249 - 376s - loss: 0.1558 - accuracy: 0.9317 - val_loss: 0.1546 - val_accuracy: 0.9563
Confusion matrix: 
 [[752  12]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.622 0.378]]
Validation f1: 44.44
Validation accuracy: 95.63
Validation recall: 37.84
Validation precision: 53.85
Validation AUC: 0.40307213495055905
Validation class accuracies: [0.9842931937172775, 0.3783783783783784]
Saving model...
Epoch 19/65
249/249 - 376s - loss: 0.1131 - accuracy: 0.9496 - val_loss: 0.1865 - val_accuracy: 0.9388
Confusion matrix: 
 [[736  28]
 [ 21  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.568 0.432]]
Validation f1: 39.51
Validation accuracy: 93.88
Validation recall: 43.24
Validation precision: 36.36
Validation AUC: 0.4393947274153809
Validation class accuracies: [0.9633507853403142, 0.43243243243243246]
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 1 epochs
Epoch 20/65
249/249 - 376s - loss: 0.0952 - accuracy: 0.9582 - val_loss: 0.2107 - val_accuracy: 0.9413
Confusion matrix: 
 [[740  24]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.622 0.378]]
Validation f1: 37.33
Validation accuracy: 94.13
Validation recall: 37.84
Validation precision: 36.84
Validation AUC: 0.4405873146442872
Validation class accuracies: [0.9685863874345549, 0.3783783783783784]
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 2 epochs
Epoch 21/65
249/249 - 376s - loss: 0.0988 - accuracy: 0.9564 - val_loss: 0.1712 - val_accuracy: 0.9538
Confusion matrix: 
 [[761   3]
 [ 34   3]]
Normalized Confusion matrix: 
 [[0.996 0.004]
 [0.919 0.081]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.95
Validation accuracy: 95.38
Validation recall: 8.11
Validation precision: 50.00
Validation AUC: 0.28545918294849326
Validation class accuracies: [0.9960732984293194, 0.08108108108108109]
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 3 epochs
Epoch 22/65
249/249 - 376s - loss: 0.0980 - accuracy: 0.9584 - val_loss: 0.3834 - val_accuracy: 0.8801
Confusion matrix: 
 [[686  78]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.898 0.102]
 [0.486 0.514]]
Validation f1: 28.36
Validation accuracy: 88.01
Validation recall: 51.35
Validation precision: 19.59
Validation AUC: 0.4547841575362646
Validation class accuracies: [0.8979057591623036, 0.5135135135135135]
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 4 epochs
Epoch 23/65
249/249 - 376s - loss: 0.1261 - accuracy: 0.9428 - val_loss: 0.2298 - val_accuracy: 0.9576
Confusion matrix: 
 [[762   2]
 [ 32   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.865 0.135]]
Validation f1: 22.73
Validation accuracy: 95.76
Validation recall: 13.51
Validation precision: 71.43
Validation AUC: 0.3083690911242981
Validation class accuracies: [0.9973821989528796, 0.13513513513513514]
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 5 epochs
Epoch 24/65
249/249 - 376s - loss: 0.0696 - accuracy: 0.9685 - val_loss: 0.3197 - val_accuracy: 0.8839
Confusion matrix: 
 [[686  78]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.898 0.102]
 [0.405 0.595]]
Validation f1: 32.12
Validation accuracy: 88.39
Validation recall: 59.46
Validation precision: 22.00
Validation AUC: 0.5080404370663895
Validation class accuracies: [0.8979057591623036, 0.5945945945945946]
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 25/65
249/249 - 376s - loss: 0.0548 - accuracy: 0.9746 - val_loss: 0.1651 - val_accuracy: 0.9526
Confusion matrix: 
 [[749  15]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.622 0.378]]
Validation f1: 42.42
Validation accuracy: 95.26
Validation recall: 37.84
Validation precision: 48.28
Validation AUC: 0.5094618651648982
Validation class accuracies: [0.9803664921465969, 0.3783783783783784]
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 7 epochs
Epoch 26/65
249/249 - 376s - loss: 0.0463 - accuracy: 0.9801 - val_loss: 0.1613 - val_accuracy: 0.9613
Confusion matrix: 
 [[756   8]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.622 0.378]]
Validation f1: 47.46
Validation accuracy: 96.13
Validation recall: 37.84
Validation precision: 63.64
Validation AUC: 0.4660322890853312
Validation class accuracies: [0.9895287958115183, 0.3783783783783784]
Saving model...
Epoch 27/65
249/249 - 376s - loss: 0.0359 - accuracy: 0.9859 - val_loss: 0.1917 - val_accuracy: 0.9451
Confusion matrix: 
 [[742  22]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.971 0.029]
 [0.595 0.405]]
Validation f1: 40.54
Validation accuracy: 94.51
Validation recall: 40.54
Validation precision: 40.54
Validation AUC: 0.4835399965360043
Validation class accuracies: [0.9712041884816754, 0.40540540540540543]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 1 epochs
Epoch 28/65
249/249 - 376s - loss: 0.0527 - accuracy: 0.9751 - val_loss: 0.1966 - val_accuracy: 0.9513
Confusion matrix: 
 [[748  16]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.622 0.378]]
Validation f1: 41.79
Validation accuracy: 95.13
Validation recall: 37.84
Validation precision: 46.67
Validation AUC: 0.4851529559037979
Validation class accuracies: [0.9790575916230366, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 2 epochs
Epoch 29/65
249/249 - 376s - loss: 0.0364 - accuracy: 0.9819 - val_loss: 0.1713 - val_accuracy: 0.9563
Confusion matrix: 
 [[753  11]
 [ 24  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.649 0.351]]
Validation f1: 42.62
Validation accuracy: 95.63
Validation recall: 35.14
Validation precision: 54.17
Validation AUC: 0.4827857102571731
Validation class accuracies: [0.9856020942408377, 0.35135135135135137]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 3 epochs
Epoch 30/65
249/249 - 376s - loss: 0.0490 - accuracy: 0.9834 - val_loss: 0.2049 - val_accuracy: 0.9513
Confusion matrix: 
 [[747  17]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.978 0.022]
 [0.595 0.405]]
Validation f1: 43.48
Validation accuracy: 95.13
Validation recall: 40.54
Validation precision: 46.88
Validation AUC: 0.45198388460386846
Validation class accuracies: [0.9777486910994765, 0.40540540540540543]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 4 epochs
Epoch 31/65
249/249 - 376s - loss: 0.0686 - accuracy: 0.9728 - val_loss: 0.2087 - val_accuracy: 0.9526
Confusion matrix: 
 [[749  15]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.42
Validation accuracy: 95.26
Validation recall: 37.84
Validation precision: 48.28
Validation AUC: 0.4977460064700473
Validation class accuracies: [0.9803664921465969, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 5 epochs
Epoch 32/65
249/249 - 376s - loss: 0.0473 - accuracy: 0.9839 - val_loss: 0.1926 - val_accuracy: 0.9613
Confusion matrix: 
 [[756   8]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.46
Validation accuracy: 96.13
Validation recall: 37.84
Validation precision: 63.64
Validation AUC: 0.4690779055461631
Validation class accuracies: [0.9895287958115183, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 33/65
249/249 - 376s - loss: 0.0435 - accuracy: 0.9761 - val_loss: 0.1999 - val_accuracy: 0.9563
Confusion matrix: 
 [[753  11]
 [ 24  13]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.649 0.351]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.62
Validation accuracy: 95.63
Validation recall: 35.14
Validation precision: 54.17
Validation AUC: 0.4504096067944606
Validation class accuracies: [0.9856020942408377, 0.35135135135135137]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 7 epochs
Epoch 34/65
249/249 - 376s - loss: 0.0300 - accuracy: 0.9872 - val_loss: 0.1972 - val_accuracy: 0.9563
Confusion matrix: 
 [[753  11]
 [ 24  13]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.649 0.351]]
Validation f1: 42.62
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.63
Validation recall: 35.14
Validation precision: 54.17
Validation AUC: 0.43884553969900736
Validation class accuracies: [0.9856020942408377, 0.35135135135135137]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 8 epochs
Epoch 35/65
249/249 - 376s - loss: 0.0342 - accuracy: 0.9831 - val_loss: 0.1807 - val_accuracy: 0.9526
Confusion matrix: 
 [[748  16]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.595 0.405]]
Validation f1: 44.12
Validation accuracy: 95.26
Validation recall: 40.54
Validation precision: 48.39
Validation AUC: 0.5114359187624395
Validation class accuracies: [0.9790575916230366, 0.40540540540540543]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 9 epochs
Epoch 36/65
249/249 - 376s - loss: 0.0228 - accuracy: 0.9912 - val_loss: 0.1906 - val_accuracy: 0.9538
Confusion matrix: 
 [[750  14]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.982 0.018]
 [0.622 0.378]]
Validation f1: 43.08
Validation accuracy: 95.38
Validation recall: 37.84
Validation precision: 50.00
Validation AUC: 0.476661664181665
Validation class accuracies: [0.981675392670157, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 10 epochs
Epoch 37/65
249/249 - 376s - loss: 0.0292 - accuracy: 0.9899 - val_loss: 0.2229 - val_accuracy: 0.9476
Confusion matrix: 
 [[745  19]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.975 0.025]
 [0.622 0.378]]
Validation f1: 40.00
Validation accuracy: 94.76
Validation recall: 37.84
Validation precision: 42.42
Validation AUC: 0.4750443371535777
Validation class accuracies: [0.975130890052356, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 11 epochs
Epoch 38/65
249/249 - 376s - loss: 0.0212 - accuracy: 0.9897 - val_loss: 0.2032 - val_accuracy: 0.9551
Confusion matrix: 
 [[752  12]
 [ 24  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.649 0.351]]
Validation f1: 41.94
Validation accuracy: 95.51
Validation recall: 35.14
Validation precision: 52.00
Validation AUC: 0.4447632308180137
Validation class accuracies: [0.9842931937172775, 0.35135135135135137]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 39/65
249/249 - 375s - loss: 0.0164 - accuracy: 0.9947 - val_loss: 0.2031 - val_accuracy: 0.9526
Confusion matrix: 
 [[749  15]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.622 0.378]]
Validation f1: 42.42
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.26
Validation recall: 37.84
Validation precision: 48.28
Validation AUC: 0.4517402842666348
Validation class accuracies: [0.9803664921465969, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 13 epochs
Epoch 40/65
249/249 - 376s - loss: 0.0155 - accuracy: 0.9952 - val_loss: 0.2062 - val_accuracy: 0.9538
Confusion matrix: 
 [[750  14]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.982 0.018]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.08
Validation accuracy: 95.38
Validation recall: 37.84
Validation precision: 50.00
Validation AUC: 0.45540888950908104
Validation class accuracies: [0.981675392670157, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 14 epochs
Epoch 41/65
249/249 - 375s - loss: 0.0200 - accuracy: 0.9929 - val_loss: 0.2112 - val_accuracy: 0.9526
Confusion matrix: 
 [[749  15]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.42
Validation accuracy: 95.26
Validation recall: 37.84
Validation precision: 48.28
Validation AUC: 0.4486530170437274
Validation class accuracies: [0.9803664921465969, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 15 epochs
Epoch 42/65
249/249 - 375s - loss: 0.0150 - accuracy: 0.9960 - val_loss: 0.2056 - val_accuracy: 0.9526
Confusion matrix: 
 [[749  15]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.42
Validation accuracy: 95.26
Validation recall: 37.84
Validation precision: 48.28
Validation AUC: 0.4498944950741733
Validation class accuracies: [0.9803664921465969, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 16 epochs
Epoch 43/65
249/249 - 376s - loss: 0.0177 - accuracy: 0.9937 - val_loss: 0.2056 - val_accuracy: 0.9538
Confusion matrix: 
 [[750  14]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.982 0.018]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.08
Validation accuracy: 95.38
Validation recall: 37.84
Validation precision: 50.00
Validation AUC: 0.4421731759503691
Validation class accuracies: [0.981675392670157, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 17 epochs
Epoch 44/65
249/249 - 375s - loss: 0.0180 - accuracy: 0.9952 - val_loss: 0.2115 - val_accuracy: 0.9538
Confusion matrix: 
 [[750  14]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.982 0.018]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.08
Validation accuracy: 95.38
Validation recall: 37.84
Validation precision: 50.00
Validation AUC: 0.4501652552016668
Validation class accuracies: [0.981675392670157, 0.3783783783783784]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 45/65
249/249 - 376s - loss: 0.0146 - accuracy: 0.9942 - val_loss: 0.2067 - val_accuracy: 0.9551
Confusion matrix: 
 [[752  12]
 [ 24  13]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.649 0.351]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.94
Validation accuracy: 95.51
Validation recall: 35.14
Validation precision: 52.00
Validation AUC: 0.43338506835995866
Validation class accuracies: [0.9842931937172775, 0.35135135135135137]
The validation tracker metric at 0.4745762711864407 hasn't increased by 0 in 19 epochs
Epoch 46/65
249/249 - 376s - loss: 0.0499 - accuracy: 0.9927 - val_loss: 0.2062 - val_accuracy: 0.9563
Confusion matrix: 
 [[753  11]
 [ 24  13]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.649 0.351]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.62
Validation accuracy: 95.63
Validation recall: 35.14
Validation precision: 54.17
Validation AUC: 0.4312867414978075
Validation class accuracies: [0.9856020942408377, 0.35135135135135137]

The metrics for job 1 with the best target metric are: 
Best cm: [[756   8]
 [ 23  14]]
Best normalized cm: [[0.99  0.01 ]
 [0.622 0.378]]
Best f1: 0.47
Best accuracy: 0.96
Best recall: 0.38
Best precision: 0.64
Best AUC: 0.47
Best class accuracies: [0.9895287958115183, 0.3783783783783784]
Best epoch: 26
The number of epochs since last 1% equals the patience
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_226_1b1_Pl_sc_LittC2SE_0_label_1_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP83_N,N,A R U,18,F_2_label_0_pred_0.png, [[6.863e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_223_1b1_Lr_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Pr_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_3b4_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_0.png, [[0.007]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_2b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.035]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP50_N,N,P R L ,27,M_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_1b3_Ll_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_211_1p2_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_211_1p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_226_1b1_Pl_sc_LittC2SE_3_label_1_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_207_2b2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1b1_Al_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_223_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_3b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.04]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Ar_sc_Meditron_9_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_3b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_2p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_223_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Lr_sc_Meditron_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_224_1b1_Tc_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_205_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_219_2b2_Tc_mc_LittC2SE_1_label_1_pred_1.png, [[0.987]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p5_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_215_1b3_Tc_sc_Meditron_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP57_COPD,E W,P R L ,42,M_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP90_heart failure,Crep,P L M,74,F_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_1p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.075]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_207_3b2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_204_7p5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP95_N,N,P L M,18,M_1_label_0_pred_0.png, [[9.772e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_218_1b1_Al_sc_Meditron_12_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_213_2p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/1/jordan_EP88_N,N,A R U,29,M_2_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 9361
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_023323-3e7rol8s/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_023323-3e7rol8s/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9927
wandb:         val_accuracy 0.9563
wandb:             _runtime 18171
wandb:           _timestamp 1624520174
wandb:                _step 339
wandb:           train_loss 0.0499
wandb:             val_loss 0.20615
wandb:           val_recall 0.35135
wandb:        val_precision 0.54167
wandb:               val_f1 0.42623
wandb:              val_auc 0.43129
wandb:                   lr 3e-05
wandb:          best_val_f1 0.47458
wandb:    best_val_accuracy 0.9613
wandb:   best_val_precision 0.63636
wandb:      best_val_recall 0.37838
wandb:             best_auc 0.46603
wandb:           best_epoch 26
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_023323-3e7rol8s

-----------------------
Changing augmentation to v48
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v48'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 937
-----------------------
Number of train recordings: 3208 with pneumonia: 162 and non-pneumonia: 3046
Length of training samples after audio augmentation: 3370
-----------------------
Number of train recordings: 3370 with pneumonia: 324 and non-pneumonia: 3046
Length of training samples after audio augmentation: 3970
-----------------------
Number of train recordings: 3970 with pneumonia: 324 and non-pneumonia: 3646
Number of val recordings: 801 with pneumonia: 37 and non-pneumonia: 764
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 128, 1250, 1)    4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_2 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 64, 625, 48)     0            concatenate_2[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 64, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 32, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 16, 156, 128)    91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 8, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 4, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               513          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
249/249 - 376s - loss: 1.1221 - accuracy: 0.4332 - val_loss: 0.8397 - val_accuracy: 0.0462
Confusion matrix: 
 [[  0 764]
 [  0  37]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 8.83
Validation accuracy: 4.62
Validation recall: 100.00
Validation precision: 4.62
Validation AUC: 0.07671285664815275
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
249/249 - 376s - loss: 0.7234 - accuracy: 0.5315 - val_loss: 0.7456 - val_accuracy: 0.4020
Confusion matrix: 
 [[289 475]
 [  4  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.378 0.622]
 [0.108 0.892]]
Validation f1: 12.11
Validation accuracy: 40.20
Validation recall: 89.19
Validation precision: 6.50
Validation AUC: 0.12684331704678622
Validation class accuracies: [0.3782722513089005, 0.8918918918918919]
Saving model...
Epoch 3/65
249/249 - 376s - loss: 0.7154 - accuracy: 0.5967 - val_loss: 0.4148 - val_accuracy: 0.8702
Confusion matrix: 
 [[687  77]
 [ 27  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.73  0.27 ]]
Validation f1: 16.13
Validation accuracy: 87.02
Validation recall: 27.03
Validation precision: 11.49
Validation AUC: 0.07455320572794108
Validation class accuracies: [0.8992146596858639, 0.2702702702702703]
Saving model...
Epoch 4/65
249/249 - 376s - loss: 0.5869 - accuracy: 0.6426 - val_loss: 1.1023 - val_accuracy: 0.4669
Confusion matrix: 
 [[351 413]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.459 0.541]
 [0.378 0.622]]
Validation f1: 9.73
Validation accuracy: 46.69
Validation recall: 62.16
Validation precision: 5.28
Validation AUC: 0.3376343783044919
Validation class accuracies: [0.4594240837696335, 0.6216216216216216]
The validation tracker metric at 0.16129032258064516 hasn't increased by 0 in 1 epochs
Epoch 5/65
249/249 - 376s - loss: 0.5466 - accuracy: 0.6887 - val_loss: 0.4332 - val_accuracy: 0.8227
Confusion matrix: 
 [[644 120]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.595 0.405]]
Validation f1: 17.44
Validation accuracy: 82.27
Validation recall: 40.54
Validation precision: 11.11
Validation AUC: 0.23451608603739846
Validation class accuracies: [0.8429319371727748, 0.40540540540540543]
Saving model...
Epoch 6/65
249/249 - 375s - loss: 0.4470 - accuracy: 0.7441 - val_loss: 0.4856 - val_accuracy: 0.8077
Confusion matrix: 
 [[627 137]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.821 0.179]
 [0.459 0.541]]
Validation f1: 20.62
Validation accuracy: 80.77
Validation recall: 54.05
Validation precision: 12.74
Validation AUC: 0.3464314571510661
Validation class accuracies: [0.8206806282722513, 0.5405405405405406]
Saving model...
Epoch 7/65
249/249 - 375s - loss: 0.3885 - accuracy: 0.7798 - val_loss: 0.9605 - val_accuracy: 0.6380
Confusion matrix: 
 [[481 283]
 [  7  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.63  0.37 ]
 [0.189 0.811]]
Validation f1: 17.14
Validation accuracy: 63.80
Validation recall: 81.08
Validation precision: 9.58
Validation AUC: 0.47834947684024276
Validation class accuracies: [0.6295811518324608, 0.8108108108108109]
The validation tracker metric at 0.20618556701030927 hasn't increased by 0 in 1 epochs
Epoch 8/65
249/249 - 376s - loss: 0.4252 - accuracy: 0.7854 - val_loss: 0.3456 - val_accuracy: 0.8851
Confusion matrix: 
 [[705  59]
 [ 33   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.892 0.108]]
Validation f1: 8.00
Validation accuracy: 88.51
Validation recall: 10.81
Validation precision: 6.35
Validation AUC: 0.06173055627047767
Validation class accuracies: [0.9227748691099477, 0.10810810810810811]
The validation tracker metric at 0.20618556701030927 hasn't increased by 0 in 2 epochs
Epoch 9/65
249/249 - 376s - loss: 0.3440 - accuracy: 0.8144 - val_loss: 0.3409 - val_accuracy: 0.8839
Confusion matrix: 
 [[686  78]
 [ 15  22]]
Normalized Confusion matrix: 
 [[0.898 0.102]
 [0.405 0.595]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 32.12
Validation accuracy: 88.39
Validation recall: 59.46
Validation precision: 22.00
Validation AUC: 0.5093434162467123
Validation class accuracies: [0.8979057591623036, 0.5945945945945946]
Saving model...
Epoch 10/65
249/249 - 376s - loss: 0.2943 - accuracy: 0.8549 - val_loss: 0.3724 - val_accuracy: 0.8639
Confusion matrix: 
 [[671  93]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.878 0.122]
 [0.432 0.568]]
Validation f1: 27.81
Validation accuracy: 86.39
Validation recall: 56.76
Validation precision: 18.42
Validation AUC: 0.5089564108408435
Validation class accuracies: [0.8782722513089005, 0.5675675675675675]
The validation tracker metric at 0.32116788321167883 hasn't increased by 0 in 1 epochs
Epoch 11/65
249/249 - 376s - loss: 0.3062 - accuracy: 0.8451 - val_loss: 0.2185 - val_accuracy: 0.9463
Confusion matrix: 
 [[749  15]
 [ 28   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.757 0.243]]
Validation f1: 29.51
Validation accuracy: 94.63
Validation recall: 24.32
Validation precision: 37.50
Validation AUC: 0.21945739099330655
Validation class accuracies: [0.9803664921465969, 0.24324324324324326]
The validation tracker metric at 0.32116788321167883 hasn't increased by 0 in 2 epochs
Epoch 12/65
249/249 - 375s - loss: 0.2871 - accuracy: 0.8617 - val_loss: 0.4431 - val_accuracy: 0.8564
Confusion matrix: 
 [[665  99]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87  0.13 ]
 [0.432 0.568]]
Validation f1: 26.75
Validation accuracy: 85.64
Validation recall: 56.76
Validation precision: 17.50
Validation AUC: 0.5509728612850985
Validation class accuracies: [0.8704188481675392, 0.5675675675675675]
The validation tracker metric at 0.32116788321167883 hasn't increased by 0 in 3 epochs
Epoch 13/65
249/249 - 376s - loss: 0.2732 - accuracy: 0.8552 - val_loss: 0.3436 - val_accuracy: 0.8689
Confusion matrix: 
 [[673  91]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.378 0.622]]
Validation f1: 30.46
Validation accuracy: 86.89
Validation recall: 62.16
Validation precision: 20.18
Validation AUC: 0.5617260093672237
Validation class accuracies: [0.8808900523560209, 0.6216216216216216]
The validation tracker metric at 0.32116788321167883 hasn't increased by 0 in 4 epochs
Epoch 14/65
249/249 - 376s - loss: 0.2126 - accuracy: 0.8932 - val_loss: 0.6706 - val_accuracy: 0.7253
Confusion matrix: 
 [[556 208]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.728 0.272]
 [0.324 0.676]]
Validation f1: 18.52
Validation accuracy: 72.53
Validation recall: 67.57
Validation precision: 10.73
Validation AUC: 0.4747344411534434
Validation class accuracies: [0.7277486910994765, 0.6756756756756757]
The validation tracker metric at 0.32116788321167883 hasn't increased by 0 in 5 epochs
Epoch 15/65
249/249 - 375s - loss: 0.2181 - accuracy: 0.8927 - val_loss: 0.3040 - val_accuracy: 0.8876
Confusion matrix: 
 [[691  73]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.459 0.541]]
Validation f1: 30.77
Validation accuracy: 88.76
Validation recall: 54.05
Validation precision: 21.51
Validation AUC: 0.4100013839884038
Validation class accuracies: [0.9044502617801047, 0.5405405405405406]
The validation tracker metric at 0.32116788321167883 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
249/249 - 375s - loss: 0.1391 - accuracy: 0.9300 - val_loss: 0.1949 - val_accuracy: 0.9401
Confusion matrix: 
 [[734  30]
 [ 18  19]]
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.486 0.514]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.19
Validation accuracy: 94.01
Validation recall: 51.35
Validation precision: 38.78
Validation AUC: 0.5404187414663788
Validation class accuracies: [0.9607329842931938, 0.5135135135135135]
Saving model...
Epoch 17/65
249/249 - 376s - loss: 0.1058 - accuracy: 0.9446 - val_loss: 0.1461 - val_accuracy: 0.9650
Confusion matrix: 
 [[756   8]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.541 0.459]]
Validation f1: 54.84
Validation accuracy: 96.50
Validation recall: 45.95
Validation precision: 68.00
Validation AUC: 0.5076746774924207
Validation class accuracies: [0.9895287958115183, 0.4594594594594595]
Saving model...
Epoch 18/65
249/249 - 375s - loss: 0.1064 - accuracy: 0.9499 - val_loss: 0.2018 - val_accuracy: 0.9363
Confusion matrix: 
 [[728  36]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.405 0.595]]
Validation f1: 46.32
Validation accuracy: 93.63
Validation recall: 59.46
Validation precision: 37.93
Validation AUC: 0.5716261008873279
Validation class accuracies: [0.9528795811518325, 0.5945945945945946]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 1 epochs
Epoch 19/65
249/249 - 375s - loss: 0.1021 - accuracy: 0.9466 - val_loss: 0.1532 - val_accuracy: 0.9688
Confusion matrix: 
 [[762   2]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.622 0.378]]
Validation f1: 52.83
Validation accuracy: 96.88
Validation recall: 37.84
Validation precision: 87.50
Validation AUC: 0.5214218919802543
Validation class accuracies: [0.9973821989528796, 0.3783783783783784]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 2 epochs
Epoch 20/65
249/249 - 375s - loss: 0.0857 - accuracy: 0.9587 - val_loss: 0.8300 - val_accuracy: 0.7553
Confusion matrix: 
 [[578 186]
 [ 10  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.757 0.243]
 [0.27  0.73 ]]
Validation f1: 21.60
Validation accuracy: 75.53
Validation recall: 72.97
Validation precision: 12.68
Validation AUC: 0.44506753448411085
Validation class accuracies: [0.756544502617801, 0.7297297297297297]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 3 epochs
Epoch 21/65
249/249 - 375s - loss: 0.0761 - accuracy: 0.9647 - val_loss: 0.1776 - val_accuracy: 0.9638
Confusion matrix: 
 [[759   5]
 [ 24  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.649 0.351]]
Validation f1: 47.27
Validation accuracy: 96.38
Validation recall: 35.14
Validation precision: 72.22
Validation AUC: 0.4475505206591214
Validation class accuracies: [0.993455497382199, 0.35135135135135137]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 4 epochs
Epoch 22/65
249/249 - 375s - loss: 0.0633 - accuracy: 0.9718 - val_loss: 0.1723 - val_accuracy: 0.9638
Confusion matrix: 
 [[755   9]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.541 0.459]]
Validation f1: 53.97
Validation accuracy: 96.38
Validation recall: 45.95
Validation precision: 65.38
Validation AUC: 0.5588015270513843
Validation class accuracies: [0.9882198952879581, 0.4594594594594595]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 5 epochs
Epoch 23/65
249/249 - 375s - loss: 0.0536 - accuracy: 0.9763 - val_loss: 0.2295 - val_accuracy: 0.9301
Confusion matrix: 
 [[730  34]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.595 0.405]]
Validation f1: 34.88
Validation accuracy: 93.01
Validation recall: 40.54
Validation precision: 30.61
Validation AUC: 0.4178180537171468
Validation class accuracies: [0.9554973821989529, 0.40540540540540543]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 24/65
249/249 - 376s - loss: 0.0392 - accuracy: 0.9839 - val_loss: 0.1601 - val_accuracy: 0.9663
Confusion matrix: 
 [[759   5]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.595 0.405]]
Validation f1: 52.63
Validation accuracy: 96.63
Validation recall: 40.54
Validation precision: 75.00
Validation AUC: 0.5280910293352565
Validation class accuracies: [0.993455497382199, 0.40540540540540543]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 7 epochs
Epoch 25/65
249/249 - 375s - loss: 0.0310 - accuracy: 0.9899 - val_loss: 0.2806 - val_accuracy: 0.9313
Confusion matrix: 
 [[729  35]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.954 0.046]
 [0.541 0.459]]
Validation f1: 38.20
Validation accuracy: 93.13
Validation recall: 45.95
Validation precision: 32.69
Validation AUC: 0.5028405765265308
Validation class accuracies: [0.9541884816753927, 0.4594594594594595]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 8 epochs
Epoch 26/65
249/249 - 375s - loss: 0.0312 - accuracy: 0.9866 - val_loss: 0.1778 - val_accuracy: 0.9638
Confusion matrix: 
 [[760   4]
 [ 25  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.676 0.324]]
Validation f1: 45.28
Validation accuracy: 96.38
Validation recall: 32.43
Validation precision: 75.00
Validation AUC: 0.4888270810428365
Validation class accuracies: [0.9947643979057592, 0.32432432432432434]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 9 epochs
Epoch 27/65
249/249 - 375s - loss: 0.0258 - accuracy: 0.9907 - val_loss: 0.1850 - val_accuracy: 0.9675
Confusion matrix: 
 [[762   2]
 [ 24  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.649 0.351]]
Validation f1: 50.00
Validation accuracy: 96.75
Validation recall: 35.14
Validation precision: 86.67
Validation AUC: 0.5212861033182326
Validation class accuracies: [0.9973821989528796, 0.35135135135135137]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 10 epochs
Epoch 28/65
249/249 - 375s - loss: 0.0187 - accuracy: 0.9924 - val_loss: 0.1851 - val_accuracy: 0.9600
Confusion matrix: 
 [[756   8]
 [ 24  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.649 0.351]]
Validation f1: 44.83
Validation accuracy: 96.00
Validation recall: 35.14
Validation precision: 61.90
Validation AUC: 0.48480215292168427
Validation class accuracies: [0.9895287958115183, 0.35135135135135137]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 11 epochs
Epoch 29/65
249/249 - 375s - loss: 0.0209 - accuracy: 0.9945 - val_loss: 0.3416 - val_accuracy: 0.9039
Confusion matrix: 
 [[703  61]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.432 0.568]]
Validation f1: 35.29
Validation accuracy: 90.39
Validation recall: 56.76
Validation precision: 25.61
Validation AUC: 0.4635784329358707
Validation class accuracies: [0.9201570680628273, 0.5675675675675675]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 30/65
249/249 - 375s - loss: 0.0244 - accuracy: 0.9894 - val_loss: 0.2152 - val_accuracy: 0.9588
Confusion matrix: 
 [[753  11]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.595 0.405]]
Validation f1: 47.62
Validation accuracy: 95.88
Validation recall: 40.54
Validation precision: 57.69
Validation AUC: 0.47483257377267385
Validation class accuracies: [0.9856020942408377, 0.40540540540540543]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 13 epochs
Epoch 31/65
249/249 - 375s - loss: 0.0148 - accuracy: 0.9945 - val_loss: 0.1943 - val_accuracy: 0.9625
Confusion matrix: 
 [[757   7]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.28
Validation accuracy: 96.25
Validation recall: 37.84
Validation precision: 66.67
Validation AUC: 0.48416853125323117
Validation class accuracies: [0.9908376963350786, 0.3783783783783784]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 14 epochs
Epoch 32/65
249/249 - 375s - loss: 0.0177 - accuracy: 0.9962 - val_loss: 0.1992 - val_accuracy: 0.9613
Confusion matrix: 
 [[756   8]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.622 0.378]]
Validation f1: 47.46
Validation accuracy: 96.13
Validation recall: 37.84
Validation precision: 63.64
Validation AUC: 0.47522502028581365
Validation class accuracies: [0.9895287958115183, 0.3783783783783784]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 15 epochs
Epoch 33/65
249/249 - 375s - loss: 0.0218 - accuracy: 0.9897 - val_loss: 0.1957 - val_accuracy: 0.9650
Confusion matrix: 
 [[759   5]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.622 0.378]]
Validation f1: 50.00
Validation accuracy: 96.50
Validation recall: 37.84
Validation precision: 73.68
Validation AUC: 0.4873071230606927
Validation class accuracies: [0.993455497382199, 0.3783783783783784]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 16 epochs
Epoch 34/65
249/249 - 375s - loss: 0.0132 - accuracy: 0.9952 - val_loss: 0.1914 - val_accuracy: 0.9638
Confusion matrix: 
 [[758   6]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.992 0.008]
 [0.622 0.378]]
Validation f1: 49.12
Validation accuracy: 96.38
Validation recall: 37.84
Validation precision: 70.00
Validation AUC: 0.486195380646677
Validation class accuracies: [0.9921465968586387, 0.3783783783783784]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 17 epochs
Epoch 35/65
249/249 - 374s - loss: 0.0097 - accuracy: 0.9975 - val_loss: 0.1919 - val_accuracy: 0.9625
Confusion matrix: 
 [[757   7]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.622 0.378]]
Validation f1: 48.28
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 96.25
Validation recall: 37.84
Validation precision: 66.67
Validation AUC: 0.48539451312283954
Validation class accuracies: [0.9908376963350786, 0.3783783783783784]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 36/65
249/249 - 375s - loss: 0.0143 - accuracy: 0.9960 - val_loss: 0.1942 - val_accuracy: 0.9638
Confusion matrix: 
 [[758   6]
 [ 23  14]]
Normalized Confusion matrix: 
 [[0.992 0.008]
 [0.622 0.378]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.12
Validation accuracy: 96.38
Validation recall: 37.84
Validation precision: 70.00
Validation AUC: 0.4833904210714466
Validation class accuracies: [0.9921465968586387, 0.3783783783783784]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 19 epochs
Epoch 37/65
249/249 - 375s - loss: 0.0132 - accuracy: 0.9940 - val_loss: 0.1945 - val_accuracy: 0.9588
Confusion matrix: 
 [[754  10]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.987 0.013]
 [0.622 0.378]]
Validation f1: 45.90
Validation accuracy: 95.88
Validation recall: 37.84
Validation precision: 58.33
Validation AUC: 0.49409259928146293
Validation class accuracies: [0.9869109947643979, 0.3783783783783784]

The metrics for job 2 with the best target metric are: 
Best cm: [[756   8]
 [ 20  17]]
Best normalized cm: [[0.99  0.01 ]
 [0.541 0.459]]
Best f1: 0.55
Best accuracy: 0.97
Best recall: 0.46
Best precision: 0.68
Best AUC: 0.51
Best class accuracies: [0.9895287958115183, 0.4594594594594595]
Best epoch: 17
The number of epochs since last 1% equals the patience
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_203_2p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.269e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP73_N,N,P L L,32,M_1_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p2_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[5.107e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p5_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[9.149e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_222_1b1_Lr_sc_Meditron_7_label_0_pred_0.png, [[6.312e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP54_heart failure,Crep,P R L ,73,F_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.043]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Al_sc_Meditron_4_label_0_pred_0.png, [[2.711e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_2b4_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_2b4_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.036]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_223_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[3.423e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_2b3_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP90_heart failure,Crep,P L M,74,F_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP82_N,N,P L U,38,M_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP89_N,N,P L M,70,M_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Pl_sc_Meditron_7_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[5.637e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP67_heart failure,Crep,P R L ,24,F_2_label_0_pred_0.png, [[0.032]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP97_Asthma,E W,P R U,24,M_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_222_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[4.835e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP76_N,N,A L U,31,M_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/jordan_EP78_Asthma,E W,P R M,20,M_3_label_0_pred_0.png, [[0.089]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_2p2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[4.176e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b2_Pl_mc_LittC2SE_1_label_0_pred_0.png, [[1.619e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_219_2b3_Tc_mc_LittC2SE_1_label_1_pred_1.png, [[0.759]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[5.154e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[2.697e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1p1_Ar_sc_Litt3200_4_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_219_2b2_Ar_mc_LittC2SE_1_label_1_pred_1.png, [[0.999]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b3_Ar_mc_LittC2SE_0_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_205_2b4_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[8.342e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[6.646e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_218_1p1_Pr_sc_Litt3200_3_label_0_pred_0.png, [[2.449e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b1_Ar_mc_LittC2SE_0_label_0_pred_0.png, [[0.045]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_215_1b3_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_203_2p3_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_226_1b1_Ll_sc_Meditron_0_label_1_pred_0.png, [[0.019]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_213_1p3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_207_2b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_205_1b3_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[3.38e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_221_2b2_Ar_mc_LittC2SE_3_label_0_pred_1.png, [[0.518]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/2/icbhi_204_7p5_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 14264
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_073655-ncc29odm/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_073655-ncc29odm/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99395
wandb:         val_accuracy 0.9588
wandb:             _runtime 14582
wandb:           _timestamp 1624534797
wandb:                _step 282
wandb:           train_loss 0.01323
wandb:             val_loss 0.19447
wandb:           val_recall 0.37838
wandb:        val_precision 0.58333
wandb:               val_f1 0.45902
wandb:              val_auc 0.49409
wandb:                   lr 6e-05
wandb:          best_val_f1 0.54839
wandb:    best_val_accuracy 0.96504
wandb:   best_val_precision 0.68
wandb:      best_val_recall 0.45946
wandb:             best_auc 0.50767
wandb:           best_epoch 17
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_073655-ncc29odm

-----------------------
Changing augmentation to v42, v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 937
-----------------------
Number of train recordings: 3208 with pneumonia: 162 and non-pneumonia: 3046
Length of training samples after audio augmentation: 3532
-----------------------
Number of train recordings: 3532 with pneumonia: 486 and non-pneumonia: 3046
Length of training samples after audio augmentation: 4732
-----------------------
Number of train recordings: 4732 with pneumonia: 486 and non-pneumonia: 4246
Number of val recordings: 801 with pneumonia: 37 and non-pneumonia: 764
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormal (None, 128, 1250, 1)    4            input_4[0][0]                        
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_15[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_17[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_3[0][0]                
______________________________________________________________________________________________________________
concatenate_3 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_16[0][0]                      
                                                                         conv2d_18[0][0]                      
                                                                         conv2d_19[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePoolin (None, 64, 625, 48)     0            concatenate_3[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_15[0][0]           
______________________________________________________________________________________________________________
dropout_15 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_19[0][0]         
______________________________________________________________________________________________________________
inverted_residual_30 (InvertedResid (None, 64, 625, 32)     35840        dropout_15[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_31 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_30[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_31[0][0]           
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_16[0][0]           
______________________________________________________________________________________________________________
dropout_16 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_20[0][0]         
______________________________________________________________________________________________________________
inverted_residual_32 (InvertedResid (None, 32, 312, 64)     27136        dropout_16[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_33 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_32[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_33[0][0]           
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_17[0][0]           
______________________________________________________________________________________________________________
dropout_17 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_21[0][0]         
______________________________________________________________________________________________________________
inverted_residual_34 (InvertedResid (None, 16, 156, 128)    91136        dropout_17[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_35 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_34[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_35[0][0]           
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_18[0][0]           
______________________________________________________________________________________________________________
dropout_18 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
inverted_residual_36 (InvertedResid (None, 8, 78, 256)      329728       dropout_18[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_37 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_36[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_37[0][0]           
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_19[0][0]           
______________________________________________________________________________________________________________
dropout_19 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
inverted_residual_38 (InvertedResid (None, 4, 39, 512)      1249280      dropout_19[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_39 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_38[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalA (None, 512)             0            inverted_residual_39[0][0]           
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 1)               513          global_average_pooling2d_3[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
296/296 - 444s - loss: 1.0332 - accuracy: 0.4372 - val_loss: 0.7209 - val_accuracy: 0.0462
Confusion matrix: 
 [[  0 764]
 [  0  37]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 8.83
Validation accuracy: 4.62
Validation recall: 100.00
Validation precision: 4.62
Validation AUC: 0.15473483246589192
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
296/296 - 444s - loss: 0.7552 - accuracy: 0.5178 - val_loss: 0.9684 - val_accuracy: 0.4132
Confusion matrix: 
 [[303 461]
 [  9  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.397 0.603]
 [0.243 0.757]]
Validation f1: 10.65
Validation accuracy: 41.32
Validation recall: 75.68
Validation precision: 5.73
Validation AUC: 0.10964052775744482
Validation class accuracies: [0.39659685863874344, 0.7567567567567568]
Saving model...
Epoch 3/65
296/296 - 443s - loss: 0.6738 - accuracy: 0.5858 - val_loss: 0.9508 - val_accuracy: 0.5643
Confusion matrix: 
 [[419 345]
 [  4  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.548 0.452]
 [0.108 0.892]]
Validation f1: 15.90
Validation accuracy: 56.43
Validation recall: 89.19
Validation precision: 8.73
Validation AUC: 0.33133961392875244
Validation class accuracies: [0.5484293193717278, 0.8918918918918919]
Saving model...
Epoch 4/65
296/296 - 443s - loss: 0.6185 - accuracy: 0.6088 - val_loss: 0.5151 - val_accuracy: 0.7328
Confusion matrix: 
 [[565 199]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.74  0.26 ]
 [0.405 0.595]]
Validation f1: 17.05
Validation accuracy: 73.28
Validation recall: 59.46
Validation precision: 9.95
Validation AUC: 0.3394402250999412
Validation class accuracies: [0.7395287958115183, 0.5945945945945946]
Saving model...
Epoch 5/65
296/296 - 443s - loss: 0.5726 - accuracy: 0.6667 - val_loss: 0.2557 - val_accuracy: 0.9351
Confusion matrix: 
 [[741  23]
 [ 29   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.784 0.216]]
Validation f1: 23.53
Validation accuracy: 93.51
Validation recall: 21.62
Validation precision: 25.81
Validation AUC: 0.14516912430212575
Validation class accuracies: [0.9698952879581152, 0.21621621621621623]
Saving model...
Epoch 6/65
296/296 - 443s - loss: 0.5336 - accuracy: 0.6784 - val_loss: 0.4122 - val_accuracy: 0.8689
Confusion matrix: 
 [[683  81]
 [ 24  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.649 0.351]]
Validation f1: 19.85
Validation accuracy: 86.89
Validation recall: 35.14
Validation precision: 13.83
Validation AUC: 0.2046101746762555
Validation class accuracies: [0.893979057591623, 0.35135135135135137]
The validation tracker metric at 0.23529411764705882 hasn't increased by 0 in 1 epochs
Epoch 7/65
296/296 - 442s - loss: 0.4418 - accuracy: 0.7555 - val_loss: 2.0827 - val_accuracy: 0.2996
Confusion matrix: 
 [[205 559]
 [  2  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.268 0.732]
 [0.054 0.946]]
Validation f1: 11.09
Validation accuracy: 29.96
Validation recall: 94.59
Validation precision: 5.89
Validation AUC: 0.29487213235453563
Validation class accuracies: [0.2683246073298429, 0.9459459459459459]
The validation tracker metric at 0.23529411764705882 hasn't increased by 0 in 2 epochs
Epoch 8/65
296/296 - 443s - loss: 0.3756 - accuracy: 0.7946 - val_loss: 0.3395 - val_accuracy: 0.8814
Confusion matrix: 
 [[685  79]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.432 0.568]]
Validation f1: 30.66
Validation accuracy: 88.14
Validation recall: 56.76
Validation precision: 21.00
Validation AUC: 0.4516855783271976
Validation class accuracies: [0.8965968586387435, 0.5675675675675675]
Saving model...
Epoch 9/65
296/296 - 443s - loss: 0.3732 - accuracy: 0.8100 - val_loss: 0.4840 - val_accuracy: 0.8390
Confusion matrix: 
 [[650 114]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.851 0.149]
 [0.405 0.595]]
Validation f1: 25.43
Validation accuracy: 83.90
Validation recall: 59.46
Validation precision: 16.18
Validation AUC: 0.41221188071527703
Validation class accuracies: [0.8507853403141361, 0.5945945945945946]
The validation tracker metric at 0.30656934306569344 hasn't increased by 0 in 1 epochs
Epoch 10/65
296/296 - 443s - loss: 0.3220 - accuracy: 0.8335 - val_loss: 1.0019 - val_accuracy: 0.7066
Confusion matrix: 
 [[534 230]
 [  5  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.699 0.301]
 [0.135 0.865]]
Validation f1: 21.40
Validation accuracy: 70.66
Validation recall: 86.49
Validation precision: 12.21
Validation AUC: 0.4740400692038505
Validation class accuracies: [0.6989528795811518, 0.8648648648648649]
The validation tracker metric at 0.30656934306569344 hasn't increased by 0 in 2 epochs
Epoch 11/65
296/296 - 442s - loss: 0.2707 - accuracy: 0.8658 - val_loss: 1.4503 - val_accuracy: 0.5443
Confusion matrix: 
 [[401 363]
 [  2  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.525 0.475]
 [0.054 0.946]]
Validation f1: 16.09
Validation accuracy: 54.43
Validation recall: 94.59
Validation precision: 8.79
Validation AUC: 0.21445929483595425
Validation class accuracies: [0.524869109947644, 0.9459459459459459]
The validation tracker metric at 0.30656934306569344 hasn't increased by 0 in 3 epochs
Epoch 12/65
296/296 - 442s - loss: 0.2143 - accuracy: 0.8954 - val_loss: 0.9884 - val_accuracy: 0.7640
Confusion matrix: 
 [[597 167]
 [ 22  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.781 0.219]
 [0.595 0.405]]
Validation f1: 13.70
Validation accuracy: 76.40
Validation recall: 40.54
Validation precision: 8.24
Validation AUC: 0.06943278600019591
Validation class accuracies: [0.7814136125654451, 0.40540540540540543]
The validation tracker metric at 0.30656934306569344 hasn't increased by 0 in 4 epochs
Epoch 13/65
296/296 - 443s - loss: 0.2417 - accuracy: 0.8831 - val_loss: 0.2158 - val_accuracy: 0.9451
Confusion matrix: 
 [[741  23]
 [ 21  16]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.568 0.432]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.11
Validation accuracy: 94.51
Validation recall: 43.24
Validation precision: 41.03
Validation AUC: 0.4741839948829929
Validation class accuracies: [0.9698952879581152, 0.43243243243243246]
Saving model...
Epoch 14/65
296/296 - 443s - loss: 0.1730 - accuracy: 0.9167 - val_loss: 0.1974 - val_accuracy: 0.9363
Confusion matrix: 
 [[732  32]
 [ 19  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.514 0.486]]
Validation f1: 41.38
Validation accuracy: 93.63
Validation recall: 48.65
Validation precision: 36.00
Validation AUC: 0.4934286551720419
Validation class accuracies: [0.9581151832460733, 0.4864864864864865]
The validation tracker metric at 0.42105263157894735 hasn't increased by 0 in 1 epochs
Epoch 15/65
296/296 - 443s - loss: 0.2026 - accuracy: 0.9155 - val_loss: 2.9253 - val_accuracy: 0.3870
Confusion matrix: 
 [[275 489]
 [  2  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.36  0.64 ]
 [0.054 0.946]]
Validation f1: 12.48
Validation accuracy: 38.70
Validation recall: 94.59
Validation precision: 6.68
Validation AUC: 0.3810139256639018
Validation class accuracies: [0.3599476439790576, 0.9459459459459459]
The validation tracker metric at 0.42105263157894735 hasn't increased by 0 in 2 epochs
Epoch 16/65
296/296 - 443s - loss: 0.1358 - accuracy: 0.9281 - val_loss: 0.3394 - val_accuracy: 0.8839
Confusion matrix: 
 [[681  83]
 [ 10  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.891 0.109]
 [0.27  0.73 ]]
Validation f1: 36.73
Validation accuracy: 88.39
Validation recall: 72.97
Validation precision: 24.55
Validation AUC: 0.5317079252536986
Validation class accuracies: [0.8913612565445026, 0.7297297297297297]
The validation tracker metric at 0.42105263157894735 hasn't increased by 0 in 3 epochs
Epoch 17/65
296/296 - 444s - loss: 0.1701 - accuracy: 0.9269 - val_loss: 0.1526 - val_accuracy: 0.9551
Confusion matrix: 
 [[746  18]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.486 0.514]]
Validation f1: 51.35
Validation accuracy: 95.51
Validation recall: 51.35
Validation precision: 51.35
Validation AUC: 0.593243242303398
Validation class accuracies: [0.9764397905759162, 0.5135135135135135]
Saving model...
Epoch 18/65
296/296 - 443s - loss: 0.1433 - accuracy: 0.9326 - val_loss: 0.2917 - val_accuracy: 0.9001
Confusion matrix: 
 [[697  67]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.912 0.088]
 [0.351 0.649]]
Validation f1: 37.50
Validation accuracy: 90.01
Validation recall: 64.86
Validation precision: 26.37
Validation AUC: 0.4083618413046888
Validation class accuracies: [0.912303664921466, 0.6486486486486487]
The validation tracker metric at 0.5135135135135135 hasn't increased by 0 in 1 epochs
Epoch 19/65
296/296 - 443s - loss: 0.1065 - accuracy: 0.9497 - val_loss: 0.9441 - val_accuracy: 0.7578
Confusion matrix: 
 [[580 184]
 [ 10  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.759 0.241]
 [0.27  0.73 ]]
Validation f1: 21.77
Validation accuracy: 75.78
Validation recall: 72.97
Validation precision: 12.80
Validation AUC: 0.29086328255200616
Validation class accuracies: [0.7591623036649214, 0.7297297297297297]
The validation tracker metric at 0.5135135135135135 hasn't increased by 0 in 2 epochs
Epoch 20/65
296/296 - 443s - loss: 0.0937 - accuracy: 0.9522 - val_loss: 0.2748 - val_accuracy: 0.9201
Confusion matrix: 
 [[713  51]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.933 0.067]
 [0.351 0.649]]
Validation f1: 42.86
Validation accuracy: 92.01
Validation recall: 64.86
Validation precision: 32.00
Validation AUC: 0.5028901758271409
Validation class accuracies: [0.9332460732984293, 0.6486486486486487]
The validation tracker metric at 0.5135135135135135 hasn't increased by 0 in 3 epochs
Epoch 21/65
296/296 - 443s - loss: 0.0750 - accuracy: 0.9653 - val_loss: 0.2025 - val_accuracy: 0.9563
Confusion matrix: 
 [[746  18]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.459 0.541]]
Validation f1: 53.33
Validation accuracy: 95.63
Validation recall: 54.05
Validation precision: 52.63
Validation AUC: 0.5654745337386066
Validation class accuracies: [0.9764397905759162, 0.5405405405405406]
Saving model...
Epoch 22/65
296/296 - 443s - loss: 0.0441 - accuracy: 0.9799 - val_loss: 0.2523 - val_accuracy: 0.9376
Confusion matrix: 
 [[730  34]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.432 0.568]]
Validation f1: 45.65
Validation accuracy: 93.76
Validation recall: 56.76
Validation precision: 38.18
Validation AUC: 0.48662784185754465
Validation class accuracies: [0.9554973821989529, 0.5675675675675675]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 1 epochs
Epoch 23/65
296/296 - 443s - loss: 0.0523 - accuracy: 0.9787 - val_loss: 0.2891 - val_accuracy: 0.9338
Confusion matrix: 
 [[730  34]
 [ 19  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.514 0.486]]
Validation f1: 40.45
Validation accuracy: 93.38
Validation recall: 48.65
Validation precision: 34.62
Validation AUC: 0.42897082930826064
Validation class accuracies: [0.9554973821989529, 0.4864864864864865]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 2 epochs
Epoch 24/65
296/296 - 443s - loss: 0.0361 - accuracy: 0.9865 - val_loss: 0.7388 - val_accuracy: 0.8365
Confusion matrix: 
 [[647 117]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.847 0.153]
 [0.378 0.622]]
Validation f1: 25.99
Validation accuracy: 83.65
Validation recall: 62.16
Validation precision: 16.43
Validation AUC: 0.23269075259028268
Validation class accuracies: [0.8468586387434555, 0.6216216216216216]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 3 epochs
Epoch 25/65
296/296 - 443s - loss: 0.1710 - accuracy: 0.9434 - val_loss: 0.4085 - val_accuracy: 0.8764
Confusion matrix: 
 [[684  80]
 [ 19  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.514 0.486]]
Validation f1: 26.67
Validation accuracy: 87.64
Validation recall: 48.65
Validation precision: 18.37
Validation AUC: 0.38548367864187383
Validation class accuracies: [0.8952879581151832, 0.4864864864864865]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 4 epochs
Epoch 26/65
296/296 - 443s - loss: 0.0796 - accuracy: 0.9687 - val_loss: 0.4977 - val_accuracy: 0.8702
Confusion matrix: 
 [[680  84]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.541 0.459]]
Validation f1: 24.64
Validation accuracy: 87.02
Validation recall: 45.95
Validation precision: 16.83
Validation AUC: 0.27178053252994566
Validation class accuracies: [0.8900523560209425, 0.4594594594594595]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 5 epochs
Epoch 27/65
296/296 - 443s - loss: 0.0419 - accuracy: 0.9829 - val_loss: 0.8882 - val_accuracy: 0.7928
Confusion matrix: 
 [[618 146]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.809 0.191]
 [0.541 0.459]]
Validation f1: 17.00
Validation accuracy: 79.28
Validation recall: 45.95
Validation precision: 10.43
Validation AUC: 0.2332627294517097
Validation class accuracies: [0.8089005235602095, 0.4594594594594595]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 28/65
296/296 - 443s - loss: 0.0328 - accuracy: 0.9842 - val_loss: 0.2915 - val_accuracy: 0.9276
Confusion matrix: 
 [[724  40]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.486 0.514]]
Validation f1: 39.58
Validation accuracy: 92.76
Validation recall: 51.35
Validation precision: 32.20
Validation AUC: 0.5069098900675718
Validation class accuracies: [0.9476439790575916, 0.5135135135135135]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 7 epochs
Epoch 29/65
296/296 - 443s - loss: 0.0230 - accuracy: 0.9909 - val_loss: 0.3414 - val_accuracy: 0.9176
Confusion matrix: 
 [[712  52]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.378 0.622]]
Validation f1: 41.07
Validation accuracy: 91.76
Validation recall: 62.16
Validation precision: 30.67
Validation AUC: 0.4720651344417932
Validation class accuracies: [0.9319371727748691, 0.6216216216216216]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 8 epochs
Epoch 30/65
296/296 - 443s - loss: 0.0262 - accuracy: 0.9890 - val_loss: 0.2641 - val_accuracy: 0.9413
Confusion matrix: 
 [[734  30]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.459 0.541]]
Validation f1: 45.98
Validation accuracy: 94.13
Validation recall: 54.05
Validation precision: 40.00
Validation AUC: 0.49232026762054154
Validation class accuracies: [0.9607329842931938, 0.5405405405405406]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 9 epochs
Epoch 31/65
296/296 - 443s - loss: 0.0172 - accuracy: 0.9932 - val_loss: 0.2975 - val_accuracy: 0.9363
Confusion matrix: 
 [[731  33]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.957 0.043]
 [0.486 0.514]]
Validation f1: 42.70
Validation accuracy: 93.63
Validation recall: 51.35
Validation precision: 36.54
Validation AUC: 0.46250247847438875
Validation class accuracies: [0.9568062827225131, 0.5135135135135135]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 10 epochs
Epoch 32/65
296/296 - 443s - loss: 0.0136 - accuracy: 0.9951 - val_loss: 0.3042 - val_accuracy: 0.9313
Confusion matrix: 
 [[726  38]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.95  0.05 ]
 [0.459 0.541]]
Validation f1: 42.11
Validation accuracy: 93.13
Validation recall: 54.05
Validation precision: 34.48
Validation AUC: 0.4393881582673858
Validation class accuracies: [0.9502617801047121, 0.5405405405405406]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 11 epochs
Epoch 33/65
296/296 - 443s - loss: 0.0128 - accuracy: 0.9939 - val_loss: 0.2742 - val_accuracy: 0.9376
Confusion matrix: 
 [[731  33]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.957 0.043]
 [0.459 0.541]]
Validation f1: 44.44
Validation accuracy: 93.76
Validation recall: 54.05
Validation precision: 37.74
Validation AUC: 0.4773342175437634
Validation class accuracies: [0.9568062827225131, 0.5405405405405406]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 34/65
296/296 - 443s - loss: 0.0077 - accuracy: 0.9985 - val_loss: 0.2860 - val_accuracy: 0.9388
Confusion matrix: 
 [[731  33]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.957 0.043]
 [0.432 0.568]]
Validation f1: 46.15
Validation accuracy: 93.88
Validation recall: 56.76
Validation precision: 38.89
Validation AUC: 0.506791684609936
Validation class accuracies: [0.9568062827225131, 0.5675675675675675]
The validation tracker metric at 0.5333333333333333 hasn't increased by 0 in 13 epochs
Epoch 35/65
296/296 - 443s - loss: 0.0100 - accuracy: 0.9985 - val_loss: 0.2556 - val_accuracy: 0.9551
Confusion matrix: 
 [[744  20]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.432 0.568]]
Validation f1: 53.85
Validation accuracy: 95.51
Validation recall: 56.76
Validation precision: 51.22
Validation AUC: 0.5462100498546927
Validation class accuracies: [0.9738219895287958, 0.5675675675675675]
Saving model...
Epoch 36/65
296/296 - 443s - loss: 0.0100 - accuracy: 0.9975 - val_loss: 0.3174 - val_accuracy: 0.9338
Confusion matrix: 
 [[728  36]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.01
Validation accuracy: 93.38
Validation recall: 54.05
Validation precision: 35.71
Validation AUC: 0.4573784967709706
Validation class accuracies: [0.9528795811518325, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 1 epochs
Epoch 37/65
296/296 - 443s - loss: 0.0057 - accuracy: 0.9985 - val_loss: 0.3019 - val_accuracy: 0.9401
Confusion matrix: 
 [[734  30]
 [ 18  19]]
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.486 0.514]]
Validation f1: 44.19
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.01
Validation recall: 51.35
Validation precision: 38.78
Validation AUC: 0.45234452377383383
Validation class accuracies: [0.9607329842931938, 0.5135135135135135]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 2 epochs
Epoch 38/65
296/296 - 443s - loss: 0.0085 - accuracy: 0.9983 - val_loss: 0.3867 - val_accuracy: 0.9376
Confusion matrix: 
 [[732  32]
 [ 18  19]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.486 0.514]]
Validation f1: 43.18
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.76
Validation recall: 51.35
Validation precision: 37.25
Validation AUC: 0.38976733009174813
Validation class accuracies: [0.9581151832460733, 0.5135135135135135]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 3 epochs
Epoch 39/65
296/296 - 442s - loss: 0.0094 - accuracy: 0.9958 - val_loss: 0.3072 - val_accuracy: 0.9463
Confusion matrix: 
 [[739  25]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.486 0.514]]
Validation f1: 46.91
Validation accuracy: 94.63
Validation recall: 51.35
Validation precision: 43.18
Validation AUC: 0.48980056837562336
Validation class accuracies: [0.9672774869109948, 0.5135135135135135]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 4 epochs
Epoch 40/65
296/296 - 443s - loss: 0.0048 - accuracy: 0.9987 - val_loss: 0.2785 - val_accuracy: 0.9488
Confusion matrix: 
 [[740  24]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.459 0.541]]
Validation f1: 49.38
Validation accuracy: 94.88
Validation recall: 54.05
Validation precision: 45.45
Validation AUC: 0.525438457501141
Validation class accuracies: [0.9685863874345549, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 5 epochs
Epoch 41/65
296/296 - 443s - loss: 0.0065 - accuracy: 0.9989 - val_loss: 0.3090 - val_accuracy: 0.9426
Confusion matrix: 
 [[735  29]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.459 0.541]]
Validation f1: 46.51
Validation accuracy: 94.26
Validation recall: 54.05
Validation precision: 40.82
Validation AUC: 0.5044907038899508
Validation class accuracies: [0.9620418848167539, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 42/65
296/296 - 443s - loss: 0.0049 - accuracy: 0.9979 - val_loss: 0.3212 - val_accuracy: 0.9326
Confusion matrix: 
 [[727  37]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.952 0.048]
 [0.459 0.541]]
Validation f1: 42.55
Validation accuracy: 93.26
Validation recall: 54.05
Validation precision: 35.09
Validation AUC: 0.5161743769517986
Validation class accuracies: [0.9515706806282722, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 7 epochs
Epoch 43/65
296/296 - 443s - loss: 0.0051 - accuracy: 0.9989 - val_loss: 0.3194 - val_accuracy: 0.9413
Confusion matrix: 
 [[734  30]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.98
Validation accuracy: 94.13
Validation recall: 54.05
Validation precision: 40.00
Validation AUC: 0.48896617251739966
Validation class accuracies: [0.9607329842931938, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 8 epochs
Epoch 44/65
296/296 - 444s - loss: 0.0088 - accuracy: 0.9983 - val_loss: 0.3471 - val_accuracy: 0.9363
Confusion matrix: 
 [[730  34]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.459 0.541]]
Validation f1: 43.96
Validation accuracy: 93.63
Validation recall: 54.05
Validation precision: 37.04
Validation AUC: 0.5374944846202235
Validation class accuracies: [0.9554973821989529, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 9 epochs
Epoch 45/65
296/296 - 444s - loss: 0.0045 - accuracy: 0.9989 - val_loss: 0.2792 - val_accuracy: 0.9513
Confusion matrix: 
 [[742  22]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.971 0.029]
 [0.459 0.541]]
Validation f1: 50.63
Validation accuracy: 95.13
Validation recall: 54.05
Validation precision: 47.62
Validation AUC: 0.5319783773222088
Validation class accuracies: [0.9712041884816754, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 10 epochs
Epoch 46/65
296/296 - 444s - loss: 0.0089 - accuracy: 0.9987 - val_loss: 0.3607 - val_accuracy: 0.9338
Confusion matrix: 
 [[728  36]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.01
Validation accuracy: 93.38
Validation recall: 54.05
Validation precision: 35.71
Validation AUC: 0.45360231850068455
Validation class accuracies: [0.9528795811518325, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 11 epochs
Epoch 47/65
296/296 - 445s - loss: 0.0049 - accuracy: 0.9981 - val_loss: 0.3179 - val_accuracy: 0.9413
Confusion matrix: 
 [[734  30]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.98
Validation accuracy: 94.13
Validation recall: 54.05
Validation precision: 40.00
Validation AUC: 0.4977761629890132
Validation class accuracies: [0.9607329842931938, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 48/65
296/296 - 445s - loss: 0.0046 - accuracy: 0.9987 - val_loss: 0.3366 - val_accuracy: 0.9363
Confusion matrix: 
 [[730  34]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.96
Validation accuracy: 93.63
Validation recall: 54.05
Validation precision: 37.04
Validation AUC: 0.49810901969136223
Validation class accuracies: [0.9554973821989529, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 13 epochs
Epoch 49/65
296/296 - 445s - loss: 0.0040 - accuracy: 0.9985 - val_loss: 0.3192 - val_accuracy: 0.9413
Confusion matrix: 
 [[734  30]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.98
Validation accuracy: 94.13
Validation recall: 54.05
Validation precision: 40.00
Validation AUC: 0.5016263642540967
Validation class accuracies: [0.9607329842931938, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 14 epochs
Epoch 50/65
296/296 - 444s - loss: 0.0050 - accuracy: 0.9992 - val_loss: 0.3442 - val_accuracy: 0.9376
Confusion matrix: 
 [[731  33]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.957 0.043]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.44
Validation accuracy: 93.76
Validation recall: 54.05
Validation precision: 37.74
Validation AUC: 0.48631777033689644
Validation class accuracies: [0.9568062827225131, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 15 epochs
Epoch 51/65
296/296 - 445s - loss: 0.0042 - accuracy: 0.9992 - val_loss: 0.3304 - val_accuracy: 0.9401
Confusion matrix: 
 [[733  31]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.959 0.041]
 [0.459 0.541]]
Validation f1: 45.45
Validation accuracy: 94.01
Validation recall: 54.05
Validation precision: 39.22
Validation AUC: 0.49838448709599187
Validation class accuracies: [0.9594240837696335, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 16 epochs
Epoch 52/65
296/296 - 444s - loss: 0.0037 - accuracy: 0.9989 - val_loss: 0.3154 - val_accuracy: 0.9438
Confusion matrix: 
 [[736  28]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.06
Validation accuracy: 94.38
Validation recall: 54.05
Validation precision: 41.67
Validation AUC: 0.5026735628958606
Validation class accuracies: [0.9633507853403142, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 17 epochs
Epoch 53/65
296/296 - 445s - loss: 0.0036 - accuracy: 0.9992 - val_loss: 0.3037 - val_accuracy: 0.9463
Confusion matrix: 
 [[738  26]
 [ 17  20]]
Normalized Confusion matrix: 
 [[0.966 0.034]
 [0.459 0.541]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.19
Validation accuracy: 94.63
Validation recall: 54.05
Validation precision: 43.48
Validation AUC: 0.5160939500809704
Validation class accuracies: [0.9659685863874345, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 54/65
296/296 - 444s - loss: 0.0039 - accuracy: 0.9985 - val_loss: 0.3098 - val_accuracy: 0.9451
Confusion matrix: 
 [[737  27]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.459 0.541]]
Validation f1: 47.62
Validation accuracy: 94.51
Validation recall: 54.05
Validation precision: 42.55
Validation AUC: 0.507719709238299
Validation class accuracies: [0.9646596858638743, 0.5405405405405406]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 19 epochs
Epoch 55/65
296/296 - 444s - loss: 0.0034 - accuracy: 0.9992 - val_loss: 0.3088 - val_accuracy: 0.9476
Confusion matrix: 
 [[739  25]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.459 0.541]]
Validation f1: 48.78
Validation accuracy: 94.76
Validation recall: 54.05
Validation precision: 44.44
Validation AUC: 0.5085989907875346
Validation class accuracies: [0.9672774869109948, 0.5405405405405406]

The metrics for job 3 with the best target metric are: 
Best cm: [[744  20]
 [ 16  21]]
Best normalized cm: [[0.974 0.026]
 [0.432 0.568]]
Best f1: 0.54
Best accuracy: 0.96
Best recall: 0.57
Best precision: 0.51
Best AUC: 0.55
Best class accuracies: [0.9738219895287958, 0.5675675675675675]
Best epoch: 35
The number of epochs since last 1% equals the patience
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_219_2b2_Tc_mc_LittC2SE_3_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_2b3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[3.505e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[2.266e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_221_2b1_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP94_N,N,P L L,24,M_0_label_0_pred_0.png, [[4.29e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP78_Asthma,E W,P R M,20,M_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_2_label_1_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_222_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[3.817e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_204_2b5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_2b3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.321]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_221_2b3_Ar_mc_LittC2SE_0_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP96_N,N,P R L ,66,F_2_label_0_pred_0.png, [[1.65e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_203_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[1.932e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_219_2b2_Ar_mc_LittC2SE_3_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP46_asthma,E W,P L U,41,F_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP80_asthma,E W,A L U,38,M_2_label_0_pred_0.png, [[7.471e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_222_1b1_Lr_sc_Meditron_7_label_0_pred_0.png, [[2.388e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_2b3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_205_1b3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[6.645e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP96_N,N,P R L ,66,F_0_label_0_pred_0.png, [[8.255e-08]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_220_1b2_Al_mc_LittC2SE_0_label_0_pred_0.png, [[2.261e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP83_N,N,A R U,18,F_3_label_0_pred_0.png, [[1.64e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_223_1b1_Al_sc_Meditron_2_label_0_pred_0.png, [[7.156e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_3b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.452e-07]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_3b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[3.037e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_221_2b3_Pr_mc_LittC2SE_0_label_0_pred_1.png, [[0.947]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[7.491e-08]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_219_2b1_Tc_mc_LittC2SE_3_label_1_pred_1.png, [[0.993]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP5_Heart Failure + COPD,I C E W,P L R ,71,M_0_label_0_pred_1.png, [[0.871]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_2b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[1.007e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_221_2b2_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[7.134e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_223_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP90_heart failure,Crep,P L M,74,F_1_label_0_pred_0.png, [[9.003e-07]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP66_heart failure,Crep,P R L ,43,M_1_label_0_pred_0.png, [[3.222e-07]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP58_asthma,E W,P L M,40,M_2_label_0_pred_0.png, [[4.87e-07]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[3.418e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP75_N,N,P L U,73,F_3_label_0_pred_0.png, [[5.991e-10]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_224_1b2_Al_sc_Meditron_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1b1_Al_sc_Meditron_13_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_218_1p1_Ar_sc_Litt3200_2_label_0_pred_0.png, [[1.764e-07]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/jordan_EP79_asthma,E W,A R U,46,M_0_label_0_pred_0.png, [[7.76e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_204_7p5_Ll_mc_AKGC417L_0_label_0_pred_0.png, [[6.622e-06]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/3/icbhi_207_3b2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[1.481e-06]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 29412
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_114032-1337b2kf/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_114032-1337b2kf/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99915
wandb:         val_accuracy 0.94757
wandb:             _runtime 25399
wandb:           _timestamp 1624560231
wandb:                _step 414
wandb:           train_loss 0.00342
wandb:             val_loss 0.3088
wandb:           val_recall 0.54054
wandb:        val_precision 0.44444
wandb:               val_f1 0.4878
wandb:              val_auc 0.5086
wandb:                   lr 3e-05
wandb:          best_val_f1 0.53846
wandb:    best_val_accuracy 0.95506
wandb:   best_val_precision 0.5122
wandb:      best_val_recall 0.56757
wandb:             best_auc 0.54621
wandb:           best_epoch 35
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_114032-1337b2kf

-----------------------
Model 9 with new params
Changing augmentation to time/frequency masking
Audio Augmentation Parameters: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Spec Augmentation Parameters: {'ADD': 1, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 937
-----------------------
Number of train recordings: 3208 with pneumonia: 162 and non-pneumonia: 3046
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_8
Length of training samples after spec augmentation: 3370
-----------------------
Number of train recordings: 3370 with pneumonia: 324 and non-pneumonia: 3046
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_9
Length of training samples after spec augmentation: 3970
-----------------------
Number of train recordings: 3970 with pneumonia: 324 and non-pneumonia: 3646
Number of val recordings: 801 with pneumonia: 37 and non-pneumonia: 764
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_5 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_24 (BatchNormal (None, 128, 1250, 1)    4            input_5[0][0]                        
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_20[0][0]                      
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_22[0][0]                      
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_4[0][0]                
______________________________________________________________________________________________________________
concatenate_4 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_21[0][0]                      
                                                                         conv2d_23[0][0]                      
                                                                         conv2d_24[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_20 (AveragePoolin (None, 64, 625, 48)     0            concatenate_4[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_25 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_20[0][0]           
______________________________________________________________________________________________________________
dropout_20 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_25[0][0]         
______________________________________________________________________________________________________________
inverted_residual_40 (InvertedResid (None, 64, 625, 32)     35840        dropout_20[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_41 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_40[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_21 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_41[0][0]           
______________________________________________________________________________________________________________
batch_normalization_26 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_21[0][0]           
______________________________________________________________________________________________________________
dropout_21 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_26[0][0]         
______________________________________________________________________________________________________________
inverted_residual_42 (InvertedResid (None, 32, 312, 64)     27136        dropout_21[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_43 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_42[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_22 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_43[0][0]           
______________________________________________________________________________________________________________
batch_normalization_27 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_22[0][0]           
______________________________________________________________________________________________________________
dropout_22 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_27[0][0]         
______________________________________________________________________________________________________________
inverted_residual_44 (InvertedResid (None, 16, 156, 128)    91136        dropout_22[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_45 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_44[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_23 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_45[0][0]           
______________________________________________________________________________________________________________
batch_normalization_28 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_23[0][0]           
______________________________________________________________________________________________________________
dropout_23 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_28[0][0]         
______________________________________________________________________________________________________________
inverted_residual_46 (InvertedResid (None, 8, 78, 256)      329728       dropout_23[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_47 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_46[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_24 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_47[0][0]           
______________________________________________________________________________________________________________
batch_normalization_29 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_24[0][0]           
______________________________________________________________________________________________________________
dropout_24 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_29[0][0]         
______________________________________________________________________________________________________________
inverted_residual_48 (InvertedResid (None, 4, 39, 512)      1249280      dropout_24[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_49 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_48[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_4 (GlobalA (None, 512)             0            inverted_residual_49[0][0]           
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 1)               513          global_average_pooling2d_4[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
249/249 - 375s - loss: 1.2705 - accuracy: 0.4748 - val_loss: 0.3882 - val_accuracy: 0.9538
Confusion matrix: 
 [[764   0]
 [ 37   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 95.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.050104056301896
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
249/249 - 373s - loss: 0.6400 - accuracy: 0.6028 - val_loss: 0.1989 - val_accuracy: 0.9501
Confusion matrix: 
 [[761   3]
 [ 37   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.996 0.004]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 95.01
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.057231870256662404
Validation class accuracies: [0.9960732984293194, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
249/249 - 374s - loss: 0.5560 - accuracy: 0.6710 - val_loss: 0.3353 - val_accuracy: 0.9338
Confusion matrix: 
 [[739  25]
 [ 28   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.757 0.243]]
Validation f1: 25.35
Validation accuracy: 93.38
Validation recall: 24.32
Validation precision: 26.47
Validation AUC: 0.22185278175421205
Validation class accuracies: [0.9672774869109948, 0.24324324324324326]
Saving model...
Epoch 4/65
249/249 - 374s - loss: 0.5551 - accuracy: 0.7010 - val_loss: 0.6349 - val_accuracy: 0.6517
Confusion matrix: 
 [[498 266]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.652 0.348]
 [0.351 0.649]]
Validation f1: 14.68
Validation accuracy: 65.17
Validation recall: 64.86
Validation precision: 8.28
Validation AUC: 0.38835158299216604
Validation class accuracies: [0.6518324607329843, 0.6486486486486487]
The validation tracker metric at 0.25352112676056343 hasn't increased by 0 in 1 epochs
Epoch 5/65
249/249 - 374s - loss: 0.5372 - accuracy: 0.6972 - val_loss: 0.6107 - val_accuracy: 0.7278
Confusion matrix: 
 [[554 210]
 [  8  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.725 0.275]
 [0.216 0.784]]
Validation f1: 21.01
Validation accuracy: 72.78
Validation recall: 78.38
Validation precision: 12.13
Validation AUC: 0.549628996795504
Validation class accuracies: [0.725130890052356, 0.7837837837837838]
The validation tracker metric at 0.25352112676056343 hasn't increased by 0 in 2 epochs
Epoch 6/65
249/249 - 374s - loss: 0.5286 - accuracy: 0.6904 - val_loss: 1.5178 - val_accuracy: 0.4719
Confusion matrix: 
 [[346 418]
 [  5  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.453 0.547]
 [0.135 0.865]]
Validation f1: 13.14
Validation accuracy: 47.19
Validation recall: 86.49
Validation precision: 7.11
Validation AUC: 0.3517552436173234
Validation class accuracies: [0.45287958115183247, 0.8648648648648649]
The validation tracker metric at 0.25352112676056343 hasn't increased by 0 in 3 epochs
Epoch 7/65
249/249 - 374s - loss: 0.4364 - accuracy: 0.7552 - val_loss: 1.1083 - val_accuracy: 0.4669
Confusion matrix: 
 [[338 426]
 [  1  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.442 0.558]
 [0.027 0.973]]
Validation f1: 14.43
Validation accuracy: 46.69
Validation recall: 97.30
Validation precision: 7.79
Validation AUC: 0.3678100809180174
Validation class accuracies: [0.4424083769633508, 0.972972972972973]
The validation tracker metric at 0.25352112676056343 hasn't increased by 0 in 4 epochs
Epoch 8/65
249/249 - 374s - loss: 0.4275 - accuracy: 0.7851 - val_loss: 6.2544 - val_accuracy: 0.1985
Confusion matrix: 
 [[123 641]
 [  1  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.161 0.839]
 [0.027 0.973]]
Validation f1: 10.08
Validation accuracy: 19.85
Validation recall: 97.30
Validation precision: 5.32
Validation AUC: 0.3508620376057708
Validation class accuracies: [0.16099476439790575, 0.972972972972973]
The validation tracker metric at 0.25352112676056343 hasn't increased by 0 in 5 epochs
Epoch 9/65
249/249 - 373s - loss: 0.3774 - accuracy: 0.8118 - val_loss: 1.1552 - val_accuracy: 0.6492
Confusion matrix: 
 [[499 265]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.653 0.347]
 [0.432 0.568]]
Validation f1: 13.00
Validation accuracy: 64.92
Validation recall: 56.76
Validation precision: 7.34
Validation AUC: 0.1992490252429491
Validation class accuracies: [0.6531413612565445, 0.5675675675675675]
The validation tracker metric at 0.25352112676056343 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 10/65
249/249 - 377s - loss: 0.3186 - accuracy: 0.8368 - val_loss: 0.4479 - val_accuracy: 0.8464
Confusion matrix: 
 [[656 108]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.405 0.595]]
Validation f1: 26.35
Validation accuracy: 84.64
Validation recall: 59.46
Validation precision: 16.92
Validation AUC: 0.4185316541482792
Validation class accuracies: [0.8586387434554974, 0.5945945945945946]
Saving model...
Epoch 11/65
249/249 - 377s - loss: 0.2616 - accuracy: 0.8680 - val_loss: 1.3964 - val_accuracy: 0.6342
Confusion matrix: 
 [[474 290]
 [  3  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.62  0.38 ]
 [0.081 0.919]]
Validation f1: 18.84
Validation accuracy: 63.42
Validation recall: 91.89
Validation precision: 10.49
Validation AUC: 0.44480471153186835
Validation class accuracies: [0.6204188481675392, 0.918918918918919]
The validation tracker metric at 0.2634730538922156 hasn't increased by 0 in 1 epochs
Epoch 12/65
249/249 - 377s - loss: 0.2670 - accuracy: 0.8610 - val_loss: 1.0117 - val_accuracy: 0.6792
Confusion matrix: 
 [[508 256]
 [  1  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.665 0.335]
 [0.027 0.973]]
Validation f1: 21.88
Validation accuracy: 67.92
Validation recall: 97.30
Validation precision: 12.33
Validation AUC: 0.4643059819569795
Validation class accuracies: [0.6649214659685864, 0.972972972972973]
The validation tracker metric at 0.2634730538922156 hasn't increased by 0 in 2 epochs
Epoch 13/65
249/249 - 377s - loss: 0.2605 - accuracy: 0.8758 - val_loss: 0.2341 - val_accuracy: 0.9326
Confusion matrix: 
 [[733  31]
 [ 23  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.959 0.041]
 [0.622 0.378]]
Validation f1: 34.15
Validation accuracy: 93.26
Validation recall: 37.84
Validation precision: 31.11
Validation AUC: 0.3460259596647926
Validation class accuracies: [0.9594240837696335, 0.3783783783783784]
Saving model...
Epoch 14/65
249/249 - 374s - loss: 0.2235 - accuracy: 0.8907 - val_loss: 0.5319 - val_accuracy: 0.8489
Confusion matrix: 
 [[650 114]
 [  7  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.851 0.149]
 [0.189 0.811]]
Validation f1: 33.15
Validation accuracy: 84.89
Validation recall: 81.08
Validation precision: 20.83
Validation AUC: 0.47061901821697055
Validation class accuracies: [0.8507853403141361, 0.8108108108108109]
The validation tracker metric at 0.34146341463414637 hasn't increased by 0 in 1 epochs
Epoch 15/65
249/249 - 374s - loss: 0.2067 - accuracy: 0.8977 - val_loss: 0.2802 - val_accuracy: 0.8989
Confusion matrix: 
 [[700  64]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.459 0.541]]
Validation f1: 33.06
Validation accuracy: 89.89
Validation recall: 54.05
Validation precision: 23.81
Validation AUC: 0.4678227419766114
Validation class accuracies: [0.9162303664921466, 0.5405405405405406]
The validation tracker metric at 0.34146341463414637 hasn't increased by 0 in 2 epochs
Epoch 16/65
249/249 - 375s - loss: 0.1937 - accuracy: 0.9040 - val_loss: 0.3562 - val_accuracy: 0.8976
Confusion matrix: 
 [[698  66]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.432 0.568]]
Validation f1: 33.87
Validation accuracy: 89.76
Validation recall: 56.76
Validation precision: 24.14
Validation AUC: 0.35052008841312404
Validation class accuracies: [0.9136125654450262, 0.5675675675675675]
The validation tracker metric at 0.34146341463414637 hasn't increased by 0 in 3 epochs
Epoch 17/65
249/249 - 374s - loss: 0.2127 - accuracy: 0.8967 - val_loss: 0.6734 - val_accuracy: 0.7778
Confusion matrix: 
 [[596 168]
 [ 10  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78 0.22]
 [0.27 0.73]]
Validation f1: 23.28
Validation accuracy: 77.78
Validation recall: 72.97
Validation precision: 13.85
Validation AUC: 0.41840063755750995
Validation class accuracies: [0.7801047120418848, 0.7297297297297297]
The validation tracker metric at 0.34146341463414637 hasn't increased by 0 in 4 epochs
Epoch 18/65
249/249 - 375s - loss: 0.1460 - accuracy: 0.9322 - val_loss: 1.0232 - val_accuracy: 0.7403
Confusion matrix: 
 [[561 203]
 [  5  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.734 0.266]
 [0.135 0.865]]
Validation f1: 23.53
Validation accuracy: 74.03
Validation recall: 86.49
Validation precision: 13.62
Validation AUC: 0.42301413326486426
Validation class accuracies: [0.7342931937172775, 0.8648648648648649]
The validation tracker metric at 0.34146341463414637 hasn't increased by 0 in 5 epochs
Epoch 19/65
249/249 - 374s - loss: 0.1344 - accuracy: 0.9385 - val_loss: 0.2459 - val_accuracy: 0.9213
Confusion matrix: 
 [[714  50]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.351 0.649]]
Validation f1: 43.24
Validation accuracy: 92.13
Validation recall: 64.86
Validation precision: 32.43
Validation AUC: 0.5667868445250713
Validation class accuracies: [0.9345549738219895, 0.6486486486486487]
Saving model...
Epoch 20/65
249/249 - 374s - loss: 0.2094 - accuracy: 0.9123 - val_loss: 1.0085 - val_accuracy: 0.7591
Confusion matrix: 
 [[575 189]
 [  4  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.753 0.247]
 [0.108 0.892]]
Validation f1: 25.48
Validation accuracy: 75.91
Validation recall: 89.19
Validation precision: 14.86
Validation AUC: 0.44935778773321206
Validation class accuracies: [0.7526178010471204, 0.8918918918918919]
The validation tracker metric at 0.43243243243243246 hasn't increased by 0 in 1 epochs
Epoch 21/65
249/249 - 374s - loss: 0.1671 - accuracy: 0.9244 - val_loss: 0.5018 - val_accuracy: 0.8614
Confusion matrix: 
 [[663 101]
 [ 10  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.868 0.132]
 [0.27  0.73 ]]
Validation f1: 32.73
Validation accuracy: 86.14
Validation recall: 72.97
Validation precision: 21.09
Validation AUC: 0.45198000609143807
Validation class accuracies: [0.8678010471204188, 0.7297297297297297]
The validation tracker metric at 0.43243243243243246 hasn't increased by 0 in 2 epochs
Epoch 22/65
249/249 - 374s - loss: 0.1334 - accuracy: 0.9358 - val_loss: 0.4649 - val_accuracy: 0.8789
Confusion matrix: 
 [[678  86]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.297 0.703]]
Validation f1: 34.90
Validation accuracy: 87.89
Validation recall: 70.27
Validation precision: 23.21
Validation AUC: 0.5099801429906424
Validation class accuracies: [0.887434554973822, 0.7027027027027027]
The validation tracker metric at 0.43243243243243246 hasn't increased by 0 in 3 epochs
Epoch 23/65
249/249 - 375s - loss: 0.0860 - accuracy: 0.9597 - val_loss: 0.7575 - val_accuracy: 0.8177
Confusion matrix: 
 [[625 139]
 [  7  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.189 0.811]]
Validation f1: 29.13
Validation accuracy: 81.77
Validation recall: 81.08
Validation precision: 17.75
Validation AUC: 0.4740743658167006
Validation class accuracies: [0.8180628272251309, 0.8108108108108109]
The validation tracker metric at 0.43243243243243246 hasn't increased by 0 in 4 epochs
Epoch 24/65
249/249 - 375s - loss: 0.1702 - accuracy: 0.9237 - val_loss: 0.1652 - val_accuracy: 0.9376
Confusion matrix: 
 [[729  35]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.954 0.046]
 [0.405 0.595]]
Validation f1: 46.81
Validation accuracy: 93.76
Validation recall: 59.46
Validation precision: 38.60
Validation AUC: 0.5424088628906631
Validation class accuracies: [0.9541884816753927, 0.5945945945945946]
Saving model...
Epoch 25/65
249/249 - 374s - loss: 0.1287 - accuracy: 0.9479 - val_loss: 0.3403 - val_accuracy: 0.9026
Confusion matrix: 
 [[703  61]
 [ 17  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.459 0.541]]
Validation f1: 33.90
Validation accuracy: 90.26
Validation recall: 54.05
Validation precision: 24.69
Validation AUC: 0.428733857616971
Validation class accuracies: [0.9201570680628273, 0.5405405405405406]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 1 epochs
Epoch 26/65
249/249 - 375s - loss: 0.1142 - accuracy: 0.9552 - val_loss: 0.6223 - val_accuracy: 0.8215
Confusion matrix: 
 [[627 137]
 [  6  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.821 0.179]
 [0.162 0.838]]
Validation f1: 30.24
Validation accuracy: 82.15
Validation recall: 83.78
Validation precision: 18.45
Validation AUC: 0.4586665227826934
Validation class accuracies: [0.8206806282722513, 0.8378378378378378]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 2 epochs
Epoch 27/65
249/249 - 375s - loss: 0.0768 - accuracy: 0.9645 - val_loss: 0.6295 - val_accuracy: 0.7865
Confusion matrix: 
 [[601 163]
 [  8  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.216 0.784]]
Validation f1: 25.33
Validation accuracy: 78.65
Validation recall: 78.38
Validation precision: 15.10
Validation AUC: 0.414627234556317
Validation class accuracies: [0.7866492146596858, 0.7837837837837838]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 3 epochs
Epoch 28/65
249/249 - 375s - loss: 0.0710 - accuracy: 0.9705 - val_loss: 0.6122 - val_accuracy: 0.8514
Confusion matrix: 
 [[652 112]
 [  7  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.853 0.147]
 [0.189 0.811]]
Validation f1: 33.52
Validation accuracy: 85.14
Validation recall: 81.08
Validation precision: 21.13
Validation AUC: 0.5147229784617349
Validation class accuracies: [0.8534031413612565, 0.8108108108108109]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 4 epochs
Epoch 29/65
249/249 - 374s - loss: 0.1514 - accuracy: 0.9365 - val_loss: 0.4510 - val_accuracy: 0.8839
Confusion matrix: 
 [[689  75]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.902 0.098]
 [0.486 0.514]]
Validation f1: 29.01
Validation accuracy: 88.39
Validation recall: 51.35
Validation precision: 20.21
Validation AUC: 0.4002556242798832
Validation class accuracies: [0.9018324607329843, 0.5135135135135135]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 5 epochs
Epoch 30/65
249/249 - 375s - loss: 0.1117 - accuracy: 0.9524 - val_loss: 0.7771 - val_accuracy: 0.7803
Confusion matrix: 
 [[596 168]
 [  8  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.216 0.784]]
Validation f1: 24.79
Validation accuracy: 78.03
Validation recall: 78.38
Validation precision: 14.72
Validation AUC: 0.4140822031646238
Validation class accuracies: [0.7801047120418848, 0.7837837837837838]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 31/65
249/249 - 374s - loss: 0.0786 - accuracy: 0.9678 - val_loss: 0.8740 - val_accuracy: 0.7678
Confusion matrix: 
 [[579 185]
 [  1  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.758 0.242]
 [0.027 0.973]]
Validation f1: 27.91
Validation accuracy: 76.78
Validation recall: 97.30
Validation precision: 16.29
Validation AUC: 0.5740981507843155
Validation class accuracies: [0.7578534031413613, 0.972972972972973]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 7 epochs
Epoch 32/65
249/249 - 375s - loss: 0.0626 - accuracy: 0.9678 - val_loss: 0.1997 - val_accuracy: 0.9488
Confusion matrix: 
 [[742  22]
 [ 19  18]]
Normalized Confusion matrix: 
 [[0.971 0.029]
 [0.514 0.486]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 46.75
Validation accuracy: 94.88
Validation recall: 48.65
Validation precision: 45.00
Validation AUC: 0.5142531564834817
Validation class accuracies: [0.9712041884816754, 0.4864864864864865]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 8 epochs
Epoch 33/65
249/249 - 374s - loss: 0.0488 - accuracy: 0.9753 - val_loss: 0.2375 - val_accuracy: 0.9301
Confusion matrix: 
 [[726  38]
 [ 18  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.95  0.05 ]
 [0.486 0.514]]
Validation f1: 40.43
Validation accuracy: 93.01
Validation recall: 51.35
Validation precision: 33.33
Validation AUC: 0.5031901525113127
Validation class accuracies: [0.9502617801047121, 0.5135135135135135]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 9 epochs
Epoch 34/65
249/249 - 374s - loss: 0.0433 - accuracy: 0.9801 - val_loss: 0.2152 - val_accuracy: 0.9463
Confusion matrix: 
 [[740  24]
 [ 19  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.514 0.486]]
Validation f1: 45.57
Validation accuracy: 94.63
Validation recall: 48.65
Validation precision: 42.86
Validation AUC: 0.4868175717910394
Validation class accuracies: [0.9685863874345549, 0.4864864864864865]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 10 epochs
Epoch 35/65
249/249 - 375s - loss: 0.0496 - accuracy: 0.9809 - val_loss: 0.2109 - val_accuracy: 0.9526
Confusion matrix: 
 [[746  18]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.541 0.459]]
Validation f1: 47.22
Validation accuracy: 95.26
Validation recall: 45.95
Validation precision: 48.57
Validation AUC: 0.49340614680522976
Validation class accuracies: [0.9764397905759162, 0.4594594594594595]
Saving model...
Epoch 36/65
249/249 - 374s - loss: 0.0401 - accuracy: 0.9849 - val_loss: 0.2693 - val_accuracy: 0.9276
Confusion matrix: 
 [[720  44]
 [ 14  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.378 0.622]]
Validation f1: 44.23
Validation accuracy: 92.76
Validation recall: 62.16
Validation precision: 34.33
Validation AUC: 0.5321663741778331
Validation class accuracies: [0.9424083769633508, 0.6216216216216216]
The validation tracker metric at 0.47222222222222227 hasn't increased by 0 in 1 epochs
Epoch 37/65
249/249 - 375s - loss: 0.0361 - accuracy: 0.9851 - val_loss: 0.2492 - val_accuracy: 0.9438
Confusion matrix: 
 [[729  35]
 [ 10  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.954 0.046]
 [0.27  0.73 ]]
Validation f1: 54.55
Validation accuracy: 94.38
Validation recall: 72.97
Validation precision: 43.55
Validation AUC: 0.5745650976498562
Validation class accuracies: [0.9541884816753927, 0.7297297297297297]
Saving model...
Epoch 38/65
249/249 - 375s - loss: 0.0440 - accuracy: 0.9839 - val_loss: 0.2313 - val_accuracy: 0.9476
Confusion matrix: 
 [[738  26]
 [ 16  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.966 0.034]
 [0.432 0.568]]
Validation f1: 50.00
Validation accuracy: 94.76
Validation recall: 56.76
Validation precision: 44.68
Validation AUC: 0.49522893228076104
Validation class accuracies: [0.9659685863874345, 0.5675675675675675]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 1 epochs
Epoch 39/65
249/249 - 374s - loss: 0.0462 - accuracy: 0.9793 - val_loss: 0.2616 - val_accuracy: 0.9338
Confusion matrix: 
 [[720  44]
 [  9  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.243 0.757]]
Validation f1: 51.38
Validation accuracy: 93.38
Validation recall: 75.68
Validation precision: 38.89
Validation AUC: 0.5685849471985273
Validation class accuracies: [0.9424083769633508, 0.7567567567567568]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 2 epochs
Epoch 40/65
249/249 - 374s - loss: 0.0404 - accuracy: 0.9859 - val_loss: 0.2569 - val_accuracy: 0.9263
Confusion matrix: 
 [[716  48]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.297 0.703]]
Validation f1: 46.85
Validation accuracy: 92.63
Validation recall: 70.27
Validation precision: 35.14
Validation AUC: 0.5889759409101888
Validation class accuracies: [0.93717277486911, 0.7027027027027027]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 3 epochs
Epoch 41/65
249/249 - 374s - loss: 0.0402 - accuracy: 0.9854 - val_loss: 0.2561 - val_accuracy: 0.9363
Confusion matrix: 
 [[726  38]
 [ 13  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.95  0.05 ]
 [0.351 0.649]]
Validation f1: 48.48
Validation accuracy: 93.63
Validation recall: 64.86
Validation precision: 38.71
Validation AUC: 0.5613767246537981
Validation class accuracies: [0.9502617801047121, 0.6486486486486487]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 4 epochs
Epoch 42/65
249/249 - 375s - loss: 0.0243 - accuracy: 0.9917 - val_loss: 0.2921 - val_accuracy: 0.9251
Confusion matrix: 
 [[716  48]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.324 0.676]]
Validation f1: 45.45
Validation accuracy: 92.51
Validation recall: 67.57
Validation precision: 34.25
Validation AUC: 0.5602550024568563
Validation class accuracies: [0.93717277486911, 0.6756756756756757]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 5 epochs
Epoch 43/65
249/249 - 374s - loss: 0.0491 - accuracy: 0.9811 - val_loss: 0.2044 - val_accuracy: 0.9501
Confusion matrix: 
 [[744  20]
 [ 20  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.541 0.459]]
Validation f1: 45.95
Validation accuracy: 95.01
Validation recall: 45.95
Validation precision: 45.95
Validation AUC: 0.5398361615086408
Validation class accuracies: [0.9738219895287958, 0.4594594594594595]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 44/65
249/249 - 375s - loss: 0.0470 - accuracy: 0.9859 - val_loss: 0.2376 - val_accuracy: 0.9376
Confusion matrix: 
 [[728  36]
 [ 14  23]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.378 0.622]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.92
Validation accuracy: 93.76
Validation recall: 62.16
Validation precision: 38.98
Validation AUC: 0.5260225590874327
Validation class accuracies: [0.9528795811518325, 0.6216216216216216]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 7 epochs
Epoch 45/65
249/249 - 374s - loss: 0.0260 - accuracy: 0.9904 - val_loss: 0.2613 - val_accuracy: 0.9326
Confusion matrix: 
 [[722  42]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.945 0.055]
 [0.324 0.676]]
Validation f1: 48.08
Validation accuracy: 93.26
Validation recall: 67.57
Validation precision: 37.31
Validation AUC: 0.5467091453788802
Validation class accuracies: [0.9450261780104712, 0.6756756756756757]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 8 epochs
Epoch 46/65
249/249 - 374s - loss: 0.0288 - accuracy: 0.9907 - val_loss: 0.3131 - val_accuracy: 0.9251
Confusion matrix: 
 [[712  52]
 [  8  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.216 0.784]]
Validation f1: 49.15
Validation accuracy: 92.51
Validation recall: 78.38
Validation precision: 35.80
Validation AUC: 0.5736170357270169
Validation class accuracies: [0.9319371727748691, 0.7837837837837838]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 9 epochs
Epoch 47/65
249/249 - 375s - loss: 0.0285 - accuracy: 0.9849 - val_loss: 0.2486 - val_accuracy: 0.9388
Confusion matrix: 
 [[730  34]
 [ 15  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.405 0.595]]
Validation f1: 47.31
Validation accuracy: 93.88
Validation recall: 59.46
Validation precision: 39.29
Validation AUC: 0.5235754552993398
Validation class accuracies: [0.9554973821989529, 0.5945945945945946]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 10 epochs
Epoch 48/65
249/249 - 374s - loss: 0.0247 - accuracy: 0.9902 - val_loss: 0.2472 - val_accuracy: 0.9401
Confusion matrix: 
 [[728  36]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.324 0.676]]
Validation f1: 51.02
Validation accuracy: 94.01
Validation recall: 67.57
Validation precision: 40.98
Validation AUC: 0.5516417675348935
Validation class accuracies: [0.9528795811518325, 0.6756756756756757]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 11 epochs
Epoch 49/65
249/249 - 374s - loss: 0.0182 - accuracy: 0.9952 - val_loss: 0.2538 - val_accuracy: 0.9363
Confusion matrix: 
 [[726  38]
 [ 13  24]]
Normalized Confusion matrix: 
 [[0.95  0.05 ]
 [0.351 0.649]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.48
Validation accuracy: 93.63
Validation recall: 64.86
Validation precision: 38.71
Validation AUC: 0.5456343452720004
Validation class accuracies: [0.9502617801047121, 0.6486486486486487]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 50/65
249/249 - 375s - loss: 0.0157 - accuracy: 0.9960 - val_loss: 0.2618 - val_accuracy: 0.9401
Confusion matrix: 
 [[727  37]
 [ 11  26]]
Normalized Confusion matrix: 
 [[0.952 0.048]
 [0.297 0.703]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.00
Validation accuracy: 94.01
Validation recall: 70.27
Validation precision: 41.27
Validation AUC: 0.5545547798825851
Validation class accuracies: [0.9515706806282722, 0.7027027027027027]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 13 epochs
Epoch 51/65
249/249 - 374s - loss: 0.0178 - accuracy: 0.9947 - val_loss: 0.2451 - val_accuracy: 0.9426
Confusion matrix: 
 [[730  34]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.324 0.676]]
Validation f1: 52.08
Validation accuracy: 94.26
Validation recall: 67.57
Validation precision: 42.37
Validation AUC: 0.5588498096179969
Validation class accuracies: [0.9554973821989529, 0.6756756756756757]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 14 epochs
Epoch 52/65
249/249 - 374s - loss: 0.0189 - accuracy: 0.9947 - val_loss: 0.2567 - val_accuracy: 0.9426
Confusion matrix: 
 [[730  34]
 [ 12  25]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.324 0.676]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.08
Validation accuracy: 94.26
Validation recall: 67.57
Validation precision: 42.37
Validation AUC: 0.5638414709317393
Validation class accuracies: [0.9554973821989529, 0.6756756756756757]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 15 epochs
Epoch 53/65
249/249 - 374s - loss: 0.0153 - accuracy: 0.9947 - val_loss: 0.2368 - val_accuracy: 0.9463
Confusion matrix: 
 [[733  31]
 [ 12  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.959 0.041]
 [0.324 0.676]]
Validation f1: 53.76
Validation accuracy: 94.63
Validation recall: 67.57
Validation precision: 44.64
Validation AUC: 0.5542261888363451
Validation class accuracies: [0.9594240837696335, 0.6756756756756757]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 16 epochs
Epoch 54/65
249/249 - 375s - loss: 0.0307 - accuracy: 0.9950 - val_loss: 0.2808 - val_accuracy: 0.9376
Confusion matrix: 
 [[723  41]
 [  9  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.243 0.757]]
Validation f1: 52.83
Validation accuracy: 93.76
Validation recall: 75.68
Validation precision: 40.58
Validation AUC: 0.5761120538822809
Validation class accuracies: [0.9463350785340314, 0.7567567567567568]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 17 epochs
Epoch 55/65
249/249 - 374s - loss: 0.0189 - accuracy: 0.9907 - val_loss: 0.2284 - val_accuracy: 0.9438
Confusion matrix: 
 [[729  35]
 [ 10  27]]
Normalized Confusion matrix: 
 [[0.954 0.046]
 [0.27  0.73 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.55
Validation accuracy: 94.38
Validation recall: 72.97
Validation precision: 43.55
Validation AUC: 0.5888776482910726
Validation class accuracies: [0.9541884816753927, 0.7297297297297297]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 56/65
249/249 - 375s - loss: 0.0145 - accuracy: 0.9945 - val_loss: 0.2331 - val_accuracy: 0.9438
Confusion matrix: 
 [[730  34]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.297 0.703]]
Validation f1: 53.61
Validation accuracy: 94.38
Validation recall: 70.27
Validation precision: 43.33
Validation AUC: 0.5780425231792736
Validation class accuracies: [0.9554973821989529, 0.7027027027027027]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 19 epochs
Epoch 57/65
249/249 - 374s - loss: 0.0169 - accuracy: 0.9942 - val_loss: 0.2389 - val_accuracy: 0.9426
Confusion matrix: 
 [[729  35]
 [ 11  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.954 0.046]
 [0.297 0.703]]
Validation f1: 53.06
Validation accuracy: 94.26
Validation recall: 70.27
Validation precision: 42.62
Validation AUC: 0.5701249649891508
Validation class accuracies: [0.9541884816753927, 0.7027027027027027]

The metrics for job 4 with the best target metric are: 
Best cm: [[729  35]
 [ 10  27]]
Best normalized cm: [[0.954 0.046]
 [0.27  0.73 ]]
Best f1: 0.55
Best accuracy: 0.94
Best recall: 0.73
Best precision: 0.44
Best AUC: 0.57
Best class accuracies: [0.9541884816753927, 0.7297297297297297]
Best epoch: 37
The number of epochs since last 1% equals the patience
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_1p2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.074]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_222_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[0.034]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP63_COPD,E W,P R L ,58,F_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_211_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP83_N,N,A R U,18,F_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_216_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[0.031]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_204_7p5_Lr_mc_AKGC417L_3_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[9.232e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_221_2b2_Al_mc_LittC2SE_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP85_N,N,A R U,33,M_0_label_0_pred_0.png, [[0.256]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Al_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_222_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_3b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_1p5_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_3b2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.104]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_1b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.035]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b4_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP57_COPD,E W,P R L ,42,M_2_label_0_pred_0.png, [[0.064]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_223_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_0_label_1_pred_1.png, [[0.925]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_224_1b2_Al_sc_Meditron_1_label_0_pred_0.png, [[0.124]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_215_1b2_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_2b4_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[6.483e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[9.648e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.074]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_219_2b1_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_222_1b1_Lr_sc_Meditron_7_label_0_pred_0.png, [[7.482e-05]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_205_4b2_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP86_N,N,P R U,68,F_0_label_0_pred_0.png, [[0.056]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Al_sc_Meditron_6_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP89_N,N,P L M,70,M_3_label_0_pred_0.png, [[0.058]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP81_N,N,P L U,33,M_1_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_207_2b4_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_218_1b1_Al_sc_Meditron_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP97_Asthma,E W,P R U,24,M_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/jordan_EP4_Heart Failure + Lung Fibrosis ,I C,P L R,72,F_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/4/icbhi_219_2b2_Tc_mc_LittC2SE_3_label_1_pred_1.png, [[0.996]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 27329
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_184425-13ej4wpx/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_184425-13ej4wpx/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99421
wandb:         val_accuracy 0.94257
wandb:             _runtime 22636
wandb:           _timestamp 1624582902
wandb:                _step 419
wandb:           train_loss 0.0169
wandb:             val_loss 0.23895
wandb:           val_recall 0.7027
wandb:        val_precision 0.42623
wandb:               val_f1 0.53061
wandb:              val_auc 0.57012
wandb:                   lr 3e-05
wandb:          best_val_f1 0.54545
wandb:    best_val_accuracy 0.94382
wandb:   best_val_precision 0.43548
wandb:      best_val_recall 0.72973
wandb:             best_auc 0.57457
wandb:           best_epoch 37
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210624_184425-13ej4wpx

-----------------------

 See logs at ../../new_cache/conv__2247__06_2127__v39__icbhi_pneumoniajordan_seaprated/logs/