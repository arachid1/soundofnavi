Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2044
Description:  mod9_labels
2021-04-09 16:41:16.030782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-09 16:41:18.177528: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-09 16:41:18.178637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-09 16:41:18.233278: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.234028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-09 16:41:18.234059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-09 16:41:18.237631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-09 16:41:18.237737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-09 16:41:18.238951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-09 16:41:18.239300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-09 16:41:18.240382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-09 16:41:18.241314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-09 16:41:18.241486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-09 16:41:18.241637: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.242516: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.243195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-09 16:41:18.245369: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-09 16:41:18.245531: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.246250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-09 16:41:18.246274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-09 16:41:18.246304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-09 16:41:18.246319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-09 16:41:18.246333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-09 16:41:18.246347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-09 16:41:18.246374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-09 16:41:18.246388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-09 16:41:18.246402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-09 16:41:18.246468: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.247198: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.247909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-09 16:41:18.247948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-09 16:41:18.991479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-09 16:41:18.991530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-09 16:41:18.991540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-09 16:41:18.991885: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.992768: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.993483: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 16:41:18.994167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-04-09 16:41:19.505081: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-09 16:41:19.505136: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-09 16:41:19.505214: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-09 16:41:19.505489: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-09 16:41:19.506331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-09 16:41:19.704943: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-09 16:41:19.707664: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2044.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_1640___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___mod9_labels___2044/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.8}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        2021-04-09 16:41:20.698320: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-09 16:41:20.700546: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-09 16:41:24.292405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-09 16:41:24.761747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-09 16:41:24.802179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-09 16:41:28.739880: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-09 16:41:28.739934: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-09 16:41:29.999464: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-09 16:41:30.002807: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-09 16:41:30.044829: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 1560 callback api events and 1556 activity events. 
2021-04-09 16:41:30.090248: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.

__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            1026        global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,201,262
Trainable params: 6,159,752
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
872/872 - 709s - loss: 0.5352 - calc_accuracy: 0.5679 - val_loss: 0.6954 - val_calc_accuracy: 0.5709
Epoch 2/40
872/872 - 710s - loss: 0.5255 - calc_accuracy: 0.6713 - val_loss: 0.6879 - val_calc_accuracy: 0.5489
Epoch 3/40
872/872 - 712s - loss: 0.5247 - calc_accuracy: 0.7096 - val_loss: 0.6833 - val_calc_accuracy: 0.7377
Epoch 4/40
872/872 - 713s - loss: 0.5240 - calc_accuracy: 0.7371 - val_loss: 0.6850 - val_calc_accuracy: 0.6414
Epoch 5/40
872/872 - 715s - loss: 0.5234 - calc_accuracy: 0.7642 - val_loss: 0.6825 - val_calc_accuracy: 0.7501
Epoch 6/40
872/872 - 704s - loss: 0.5229 - calc_accuracy: 0.7840 - val_loss: 0.6828 - val_calc_accuracy: 0.7353
Epoch 7/40
872/872 - 714s - loss: 0.5224 - calc_accuracy: 0.8066 - val_loss: 0.7005 - val_calc_accuracy: 0.7551
Epoch 8/40
872/872 - 713s - loss: 0.5222 - calc_accuracy: 0.8169 - val_loss: 0.6790 - val_calc_accuracy: 0.8442
Epoch 9/40
872/872 - 715s - loss: 0.5219 - calc_accuracy: 0.8273 - val_loss: 0.6811 - val_calc_accuracy: 0.7828
Epoch 10/40
872/872 - 707s - loss: 0.5217 - calc_accuracy: 0.8380 - val_loss: 0.6793 - val_calc_accuracy: 0.8351
Epoch 11/40
872/872 - 707s - loss: 0.5215 - calc_accuracy: 0.8483 - val_loss: 0.6776 - val_calc_accuracy: 0.8804
Epoch 12/40
872/872 - 712s - loss: 0.5213 - calc_accuracy: 0.8557 - val_loss: 0.6782 - val_calc_accuracy: 0.8666
Epoch 13/40
872/872 - 711s - loss: 0.5212 - calc_accuracy: 0.8620 - val_loss: 0.6784 - val_calc_accuracy: 0.8715
Epoch 14/40
872/872 - 710s - loss: 0.5209 - calc_accuracy: 0.8764 - val_loss: 0.6785 - val_calc_accuracy: 0.8437

Epoch 00014: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 15/40
872/872 - 713s - loss: 0.5206 - calc_accuracy: 0.8842 - val_loss: 0.6772 - val_calc_accuracy: 0.8882
Epoch 16/40
872/872 - 708s - loss: 0.5205 - calc_accuracy: 0.8915 - val_loss: 0.6778 - val_calc_accuracy: 0.8872
Epoch 17/40
872/872 - 713s - loss: 0.5203 - calc_accuracy: 0.9033 - val_loss: 0.6771 - val_calc_accuracy: 0.8909
Epoch 18/40
872/872 - 711s - loss: 0.5202 - calc_accuracy: 0.9067 - val_loss: 0.6772 - val_calc_accuracy: 0.8936
Epoch 19/40
872/872 - 711s - loss: 0.5200 - calc_accuracy: 0.9161 - val_loss: 0.6790 - val_calc_accuracy: 0.8536
Epoch 20/40
872/872 - 715s - loss: 0.5198 - calc_accuracy: 0.9238 - val_loss: 0.6768 - val_calc_accuracy: 0.9033
Epoch 21/40
872/872 - 708s - loss: 0.5197 - calc_accuracy: 0.9263 - val_loss: 0.6764 - val_calc_accuracy: 0.9174
Epoch 22/40
872/872 - 709s - loss: 0.5197 - calc_accuracy: 0.9282 - val_loss: 0.6768 - val_calc_accuracy: 0.9037
Epoch 23/40
872/872 - 713s - loss: 0.5196 - calc_accuracy: 0.9370 - val_loss: 0.6765 - val_calc_accuracy: 0.9119
Epoch 24/40
872/872 - 706s - loss: 0.5194 - calc_accuracy: 0.9451 - val_loss: 0.6765 - val_calc_accuracy: 0.9168

Epoch 00024: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 25/40
872/872 - 709s - loss: 0.5192 - calc_accuracy: 0.9534 - val_loss: 0.6766 - val_calc_accuracy: 0.9007
Epoch 26/40
872/872 - 713s - loss: 0.5191 - calc_accuracy: 0.9581 - val_loss: 0.6764 - val_calc_accuracy: 0.9170
Epoch 27/40
872/872 - 713s - loss: 0.5190 - calc_accuracy: 0.9634 - val_loss: 0.6767 - val_calc_accuracy: 0.9269
Epoch 28/40
872/872 - 714s - loss: 0.5190 - calc_accuracy: 0.9658 - val_loss: 0.6760 - val_calc_accuracy: 0.9251
Epoch 29/40
872/872 - 713s - loss: 0.5189 - calc_accuracy: 0.9682 - val_loss: 0.6760 - val_calc_accuracy: 0.9194
Epoch 30/40
872/872 - 711s - loss: 0.5188 - calc_accuracy: 0.9726 - val_loss: 0.6761 - val_calc_accuracy: 0.9289
Epoch 31/40
872/872 - 713s - loss: 0.5189 - calc_accuracy: 0.9718 - val_loss: 0.6766 - val_calc_accuracy: 0.9085
Epoch 32/40
872/872 - 712s - loss: 0.5188 - calc_accuracy: 0.9734 - val_loss: 0.6768 - val_calc_accuracy: 0.8967
Epoch 33/40
872/872 - 712s - loss: 0.5187 - calc_accuracy: 0.9781 - val_loss: 0.6761 - val_calc_accuracy: 0.9220

Epoch 00033: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 34/40
872/872 - 711s - loss: 0.5186 - calc_accuracy: 0.9825 - val_loss: 0.6758 - val_calc_accuracy: 0.9320
Epoch 35/40
872/872 - 714s - loss: 0.5186 - calc_accuracy: 0.9838 - val_loss: 0.6758 - val_calc_accuracy: 0.9286
Epoch 36/40
872/872 - 711s - loss: 0.5185 - calc_accuracy: 0.9844 - val_loss: 0.6758 - val_calc_accuracy: 0.9314
Epoch 37/40
872/872 - 712s - loss: 0.5186 - calc_accuracy: 0.9861 - val_loss: 0.6757 - val_calc_accuracy: 0.9309

Epoch 00037: ReduceLROnPlateau reducing learning rate to 0.00031640623637940735.
Epoch 38/40
872/872 - 713s - loss: 0.5185 - calc_accuracy: 0.9887 - val_loss: 0.6759 - val_calc_accuracy: 0.9292
Epoch 39/40
872/872 - 713s - loss: 0.5185 - calc_accuracy: 0.9903 - val_loss: 0.6760 - val_calc_accuracy: 0.9295
Epoch 00039: early stopping

 See logs at ../../cache/conv___04_1640___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___mod9_labels___2044/logs/