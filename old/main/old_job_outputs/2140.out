Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2140
Description:  redo
2021-05-16 15:25:53.411432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-16 15:25:56.032049: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-16 15:25:56.033170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-16 15:25:56.086937: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:25:56.087752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-16 15:25:56.087799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-16 15:25:56.091749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-16 15:25:56.091891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-16 15:25:56.093121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-16 15:25:56.093488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-16 15:25:56.094620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-16 15:25:56.095619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-16 15:25:56.095803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-16 15:25:56.095958: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:25:56.096813: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:25:56.097539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2140.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2140__05_1525__v29__redo/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 4, 'LR': 0.001, 'SHAPE': (6, 128, 1250), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: True and Concat: True
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2140
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/d85eorvg
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210516_152556-d85eorvg
wandb: Run `wandb offline` to turn off syncing.
2021-05-16 15:26:01.939323: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-16 15:26:01.939631: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:26:01.940817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-16 15:26:01.940889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-16 15:26:01.940974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-16 15:26:01.941014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-16 15:26:01.941048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-16 15:26:01.941089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-16 15:26:01.941122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-16 15:26:01.941157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-16 15:26:01.941189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-16 15:26:01.941351: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:26:01.942557: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:26:01.943655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-16 15:26:01.943738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-16 15:26:02.726956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-16 15:26:02.727010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-16 15:26:02.727020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-16 15:26:02.727334: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:26:02.728221: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:26:02.729018: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-16 15:26:02.729768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-16 15:26:43.106589: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-16 15:26:43.107560: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-16 15:26:46.668781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-16 15:26:47.740458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-16 15:26:47.802089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 6, 128, 1250 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 6, 128, 1250) 5000        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 16, 128, 1250 112         batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 16, 128, 1250 112         batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 6, 128, 1250) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 16, 128, 1250 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 16, 128, 1250 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 16, 128, 1250 112         max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 48, 128, 1250 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 48, 64, 625)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 48, 64, 625)  2500        average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 48, 64, 625)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 32, 64, 625)  40908       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 32, 64, 625)  26700       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 32, 312)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 312)  1248        average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 32, 312)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 64, 32, 312)  29088       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 64, 32, 312)  66720       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 64, 16, 156)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 64, 16, 156)  624         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64, 16, 156)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 128, 16, 156) 89424       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 128, 16, 156) 226128      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 128, 8, 78)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 8, 78)   312         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128, 8, 78)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 256, 8, 78)   323496      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 256, 8, 78)   842664      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 256, 4, 39)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 256, 4, 39)   156         average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 256, 4, 39)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 512, 4, 39)   1235412     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 512, 4, 39)   3256788     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,156,753
Trainable params: 6,137,313
Non-trainable params: 19,440
__________________________________________________________________________________________________
binary
Epoch 1/80
76/76 - 55s - loss: 1.1793 - accuracy: 0.6151 - val_loss: 0.6611 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.14150367433208594
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 2/80
76/76 - 47s - loss: 0.6717 - accuracy: 0.6349 - val_loss: 0.6774 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.14272477044931264
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 3/80
76/76 - 48s - loss: 0.6977 - accuracy: 0.6612 - val_loss: 0.7715 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.14245735832789957
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 4/80
76/76 - 49s - loss: 0.7498 - accuracy: 0.6382 - val_loss: 0.9388 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.13788519584834594
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 5/80
76/76 - 49s - loss: 0.6475 - accuracy: 0.6447 - val_loss: 1.2037 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.1489513389243905
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 6/80
76/76 - 49s - loss: 0.6593 - accuracy: 0.6612 - val_loss: 0.7074 - val_accuracy: 0.2800
Confusion matrix: 
 [[ 7 53]
 [ 1 14]]
Validation f1: 34.15
Validation accuracy: 28.00
Validation recall: 93.33
Validation precision: 20.90
Validation AUC: 0.36446268543801447
Validation class accuracies: [0.11666666666666667, 0.9333333333333333]
TARGET: 1
target metric(test f1): 0.34146341463414637
column_sums: [ 8 67]
cm_sum: 75
inside not defaulting
Saving model...
Epoch 7/80
76/76 - 49s - loss: 0.6546 - accuracy: 0.6743 - val_loss: 0.5202 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.30018815316364483
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 8/80
76/76 - 49s - loss: 0.6530 - accuracy: 0.6184 - val_loss: 0.6311 - val_accuracy: 0.7067
Confusion matrix: 
 [[51  9]
 [13  2]]
Validation f1: 15.38
Validation accuracy: 70.67
Validation recall: 13.33
Validation precision: 18.18
Validation AUC: 0.27882707303880777
Validation class accuracies: [0.85, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.15384615384615383
column_sums: [64 11]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.34146341463414637 hasn't increased by 0 in 1 epochs
Epoch 9/80
76/76 - 49s - loss: 0.6422 - accuracy: 0.6678 - val_loss: 0.8791 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3679283026477559
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 10/80
76/76 - 49s - loss: 0.6712 - accuracy: 0.6382 - val_loss: 0.8671 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.35573250252588473
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 11/80
76/76 - 49s - loss: 0.6318 - accuracy: 0.6809 - val_loss: 0.6354 - val_accuracy: 0.7600
Confusion matrix: 
 [[55  5]
 [13  2]]
Validation f1: 18.18
Validation accuracy: 76.00
Validation recall: 13.33
Validation precision: 28.57
Validation AUC: 0.32119694035696167
Validation class accuracies: [0.9166666666666666, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 12/80
76/76 - 49s - loss: 0.6533 - accuracy: 0.6513 - val_loss: 0.4888 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3474310490495983
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 13/80
76/76 - 49s - loss: 0.6370 - accuracy: 0.6743 - val_loss: 0.6938 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.34413746139278195
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 14/80
76/76 - 49s - loss: 0.6256 - accuracy: 0.6842 - val_loss: 1.0557 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31677320088393235
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 15/80
76/76 - 49s - loss: 0.6450 - accuracy: 0.6875 - val_loss: 0.7149 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.30538787948712237
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 16/80
76/76 - 49s - loss: 0.6195 - accuracy: 0.6678 - val_loss: 0.6931 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32032144431412657
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 17/80
76/76 - 49s - loss: 0.6350 - accuracy: 0.6908 - val_loss: 0.8047 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3399556084193105
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 18/80
76/76 - 49s - loss: 0.6156 - accuracy: 0.6842 - val_loss: 0.5151 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.3057735881561597
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 19/80
76/76 - 48s - loss: 0.6139 - accuracy: 0.6974 - val_loss: 0.5382 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.32165075055736814
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 20/80
76/76 - 49s - loss: 0.6016 - accuracy: 0.7039 - val_loss: 1.0541 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31085498429487574
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 21/80
76/76 - 49s - loss: 0.6240 - accuracy: 0.6743 - val_loss: 1.3394 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.29221744865304067
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 22/80
76/76 - 49s - loss: 0.6200 - accuracy: 0.7039 - val_loss: 1.4765 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.30273414528895654
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 23/80
76/76 - 49s - loss: 0.5911 - accuracy: 0.7039 - val_loss: 1.7015 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.32410585646178924
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 24/80
76/76 - 49s - loss: 0.5958 - accuracy: 0.7039 - val_loss: 1.4074 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27254514499411675
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 25/80
76/76 - 49s - loss: 0.6097 - accuracy: 0.6776 - val_loss: 0.8177 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.27560107438707815
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 26/80
76/76 - 49s - loss: 0.6026 - accuracy: 0.6875 - val_loss: 1.8099 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.2879678202187036
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 27/80
76/76 - 49s - loss: 0.6072 - accuracy: 0.6974 - val_loss: 1.7135 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2918173503678264
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 28/80
76/76 - 49s - loss: 0.5976 - accuracy: 0.6941 - val_loss: 0.6122 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.2875825868353379
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 29/80
76/76 - 49s - loss: 0.5979 - accuracy: 0.6776 - val_loss: 0.5653 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.2818415414759561
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 30/80
76/76 - 49s - loss: 0.6075 - accuracy: 0.6809 - val_loss: 0.7105 - val_accuracy: 0.2667
Confusion matrix: 
 [[ 6 54]
 [ 1 14]]
Validation f1: 33.73
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 26.67
Validation recall: 93.33
Validation precision: 20.59
Validation AUC: 0.2169270785688696
Validation class accuracies: [0.1, 0.9333333333333333]
TARGET: 1
target metric(test f1): 0.3373493975903614
column_sums: [ 7 68]
cm_sum: 75
The training is defaulting to either class.
Epoch 31/80
76/76 - 49s - loss: 0.5951 - accuracy: 0.6875 - val_loss: 1.1503 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31789199279217867
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 32/80
76/76 - 49s - loss: 0.5881 - accuracy: 0.6908 - val_loss: 2.7749 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2905221179785264
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 33/80
76/76 - 49s - loss: 0.5639 - accuracy: 0.7237 - val_loss: 1.1567 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2701001474304855
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 34/80
76/76 - 49s - loss: 0.5831 - accuracy: 0.6908 - val_loss: 2.7787 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3003602278957112
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 35/80
76/76 - 48s - loss: 0.6082 - accuracy: 0.6743 - val_loss: 6.4006 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27754512440972356
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 36/80
76/76 - 49s - loss: 0.5652 - accuracy: 0.7336 - val_loss: 3.0336 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.30107654574129206
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 37/80
76/76 - 49s - loss: 0.5930 - accuracy: 0.6875 - val_loss: 0.9620 - val_accuracy: 0.6267
Confusion matrix: 
 [[42 18]
 [10  5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.32
Validation accuracy: 62.67
Validation recall: 33.33
Validation precision: 21.74
Validation AUC: 0.20458125147706552
Validation class accuracies: [0.7, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.26315789473684204
column_sums: [52 23]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.34146341463414637 hasn't increased by 0 in 2 epochs
Epoch 38/80
76/76 - 50s - loss: 0.5845 - accuracy: 0.7138 - val_loss: 2.3185 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2860833116480833
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 39/80
76/76 - 49s - loss: 0.6054 - accuracy: 0.6809 - val_loss: 2.3977 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2917473100188454
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 40/80
76/76 - 49s - loss: 0.6002 - accuracy: 0.6776 - val_loss: 1.1265 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.26971559154148667
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 41/80
76/76 - 49s - loss: 0.5888 - accuracy: 0.7039 - val_loss: 0.8104 - val_accuracy: 0.5200
Confusion matrix: 
 [[29 31]
 [ 5 10]]
Validation f1: 35.71
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 52.00
Validation recall: 66.67
Validation precision: 24.39
Validation AUC: 0.2164124668851043
Validation class accuracies: [0.48333333333333334, 0.6666666666666666]
TARGET: 1
target metric(test f1): 0.35714285714285715
column_sums: [34 41]
cm_sum: 75
inside not defaulting
Saving model...
Epoch 42/80
76/76 - 49s - loss: 0.5540 - accuracy: 0.7138 - val_loss: 6.7443 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27256370239913363
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 43/80
76/76 - 49s - loss: 0.5602 - accuracy: 0.7434 - val_loss: 0.9164 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.26311854838858467
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 44/80
76/76 - 49s - loss: 0.5762 - accuracy: 0.7171 - val_loss: 2.0421 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2711400635072886
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 45/80
76/76 - 49s - loss: 0.5402 - accuracy: 0.7467 - val_loss: 0.8468 - val_accuracy: 0.4000
Confusion matrix: 
 [[19 41]
 [ 4 11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 32.84
Validation accuracy: 40.00
Validation recall: 73.33
Validation precision: 21.15
Validation AUC: 0.18420610232376058
Validation class accuracies: [0.31666666666666665, 0.7333333333333333]
TARGET: 1
target metric(test f1): 0.32835820895522383
column_sums: [23 52]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 1 epochs
Epoch 46/80
76/76 - 49s - loss: 0.6080 - accuracy: 0.6678 - val_loss: 0.8927 - val_accuracy: 0.4533
Confusion matrix: 
 [[25 35]
 [ 6  9]]
Validation f1: 30.51
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 45.33
Validation recall: 60.00
Validation precision: 20.45
Validation AUC: 0.17502497261059136
Validation class accuracies: [0.4166666666666667, 0.6]
TARGET: 1
target metric(test f1): 0.30508474576271183
column_sums: [31 44]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 2 epochs
Epoch 47/80
76/76 - 49s - loss: 0.5946 - accuracy: 0.6875 - val_loss: 25.2961 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3933333333333333
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 48/80
76/76 - 49s - loss: 0.5627 - accuracy: 0.7171 - val_loss: 13.0556 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.2873692809725473
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 49/80
76/76 - 49s - loss: 0.5806 - accuracy: 0.7039 - val_loss: 3.5836 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3256749221527383
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 50/80
76/76 - 49s - loss: 0.5467 - accuracy: 0.7138 - val_loss: 5.7373 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.3136211685872191
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 51/80
76/76 - 49s - loss: 0.5689 - accuracy: 0.7138 - val_loss: 1.8601 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3055606061973533
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 52/80
76/76 - 49s - loss: 0.5411 - accuracy: 0.7270 - val_loss: 7.0332 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.3225671376428009
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 53/80
76/76 - 49s - loss: 0.5401 - accuracy: 0.7237 - val_loss: 3.4699 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31197941571875637
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 54/80
76/76 - 49s - loss: 0.5395 - accuracy: 0.7303 - val_loss: 3.7981 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3629397565648697
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 55/80
76/76 - 49s - loss: 0.5623 - accuracy: 0.7270 - val_loss: 1.5826 - val_accuracy: 0.6133
Confusion matrix: 
 [[39 21]
 [ 8  7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 32.56
Validation accuracy: 61.33
Validation recall: 46.67
Validation precision: 25.00
Validation AUC: 0.26840371205145197
Validation class accuracies: [0.65, 0.4666666666666667]
TARGET: 1
target metric(test f1): 0.32558139534883723
column_sums: [47 28]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 3 epochs
Epoch 56/80
76/76 - 49s - loss: 0.5206 - accuracy: 0.7270 - val_loss: 1.0800 - val_accuracy: 0.4933
Confusion matrix: 
 [[27 33]
 [ 5 10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 34.48
Validation accuracy: 49.33
Validation recall: 66.67
Validation precision: 23.26
Validation AUC: 0.21076075906193725
Validation class accuracies: [0.45, 0.6666666666666666]
TARGET: 1
target metric(test f1): 0.3448275862068966
column_sums: [32 43]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 4 epochs
Epoch 57/80
76/76 - 49s - loss: 0.5465 - accuracy: 0.7204 - val_loss: 1.0761 - val_accuracy: 0.4667
Confusion matrix: 
 [[25 35]
 [ 5 10]]
Validation f1: 33.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 46.67
Validation recall: 66.67
Validation precision: 22.22
Validation AUC: 0.2525839651863888
Validation class accuracies: [0.4166666666666667, 0.6666666666666666]
TARGET: 1
target metric(test f1): 0.3333333333333333
column_sums: [30 45]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 5 epochs
Epoch 58/80
76/76 - 49s - loss: 0.4744 - accuracy: 0.7632 - val_loss: 1.0830 - val_accuracy: 0.4667
Confusion matrix: 
 [[25 35]
 [ 5 10]]
Validation f1: 33.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 46.67
Validation recall: 66.67
Validation precision: 22.22
Validation AUC: 0.27226795281633104
Validation class accuracies: [0.4166666666666667, 0.6666666666666666]
TARGET: 1
target metric(test f1): 0.3333333333333333
column_sums: [30 45]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 6 epochs
Epoch 59/80
76/76 - 49s - loss: 0.5074 - accuracy: 0.7336 - val_loss: 1.2170 - val_accuracy: 0.5200
Confusion matrix: 
 [[29 31]
 [ 5 10]]
Validation f1: 35.71
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 52.00
Validation recall: 66.67
Validation precision: 24.39
Validation AUC: 0.2648706170267433
Validation class accuracies: [0.48333333333333334, 0.6666666666666666]
TARGET: 1
target metric(test f1): 0.35714285714285715
column_sums: [34 41]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 7 epochs
Epoch 60/80
76/76 - 49s - loss: 0.5119 - accuracy: 0.7336 - val_loss: 1.3080 - val_accuracy: 0.8267
Confusion matrix: 
 [[59  1]
 [12  3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 31.58
Validation accuracy: 82.67
Validation recall: 20.00
Validation precision: 75.00
Validation AUC: 0.3602431663364022
Validation class accuracies: [0.9833333333333333, 0.2]
TARGET: 1
target metric(test f1): 0.31578947368421056
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 61/80
76/76 - 49s - loss: 0.5242 - accuracy: 0.7401 - val_loss: 1.4120 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 100.00
Validation AUC: 0.3314135664585731
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 62/80
76/76 - 49s - loss: 0.5022 - accuracy: 0.7632 - val_loss: 1.1128 - val_accuracy: 0.4800
Confusion matrix: 
 [[26 34]
 [ 5 10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 33.90
Validation accuracy: 48.00
Validation recall: 66.67
Validation precision: 22.73
Validation AUC: 0.24480566330732434
Validation class accuracies: [0.43333333333333335, 0.6666666666666666]
TARGET: 1
target metric(test f1): 0.33898305084745756
column_sums: [31 44]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 8 epochs
Epoch 63/80
76/76 - 49s - loss: 0.4863 - accuracy: 0.7467 - val_loss: 1.1660 - val_accuracy: 0.4533
Confusion matrix: 
 [[23 37]
 [ 4 11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 34.92
Validation accuracy: 45.33
Validation recall: 73.33
Validation precision: 22.92
Validation AUC: 0.23116566403318872
Validation class accuracies: [0.38333333333333336, 0.7333333333333333]
TARGET: 1
target metric(test f1): 0.3492063492063492
column_sums: [27 48]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 9 epochs
Epoch 64/80
76/76 - 49s - loss: 0.4997 - accuracy: 0.7303 - val_loss: 1.0573 - val_accuracy: 0.7333
Confusion matrix: 
 [[51  9]
 [11  4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.57
Validation accuracy: 73.33
Validation recall: 26.67
Validation precision: 30.77
Validation AUC: 0.3632684546262521
Validation class accuracies: [0.85, 0.26666666666666666]
TARGET: 1
target metric(test f1): 0.28571428571428575
column_sums: [62 13]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 10 epochs
Epoch 65/80
76/76 - 49s - loss: 0.4853 - accuracy: 0.7566 - val_loss: 1.1429 - val_accuracy: 0.5867
Confusion matrix: 
 [[36 24]
 [ 7  8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 34.04
Validation accuracy: 58.67
Validation recall: 53.33
Validation precision: 25.00
Validation AUC: 0.30867460460234725
Validation class accuracies: [0.6, 0.5333333333333333]
TARGET: 1
target metric(test f1): 0.3404255319148936
column_sums: [43 32]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 11 epochs
Epoch 66/80
76/76 - 49s - loss: 0.4748 - accuracy: 0.7730 - val_loss: 1.0811 - val_accuracy: 0.6667
Confusion matrix: 
 [[45 15]
 [10  5]]
Validation f1: 28.57
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 66.67
Validation recall: 33.33
Validation precision: 25.00
Validation AUC: 0.32561438328781844
Validation class accuracies: [0.75, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.28571428571428575
column_sums: [55 20]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 12 epochs
Epoch 67/80
76/76 - 49s - loss: 0.4997 - accuracy: 0.7599 - val_loss: 1.0909 - val_accuracy: 0.7600
Confusion matrix: 
 [[54  6]
 [12  3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.00
Validation accuracy: 76.00
Validation recall: 20.00
Validation precision: 33.33
Validation AUC: 0.3842888042077526
Validation class accuracies: [0.9, 0.2]
TARGET: 1
target metric(test f1): 0.25
column_sums: [66  9]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 13 epochs
Epoch 68/80
76/76 - 49s - loss: 0.4517 - accuracy: 0.7895 - val_loss: 1.1354 - val_accuracy: 0.8000
Confusion matrix: 
 [[57  3]
 [12  3]]
Validation f1: 28.57
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 80.00
Validation recall: 20.00
Validation precision: 50.00
Validation AUC: 0.3906492108827243
Validation class accuracies: [0.95, 0.2]
TARGET: 1
target metric(test f1): 0.28571428571428575
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 69/80
76/76 - 49s - loss: 0.4885 - accuracy: 0.7500 - val_loss: 1.0905 - val_accuracy: 0.8000
Confusion matrix: 
 [[57  3]
 [12  3]]
Validation f1: 28.57
Validation accuracy: 80.00
Validation recall: 20.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 50.00
Validation AUC: 0.386321449674851
Validation class accuracies: [0.95, 0.2]
TARGET: 1
target metric(test f1): 0.28571428571428575
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 70/80
76/76 - 49s - loss: 0.4949 - accuracy: 0.7467 - val_loss: 1.1016 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.3523707808675648
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 71/80
76/76 - 49s - loss: 0.4686 - accuracy: 0.7993 - val_loss: 1.0880 - val_accuracy: 0.8000
Confusion matrix: 
 [[58  2]
 [13  2]]
Validation f1: 21.05
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 80.00
Validation recall: 13.33
Validation precision: 50.00
Validation AUC: 0.34105149117473454
Validation class accuracies: [0.9666666666666667, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.2105263157894737
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 72/80
76/76 - 49s - loss: 0.4785 - accuracy: 0.7664 - val_loss: 1.1184 - val_accuracy: 0.7867
Confusion matrix: 
 [[57  3]
 [13  2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 20.00
Validation accuracy: 78.67
Validation recall: 13.33
Validation precision: 40.00
Validation AUC: 0.3680351790665752
Validation class accuracies: [0.95, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.2
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 73/80
76/76 - 49s - loss: 0.4704 - accuracy: 0.7632 - val_loss: 1.1692 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.3398215041629895
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 74/80
76/76 - 50s - loss: 0.4849 - accuracy: 0.7664 - val_loss: 1.1782 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.3379663583750706
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 75/80
76/76 - 49s - loss: 0.4785 - accuracy: 0.7632 - val_loss: 1.1939 - val_accuracy: 0.8133
Confusion matrix: 
 [[59  1]
 [13  2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 22.22
Validation accuracy: 81.33
Validation recall: 13.33
Validation precision: 66.67
Validation AUC: 0.3427501710536472
Validation class accuracies: [0.9833333333333333, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.2222222222222222
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 76/80
76/76 - 49s - loss: 0.4708 - accuracy: 0.7796 - val_loss: 1.1991 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.3400310151180894
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 77/80
76/76 - 49s - loss: 0.4712 - accuracy: 0.7664 - val_loss: 1.2063 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.33844817162664165
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 78/80
76/76 - 49s - loss: 0.4689 - accuracy: 0.7862 - val_loss: 1.1604 - val_accuracy: 0.8000
Confusion matrix: 
 [[58  2]
 [13  2]]
Validation f1: 21.05
Validation accuracy: 80.00
Validation recall: 13.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 50.00
Validation AUC: 0.3469943724417958
Validation class accuracies: [0.9666666666666667, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.2105263157894737
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 79/80
76/76 - 49s - loss: 0.4733 - accuracy: 0.7632 - val_loss: 1.1257 - val_accuracy: 0.8133
Confusion matrix: 
 [[58  2]
 [12  3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 30.00
Validation accuracy: 81.33
Validation recall: 20.00
Validation precision: 60.00
Validation AUC: 0.3473711798008282
Validation class accuracies: [0.9666666666666667, 0.2]
TARGET: 1
target metric(test f1): 0.3
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 80/80
76/76 - 49s - loss: 0.4679 - accuracy: 0.7730 - val_loss: 1.1252 - val_accuracy: 0.8133
Confusion matrix: 
 [[58  2]
 [12  3]]
Validation f1: 30.00
Validation accuracy: 81.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 20.00
Validation precision: 60.00
Validation AUC: 0.3539634400609793
Validation class accuracies: [0.9666666666666667, 0.2]

The metrics for the epoch with the best target metric are: 
Best cm: [[29 31]
 [ 5 10]]
Best f1: 0.35714285714285715
Best accuracy: 0.52
Best recall: 0.6666666666666666
Best precision: 0.24390243902439024
Best AUC: 0.2164124668851043
Best epoch: 41
TARGET: 1
target metric(test f1): 0.3
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.

Starting the Bangladesh analysis...
Epoch: 41
Starting...
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2140.py", line 312, in <module>
    train_model(**arguments)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2140.py", line 261, in train_model
    bd_f1, bd_accuracy, bd_precision, bd_recall, bd_auc, bd_y_true, bd_y_pred = generate_bangladesh_sheet(model, grouped_val_samples, excel_dest, six, initial_channels)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/pneumonia.py", line 182, in generate_bangladesh_sheet
    output = model.predict(np.array([arr]))
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1629, in predict
    tmp_batch_outputs = self.predict_function(iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 871, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 726, in _initialize
    *args, **kwds))
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2969, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 3206, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 634, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 977, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1478 predict_function  *
        return step_function(self, iterator)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1468 step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:1259 run
        return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:2730 call_for_each_replica
        return self._call_for_each_replica(fn, args, kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:3417 _call_for_each_replica
        return fn(*args, **kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1461 run_step  **
        outputs = model.predict_step(data)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1434 predict_step
        return self(x, training=False)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py:998 __call__
        input_spec.assert_input_compatibility(self.input_spec, inputs, self.name)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py:274 assert_input_compatibility
        ', found shape=' + display_shape(x.shape))

    ValueError: Input 0 is incompatible with layer conv2d: expected shape=(None, 6, 128, 1250), found shape=(None, 128, 1250, 6)

wandb: Waiting for W&B process to finish, PID 7237
wandb: Program failed with code 1.  Press ctrl-c to abort syncing.
wandb: - 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: \ 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.05MB uploaded (0.00MB deduped)wandb: / 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb: - 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb: \ 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb: | 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb: / 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210516_152556-d85eorvg/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210516_152556-d85eorvg/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.77303
wandb:         val_accuracy 0.81333
wandb:             _runtime 4503
wandb:           _timestamp 1621183259
wandb:                _step 565
wandb:           train_loss 0.46794
wandb:             val_loss 1.12521
wandb:           val_recall 0.2
wandb:        val_precision 0.6
wandb:               val_f1 0.3
wandb:              val_auc 0.35396
wandb:                   lr 2e-05
wandb:          best_val_f1 0.35714
wandb:    best_val_accuracy 0.52
wandb:   best_val_precision 0.2439
wandb:      best_val_recall 0.66667
wandb:             best_auc 0.21641
wandb:           best_epoch 41
wandb: Run history:
wandb:   train_accuracy ▁▃▂▃▃▄▃▄▄▄▃▄▃▄▃▄▅▃▄▄▄▆▆▄▄▅▅▅▅▆▆▆▆▇▆█▇▇▇▇
wandb:     val_accuracy █▁▁██▇████████████▆█▅█▃████▆▄▅█▄▅▇██████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▃▃▃▃▃▃▃▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▂▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▂▁▁▁█▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁██▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▃▁▆▁▆▁▁▁▁▄▆▆▁▆▅▂▂▂▁▂▁▂
wandb:    val_precision ▁▂▂█▁▃▁▁▁█▁▁█▁█▁▁▁▃▁▃▅▂▁▁▁▁▃▃▃█▃▃▃▅▅█▆▅▅
wandb:           val_f1 ▁██▃▁▅▁▁▁▃▁▁▃▁▃▁▁▁▆▁█▃▇▁▁▁▁▇██▃██▆▇▅▃▅▃▇
wandb:          val_auc ▁▁▁▅▇▆▇▆▇▆▅▆▅▅▅▆▅▅▃▅▃▄▂█▆▆▆▅▄▄▆▃▆██▇▇▇▆▇
wandb:               lr ████████████████████████████▃▃▃▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 6 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2140: https://wandb.ai/arachid1/tensorboard-integration/runs/d85eorvg


 See logs at ../../new_cache/conv__2140__05_1525__v29__redo/logs/