Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2234
Description:  newdata
2021-06-22 01:56:09.549502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-22 01:56:11.741843: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-22 01:56:11.742757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-22 01:56:11.755713: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:11.756529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-22 01:56:11.756564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 01:56:11.760232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 01:56:11.760309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-22 01:56:11.761415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-22 01:56:11.761687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-22 01:56:11.762648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-22 01:56:11.763492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-22 01:56:11.763641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 01:56:11.763750: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:11.764485: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:11.765124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2234.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2234__06_0139__v39__newdata
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 148, 'WAV_PATH': 'v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 148, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-22 01:56:16.545688: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-22 01:56:16.545942: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:16.546676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-22 01:56:16.546719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 01:56:16.546776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 01:56:16.546796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-22 01:56:16.546816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-22 01:56:16.546853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-22 01:56:16.546879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-22 01:56:16.546897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-22 01:56:16.546914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 01:56:16.546994: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:16.547682: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:16.548312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-22 01:56:16.548354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 01:56:17.267959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-22 01:56:17.268013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-22 01:56:17.268023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-22 01:56:17.268326: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:17.269214: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:17.270005: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 01:56:17.270743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 199, Non-pneumonia patients: 3810
-----------------------
Number of train recordings: 3207 with pneumonia: 161 and non-pneumonia: 3046
Number of val recordings: 802 with pneumonia: 38 and non-pneumonia: 764
-----------------------
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5261154855643044, 1: 10.07286432160804}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-22 01:56:18.627576: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-22 01:56:18.629406: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-22 01:56:18.974244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 01:56:20.911778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 01:56:21.369836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
201/201 - 305s - loss: 0.9562 - accuracy: 0.6732 - val_loss: 0.2012 - val_accuracy: 0.9526
Confusion matrix: 
 [[764   0]
 [ 38   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 95.26
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12675718393730329
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
201/201 - 306s - loss: 0.5668 - accuracy: 0.7496 - val_loss: 0.2208 - val_accuracy: 0.9526
Confusion matrix: 
 [[764   0]
 [ 38   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.26
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.03473129496181413
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
201/201 - 307s - loss: 0.5112 - accuracy: 0.7655 - val_loss: 1.4295 - val_accuracy: 0.5835
Confusion matrix: 
 [[459 305]
 [ 29   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.601 0.399]
 [0.763 0.237]]
Validation f1: 5.11
Validation accuracy: 58.35
Validation recall: 23.68
Validation precision: 2.87
Validation AUC: 0.03930128532698833
Validation class accuracies: [0.6007853403141361, 0.23684210526315788]
Saving model...
Epoch 4/65
201/201 - 306s - loss: 0.4411 - accuracy: 0.7783 - val_loss: 1.5154 - val_accuracy: 0.3167
Confusion matrix: 
 [[221 543]
 [  5  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.289 0.711]
 [0.132 0.868]]
Validation f1: 10.75
Validation accuracy: 31.67
Validation recall: 86.84
Validation precision: 5.73
Validation AUC: 0.06840804423881397
Validation class accuracies: [0.2892670157068063, 0.868421052631579]
Saving model...
Epoch 5/65
201/201 - 306s - loss: 0.4012 - accuracy: 0.8085 - val_loss: 0.8307 - val_accuracy: 0.4476
Confusion matrix: 
 [[336 428]
 [ 15  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.44  0.56 ]
 [0.395 0.605]]
Validation f1: 9.41
Validation accuracy: 44.76
Validation recall: 60.53
Validation precision: 5.10
Validation AUC: 0.04422757746606269
Validation class accuracies: [0.4397905759162304, 0.6052631578947368]
The validation tracker metric at 0.10749185667752442 hasn't increased by 0 in 1 epochs
Epoch 6/65
201/201 - 306s - loss: 0.3682 - accuracy: 0.8207 - val_loss: 1.4796 - val_accuracy: 0.4214
Confusion matrix: 
 [[306 458]
 [  6  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.401 0.599]
 [0.158 0.842]]
Validation f1: 12.12
Validation accuracy: 42.14
Validation recall: 84.21
Validation precision: 6.53
Validation AUC: 0.08605018311018196
Validation class accuracies: [0.4005235602094241, 0.8421052631578947]
Saving model...
Epoch 7/65
201/201 - 306s - loss: 0.3615 - accuracy: 0.8385 - val_loss: 8.2725 - val_accuracy: 0.0474
Confusion matrix: 
 [[  0 764]
 [  0  38]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 9.05
Validation accuracy: 4.74
Validation recall: 100.00
Validation precision: 4.74
Validation AUC: 0.04424444811887601
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.12121212121212122 hasn't increased by 0 in 1 epochs
Epoch 8/65
201/201 - 307s - loss: 0.3337 - accuracy: 0.8251 - val_loss: 1.9135 - val_accuracy: 0.3541
Confusion matrix: 
 [[249 515]
 [  3  35]]
Normalized Confusion matrix: 
 [[0.326 0.674]
 [0.079 0.921]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 11.90
Validation accuracy: 35.41
Validation recall: 92.11
Validation precision: 6.36
Validation AUC: 0.07106004186580936
Validation class accuracies: [0.32591623036649214, 0.9210526315789473]
The validation tracker metric at 0.12121212121212122 hasn't increased by 0 in 2 epochs
Epoch 9/65
201/201 - 306s - loss: 0.3107 - accuracy: 0.8503 - val_loss: 0.5101 - val_accuracy: 0.7506
Confusion matrix: 
 [[590 174]
 [ 26  12]]
Normalized Confusion matrix: 
 [[0.772 0.228]
 [0.684 0.316]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.71
Validation accuracy: 75.06
Validation recall: 31.58
Validation precision: 6.45
Validation AUC: 0.06610444344275657
Validation class accuracies: [0.7722513089005235, 0.3157894736842105]
The validation tracker metric at 0.12121212121212122 hasn't increased by 0 in 3 epochs
Epoch 10/65
201/201 - 306s - loss: 0.2492 - accuracy: 0.8809 - val_loss: 1.0838 - val_accuracy: 0.5623
Confusion matrix: 
 [[426 338]
 [ 13  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.558 0.442]
 [0.342 0.658]]
Validation f1: 12.47
Validation accuracy: 56.23
Validation recall: 65.79
Validation precision: 6.89
Validation AUC: 0.06013078395305875
Validation class accuracies: [0.5575916230366492, 0.6578947368421053]
Saving model...
Epoch 11/65
201/201 - 306s - loss: 0.2302 - accuracy: 0.8887 - val_loss: 1.3542 - val_accuracy: 0.5561
Confusion matrix: 
 [[417 347]
 [  9  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.546 0.454]
 [0.237 0.763]]
Validation f1: 14.01
Validation accuracy: 55.61
Validation recall: 76.32
Validation precision: 7.71
Validation AUC: 0.10361976502145319
Validation class accuracies: [0.5458115183246073, 0.7631578947368421]
Saving model...
Epoch 12/65
201/201 - 306s - loss: 0.2162 - accuracy: 0.9033 - val_loss: 1.1322 - val_accuracy: 0.5810
Confusion matrix: 
 [[438 326]
 [ 10  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.573 0.427]
 [0.263 0.737]]
Validation f1: 14.29
Validation accuracy: 58.10
Validation recall: 73.68
Validation precision: 7.91
Validation AUC: 0.11168253177583015
Validation class accuracies: [0.5732984293193717, 0.7368421052631579]
Saving model...
Epoch 13/65
201/201 - 306s - loss: 0.1837 - accuracy: 0.9189 - val_loss: 0.4400 - val_accuracy: 0.8354
Confusion matrix: 
 [[657 107]
 [ 25  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86  0.14 ]
 [0.658 0.342]]
Validation f1: 16.46
Validation accuracy: 83.54
Validation recall: 34.21
Validation precision: 10.83
Validation AUC: 0.09391767914373926
Validation class accuracies: [0.8599476439790575, 0.34210526315789475]
Saving model...
Epoch 14/65
201/201 - 306s - loss: 0.1637 - accuracy: 0.9339 - val_loss: 1.9523 - val_accuracy: 0.4938
Confusion matrix: 
 [[378 386]
 [ 20  18]]
Normalized Confusion matrix: 
 [[0.495 0.505]
 [0.526 0.474]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 8.14
Validation accuracy: 49.38
Validation recall: 47.37
Validation precision: 4.46
Validation AUC: 0.04597270543840894
Validation class accuracies: [0.49476439790575916, 0.47368421052631576]
The validation tracker metric at 0.16455696202531647 hasn't increased by 0 in 1 epochs
Epoch 15/65
201/201 - 307s - loss: 0.1416 - accuracy: 0.9314 - val_loss: 0.1936 - val_accuracy: 0.9489
Confusion matrix: 
 [[760   4]
 [ 37   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.974 0.026]]
Validation f1: 4.65
Validation accuracy: 94.89
Validation recall: 2.63
Validation precision: 20.00
Validation AUC: 0.12286236166027106
Validation class accuracies: [0.9947643979057592, 0.02631578947368421]
The validation tracker metric at 0.16455696202531647 hasn't increased by 0 in 2 epochs
Epoch 16/65
201/201 - 306s - loss: 0.1689 - accuracy: 0.9330 - val_loss: 0.4095 - val_accuracy: 0.8254
Confusion matrix: 
 [[647 117]
 [ 23  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.847 0.153]
 [0.605 0.395]]
Validation f1: 17.65
Validation accuracy: 82.54
Validation recall: 39.47
Validation precision: 11.36
Validation AUC: 0.13563812163027122
Validation class accuracies: [0.8468586387434555, 0.39473684210526316]
Saving model...
Epoch 17/65
201/201 - 306s - loss: 0.1286 - accuracy: 0.9532 - val_loss: 0.2511 - val_accuracy: 0.9252
Confusion matrix: 
 [[735  29]
 [ 31   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.816 0.184]]
Validation f1: 18.92
Validation accuracy: 92.52
Validation recall: 18.42
Validation precision: 19.44
Validation AUC: 0.10385802035044497
Validation class accuracies: [0.9620418848167539, 0.18421052631578946]
Saving model...
Epoch 18/65
201/201 - 306s - loss: 0.1059 - accuracy: 0.9542 - val_loss: 0.2588 - val_accuracy: 0.9514
Confusion matrix: 
 [[763   1]
 [ 38   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.999 0.001]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 95.14
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05665059318826213
Validation class accuracies: [0.9986910994764397, 0.0]
The validation tracker metric at 0.18918918918918917 hasn't increased by 0 in 1 epochs
Epoch 19/65
201/201 - 306s - loss: 0.0993 - accuracy: 0.9632 - val_loss: 0.2158 - val_accuracy: 0.9252
Confusion matrix: 
 [[737  27]
 [ 33   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.868 0.132]]
Validation f1: 14.29
Validation accuracy: 92.52
Validation recall: 13.16
Validation precision: 15.62
Validation AUC: 0.12351247728793609
Validation class accuracies: [0.9646596858638743, 0.13157894736842105]
The validation tracker metric at 0.18918918918918917 hasn't increased by 0 in 2 epochs
Epoch 20/65
201/201 - 307s - loss: 0.0745 - accuracy: 0.9673 - val_loss: 0.2162 - val_accuracy: 0.9401
Confusion matrix: 
 [[745  19]
 [ 29   9]]
Normalized Confusion matrix: 
 [[0.975 0.025]
 [0.763 0.237]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.27
Validation accuracy: 94.01
Validation recall: 23.68
Validation precision: 32.14
Validation AUC: 0.1442968295024468
Validation class accuracies: [0.975130890052356, 0.23684210526315788]
Saving model...
Epoch 21/65
201/201 - 306s - loss: 0.0687 - accuracy: 0.9685 - val_loss: 0.2913 - val_accuracy: 0.9277
Confusion matrix: 
 [[740  24]
 [ 34   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.895 0.105]]
Validation f1: 12.12
Validation accuracy: 92.77
Validation recall: 10.53
Validation precision: 14.29
Validation AUC: 0.08444103870001447
Validation class accuracies: [0.9685863874345549, 0.10526315789473684]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 1 epochs
Epoch 22/65
201/201 - 307s - loss: 0.0674 - accuracy: 0.9729 - val_loss: 0.2165 - val_accuracy: 0.9476
Confusion matrix: 
 [[756   8]
 [ 34   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.895 0.105]]
Validation f1: 16.00
Validation accuracy: 94.76
Validation recall: 10.53
Validation precision: 33.33
Validation AUC: 0.13480677761022755
Validation class accuracies: [0.9895287958115183, 0.10526315789473684]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 2 epochs
Epoch 23/65
201/201 - 306s - loss: 0.0653 - accuracy: 0.9716 - val_loss: 1.3299 - val_accuracy: 0.6197
Confusion matrix: 
 [[470 294]
 [ 11  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.615 0.385]
 [0.289 0.711]]
Validation f1: 15.04
Validation accuracy: 61.97
Validation recall: 71.05
Validation precision: 8.41
Validation AUC: 0.1366792123736319
Validation class accuracies: [0.6151832460732984, 0.7105263157894737]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 3 epochs
Epoch 24/65
201/201 - 306s - loss: 0.0632 - accuracy: 0.9769 - val_loss: 0.5161 - val_accuracy: 0.8653
Confusion matrix: 
 [[685  79]
 [ 29   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.763 0.237]]
Validation f1: 14.29
Validation accuracy: 86.53
Validation recall: 23.68
Validation precision: 10.23
Validation AUC: 0.07830581282188012
Validation class accuracies: [0.8965968586387435, 0.23684210526315788]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 4 epochs
Epoch 25/65
201/201 - 306s - loss: 0.0571 - accuracy: 0.9757 - val_loss: 0.3281 - val_accuracy: 0.8890
Confusion matrix: 
 [[697  67]
 [ 22  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.912 0.088]
 [0.579 0.421]]
Validation f1: 26.45
Validation accuracy: 88.90
Validation recall: 42.11
Validation precision: 19.28
Validation AUC: 0.16745055947364668
Validation class accuracies: [0.912303664921466, 0.42105263157894735]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 5 epochs
Epoch 26/65
201/201 - 306s - loss: 0.0516 - accuracy: 0.9832 - val_loss: 0.2130 - val_accuracy: 0.9426
Confusion matrix: 
 [[755   9]
 [ 37   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.974 0.026]]
Validation f1: 4.17
Validation accuracy: 94.26
Validation recall: 2.63
Validation precision: 10.00
Validation AUC: 0.12234189074690219
Validation class accuracies: [0.9882198952879581, 0.02631578947368421]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 27/65
201/201 - 307s - loss: 0.0262 - accuracy: 0.9888 - val_loss: 0.2327 - val_accuracy: 0.9439
Confusion matrix: 
 [[753  11]
 [ 34   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.895 0.105]]
Validation f1: 15.09
Validation accuracy: 94.39
Validation recall: 10.53
Validation precision: 26.67
Validation AUC: 0.12857243863979212
Validation class accuracies: [0.9856020942408377, 0.10526315789473684]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 7 epochs
Epoch 28/65
201/201 - 307s - loss: 0.0289 - accuracy: 0.9888 - val_loss: 0.2287 - val_accuracy: 0.9239
Confusion matrix: 
 [[734  30]
 [ 31   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.961 0.039]
 [0.816 0.184]]
Validation f1: 18.67
Validation accuracy: 92.39
Validation recall: 18.42
Validation precision: 18.92
Validation AUC: 0.15437129920973047
Validation class accuracies: [0.9607329842931938, 0.18421052631578946]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 8 epochs
Epoch 29/65
201/201 - 306s - loss: 0.0223 - accuracy: 0.9919 - val_loss: 0.4106 - val_accuracy: 0.8579
Confusion matrix: 
 [[672  92]
 [ 22  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.579 0.421]]
Validation f1: 21.92
Validation accuracy: 85.79
Validation recall: 42.11
Validation precision: 14.81
Validation AUC: 0.14733708844422094
Validation class accuracies: [0.8795811518324608, 0.42105263157894735]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 9 epochs
Epoch 30/65
201/201 - 307s - loss: 0.0234 - accuracy: 0.9913 - val_loss: 0.2696 - val_accuracy: 0.9165
Confusion matrix: 
 [[727  37]
 [ 30   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.952 0.048]
 [0.789 0.211]]
Validation f1: 19.28
Validation accuracy: 91.65
Validation recall: 21.05
Validation precision: 17.78
Validation AUC: 0.1406942770285655
Validation class accuracies: [0.9515706806282722, 0.21052631578947367]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 10 epochs
Epoch 31/65
201/201 - 306s - loss: 0.0139 - accuracy: 0.9956 - val_loss: 0.2410 - val_accuracy: 0.9339
Confusion matrix: 
 [[740  24]
 [ 29   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.763 0.237]]
Validation f1: 25.35
Validation accuracy: 93.39
Validation recall: 23.68
Validation precision: 27.27
Validation AUC: 0.15595085807335
Validation class accuracies: [0.9685863874345549, 0.23684210526315788]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 11 epochs
Epoch 32/65
201/201 - 307s - loss: 0.0278 - accuracy: 0.9888 - val_loss: 0.2367 - val_accuracy: 0.9426
Confusion matrix: 
 [[752  12]
 [ 34   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.895 0.105]]
Validation f1: 14.81
Validation accuracy: 94.26
Validation recall: 10.53
Validation precision: 25.00
Validation AUC: 0.12652431794278104
Validation class accuracies: [0.9842931937172775, 0.10526315789473684]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 33/65
201/201 - 307s - loss: 0.0129 - accuracy: 0.9966 - val_loss: 0.2503 - val_accuracy: 0.9426
Confusion matrix: 
 [[751  13]
 [ 33   5]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.868 0.132]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.86
Validation accuracy: 94.26
Validation recall: 13.16
Validation precision: 27.78
Validation AUC: 0.1378631124203279
Validation class accuracies: [0.9829842931937173, 0.13157894736842105]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 13 epochs
Epoch 34/65
201/201 - 307s - loss: 0.0091 - accuracy: 0.9959 - val_loss: 0.2390 - val_accuracy: 0.9464
Confusion matrix: 
 [[754  10]
 [ 33   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.987 0.013]
 [0.868 0.132]]
Validation f1: 18.87
Validation accuracy: 94.64
Validation recall: 13.16
Validation precision: 33.33
Validation AUC: 0.14403739731460177
Validation class accuracies: [0.9869109947643979, 0.13157894736842105]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 14 epochs
Epoch 35/65
201/201 - 306s - loss: 0.0096 - accuracy: 0.9988 - val_loss: 0.3464 - val_accuracy: 0.9002
Confusion matrix: 
 [[711  53]
 [ 27  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.931 0.069]
 [0.711 0.289]]
Validation f1: 21.57
Validation accuracy: 90.02
Validation recall: 28.95
Validation precision: 17.19
Validation AUC: 0.13446754378550616
Validation class accuracies: [0.930628272251309, 0.2894736842105263]
The validation tracker metric at 0.2727272727272727 hasn't increased by 0 in 15 epochs
Epoch 36/65
201/201 - 307s - loss: 0.0155 - accuracy: 0.9950 - val_loss: 0.2514 - val_accuracy: 0.9352
Confusion matrix: 
 [[740  24]
 [ 28  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.737 0.263]]
Validation f1: 27.78
Validation accuracy: 93.52
Validation recall: 26.32
Validation precision: 29.41
Validation AUC: 0.1689082410851311
Validation class accuracies: [0.9685863874345549, 0.2631578947368421]
Saving model...
Epoch 37/65
201/201 - 306s - loss: 0.0096 - accuracy: 0.9969 - val_loss: 0.2311 - val_accuracy: 0.9476
Confusion matrix: 
 [[753  11]
 [ 31   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.816 0.184]]
Validation f1: 25.00
Validation accuracy: 94.76
Validation recall: 18.42
Validation precision: 38.89
Validation AUC: 0.1852482070733991
Validation class accuracies: [0.9856020942408377, 0.18421052631578946]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 1 epochs
Epoch 38/65
201/201 - 306s - loss: 0.0108 - accuracy: 0.9972 - val_loss: 0.2456 - val_accuracy: 0.9451
Confusion matrix: 
 [[750  14]
 [ 30   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.982 0.018]
 [0.789 0.211]]
Validation f1: 26.67
Validation accuracy: 94.51
Validation recall: 21.05
Validation precision: 36.36
Validation AUC: 0.1850732131067275
Validation class accuracies: [0.981675392670157, 0.21052631578947367]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 2 epochs
Epoch 39/65
201/201 - 307s - loss: 0.0076 - accuracy: 0.9972 - val_loss: 0.2373 - val_accuracy: 0.9401
Confusion matrix: 
 [[745  19]
 [ 29   9]]
Normalized Confusion matrix: 
 [[0.975 0.025]
 [0.763 0.237]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.27
Validation accuracy: 94.01
Validation recall: 23.68
Validation precision: 32.14
Validation AUC: 0.18748254369504924
Validation class accuracies: [0.975130890052356, 0.23684210526315788]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 3 epochs
Epoch 40/65
201/201 - 307s - loss: 0.0079 - accuracy: 0.9988 - val_loss: 0.2473 - val_accuracy: 0.9377
Confusion matrix: 
 [[743  21]
 [ 29   9]]
Normalized Confusion matrix: 
 [[0.973 0.027]
 [0.763 0.237]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.47
Validation accuracy: 93.77
Validation recall: 23.68
Validation precision: 30.00
Validation AUC: 0.19086625263461648
Validation class accuracies: [0.9725130890052356, 0.23684210526315788]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 4 epochs
Epoch 41/65
201/201 - 306s - loss: 0.0062 - accuracy: 0.9972 - val_loss: 0.2436 - val_accuracy: 0.9476
Confusion matrix: 
 [[754  10]
 [ 32   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.987 0.013]
 [0.842 0.158]]
Validation f1: 22.22
Validation accuracy: 94.76
Validation recall: 15.79
Validation precision: 37.50
Validation AUC: 0.1828192075414802
Validation class accuracies: [0.9869109947643979, 0.15789473684210525]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 5 epochs
Epoch 42/65
201/201 - 307s - loss: 0.0059 - accuracy: 0.9984 - val_loss: 0.2482 - val_accuracy: 0.9514
Confusion matrix: 
 [[758   6]
 [ 33   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.992 0.008]
 [0.868 0.132]]
Validation f1: 20.41
Validation accuracy: 95.14
Validation recall: 13.16
Validation precision: 45.45
Validation AUC: 0.18618984147835074
Validation class accuracies: [0.9921465968586387, 0.13157894736842105]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 43/65
201/201 - 307s - loss: 0.0057 - accuracy: 0.9984 - val_loss: 0.2481 - val_accuracy: 0.9489
Confusion matrix: 
 [[756   8]
 [ 33   5]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.868 0.132]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 19.61
Validation accuracy: 94.89
Validation recall: 13.16
Validation precision: 38.46
Validation AUC: 0.19560484961979338
Validation class accuracies: [0.9895287958115183, 0.13157894736842105]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 7 epochs
Epoch 44/65
201/201 - 307s - loss: 0.0049 - accuracy: 0.9994 - val_loss: 0.2470 - val_accuracy: 0.9377
Confusion matrix: 
 [[743  21]
 [ 29   9]]
Normalized Confusion matrix: 
 [[0.973 0.027]
 [0.763 0.237]]
Validation f1: 26.47
Validation accuracy: 93.77
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 23.68
Validation precision: 30.00
Validation AUC: 0.19471777319600866
Validation class accuracies: [0.9725130890052356, 0.23684210526315788]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 8 epochs
Epoch 45/65
201/201 - 308s - loss: 0.0033 - accuracy: 1.0000 - val_loss: 0.2440 - val_accuracy: 0.9489
Confusion matrix: 
 [[755   9]
 [ 32   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.842 0.158]]
Validation f1: 22.64
Validation accuracy: 94.89
Validation recall: 15.79
Validation precision: 40.00
Validation AUC: 0.20065366869206863
Validation class accuracies: [0.9882198952879581, 0.15789473684210525]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 9 epochs
Epoch 46/65
201/201 - 307s - loss: 0.0080 - accuracy: 0.9984 - val_loss: 0.2552 - val_accuracy: 0.9414
Confusion matrix: 
 [[749  15]
 [ 32   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.842 0.158]]
Validation f1: 20.34
Validation accuracy: 94.14
Validation recall: 15.79
Validation precision: 28.57
Validation AUC: 0.1924472244787092
Validation class accuracies: [0.9803664921465969, 0.15789473684210525]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 10 epochs
Epoch 47/65
201/201 - 306s - loss: 0.0046 - accuracy: 0.9994 - val_loss: 0.2605 - val_accuracy: 0.9514
Confusion matrix: 
 [[758   6]
 [ 33   5]]
Normalized Confusion matrix: 
 [[0.992 0.008]
 [0.868 0.132]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.41
Validation accuracy: 95.14
Validation recall: 13.16
Validation precision: 45.45
Validation AUC: 0.18908786402763883
Validation class accuracies: [0.9921465968586387, 0.13157894736842105]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 11 epochs
Epoch 48/65
201/201 - 307s - loss: 0.0034 - accuracy: 0.9991 - val_loss: 0.2571 - val_accuracy: 0.9526
Confusion matrix: 
 [[759   5]
 [ 33   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.868 0.132]]
Validation f1: 20.83
Validation accuracy: 95.26
Validation recall: 13.16
Validation precision: 50.00
Validation AUC: 0.19418546256193187
Validation class accuracies: [0.993455497382199, 0.13157894736842105]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 49/65
201/201 - 307s - loss: 0.0059 - accuracy: 0.9994 - val_loss: 0.2558 - val_accuracy: 0.9389
Confusion matrix: 
 [[746  18]
 [ 31   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.816 0.184]]
Validation f1: 22.22
Validation accuracy: 93.89
Validation recall: 18.42
Validation precision: 28.00
Validation AUC: 0.18632795370552455
Validation class accuracies: [0.9764397905759162, 0.18421052631578946]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 13 epochs
Epoch 50/65
201/201 - 307s - loss: 0.0042 - accuracy: 0.9997 - val_loss: 0.2510 - val_accuracy: 0.9414
Confusion matrix: 
 [[750  14]
 [ 33   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.982 0.018]
 [0.868 0.132]]
Validation f1: 17.54
Validation accuracy: 94.14
Validation recall: 13.16
Validation precision: 26.32
Validation AUC: 0.1891528765817447
Validation class accuracies: [0.981675392670157, 0.13157894736842105]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 14 epochs
Epoch 51/65
201/201 - 306s - loss: 0.0032 - accuracy: 0.9994 - val_loss: 0.2533 - val_accuracy: 0.9476
Confusion matrix: 
 [[755   9]
 [ 33   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.868 0.132]]
Validation f1: 19.23
Validation accuracy: 94.76
Validation recall: 13.16
Validation precision: 35.71
Validation AUC: 0.19290766086353076
Validation class accuracies: [0.9882198952879581, 0.13157894736842105]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 15 epochs
Epoch 52/65
201/201 - 306s - loss: 0.0038 - accuracy: 0.9997 - val_loss: 0.2528 - val_accuracy: 0.9426
Confusion matrix: 
 [[749  15]
 [ 31   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98  0.02 ]
 [0.816 0.184]]
Validation f1: 23.33
Validation accuracy: 94.26
Validation recall: 18.42
Validation precision: 31.82
Validation AUC: 0.19086333850762932
Validation class accuracies: [0.9803664921465969, 0.18421052631578946]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 16 epochs
Epoch 53/65
201/201 - 307s - loss: 0.0042 - accuracy: 0.9991 - val_loss: 0.2584 - val_accuracy: 0.9414
Confusion matrix: 
 [[747  17]
 [ 30   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.978 0.022]
 [0.789 0.211]]
Validation f1: 25.40
Validation accuracy: 94.14
Validation recall: 21.05
Validation precision: 32.00
Validation AUC: 0.18415358166822254
Validation class accuracies: [0.9777486910994765, 0.21052631578947367]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 17 epochs
Epoch 54/65
201/201 - 307s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.2568 - val_accuracy: 0.9414
Confusion matrix: 
 [[748  16]
 [ 31   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.816 0.184]]
Validation f1: 22.95
Validation accuracy: 94.14
Validation recall: 18.42
Validation precision: 30.43
Validation AUC: 0.1874892517307093
Validation class accuracies: [0.9790575916230366, 0.18421052631578946]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 55/65
201/201 - 307s - loss: 0.0041 - accuracy: 0.9997 - val_loss: 0.2582 - val_accuracy: 0.9414
Confusion matrix: 
 [[747  17]
 [ 30   8]]
Normalized Confusion matrix: 
 [[0.978 0.022]
 [0.789 0.211]]
Validation f1: 25.40
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.14
Validation recall: 21.05
Validation precision: 32.00
Validation AUC: 0.1890791805530752
Validation class accuracies: [0.9777486910994765, 0.21052631578947367]
The validation tracker metric at 0.27777777777777773 hasn't increased by 0 in 19 epochs
Epoch 56/65
201/201 - 306s - loss: 0.0105 - accuracy: 0.9994 - val_loss: 0.2598 - val_accuracy: 0.9439
Confusion matrix: 
 [[751  13]
 [ 32   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.842 0.158]]
Validation f1: 21.05
Validation accuracy: 94.39
Validation recall: 15.79
Validation precision: 31.58
Validation AUC: 0.1865803446183475
Validation class accuracies: [0.9829842931937173, 0.15789473684210525]

The metrics for job 0 with the best target metric are: 
Best cm: [[740  24]
 [ 28  10]]
Best normalized cm: [[0.969 0.031]
 [0.737 0.263]]
Best f1: 0.28
Best accuracy: 0.94
Best recall: 0.26
Best precision: 0.29
Best AUC: 0.17
Best class accuracies: [0.9685863874345549, 0.2631578947368421]
Best epoch: 36
The number of epochs since last 1% equals the patience
-----------------------
Mixednet
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 199, Non-pneumonia patients: 3810
-----------------------
Number of train recordings: 3207 with pneumonia: 161 and non-pneumonia: 3046
Number of val recordings: 802 with pneumonia: 38 and non-pneumonia: 764
-----------------------
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5261154855643044, 1: 10.07286432160804}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
201/201 - 89s - loss: 0.5357 - accuracy: 0.6399 - val_loss: 0.6065 - val_accuracy: 0.9526
Confusion matrix: 
 [[764   0]
 [ 38   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.26
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.04076003804409265
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
201/201 - 83s - loss: 0.3546 - accuracy: 0.8513 - val_loss: 0.5862 - val_accuracy: 0.9526
Confusion matrix: 
 [[764   0]
 [ 38   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 95.26
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.04360742730718781
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
201/201 - 83s - loss: 0.2908 - accuracy: 0.8800 - val_loss: 0.5661 - val_accuracy: 0.8678
Confusion matrix: 
 [[684  80]
 [ 26  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.684 0.316]]
Validation f1: 18.46
Validation accuracy: 86.78
Validation recall: 31.58
Validation precision: 13.04
Validation AUC: 0.1039987911402295
Validation class accuracies: [0.8952879581151832, 0.3157894736842105]
Saving model...
Epoch 4/65
201/201 - 82s - loss: 0.2140 - accuracy: 0.9055 - val_loss: 0.3774 - val_accuracy: 0.8392
Confusion matrix: 
 [[664 100]
 [ 29   9]]
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.763 0.237]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.24
Validation accuracy: 83.92
Validation recall: 23.68
Validation precision: 8.26
Validation AUC: 0.06936648914118346
Validation class accuracies: [0.8691099476439791, 0.23684210526315788]
The validation tracker metric at 0.1846153846153846 hasn't increased by 0 in 1 epochs
Epoch 5/65
201/201 - 88s - loss: 0.1748 - accuracy: 0.9317 - val_loss: 1.4063 - val_accuracy: 0.3753
Confusion matrix: 
 [[275 489]
 [ 12  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.36  0.64 ]
 [0.316 0.684]]
Validation f1: 9.40
Validation accuracy: 37.53
Validation recall: 68.42
Validation precision: 5.05
Validation AUC: 0.048618301407341774
Validation class accuracies: [0.3599476439790576, 0.6842105263157895]
The validation tracker metric at 0.1846153846153846 hasn't increased by 0 in 2 epochs
Epoch 6/65
201/201 - 83s - loss: 0.1524 - accuracy: 0.9364 - val_loss: 0.2336 - val_accuracy: 0.9289
Confusion matrix: 
 [[739  25]
 [ 32   6]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.842 0.158]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.39
Validation accuracy: 92.89
Validation recall: 15.79
Validation precision: 19.35
Validation AUC: 0.16434208076295326
Validation class accuracies: [0.9672774869109948, 0.15789473684210525]
The validation tracker metric at 0.1846153846153846 hasn't increased by 0 in 3 epochs
Epoch 7/65
201/201 - 83s - loss: 0.1110 - accuracy: 0.9548 - val_loss: 0.4157 - val_accuracy: 0.8267
Confusion matrix: 
 [[648 116]
 [ 23  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.605 0.395]]
Validation f1: 17.75
Validation accuracy: 82.67
Validation recall: 39.47
Validation precision: 11.45
Validation AUC: 0.11716469321351423
Validation class accuracies: [0.8481675392670157, 0.39473684210526316]
The validation tracker metric at 0.1846153846153846 hasn't increased by 0 in 4 epochs
Epoch 8/65
201/201 - 84s - loss: 0.0877 - accuracy: 0.9648 - val_loss: 0.7963 - val_accuracy: 0.6197
Confusion matrix: 
 [[469 295]
 [ 10  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.614 0.386]
 [0.263 0.737]]
Validation f1: 15.51
Validation accuracy: 61.97
Validation recall: 73.68
Validation precision: 8.67
Validation AUC: 0.12794141218538885
Validation class accuracies: [0.6138743455497382, 0.7368421052631579]
The validation tracker metric at 0.1846153846153846 hasn't increased by 0 in 5 epochs
Epoch 9/65
201/201 - 86s - loss: 0.0587 - accuracy: 0.9797 - val_loss: 0.4712 - val_accuracy: 0.8067
Confusion matrix: 
 [[623 141]
 [ 14  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.815 0.185]
 [0.368 0.632]]
Validation f1: 23.65
Validation accuracy: 80.67
Validation recall: 63.16
Validation precision: 14.55
Validation AUC: 0.17738195323391984
Validation class accuracies: [0.8154450261780105, 0.631578947368421]
Saving model...
Epoch 10/65
201/201 - 84s - loss: 0.0657 - accuracy: 0.9769 - val_loss: 1.7615 - val_accuracy: 0.4638
Confusion matrix: 
 [[340 424]
 [  6  32]]
Normalized Confusion matrix: 
 [[0.445 0.555]
 [0.158 0.842]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.96
Validation accuracy: 46.38
Validation recall: 84.21
Validation precision: 7.02
Validation AUC: 0.09194285989704047
Validation class accuracies: [0.44502617801047123, 0.8421052631578947]
The validation tracker metric at 0.2364532019704433 hasn't increased by 0 in 1 epochs
Epoch 11/65
201/201 - 83s - loss: 0.0478 - accuracy: 0.9841 - val_loss: 0.2806 - val_accuracy: 0.8928
Confusion matrix: 
 [[707  57]
 [ 29   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.763 0.237]]
Validation f1: 17.31
Validation accuracy: 89.28
Validation recall: 23.68
Validation precision: 13.64
Validation AUC: 0.1192728381775113
Validation class accuracies: [0.925392670157068, 0.23684210526315788]
The validation tracker metric at 0.2364532019704433 hasn't increased by 0 in 2 epochs
Epoch 12/65
201/201 - 85s - loss: 0.0325 - accuracy: 0.9900 - val_loss: 0.1742 - val_accuracy: 0.9439
Confusion matrix: 
 [[751  13]
 [ 32   6]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.842 0.158]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.05
Validation accuracy: 94.39
Validation recall: 15.79
Validation precision: 31.58
Validation AUC: 0.2502794820548735
Validation class accuracies: [0.9829842931937173, 0.15789473684210525]
The validation tracker metric at 0.2364532019704433 hasn't increased by 0 in 3 epochs
Epoch 13/65
201/201 - 86s - loss: 0.0312 - accuracy: 0.9891 - val_loss: 0.4615 - val_accuracy: 0.8217
Confusion matrix: 
 [[640 124]
 [ 19  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.5   0.5  ]]
Validation f1: 20.99
Validation accuracy: 82.17
Validation recall: 50.00
Validation precision: 13.29
Validation AUC: 0.1994768023336779
Validation class accuracies: [0.837696335078534, 0.5]
The validation tracker metric at 0.2364532019704433 hasn't increased by 0 in 4 epochs
Epoch 14/65
201/201 - 85s - loss: 0.0185 - accuracy: 0.9959 - val_loss: 0.2455 - val_accuracy: 0.9040
Confusion matrix: 
 [[710  54]
 [ 23  15]]
Normalized Confusion matrix: 
 [[0.929 0.071]
 [0.605 0.395]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.04
Validation accuracy: 90.40
Validation recall: 39.47
Validation precision: 21.74
Validation AUC: 0.23825607236079413
Validation class accuracies: [0.9293193717277487, 0.39473684210526316]
Saving model...
Epoch 15/65
201/201 - 85s - loss: 0.0396 - accuracy: 0.9866 - val_loss: 0.2422 - val_accuracy: 0.9115
Confusion matrix: 
 [[718  46]
 [ 25  13]]
Normalized Confusion matrix: 
 [[0.94  0.06 ]
 [0.658 0.342]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.80
Validation accuracy: 91.15
Validation recall: 34.21
Validation precision: 22.03
Validation AUC: 0.24055734406929527
Validation class accuracies: [0.9397905759162304, 0.34210526315789475]
The validation tracker metric at 0.28037383177570097 hasn't increased by 0 in 1 epochs
Epoch 16/65
201/201 - 85s - loss: 0.0165 - accuracy: 0.9963 - val_loss: 0.4091 - val_accuracy: 0.8379
Confusion matrix: 
 [[653 111]
 [ 19  19]]
Normalized Confusion matrix: 
 [[0.855 0.145]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.62
Validation accuracy: 83.79
Validation recall: 50.00
Validation precision: 14.62
Validation AUC: 0.2102455038453743
Validation class accuracies: [0.8547120418848168, 0.5]
The validation tracker metric at 0.28037383177570097 hasn't increased by 0 in 2 epochs
Epoch 17/65
201/201 - 86s - loss: 0.0170 - accuracy: 0.9978 - val_loss: 0.2335 - val_accuracy: 0.9177
Confusion matrix: 
 [[721  43]
 [ 23  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.605 0.395]]
Validation f1: 31.25
Validation accuracy: 91.77
Validation recall: 39.47
Validation precision: 25.86
Validation AUC: 0.2341200400614685
Validation class accuracies: [0.943717277486911, 0.39473684210526316]
Saving model...
Epoch 18/65
201/201 - 86s - loss: 0.0113 - accuracy: 0.9988 - val_loss: 0.2282 - val_accuracy: 0.9202
Confusion matrix: 
 [[727  37]
 [ 27  11]]
Normalized Confusion matrix: 
 [[0.952 0.048]
 [0.711 0.289]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.58
Validation accuracy: 92.02
Validation recall: 28.95
Validation precision: 22.92
Validation AUC: 0.20951406898112562
Validation class accuracies: [0.9515706806282722, 0.2894736842105263]
The validation tracker metric at 0.3125 hasn't increased by 0 in 1 epochs
Epoch 19/65
201/201 - 86s - loss: 0.0083 - accuracy: 0.9984 - val_loss: 0.4597 - val_accuracy: 0.8279
Confusion matrix: 
 [[644 120]
 [ 18  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.474 0.526]]
Validation f1: 22.47
Validation accuracy: 82.79
Validation recall: 52.63
Validation precision: 14.29
Validation AUC: 0.19953342441117142
Validation class accuracies: [0.8429319371727748, 0.5263157894736842]
The validation tracker metric at 0.3125 hasn't increased by 0 in 2 epochs
Epoch 20/65
201/201 - 89s - loss: 0.0079 - accuracy: 0.9991 - val_loss: 0.2592 - val_accuracy: 0.9102
Confusion matrix: 
 [[714  50]
 [ 22  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.579 0.421]]
Validation f1: 30.77
Validation accuracy: 91.02
Validation recall: 42.11
Validation precision: 24.24
Validation AUC: 0.22326366116547564
Validation class accuracies: [0.9345549738219895, 0.42105263157894735]
The validation tracker metric at 0.3125 hasn't increased by 0 in 3 epochs
Epoch 21/65
201/201 - 86s - loss: 0.0079 - accuracy: 0.9988 - val_loss: 0.7899 - val_accuracy: 0.7519
Confusion matrix: 
 [[578 186]
 [ 13  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.757 0.243]
 [0.342 0.658]]
Validation f1: 20.08
Validation accuracy: 75.19
Validation recall: 65.79
Validation precision: 11.85
Validation AUC: 0.20235101025698893
Validation class accuracies: [0.756544502617801, 0.6578947368421053]
The validation tracker metric at 0.3125 hasn't increased by 0 in 4 epochs
Epoch 22/65
201/201 - 86s - loss: 0.0060 - accuracy: 0.9991 - val_loss: 0.3569 - val_accuracy: 0.8678
Confusion matrix: 
 [[672  92]
 [ 14  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.368 0.632]]
Validation f1: 31.17
Validation accuracy: 86.78
Validation recall: 63.16
Validation precision: 20.69
Validation AUC: 0.23209277373083645
Validation class accuracies: [0.8795811518324608, 0.631578947368421]
The validation tracker metric at 0.3125 hasn't increased by 0 in 5 epochs
Epoch 23/65
201/201 - 85s - loss: 0.0049 - accuracy: 0.9994 - val_loss: 0.3636 - val_accuracy: 0.8653
Confusion matrix: 
 [[676  88]
 [ 20  18]]
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.526 0.474]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.00
Validation accuracy: 86.53
Validation recall: 47.37
Validation precision: 16.98
Validation AUC: 0.2216613549553659
Validation class accuracies: [0.8848167539267016, 0.47368421052631576]
The validation tracker metric at 0.3125 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 24/65
201/201 - 87s - loss: 0.0048 - accuracy: 0.9997 - val_loss: 0.3153 - val_accuracy: 0.8815
Confusion matrix: 
 [[690  74]
 [ 21  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.903 0.097]
 [0.553 0.447]]
Validation f1: 26.36
Validation accuracy: 88.15
Validation recall: 44.74
Validation precision: 18.68
Validation AUC: 0.23601625519641023
Validation class accuracies: [0.9031413612565445, 0.4473684210526316]
The validation tracker metric at 0.3125 hasn't increased by 0 in 7 epochs
Epoch 25/65
201/201 - 84s - loss: 0.0036 - accuracy: 1.0000 - val_loss: 0.2656 - val_accuracy: 0.8990
Confusion matrix: 
 [[705  59]
 [ 22  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.579 0.421]]
Validation f1: 28.32
Validation accuracy: 89.90
Validation recall: 42.11
Validation precision: 21.33
Validation AUC: 0.2394748724357958
Validation class accuracies: [0.9227748691099477, 0.42105263157894735]
The validation tracker metric at 0.3125 hasn't increased by 0 in 8 epochs
Epoch 26/65
201/201 - 84s - loss: 0.0034 - accuracy: 1.0000 - val_loss: 0.1958 - val_accuracy: 0.9377
Confusion matrix: 
 [[740  24]
 [ 26  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.684 0.316]]
Validation f1: 32.43
Validation accuracy: 93.77
Validation recall: 31.58
Validation precision: 33.33
Validation AUC: 0.2588592866538203
Validation class accuracies: [0.9685863874345549, 0.3157894736842105]
Saving model...
Epoch 27/65
201/201 - 84s - loss: 0.0031 - accuracy: 1.0000 - val_loss: 0.2342 - val_accuracy: 0.9140
Confusion matrix: 
 [[720  44]
 [ 25  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.658 0.342]]
Validation f1: 27.37
Validation accuracy: 91.40
Validation recall: 34.21
Validation precision: 22.81
Validation AUC: 0.24511884011151797
Validation class accuracies: [0.9424083769633508, 0.34210526315789475]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 1 epochs
Epoch 28/65
201/201 - 86s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.2416 - val_accuracy: 0.9052
Confusion matrix: 
 [[713  51]
 [ 25  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.933 0.067]
 [0.658 0.342]]
Validation f1: 25.49
Validation accuracy: 90.52
Validation recall: 34.21
Validation precision: 20.31
Validation AUC: 0.24816961422682776
Validation class accuracies: [0.9332460732984293, 0.34210526315789475]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 2 epochs
Epoch 29/65
201/201 - 84s - loss: 0.0036 - accuracy: 0.9991 - val_loss: 0.2753 - val_accuracy: 0.8928
Confusion matrix: 
 [[701  63]
 [ 23  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.605 0.395]]
Validation f1: 25.86
Validation accuracy: 89.28
Validation recall: 39.47
Validation precision: 19.23
Validation AUC: 0.23990067166060866
Validation class accuracies: [0.9175392670157068, 0.39473684210526316]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 3 epochs
Epoch 30/65
201/201 - 84s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.3066 - val_accuracy: 0.8878
Confusion matrix: 
 [[696  68]
 [ 22  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.579 0.421]]
Validation f1: 26.23
Validation accuracy: 88.78
Validation recall: 42.11
Validation precision: 19.05
Validation AUC: 0.21714473584676822
Validation class accuracies: [0.9109947643979057, 0.42105263157894735]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 4 epochs
Epoch 31/65
201/201 - 84s - loss: 0.0021 - accuracy: 1.0000 - val_loss: 0.3598 - val_accuracy: 0.8616
Confusion matrix: 
 [[673  91]
 [ 20  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.526 0.474]]
Validation f1: 24.49
Validation accuracy: 86.16
Validation recall: 47.37
Validation precision: 16.51
Validation AUC: 0.23379993608989316
Validation class accuracies: [0.8808900523560209, 0.47368421052631576]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 5 epochs
Epoch 32/65
201/201 - 86s - loss: 0.0029 - accuracy: 1.0000 - val_loss: 0.2670 - val_accuracy: 0.9102
Confusion matrix: 
 [[715  49]
 [ 23  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.936 0.064]
 [0.605 0.395]]
Validation f1: 29.41
Validation accuracy: 91.02
Validation recall: 39.47
Validation precision: 23.44
Validation AUC: 0.23766127017789807
Validation class accuracies: [0.9358638743455497, 0.39473684210526316]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 33/65
201/201 - 84s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.3194 - val_accuracy: 0.8791
Confusion matrix: 
 [[688  76]
 [ 21  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.553 0.447]]
Validation f1: 25.95
Validation accuracy: 87.91
Validation recall: 44.74
Validation precision: 18.28
Validation AUC: 0.2418272587923824
Validation class accuracies: [0.900523560209424, 0.4473684210526316]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 7 epochs
Epoch 34/65
201/201 - 84s - loss: 0.0020 - accuracy: 1.0000 - val_loss: 0.2568 - val_accuracy: 0.9027
Confusion matrix: 
 [[709  55]
 [ 23  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.605 0.395]]
Validation f1: 27.78
Validation accuracy: 90.27
Validation recall: 39.47
Validation precision: 21.43
Validation AUC: 0.23522048444776963
Validation class accuracies: [0.9280104712041884, 0.39473684210526316]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 8 epochs
Epoch 35/65
201/201 - 88s - loss: 0.0019 - accuracy: 0.9997 - val_loss: 0.2848 - val_accuracy: 0.8940
Confusion matrix: 
 [[701  63]
 [ 22  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.579 0.421]]
Validation f1: 27.35
Validation accuracy: 89.40
Validation recall: 42.11
Validation precision: 20.25
Validation AUC: 0.2353506738002147
Validation class accuracies: [0.9175392670157068, 0.42105263157894735]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 9 epochs
Epoch 36/65
201/201 - 85s - loss: 0.0020 - accuracy: 1.0000 - val_loss: 0.3194 - val_accuracy: 0.8828
Confusion matrix: 
 [[693  71]
 [ 23  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.907 0.093]
 [0.605 0.395]]
Validation f1: 24.19
Validation accuracy: 88.28
Validation recall: 39.47
Validation precision: 17.44
Validation AUC: 0.2264576597139809
Validation class accuracies: [0.9070680628272252, 0.39473684210526316]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 10 epochs
Epoch 37/65
201/201 - 84s - loss: 0.0017 - accuracy: 0.9997 - val_loss: 0.3345 - val_accuracy: 0.8728
Confusion matrix: 
 [[684  80]
 [ 22  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.579 0.421]]
Validation f1: 23.88
Validation accuracy: 87.28
Validation recall: 42.11
Validation precision: 16.67
Validation AUC: 0.23002030585086747
Validation class accuracies: [0.8952879581151832, 0.42105263157894735]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 11 epochs
Epoch 38/65
201/201 - 84s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.3575 - val_accuracy: 0.8678
Confusion matrix: 
 [[679  85]
 [ 21  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.889 0.111]
 [0.553 0.447]]
Validation f1: 24.29
Validation accuracy: 86.78
Validation recall: 44.74
Validation precision: 16.67
Validation AUC: 0.23370198139915488
Validation class accuracies: [0.8887434554973822, 0.4473684210526316]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 39/65
201/201 - 85s - loss: 0.0015 - accuracy: 1.0000 - val_loss: 0.2630 - val_accuracy: 0.9052
Confusion matrix: 
 [[712  52]
 [ 24  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.632 0.368]]
Validation f1: 26.92
Validation accuracy: 90.52
Validation recall: 36.84
Validation precision: 21.21
Validation AUC: 0.23599519078052866
Validation class accuracies: [0.9319371727748691, 0.3684210526315789]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 13 epochs
Epoch 40/65
201/201 - 84s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.2542 - val_accuracy: 0.9090
Confusion matrix: 
 [[715  49]
 [ 24  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.936 0.064]
 [0.632 0.368]]
Validation f1: 27.72
Validation accuracy: 90.90
Validation recall: 36.84
Validation precision: 22.22
Validation AUC: 0.23920693920647237
Validation class accuracies: [0.9358638743455497, 0.3684210526315789]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 14 epochs
Epoch 41/65
201/201 - 84s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.2453 - val_accuracy: 0.9102
Confusion matrix: 
 [[718  46]
 [ 26  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.94  0.06 ]
 [0.684 0.316]]
Validation f1: 25.00
Validation accuracy: 91.02
Validation recall: 31.58
Validation precision: 20.69
Validation AUC: 0.23327588146162898
Validation class accuracies: [0.9397905759162304, 0.3157894736842105]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 15 epochs
Epoch 42/65
201/201 - 85s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.2737 - val_accuracy: 0.9002
Confusion matrix: 
 [[707  57]
 [ 23  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.605 0.395]]
Validation f1: 27.27
Validation accuracy: 90.02
Validation recall: 39.47
Validation precision: 20.83
Validation AUC: 0.23535980622002353
Validation class accuracies: [0.925392670157068, 0.39473684210526316]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 16 epochs
Epoch 43/65
201/201 - 86s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.2355 - val_accuracy: 0.9227
Confusion matrix: 
 [[728  36]
 [ 26  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.684 0.316]]
Validation f1: 27.91
Validation accuracy: 92.27
Validation recall: 31.58
Validation precision: 25.00
Validation AUC: 0.24632051373664443
Validation class accuracies: [0.9528795811518325, 0.3157894736842105]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 17 epochs
Epoch 44/65
201/201 - 84s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.2486 - val_accuracy: 0.9115
Confusion matrix: 
 [[718  46]
 [ 25  13]]
Normalized Confusion matrix: 
 [[0.94  0.06 ]
 [0.658 0.342]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.80
Validation accuracy: 91.15
Validation recall: 34.21
Validation precision: 22.03
Validation AUC: 0.24378500679178924
Validation class accuracies: [0.9397905759162304, 0.34210526315789475]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 45/65
201/201 - 83s - loss: 0.0017 - accuracy: 1.0000 - val_loss: 0.2629 - val_accuracy: 0.9052
Confusion matrix: 
 [[712  52]
 [ 24  14]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.632 0.368]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.92
Validation accuracy: 90.52
Validation recall: 36.84
Validation precision: 21.21
Validation AUC: 0.23606985637806854
Validation class accuracies: [0.9319371727748691, 0.3684210526315789]
The validation tracker metric at 0.3243243243243243 hasn't increased by 0 in 19 epochs
Epoch 46/65
201/201 - 84s - loss: 0.0027 - accuracy: 0.9997 - val_loss: 0.2408 - val_accuracy: 0.9202
Confusion matrix: 
 [[726  38]
 [ 26  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.95  0.05 ]
 [0.684 0.316]]
Validation f1: 27.27
Validation accuracy: 92.02
Validation recall: 31.58
Validation precision: 24.00
Validation AUC: 0.2398486580074875
Validation class accuracies: [0.9502617801047121, 0.3157894736842105]

The metrics for job 0 with the best target metric are: 
Best cm: [[740  24]
 [ 26  12]]
Best normalized cm: [[0.969 0.031]
 [0.684 0.316]]
Best f1: 0.32
Best accuracy: 0.94
Best recall: 0.32
Best precision: 0.33
Best AUC: 0.26
Best class accuracies: [0.9685863874345549, 0.3157894736842105]
Best epoch: 26
[34m[1mwandb[0m: [32m[41mERROR[0m Attempted to change value of key "weight_decay" from 0.001 to 1e-05
[34m[1mwandb[0m: [32m[41mERROR[0m If you really want to do this, pass allow_val_change=True to config.update()
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2234.py", line 404, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params, model9)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2234.py", line 231, in train_model
    config.weight_decay = weight_decay
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/sdk/wandb_config.py", line 139, in __setitem__
    key, val = self._sanitize(key, val)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/sdk/wandb_config.py", line 237, in _sanitize
    ).format(key, self._items[key], val)
wandb.sdk.lib.config_util.ConfigError: Attempted to change value of key "weight_decay" from 0.001 to 1e-05
If you really want to do this, pass allow_val_change=True to config.update()
The number of epochs since last 1% equals the patience
-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 1e-05, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
wandb: Waiting for W&B process to finish, PID 6275
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210622_015611-1algnosv/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210622_015611-1algnosv/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99969
wandb:         val_accuracy 0.9202
wandb:             _runtime 22817
wandb:           _timestamp 1624349789
wandb:                _step 761
wandb:           train_loss 0.00273
wandb:             val_loss 0.24085
wandb:           val_recall 0.31579
wandb:        val_precision 0.24
wandb:               val_f1 0.27273
wandb:              val_auc 0.23985
wandb:                   lr 6e-05
wandb:          best_val_f1 0.32432
wandb:    best_val_accuracy 0.93766
wandb:   best_val_precision 0.33333
wandb:      best_val_recall 0.31579
wandb:             best_auc 0.25886
wandb:           best_epoch 26
wandb: Run history:
wandb:   train_accuracy ▂▃▅▅▆▆▇▇▇█████████████▁▆▇███████████████
wandb:     val_accuracy █▄▂▁▃▇▇██▇█▇███████████▇▇▆█▇██▇▇█▇▇▇▇▇██
wandb:         _runtime ▁▁▁▂▂▂▂▂▃▃▃▄▄▄▄▅▅▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇██████
wandb:       _timestamp ▁▁▁▂▂▂▂▂▃▃▃▄▄▄▄▅▅▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇██████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▆▆█▆▂▂▁▁▂▁▂▁▁▁▁▁▁▁▁▁▁▃▂▂▂▁▁▁▁▂▁▁▂▂▁▂▁▁▁
wandb:       val_recall ▁▃▇█▇▄▄▂▂▃▁▄▂▂▂▃▂▂▂▂▂▃▁▃▄▆▂▄▄▄▆▄▄▄▄▄▄▄▃▃
wandb:    val_precision ▁▁▂▂▂▃▃▃▃▃▃▃▅▆▇▆█▇█▅▆▆▁▂▃▃▆▄▅▅▄▄▅▄▄▄▄▄▅▅
wandb:           val_f1 ▁▂▄▄▄▅▅▄▄▄▂▆▄▅▇▇▆▆▆▅▆▇▁▄▅▆▆▇███▇▇▇▇▇▆▇▇▇
wandb:          val_auc ▄▁▃▂▃▃▄▄▂▂▄▅▄▄▆▆▆▆▆▆▆▆▁▂▄▆██▇▇▇██▇██▇███
wandb:               lr ███████████▄▄▃▃▃▃▂▂▁▁▁█████████▄▄▄▃▃▃▂▂▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210622_015611-1algnosv


 See logs at ../../new_cache/conv__2234__06_0139__v39__newdata/logs/