Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2305
Description:  augmix
2021-07-12 12:21:09.327333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-12 12:21:11.633375: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-12 12:21:11.634414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-12 12:21:11.647111: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:21:11.647940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-12 12:21:11.647976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-12 12:21:11.652331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-12 12:21:11.652408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-12 12:21:11.654383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-12 12:21:11.654667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-12 12:21:11.655941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-12 12:21:11.657226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-12 12:21:11.657406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-12 12:21:11.657527: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:21:11.658334: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:21:11.658958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2305.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2305__07_1219__v39__augmix
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-12 12:31:24.273616: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-12 12:31:24.274039: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:31:24.274778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-12 12:31:24.274830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-12 12:31:24.274906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-12 12:31:24.274931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-12 12:31:24.274953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-12 12:31:24.274980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-12 12:31:24.275001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-12 12:31:24.275022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-12 12:31:24.275042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-12 12:31:24.275149: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:31:24.275862: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:31:24.276512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-12 12:31:24.276595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-12 12:31:24.962505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-12 12:31:24.962556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-12 12:31:24.962566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-12 12:31:24.962841: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:31:24.963612: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:31:24.964282: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 12:31:24.964917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-07-12 12:31:26.041599: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-12 12:31:26.043089: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-12 12:31:27.626308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-12 12:31:28.382104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-12 12:31:28.389507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_12
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_13
Length of training samples after augmix augmentation: 3016
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
189/189 - 113s - loss: 0.4981 - accuracy: 0.7039 - val_loss: 0.4883 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.11357620897175483
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
189/189 - 105s - loss: 0.3125 - accuracy: 0.8412 - val_loss: 0.3128 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16463836803346907
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
189/189 - 106s - loss: 0.2205 - accuracy: 0.8995 - val_loss: 0.2211 - val_accuracy: 0.9544
Confusion matrix: 
 [[571   2]
 [ 26  15]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.634 0.366]]
Validation f1: 51.72
Validation accuracy: 95.44
Validation recall: 36.59
Validation precision: 88.24
Validation AUC: 0.6603803182598007
Validation class accuracies: [0.9965095986038395, 0.36585365853658536]
Saving model...
Epoch 4/65
189/189 - 103s - loss: 0.1606 - accuracy: 0.9257 - val_loss: 0.4198 - val_accuracy: 0.8713
Confusion matrix: 
 [[500  73]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.146 0.854]]
Validation f1: 46.98
Validation accuracy: 87.13
Validation recall: 85.37
Validation precision: 32.41
Validation AUC: 0.6907846757725735
Validation class accuracies: [0.8726003490401396, 0.8536585365853658]
The validation tracker metric at 0.5172413793103449 hasn't increased by 0 in 1 epochs
Epoch 5/65
189/189 - 106s - loss: 0.1533 - accuracy: 0.9406 - val_loss: 0.1720 - val_accuracy: 0.9560
Confusion matrix: 
 [[563  10]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.415 0.585]]
Validation f1: 64.00
Validation accuracy: 95.60
Validation recall: 58.54
Validation precision: 70.59
Validation AUC: 0.6359571276769587
Validation class accuracies: [0.9825479930191972, 0.5853658536585366]
Saving model...
Epoch 6/65
189/189 - 106s - loss: 0.0966 - accuracy: 0.9615 - val_loss: 1.4687 - val_accuracy: 0.6059
Confusion matrix: 
 [[332 241]
 [  1  40]]
Normalized Confusion matrix: 
 [[0.579 0.421]
 [0.024 0.976]]
Validation f1: 24.84
Validation accuracy: 60.59
Validation recall: 97.56
Validation precision: 14.23
Validation AUC: 0.5271781651955828
Validation class accuracies: [0.5794066317626527, 0.975609756097561]
The validation tracker metric at 0.64 hasn't increased by 0 in 1 epochs
Epoch 7/65
189/189 - 104s - loss: 0.0777 - accuracy: 0.9665 - val_loss: 0.3387 - val_accuracy: 0.8974
Confusion matrix: 
 [[521  52]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.268 0.732]]
Validation f1: 48.78
Validation accuracy: 89.74
Validation recall: 73.17
Validation precision: 36.59
Validation AUC: 0.6525816597570346
Validation class accuracies: [0.9092495636998255, 0.7317073170731707]
The validation tracker metric at 0.64 hasn't increased by 0 in 2 epochs
Epoch 8/65
189/189 - 106s - loss: 0.0673 - accuracy: 0.9705 - val_loss: 0.3070 - val_accuracy: 0.9218
Confusion matrix: 
 [[536  37]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.268 0.732]]
Validation f1: 55.56
Validation accuracy: 92.18
Validation recall: 73.17
Validation precision: 44.78
Validation AUC: 0.6918834909761624
Validation class accuracies: [0.9354275741710296, 0.7317073170731707]
The validation tracker metric at 0.64 hasn't increased by 0 in 3 epochs
Epoch 9/65
189/189 - 106s - loss: 0.0566 - accuracy: 0.9781 - val_loss: 0.4684 - val_accuracy: 0.8599
Confusion matrix: 
 [[495  78]
 [  8  33]]
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.195 0.805]]
Validation f1: 43.42
Validation accuracy: 85.99
Validation recall: 80.49
Validation precision: 29.73
Validation AUC: 0.6952917226385217
Validation class accuracies: [0.8638743455497382, 0.8048780487804879]
The validation tracker metric at 0.64 hasn't increased by 0 in 4 epochs
Epoch 10/65
189/189 - 103s - loss: 0.0346 - accuracy: 0.9877 - val_loss: 0.3145 - val_accuracy: 0.9186
Confusion matrix: 
 [[535  38]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.293 0.707]]
Validation f1: 53.70
Validation accuracy: 91.86
Validation recall: 70.73
Validation precision: 43.28
Validation AUC: 0.6962224256743808
Validation class accuracies: [0.9336823734729494, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 11/65
189/189 - 106s - loss: 0.0245 - accuracy: 0.9920 - val_loss: 0.2724 - val_accuracy: 0.9300
Confusion matrix: 
 [[542  31]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.293 0.707]]
Validation f1: 57.43
Validation accuracy: 93.00
Validation recall: 70.73
Validation precision: 48.33
Validation AUC: 0.7157493440578034
Validation class accuracies: [0.9458987783595113, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 6 epochs
Epoch 12/65
189/189 - 106s - loss: 0.0197 - accuracy: 0.9944 - val_loss: 0.2719 - val_accuracy: 0.9300
Confusion matrix: 
 [[542  31]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.293 0.707]]
Validation f1: 57.43
Validation accuracy: 93.00
Validation recall: 70.73
Validation precision: 48.33
Validation AUC: 0.7157597136823611
Validation class accuracies: [0.9458987783595113, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 7 epochs
Epoch 13/65
189/189 - 103s - loss: 0.0183 - accuracy: 0.9950 - val_loss: 0.2895 - val_accuracy: 0.9316
Confusion matrix: 
 [[543  30]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.293 0.707]]
Validation f1: 58.00
Validation accuracy: 93.16
Validation recall: 70.73
Validation precision: 49.15
Validation AUC: 0.7123653563520846
Validation class accuracies: [0.9476439790575916, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 8 epochs
Epoch 14/65
189/189 - 106s - loss: 0.0236 - accuracy: 0.9947 - val_loss: 0.4219 - val_accuracy: 0.9055
Confusion matrix: 
 [[525  48]
 [ 10  31]]
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.244 0.756]]
Validation f1: 51.67
Validation accuracy: 90.55
Validation recall: 75.61
Validation precision: 39.24
Validation AUC: 0.7180041464014689
Validation class accuracies: [0.9162303664921466, 0.7560975609756098]
The validation tracker metric at 0.64 hasn't increased by 0 in 9 epochs
Epoch 15/65
189/189 - 106s - loss: 0.0163 - accuracy: 0.9947 - val_loss: 0.3203 - val_accuracy: 0.9169
Confusion matrix: 
 [[534  39]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.293 0.707]]
Validation f1: 53.21
Validation accuracy: 91.69
Validation recall: 70.73
Validation precision: 42.65
Validation AUC: 0.7082691489444135
Validation class accuracies: [0.9319371727748691, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 16/65
189/189 - 106s - loss: 0.0150 - accuracy: 0.9990 - val_loss: 0.3190 - val_accuracy: 0.9186
Confusion matrix: 
 [[535  38]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.293 0.707]]
Validation f1: 53.70
Validation accuracy: 91.86
Validation recall: 70.73
Validation precision: 43.28
Validation AUC: 0.709476892980871
Validation class accuracies: [0.9336823734729494, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 11 epochs
Epoch 17/65
189/189 - 105s - loss: 0.0158 - accuracy: 0.9977 - val_loss: 0.3290 - val_accuracy: 0.9186
Confusion matrix: 
 [[534  39]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.268 0.732]]
Validation f1: 54.55
Validation accuracy: 91.86
Validation recall: 73.17
Validation precision: 43.48
Validation AUC: 0.7106676172200945
Validation class accuracies: [0.9319371727748691, 0.7317073170731707]
The validation tracker metric at 0.64 hasn't increased by 0 in 12 epochs
Epoch 18/65
189/189 - 106s - loss: 0.0160 - accuracy: 0.9964 - val_loss: 0.3262 - val_accuracy: 0.9218
Confusion matrix: 
 [[537  36]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.293 0.707]]
Validation f1: 54.72
Validation accuracy: 92.18
Validation recall: 70.73
Validation precision: 44.62
Validation AUC: 0.7060729197569743
Validation class accuracies: [0.93717277486911, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 13 epochs
Epoch 19/65
189/189 - 106s - loss: 0.0149 - accuracy: 0.9973 - val_loss: 0.3156 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.7115420862727387
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 14 epochs
Epoch 20/65
189/189 - 103s - loss: 0.0125 - accuracy: 0.9980 - val_loss: 0.3221 - val_accuracy: 0.9202
Confusion matrix: 
 [[536  37]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.293 0.707]]
Validation f1: 54.21
Validation accuracy: 92.02
Validation recall: 70.73
Validation precision: 43.94
Validation AUC: 0.7070845491651933
Validation class accuracies: [0.9354275741710296, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 21/65
189/189 - 106s - loss: 0.0158 - accuracy: 0.9987 - val_loss: 0.3234 - val_accuracy: 0.9218
Confusion matrix: 
 [[537  36]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.293 0.707]]
Validation f1: 54.72
Validation accuracy: 92.18
Validation recall: 70.73
Validation precision: 44.62
Validation AUC: 0.7080954528062073
Validation class accuracies: [0.93717277486911, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 16 epochs
Epoch 22/65
189/189 - 106s - loss: 0.0162 - accuracy: 0.9977 - val_loss: 0.3181 - val_accuracy: 0.9218
Confusion matrix: 
 [[537  36]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.293 0.707]]
Validation f1: 54.72
Validation accuracy: 92.18
Validation recall: 70.73
Validation precision: 44.62
Validation AUC: 0.7087789977779845
Validation class accuracies: [0.93717277486911, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 17 epochs
Epoch 23/65
189/189 - 104s - loss: 0.0139 - accuracy: 0.9964 - val_loss: 0.3220 - val_accuracy: 0.9218
Confusion matrix: 
 [[537  36]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.293 0.707]]
Validation f1: 54.72
Validation accuracy: 92.18
Validation recall: 70.73
Validation precision: 44.62
Validation AUC: 0.7078855927470749
Validation class accuracies: [0.93717277486911, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 18 epochs
Epoch 24/65
189/189 - 106s - loss: 0.0141 - accuracy: 0.9970 - val_loss: 0.3253 - val_accuracy: 0.9186
Confusion matrix: 
 [[535  38]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.293 0.707]]
Validation f1: 53.70
Validation accuracy: 91.86
Validation recall: 70.73
Validation precision: 43.28
Validation AUC: 0.7084485428042698
Validation class accuracies: [0.9336823734729494, 0.7073170731707317]
The validation tracker metric at 0.64 hasn't increased by 0 in 19 epochs
Epoch 25/65
189/189 - 106s - loss: 0.0125 - accuracy: 0.9970 - val_loss: 0.3246 - val_accuracy: 0.9186
Confusion matrix: 
 [[535  38]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.293 0.707]]
Validation f1: 53.70
Validation accuracy: 91.86
Validation recall: 70.73
Validation precision: 43.28
Validation AUC: 0.7082205409531239
Validation class accuracies: [0.9336823734729494, 0.7073170731707317]

The metrics for job 0 with the best target metric are: 
Best cm: [[563  10]
 [ 17  24]]
Best normalized cm: [[0.983 0.017]
 [0.415 0.585]]
Best f1: 0.64
Best accuracy: 0.96
Best recall: 0.59
Best precision: 0.71
Best AUC: 0.64
Best class accuracies: [0.9825479930191972, 0.5853658536585366]
Best epoch: 5
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.286]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.395]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.019]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.1]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.183]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[5.461e-05]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.028]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.023]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.448]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[1.576e-05]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[8.82e-05]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.008]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_1.png, [[0.643]]
../../new_cache/conv__2305__07_1219__v39__augmix/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.713]]
wandb: Waiting for W&B process to finish, PID 15527
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210712_122111-347ad9iw/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210712_122111-347ad9iw/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99702
wandb:         val_accuracy 0.91857
wandb:             _runtime 3570
wandb:           _timestamp 1626096042
wandb:                _step 180
wandb:           train_loss 0.01254
wandb:             val_loss 0.3246
wandb:           val_recall 0.70732
wandb:        val_precision 0.43284
wandb:               val_f1 0.53704
wandb:              val_auc 0.70822
wandb:                   lr 2e-05
wandb:          best_val_f1 0.64
wandb:    best_val_accuracy 0.95603
wandb:   best_val_precision 0.70588
wandb:      best_val_recall 0.58537
wandb:             best_auc 0.63596
wandb:           best_epoch 5
wandb: Run history:
wandb:   train_accuracy ▁▄▆▆▇▇▇▇█████████████████
wandb:     val_accuracy ███▆█▁▇▇▆▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▂▁▂▁█▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ▁▁▄▇▅█▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▁█▄▇▂▄▅▃▄▅▅▅▄▄▄▄▅▅▄▅▅▅▄▄
wandb:           val_f1 ▁▁▇▆█▄▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▂▇█▇▆▇██████████████████
wandb:               lr ██████████▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210712_122111-347ad9iw


 See logs at ../../new_cache/conv__2305__07_1219__v39__augmix/logs/