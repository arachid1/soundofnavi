Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2116
Description:  mixednet_concat
2021-05-09 20:14:08.777268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 20:14:11.378411: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 20:14:11.379858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-09 20:14:11.442668: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:11.443407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 20:14:11.443437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 20:14:11.447183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 20:14:11.447297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 20:14:11.448716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 20:14:11.449337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 20:14:11.451220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 20:14:11.452414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 20:14:11.452610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 20:14:11.452786: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:11.453888: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:11.454906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-09 20:14:11.694166: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 20:14:11.694418: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:11.695212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 20:14:11.695250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 20:14:11.695298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 20:14:11.695316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 20:14:11.695334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 20:14:11.695351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 20:14:11.695377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 20:14:11.695395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 20:14:11.695423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 20:14:11.695512: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:11.696210: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:11.696831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-09 20:14:11.696868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 20:14:12.481700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-09 20:14:12.481753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-09 20:14:12.481764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-09 20:14:12.482066: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:12.483190: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:12.484148: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:14:12.485120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-09 20:14:56.447567: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-09 20:14:56.448387: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-09 20:14:58.411709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 20:14:59.724863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 20:14:59.861523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2116.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2116__05_2014__v29__mixednet_concat/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 4, 'LR': 0.0001, 'SHAPE': (6, 128, 1250), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 3, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: True and Concat: True
-----------------------
Original number of folders: 453
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 6, 128, 1250)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 8, 128, 1250)      440       
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 128, 1250)      1080      
_________________________________________________________________
average_pooling2d (AveragePo (None, 8, 64, 625)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 8, 64, 625)        2500      
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 16, 64, 625)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 64, 625)       2160      
_________________________________________________________________
average_pooling2d_1 (Average (None, 16, 32, 313)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 16, 32, 313)       1252      
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 32, 313)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 32, 313)       4320      
_________________________________________________________________
average_pooling2d_2 (Average (None, 32, 16, 157)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 32, 16, 157)       628       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 16, 157)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 16, 157)       8640      
_________________________________________________________________
average_pooling2d_3 (Average (None, 64, 8, 79)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 64, 8, 79)         316       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 128, 8, 79)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 8, 79)        17280     
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 4, 40)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 128, 4, 40)        160       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 137,065
Trainable params: 134,637
Non-trainable params: 2,428
_________________________________________________________________
Epoch 1/40
76/76 - 39s - loss: 0.7392 - accuracy: 0.4836 - val_loss: 0.6838 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23931068165296135
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
76/76 - 33s - loss: 0.7055 - accuracy: 0.5099 - val_loss: 0.6725 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23324183971575035
Validation class accuracies: [1.0, 0.0]
Epoch 3/40
76/76 - 33s - loss: 0.7008 - accuracy: 0.5329 - val_loss: 0.6594 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22703879457447745
Validation class accuracies: [1.0, 0.0]
Epoch 4/40
76/76 - 33s - loss: 0.7010 - accuracy: 0.5329 - val_loss: 0.6474 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.227048805676822
Validation class accuracies: [1.0, 0.0]
Epoch 5/40
76/76 - 33s - loss: 0.6902 - accuracy: 0.6086 - val_loss: 0.6334 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17079584935892222
Validation class accuracies: [1.0, 0.0]
Epoch 6/40
76/76 - 32s - loss: 0.7005 - accuracy: 0.5296 - val_loss: 0.6245 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16105142689844973
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0.01 in 1 epochs
Epoch 7/40
76/76 - 33s - loss: 0.6831 - accuracy: 0.5724 - val_loss: 0.6085 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16590534573386748
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0.01 in 2 epochs
Epoch 8/40
76/76 - 33s - loss: 0.6858 - accuracy: 0.6184 - val_loss: 0.6439 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.17627806967884224
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
Saving model...
Epoch 9/40
76/76 - 33s - loss: 0.6720 - accuracy: 0.5855 - val_loss: 0.7292 - val_accuracy: 0.4000
Confusion matrix: 
 [[23 37]
 [ 8  7]]
Validation f1: 23.73
Validation accuracy: 40.00
Validation recall: 46.67
Validation precision: 15.91
Validation AUC: 0.18282064269675002
Validation class accuracies: [0.38333333333333336, 0.4666666666666667]
Saving model...
Epoch 10/40
76/76 - 33s - loss: 0.6773 - accuracy: 0.5789 - val_loss: 0.7546 - val_accuracy: 0.4533
Confusion matrix: 
 [[25 35]
 [ 6  9]]
Validation f1: 30.51
Validation accuracy: 45.33
Validation recall: 60.00
Validation precision: 20.45
Validation AUC: 0.20372046628458762
Validation class accuracies: [0.4166666666666667, 0.6]
Saving model...
Epoch 11/40
76/76 - 33s - loss: 0.6758 - accuracy: 0.5921 - val_loss: 0.7614 - val_accuracy: 0.4667
Confusion matrix: 
 [[27 33]
 [ 7  8]]
Validation f1: 28.57
Validation accuracy: 46.67
Validation recall: 53.33
Validation precision: 19.51
Validation AUC: 0.25840585193423843
Validation class accuracies: [0.45, 0.5333333333333333]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 1 epochs
Epoch 12/40
76/76 - 33s - loss: 0.6790 - accuracy: 0.5395 - val_loss: 0.7246 - val_accuracy: 0.5467
Confusion matrix: 
 [[35 25]
 [ 9  6]]
Validation f1: 26.09
Validation accuracy: 54.67
Validation recall: 40.00
Validation precision: 19.35
Validation AUC: 0.24319544446937696
Validation class accuracies: [0.5833333333333334, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 2 epochs
Epoch 13/40
76/76 - 33s - loss: 0.6675 - accuracy: 0.5954 - val_loss: 0.7556 - val_accuracy: 0.4800
Confusion matrix: 
 [[30 30]
 [ 9  6]]
Validation f1: 23.53
Validation accuracy: 48.00
Validation recall: 40.00
Validation precision: 16.67
Validation AUC: 0.2551368662353654
Validation class accuracies: [0.5, 0.4]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 3 epochs
Epoch 14/40
76/76 - 33s - loss: 0.6628 - accuracy: 0.6184 - val_loss: 0.7190 - val_accuracy: 0.5467
Confusion matrix: 
 [[35 25]
 [ 9  6]]
Validation f1: 26.09
Validation accuracy: 54.67
Validation recall: 40.00
Validation precision: 19.35
Validation AUC: 0.24562364398932102
Validation class accuracies: [0.5833333333333334, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 4 epochs
Epoch 15/40
76/76 - 33s - loss: 0.6604 - accuracy: 0.5987 - val_loss: 0.7465 - val_accuracy: 0.5200
Confusion matrix: 
 [[33 27]
 [ 9  6]]
Validation f1: 25.00
Validation accuracy: 52.00
Validation recall: 40.00
Validation precision: 18.18
Validation AUC: 0.2481510356564896
Validation class accuracies: [0.55, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 5 epochs
Epoch 16/40
76/76 - 33s - loss: 0.6454 - accuracy: 0.6743 - val_loss: 0.7518 - val_accuracy: 0.4667
Confusion matrix: 
 [[29 31]
 [ 9  6]]
Validation f1: 23.08
Validation accuracy: 46.67
Validation recall: 40.00
Validation precision: 16.22
Validation AUC: 0.2637963544013165
Validation class accuracies: [0.48333333333333334, 0.4]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 6 epochs
Epoch 17/40
76/76 - 33s - loss: 0.6559 - accuracy: 0.6349 - val_loss: 0.7642 - val_accuracy: 0.4400
Confusion matrix: 
 [[27 33]
 [ 9  6]]
Validation f1: 22.22
Validation accuracy: 44.00
Validation recall: 40.00
Validation precision: 15.38
Validation AUC: 0.25301982792517297
Validation class accuracies: [0.45, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 7 epochs
Epoch 18/40
76/76 - 33s - loss: 0.6488 - accuracy: 0.6151 - val_loss: 0.7658 - val_accuracy: 0.4400
Confusion matrix: 
 [[27 33]
 [ 9  6]]
Validation f1: 22.22
Validation accuracy: 44.00
Validation recall: 40.00
Validation precision: 15.38
Validation AUC: 0.253153483405343
Validation class accuracies: [0.45, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 8 epochs
Epoch 19/40
76/76 - 32s - loss: 0.6466 - accuracy: 0.5987 - val_loss: 0.7513 - val_accuracy: 0.4667
Confusion matrix: 
 [[29 31]
 [ 9  6]]
Validation f1: 23.08
Validation accuracy: 46.67
Validation recall: 40.00
Validation precision: 16.22
Validation AUC: 0.2529698696454892
Validation class accuracies: [0.48333333333333334, 0.4]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 9 epochs
Epoch 20/40
76/76 - 33s - loss: 0.6433 - accuracy: 0.6283 - val_loss: 0.7580 - val_accuracy: 0.4667
Confusion matrix: 
 [[29 31]
 [ 9  6]]
Validation f1: 23.08
Validation accuracy: 46.67
Validation recall: 40.00
Validation precision: 16.22
Validation AUC: 0.2535013491388246
Validation class accuracies: [0.48333333333333334, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 10 epochs
Epoch 21/40
76/76 - 33s - loss: 0.6418 - accuracy: 0.6217 - val_loss: 0.7557 - val_accuracy: 0.4667
Confusion matrix: 
 [[29 31]
 [ 9  6]]
Validation f1: 23.08
Validation accuracy: 46.67
Validation recall: 40.00
Validation precision: 16.22
Validation AUC: 0.2527266957868753
Validation class accuracies: [0.48333333333333334, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 11 epochs
Epoch 22/40
76/76 - 33s - loss: 0.6445 - accuracy: 0.6414 - val_loss: 0.7499 - val_accuracy: 0.4800
Confusion matrix: 
 [[30 30]
 [ 9  6]]
Validation f1: 23.53
Validation accuracy: 48.00
Validation recall: 40.00
Validation precision: 16.67
Validation AUC: 0.2539714370825404
Validation class accuracies: [0.5, 0.4]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 12 epochs
Epoch 23/40
76/76 - 33s - loss: 0.6382 - accuracy: 0.6447 - val_loss: 0.7497 - val_accuracy: 0.4667
Confusion matrix: 
 [[29 31]
 [ 9  6]]
Validation f1: 23.08
Validation accuracy: 46.67
Validation recall: 40.00
Validation precision: 16.22
Validation AUC: 0.2645177624502943
Validation class accuracies: [0.48333333333333334, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 13 epochs
Epoch 24/40
76/76 - 34s - loss: 0.6347 - accuracy: 0.6513 - val_loss: 0.7521 - val_accuracy: 0.4667
Confusion matrix: 
 [[29 31]
 [ 9  6]]
Validation f1: 23.08
Validation accuracy: 46.67
Validation recall: 40.00
Validation precision: 16.22
Validation AUC: 0.2534066513391832
Validation class accuracies: [0.48333333333333334, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 14 epochs
Epoch 25/40
76/76 - 23s - loss: 0.6437 - accuracy: 0.6217 - val_loss: 0.7531 - val_accuracy: 0.4800
Confusion matrix: 
 [[30 30]
 [ 9  6]]
Validation f1: 23.53
Validation accuracy: 48.00
Validation recall: 40.00
Validation precision: 16.67
Validation AUC: 0.254599585575139
Validation class accuracies: [0.5, 0.4]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 15 epochs
Epoch 26/40
76/76 - 23s - loss: 0.6412 - accuracy: 0.6217 - val_loss: 0.7525 - val_accuracy: 0.4800
Confusion matrix: 
 [[30 30]
 [ 9  6]]
Validation f1: 23.53
Validation accuracy: 48.00
Validation recall: 40.00
Validation precision: 16.67
Validation AUC: 0.2541773833778574
Validation class accuracies: [0.5, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 16 epochs
Epoch 27/40
76/76 - 23s - loss: 0.6469 - accuracy: 0.6086 - val_loss: 0.7516 - val_accuracy: 0.4933
Confusion matrix: 
 [[31 29]
 [ 9  6]]
Validation f1: 24.00
Validation accuracy: 49.33
Validation recall: 40.00
Validation precision: 17.14
Validation AUC: 0.25378782332268657
Validation class accuracies: [0.5166666666666667, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 17 epochs
Epoch 28/40
76/76 - 23s - loss: 0.6492 - accuracy: 0.6316 - val_loss: 0.7513 - val_accuracy: 0.4933
Confusion matrix: 
 [[31 29]
 [ 9  6]]
Validation f1: 24.00
Validation accuracy: 49.33
Validation recall: 40.00
Validation precision: 17.14
Validation AUC: 0.2541773833778574
Validation class accuracies: [0.5166666666666667, 0.4]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 18 epochs
Epoch 29/40
76/76 - 23s - loss: 0.6453 - accuracy: 0.6414 - val_loss: 0.7504 - val_accuracy: 0.4933
Confusion matrix: 
 [[31 29]
 [ 9  6]]
Validation f1: 24.00
Validation accuracy: 49.33
Validation recall: 40.00
Validation precision: 17.14
Validation AUC: 0.25378782332268657
Validation class accuracies: [0.5166666666666667, 0.4]
The validation tracker metric at 0.30508474576271183 hasn't increased by 0.01 in 19 epochs
Epoch 30/40
76/76 - 25s - loss: 0.6444 - accuracy: 0.6645 - val_loss: 0.7514 - val_accuracy: 0.4933
Confusion matrix: 
 [[31 29]
 [ 9  6]]
Validation f1: 24.00
Validation accuracy: 49.33
Validation recall: 40.00
Validation precision: 17.14
Validation AUC: 0.25378782332268657
Validation class accuracies: [0.5166666666666667, 0.4]

The metrics for the epoch with the best target metric are: 
Best cm: [[25 35]
 [ 6  9]]
Best f1: 0.30508474576271183
Best accuracy: 0.4533333333333333
Best recall: 0.6
Best precision: 0.20454545454545456
Best AUC: 0.20372046628458762
Best epoch: 10
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2116.py", line 360, in <module>
    train_model(**arguments)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2116.py", line 315, in train_model
    bd_f1, bd_accuracy, bd_precision, bd_recall = generate_bangladesh_sheet(model, grouped_val_samples, excel_dest, six, initial_channels)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/pneumonia.py", line 182, in generate_bangladesh_sheet
    output = model.predict(np.array([arr]))
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1629, in predict
    tmp_batch_outputs = self.predict_function(iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 871, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 726, in _initialize
    *args, **kwds))
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2969, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 3206, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 634, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 977, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1478 predict_function  *
        return step_function(self, iterator)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1468 step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:1259 run
        return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:2730 call_for_each_replica
        return self._call_for_each_replica(fn, args, kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:3417 _call_for_each_replica
        return fn(*args, **kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1461 run_step  **
        outputs = model.predict_step(data)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1434 predict_step
        return self(x, training=False)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py:998 __call__
        input_spec.assert_input_compatibility(self.input_spec, inputs, self.name)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py:274 assert_input_compatibility
        ', found shape=' + display_shape(x.shape))

    ValueError: Input 0 is incompatible with layer conv2d: expected shape=(None, 6, 128, 1250), found shape=(None, 128, 1250, 6)

The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 10
Starting...

 See logs at ../../new_cache/conv__2116__05_2014__v29__mixednet_concat/logs/