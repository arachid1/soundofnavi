Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2138
Description:  mod9
2021-05-14 14:44:56.393212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-14 14:44:58.939807: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-14 14:44:58.940945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-14 14:44:58.994318: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:44:58.995186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-14 14:44:58.995221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-14 14:44:58.999191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-14 14:44:58.999299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-14 14:44:59.000571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-14 14:44:59.000931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-14 14:44:59.002036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-14 14:44:59.002987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-14 14:44:59.003154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-14 14:44:59.003302: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:44:59.004185: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:44:59.004973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2138.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2138__05_1444__v29__mod9/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2138
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2wbwfqos
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210514_144459-2wbwfqos
wandb: Run `wandb offline` to turn off syncing.
2021-05-14 14:45:04.843826: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-14 14:45:04.844070: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:45:04.844925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-14 14:45:04.844976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-14 14:45:04.845028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-14 14:45:04.845050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-14 14:45:04.845070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-14 14:45:04.845092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-14 14:45:04.845113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-14 14:45:04.845134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-14 14:45:04.845155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-14 14:45:04.845245: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:45:04.846078: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:45:04.846804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-14 14:45:04.846856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-14 14:45:05.621477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-14 14:45:05.621523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-14 14:45:05.621536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-14 14:45:05.621852: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:45:05.622750: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:45:05.623599: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-14 14:45:05.624384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-14 14:45:45.420126: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-14 14:45:45.421955: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-14 14:45:48.745846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-14 14:45:49.520212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-14 14:45:49.529481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
binary
Epoch 1/80
263/263 - 507s - loss: 0.7372 - accuracy: 0.5643 - val_loss: 0.5723 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2683718592420586
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
263/263 - 495s - loss: 0.6871 - accuracy: 0.5772 - val_loss: 0.6111 - val_accuracy: 0.7675
Confusion matrix: 
 [[818  52]
 [201  17]]
Validation f1: 11.85
Validation accuracy: 76.75
Validation recall: 7.80
Validation precision: 24.64
Validation AUC: 0.21731057040357182
Validation class accuracies: [0.9402298850574713, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.11846689895470384
column_sums: [1019   69]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
263/263 - 494s - loss: 0.6822 - accuracy: 0.6006 - val_loss: 0.6925 - val_accuracy: 0.6002
Confusion matrix: 
 [[557 313]
 [122  96]]
Validation f1: 30.62
Validation accuracy: 60.02
Validation recall: 44.04
Validation precision: 23.47
Validation AUC: 0.21982129702029152
Validation class accuracies: [0.6402298850574712, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.3062200956937799
column_sums: [679 409]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 4/80
263/263 - 501s - loss: 0.6819 - accuracy: 0.5708 - val_loss: 0.8191 - val_accuracy: 0.5607
Confusion matrix: 
 [[525 345]
 [133  85]]
Validation f1: 26.23
Validation accuracy: 56.07
Validation recall: 38.99
Validation precision: 19.77
Validation AUC: 0.22146835333189283
Validation class accuracies: [0.603448275862069, 0.38990825688073394]
TARGET: 1
target metric(test f1): 0.2623456790123456
column_sums: [658 430]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 1 epochs
Epoch 5/80
263/263 - 494s - loss: 0.6712 - accuracy: 0.6182 - val_loss: 3.4681 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.1984889574213697
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.333843797856049
column_sums: [   0 1088]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
263/263 - 494s - loss: 0.6764 - accuracy: 0.5815 - val_loss: 0.6151 - val_accuracy: 0.7408
Confusion matrix: 
 [[788  82]
 [200  18]]
Validation f1: 11.32
Validation accuracy: 74.08
Validation recall: 8.26
Validation precision: 18.00
Validation AUC: 0.2028793873789933
Validation class accuracies: [0.9057471264367816, 0.08256880733944955]
TARGET: 1
target metric(test f1): 0.11320754716981132
column_sums: [988 100]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
263/263 - 494s - loss: 0.6693 - accuracy: 0.6156 - val_loss: 0.5859 - val_accuracy: 0.7592
Confusion matrix: 
 [[812  58]
 [204  14]]
Validation f1: 9.66
Validation accuracy: 75.92
Validation recall: 6.42
Validation precision: 19.44
Validation AUC: 0.20421748410561588
Validation class accuracies: [0.9333333333333333, 0.06422018348623854]
TARGET: 1
target metric(test f1): 0.09655172413793102
column_sums: [1016   72]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
263/263 - 493s - loss: 0.6684 - accuracy: 0.6130 - val_loss: 0.5980 - val_accuracy: 0.7831
Confusion matrix: 
 [[843  27]
 [209   9]]
Validation f1: 7.09
Validation accuracy: 78.31
Validation recall: 4.13
Validation precision: 25.00
Validation AUC: 0.18844676604830488
Validation class accuracies: [0.9689655172413794, 0.04128440366972477]
TARGET: 1
target metric(test f1): 0.07086614173228348
column_sums: [1052   36]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
263/263 - 492s - loss: 0.6589 - accuracy: 0.6180 - val_loss: 0.6294 - val_accuracy: 0.6801
Confusion matrix: 
 [[687 183]
 [165  53]]
Validation f1: 23.35
Validation accuracy: 68.01
Validation recall: 24.31
Validation precision: 22.46
Validation AUC: 0.22891325578282495
Validation class accuracies: [0.7896551724137931, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.23348017621145373
column_sums: [852 236]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 2 epochs
Epoch 10/80
263/263 - 492s - loss: 0.6589 - accuracy: 0.6077 - val_loss: 0.6295 - val_accuracy: 0.7243
Confusion matrix: 
 [[754 116]
 [184  34]]
Validation f1: 18.48
Validation accuracy: 72.43
Validation recall: 15.60
Validation precision: 22.67
Validation AUC: 0.2305155649104365
Validation class accuracies: [0.8666666666666667, 0.1559633027522936]
TARGET: 1
target metric(test f1): 0.18478260869565216
column_sums: [938 150]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 3 epochs
Epoch 11/80
263/263 - 492s - loss: 0.6551 - accuracy: 0.6332 - val_loss: 0.8781 - val_accuracy: 0.5138
Confusion matrix: 
 [[455 415]
 [114 104]]
Validation f1: 28.22
Validation accuracy: 51.38
Validation recall: 47.71
Validation precision: 20.04
Validation AUC: 0.21871262925249318
Validation class accuracies: [0.5229885057471264, 0.47706422018348627]
TARGET: 1
target metric(test f1): 0.28222523744911804
column_sums: [569 519]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 4 epochs
Epoch 12/80
263/263 - 494s - loss: 0.6402 - accuracy: 0.6461 - val_loss: 0.6397 - val_accuracy: 0.6333
Confusion matrix: 
 [[620 250]
 [149  69]]
Validation f1: 25.70
Validation accuracy: 63.33
Validation recall: 31.65
Validation precision: 21.63
Validation AUC: 0.20919807318152278
Validation class accuracies: [0.7126436781609196, 0.3165137614678899]
TARGET: 1
target metric(test f1): 0.2569832402234637
column_sums: [769 319]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 5 epochs
Epoch 13/80
263/263 - 493s - loss: 0.6323 - accuracy: 0.6447 - val_loss: 0.5952 - val_accuracy: 0.6884
Confusion matrix: 
 [[705 165]
 [174  44]]
Validation f1: 20.61
Validation accuracy: 68.84
Validation recall: 20.18
Validation precision: 21.05
Validation AUC: 0.2136765941685682
Validation class accuracies: [0.8103448275862069, 0.2018348623853211]
TARGET: 1
target metric(test f1): 0.20608899297423885
column_sums: [879 209]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 6 epochs
Epoch 14/80
263/263 - 499s - loss: 0.6268 - accuracy: 0.6463 - val_loss: 0.7235 - val_accuracy: 0.5551
Confusion matrix: 
 [[512 358]
 [126  92]]
Validation f1: 27.54
Validation accuracy: 55.51
Validation recall: 42.20
Validation precision: 20.44
Validation AUC: 0.20613794911621186
Validation class accuracies: [0.5885057471264368, 0.42201834862385323]
TARGET: 1
target metric(test f1): 0.27544910179640725
column_sums: [638 450]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 7 epochs
Epoch 15/80
263/263 - 495s - loss: 0.6213 - accuracy: 0.6628 - val_loss: 0.6481 - val_accuracy: 0.6461
Confusion matrix: 
 [[640 230]
 [155  63]]
Validation f1: 24.66
Validation accuracy: 64.61
Validation recall: 28.90
Validation precision: 21.50
Validation AUC: 0.218797094902699
Validation class accuracies: [0.735632183908046, 0.2889908256880734]
TARGET: 1
target metric(test f1): 0.2465753424657534
column_sums: [795 293]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 8 epochs
Epoch 16/80
263/263 - 495s - loss: 0.6148 - accuracy: 0.6649 - val_loss: 0.7817 - val_accuracy: 0.5119
Confusion matrix: 
 [[444 426]
 [105 113]]
Validation f1: 29.85
Validation accuracy: 51.19
Validation recall: 51.83
Validation precision: 20.96
Validation AUC: 0.20974201516843746
Validation class accuracies: [0.5103448275862069, 0.518348623853211]
TARGET: 1
target metric(test f1): 0.2985468956406869
column_sums: [549 539]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 9 epochs
Epoch 17/80
263/263 - 498s - loss: 0.6012 - accuracy: 0.6780 - val_loss: 0.7455 - val_accuracy: 0.5570
Confusion matrix: 
 [[507 363]
 [119  99]]
Validation f1: 29.12
Validation accuracy: 55.70
Validation recall: 45.41
Validation precision: 21.43
Validation AUC: 0.21027578771341826
Validation class accuracies: [0.5827586206896552, 0.4541284403669725]
TARGET: 1
target metric(test f1): 0.2911764705882353
column_sums: [626 462]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 10 epochs
Epoch 18/80
263/263 - 494s - loss: 0.6097 - accuracy: 0.6711 - val_loss: 0.7567 - val_accuracy: 0.5542
Confusion matrix: 
 [[505 365]
 [120  98]]
Validation f1: 28.78
Validation accuracy: 55.42
Validation recall: 44.95
Validation precision: 21.17
Validation AUC: 0.2094580833306055
Validation class accuracies: [0.5804597701149425, 0.44954128440366975]
TARGET: 1
target metric(test f1): 0.2878120411160059
column_sums: [625 463]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3062200956937799 hasn't increased by 0 in 11 epochs
Epoch 19/80
263/263 - 495s - loss: 0.5998 - accuracy: 0.6759 - val_loss: 0.7758 - val_accuracy: 0.5441
Confusion matrix: 
 [[482 388]
 [108 110]]
Validation f1: 30.73
Validation accuracy: 54.41
Validation recall: 50.46
Validation precision: 22.09
Validation AUC: 0.21320001250537
Validation class accuracies: [0.5540229885057472, 0.5045871559633027]
TARGET: 1
target metric(test f1): 0.30726256983240224
column_sums: [590 498]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 20/80
263/263 - 494s - loss: 0.5968 - accuracy: 0.6776 - val_loss: 0.8069 - val_accuracy: 0.5211
Confusion matrix: 
 [[452 418]
 [103 115]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 30.63
Validation accuracy: 52.11
Validation recall: 52.75
Validation precision: 21.58
Validation AUC: 0.21161760654495082
Validation class accuracies: [0.5195402298850574, 0.5275229357798165]
TARGET: 1
target metric(test f1): 0.3062583222370173
column_sums: [555 533]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 1 epochs
Epoch 21/80
263/263 - 493s - loss: 0.5980 - accuracy: 0.6811 - val_loss: 0.7792 - val_accuracy: 0.5450
Confusion matrix: 
 [[492 378]
 [117 101]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.98
Validation accuracy: 54.50
Validation recall: 46.33
Validation precision: 21.09
Validation AUC: 0.21216014328872043
Validation class accuracies: [0.5655172413793104, 0.463302752293578]
TARGET: 1
target metric(test f1): 0.28981348637015786
column_sums: [609 479]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 2 epochs
Epoch 22/80
263/263 - 495s - loss: 0.5979 - accuracy: 0.6725 - val_loss: 0.7160 - val_accuracy: 0.5965
Confusion matrix: 
 [[583 287]
 [152  66]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.12
Validation accuracy: 59.65
Validation recall: 30.28
Validation precision: 18.70
Validation AUC: 0.2077612956991213
Validation class accuracies: [0.6701149425287356, 0.30275229357798167]
TARGET: 1
target metric(test f1): 0.23117338003502624
column_sums: [735 353]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 3 epochs
Epoch 23/80
263/263 - 494s - loss: 0.5910 - accuracy: 0.6878 - val_loss: 0.7696 - val_accuracy: 0.5506
Confusion matrix: 
 [[504 366]
 [123  95]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.98
Validation accuracy: 55.06
Validation recall: 43.58
Validation precision: 20.61
Validation AUC: 0.21029511952083044
Validation class accuracies: [0.5793103448275863, 0.43577981651376146]
TARGET: 1
target metric(test f1): 0.27982326951399117
column_sums: [627 461]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 4 epochs
Epoch 24/80
263/263 - 496s - loss: 0.5863 - accuracy: 0.6852 - val_loss: 0.7756 - val_accuracy: 0.5506
Confusion matrix: 
 [[505 365]
 [124  94]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.77
Validation accuracy: 55.06
Validation recall: 43.12
Validation precision: 20.48
Validation AUC: 0.20936808009075938
Validation class accuracies: [0.5804597701149425, 0.43119266055045874]
TARGET: 1
target metric(test f1): 0.2776957163958641
column_sums: [629 459]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 5 epochs
Epoch 25/80
263/263 - 494s - loss: 0.5917 - accuracy: 0.6833 - val_loss: 0.7916 - val_accuracy: 0.5423
Confusion matrix: 
 [[494 376]
 [122  96]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.83
Validation accuracy: 54.23
Validation recall: 44.04
Validation precision: 20.34
Validation AUC: 0.20857949522250327
Validation class accuracies: [0.5678160919540229, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.2782608695652174
column_sums: [616 472]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 6 epochs
Epoch 26/80
263/263 - 491s - loss: 0.5880 - accuracy: 0.6811 - val_loss: 0.7839 - val_accuracy: 0.5450
Confusion matrix: 
 [[498 372]
 [123  95]]
Validation f1: 27.74
Validation accuracy: 54.50
Validation recall: 43.58
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 20.34
Validation AUC: 0.2106241070538119
Validation class accuracies: [0.5724137931034483, 0.43577981651376146]
TARGET: 1
target metric(test f1): 0.2773722627737226
column_sums: [621 467]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 7 epochs
Epoch 27/80
263/263 - 490s - loss: 0.5874 - accuracy: 0.6859 - val_loss: 0.7815 - val_accuracy: 0.5487
Confusion matrix: 
 [[503 367]
 [124  94]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.69
Validation accuracy: 54.87
Validation recall: 43.12
Validation precision: 20.39
Validation AUC: 0.21118447760211934
Validation class accuracies: [0.5781609195402299, 0.43119266055045874]
TARGET: 1
target metric(test f1): 0.27687776141384385
column_sums: [627 461]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 8 epochs
Epoch 28/80
263/263 - 492s - loss: 0.5841 - accuracy: 0.6802 - val_loss: 0.7994 - val_accuracy: 0.5404
Confusion matrix: 
 [[487 383]
 [117 101]]
Validation f1: 28.77
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 54.04
Validation recall: 46.33
Validation precision: 20.87
Validation AUC: 0.21413376628509892
Validation class accuracies: [0.5597701149425287, 0.463302752293578]
TARGET: 1
target metric(test f1): 0.2877492877492877
column_sums: [604 484]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 9 epochs
Epoch 29/80
263/263 - 491s - loss: 0.5845 - accuracy: 0.6787 - val_loss: 0.7953 - val_accuracy: 0.5432
Confusion matrix: 
 [[491 379]
 [118 100]]
Validation f1: 28.69
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 54.32
Validation recall: 45.87
Validation precision: 20.88
Validation AUC: 0.21118124153005685
Validation class accuracies: [0.5643678160919541, 0.45871559633027525]
TARGET: 1
target metric(test f1): 0.2869440459110474
column_sums: [609 479]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 10 epochs
Epoch 30/80
263/263 - 491s - loss: 0.5840 - accuracy: 0.6873 - val_loss: 0.7893 - val_accuracy: 0.5469
Confusion matrix: 
 [[501 369]
 [124  94]]
Validation f1: 27.61
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 54.69
Validation recall: 43.12
Validation precision: 20.30
Validation AUC: 0.21028842261965563
Validation class accuracies: [0.5758620689655173, 0.43119266055045874]
TARGET: 1
target metric(test f1): 0.27606461086637296
column_sums: [625 463]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 11 epochs
Epoch 31/80
263/263 - 491s - loss: 0.5823 - accuracy: 0.6918 - val_loss: 0.7891 - val_accuracy: 0.5460
Confusion matrix: 
 [[499 371]
 [123  95]]
Validation f1: 27.78
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 54.60
Validation recall: 43.58
Validation precision: 20.39
Validation AUC: 0.20971129671864364
Validation class accuracies: [0.5735632183908046, 0.43577981651376146]
TARGET: 1
target metric(test f1): 0.27777777777777785
column_sums: [622 466]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 12 epochs
Epoch 32/80
263/263 - 491s - loss: 0.5859 - accuracy: 0.6873 - val_loss: 0.7841 - val_accuracy: 0.5450
Confusion matrix: 
 [[501 369]
 [126  92]]
Validation f1: 27.10
Validation accuracy: 54.50
Validation recall: 42.20
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 19.96
Validation AUC: 0.20888185857718577
Validation class accuracies: [0.5758620689655173, 0.42201834862385323]
TARGET: 1
target metric(test f1): 0.2709867452135494
column_sums: [627 461]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 13 epochs
Epoch 33/80
263/263 - 491s - loss: 0.5832 - accuracy: 0.6921 - val_loss: 0.7923 - val_accuracy: 0.5441
Confusion matrix: 
 [[496 374]
 [122  96]]
Validation f1: 27.91
Validation accuracy: 54.41
Validation recall: 44.04
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 20.43
Validation AUC: 0.2093815829756992
Validation class accuracies: [0.5701149425287356, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.27906976744186046
column_sums: [618 470]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 14 epochs
Epoch 34/80
263/263 - 490s - loss: 0.5844 - accuracy: 0.6888 - val_loss: 0.7950 - val_accuracy: 0.5432
Confusion matrix: 
 [[495 375]
 [122  96]]
Validation f1: 27.87
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 54.32
Validation recall: 44.04
Validation precision: 20.38
Validation AUC: 0.21031113995583228
Validation class accuracies: [0.5689655172413793, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.2786647314949202
column_sums: [617 471]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 15 epochs
Epoch 35/80
263/263 - 491s - loss: 0.5842 - accuracy: 0.6890 - val_loss: 0.7926 - val_accuracy: 0.5478
Confusion matrix: 
 [[500 370]
 [122  96]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.07
Validation accuracy: 54.78
Validation recall: 44.04
Validation precision: 20.60
Validation AUC: 0.21008037818213568
Validation class accuracies: [0.5747126436781609, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.28070175438596495
column_sums: [622 466]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 16 epochs
Epoch 36/80
263/263 - 491s - loss: 0.5928 - accuracy: 0.6745 - val_loss: 0.7876 - val_accuracy: 0.5423
Confusion matrix: 
 [[498 372]
 [126  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.98
Validation accuracy: 54.23
Validation recall: 42.20
Validation precision: 19.83
Validation AUC: 0.2079011371389783
Validation class accuracies: [0.5724137931034483, 0.42201834862385323]
TARGET: 1
target metric(test f1): 0.26979472140762467
column_sums: [624 464]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 17 epochs
Epoch 37/80
263/263 - 492s - loss: 0.5879 - accuracy: 0.6811 - val_loss: 0.7909 - val_accuracy: 0.5423
Confusion matrix: 
 [[497 373]
 [125  93]]
Validation f1: 27.19
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 54.23
Validation recall: 42.66
Validation precision: 19.96
Validation AUC: 0.20822431841394617
Validation class accuracies: [0.5712643678160919, 0.42660550458715596]
TARGET: 1
target metric(test f1): 0.27192982456140347
column_sums: [622 466]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 18 epochs
Epoch 38/80
263/263 - 491s - loss: 0.5846 - accuracy: 0.6911 - val_loss: 0.7887 - val_accuracy: 0.5404
Confusion matrix: 
 [[497 373]
 [127  91]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.69
Validation accuracy: 54.04
Validation recall: 41.74
Validation precision: 19.61
Validation AUC: 0.20824163101568305
Validation class accuracies: [0.5712643678160919, 0.41743119266055045]
TARGET: 1
target metric(test f1): 0.2668621700879765
column_sums: [624 464]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 19 epochs
Epoch 39/80
263/263 - 491s - loss: 0.5877 - accuracy: 0.6871 - val_loss: 0.7862 - val_accuracy: 0.5423
Confusion matrix: 
 [[500 370]
 [128  90]]
Validation f1: 26.55
Validation accuracy: 54.23
Validation recall: 41.28
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 19.57
Validation AUC: 0.20687686944093286
Validation class accuracies: [0.5747126436781609, 0.41284403669724773]
TARGET: 1
target metric(test f1): 0.26548672566371684
column_sums: [628 460]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.103515914901436e-08
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 20 epochs
Epoch 40/80
263/263 - 492s - loss: 0.5886 - accuracy: 0.6797 - val_loss: 0.7952 - val_accuracy: 0.5432
Confusion matrix: 
 [[495 375]
 [122  96]]
Validation f1: 27.87
Validation accuracy: 54.32
Validation recall: 44.04
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 20.38
Validation AUC: 0.21007034148651915
Validation class accuracies: [0.5689655172413793, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.2786647314949202
column_sums: [617 471]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 21 epochs
Epoch 41/80
263/263 - 491s - loss: 0.5856 - accuracy: 0.6880 - val_loss: 0.8006 - val_accuracy: 0.5368
Confusion matrix: 
 [[485 385]
 [119  99]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.21
Validation accuracy: 53.68
Validation recall: 45.41
Validation precision: 20.45
Validation AUC: 0.2114673020226734
Validation class accuracies: [0.5574712643678161, 0.4541284403669725]
TARGET: 1
target metric(test f1): 0.2820512820512821
column_sums: [604 484]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 22 epochs
Epoch 42/80
263/263 - 490s - loss: 0.5848 - accuracy: 0.6878 - val_loss: 0.7846 - val_accuracy: 0.5460
Confusion matrix: 
 [[501 369]
 [125  93]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.35
Validation accuracy: 54.60
Validation recall: 42.66
Validation precision: 20.13
Validation AUC: 0.2090224573643142
Validation class accuracies: [0.5758620689655173, 0.42660550458715596]
TARGET: 1
target metric(test f1): 0.27352941176470585
column_sums: [626 462]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 23 epochs
Epoch 43/80
263/263 - 491s - loss: 0.5872 - accuracy: 0.6830 - val_loss: 0.7923 - val_accuracy: 0.5441
Confusion matrix: 
 [[496 374]
 [122  96]]
Validation f1: 27.91
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 54.41
Validation recall: 44.04
Validation precision: 20.43
Validation AUC: 0.20984002783286876
Validation class accuracies: [0.5701149425287356, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.27906976744186046
column_sums: [618 470]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.525878978725359e-08
The validation tracker metric at 0.30726256983240224 hasn't increased by 0 in 24 epochs
Epoch 44/80
263/263 - 491s - loss: 0.5882 - accuracy: 0.6899 - val_loss: 0.7924 - val_accuracy: 0.5377
Confusion matrix: 
 [[493 377]
 [126  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.78
Validation accuracy: 53.77
Validation recall: 42.20
Validation precision: 19.62
Validation AUC: 0.20726858557304148
Validation class accuracies: [0.5666666666666667, 0.42201834862385323]

The metrics for the epoch with the best target metric are: 
Best cm: [[482 388]
 [108 110]]
Best f1: 0.30726256983240224
Best accuracy: 0.5441176470588235
Best recall: 0.5045871559633027
Best precision: 0.22088353413654618
Best AUC: 0.21320001250537
Best epoch: 19
TARGET: 1
target metric(test f1): 0.2678311499272198
column_sums: [619 469]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 19
Starting...
CM: [[ 6 54]
 [ 0 15]]
F1: 0.3571428571428571
AUC: 0.6086956521739131
Accuracy: 0.28
Precision: 0.21739130434782608
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2138__05_1444__v29__mod9/validation_sheet_19.xls...
Done.
Epoch: 3
Starting...
CM: [[13 47]
 [ 2 13]]
F1: 0.3466666666666666
AUC: 0.555
Accuracy: 0.3466666666666667
Precision: 0.21666666666666667
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2138__05_1444__v29__mod9/validation_sheet_3.xls...
Done.
Epoch: 80
Starting...
CM: [[ 4 56]
 [ 1 14]]
F1: 0.3294117647058824
AUC: 0.5733333333333333
Accuracy: 0.24
Precision: 0.2
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2138__05_1444__v29__mod9/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 30907
wandb: Program ended successfully.
wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.05MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.05MB of 0.06MB uploaded (0.00MB deduped)wandb: - 0.05MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210514_144459-2wbwfqos/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210514_144459-2wbwfqos/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.68994
wandb:         val_accuracy 0.53768
wandb:             _runtime 22833
wandb:           _timestamp 1621026332
wandb:                _step 314
wandb:           train_loss 0.58819
wandb:             val_loss 0.79245
wandb:           val_recall 0.42202
wandb:        val_precision 0.19616
wandb:               val_f1 0.26783
wandb:              val_auc 0.20727
wandb:                   lr 0.0
wandb:          best_val_f1 0.30726
wandb:    best_val_accuracy 0.54412
wandb:   best_val_precision 0.22088
wandb:      best_val_recall 0.50459
wandb:             best_auc 0.2132
wandb:           best_epoch 19
wandb:           best_bd_f1 0.35714
wandb:          best_bd_auc 0.6087
wandb:     best_bd_accuracy 0.28
wandb:    best_bd_precision 0.21739
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 19
wandb: Run history:
wandb:   train_accuracy ▁▂▃▁▄▂▄▄▄▃▅▅▆▆▇▇▇▇▇▇███▇█▇▇█████▇▇██▇███
wandb:     val_accuracy ██▆▅▁▇██▇▇▆▇▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▆▅▅▅▅▅▄▄▄▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▂█▁▁▁▁▁▁▁▁▁▂▁▁▁▂▂▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ▁▂▄▄█▂▁▁▃▂▃▂▄▃▅▄▄▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:    val_precision ▁██▇▇▆▆█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▆▇▇▇▆
wandb:           val_f1 ▁▃▇▇█▃▃▂▆▅▆▅▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc █▄▄▄▂▂▂▁▅▅▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:               lr ██████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 7 media file(s), 5 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2138: https://wandb.ai/arachid1/tensorboard-integration/runs/2wbwfqos


 See logs at ../../new_cache/conv__2138__05_1444__v29__mod9/logs/