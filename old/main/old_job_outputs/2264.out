Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2264
Description:  mixup
2021-06-28 20:33:31.263951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-28 20:33:34.361472: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-28 20:33:34.362745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-28 20:33:34.424251: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:34.425375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-28 20:33:34.425459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 20:33:34.430860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 20:33:34.431014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-28 20:33:34.432734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-28 20:33:34.433203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-28 20:33:34.435041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-28 20:33:34.436503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-28 20:33:34.436774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 20:33:34.437021: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:34.438441: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:34.439543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2264.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2264__06_2020__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-28 20:33:39.697003: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-28 20:33:39.697339: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:39.698159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-28 20:33:39.698218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 20:33:39.698293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 20:33:39.698327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-28 20:33:39.698359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-28 20:33:39.698393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-28 20:33:39.698425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-28 20:33:39.698455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-28 20:33:39.698484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 20:33:39.698607: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:39.699455: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:39.700158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-28 20:33:39.700214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 20:33:40.525263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-28 20:33:40.525323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-28 20:33:40.525336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-28 20:33:40.525668: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:40.526520: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:40.527278: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 20:33:40.528296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-06-28 20:33:41.613955: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-28 20:33:41.616346: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-28 20:34:37.487563: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2858
2021-06-28 20:34:47.300428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 2858
2021-06-28 20:34:57.374304: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 2858
2021-06-28 20:35:07.413424: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 2858
2021-06-28 20:35:09.761443: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-06-28 20:35:10.043833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 20:35:11.560291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 20:35:12.000054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 2858
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
179/179 - 119s - loss: 0.3131 - accuracy: 0.8968 - val_loss: 0.2498 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12407217407278784
Validation class accuracies: [1.0, 0.0]
2021-06-28 20:36:48.541096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 2858
2021-06-28 20:36:58.583418: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 2858
2021-06-28 20:37:08.537367: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 2858
2021-06-28 20:37:18.499061: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 2858
2021-06-28 20:37:28.565528: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 2858
2021-06-28 20:37:32.718317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
179/179 - 128s - loss: 0.1331 - accuracy: 0.9468 - val_loss: 0.2840 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.18436157449481777
Validation class accuracies: [1.0, 0.0]
2021-06-28 20:39:10.482326: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 2858
2021-06-28 20:39:20.179040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 2858
2021-06-28 20:39:30.164964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1678 of 2858
2021-06-28 20:39:40.207720: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 2858
2021-06-28 20:39:50.505812: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 2858
2021-06-28 20:39:54.497379: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
179/179 - 126s - loss: 0.0932 - accuracy: 0.9531 - val_loss: 0.2711 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.30532375384968197
Validation class accuracies: [1.0, 0.0]
2021-06-28 20:41:28.805573: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 2858
2021-06-28 20:41:38.564242: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 2858
2021-06-28 20:41:48.757356: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 2858
2021-06-28 20:41:58.603418: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 2858
2021-06-28 20:42:08.990231: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 2858
2021-06-28 20:42:13.977152: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
179/179 - 126s - loss: 0.0682 - accuracy: 0.9657 - val_loss: 0.2774 - val_accuracy: 0.9007
Confusion matrix: 
 [[524  49]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.293 0.707]]
Validation f1: 48.74
Validation accuracy: 90.07
Validation recall: 70.73
Validation precision: 37.18
Validation AUC: 0.5402296411293129
Validation class accuracies: [0.9144851657940664, 0.7073170731707317]
2021-06-28 20:43:46.001613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 2858
2021-06-28 20:43:56.303175: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1089 of 2858
2021-06-28 20:44:06.005739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 2858
2021-06-28 20:44:16.249564: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 2858
2021-06-28 20:44:26.135070: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2619 of 2858
2021-06-28 20:44:31.427822: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
179/179 - 126s - loss: 0.0535 - accuracy: 0.9685 - val_loss: 0.1503 - val_accuracy: 0.9495
Confusion matrix: 
 [[560  13]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.439 0.561]]
Validation f1: 59.74
Validation accuracy: 94.95
Validation recall: 56.10
Validation precision: 63.89
Validation AUC: 0.6824668093276058
Validation class accuracies: [0.9773123909249564, 0.5609756097560976]
2021-06-28 20:46:03.660232: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 2858
2021-06-28 20:46:13.616770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1176 of 2858
2021-06-28 20:46:23.673025: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 2858
2021-06-28 20:46:33.723274: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 2858
2021-06-28 20:46:43.862187: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2667 of 2858
2021-06-28 20:46:48.607665: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
179/179 - 127s - loss: 0.0328 - accuracy: 0.9801 - val_loss: 0.2862 - val_accuracy: 0.9023
Confusion matrix: 
 [[520  53]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.171 0.829]]
Validation f1: 53.12
Validation accuracy: 90.23
Validation recall: 82.93
Validation precision: 39.08
Validation AUC: 0.7061754276568425
Validation class accuracies: [0.9075043630017452, 0.8292682926829268]
2021-06-28 20:48:22.215559: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 2858
2021-06-28 20:48:32.021550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1089 of 2858
2021-06-28 20:48:42.229776: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1649 of 2858
2021-06-28 20:48:52.124947: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 2858
2021-06-28 20:49:02.268555: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2651 of 2858
2021-06-28 20:49:08.049677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5974025974025975 hasn't increased by 0 in 1 epochs
Epoch 7/65
179/179 - 128s - loss: 0.0214 - accuracy: 0.9853 - val_loss: 0.1654 - val_accuracy: 0.9414
Confusion matrix: 
 [[551  22]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.341 0.659]]
Validation f1: 60.00
Validation accuracy: 94.14
Validation recall: 65.85
Validation precision: 55.10
Validation AUC: 0.7002973148443095
Validation class accuracies: [0.9616055846422339, 0.6585365853658537]
2021-06-28 20:50:41.640162: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 2858
2021-06-28 20:50:51.597814: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 2858
2021-06-28 20:51:01.599755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1633 of 2858
2021-06-28 20:51:11.752050: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 2858
2021-06-28 20:51:22.039773: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2651 of 2858
2021-06-28 20:51:26.577073: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 8/65
179/179 - 127s - loss: 0.0190 - accuracy: 0.9822 - val_loss: 0.3104 - val_accuracy: 0.9088
Confusion matrix: 
 [[530  43]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.317 0.683]]
Validation f1: 50.00
Validation accuracy: 90.88
Validation recall: 68.29
Validation precision: 39.44
Validation AUC: 0.648639255548588
Validation class accuracies: [0.924956369982548, 0.6829268292682927]
2021-06-28 20:53:00.207942: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 2858
2021-06-28 20:53:10.127429: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 2858
2021-06-28 20:53:20.193683: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 2858
2021-06-28 20:53:30.193854: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 2858
2021-06-28 20:53:40.359037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-28 20:53:43.084017: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6 hasn't increased by 0 in 1 epochs
Epoch 9/65
179/179 - 124s - loss: 0.0272 - accuracy: 0.9794 - val_loss: 0.2696 - val_accuracy: 0.9153
Confusion matrix: 
 [[531  42]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.244 0.756]]
Validation f1: 54.39
Validation accuracy: 91.53
Validation recall: 75.61
Validation precision: 42.47
Validation AUC: 0.6826403710387792
Validation class accuracies: [0.9267015706806283, 0.7560975609756098]
2021-06-28 20:55:15.674048: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 2858
2021-06-28 20:55:25.663711: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 2858
2021-06-28 20:55:35.818993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 2858
2021-06-28 20:55:45.724016: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 2858
2021-06-28 20:55:55.597805: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-28 20:55:58.301791: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6 hasn't increased by 0 in 2 epochs
Epoch 10/65
179/179 - 125s - loss: 0.0148 - accuracy: 0.9829 - val_loss: 0.2282 - val_accuracy: 0.9349
Confusion matrix: 
 [[543  30]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.244 0.756]]
Validation f1: 60.78
Validation accuracy: 93.49
Validation recall: 75.61
Validation precision: 50.82
Validation AUC: 0.6669833327053748
Validation class accuracies: [0.9476439790575916, 0.7560975609756098]
2021-06-28 20:57:32.204803: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 2858
2021-06-28 20:57:42.166273: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 2858
2021-06-28 20:57:52.323442: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1681 of 2858
2021-06-28 20:58:02.290760: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 2858
2021-06-28 20:58:12.352179: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 2858
2021-06-28 20:58:16.403147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 11/65
179/179 - 128s - loss: 0.0322 - accuracy: 0.9776 - val_loss: 0.2923 - val_accuracy: 0.9381
Confusion matrix: 
 [[573   0]
 [ 38   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.927 0.073]]
Validation f1: 13.64
Validation accuracy: 93.81
Validation recall: 7.32
Validation precision: 100.00
Validation AUC: 0.49925657861676664
Validation class accuracies: [1.0, 0.07317073170731707]
2021-06-28 20:59:51.946802: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 2858
2021-06-28 21:00:01.670246: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 2858
2021-06-28 21:00:11.682150: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 2858
2021-06-28 21:00:21.873495: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 2858
2021-06-28 21:00:31.716044: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2667 of 2858
2021-06-28 21:00:36.111944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6078431372549019 hasn't increased by 0 in 1 epochs
Epoch 12/65
179/179 - 127s - loss: 0.0159 - accuracy: 0.9822 - val_loss: 0.1387 - val_accuracy: 0.9511
Confusion matrix: 
 [[555  18]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.293 0.707]]
Validation f1: 65.91
Validation accuracy: 95.11
Validation recall: 70.73
Validation precision: 61.70
Validation AUC: 0.7164658052436647
Validation class accuracies: [0.9685863874345549, 0.7073170731707317]
2021-06-28 21:02:11.956092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 2858
2021-06-28 21:02:22.046449: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 2858
2021-06-28 21:02:31.893601: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 2858
2021-06-28 21:02:41.967734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 2858
2021-06-28 21:02:51.900029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2778 of 2858
2021-06-28 21:02:53.818462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 13/65
179/179 - 122s - loss: 0.0113 - accuracy: 0.9843 - val_loss: 0.1348 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.7539641551732674
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
2021-06-28 21:04:25.929756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 2858
2021-06-28 21:04:35.916258: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 2858
2021-06-28 21:04:45.818760: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1521 of 2858
2021-06-28 21:04:55.768677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2081 of 2858
2021-06-28 21:05:05.854901: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-28 21:05:12.566844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 1 epochs
Epoch 14/65
179/179 - 128s - loss: 0.0139 - accuracy: 0.9843 - val_loss: 0.1639 - val_accuracy: 0.9544
Confusion matrix: 
 [[560  13]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.366 0.634]]
Validation f1: 65.00
Validation accuracy: 95.44
Validation recall: 63.41
Validation precision: 66.67
Validation AUC: 0.6957649092762611
Validation class accuracies: [0.9773123909249564, 0.6341463414634146]
2021-06-28 21:06:45.946397: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 2858
2021-06-28 21:06:55.906096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1041 of 2858
2021-06-28 21:07:05.901240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1521 of 2858
2021-06-28 21:07:16.109027: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 2858
2021-06-28 21:07:25.984749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 2858
2021-06-28 21:07:34.524353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 2 epochs
Epoch 15/65
179/179 - 130s - loss: 0.0131 - accuracy: 0.9846 - val_loss: 0.1650 - val_accuracy: 0.9625
Confusion matrix: 
 [[569   4]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.463 0.537]]
Validation f1: 65.67
Validation accuracy: 96.25
Validation recall: 53.66
Validation precision: 84.62
Validation AUC: 0.707911638657924
Validation class accuracies: [0.9930191972076788, 0.5365853658536586]
2021-06-28 21:09:08.005507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 2858
2021-06-28 21:09:18.080824: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 2858
2021-06-28 21:09:27.974455: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 2858
2021-06-28 21:09:37.921917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 2858
2021-06-28 21:09:48.113196: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2858
2021-06-28 21:09:56.672726: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 3 epochs
Epoch 16/65
179/179 - 130s - loss: 0.0108 - accuracy: 0.9829 - val_loss: 0.1681 - val_accuracy: 0.9511
Confusion matrix: 
 [[563  10]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.488 0.512]]
Validation f1: 58.33
Validation accuracy: 95.11
Validation recall: 51.22
Validation precision: 67.74
Validation AUC: 0.6801609000818847
Validation class accuracies: [0.9825479930191972, 0.5121951219512195]
2021-06-28 21:11:29.330172: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 2858
2021-06-28 21:11:39.173506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 2858
2021-06-28 21:11:49.113910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 2858
2021-06-28 21:11:59.286332: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 2858
2021-06-28 21:12:09.416842: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 2858
2021-06-28 21:12:13.714869: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 4 epochs
Epoch 17/65
179/179 - 126s - loss: 0.0132 - accuracy: 0.9843 - val_loss: 0.3996 - val_accuracy: 0.8762
Confusion matrix: 
 [[507  66]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.244 0.756]]
Validation f1: 44.93
Validation accuracy: 87.62
Validation recall: 75.61
Validation precision: 31.96
Validation AUC: 0.5376452104130067
Validation class accuracies: [0.8848167539267016, 0.7560975609756098]
2021-06-28 21:13:47.534944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 2858
2021-06-28 21:13:57.441144: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1089 of 2858
2021-06-28 21:14:07.288978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1633 of 2858
2021-06-28 21:14:17.385421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 2858
2021-06-28 21:14:27.426757: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2795 of 2858
2021-06-28 21:14:28.408873: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 5 epochs
Epoch 18/65
179/179 - 121s - loss: 0.0143 - accuracy: 0.9815 - val_loss: 0.1688 - val_accuracy: 0.9446
Confusion matrix: 
 [[562  11]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.561 0.439]]
Validation f1: 51.43
Validation accuracy: 94.46
Validation recall: 43.90
Validation precision: 62.07
Validation AUC: 0.6506936855135447
Validation class accuracies: [0.9808027923211169, 0.43902439024390244]
2021-06-28 21:15:57.877935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 21:16:07.739169: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 21:16:17.819067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 21:16:27.895126: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2858
2021-06-28 21:16:33.210795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 19/65
179/179 - 116s - loss: 0.0110 - accuracy: 0.9843 - val_loss: 0.1433 - val_accuracy: 0.9544
Confusion matrix: 
 [[565   8]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.488 0.512]]
Validation f1: 60.00
Validation accuracy: 95.44
Validation recall: 51.22
Validation precision: 72.41
Validation AUC: 0.7031492035277325
Validation class accuracies: [0.9860383944153578, 0.5121951219512195]
2021-06-28 21:18:03.120539: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 21:18:13.098478: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2858
2021-06-28 21:18:23.019199: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2858
2021-06-28 21:18:33.094910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2603 of 2858
2021-06-28 21:18:37.711410: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 7 epochs
Epoch 20/65
179/179 - 115s - loss: 0.0079 - accuracy: 0.9871 - val_loss: 0.1377 - val_accuracy: 0.9511
Confusion matrix: 
 [[561  12]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.439 0.561]]
Validation f1: 60.53
Validation accuracy: 95.11
Validation recall: 56.10
Validation precision: 65.71
Validation AUC: 0.7002878763533121
Validation class accuracies: [0.9790575916230366, 0.5609756097560976]
2021-06-28 21:20:07.513292: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2858
2021-06-28 21:20:17.480030: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2858
2021-06-28 21:20:27.438795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 2858
2021-06-28 21:20:37.657052: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2667 of 2858
2021-06-28 21:20:41.001478: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 8 epochs
Epoch 21/65
179/179 - 113s - loss: 0.0140 - accuracy: 0.9818 - val_loss: 0.1598 - val_accuracy: 0.9593
Confusion matrix: 
 [[570   3]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.537 0.463]]
Validation f1: 60.32
Validation accuracy: 95.93
Validation recall: 46.34
Validation precision: 86.36
Validation AUC: 0.7269426021530795
Validation class accuracies: [0.9947643979057592, 0.4634146341463415]
2021-06-28 21:22:10.308239: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2858
2021-06-28 21:22:20.166696: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 2858
2021-06-28 21:22:30.220813: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 2858
2021-06-28 21:22:40.298125: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 2858
2021-06-28 21:22:42.643594: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 9 epochs
Epoch 22/65
179/179 - 114s - loss: 0.0092 - accuracy: 0.9860 - val_loss: 0.1485 - val_accuracy: 0.9544
Confusion matrix: 
 [[559  14]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.341 0.659]]
Validation f1: 65.85
Validation accuracy: 95.44
Validation recall: 65.85
Validation precision: 65.85
Validation AUC: 0.7433339803330846
Validation class accuracies: [0.9755671902268761, 0.6585365853658537]
2021-06-28 21:24:17.493882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 2858
2021-06-28 21:24:27.295330: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 999 of 2858
2021-06-28 21:24:37.495505: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 2858
2021-06-28 21:24:47.413094: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 21:24:57.302778: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 2858
2021-06-28 21:25:04.225280: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 10 epochs
Epoch 23/65
179/179 - 127s - loss: 0.0119 - accuracy: 0.9832 - val_loss: 0.1612 - val_accuracy: 0.9495
Confusion matrix: 
 [[555  18]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.317 0.683]]
Validation f1: 64.37
Validation accuracy: 94.95
Validation recall: 68.29
Validation precision: 60.87
Validation AUC: 0.7314763201473815
Validation class accuracies: [0.9685863874345549, 0.6829268292682927]
2021-06-28 21:26:34.371910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 21:26:44.445148: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-28 21:26:54.383985: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 21:27:04.300962: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 2858
2021-06-28 21:27:09.861680: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 11 epochs
Epoch 24/65
179/179 - 117s - loss: 0.0119 - accuracy: 0.9850 - val_loss: 0.1389 - val_accuracy: 0.9642
Confusion matrix: 
 [[572   1]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.512 0.488]]
Validation f1: 64.52
Validation accuracy: 96.42
Validation recall: 48.78
Validation precision: 95.24
Validation AUC: 0.787056638787403
Validation class accuracies: [0.9982547993019197, 0.4878048780487805]
2021-06-28 21:28:41.509410: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 21:28:51.658759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 21:29:01.480468: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 2858
2021-06-28 21:29:11.425256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2537 of 2858
2021-06-28 21:29:17.659860: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6590909090909092 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 25/65
179/179 - 116s - loss: 0.0096 - accuracy: 0.9825 - val_loss: 0.1375 - val_accuracy: 0.9560
Confusion matrix: 
 [[559  14]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.317 0.683]]
Validation f1: 67.47
Validation accuracy: 95.60
Validation recall: 68.29
Validation precision: 66.67
Validation AUC: 0.758673393608146
Validation class accuracies: [0.9755671902268761, 0.6829268292682927]
2021-06-28 21:30:47.763102: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2858
2021-06-28 21:30:57.751735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2858
2021-06-28 21:31:07.662843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 21:31:17.693192: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 2858
2021-06-28 21:31:22.578702: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 26/65
179/179 - 115s - loss: 0.0087 - accuracy: 0.9871 - val_loss: 0.1412 - val_accuracy: 0.9560
Confusion matrix: 
 [[560  13]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.341 0.659]]
Validation f1: 66.67
Validation accuracy: 95.60
Validation recall: 65.85
Validation precision: 67.50
Validation AUC: 0.7553287422884457
Validation class accuracies: [0.9773123909249564, 0.6585365853658537]
2021-06-28 21:32:52.472781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 21:33:02.466545: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 2858
2021-06-28 21:33:12.605347: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 2858
2021-06-28 21:33:22.588943: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 2858
2021-06-28 21:33:32.691356: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 2858
2021-06-28 21:33:39.982151: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.674698795180723 hasn't increased by 0 in 1 epochs
Epoch 27/65
179/179 - 132s - loss: 0.0086 - accuracy: 0.9871 - val_loss: 0.1478 - val_accuracy: 0.9544
Confusion matrix: 
 [[559  14]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 65.85
Validation accuracy: 95.44
Validation recall: 65.85
Validation precision: 65.85
Validation AUC: 0.7387433172252865
Validation class accuracies: [0.9755671902268761, 0.6585365853658537]
2021-06-28 21:35:14.578609: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 21:35:24.751569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 21:35:34.667309: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 2858
2021-06-28 21:35:44.565514: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2486 of 2858
2021-06-28 21:35:52.504393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.674698795180723 hasn't increased by 0 in 2 epochs
Epoch 28/65
179/179 - 124s - loss: 0.0115 - accuracy: 0.9832 - val_loss: 0.1451 - val_accuracy: 0.9528
Confusion matrix: 
 [[558  15]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.341 0.659]]
Validation f1: 65.06
Validation accuracy: 95.28
Validation recall: 65.85
Validation precision: 64.29
Validation AUC: 0.7353851688310039
Validation class accuracies: [0.9738219895287958, 0.6585365853658537]
2021-06-28 21:37:29.638133: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 21:37:39.613613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 21:37:49.719594: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 21:37:59.820835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 21:38:09.193480: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.674698795180723 hasn't increased by 0 in 3 epochs
Epoch 29/65
179/179 - 125s - loss: 0.0102 - accuracy: 0.9843 - val_loss: 0.1333 - val_accuracy: 0.9577
Confusion matrix: 
 [[561  12]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.341 0.659]]
Validation f1: 67.50
Validation accuracy: 95.77
Validation recall: 65.85
Validation precision: 69.23
Validation AUC: 0.7595083049784869
Validation class accuracies: [0.9790575916230366, 0.6585365853658537]
2021-06-28 21:39:44.923204: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 21:39:54.893202: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2858
2021-06-28 21:40:04.989475: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 2858
2021-06-28 21:40:14.794916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2517 of 2858
2021-06-28 21:40:22.208093: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 30/65
179/179 - 121s - loss: 0.0110 - accuracy: 0.9850 - val_loss: 0.1460 - val_accuracy: 0.9560
Confusion matrix: 
 [[559  14]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.317 0.683]]
Validation f1: 67.47
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.60
Validation recall: 68.29
Validation precision: 66.67
Validation AUC: 0.7338148024971556
Validation class accuracies: [0.9755671902268761, 0.6829268292682927]
2021-06-28 21:41:56.448164: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 21:42:06.440096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2858
2021-06-28 21:42:16.489951: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 2858
2021-06-28 21:42:26.334934: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 2858
2021-06-28 21:42:34.733458: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.675 hasn't increased by 0 in 1 epochs
Epoch 31/65
179/179 - 124s - loss: 0.0103 - accuracy: 0.9825 - val_loss: 0.1603 - val_accuracy: 0.9528
Confusion matrix: 
 [[557  16]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.317 0.683]]
Validation f1: 65.88
Validation accuracy: 95.28
Validation recall: 68.29
Validation precision: 63.64
Validation AUC: 0.7323090734241412
Validation class accuracies: [0.9720767888307156, 0.6829268292682927]
2021-06-28 21:44:10.256622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 21:44:20.267840: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 21:44:30.277961: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 21:44:40.438999: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 21:44:50.018801: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.675 hasn't increased by 0 in 2 epochs
Epoch 32/65
179/179 - 125s - loss: 0.0094 - accuracy: 0.9857 - val_loss: 0.1414 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
Validation f1: 66.67
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7397137911182735
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 21:46:26.049881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 21:46:36.082035: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 21:46:46.052947: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 21:46:56.484099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 21:47:05.905996: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.675 hasn't increased by 0 in 3 epochs
Epoch 33/65
179/179 - 126s - loss: 0.0118 - accuracy: 0.9815 - val_loss: 0.1524 - val_accuracy: 0.9560
Confusion matrix: 
 [[559  14]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 67.47
Validation accuracy: 95.60
Validation recall: 68.29
Validation precision: 66.67
Validation AUC: 0.7329329933136366
Validation class accuracies: [0.9755671902268761, 0.6829268292682927]
2021-06-28 21:48:42.250992: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 21:48:52.190971: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 21:49:02.255964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 21:49:12.125884: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 2858
2021-06-28 21:49:19.375660: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.675 hasn't increased by 0 in 4 epochs
Epoch 34/65
179/179 - 119s - loss: 0.0105 - accuracy: 0.9825 - val_loss: 0.1193 - val_accuracy: 0.9642
Confusion matrix: 
 [[566   7]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.366 0.634]]
Validation f1: 70.27
Validation accuracy: 96.42
Validation recall: 63.41
Validation precision: 78.79
Validation AUC: 0.7616798604491195
Validation class accuracies: [0.987783595113438, 0.6341463414634146]
2021-06-28 21:50:52.057007: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 21:51:02.119550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2858
2021-06-28 21:51:12.138338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 21:51:22.255682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2858
2021-06-28 21:51:32.275708: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2843 of 2858
2021-06-28 21:51:32.285897: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 35/65
179/179 - 124s - loss: 0.0086 - accuracy: 0.9871 - val_loss: 0.1307 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7480491842088159
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 21:53:05.504790: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 21:53:15.623915: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 2858
2021-06-28 21:53:25.646312: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 21:53:35.406462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 2858
2021-06-28 21:53:45.587368: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 2858
2021-06-28 21:53:48.950662: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 1 epochs
Epoch 36/65
179/179 - 131s - loss: 0.0118 - accuracy: 0.9804 - val_loss: 0.1449 - val_accuracy: 0.9560
Confusion matrix: 
 [[561  12]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.366 0.634]]
Validation f1: 65.82
Validation accuracy: 95.60
Validation recall: 63.41
Validation precision: 68.42
Validation AUC: 0.7191679035933882
Validation class accuracies: [0.9790575916230366, 0.6341463414634146]
2021-06-28 21:55:30.478825: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 21:55:40.512382: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 21:55:50.576238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 2858
2021-06-28 21:56:00.915967: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 21:56:08.854023: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 2 epochs
Epoch 37/65
179/179 - 122s - loss: 0.0120 - accuracy: 0.9811 - val_loss: 0.1558 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7134497377969458
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 21:57:49.129843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 21:57:59.129133: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 2858
2021-06-28 21:58:09.114568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 2858
2021-06-28 21:58:19.051710: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2858
2021-06-28 21:58:25.555639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 3 epochs
Epoch 38/65
179/179 - 120s - loss: 0.0126 - accuracy: 0.9829 - val_loss: 0.1480 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7285669440923443
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 22:00:04.908691: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:00:15.116806: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:00:25.077801: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 2858
2021-06-28 22:00:34.928754: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:00:42.958527: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 4 epochs
Epoch 39/65
179/179 - 122s - loss: 0.0126 - accuracy: 0.9794 - val_loss: 0.1460 - val_accuracy: 0.9560
Confusion matrix: 
 [[562  11]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.39  0.61 ]]
Validation f1: 64.94
Validation accuracy: 95.60
Validation recall: 60.98
Validation precision: 69.44
Validation AUC: 0.7285220647678264
Validation class accuracies: [0.9808027923211169, 0.6097560975609756]
2021-06-28 22:02:22.231843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:02:32.220426: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:02:42.279209: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 22:02:52.385942: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2858
2021-06-28 22:02:59.979337: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 5 epochs
Epoch 40/65
179/179 - 122s - loss: 0.0116 - accuracy: 0.9794 - val_loss: 0.1448 - val_accuracy: 0.9560
Confusion matrix: 
 [[561  12]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 65.82
Validation accuracy: 95.60
Validation recall: 63.41
Validation precision: 68.42
Validation AUC: 0.7389399349318725
Validation class accuracies: [0.9790575916230366, 0.6341463414634146]
2021-06-28 22:04:39.817986: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:04:49.917036: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:04:59.806514: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:05:09.924862: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:05:17.771216: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 41/65
179/179 - 122s - loss: 0.0113 - accuracy: 0.9853 - val_loss: 0.1430 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
Validation f1: 66.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7417794619010971
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 22:06:56.999392: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2858
2021-06-28 22:07:06.965336: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:07:16.848531: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 2858
2021-06-28 22:07:26.923608: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 2858
2021-06-28 22:07:33.988166: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 7 epochs
Epoch 42/65
179/179 - 122s - loss: 0.0080 - accuracy: 0.9829 - val_loss: 0.1388 - val_accuracy: 0.9560
Confusion matrix: 
 [[563  10]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.415 0.585]]
Validation f1: 64.00
Validation accuracy: 95.60
Validation recall: 58.54
Validation precision: 70.59
Validation AUC: 0.7468064351229046
Validation class accuracies: [0.9825479930191972, 0.5853658536585366]
2021-06-28 22:09:11.153374: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:09:21.136620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 22:09:31.117245: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 2858
2021-06-28 22:09:41.310592: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 2858
2021-06-28 22:09:47.611801: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 8 epochs
Epoch 43/65
179/179 - 122s - loss: 0.0107 - accuracy: 0.9815 - val_loss: 0.1342 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
Validation f1: 66.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7483936232994809
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 22:11:26.395793: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:11:36.508539: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:11:46.461550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:11:56.735071: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:12:04.751180: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 9 epochs
Epoch 44/65
179/179 - 125s - loss: 0.0119 - accuracy: 0.9832 - val_loss: 0.1417 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
Validation f1: 66.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7373534641952197
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 22:13:43.673272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:13:53.683414: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:14:03.639916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:14:13.725586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:14:21.517695: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 10 epochs
Epoch 45/65
179/179 - 125s - loss: 0.0088 - accuracy: 0.9853 - val_loss: 0.1359 - val_accuracy: 0.9577
Confusion matrix: 
 [[561  12]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 67.50
Validation accuracy: 95.77
Validation recall: 65.85
Validation precision: 69.23
Validation AUC: 0.7494517863260922
Validation class accuracies: [0.9790575916230366, 0.6585365853658537]
2021-06-28 22:15:59.705631: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:16:09.683378: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:16:19.633317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:16:29.847431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2858
2021-06-28 22:16:37.326912: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 11 epochs
Epoch 46/65
179/179 - 123s - loss: 0.0097 - accuracy: 0.9853 - val_loss: 0.1337 - val_accuracy: 0.9625
Confusion matrix: 
 [[565   8]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.366 0.634]]
Validation f1: 69.33
Validation accuracy: 96.25
Validation recall: 63.41
Validation precision: 76.47
Validation AUC: 0.7504071225993368
Validation class accuracies: [0.9860383944153578, 0.6341463414634146]
2021-06-28 22:18:13.025114: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:18:23.051710: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 22:18:33.228753: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2858
2021-06-28 22:18:43.073616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 2858
2021-06-28 22:18:49.257718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 47/65
179/179 - 123s - loss: 0.0097 - accuracy: 0.9815 - val_loss: 0.1356 - val_accuracy: 0.9593
Confusion matrix: 
 [[563  10]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.366 0.634]]
Validation f1: 67.53
Validation accuracy: 95.93
Validation recall: 63.41
Validation precision: 72.22
Validation AUC: 0.7467442555991585
Validation class accuracies: [0.9825479930191972, 0.6341463414634146]
2021-06-28 22:20:26.771238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:20:36.790879: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:20:46.975224: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 22:20:56.741184: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2858
2021-06-28 22:21:04.063088: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 13 epochs
Epoch 48/65
179/179 - 125s - loss: 0.0104 - accuracy: 0.9811 - val_loss: 0.1378 - val_accuracy: 0.9593
Confusion matrix: 
 [[563  10]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.366 0.634]]
Validation f1: 67.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.93
Validation recall: 63.41
Validation precision: 72.22
Validation AUC: 0.7434756305692586
Validation class accuracies: [0.9825479930191972, 0.6341463414634146]
2021-06-28 22:22:42.075207: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:22:52.195298: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:23:02.169636: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 2858
2021-06-28 22:23:12.597159: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:23:20.563689: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 14 epochs
Epoch 49/65
179/179 - 126s - loss: 0.0086 - accuracy: 0.9850 - val_loss: 0.1378 - val_accuracy: 0.9593
Confusion matrix: 
 [[562  11]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.341 0.659]]
Validation f1: 68.35
Validation accuracy: 95.93
Validation recall: 65.85
Validation precision: 71.05
Validation AUC: 0.7461160282097514
Validation class accuracies: [0.9808027923211169, 0.6585365853658537]
2021-06-28 22:24:58.274184: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:25:08.466353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 2858
2021-06-28 22:25:18.393257: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 2858
2021-06-28 22:25:28.411911: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2858
2021-06-28 22:25:35.754850: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 15 epochs
Epoch 50/65
179/179 - 124s - loss: 0.0114 - accuracy: 0.9829 - val_loss: 0.1417 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
Validation f1: 66.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7412196847214936
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 22:27:11.965002: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2858
2021-06-28 22:27:22.128274: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 22:27:31.907314: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 2858
2021-06-28 22:27:42.048902: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 2858
2021-06-28 22:27:48.316401: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 16 epochs
Epoch 51/65
179/179 - 123s - loss: 0.0091 - accuracy: 0.9832 - val_loss: 0.1476 - val_accuracy: 0.9560
Confusion matrix: 
 [[560  13]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.60
Validation recall: 65.85
Validation precision: 67.50
Validation AUC: 0.7328367137804994
Validation class accuracies: [0.9773123909249564, 0.6585365853658537]
2021-06-28 22:29:25.669867: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:29:35.589346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:29:45.573448: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:29:55.885871: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:30:03.808962: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 17 epochs
Epoch 52/65
179/179 - 125s - loss: 0.0113 - accuracy: 0.9818 - val_loss: 0.1429 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7370933433558827
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-28 22:31:40.835617: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:31:50.860142: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:32:00.875623: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:32:11.016182: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2858
2021-06-28 22:32:19.422023: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 53/65
179/179 - 125s - loss: 0.0075 - accuracy: 0.9850 - val_loss: 0.1435 - val_accuracy: 0.9609
Confusion matrix: 
 [[562  11]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.317 0.683]]
Validation f1: 70.00
Validation accuracy: 96.09
Validation recall: 68.29
Validation precision: 71.79
Validation AUC: 0.736141742362852
Validation class accuracies: [0.9808027923211169, 0.6829268292682927]
2021-06-28 22:33:56.467338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 2858
2021-06-28 22:34:06.561926: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 2858
2021-06-28 22:34:16.452728: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 2858
2021-06-28 22:34:26.641472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2858
2021-06-28 22:34:33.973488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7027027027027027 hasn't increased by 0 in 19 epochs
Epoch 54/65
179/179 - 123s - loss: 0.0106 - accuracy: 0.9825 - val_loss: 0.1447 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 66.67
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.7375466503215533
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]

The metrics for job 0 with the best target metric are: 
Best cm: [[566   7]
 [ 15  26]]
Best normalized cm: [[0.988 0.012]
 [0.366 0.634]]
Best f1: 0.70
Best accuracy: 0.96
Best recall: 0.63
Best precision: 0.79
Best AUC: 0.76
Best class accuracies: [0.987783595113438, 0.6341463414634146]
Best epoch: 34
The number of epochs since last 1% equals the patience
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.022]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[7.917e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[9.03e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.466]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[6.815e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.097e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[6.825e-06]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[1.617e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[9.307e-06]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[5.629e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[8.242e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.832e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[4.576e-05]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.106]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.143]]
../../new_cache/conv__2264__06_2020__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.018]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 29995
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_203334-3ntepvze/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_203334-3ntepvze/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98251
wandb:         val_accuracy 0.95765
wandb:             _runtime 7344
wandb:           _timestamp 1624919758
wandb:                _step 401
wandb:           train_loss 0.01058
wandb:             val_loss 0.14466
wandb:           val_recall 0.63415
wandb:        val_precision 0.7027
wandb:               val_f1 0.66667
wandb:              val_auc 0.73755
wandb:                   lr 3e-05
wandb:          best_val_f1 0.7027
wandb:    best_val_accuracy 0.96417
wandb:   best_val_precision 0.78788
wandb:      best_val_recall 0.63415
wandb:             best_auc 0.76168
wandb:           best_epoch 34
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_203334-3ntepvze

-----------------------
model 9
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 2858
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate_69615 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_69615[0][0]              
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-28 22:37:53.736359: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 2858
2021-06-28 22:38:03.836452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 2858
2021-06-28 22:38:13.880663: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2858
2021-06-28 22:38:23.620223: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 2858
2021-06-28 22:38:33.640180: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2478 of 2858
2021-06-28 22:38:41.249312: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
local_gc_exec.sh: line 6: 29955 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2264__06_2020__v39__mixup/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 12 leaked semaphores to clean up at shutdown
  len(cache))
