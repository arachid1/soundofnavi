Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2121
Description:  mod9_newparams
2021-05-10 15:23:57.814879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 15:24:00.406435: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 15:24:00.407350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-10 15:24:00.446291: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:00.447018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 15:24:00.447049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 15:24:00.450422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 15:24:00.450509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 15:24:00.451626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 15:24:00.451945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 15:24:00.452942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 15:24:00.453850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 15:24:00.454037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 15:24:00.454170: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:00.454953: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:00.455932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2121.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2121__05_1522__v29__mod9_newparams/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 5.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2121
wandb: ‚≠êÔ∏è View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: üöÄ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1b6xsnof
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_152400-1b6xsnof
wandb: Run `wandb offline` to turn off syncing.
2021-05-10 15:24:05.788276: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 15:24:05.788542: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:05.789321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 15:24:05.789365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 15:24:05.789423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 15:24:05.789444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 15:24:05.789465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 15:24:05.789486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 15:24:05.789507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 15:24:05.789528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 15:24:05.789548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 15:24:05.789642: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:05.790487: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:05.791162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-10 15:24:05.791206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 15:24:06.530180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-10 15:24:06.530241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-10 15:24:06.530266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-10 15:24:06.530618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:06.531767: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:06.532880: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:24:06.533901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-10 15:24:48.369684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 15:24:49.071267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 15:24:49.080565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/40
263/263 - 537s - loss: 0.7277 - accuracy: 0.5384 - val_loss: 0.6706 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2837819543125045
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
263/263 - 528s - loss: 0.6863 - accuracy: 0.5622 - val_loss: 0.6427 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25224597864552856
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0.05 in 1 epochs
Epoch 3/40
263/263 - 528s - loss: 0.6835 - accuracy: 0.5782 - val_loss: 0.8973 - val_accuracy: 0.3382
Confusion matrix: 
 [[222 648]
 [ 72 146]]
Validation f1: 28.85
Validation accuracy: 33.82
Validation recall: 66.97
Validation precision: 18.39
Validation AUC: 0.17593611606985274
Validation class accuracies: [0.25517241379310346, 0.6697247706422018]
Saving model...
Epoch 4/40
263/263 - 528s - loss: 0.6854 - accuracy: 0.5844 - val_loss: 0.9023 - val_accuracy: 0.7923
Confusion matrix: 
 [[856  14]
 [212   6]]
Validation f1: 5.04
Validation accuracy: 79.23
Validation recall: 2.75
Validation precision: 30.00
Validation AUC: 0.18755477943516857
Validation class accuracies: [0.9839080459770115, 0.027522935779816515]
The validation tracker metric at 0.2885375494071146 hasn't increased by 0.05 in 1 epochs
Epoch 5/40
263/263 - 529s - loss: 0.6822 - accuracy: 0.5958 - val_loss: 0.7096 - val_accuracy: 0.6360
Confusion matrix: 
 [[632 238]
 [158  60]]
Validation f1: 23.26
Validation accuracy: 63.60
Validation recall: 27.52
Validation precision: 20.13
Validation AUC: 0.19623883608482268
Validation class accuracies: [0.7264367816091954, 0.27522935779816515]
The validation tracker metric at 0.2885375494071146 hasn't increased by 0.05 in 2 epochs
Epoch 6/40
263/263 - 527s - loss: 0.6816 - accuracy: 0.5708 - val_loss: 0.6409 - val_accuracy: 0.7960
Confusion matrix: 
 [[865   5]
 [217   1]]
Validation f1: 0.89
Validation accuracy: 79.60
Validation recall: 0.46
Validation precision: 16.67
Validation AUC: 0.2221522868726522
Validation class accuracies: [0.9942528735632183, 0.0045871559633027525]
The validation tracker metric at 0.2885375494071146 hasn't increased by 0.05 in 3 epochs
Epoch 7/40
263/263 - 526s - loss: 0.6795 - accuracy: 0.6001 - val_loss: 0.6743 - val_accuracy: 0.7243
Confusion matrix: 
 [[749 121]
 [179  39]]
Validation f1: 20.63
Validation accuracy: 72.43
Validation recall: 17.89
Validation precision: 24.38
Validation AUC: 0.22592412608408063
Validation class accuracies: [0.860919540229885, 0.17889908256880735]
Lr has been adjusted to 0.000750000006519258
The validation tracker metric at 0.2885375494071146 hasn't increased by 0.05 in 4 epochs
Epoch 8/40
263/263 - 528s - loss: 0.6764 - accuracy: 0.5989 - val_loss: 0.6567 - val_accuracy: 0.7675
Confusion matrix: 
 [[820  50]
 [203  15]]
Validation f1: 10.60
Validation accuracy: 76.75
Validation recall: 6.88
Validation precision: 23.08
Validation AUC: 0.20541656464396987
Validation class accuracies: [0.9425287356321839, 0.06880733944954129]
The validation tracker metric at 0.2885375494071146 hasn't increased by 0.05 in 5 epochs
Epoch 9/40
263/263 - 527s - loss: 0.6736 - accuracy: 0.6108 - val_loss: 0.6693 - val_accuracy: 0.6875
Confusion matrix: 
 [[708 162]
 [178  40]]
Validation f1: 19.05
Validation accuracy: 68.75
Validation recall: 18.35
Validation precision: 19.80
Validation AUC: 0.20385289930634004
Validation class accuracies: [0.8137931034482758, 0.1834862385321101]
The validation tracker metric at 0.2885375494071146 hasn't increased by 0.05 in 6 epochs
Epoch 10/40
263/263 - 527s - loss: 0.6732 - accuracy: 0.6184 - val_loss: 0.6609 - val_accuracy: 0.7399
Confusion matrix: 
 [[786  84]
 [199  19]]
Validation f1: 11.84
Validation accuracy: 73.99
Validation recall: 8.72
Validation precision: 18.45
Validation AUC: 0.2034520191855474
Validation class accuracies: [0.903448275862069, 0.0871559633027523]
The validation tracker metric at 0.2885375494071146 hasn't increased by 0.05 in 7 epochs
Epoch 11/40
263/263 - 528s - loss: 0.6727 - accuracy: 0.6332 - val_loss: 0.6382 - val_accuracy: 0.7739
Confusion matrix: 
 [[832  38]
 [208  10]]
Validation f1: 7.52
Validation accuracy: 77.39
Validation recall: 4.59
Validation precision: 20.83
Validation AUC: 0.2143613992492721
Validation class accuracies: [0.9563218390804598, 0.045871559633027525]
Lr has been adjusted to 0.0005624999757856131
The validation tracker metric at 0.2885375494071146 hasn't increased by 0.05 in 8 epochs
Epoch 12/40
263/263 - 527s - loss: 0.6703 - accuracy: 0.6251 - val_loss: 0.7059 - val_accuracy: 0.4835
Confusion matrix: 
 [[377 493]
 [ 69 149]]
Validation f1: 34.65
Validation accuracy: 48.35
Validation recall: 68.35
Validation precision: 23.21
Validation AUC: 0.22122999495826687
Validation class accuracies: [0.43333333333333335, 0.6834862385321101]
Saving model...
Epoch 13/40
263/263 - 528s - loss: 0.6677 - accuracy: 0.6461 - val_loss: 0.6480 - val_accuracy: 0.7417
Confusion matrix: 
 [[797  73]
 [208  10]]
Validation f1: 6.64
Validation accuracy: 74.17
Validation recall: 4.59
Validation precision: 12.05
Validation AUC: 0.20611441148268286
Validation class accuracies: [0.9160919540229885, 0.045871559633027525]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 1 epochs
Epoch 14/40
263/263 - 528s - loss: 0.6657 - accuracy: 0.6389 - val_loss: 0.7164 - val_accuracy: 0.4779
Confusion matrix: 
 [[422 448]
 [120  98]]
Validation f1: 25.65
Validation accuracy: 47.79
Validation recall: 44.95
Validation precision: 17.95
Validation AUC: 0.1882632196606183
Validation class accuracies: [0.4850574712643678, 0.44954128440366975]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 2 epochs
Epoch 15/40
263/263 - 527s - loss: 0.6635 - accuracy: 0.6532 - val_loss: 0.6521 - val_accuracy: 0.7132
Confusion matrix: 
 [[746 124]
 [188  30]]
Validation f1: 16.13
Validation accuracy: 71.32
Validation recall: 13.76
Validation precision: 19.48
Validation AUC: 0.23245751863852
Validation class accuracies: [0.8574712643678161, 0.13761467889908258]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 3 epochs
Epoch 16/40
263/263 - 527s - loss: 0.6628 - accuracy: 0.6625 - val_loss: 0.6602 - val_accuracy: 0.6820
Confusion matrix: 
 [[700 170]
 [176  42]]
Validation f1: 19.53
Validation accuracy: 68.20
Validation recall: 19.27
Validation precision: 19.81
Validation AUC: 0.21170954362086913
Validation class accuracies: [0.8045977011494253, 0.1926605504587156]
Lr has been adjusted to 0.0004218749818392098
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 4 epochs
Epoch 17/40
263/263 - 528s - loss: 0.6561 - accuracy: 0.6678 - val_loss: 0.6812 - val_accuracy: 0.6149
Confusion matrix: 
 [[601 269]
 [150  68]]
Validation f1: 24.50
Validation accuracy: 61.49
Validation recall: 31.19
Validation precision: 20.18
Validation AUC: 0.20728524279653016
Validation class accuracies: [0.6908045977011494, 0.3119266055045872]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 5 epochs
Epoch 18/40
263/263 - 528s - loss: 0.6544 - accuracy: 0.6809 - val_loss: 0.6815 - val_accuracy: 0.6415
Confusion matrix: 
 [[655 215]
 [175  43]]
Validation f1: 18.07
Validation accuracy: 64.15
Validation recall: 19.72
Validation precision: 16.67
Validation AUC: 0.17766860870767134
Validation class accuracies: [0.7528735632183908, 0.19724770642201836]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 6 epochs
Epoch 19/40
263/263 - 528s - loss: 0.6492 - accuracy: 0.6949 - val_loss: 0.7696 - val_accuracy: 0.4467
Confusion matrix: 
 [[338 532]
 [ 70 148]]
Validation f1: 32.96
Validation accuracy: 44.67
Validation recall: 67.89
Validation precision: 21.76
Validation AUC: 0.19793063938769778
Validation class accuracies: [0.38850574712643676, 0.6788990825688074]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 7 epochs
Epoch 20/40
263/263 - 529s - loss: 0.6447 - accuracy: 0.7092 - val_loss: 0.6877 - val_accuracy: 0.6213
Confusion matrix: 
 [[608 262]
 [150  68]]
Validation f1: 24.82
Validation accuracy: 62.13
Validation recall: 31.19
Validation precision: 20.61
Validation AUC: 0.2075714556988642
Validation class accuracies: [0.6988505747126437, 0.3119266055045872]
Lr has been adjusted to 0.0003164062509313226
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 8 epochs
Epoch 21/40
263/263 - 531s - loss: 0.6374 - accuracy: 0.7326 - val_loss: 0.7277 - val_accuracy: 0.5377
Confusion matrix: 
 [[472 398]
 [105 113]]
Validation f1: 31.00
Validation accuracy: 53.77
Validation recall: 51.83
Validation precision: 22.11
Validation AUC: 0.200847736524572
Validation class accuracies: [0.542528735632184, 0.518348623853211]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 9 epochs
Epoch 22/40
263/263 - 535s - loss: 0.6320 - accuracy: 0.7407 - val_loss: 0.6920 - val_accuracy: 0.6278
Confusion matrix: 
 [[624 246]
 [159  59]]
Validation f1: 22.56
Validation accuracy: 62.78
Validation recall: 27.06
Validation precision: 19.34
Validation AUC: 0.19537938513158087
Validation class accuracies: [0.7172413793103448, 0.2706422018348624]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 10 epochs
Epoch 23/40
263/263 - 535s - loss: 0.6275 - accuracy: 0.7548 - val_loss: 0.7745 - val_accuracy: 0.4825
Confusion matrix: 
 [[381 489]
 [ 74 144]]
Validation f1: 33.84
Validation accuracy: 48.25
Validation recall: 66.06
Validation precision: 22.75
Validation AUC: 0.21327198005278733
Validation class accuracies: [0.4379310344827586, 0.6605504587155964]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 11 epochs
Epoch 24/40
263/263 - 535s - loss: 0.6238 - accuracy: 0.7686 - val_loss: 0.6964 - val_accuracy: 0.6342
Confusion matrix: 
 [[627 243]
 [155  63]]
Validation f1: 24.05
Validation accuracy: 63.42
Validation recall: 28.90
Validation precision: 20.59
Validation AUC: 0.1973204576556036
Validation class accuracies: [0.7206896551724138, 0.2889908256880734]
Lr has been adjusted to 0.00023730468819849193
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 12 epochs
Epoch 25/40
263/263 - 532s - loss: 0.6155 - accuracy: 0.7772 - val_loss: 0.8060 - val_accuracy: 0.4586
Confusion matrix: 
 [[368 502]
 [ 87 131]]
Validation f1: 30.79
Validation accuracy: 45.86
Validation recall: 60.09
Validation precision: 20.70
Validation AUC: 0.21278291861018941
Validation class accuracies: [0.42298850574712643, 0.6009174311926605]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 13 epochs
Epoch 26/40
263/263 - 529s - loss: 0.6082 - accuracy: 0.7919 - val_loss: 0.7429 - val_accuracy: 0.5864
Confusion matrix: 
 [[533 337]
 [113 105]]
Validation f1: 31.82
Validation accuracy: 58.64
Validation recall: 48.17
Validation precision: 23.76
Validation AUC: 0.21832697559953076
Validation class accuracies: [0.6126436781609196, 0.481651376146789]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 14 epochs
Epoch 27/40
263/263 - 529s - loss: 0.6033 - accuracy: 0.8079 - val_loss: 0.7500 - val_accuracy: 0.5276
Confusion matrix: 
 [[478 392]
 [122  96]]
Validation f1: 27.20
Validation accuracy: 52.76
Validation recall: 44.04
Validation precision: 19.67
Validation AUC: 0.20121522823583798
Validation class accuracies: [0.5494252873563218, 0.44036697247706424]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 15 epochs
Epoch 28/40
263/263 - 526s - loss: 0.5974 - accuracy: 0.8239 - val_loss: 0.7431 - val_accuracy: 0.5772
Confusion matrix: 
 [[536 334]
 [126  92]]
Validation f1: 28.57
Validation accuracy: 57.72
Validation recall: 42.20
Validation precision: 21.60
Validation AUC: 0.20548554342467906
Validation class accuracies: [0.6160919540229886, 0.42201834862385323]
Lr has been adjusted to 0.00017797850887291133
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 16 epochs
Epoch 29/40
263/263 - 528s - loss: 0.5887 - accuracy: 0.8365 - val_loss: 0.8082 - val_accuracy: 0.4761
Confusion matrix: 
 [[385 485]
 [ 85 133]]
Validation f1: 31.82
Validation accuracy: 47.61
Validation recall: 61.01
Validation precision: 21.52
Validation AUC: 0.21899713357075629
Validation class accuracies: [0.4425287356321839, 0.6100917431192661]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 17 epochs
Epoch 30/40
263/263 - 528s - loss: 0.5865 - accuracy: 0.8465 - val_loss: 0.7701 - val_accuracy: 0.5579
Confusion matrix: 
 [[515 355]
 [126  92]]
Validation f1: 27.67
Validation accuracy: 55.79
Validation recall: 42.20
Validation precision: 20.58
Validation AUC: 0.20044978810402114
Validation class accuracies: [0.5919540229885057, 0.42201834862385323]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 18 epochs
Epoch 31/40
263/263 - 527s - loss: 0.5831 - accuracy: 0.8565 - val_loss: 0.8502 - val_accuracy: 0.4504
Confusion matrix: 
 [[359 511]
 [ 87 131]]
Validation f1: 30.47
Validation accuracy: 45.04
Validation recall: 60.09
Validation precision: 20.40
Validation AUC: 0.20105261610986863
Validation class accuracies: [0.4126436781609195, 0.6009174311926605]
The validation tracker metric at 0.34651162790697676 hasn't increased by 0.05 in 19 epochs
Epoch 32/40
263/263 - 529s - loss: 0.5791 - accuracy: 0.8651 - val_loss: 0.7494 - val_accuracy: 0.5726
Confusion matrix: 
 [[519 351]
 [114 104]]
Validation f1: 30.91
Validation accuracy: 57.26
Validation recall: 47.71
Validation precision: 22.86
Validation AUC: 0.21128049297615953
Validation class accuracies: [0.596551724137931, 0.47706422018348627]

The metrics for the epoch with the best target metric are: 
Best cm: [[377 493]
 [ 69 149]]
Best f1: 0.34651162790697676
Best accuracy: 0.4834558823529412
Best recall: 0.6834862385321101
Best precision: 0.23208722741433022
Best AUC: 0.22122999495826687
Best epoch: 12
Lr has been adjusted to 0.00013348387437872589
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 12
Starting...
CM: [[ 3 57]
 [ 0 15]]
F1: 0.3448275862068966
Accuracy: 0.24
Precision: 0.20833333333333334
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2121__05_1522__v29__mod9_newparams/validation_sheet_12.xls...
Done.
Epoch: 3
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2121__05_1522__v29__mod9_newparams/validation_sheet_3.xls...
Done.
Epoch: 40
Starting...
CM: [[ 4 56]
 [ 2 13]]
F1: 0.30952380952380953
Accuracy: 0.22666666666666666
Precision: 0.18840579710144928
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2121__05_1522__v29__mod9_newparams/validation_sheet_40.xls...
Done.
wandb: Waiting for W&B process to finish, PID 1857
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_152400-1b6xsnof/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_152400-1b6xsnof/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.86511
wandb:         val_accuracy 0.57261
wandb:             _runtime 17685
wandb:           _timestamp 1620677925
wandb:                _step 225
wandb:           train_loss 0.57909
wandb:             val_loss 0.7494
wandb:           val_recall 0.47706
wandb:        val_precision 0.22857
wandb:               val_f1 0.30906
wandb:              val_auc 0.21128
wandb:                   lr 0.00018
wandb:          best_val_f1 0.34651
wandb:    best_val_accuracy 0.48346
wandb:   best_val_precision 0.23209
wandb:      best_val_recall 0.68349
wandb:             best_auc 0.22123
wandb:           best_epoch 12
wandb:           best_bd_f1 0.34483
wandb:     best_bd_accuracy 0.24
wandb:    best_bd_precision 0.20833
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 12
wandb: Run history:
wandb:   train_accuracy ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:     val_accuracy ‚ñà‚ñà‚ñÅ‚ñà‚ñÜ‚ñà‚ñá‚ñà‚ñÜ‚ñá‚ñà‚ñÉ‚ñá‚ñÉ‚ñá‚ñÜ‚ñÖ‚ñÜ‚ñÉ‚ñÖ‚ñÑ‚ñÖ‚ñÉ‚ñÖ‚ñÉ‚ñÖ‚ñÑ‚ñÖ‚ñÉ‚ñÑ‚ñÉ‚ñÖ
wandb:         _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:       _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:            _step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:       train_loss ‚ñà‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:         val_loss ‚ñÇ‚ñÅ‚ñà‚ñà‚ñÉ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÉ‚ñÅ‚ñÉ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÑ‚ñÇ‚ñÉ‚ñÇ‚ñÖ‚ñÉ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÜ‚ñÑ‚ñá‚ñÑ
wandb:       val_recall ‚ñÅ‚ñÅ‚ñà‚ñÅ‚ñÑ‚ñÅ‚ñÉ‚ñÇ‚ñÉ‚ñÇ‚ñÅ‚ñà‚ñÅ‚ñÜ‚ñÇ‚ñÉ‚ñÑ‚ñÉ‚ñà‚ñÑ‚ñÜ‚ñÑ‚ñà‚ñÑ‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñá‚ñÖ‚ñá‚ñÜ
wandb:    val_precision ‚ñÅ‚ñÅ‚ñÖ‚ñà‚ñÜ‚ñÖ‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ
wandb:           val_f1 ‚ñÅ‚ñÅ‚ñá‚ñÇ‚ñÜ‚ñÅ‚ñÖ‚ñÉ‚ñÖ‚ñÉ‚ñÉ‚ñà‚ñÇ‚ñÜ‚ñÑ‚ñÖ‚ñÜ‚ñÖ‚ñà‚ñÜ‚ñá‚ñÜ‚ñà‚ñÜ‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:          val_auc ‚ñà‚ñÜ‚ñÅ‚ñÇ‚ñÇ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÇ‚ñÖ‚ñÉ‚ñÉ‚ñÅ‚ñÇ‚ñÉ‚ñÉ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÑ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÉ‚ñÉ
wandb:               lr ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Synced 6 W&B file(s), 2 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2121: https://wandb.ai/arachid1/tensorboard-integration/runs/1b6xsnof


 See logs at ../../new_cache/conv__2121__05_1522__v29__mod9_newparams/logs/