Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v32_augm_v0_cleaned_8000.pkl
File:  conv.train2162
Description:  v32_oversample
2021-05-26 20:40:28.642154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 20:40:30.940996: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-26 20:40:30.942145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-26 20:40:30.981547: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:30.982347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-26 20:40:30.982380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 20:40:30.986478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 20:40:30.986579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 20:40:30.987866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-26 20:40:30.988248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-26 20:40:30.989432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-26 20:40:30.990393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-26 20:40:30.990564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-26 20:40:30.990684: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:30.991535: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:30.992295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2162.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v32_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2162__05_2040__v32__v32_oversample/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2162
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/26yqvqby
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_204031-26yqvqby
wandb: Run `wandb offline` to turn off syncing.
2021-05-26 20:40:36.049793: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-26 20:40:36.050056: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:36.050783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-26 20:40:36.050829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 20:40:36.050894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 20:40:36.050918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 20:40:36.050941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-26 20:40:36.050963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-26 20:40:36.050985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-26 20:40:36.051007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-26 20:40:36.051029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-26 20:40:36.051124: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:36.051873: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:36.052575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-26 20:40:36.052625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 20:40:36.789453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-26 20:40:36.789500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-26 20:40:36.789509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-26 20:40:36.789823: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:36.790631: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:36.791392: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:40:36.792188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-26 20:41:12.066113: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-26 20:41:12.068017: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-26 20:41:15.203265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 20:41:15.932748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 20:41:15.943792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
1150
3015
6030
With concat = False and six = False, size of training set: 6030...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/80
377/377 - 720s - loss: 0.7888 - accuracy: 0.5279 - val_loss: 0.5047 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25010936703458486
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/80
377/377 - 708s - loss: 0.6869 - accuracy: 0.5423 - val_loss: 0.5513 - val_accuracy: 0.7748
Confusion matrix: 
 [[831  39]
 [206  12]]
Validation f1: 8.92
Validation accuracy: 77.48
Validation recall: 5.50
Validation precision: 23.53
Validation AUC: 0.23146937706222115
Validation class accuracies: [0.9551724137931035, 0.05504587155963303]
TARGET: 1
target metric(test f1): 0.08921933085501858
inside not defaulting
Saving model...
Epoch 3/80
377/377 - 709s - loss: 0.6863 - accuracy: 0.5594 - val_loss: 0.6559 - val_accuracy: 0.6121
Confusion matrix: 
 [[574 296]
 [126  92]]
Validation f1: 30.36
Validation accuracy: 61.21
Validation recall: 42.20
Validation precision: 23.71
Validation AUC: 0.22570935125991168
Validation class accuracies: [0.6597701149425287, 0.42201834862385323]
TARGET: 1
target metric(test f1): 0.30363036303630364
inside not defaulting
Saving model...
Epoch 4/80
377/377 - 711s - loss: 0.6777 - accuracy: 0.5723 - val_loss: 0.6255 - val_accuracy: 0.7767
Confusion matrix: 
 [[828  42]
 [201  17]]
Validation f1: 12.27
Validation accuracy: 77.67
Validation recall: 7.80
Validation precision: 28.81
Validation AUC: 0.21284133687533002
Validation class accuracies: [0.9517241379310345, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.12274368231046932
inside not defaulting
The validation tracker metric at 0.30363036303630364 hasn't increased by 0 in 1 epochs
Epoch 5/80
377/377 - 709s - loss: 0.6739 - accuracy: 0.5814 - val_loss: 0.6202 - val_accuracy: 0.7224
Confusion matrix: 
 [[740 130]
 [172  46]]
Validation f1: 23.35
Validation accuracy: 72.24
Validation recall: 21.10
Validation precision: 26.14
Validation AUC: 0.23213156248059816
Validation class accuracies: [0.8505747126436781, 0.21100917431192662]
TARGET: 1
target metric(test f1): 0.233502538071066
inside not defaulting
The validation tracker metric at 0.30363036303630364 hasn't increased by 0 in 2 epochs
Epoch 6/80
377/377 - 708s - loss: 0.6641 - accuracy: 0.5892 - val_loss: 0.6839 - val_accuracy: 0.5680
Confusion matrix: 
 [[522 348]
 [122  96]]
Validation f1: 29.00
Validation accuracy: 56.80
Validation recall: 44.04
Validation precision: 21.62
Validation AUC: 0.2135790863914618
Validation class accuracies: [0.6, 0.44036697247706424]
TARGET: 1
target metric(test f1): 0.29003021148036257
inside not defaulting
The validation tracker metric at 0.30363036303630364 hasn't increased by 0 in 3 epochs
Epoch 7/80
377/377 - 708s - loss: 0.6596 - accuracy: 0.5940 - val_loss: 0.5830 - val_accuracy: 0.7757
Confusion matrix: 
 [[840  30]
 [214   4]]
Validation f1: 3.17
Validation accuracy: 77.57
Validation recall: 1.83
Validation precision: 11.76
Validation AUC: 0.18232283698825086
Validation class accuracies: [0.9655172413793104, 0.01834862385321101]
TARGET: 1
target metric(test f1): 0.031746031746031744
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.30363036303630364 hasn't increased by 0 in 4 epochs
Epoch 8/80
377/377 - 708s - loss: 0.6323 - accuracy: 0.6322 - val_loss: 0.8797 - val_accuracy: 0.3373
Confusion matrix: 
 [[201 669]
 [ 52 166]]
Validation f1: 31.53
Validation accuracy: 33.73
Validation recall: 76.15
Validation precision: 19.88
Validation AUC: 0.1924523482841893
Validation class accuracies: [0.23103448275862068, 0.7614678899082569]
TARGET: 1
target metric(test f1): 0.315289648622982
inside not defaulting
Saving model...
Epoch 9/80
377/377 - 708s - loss: 0.6095 - accuracy: 0.6567 - val_loss: 1.2272 - val_accuracy: 0.3235
Confusion matrix: 
 [[166 704]
 [ 32 186]]
Validation f1: 33.57
Validation accuracy: 32.35
Validation recall: 85.32
Validation precision: 20.90
Validation AUC: 0.23362824646518354
Validation class accuracies: [0.19080459770114944, 0.8532110091743119]
TARGET: 1
target metric(test f1): 0.335740072202166
inside not defaulting
Saving model...
Epoch 10/80
377/377 - 709s - loss: 0.5852 - accuracy: 0.6818 - val_loss: 0.9887 - val_accuracy: 0.3309
Confusion matrix: 
 [[206 664]
 [ 64 154]]
Validation f1: 29.73
Validation accuracy: 33.09
Validation recall: 70.64
Validation precision: 18.83
Validation AUC: 0.18670417602275546
Validation class accuracies: [0.2367816091954023, 0.7064220183486238]
TARGET: 1
target metric(test f1): 0.2972972972972973
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 1 epochs
Epoch 11/80
377/377 - 709s - loss: 0.5474 - accuracy: 0.7161 - val_loss: 1.0121 - val_accuracy: 0.3934
Confusion matrix: 
 [[330 540]
 [120  98]]
Validation f1: 22.90
Validation accuracy: 39.34
Validation recall: 44.95
Validation precision: 15.36
Validation AUC: 0.16144629741313477
Validation class accuracies: [0.3793103448275862, 0.44954128440366975]
TARGET: 1
target metric(test f1): 0.22897196261682243
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 2 epochs
Epoch 12/80
377/377 - 709s - loss: 0.5071 - accuracy: 0.7401 - val_loss: 0.7908 - val_accuracy: 0.6232
Confusion matrix: 
 [[643 227]
 [183  35]]
Validation f1: 14.58
Validation accuracy: 62.32
Validation recall: 16.06
Validation precision: 13.36
Validation AUC: 0.1645578639017489
Validation class accuracies: [0.7390804597701149, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.14583333333333334
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 3 epochs
Epoch 13/80
377/377 - 710s - loss: 0.4635 - accuracy: 0.7728 - val_loss: 0.9632 - val_accuracy: 0.4614
Confusion matrix: 
 [[381 489]
 [ 97 121]]
Validation f1: 29.23
Validation accuracy: 46.14
Validation recall: 55.50
Validation precision: 19.84
Validation AUC: 0.21062493832072007
Validation class accuracies: [0.4379310344827586, 0.555045871559633]
TARGET: 1
target metric(test f1): 0.2922705314009662
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 4 epochs
Epoch 14/80
377/377 - 710s - loss: 0.3886 - accuracy: 0.8202 - val_loss: 1.0591 - val_accuracy: 0.5037
Confusion matrix: 
 [[469 401]
 [139  79]]
Validation f1: 22.64
Validation accuracy: 50.37
Validation recall: 36.24
Validation precision: 16.46
Validation AUC: 0.18360880093189075
Validation class accuracies: [0.539080459770115, 0.3623853211009174]
TARGET: 1
target metric(test f1): 0.2263610315186246
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 5 epochs
Epoch 15/80
377/377 - 709s - loss: 0.3646 - accuracy: 0.8391 - val_loss: 1.0559 - val_accuracy: 0.5129
Confusion matrix: 
 [[480 390]
 [140  78]]
Validation f1: 22.74
Validation accuracy: 51.29
Validation recall: 35.78
Validation precision: 16.67
Validation AUC: 0.19261435023596998
Validation class accuracies: [0.5517241379310345, 0.3577981651376147]
TARGET: 1
target metric(test f1): 0.22740524781341107
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 6 epochs
Epoch 16/80
377/377 - 709s - loss: 0.3509 - accuracy: 0.8401 - val_loss: 1.1530 - val_accuracy: 0.5046
Confusion matrix: 
 [[467 403]
 [136  82]]
Validation f1: 23.33
Validation accuracy: 50.46
Validation recall: 37.61
Validation precision: 16.91
Validation AUC: 0.18784434913491493
Validation class accuracies: [0.5367816091954023, 0.3761467889908257]
TARGET: 1
target metric(test f1): 0.23328591749644384
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 7 epochs
Epoch 17/80
377/377 - 708s - loss: 0.3373 - accuracy: 0.8489 - val_loss: 1.1606 - val_accuracy: 0.5211
Confusion matrix: 
 [[486 384]
 [137  81]]
Validation f1: 23.72
Validation accuracy: 52.11
Validation recall: 37.16
Validation precision: 17.42
Validation AUC: 0.19619270063226335
Validation class accuracies: [0.5586206896551724, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.23718887262079064
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 8 epochs
Epoch 18/80
377/377 - 709s - loss: 0.3147 - accuracy: 0.8566 - val_loss: 1.1653 - val_accuracy: 0.5156
Confusion matrix: 
 [[477 393]
 [134  84]]
Validation f1: 24.17
Validation accuracy: 51.56
Validation recall: 38.53
Validation precision: 17.61
Validation AUC: 0.19120316406859464
Validation class accuracies: [0.5482758620689655, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.24172661870503595
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 9 epochs
Epoch 19/80
377/377 - 709s - loss: 0.3049 - accuracy: 0.8660 - val_loss: 1.1390 - val_accuracy: 0.5276
Confusion matrix: 
 [[493 377]
 [137  81]]
Validation f1: 23.96
Validation accuracy: 52.76
Validation recall: 37.16
Validation precision: 17.69
Validation AUC: 0.19702411887666288
Validation class accuracies: [0.5666666666666667, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.23964497041420119
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 10 epochs
Epoch 20/80
377/377 - 707s - loss: 0.2898 - accuracy: 0.8698 - val_loss: 1.1698 - val_accuracy: 0.5340
Confusion matrix: 
 [[500 370]
 [137  81]]
Validation f1: 24.22
Validation accuracy: 53.40
Validation recall: 37.16
Validation precision: 17.96
Validation AUC: 0.19002919891718414
Validation class accuracies: [0.5747126436781609, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.242152466367713
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 11 epochs
Epoch 21/80
377/377 - 709s - loss: 0.2928 - accuracy: 0.8723 - val_loss: 1.1557 - val_accuracy: 0.5377
Confusion matrix: 
 [[515 355]
 [148  70]]
Validation f1: 21.77
Validation accuracy: 53.77
Validation recall: 32.11
Validation precision: 16.47
Validation AUC: 0.1913419407508737
Validation class accuracies: [0.5919540229885057, 0.3211009174311927]
TARGET: 1
target metric(test f1): 0.21772939346811818
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 12 epochs
Epoch 22/80
377/377 - 710s - loss: 0.3006 - accuracy: 0.8682 - val_loss: 1.1774 - val_accuracy: 0.5303
Confusion matrix: 
 [[501 369]
 [142  76]]
Validation f1: 22.93
Validation accuracy: 53.03
Validation recall: 34.86
Validation precision: 17.08
Validation AUC: 0.19200465900870592
Validation class accuracies: [0.5758620689655173, 0.3486238532110092]
TARGET: 1
target metric(test f1): 0.2292609351432881
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 13 epochs
Epoch 23/80
377/377 - 708s - loss: 0.2944 - accuracy: 0.8706 - val_loss: 1.1599 - val_accuracy: 0.5450
Confusion matrix: 
 [[519 351]
 [144  74]]
Validation f1: 23.02
Validation accuracy: 54.50
Validation recall: 33.94
Validation precision: 17.41
Validation AUC: 0.19352738289068505
Validation class accuracies: [0.596551724137931, 0.3394495412844037]
TARGET: 1
target metric(test f1): 0.23017107309486778
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 14 epochs
Epoch 24/80
377/377 - 708s - loss: 0.2880 - accuracy: 0.8685 - val_loss: 1.2137 - val_accuracy: 0.5129
Confusion matrix: 
 [[476 394]
 [136  82]]
Validation f1: 23.63
Validation accuracy: 51.29
Validation recall: 37.61
Validation precision: 17.23
Validation AUC: 0.19309602077683172
Validation class accuracies: [0.5471264367816092, 0.3761467889908257]
TARGET: 1
target metric(test f1): 0.23631123919308356
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 15 epochs
Epoch 25/80
377/377 - 709s - loss: 0.2852 - accuracy: 0.8755 - val_loss: 1.1900 - val_accuracy: 0.5358
Confusion matrix: 
 [[503 367]
 [138  80]]
Validation f1: 24.06
Validation accuracy: 53.58
Validation recall: 36.70
Validation precision: 17.90
Validation AUC: 0.19432885498961822
Validation class accuracies: [0.5781609195402299, 0.3669724770642202]
TARGET: 1
target metric(test f1): 0.2406015037593985
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 16 epochs
Epoch 26/80
377/377 - 708s - loss: 0.2963 - accuracy: 0.8687 - val_loss: 1.1868 - val_accuracy: 0.5294
Confusion matrix: 
 [[495 375]
 [137  81]]
Validation f1: 24.04
Validation accuracy: 52.94
Validation recall: 37.16
Validation precision: 17.76
Validation AUC: 0.19527295677295026
Validation class accuracies: [0.5689655172413793, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.2403560830860534
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 17 epochs
Epoch 27/80
377/377 - 709s - loss: 0.2871 - accuracy: 0.8760 - val_loss: 1.1922 - val_accuracy: 0.5303
Confusion matrix: 
 [[499 371]
 [140  78]]
Validation f1: 23.39
Validation accuracy: 53.03
Validation recall: 35.78
Validation precision: 17.37
Validation AUC: 0.1935837486203834
Validation class accuracies: [0.5735632183908046, 0.3577981651376147]
TARGET: 1
target metric(test f1): 0.23388305847076463
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 18 epochs
Epoch 28/80
377/377 - 708s - loss: 0.2835 - accuracy: 0.8765 - val_loss: 1.1814 - val_accuracy: 0.5294
Confusion matrix: 
 [[499 371]
 [141  77]]
Validation f1: 23.12
Validation accuracy: 52.94
Validation recall: 35.32
Validation precision: 17.19
Validation AUC: 0.19326018717336269
Validation class accuracies: [0.5735632183908046, 0.3532110091743119]
TARGET: 1
target metric(test f1): 0.23123123123123124
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 19 epochs
Epoch 29/80
377/377 - 709s - loss: 0.2891 - accuracy: 0.8750 - val_loss: 1.2111 - val_accuracy: 0.5156
Confusion matrix: 
 [[481 389]
 [138  80]]
Validation f1: 23.29
Validation accuracy: 51.56
Validation recall: 36.70
Validation precision: 17.06
Validation AUC: 0.19237544726962408
Validation class accuracies: [0.5528735632183908, 0.3669724770642202]
TARGET: 1
target metric(test f1): 0.23289665211062593
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 20 epochs
Epoch 30/80
377/377 - 710s - loss: 0.2830 - accuracy: 0.8721 - val_loss: 1.1793 - val_accuracy: 0.5294
Confusion matrix: 
 [[499 371]
 [141  77]]
Validation f1: 23.12
Validation accuracy: 52.94
Validation recall: 35.32
Validation precision: 17.19
Validation AUC: 0.19411274002004292
Validation class accuracies: [0.5735632183908046, 0.3532110091743119]
TARGET: 1
target metric(test f1): 0.23123123123123124
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 21 epochs
Epoch 31/80
377/377 - 709s - loss: 0.2909 - accuracy: 0.8705 - val_loss: 1.2101 - val_accuracy: 0.5257
Confusion matrix: 
 [[490 380]
 [136  82]]
Validation f1: 24.12
Validation accuracy: 52.57
Validation recall: 37.61
Validation precision: 17.75
Validation AUC: 0.19299720082415472
Validation class accuracies: [0.5632183908045977, 0.3761467889908257]
TARGET: 1
target metric(test f1): 0.2411764705882353
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 22 epochs
Epoch 32/80
377/377 - 708s - loss: 0.2897 - accuracy: 0.8713 - val_loss: 1.1791 - val_accuracy: 0.5331
Confusion matrix: 
 [[504 366]
 [142  76]]
Validation f1: 23.03
Validation accuracy: 53.31
Validation recall: 34.86
Validation precision: 17.19
Validation AUC: 0.19334005277960836
Validation class accuracies: [0.5793103448275863, 0.3486238532110092]
TARGET: 1
target metric(test f1): 0.23030303030303031
inside not defaulting
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 23 epochs
Epoch 33/80
377/377 - 708s - loss: 0.2917 - accuracy: 0.8730 - val_loss: 1.1903 - val_accuracy: 0.5257
Confusion matrix: 
 [[492 378]
 [138  80]]
Validation f1: 23.67
Validation accuracy: 52.57
Validation recall: 36.70
Validation precision: 17.47
Validation AUC: 0.19344115681215374
Validation class accuracies: [0.5655172413793104, 0.3669724770642202]
TARGET: 1
target metric(test f1): 0.2366863905325444
inside not defaulting
Lr has been adjusted to 6.103515914901436e-08
The validation tracker metric at 0.335740072202166 hasn't increased by 0 in 24 epochs
Epoch 34/80
377/377 - 709s - loss: 0.2894 - accuracy: 0.8778 - val_loss: 1.1802 - val_accuracy: 0.5349
Confusion matrix: 
 [[506 364]
 [142  76]]
Validation f1: 23.10
Validation accuracy: 53.49
Validation recall: 34.86
Validation precision: 17.27
Validation AUC: 0.1940456613246464
Validation class accuracies: [0.5816091954022988, 0.3486238532110092]

The metrics for the epoch with the best target metric are: 
Best cm: [[166 704]
 [ 32 186]]
Best f1: 0.335740072202166
Best accuracy: 0.3235294117647059
Best recall: 0.8532110091743119
Best precision: 0.20898876404494382
Best AUC: 0.23362824646518354
Best epoch: 9
TARGET: 1
target metric(test f1): 0.23100303951367782
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[ 4 56]
 [ 2 13]]
F1: 0.30952380952380953
AUC: 0.5408695652173913
Accuracy: 0.22666666666666666
Precision: 0.18840579710144928
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[16 44]
 [ 7  8]]
F1: 0.23880597014925373
AUC: 0.3902564102564102
Accuracy: 0.32
Precision: 0.15384615384615385
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[24 36]
 [ 9  6]]
F1: 0.21052631578947364
AUC: 0.3314285714285714
Accuracy: 0.4
Precision: 0.14285714285714285
Recall: 0.4
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_80.xls...
Done.
Epoch: epoch2
Starting...
CM: [[49 11]
 [ 8  7]]
F1: 0.42424242424242425
AUC: 0.4811111111111111
Accuracy: 0.7466666666666667
Precision: 0.3888888888888889
Recall: 0.4666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch2.xls...
Done.
Epoch: epoch2
Starting...
CM: [[58  2]
 [15  0]]
F1: 0.0
AUC: 0.1
Accuracy: 0.7733333333333333
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch2.xls...
Done.
Epoch: epoch2
Starting...
CM: [[60  0]
 [15  0]]
F1: 0.0
AUC: 0.6
Accuracy: 0.8
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch2.xls...
Done.
Epoch: epoch3
Starting...
CM: [[10 50]
 [ 2 13]]
F1: 0.3333333333333333
AUC: 0.5498412698412698
Accuracy: 0.30666666666666664
Precision: 0.20634920634920634
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[27 33]
 [ 5 10]]
F1: 0.3448275862068966
AUC: 0.4829457364341085
Accuracy: 0.49333333333333335
Precision: 0.23255813953488372
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[34 26]
 [ 6  9]]
F1: 0.36
AUC: 0.4685714285714285
Accuracy: 0.5733333333333334
Precision: 0.2571428571428571
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch3.xls...
Done.
Epoch: epoch8
Starting...
CM: [[ 0 60]
 [ 1 14]]
F1: 0.3146067415730337
AUC: 0.5679279279279279
Accuracy: 0.18666666666666668
Precision: 0.1891891891891892
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch8.xls...
Done.
Epoch: epoch8
Starting...
CM: [[ 1 59]
 [ 1 14]]
F1: 0.3181818181818181
AUC: 0.5692237442922373
Accuracy: 0.2
Precision: 0.1917808219178082
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch8.xls...
Done.
Epoch: epoch8
Starting...
CM: [[ 5 55]
 [ 1 14]]
F1: 0.33333333333333337
AUC: 0.5747826086956522
Accuracy: 0.25333333333333335
Precision: 0.2028985507246377
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch8.xls...
Done.
Epoch: epoch9
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch9.xls...
Done.
Epoch: epoch9
Starting...
CM: [[ 1 59]
 [ 0 15]]
F1: 0.3370786516853933
AUC: 0.6013513513513513
Accuracy: 0.21333333333333335
Precision: 0.20270270270270271
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch9.xls...
Done.
Epoch: epoch9
Starting...
CM: [[ 6 54]
 [ 0 15]]
F1: 0.3571428571428571
AUC: 0.6086956521739131
Accuracy: 0.28
Precision: 0.21739130434782608
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2162__05_2040__v32__v32_oversample/validation_sheet_epoch9.xls...
Done.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
wandb: Waiting for W&B process to finish, PID 4464
wandb: Program ended successfully.
wandb: - 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: \ 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: | 0.08MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: - 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: | 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_204031-26yqvqby/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_204031-26yqvqby/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.87778
wandb:         val_accuracy 0.53493
wandb:             _runtime 25219
wandb:           _timestamp 1622086850
wandb:                _step 251
wandb:           train_loss 0.28942
wandb:             val_loss 1.18017
wandb:           val_recall 0.34862
wandb:        val_precision 0.17273
wandb:               val_f1 0.231
wandb:              val_auc 0.19405
wandb:                   lr 0.0
wandb:          best_val_f1 0.33574
wandb:    best_val_accuracy 0.32353
wandb:   best_val_precision 0.20899
wandb:      best_val_recall 0.85321
wandb:             best_auc 0.23363
wandb:           best_epoch 9
wandb:           best_bd_f1 0.42424
wandb:          best_bd_auc 0.48111
wandb:     best_bd_accuracy 0.74667
wandb:    best_bd_precision 0.38889
wandb:       best_bd_recall 0.46667
wandb:        best_bd_epoch epoch2
wandb: Run history:
wandb:   train_accuracy ▁▁▂▂▂▂▂▃▄▄▅▅▆▇▇▇▇█████████████████
wandb:     val_accuracy ██▅█▇▅█▁▁▁▂▅▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▆▆▆▆▆▆▅▅▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▂▂▂▃▂▅█▆▆▄▅▆▆▇▇▇▇▇▇█▇███████████
wandb:       val_recall ▁▁▄▂▃▅▁▇█▇▅▂▆▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:    val_precision ▁▇▇█▇▆▄▆▆▆▅▄▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_f1 ▁▃▇▄▆▇▂██▇▆▄▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          val_auc █▇▆▅▇▅▃▃▇▃▁▁▅▃▃▃▄▃▄▃▃▃▄▃▄▄▄▄▃▄▃▄▄▄
wandb:               lr ███████▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 14 media file(s), 10 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2162: https://wandb.ai/arachid1/tensorboard-integration/runs/26yqvqby


 See logs at ../../new_cache/conv__2162__05_2040__v32__v32_oversample/logs/