Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2040
Description:  mixednet_new
2021-04-07 00:48:22.720714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 00:48:28.824224: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-07 00:48:28.827980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-07 00:48:28.929229: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:28.930318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-07 00:48:28.930450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 00:48:28.998632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 00:48:28.998891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 00:48:29.060263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-07 00:48:29.082424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-07 00:48:29.091418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-07 00:48:29.102957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-07 00:48:29.106283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 00:48:29.106592: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:29.107896: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:29.108941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-07 00:48:29.114413: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-07 00:48:29.114713: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:29.115735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-07 00:48:29.115785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 00:48:29.115855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 00:48:29.115877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 00:48:29.115908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-07 00:48:29.115929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-07 00:48:29.115965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-07 00:48:29.115985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-07 00:48:29.116005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 00:48:29.116123: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:29.117180: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:29.118144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-07 00:48:29.118918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 00:48:31.651926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-07 00:48:31.651975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-07 00:48:31.651983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-07 00:48:31.652332: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:31.653243: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:31.654050: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 00:48:31.654855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-04-07 00:48:32.387735: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-07 00:48:32.387802: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-07 00:48:32.389075: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-07 00:48:32.390112: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-07 00:48:32.406374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-07 00:48:32.656717: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-07 00:48:32.659917: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-07 00:48:33.815572: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-07 00:48:33.818671: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-07 00:48:36.605727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 00:48:40.276498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 00:48:40.309735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 00:48:52.183736: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-07 00:48:52.183812: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-07 00:48:53.351512: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-07 00:48:53.355653: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-07 00:48:53.426980: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 609 callback api events and 605 activity events. 
2021-04-07 00:48:53.460291: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2040.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_0047___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___mixednet_new___2040/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 128, 1250, 12)     336       
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 625, 12)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 64, 625, 12)       48        
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 64, 625, 16)       1744      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 64, 625, 16)       2320      
_________________________________________________________________
average_pooling2d_2 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 32, 313, 32)       9248      
_________________________________________________________________
average_pooling2d_3 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 157, 64)       36928     
_________________________________________________________________
average_pooling2d_4 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 8, 79, 128)        147584    
_________________________________________________________________
average_pooling2d_5 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 258       
=================================================================
Total params: 302,718
Trainable params: 302,214
Non-trainable params: 504
_________________________________________________________________
Epoch 1/40
872/872 - 380s - loss: 0.3151 - calc_accuracy: 0.6620 - val_loss: 0.3980 - val_calc_accuracy: 0.6936
Epoch 2/40
872/872 - 336s - loss: 0.2572 - calc_accuracy: 0.7327 - val_loss: 0.3274 - val_calc_accuracy: 0.7627
Epoch 3/40
872/872 - 335s - loss: 0.2380 - calc_accuracy: 0.7534 - val_loss: 0.3313 - val_calc_accuracy: 0.7660
Epoch 4/40
872/872 - 336s - loss: 0.2189 - calc_accuracy: 0.7703 - val_loss: 0.2795 - val_calc_accuracy: 0.7950
Epoch 5/40
872/872 - 336s - loss: 0.2050 - calc_accuracy: 0.7881 - val_loss: 0.2655 - val_calc_accuracy: 0.7951
Epoch 6/40
872/872 - 356s - loss: 0.1878 - calc_accuracy: 0.8082 - val_loss: 0.2234 - val_calc_accuracy: 0.8442
Epoch 7/40
872/872 - 342s - loss: 0.1657 - calc_accuracy: 0.8320 - val_loss: 0.2520 - val_calc_accuracy: 0.8204
Epoch 8/40
872/872 - 337s - loss: 0.1530 - calc_accuracy: 0.8430 - val_loss: 0.2287 - val_calc_accuracy: 0.8439
Epoch 9/40
872/872 - 336s - loss: 0.1405 - calc_accuracy: 0.8601 - val_loss: 0.2109 - val_calc_accuracy: 0.8467
Epoch 10/40
872/872 - 337s - loss: 0.1304 - calc_accuracy: 0.8713 - val_loss: 0.2283 - val_calc_accuracy: 0.8388
Epoch 11/40
872/872 - 335s - loss: 0.1218 - calc_accuracy: 0.8757 - val_loss: 0.2322 - val_calc_accuracy: 0.8392
Epoch 12/40
872/872 - 360s - loss: 0.1106 - calc_accuracy: 0.8906 - val_loss: 0.2089 - val_calc_accuracy: 0.8538
Epoch 13/40
872/872 - 336s - loss: 0.1053 - calc_accuracy: 0.8954 - val_loss: 0.1738 - val_calc_accuracy: 0.8876
Epoch 14/40
872/872 - 341s - loss: 0.0922 - calc_accuracy: 0.9102 - val_loss: 0.2108 - val_calc_accuracy: 0.8686
Epoch 15/40
872/872 - 340s - loss: 0.0867 - calc_accuracy: 0.9100 - val_loss: 0.1666 - val_calc_accuracy: 0.8905
Epoch 16/40
872/872 - 341s - loss: 0.0815 - calc_accuracy: 0.9177 - val_loss: 0.1864 - val_calc_accuracy: 0.8827
Epoch 17/40
872/872 - 341s - loss: 0.0699 - calc_accuracy: 0.9299 - val_loss: 0.2004 - val_calc_accuracy: 0.8738
Epoch 18/40
872/872 - 383s - loss: 0.0634 - calc_accuracy: 0.9358 - val_loss: 0.1834 - val_calc_accuracy: 0.8913
Epoch 19/40
872/872 - 346s - loss: 0.0572 - calc_accuracy: 0.9442 - val_loss: 0.1896 - val_calc_accuracy: 0.8938
Epoch 20/40
872/872 - 341s - loss: 0.0540 - calc_accuracy: 0.9452 - val_loss: 0.1795 - val_calc_accuracy: 0.8884
Epoch 21/40
872/872 - 343s - loss: 0.0484 - calc_accuracy: 0.9514 - val_loss: 0.2487 - val_calc_accuracy: 0.8701
Epoch 22/40
872/872 - 355s - loss: 0.0469 - calc_accuracy: 0.9519 - val_loss: 0.1965 - val_calc_accuracy: 0.8893

Epoch 00022: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 00022: early stopping

 See logs at ../../cache/conv___04_0047___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___mixednet_new___2040/logs/