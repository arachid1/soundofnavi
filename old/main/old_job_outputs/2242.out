Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2242
Description:  augmented_icbhi_and_jordan
2021-06-23 00:21:53.698813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-23 00:21:55.843047: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 00:21:55.843910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-23 00:21:55.890999: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:21:55.891673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 00:21:55.891699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 00:21:55.896733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 00:21:55.896818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 00:21:55.897956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 00:21:55.898269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 00:21:55.899359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 00:21:55.900279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 00:21:55.901884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 00:21:55.902005: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:21:55.902711: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:21:55.903352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2242.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2242__06_0000__v39__augmented_icbhi_and_jordan
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 300, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-23 00:22:00.530048: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 00:22:00.530292: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:22:00.531056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 00:22:00.531104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 00:22:00.531167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 00:22:00.531196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 00:22:00.531227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 00:22:00.531269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 00:22:00.531296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 00:22:00.531322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 00:22:00.531346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 00:22:00.531454: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:22:00.532179: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:22:00.532842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-23 00:22:00.532893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 00:22:01.230645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-23 00:22:01.230691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-23 00:22:01.230700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-23 00:22:01.230970: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:22:01.231749: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:22:01.232500: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:22:01.233275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2614
-----------------------
Number of train recordings: 2614 with pneumonia: 314 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3214
-----------------------
Number of train recordings: 3214 with pneumonia: 314 and non-pneumonia: 2900
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-23 00:22:02.483780: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-23 00:22:02.485598: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-23 00:22:02.827153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 00:22:04.597017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 00:22:05.059989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
201/201 - 299s - loss: 1.0173 - accuracy: 0.5585 - val_loss: 0.3654 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3355636014915088
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
201/201 - 302s - loss: 0.5963 - accuracy: 0.6553 - val_loss: 0.2841 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.050140015918689385
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
201/201 - 302s - loss: 0.6463 - accuracy: 0.7001 - val_loss: 0.1933 - val_accuracy: 0.9366
Confusion matrix: 
 [[564   9]
 [ 30  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.714 0.286]]
Validation f1: 38.10
Validation accuracy: 93.66
Validation recall: 28.57
Validation precision: 57.14
Validation AUC: 0.4909456084631311
Validation class accuracies: [0.9842931937172775, 0.2857142857142857]
Saving model...
Epoch 4/65
201/201 - 303s - loss: 0.5263 - accuracy: 0.6879 - val_loss: 0.4972 - val_accuracy: 0.7902
Confusion matrix: 
 [[450 123]
 [  6  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.143 0.857]]
Validation f1: 35.82
Validation accuracy: 79.02
Validation recall: 85.71
Validation precision: 22.64
Validation AUC: 0.46351702024662245
Validation class accuracies: [0.7853403141361257, 0.8571428571428571]
The validation tracker metric at 0.38095238095238093 hasn't increased by 0 in 1 epochs
Epoch 5/65
201/201 - 303s - loss: 0.4083 - accuracy: 0.7685 - val_loss: 1.5421 - val_accuracy: 0.4130
Confusion matrix: 
 [[212 361]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.37 0.63]
 [0.   1.  ]]
Validation f1: 18.88
Validation accuracy: 41.30
Validation recall: 100.00
Validation precision: 10.42
Validation AUC: 0.6410611953848825
Validation class accuracies: [0.3699825479930192, 1.0]
The validation tracker metric at 0.38095238095238093 hasn't increased by 0 in 2 epochs
Epoch 6/65
201/201 - 302s - loss: 0.3951 - accuracy: 0.7974 - val_loss: 0.9445 - val_accuracy: 0.6049
Confusion matrix: 
 [[336 237]
 [  6  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.586 0.414]
 [0.143 0.857]]
Validation f1: 22.86
Validation accuracy: 60.49
Validation recall: 85.71
Validation precision: 13.19
Validation AUC: 0.13485589013928598
Validation class accuracies: [0.5863874345549738, 0.8571428571428571]
The validation tracker metric at 0.38095238095238093 hasn't increased by 0 in 3 epochs
Epoch 7/65
201/201 - 303s - loss: 0.3442 - accuracy: 0.8267 - val_loss: 0.4574 - val_accuracy: 0.7951
Confusion matrix: 
 [[451 122]
 [  4  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.095 0.905]]
Validation f1: 37.62
Validation accuracy: 79.51
Validation recall: 90.48
Validation precision: 23.75
Validation AUC: 0.6013974704675464
Validation class accuracies: [0.787085514834206, 0.9047619047619048]
The validation tracker metric at 0.38095238095238093 hasn't increased by 0 in 4 epochs
Epoch 8/65
201/201 - 303s - loss: 0.2988 - accuracy: 0.8416 - val_loss: 1.1940 - val_accuracy: 0.6163
Confusion matrix: 
 [[340 233]
 [  3  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.593 0.407]
 [0.071 0.929]]
Validation f1: 24.84
Validation accuracy: 61.63
Validation recall: 92.86
Validation precision: 14.34
Validation AUC: 0.610312878715898
Validation class accuracies: [0.5933682373472949, 0.9285714285714286]
The validation tracker metric at 0.38095238095238093 hasn't increased by 0 in 5 epochs
Epoch 9/65
201/201 - 303s - loss: 0.2849 - accuracy: 0.8522 - val_loss: 0.3405 - val_accuracy: 0.8715
Confusion matrix: 
 [[509  64]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.357 0.643]]
Validation f1: 40.60
Validation accuracy: 87.15
Validation recall: 64.29
Validation precision: 29.67
Validation AUC: 0.542392884629549
Validation class accuracies: [0.8883071553228621, 0.6428571428571429]
Saving model...
Epoch 10/65
201/201 - 302s - loss: 0.2430 - accuracy: 0.8855 - val_loss: 0.4261 - val_accuracy: 0.8293
Confusion matrix: 
 [[480  93]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.286 0.714]]
Validation f1: 36.36
Validation accuracy: 82.93
Validation recall: 71.43
Validation precision: 24.39
Validation AUC: 0.5835843536940419
Validation class accuracies: [0.837696335078534, 0.7142857142857143]
The validation tracker metric at 0.40601503759398505 hasn't increased by 0 in 1 epochs
Epoch 11/65
201/201 - 303s - loss: 0.2331 - accuracy: 0.8892 - val_loss: 2.1332 - val_accuracy: 0.3528
Confusion matrix: 
 [[175 398]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.305 0.695]
 [0.    1.   ]]
Validation f1: 17.43
Validation accuracy: 35.28
Validation recall: 100.00
Validation precision: 9.55
Validation AUC: 0.5631428557924344
Validation class accuracies: [0.3054101221640489, 1.0]
The validation tracker metric at 0.40601503759398505 hasn't increased by 0 in 2 epochs
Epoch 12/65
201/201 - 302s - loss: 0.1476 - accuracy: 0.9259 - val_loss: 0.6987 - val_accuracy: 0.8130
Confusion matrix: 
 [[463 110]
 [  5  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.808 0.192]
 [0.119 0.881]]
Validation f1: 39.15
Validation accuracy: 81.30
Validation recall: 88.10
Validation precision: 25.17
Validation AUC: 0.5496854915371886
Validation class accuracies: [0.8080279232111692, 0.8809523809523809]
The validation tracker metric at 0.40601503759398505 hasn't increased by 0 in 3 epochs
Epoch 13/65
201/201 - 303s - loss: 0.1948 - accuracy: 0.9179 - val_loss: 1.3713 - val_accuracy: 0.6195
Confusion matrix: 
 [[354 219]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.618 0.382]
 [0.357 0.643]]
Validation f1: 18.75
Validation accuracy: 61.95
Validation recall: 64.29
Validation precision: 10.98
Validation AUC: 0.36975064803195723
Validation class accuracies: [0.6178010471204188, 0.6428571428571429]
The validation tracker metric at 0.40601503759398505 hasn't increased by 0 in 4 epochs
Epoch 14/65
201/201 - 303s - loss: 0.2254 - accuracy: 0.9004 - val_loss: 0.2319 - val_accuracy: 0.9138
Confusion matrix: 
 [[543  30]
 [ 23  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.548 0.452]]
Validation f1: 41.76
Validation accuracy: 91.38
Validation recall: 45.24
Validation precision: 38.78
Validation AUC: 0.5394326602426227
Validation class accuracies: [0.9476439790575916, 0.4523809523809524]
Saving model...
Epoch 15/65
201/201 - 303s - loss: 0.0997 - accuracy: 0.9543 - val_loss: 0.6034 - val_accuracy: 0.8016
Confusion matrix: 
 [[460 113]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.803 0.197]
 [0.214 0.786]]
Validation f1: 35.11
Validation accuracy: 80.16
Validation recall: 78.57
Validation precision: 22.60
Validation AUC: 0.7007309305518123
Validation class accuracies: [0.8027923211169284, 0.7857142857142857]
The validation tracker metric at 0.41758241758241765 hasn't increased by 0 in 1 epochs
Epoch 16/65
201/201 - 302s - loss: 0.1232 - accuracy: 0.9502 - val_loss: 1.0706 - val_accuracy: 0.7138
Confusion matrix: 
 [[415 158]
 [ 18  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.724 0.276]
 [0.429 0.571]]
Validation f1: 21.43
Validation accuracy: 71.38
Validation recall: 57.14
Validation precision: 13.19
Validation AUC: 0.3638549950420647
Validation class accuracies: [0.7242582897033158, 0.5714285714285714]
The validation tracker metric at 0.41758241758241765 hasn't increased by 0 in 2 epochs
Epoch 17/65
201/201 - 303s - loss: 0.1219 - accuracy: 0.9462 - val_loss: 3.0189 - val_accuracy: 0.4780
Confusion matrix: 
 [[254 319]
 [  2  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.443 0.557]
 [0.048 0.952]]
Validation f1: 19.95
Validation accuracy: 47.80
Validation recall: 95.24
Validation precision: 11.14
Validation AUC: 0.31535486553087216
Validation class accuracies: [0.4432809773123909, 0.9523809523809523]
The validation tracker metric at 0.41758241758241765 hasn't increased by 0 in 3 epochs
Epoch 18/65
201/201 - 303s - loss: 0.1555 - accuracy: 0.9303 - val_loss: 1.6496 - val_accuracy: 0.6846
Confusion matrix: 
 [[383 190]
 [  4  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.668 0.332]
 [0.095 0.905]]
Validation f1: 28.15
Validation accuracy: 68.46
Validation recall: 90.48
Validation precision: 16.67
Validation AUC: 0.47740437594945656
Validation class accuracies: [0.6684118673647469, 0.9047619047619048]
The validation tracker metric at 0.41758241758241765 hasn't increased by 0 in 4 epochs
Epoch 19/65
201/201 - 303s - loss: 0.0883 - accuracy: 0.9540 - val_loss: 0.8418 - val_accuracy: 0.7837
Confusion matrix: 
 [[444 129]
 [  4  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.095 0.905]]
Validation f1: 36.36
Validation accuracy: 78.37
Validation recall: 90.48
Validation precision: 22.75
Validation AUC: 0.6276034619233165
Validation class accuracies: [0.774869109947644, 0.9047619047619048]
The validation tracker metric at 0.41758241758241765 hasn't increased by 0 in 5 epochs
Epoch 20/65
201/201 - 303s - loss: 0.0568 - accuracy: 0.9748 - val_loss: 0.2111 - val_accuracy: 0.9415
Confusion matrix: 
 [[555  18]
 [ 18  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.429 0.571]]
Validation f1: 57.14
Validation accuracy: 94.15
Validation recall: 57.14
Validation precision: 57.14
Validation AUC: 0.6008948095877258
Validation class accuracies: [0.9685863874345549, 0.5714285714285714]
Saving model...
Epoch 21/65
201/201 - 303s - loss: 0.0652 - accuracy: 0.9670 - val_loss: 1.2059 - val_accuracy: 0.7203
Confusion matrix: 
 [[406 167]
 [  5  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.709 0.291]
 [0.119 0.881]]
Validation f1: 30.08
Validation accuracy: 72.03
Validation recall: 88.10
Validation precision: 18.14
Validation AUC: 0.5730922862391945
Validation class accuracies: [0.7085514834205934, 0.8809523809523809]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 1 epochs
Epoch 22/65
201/201 - 304s - loss: 0.0346 - accuracy: 0.9866 - val_loss: 0.2704 - val_accuracy: 0.9285
Confusion matrix: 
 [[552  21]
 [ 23  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.548 0.452]]
Validation f1: 46.34
Validation accuracy: 92.85
Validation recall: 45.24
Validation precision: 47.50
Validation AUC: 0.534809524858015
Validation class accuracies: [0.9633507853403142, 0.4523809523809524]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 2 epochs
Epoch 23/65
201/201 - 303s - loss: 0.0325 - accuracy: 0.9866 - val_loss: 0.7142 - val_accuracy: 0.8146
Confusion matrix: 
 [[470 103]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82  0.18 ]
 [0.262 0.738]]
Validation f1: 35.23
Validation accuracy: 81.46
Validation recall: 73.81
Validation precision: 23.13
Validation AUC: 0.523068780392434
Validation class accuracies: [0.8202443280977313, 0.7380952380952381]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 3 epochs
Epoch 24/65
201/201 - 303s - loss: 0.0204 - accuracy: 0.9900 - val_loss: 0.3115 - val_accuracy: 0.9301
Confusion matrix: 
 [[554  19]
 [ 24  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.571 0.429]]
Validation f1: 45.57
Validation accuracy: 93.01
Validation recall: 42.86
Validation precision: 48.65
Validation AUC: 0.5349391035376876
Validation class accuracies: [0.9668411867364747, 0.42857142857142855]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 4 epochs
Epoch 25/65
201/201 - 303s - loss: 0.1021 - accuracy: 0.9602 - val_loss: 2.0362 - val_accuracy: 0.5642
Confusion matrix: 
 [[316 257]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.551 0.449]
 [0.262 0.738]]
Validation f1: 18.79
Validation accuracy: 56.42
Validation recall: 73.81
Validation precision: 10.76
Validation AUC: 0.32673579107449113
Validation class accuracies: [0.5514834205933682, 0.7380952380952381]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 5 epochs
Epoch 26/65
201/201 - 303s - loss: 0.0602 - accuracy: 0.9701 - val_loss: 0.4456 - val_accuracy: 0.8813
Confusion matrix: 
 [[511  62]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.262 0.738]]
Validation f1: 45.93
Validation accuracy: 88.13
Validation recall: 73.81
Validation precision: 33.33
Validation AUC: 0.6259552958834192
Validation class accuracies: [0.8917975567190227, 0.7380952380952381]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 27/65
201/201 - 303s - loss: 0.0196 - accuracy: 0.9916 - val_loss: 0.3128 - val_accuracy: 0.9171
Confusion matrix: 
 [[539  34]
 [ 17  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.405 0.595]]
Validation f1: 49.50
Validation accuracy: 91.71
Validation recall: 59.52
Validation precision: 42.37
Validation AUC: 0.6093014320736434
Validation class accuracies: [0.9406631762652705, 0.5952380952380952]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 7 epochs
Epoch 28/65
201/201 - 303s - loss: 0.0173 - accuracy: 0.9956 - val_loss: 0.3611 - val_accuracy: 0.9122
Confusion matrix: 
 [[533  40]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.333 0.667]]
Validation f1: 50.91
Validation accuracy: 91.22
Validation recall: 66.67
Validation precision: 41.18
Validation AUC: 0.6075579434268814
Validation class accuracies: [0.9301919720767888, 0.6666666666666666]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 8 epochs
Epoch 29/65
201/201 - 303s - loss: 0.0181 - accuracy: 0.9956 - val_loss: 0.3292 - val_accuracy: 0.9138
Confusion matrix: 
 [[538  35]
 [ 18  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.429 0.571]]
Validation f1: 47.52
Validation accuracy: 91.38
Validation recall: 57.14
Validation precision: 40.68
Validation AUC: 0.5623611491517854
Validation class accuracies: [0.9389179755671903, 0.5714285714285714]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 9 epochs
Epoch 30/65
201/201 - 303s - loss: 0.0095 - accuracy: 0.9969 - val_loss: 0.3971 - val_accuracy: 0.8992
Confusion matrix: 
 [[527  46]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.381 0.619]]
Validation f1: 45.61
Validation accuracy: 89.92
Validation recall: 61.90
Validation precision: 36.11
Validation AUC: 0.578396231446999
Validation class accuracies: [0.9197207678883071, 0.6190476190476191]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 10 epochs
Epoch 31/65
201/201 - 303s - loss: 0.0098 - accuracy: 0.9972 - val_loss: 0.4663 - val_accuracy: 0.8829
Confusion matrix: 
 [[518  55]
 [ 17  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.405 0.595]]
Validation f1: 40.98
Validation accuracy: 88.29
Validation recall: 59.52
Validation precision: 31.25
Validation AUC: 0.5317159704119518
Validation class accuracies: [0.9040139616055847, 0.5952380952380952]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 11 epochs
Epoch 32/65
201/201 - 303s - loss: 0.0181 - accuracy: 0.9935 - val_loss: 0.4072 - val_accuracy: 0.8992
Confusion matrix: 
 [[527  46]
 [ 16  26]]
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.381 0.619]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.61
Validation accuracy: 89.92
Validation recall: 61.90
Validation precision: 36.11
Validation AUC: 0.5796825446365242
Validation class accuracies: [0.9197207678883071, 0.6190476190476191]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 33/65
201/201 - 303s - loss: 0.0093 - accuracy: 0.9969 - val_loss: 0.5474 - val_accuracy: 0.8797
Confusion matrix: 
 [[511  62]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.286 0.714]]
Validation f1: 44.78
Validation accuracy: 87.97
Validation recall: 71.43
Validation precision: 32.61
Validation AUC: 0.587538998182656
Validation class accuracies: [0.8917975567190227, 0.7142857142857143]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 13 epochs
Epoch 34/65
201/201 - 304s - loss: 0.0075 - accuracy: 0.9972 - val_loss: 0.4730 - val_accuracy: 0.8927
Confusion matrix: 
 [[523  50]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.381 0.619]]
Validation f1: 44.07
Validation accuracy: 89.27
Validation recall: 61.90
Validation precision: 34.21
Validation AUC: 0.5425210820302574
Validation class accuracies: [0.912739965095986, 0.6190476190476191]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 14 epochs
Epoch 35/65
201/201 - 303s - loss: 0.0059 - accuracy: 0.9984 - val_loss: 0.4084 - val_accuracy: 0.9008
Confusion matrix: 
 [[529  44]
 [ 17  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.405 0.595]]
Validation f1: 45.05
Validation accuracy: 90.08
Validation recall: 59.52
Validation precision: 36.23
Validation AUC: 0.5547653218110408
Validation class accuracies: [0.9232111692844677, 0.5952380952380952]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 15 epochs
Epoch 36/65
201/201 - 302s - loss: 0.0046 - accuracy: 0.9991 - val_loss: 0.4540 - val_accuracy: 0.8959
Confusion matrix: 
 [[522  51]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.31  0.69 ]]
Validation f1: 47.54
Validation accuracy: 89.59
Validation recall: 69.05
Validation precision: 36.25
Validation AUC: 0.5743739157269186
Validation class accuracies: [0.9109947643979057, 0.6904761904761905]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 16 epochs
Epoch 37/65
201/201 - 303s - loss: 0.0061 - accuracy: 0.9984 - val_loss: 0.3509 - val_accuracy: 0.9106
Confusion matrix: 
 [[537  36]
 [ 19  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.452 0.548]]
Validation f1: 45.54
Validation accuracy: 91.06
Validation recall: 54.76
Validation precision: 38.98
Validation AUC: 0.5701278816793681
Validation class accuracies: [0.93717277486911, 0.5476190476190477]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 17 epochs
Epoch 38/65
201/201 - 303s - loss: 0.0095 - accuracy: 0.9969 - val_loss: 0.4772 - val_accuracy: 0.8797
Confusion matrix: 
 [[513  60]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.333 0.667]]
Validation f1: 43.08
Validation accuracy: 87.97
Validation recall: 66.67
Validation precision: 31.82
Validation AUC: 0.5476303180015735
Validation class accuracies: [0.8952879581151832, 0.6666666666666666]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 39/65
201/201 - 303s - loss: 0.0117 - accuracy: 0.9953 - val_loss: 0.3881 - val_accuracy: 0.9073
Confusion matrix: 
 [[536  37]
 [ 20  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.476 0.524]]
Validation f1: 43.56
Validation accuracy: 90.73
Validation recall: 52.38
Validation precision: 37.29
Validation AUC: 0.545214955675576
Validation class accuracies: [0.9354275741710296, 0.5238095238095238]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 19 epochs
Epoch 40/65
201/201 - 303s - loss: 0.0054 - accuracy: 0.9975 - val_loss: 0.3924 - val_accuracy: 0.9041
Confusion matrix: 
 [[532  41]
 [ 18  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.429 0.571]]
Validation f1: 44.86
Validation accuracy: 90.41
Validation recall: 57.14
Validation precision: 36.92
Validation AUC: 0.547301762284998
Validation class accuracies: [0.9284467713787086, 0.5714285714285714]

The metrics for job 0 with the best target metric are: 
Best cm: [[555  18]
 [ 18  24]]
Best normalized cm: [[0.969 0.031]
 [0.429 0.571]]
Best f1: 0.57
Best accuracy: 0.94
Best recall: 0.57
Best precision: 0.57
Best AUC: 0.60
Best class accuracies: [0.9685863874345549, 0.5714285714285714]
Best epoch: 20
The number of epochs since last 1% equals the patience
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2242.py", line 412, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params, model9, job_count=0)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2242.py", line 355, in train_model
    callbacks=[metrics_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/integration/keras/keras.py", line 124, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1154, in fit
    callbacks.on_train_end(logs=training_logs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/callbacks.py", line 532, in on_train_end
    callback.on_train_end(numpy_logs)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/callbacks.py", line 133, in on_train_end
    path = os.path.join(self.job_dir, self.job_count)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/posixpath.py", line 94, in join
    genericpath._check_arg_types('join', a, *p)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/genericpath.py", line 153, in _check_arg_types
    (funcname, s.__class__.__name__)) from None
TypeError: join() argument must be str or bytes, not 'int'
wandb: Waiting for W&B process to finish, PID 24536
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_002156-29w3kq01/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_002156-29w3kq01/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99751
wandb:         val_accuracy 0.90407
wandb:             _runtime 12688
wandb:           _timestamp 1624420405
wandb:                _step 291
wandb:           train_loss 0.00542
wandb:             val_loss 0.39244
wandb:           val_recall 0.57143
wandb:        val_precision 0.36923
wandb:               val_f1 0.4486
wandb:              val_auc 0.5473
wandb:                   lr 0.00013
wandb:          best_val_f1 0.57143
wandb:    best_val_accuracy 0.94146
wandb:   best_val_precision 0.57143
wandb:      best_val_recall 0.57143
wandb:             best_auc 0.60089
wandb:           best_epoch 20
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_002156-29w3kq01


 See logs at ../../new_cache/conv__2242__06_0000__v39__augmented_icbhi_and_jordan/logs/