Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2293
Description:  mixup
2021-07-08 16:16:22.252303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-07-08 16:16:24.405374: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-08 16:16:24.406360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-08 16:16:24.455257: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:16:24.455985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-08 16:16:24.456020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-08 16:16:24.459149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-08 16:16:24.459234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-08 16:16:24.460308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-08 16:16:24.460624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-08 16:16:24.461619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-08 16:16:24.462447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-08 16:16:24.462599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-08 16:16:24.462712: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:16:24.463439: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:16:24.464093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2293.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2293__07_1616__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
158/800 with v42, v43
{'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-08 16:32:42.054902: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-08 16:32:42.055253: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:32:42.056398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-08 16:32:42.056478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-08 16:32:42.056576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-08 16:32:42.056608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-08 16:32:42.056637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-08 16:32:42.056668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-08 16:32:42.056696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-08 16:32:42.056736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-08 16:32:42.056761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-08 16:32:42.056897: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:32:42.057982: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:32:42.058900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-08 16:32:42.058959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-08 16:32:42.820172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-08 16:32:42.820216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-08 16:32:42.820225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-08 16:32:42.820500: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:32:42.821288: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:32:42.821965: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-08 16:32:42.822606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-07-08 16:32:44.156878: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-07-08 16:32:44.159254: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-08 16:32:44.645765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-08 16:32:47.170361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-08 16:32:47.690272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_25
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_27
Length of training samples after augmix augmentation: 3416
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
214/214 - 101s - loss: 0.5063 - accuracy: 0.6917 - val_loss: 0.5258 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23895406073418873
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
214/214 - 86s - loss: 0.3160 - accuracy: 0.8381 - val_loss: 0.2838 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17988337127702747
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
214/214 - 88s - loss: 0.2389 - accuracy: 0.8893 - val_loss: 0.2164 - val_accuracy: 0.9397
Confusion matrix: 
 [[548  25]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.293 0.707]]
Validation f1: 61.05
Validation accuracy: 93.97
Validation recall: 70.73
Validation precision: 53.70
Validation AUC: 0.6898194584912999
Validation class accuracies: [0.956369982547993, 0.7073170731707317]
Saving model...
Epoch 4/65
214/214 - 93s - loss: 0.1643 - accuracy: 0.9289 - val_loss: 0.4163 - val_accuracy: 0.8876
Confusion matrix: 
 [[516  57]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.293 0.707]]
Validation f1: 45.67
Validation accuracy: 88.76
Validation recall: 70.73
Validation precision: 33.72
Validation AUC: 0.5753560917179299
Validation class accuracies: [0.900523560209424, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 1 epochs
Epoch 5/65
214/214 - 86s - loss: 0.1316 - accuracy: 0.9397 - val_loss: 0.7890 - val_accuracy: 0.7899
Confusion matrix: 
 [[449 124]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.784 0.216]
 [0.122 0.878]]
Validation f1: 35.82
Validation accuracy: 78.99
Validation recall: 87.80
Validation precision: 22.50
Validation AUC: 0.6212352060219344
Validation class accuracies: [0.7835951134380453, 0.8780487804878049]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 2 epochs
Epoch 6/65
214/214 - 88s - loss: 0.0971 - accuracy: 0.9631 - val_loss: 0.3471 - val_accuracy: 0.8941
Confusion matrix: 
 [[521  52]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.317 0.683]]
Validation f1: 46.28
Validation accuracy: 89.41
Validation recall: 68.29
Validation precision: 35.00
Validation AUC: 0.6588182305876139
Validation class accuracies: [0.9092495636998255, 0.6829268292682927]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 3 epochs
Epoch 7/65
214/214 - 93s - loss: 0.0642 - accuracy: 0.9760 - val_loss: 0.6382 - val_accuracy: 0.8795
Confusion matrix: 
 [[508  65]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.22  0.78 ]]
Validation f1: 46.38
Validation accuracy: 87.95
Validation recall: 78.05
Validation precision: 32.99
Validation AUC: 0.6225384262170287
Validation class accuracies: [0.8865619546247818, 0.7804878048780488]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 4 epochs
Epoch 8/65
214/214 - 87s - loss: 0.0595 - accuracy: 0.9789 - val_loss: 0.4504 - val_accuracy: 0.9007
Confusion matrix: 
 [[526  47]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.341 0.659]]
Validation f1: 46.96
Validation accuracy: 90.07
Validation recall: 65.85
Validation precision: 36.49
Validation AUC: 0.5804580136316233
Validation class accuracies: [0.9179755671902269, 0.6585365853658537]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 9/65
214/214 - 88s - loss: 0.0349 - accuracy: 0.9862 - val_loss: 0.4897 - val_accuracy: 0.8941
Confusion matrix: 
 [[520  53]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.293 0.707]]
Validation f1: 47.15
Validation accuracy: 89.41
Validation recall: 70.73
Validation precision: 35.37
Validation AUC: 0.5852675303657038
Validation class accuracies: [0.9075043630017452, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 6 epochs
Epoch 10/65
214/214 - 99s - loss: 0.0313 - accuracy: 0.9909 - val_loss: 0.5478 - val_accuracy: 0.8876
Confusion matrix: 
 [[516  57]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.67
Validation accuracy: 88.76
Validation recall: 70.73
Validation precision: 33.72
Validation AUC: 0.5945945328217555
Validation class accuracies: [0.900523560209424, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 7 epochs
Epoch 11/65
214/214 - 92s - loss: 0.0273 - accuracy: 0.9933 - val_loss: 0.5238 - val_accuracy: 0.8925
Confusion matrix: 
 [[519  54]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.293 0.707]]
Validation f1: 46.77
Validation accuracy: 89.25
Validation recall: 70.73
Validation precision: 34.94
Validation AUC: 0.5895386775871705
Validation class accuracies: [0.9057591623036649, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 8 epochs
Epoch 12/65
214/214 - 93s - loss: 0.0244 - accuracy: 0.9933 - val_loss: 0.4109 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.6240038946472887
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 9 epochs
Epoch 13/65
214/214 - 101s - loss: 0.0239 - accuracy: 0.9930 - val_loss: 0.4861 - val_accuracy: 0.8990
Confusion matrix: 
 [[523  50]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.293 0.707]]
Validation f1: 48.33
Validation accuracy: 89.90
Validation recall: 70.73
Validation precision: 36.71
Validation AUC: 0.6056221615053261
Validation class accuracies: [0.912739965095986, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 14/65
214/214 - 94s - loss: 0.0217 - accuracy: 0.9953 - val_loss: 0.4712 - val_accuracy: 0.9039
Confusion matrix: 
 [[526  47]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.293 0.707]]
Validation f1: 49.57
Validation accuracy: 90.39
Validation recall: 70.73
Validation precision: 38.16
Validation AUC: 0.6131659606093809
Validation class accuracies: [0.9179755671902269, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 11 epochs
Epoch 15/65
214/214 - 91s - loss: 0.0197 - accuracy: 0.9950 - val_loss: 0.4629 - val_accuracy: 0.9055
Confusion matrix: 
 [[527  46]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.293 0.707]]
Validation f1: 50.00
Validation accuracy: 90.55
Validation recall: 70.73
Validation precision: 38.67
Validation AUC: 0.6144845990219974
Validation class accuracies: [0.9197207678883071, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 12 epochs
Epoch 16/65
214/214 - 100s - loss: 0.0186 - accuracy: 0.9950 - val_loss: 0.4635 - val_accuracy: 0.9023
Confusion matrix: 
 [[525  48]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.293 0.707]]
Validation f1: 49.15
Validation accuracy: 90.23
Validation recall: 70.73
Validation precision: 37.66
Validation AUC: 0.622559595328269
Validation class accuracies: [0.9162303664921466, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 13 epochs
Epoch 17/65
214/214 - 93s - loss: 0.0194 - accuracy: 0.9965 - val_loss: 0.4844 - val_accuracy: 0.9023
Confusion matrix: 
 [[525  48]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.15
Validation accuracy: 90.23
Validation recall: 70.73
Validation precision: 37.66
Validation AUC: 0.6223935620561328
Validation class accuracies: [0.9162303664921466, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 14 epochs
Epoch 18/65
214/214 - 89s - loss: 0.0202 - accuracy: 0.9956 - val_loss: 0.5037 - val_accuracy: 0.8974
Confusion matrix: 
 [[522  51]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.293 0.707]]
Validation f1: 47.93
Validation accuracy: 89.74
Validation recall: 70.73
Validation precision: 36.25
Validation AUC: 0.6130524013361478
Validation class accuracies: [0.9109947643979057, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 19/65
214/214 - 96s - loss: 0.0204 - accuracy: 0.9965 - val_loss: 0.4874 - val_accuracy: 0.9023
Confusion matrix: 
 [[525  48]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.15
Validation accuracy: 90.23
Validation recall: 70.73
Validation precision: 37.66
Validation AUC: 0.6192217110727996
Validation class accuracies: [0.9162303664921466, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 16 epochs
Epoch 20/65
214/214 - 92s - loss: 0.0169 - accuracy: 0.9971 - val_loss: 0.4741 - val_accuracy: 0.9055
Confusion matrix: 
 [[527  46]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.293 0.707]]
Validation f1: 50.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 90.55
Validation recall: 70.73
Validation precision: 38.67
Validation AUC: 0.6194826465067091
Validation class accuracies: [0.9197207678883071, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 17 epochs
Epoch 21/65
214/214 - 88s - loss: 0.0141 - accuracy: 0.9980 - val_loss: 0.4693 - val_accuracy: 0.9055
Confusion matrix: 
 [[527  46]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.293 0.707]]
Validation f1: 50.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 90.55
Validation recall: 70.73
Validation precision: 38.67
Validation AUC: 0.6213694612226505
Validation class accuracies: [0.9197207678883071, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 18 epochs
Epoch 22/65
214/214 - 93s - loss: 0.0194 - accuracy: 0.9953 - val_loss: 0.4824 - val_accuracy: 0.9023
Confusion matrix: 
 [[525  48]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.293 0.707]]
Validation f1: 49.15
Validation accuracy: 90.23
Validation recall: 70.73
Validation precision: 37.66
Validation AUC: 0.6224551156267156
Validation class accuracies: [0.9162303664921466, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 19 epochs
Epoch 23/65
214/214 - 89s - loss: 0.0183 - accuracy: 0.9974 - val_loss: 0.4728 - val_accuracy: 0.9023
Confusion matrix: 
 [[525  48]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.293 0.707]]
Validation f1: 49.15
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 90.23
Validation recall: 70.73
Validation precision: 37.66
Validation AUC: 0.6200597957030274
Validation class accuracies: [0.9162303664921466, 0.7073170731707317]

The metrics for job 2 with the best target metric are: 
Best cm: [[548  25]
 [ 12  29]]
Best normalized cm: [[0.956 0.044]
 [0.293 0.707]]
Best f1: 0.61
Best accuracy: 0.94
Best recall: 0.71
Best precision: 0.54
Best AUC: 0.69
Best class accuracies: [0.956369982547993, 0.7073170731707317]
Best epoch: 3
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.028]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.025]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.197]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.075]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_1.png, [[0.626]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_1.png, [[0.866]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.132]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.586e-05]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.05]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.139]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.038]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.019]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.005]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.272]]
../../new_cache/conv__2293__07_1616__v39__mixup/2/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.774]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 9429
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210708_161624-3867ebqj/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210708_161624-3867ebqj/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99737
wandb:         val_accuracy 0.90228
wandb:             _runtime 3393
wandb:           _timestamp 1625764378
wandb:                _step 163
wandb:           train_loss 0.01835
wandb:             val_loss 0.47283
wandb:           val_recall 0.70732
wandb:        val_precision 0.37662
wandb:               val_f1 0.49153
wandb:              val_auc 0.62006
wandb:                   lr 2e-05
wandb:          best_val_f1 0.61053
wandb:    best_val_accuracy 0.93974
wandb:   best_val_precision 0.53704
wandb:      best_val_recall 0.70732
wandb:             best_auc 0.68982
wandb:           best_epoch 3
wandb: Run history:
wandb:   train_accuracy ▁▄▆▆▇▇▇████████████████
wandb:     val_accuracy ███▆▁▆▅▆▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▅▂▁▃█▃▆▄▄▅▅▃▄▄▄▄▄▅▄▄▄▄▄
wandb:       val_recall ▁▁▇▇█▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:    val_precision ▁▁█▅▄▆▅▆▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_f1 ▁▁█▆▅▆▆▆▆▆▆▇▇▇▇▇▇▆▇▇▇▇▇
wandb:          val_auc ▂▁█▆▇█▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr ████████▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210708_161624-3867ebqj

-----------------------
158/1200 with v42, v43
{'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_28
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_29
Length of training samples after augmix augmentation: 3816
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_5 (MixDepthGroupCo (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_6 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_7 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_8 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_9 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
239/239 - 94s - loss: 0.5150 - accuracy: 0.6779 - val_loss: 0.5015 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.29111113871731015
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
239/239 - 100s - loss: 0.3116 - accuracy: 0.8420 - val_loss: 0.4592 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.10774816949478151
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
239/239 - 101s - loss: 0.2204 - accuracy: 0.9046 - val_loss: 0.3099 - val_accuracy: 0.8681
Confusion matrix: 
 [[502  71]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.244 0.756]]
Validation f1: 43.36
Validation accuracy: 86.81
Validation recall: 75.61
Validation precision: 30.39
Validation AUC: 0.7032780856307737
Validation class accuracies: [0.8760907504363001, 0.7560975609756098]
Saving model...
Epoch 4/65
239/239 - 95s - loss: 0.1415 - accuracy: 0.9387 - val_loss: 0.5422 - val_accuracy: 0.8274
Confusion matrix: 
 [[474  99]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.827 0.173]
 [0.171 0.829]]
Validation f1: 39.08
Validation accuracy: 82.74
Validation recall: 82.93
Validation precision: 25.56
Validation AUC: 0.6946318062765218
Validation class accuracies: [0.8272251308900523, 0.8292682926829268]
The validation tracker metric at 0.4335664335664335 hasn't increased by 0 in 1 epochs
Epoch 5/65
239/239 - 102s - loss: 0.1049 - accuracy: 0.9568 - val_loss: 0.4863 - val_accuracy: 0.8730
Confusion matrix: 
 [[501  72]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.874 0.126]
 [0.146 0.854]]
Validation f1: 47.30
Validation accuracy: 87.30
Validation recall: 85.37
Validation precision: 32.71
Validation AUC: 0.67328775254214
Validation class accuracies: [0.8743455497382199, 0.8536585365853658]
Saving model...
Epoch 6/65
239/239 - 98s - loss: 0.0633 - accuracy: 0.9751 - val_loss: 0.2128 - val_accuracy: 0.9283
Confusion matrix: 
 [[547  26]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.439 0.561]]
Validation f1: 51.11
Validation accuracy: 92.83
Validation recall: 56.10
Validation precision: 46.94
Validation AUC: 0.6045320417639789
Validation class accuracies: [0.9546247818499127, 0.5609756097560976]
Saving model...
Epoch 7/65
239/239 - 97s - loss: 0.0508 - accuracy: 0.9843 - val_loss: 0.2248 - val_accuracy: 0.9414
Confusion matrix: 
 [[558  15]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.512 0.488]]
Validation f1: 52.63
Validation accuracy: 94.14
Validation recall: 48.78
Validation precision: 57.14
Validation AUC: 0.5506668363313117
Validation class accuracies: [0.9738219895287958, 0.4878048780487805]
Saving model...
Epoch 8/65
239/239 - 103s - loss: 0.1282 - accuracy: 0.9636 - val_loss: 0.4094 - val_accuracy: 0.8779
Confusion matrix: 
 [[509  64]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.268 0.732]]
Validation f1: 44.44
Validation accuracy: 87.79
Validation recall: 73.17
Validation precision: 31.91
Validation AUC: 0.673313965732013
Validation class accuracies: [0.8883071553228621, 0.7317073170731707]
The validation tracker metric at 0.5263157894736842 hasn't increased by 0 in 1 epochs
Epoch 9/65
239/239 - 95s - loss: 0.0713 - accuracy: 0.9693 - val_loss: 0.3284 - val_accuracy: 0.8974
Confusion matrix: 
 [[518  55]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.195 0.805]]
Validation f1: 51.16
Validation accuracy: 89.74
Validation recall: 80.49
Validation precision: 37.50
Validation AUC: 0.7055271249763991
Validation class accuracies: [0.9040139616055847, 0.8048780487804879]
The validation tracker metric at 0.5263157894736842 hasn't increased by 0 in 2 epochs
Epoch 10/65
239/239 - 97s - loss: 0.0386 - accuracy: 0.9887 - val_loss: 0.2306 - val_accuracy: 0.9283
Confusion matrix: 
 [[544  29]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.366 0.634]]
Validation f1: 54.17
Validation accuracy: 92.83
Validation recall: 63.41
Validation precision: 47.27
Validation AUC: 0.6564564104775638
Validation class accuracies: [0.9493891797556719, 0.6341463414634146]
Saving model...
Epoch 11/65
239/239 - 103s - loss: 0.0267 - accuracy: 0.9929 - val_loss: 0.3014 - val_accuracy: 0.9088
Confusion matrix: 
 [[530  43]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 90.88
Validation recall: 68.29
Validation precision: 39.44
Validation AUC: 0.6735547389446879
Validation class accuracies: [0.924956369982548, 0.6829268292682927]
The validation tracker metric at 0.5416666666666666 hasn't increased by 0 in 1 epochs
Epoch 12/65
239/239 - 93s - loss: 0.0238 - accuracy: 0.9934 - val_loss: 0.2137 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.7333013306116795
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
Saving model...
Epoch 13/65
239/239 - 99s - loss: 0.0224 - accuracy: 0.9940 - val_loss: 0.3034 - val_accuracy: 0.9218
Confusion matrix: 
 [[538  35]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.317 0.683]]
Validation f1: 53.85
Validation accuracy: 92.18
Validation recall: 68.29
Validation precision: 44.44
Validation AUC: 0.6665273874779082
Validation class accuracies: [0.9389179755671903, 0.6829268292682927]
The validation tracker metric at 0.5714285714285715 hasn't increased by 0 in 1 epochs
Epoch 14/65
239/239 - 103s - loss: 0.0227 - accuracy: 0.9942 - val_loss: 0.2279 - val_accuracy: 0.9332
Confusion matrix: 
 [[549  24]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.415 0.585]]
Validation f1: 53.93
Validation accuracy: 93.32
Validation recall: 58.54
Validation precision: 50.00
Validation AUC: 0.6168622044317271
Validation class accuracies: [0.9581151832460733, 0.5853658536585366]
The validation tracker metric at 0.5714285714285715 hasn't increased by 0 in 2 epochs
Epoch 15/65
239/239 - 95s - loss: 0.0139 - accuracy: 0.9966 - val_loss: 0.4602 - val_accuracy: 0.8681
Confusion matrix: 
 [[505  68]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.317 0.683]]
Validation f1: 40.88
Validation accuracy: 86.81
Validation recall: 68.29
Validation precision: 29.17
Validation AUC: 0.5526152480087496
Validation class accuracies: [0.881326352530541, 0.6829268292682927]
The validation tracker metric at 0.5714285714285715 hasn't increased by 0 in 3 epochs
Epoch 16/65
239/239 - 101s - loss: 0.0186 - accuracy: 0.9953 - val_loss: 0.2822 - val_accuracy: 0.9153
Confusion matrix: 
 [[533  40]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.293 0.707]]
Validation f1: 52.73
Validation accuracy: 91.53
Validation recall: 70.73
Validation precision: 42.03
Validation AUC: 0.6545040976848303
Validation class accuracies: [0.9301919720767888, 0.7073170731707317]
The validation tracker metric at 0.5714285714285715 hasn't increased by 0 in 4 epochs
Epoch 17/65
239/239 - 98s - loss: 0.0106 - accuracy: 0.9990 - val_loss: 0.4908 - val_accuracy: 0.8925
Confusion matrix: 
 [[515  58]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.195 0.805]]
Validation f1: 50.00
Validation accuracy: 89.25
Validation recall: 80.49
Validation precision: 36.26
Validation AUC: 0.622324489268554
Validation class accuracies: [0.8987783595113438, 0.8048780487804879]
The validation tracker metric at 0.5714285714285715 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 18/65
239/239 - 96s - loss: 0.0115 - accuracy: 0.9971 - val_loss: 0.2788 - val_accuracy: 0.9121
Confusion matrix: 
 [[532  41]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.317 0.683]]
Validation f1: 50.91
Validation accuracy: 91.21
Validation recall: 68.29
Validation precision: 40.58
Validation AUC: 0.6655680683193734
Validation class accuracies: [0.9284467713787086, 0.6829268292682927]
The validation tracker metric at 0.5714285714285715 hasn't increased by 0 in 6 epochs
Epoch 19/65
239/239 - 102s - loss: 0.0068 - accuracy: 0.9995 - val_loss: 0.2811 - val_accuracy: 0.9251
Confusion matrix: 
 [[540  33]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.90
Validation accuracy: 92.51
Validation recall: 68.29
Validation precision: 45.90
Validation AUC: 0.6531744848005105
Validation class accuracies: [0.9424083769633508, 0.6829268292682927]
The validation tracker metric at 0.5714285714285715 hasn't increased by 0 in 7 epochs
Epoch 20/65
239/239 - 95s - loss: 0.0059 - accuracy: 0.9995 - val_loss: 0.2440 - val_accuracy: 0.9381
Confusion matrix: 
 [[548  25]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.317 0.683]]
Validation f1: 59.57
Validation accuracy: 93.81
Validation recall: 68.29
Validation precision: 52.83
Validation AUC: 0.6605861096106527
Validation class accuracies: [0.956369982547993, 0.6829268292682927]
Saving model...
Epoch 21/65
239/239 - 97s - loss: 0.0057 - accuracy: 0.9995 - val_loss: 0.2910 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6553706745501163
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 1 epochs
Epoch 22/65
239/239 - 104s - loss: 0.0049 - accuracy: 0.9997 - val_loss: 0.2693 - val_accuracy: 0.9283
Confusion matrix: 
 [[542  31]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.317 0.683]]
Validation f1: 56.00
Validation accuracy: 92.83
Validation recall: 68.29
Validation precision: 47.46
Validation AUC: 0.6521464918223732
Validation class accuracies: [0.9458987783595113, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 2 epochs
Epoch 23/65
239/239 - 93s - loss: 0.0078 - accuracy: 0.9990 - val_loss: 0.3255 - val_accuracy: 0.9121
Confusion matrix: 
 [[532  41]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.91
Validation accuracy: 91.21
Validation recall: 68.29
Validation precision: 40.58
Validation AUC: 0.6410558679958247
Validation class accuracies: [0.9284467713787086, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 3 epochs
Epoch 24/65
239/239 - 99s - loss: 0.0054 - accuracy: 0.9997 - val_loss: 0.2779 - val_accuracy: 0.9300
Confusion matrix: 
 [[543  30]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.317 0.683]]
Validation f1: 56.57
Validation accuracy: 93.00
Validation recall: 68.29
Validation precision: 48.28
Validation AUC: 0.6484603766611912
Validation class accuracies: [0.9476439790575916, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 4 epochs
Epoch 25/65
239/239 - 103s - loss: 0.0063 - accuracy: 1.0000 - val_loss: 0.3909 - val_accuracy: 0.9023
Confusion matrix: 
 [[526  47]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.317 0.683]]
Validation f1: 48.28
Validation accuracy: 90.23
Validation recall: 68.29
Validation precision: 37.33
Validation AUC: 0.6456855470956341
Validation class accuracies: [0.9179755671902269, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 26/65
239/239 - 94s - loss: 0.0055 - accuracy: 0.9995 - val_loss: 0.3237 - val_accuracy: 0.9121
Confusion matrix: 
 [[532  41]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.91
Validation accuracy: 91.21
Validation recall: 68.29
Validation precision: 40.58
Validation AUC: 0.6363795041337766
Validation class accuracies: [0.9284467713787086, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 6 epochs
Epoch 27/65
239/239 - 101s - loss: 0.0042 - accuracy: 0.9992 - val_loss: 0.3067 - val_accuracy: 0.9202
Confusion matrix: 
 [[537  36]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.317 0.683]]
Validation f1: 53.33
Validation accuracy: 92.02
Validation recall: 68.29
Validation precision: 43.75
Validation AUC: 0.6354958214185951
Validation class accuracies: [0.93717277486911, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 7 epochs
Epoch 28/65
239/239 - 100s - loss: 0.0074 - accuracy: 0.9995 - val_loss: 0.3133 - val_accuracy: 0.9153
Confusion matrix: 
 [[534  39]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.317 0.683]]
Validation f1: 51.85
Validation accuracy: 91.53
Validation recall: 68.29
Validation precision: 41.79
Validation AUC: 0.6368033964859914
Validation class accuracies: [0.9319371727748691, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 8 epochs
Epoch 29/65
239/239 - 95s - loss: 0.0060 - accuracy: 1.0000 - val_loss: 0.3154 - val_accuracy: 0.9169
Confusion matrix: 
 [[535  38]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.317 0.683]]
Validation f1: 52.34
Validation accuracy: 91.69
Validation recall: 68.29
Validation precision: 42.42
Validation AUC: 0.6331155347531818
Validation class accuracies: [0.9336823734729494, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 9 epochs
Epoch 30/65
239/239 - 104s - loss: 0.0047 - accuracy: 0.9995 - val_loss: 0.3012 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6327610895960588
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 31/65
239/239 - 98s - loss: 0.0046 - accuracy: 1.0000 - val_loss: 0.3085 - val_accuracy: 0.9186
Confusion matrix: 
 [[536  37]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.317 0.683]]
Validation f1: 52.83
Validation accuracy: 91.86
Validation recall: 68.29
Validation precision: 43.08
Validation AUC: 0.6335250543134336
Validation class accuracies: [0.9354275741710296, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 11 epochs
Epoch 32/65
239/239 - 101s - loss: 0.0046 - accuracy: 1.0000 - val_loss: 0.3082 - val_accuracy: 0.9186
Confusion matrix: 
 [[536  37]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.83
Validation accuracy: 91.86
Validation recall: 68.29
Validation precision: 43.08
Validation AUC: 0.6346049230806168
Validation class accuracies: [0.9354275741710296, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 12 epochs
Epoch 33/65
239/239 - 107s - loss: 0.0041 - accuracy: 0.9995 - val_loss: 0.3057 - val_accuracy: 0.9202
Confusion matrix: 
 [[537  36]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.317 0.683]]
Validation f1: 53.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.02
Validation recall: 68.29
Validation precision: 43.75
Validation AUC: 0.63584555799728
Validation class accuracies: [0.93717277486911, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 13 epochs
Epoch 34/65
239/239 - 96s - loss: 0.0042 - accuracy: 1.0000 - val_loss: 0.3076 - val_accuracy: 0.9186
Confusion matrix: 
 [[536  37]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.83
Validation accuracy: 91.86
Validation recall: 68.29
Validation precision: 43.08
Validation AUC: 0.6376873820934951
Validation class accuracies: [0.9354275741710296, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 14 epochs
Epoch 35/65
239/239 - 99s - loss: 0.0036 - accuracy: 0.9997 - val_loss: 0.2957 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6385255864992141
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 3.906250185536919e-06
Epoch 36/65
239/239 - 103s - loss: 0.0041 - accuracy: 0.9997 - val_loss: 0.3046 - val_accuracy: 0.9202
Confusion matrix: 
 [[537  36]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.33
Validation accuracy: 92.02
Validation recall: 68.29
Validation precision: 43.75
Validation AUC: 0.6366215588134393
Validation class accuracies: [0.93717277486911, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 16 epochs
Epoch 37/65
239/239 - 93s - loss: 0.0045 - accuracy: 0.9997 - val_loss: 0.3056 - val_accuracy: 0.9186
Confusion matrix: 
 [[536  37]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.83
Validation accuracy: 91.86
Validation recall: 68.29
Validation precision: 43.08
Validation AUC: 0.6393348948475679
Validation class accuracies: [0.9354275741710296, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 17 epochs
Epoch 38/65
239/239 - 100s - loss: 0.0053 - accuracy: 1.0000 - val_loss: 0.3019 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6377401088828749
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 18 epochs
Epoch 39/65
239/239 - 103s - loss: 0.0044 - accuracy: 1.0000 - val_loss: 0.3049 - val_accuracy: 0.9218
Confusion matrix: 
 [[538  35]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.85
Validation accuracy: 92.18
Validation recall: 68.29
Validation precision: 44.44
Validation AUC: 0.6393309616518124
Validation class accuracies: [0.9389179755671903, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 19 epochs
Epoch 40/65
239/239 - 94s - loss: 0.0048 - accuracy: 0.9995 - val_loss: 0.3019 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6357001975234579
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]

The metrics for job 3 with the best target metric are: 
Best cm: [[548  25]
 [ 13  28]]
Best normalized cm: [[0.956 0.044]
 [0.317 0.683]]
Best f1: 0.60
Best accuracy: 0.94
Best recall: 0.68
Best precision: 0.53
Best AUC: 0.66
Best class accuracies: [0.956369982547993, 0.6829268292682927]
Best epoch: 20
The number of epochs since last 1% equals the patience
Lr has been adjusted to 9.765625463842298e-07
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_213_1p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_213_1p5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_217_1b1_Tc_sc_Meditron_3_label_0_pred_0.png, [[0.032]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_218_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_218_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_2_label_1_pred_1.png, [[0.89]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_222_1b1_Lr_sc_Meditron_7_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_218_1p1_Pl_sc_Litt3200_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_215_1b2_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_213_2p2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[4.685e-06]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_204_2b5_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_3b2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_219_2b1_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_205_4b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_223_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_218_1b1_Al_sc_Meditron_8_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_203_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[2.402e-05]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_213_1p2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_213_2p2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_224_1b2_Al_sc_Meditron_3_label_0_pred_0.png, [[0.077]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b3_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_213_1p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_218_1p1_Pl_sc_Litt3200_0_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.102]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_3b2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_213_1p5_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_204_7p5_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[1.034e-05]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_204_7p5_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_221_2b3_Al_mc_LittC2SE_1_label_0_pred_0.png, [[0.396]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[0.041]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_225_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_221_2b3_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.488]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_218_1b1_Pr_sc_Meditron_1_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_213_1p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[2.385e-05]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_1616__v39__mixup/3/icbhi_207_2b4_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.007]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 14082
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210708_171333-30tc2pup/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210708_171333-30tc2pup/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99948
wandb:         val_accuracy 0.92345
wandb:             _runtime 5920
wandb:           _timestamp 1625770333
wandb:                _step 300
wandb:           train_loss 0.00478
wandb:             val_loss 0.30192
wandb:           val_recall 0.68293
wandb:        val_precision 0.45161
wandb:               val_f1 0.54369
wandb:              val_auc 0.6357
wandb:                   lr 0.0
wandb:          best_val_f1 0.59574
wandb:    best_val_accuracy 0.93811
wandb:   best_val_precision 0.5283
wandb:      best_val_recall 0.68293
wandb:             best_auc 0.66059
wandb:           best_epoch 20
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇▇▇█▇▇███████████████████████████████
wandb:     val_accuracy ▇▇▃▁▄▇█▄▅▇▆▇▇▇▃▆▅▆▇█▇▇▆▇▆▆▇▆▆▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▅▄▃▂▂▂▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▇▆▃█▇▁▁▅▃▁▃▁▃▁▆▂▇▂▂▂▃▂▃▂▅▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:       val_recall ▁▁▇██▆▅▇█▆▇▇▇▆▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:    val_precision ▁▁▅▄▅▇█▅▆▇▆▇▆▇▅▆▅▆▇▇▇▇▆▇▆▆▆▆▆▇▆▆▆▆▇▆▆▇▆▇
wandb:           val_f1 ▁▁▆▆▇▇▇▆▇▇▇█▇▇▆▇▇▇▇█▇█▇█▇▇▇▇▇▇▇▇▇▇█▇▇▇▇▇
wandb:          val_auc ▃▁██▇▇▆▇█▇▇█▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr █████████████████▃▃▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210708_171333-30tc2pup


 See logs at ../../new_cache/conv__2293__07_1616__v39__mixup/logs/