Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2153
Description:  mod9_diffarch
2021-05-20 15:07:06.557808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-20 15:07:09.099590: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-20 15:07:09.100551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-20 15:07:09.148164: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:09.148852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-20 15:07:09.148881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-20 15:07:09.152268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-20 15:07:09.152349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-20 15:07:09.153424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-20 15:07:09.153760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-20 15:07:09.154757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-20 15:07:09.155622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-20 15:07:09.155791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-20 15:07:09.155901: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:09.156870: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:09.157531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2153.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2153
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1trejkqr
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210520_150709-1trejkqr
wandb: Run `wandb offline` to turn off syncing.
2021-05-20 15:07:16.265374: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-20 15:07:16.265694: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:16.266754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-20 15:07:16.266843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-20 15:07:16.266929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-20 15:07:16.266957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-20 15:07:16.266985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-20 15:07:16.267012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-20 15:07:16.267039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-20 15:07:16.267066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-20 15:07:16.267092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-20 15:07:16.267240: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:16.268279: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:16.269147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-20 15:07:16.269220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-20 15:07:16.983191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-20 15:07:16.983236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-20 15:07:16.983244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-20 15:07:16.983511: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:16.984286: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:16.984958: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-20 15:07:16.985580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
mix_depth_group_convolution2d ( (None, 64, 625, 48)  1242        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 313, 48)  0           mix_depth_group_convolution2d[0][
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 313, 48)  192         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 32, 313, 32)  35840       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 32, 313, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 32)  128         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout (Dropout)               (None, 16, 156, 32)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 16, 156, 64)  27136       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 16, 156, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 64)    0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 64)    256         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 8, 78, 64)    0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 8, 78, 128)   91136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 8, 78, 128)   230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 128)   512         average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 4, 39, 128)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 4, 39, 256)   329728      dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 4, 39, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_5 (AveragePoo (None, 2, 19, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 2, 19, 256)   1024        average_pooling2d_5[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 2, 19, 256)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 2, 19, 512)   1249280     dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 2, 19, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,202,183
Trainable params: 6,160,577
Non-trainable params: 41,606
__________________________________________________________________________________________________
2021-05-20 15:07:56.680186: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-20 15:07:56.682165: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-20 15:08:00.196165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-20 15:08:00.920510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-20 15:08:00.931299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
binary
Epoch 1/80
263/263 - 249s - loss: 0.6475 - accuracy: 0.7004 - val_loss: 0.5119 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25597652311891367
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
263/263 - 241s - loss: 0.5902 - accuracy: 0.7219 - val_loss: 0.5045 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.2148926612181715
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
263/263 - 242s - loss: 0.5863 - accuracy: 0.7204 - val_loss: 0.5115 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17738348801371812
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
263/263 - 240s - loss: 0.5862 - accuracy: 0.7209 - val_loss: 0.5683 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25525096842660244
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
263/263 - 241s - loss: 0.5826 - accuracy: 0.7212 - val_loss: 0.6434 - val_accuracy: 0.7656
Confusion matrix: 
 [[822  48]
 [207  11]]
Validation f1: 7.94
Validation accuracy: 76.56
Validation recall: 5.05
Validation precision: 18.64
Validation AUC: 0.2129728012788597
Validation class accuracies: [0.9448275862068966, 0.05045871559633028]
TARGET: 1
target metric(test f1): 0.07942238267148015
column_sums: [1029   59]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
263/263 - 240s - loss: 0.5850 - accuracy: 0.7228 - val_loss: 0.5622 - val_accuracy: 0.7987
Confusion matrix: 
 [[869   1]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.87
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21251772212921857
Validation class accuracies: [0.9988505747126437, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1087    1]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
263/263 - 241s - loss: 0.5809 - accuracy: 0.7178 - val_loss: 0.5205 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2063615833835928
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
263/263 - 241s - loss: 0.5763 - accuracy: 0.7228 - val_loss: 0.5458 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.18041510685563175
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
263/263 - 240s - loss: 0.5700 - accuracy: 0.7264 - val_loss: 0.5212 - val_accuracy: 0.7923
Confusion matrix: 
 [[857  13]
 [213   5]]
Validation f1: 4.24
Validation accuracy: 79.23
Validation recall: 2.29
Validation precision: 27.78
Validation AUC: 0.20418530827017706
Validation class accuracies: [0.9850574712643678, 0.022935779816513763]
TARGET: 1
target metric(test f1): 0.04237288135593221
column_sums: [1070   18]
cm_sum: 1088
The training is defaulting to either class.
Epoch 10/80
263/263 - 240s - loss: 0.5719 - accuracy: 0.7288 - val_loss: 0.5308 - val_accuracy: 0.7868
Confusion matrix: 
 [[846  24]
 [208  10]]
Validation f1: 7.94
Validation accuracy: 78.68
Validation recall: 4.59
Validation precision: 29.41
Validation AUC: 0.21990558037279995
Validation class accuracies: [0.9724137931034482, 0.045871559633027525]
TARGET: 1
target metric(test f1): 0.07936507936507936
column_sums: [1054   34]
cm_sum: 1088
The training is defaulting to either class.
Epoch 11/80
263/263 - 242s - loss: 0.5682 - accuracy: 0.7259 - val_loss: 0.6379 - val_accuracy: 0.7298
Confusion matrix: 
 [[769 101]
 [193  25]]
Validation f1: 14.53
Validation accuracy: 72.98
Validation recall: 11.47
Validation precision: 19.84
Validation AUC: 0.22030073950105922
Validation class accuracies: [0.8839080459770114, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.14534883720930233
column_sums: [962 126]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 12/80
263/263 - 241s - loss: 0.5631 - accuracy: 0.7326 - val_loss: 0.5381 - val_accuracy: 0.7987
Confusion matrix: 
 [[868   2]
 [217   1]]
Validation f1: 0.90
Validation accuracy: 79.87
Validation recall: 0.46
Validation precision: 33.33
Validation AUC: 0.2101145170628709
Validation class accuracies: [0.9977011494252873, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.009049773755656108
column_sums: [1085    3]
cm_sum: 1088
The training is defaulting to either class.
Epoch 13/80
263/263 - 241s - loss: 0.5594 - accuracy: 0.7305 - val_loss: 0.5494 - val_accuracy: 0.7923
Confusion matrix: 
 [[857  13]
 [213   5]]
Validation f1: 4.24
Validation accuracy: 79.23
Validation recall: 2.29
Validation precision: 27.78
Validation AUC: 0.21948601212983776
Validation class accuracies: [0.9850574712643678, 0.022935779816513763]
TARGET: 1
target metric(test f1): 0.04237288135593221
column_sums: [1070   18]
cm_sum: 1088
The training is defaulting to either class.
Epoch 14/80
263/263 - 239s - loss: 0.5510 - accuracy: 0.7390 - val_loss: 0.6141 - val_accuracy: 0.7105
Confusion matrix: 
 [[734 136]
 [179  39]]
Validation f1: 19.85
Validation accuracy: 71.05
Validation recall: 17.89
Validation precision: 22.29
Validation AUC: 0.22639792283490126
Validation class accuracies: [0.8436781609195402, 0.17889908256880735]
TARGET: 1
target metric(test f1): 0.19847328244274812
column_sums: [913 175]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 15/80
263/263 - 241s - loss: 0.5423 - accuracy: 0.7376 - val_loss: 0.5584 - val_accuracy: 0.7665
Confusion matrix: 
 [[811  59]
 [195  23]]
Validation f1: 15.33
Validation accuracy: 76.65
Validation recall: 10.55
Validation precision: 28.05
Validation AUC: 0.23762776432513966
Validation class accuracies: [0.9321839080459771, 0.10550458715596331]
TARGET: 1
target metric(test f1): 0.15333333333333332
column_sums: [1006   82]
cm_sum: 1088
The training is defaulting to either class.
Epoch 16/80
263/263 - 240s - loss: 0.5372 - accuracy: 0.7462 - val_loss: 0.5890 - val_accuracy: 0.7564
Confusion matrix: 
 [[804  66]
 [199  19]]
Validation f1: 12.54
Validation accuracy: 75.64
Validation recall: 8.72
Validation precision: 22.35
Validation AUC: 0.23619401100327803
Validation class accuracies: [0.9241379310344827, 0.0871559633027523]
TARGET: 1
target metric(test f1): 0.12541254125412543
column_sums: [1003   85]
cm_sum: 1088
The training is defaulting to either class.
Epoch 17/80
263/263 - 239s - loss: 0.5243 - accuracy: 0.7533 - val_loss: 0.5230 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20901183207501514
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 18/80
263/263 - 240s - loss: 0.5202 - accuracy: 0.7526 - val_loss: 1.0012 - val_accuracy: 0.5956
Confusion matrix: 
 [[558 312]
 [128  90]]
Validation f1: 29.03
Validation accuracy: 59.56
Validation recall: 41.28
Validation precision: 22.39
Validation AUC: 0.21928848280250418
Validation class accuracies: [0.6413793103448275, 0.41284403669724773]
TARGET: 1
target metric(test f1): 0.29032258064516125
column_sums: [686 402]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 19/80
263/263 - 240s - loss: 0.5064 - accuracy: 0.7600 - val_loss: 1.9535 - val_accuracy: 0.4835
Confusion matrix: 
 [[364 506]
 [ 56 162]]
Validation f1: 36.57
Validation accuracy: 48.35
Validation recall: 74.31
Validation precision: 24.25
Validation AUC: 0.2372984391179331
Validation class accuracies: [0.41839080459770117, 0.7431192660550459]
TARGET: 1
target metric(test f1): 0.3656884875846501
column_sums: [420 668]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 20/80
263/263 - 241s - loss: 0.4822 - accuracy: 0.7831 - val_loss: 0.7225 - val_accuracy: 0.6829
Confusion matrix: 
 [[716 154]
 [191  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 13.53
Validation accuracy: 68.29
Validation recall: 12.39
Validation precision: 14.92
Validation AUC: 0.20853210369157388
Validation class accuracies: [0.8229885057471265, 0.12385321100917432]
TARGET: 1
target metric(test f1): 0.13533834586466167
column_sums: [907 181]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 1 epochs
Epoch 21/80
263/263 - 240s - loss: 0.4726 - accuracy: 0.7819 - val_loss: 0.5976 - val_accuracy: 0.7978
Confusion matrix: 
 [[863   7]
 [213   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 4.35
Validation accuracy: 79.78
Validation recall: 2.29
Validation precision: 41.67
Validation AUC: 0.22093660069250554
Validation class accuracies: [0.9919540229885058, 0.022935779816513763]
TARGET: 1
target metric(test f1): 0.043478260869565216
column_sums: [1076   12]
cm_sum: 1088
The training is defaulting to either class.
Epoch 22/80
263/263 - 241s - loss: 0.4524 - accuracy: 0.7917 - val_loss: 1.0202 - val_accuracy: 0.5938
Confusion matrix: 
 [[526 344]
 [ 98 120]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 35.19
Validation accuracy: 59.38
Validation recall: 55.05
Validation precision: 25.86
Validation AUC: 0.2559438724622527
Validation class accuracies: [0.6045977011494252, 0.5504587155963303]
TARGET: 1
target metric(test f1): 0.35190615835777134
column_sums: [624 464]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 2 epochs
Epoch 23/80
263/263 - 240s - loss: 0.4257 - accuracy: 0.8046 - val_loss: 0.8591 - val_accuracy: 0.6958
Confusion matrix: 
 [[713 157]
 [174  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 21.00
Validation accuracy: 69.58
Validation recall: 20.18
Validation precision: 21.89
Validation AUC: 0.2349385996555447
Validation class accuracies: [0.8195402298850575, 0.2018348623853211]
TARGET: 1
target metric(test f1): 0.21002386634844872
column_sums: [887 201]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 3 epochs
Epoch 24/80
263/263 - 241s - loss: 0.4174 - accuracy: 0.8165 - val_loss: 0.8158 - val_accuracy: 0.7656
Confusion matrix: 
 [[816  54]
 [201  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 11.76
Validation accuracy: 76.56
Validation recall: 7.80
Validation precision: 23.94
Validation AUC: 0.21951730822595983
Validation class accuracies: [0.9379310344827586, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [1017   71]
cm_sum: 1088
The training is defaulting to either class.
Epoch 25/80
263/263 - 240s - loss: 0.3966 - accuracy: 0.8210 - val_loss: 0.9541 - val_accuracy: 0.6452
Confusion matrix: 
 [[644 226]
 [160  58]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.11
Validation accuracy: 64.52
Validation recall: 26.61
Validation precision: 20.42
Validation AUC: 0.21666382046691254
Validation class accuracies: [0.7402298850574712, 0.26605504587155965]
TARGET: 1
target metric(test f1): 0.2310756972111554
column_sums: [804 284]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 4 epochs
Epoch 26/80
263/263 - 240s - loss: 0.3145 - accuracy: 0.8649 - val_loss: 0.8142 - val_accuracy: 0.6829
Confusion matrix: 
 [[685 185]
 [160  58]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.16
Validation accuracy: 68.29
Validation recall: 26.61
Validation precision: 23.87
Validation AUC: 0.23610858837377702
Validation class accuracies: [0.7873563218390804, 0.26605504587155965]
TARGET: 1
target metric(test f1): 0.25162689804772237
column_sums: [845 243]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 5 epochs
Epoch 27/80
263/263 - 241s - loss: 0.2877 - accuracy: 0.8789 - val_loss: 0.7373 - val_accuracy: 0.7344
Confusion matrix: 
 [[774  96]
 [193  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 14.75
Validation accuracy: 73.44
Validation recall: 11.47
Validation precision: 20.66
Validation AUC: 0.23542619069440665
Validation class accuracies: [0.8896551724137931, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.14749262536873156
column_sums: [967 121]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 6 epochs
Epoch 28/80
263/263 - 241s - loss: 0.2737 - accuracy: 0.8908 - val_loss: 0.7750 - val_accuracy: 0.7206
Confusion matrix: 
 [[747 123]
 [181  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 19.58
Validation accuracy: 72.06
Validation recall: 16.97
Validation precision: 23.12
Validation AUC: 0.2305371617752585
Validation class accuracies: [0.8586206896551725, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.19576719576719576
column_sums: [928 160]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 7 epochs
Epoch 29/80
263/263 - 241s - loss: 0.2550 - accuracy: 0.8947 - val_loss: 0.8722 - val_accuracy: 0.6958
Confusion matrix: 
 [[709 161]
 [170  48]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 22.48
Validation accuracy: 69.58
Validation recall: 22.02
Validation precision: 22.97
Validation AUC: 0.23529249132382318
Validation class accuracies: [0.8149425287356322, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.22482435597189698
column_sums: [879 209]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 8 epochs
Epoch 30/80
263/263 - 240s - loss: 0.2298 - accuracy: 0.9047 - val_loss: 1.0652 - val_accuracy: 0.6397
Confusion matrix: 
 [[626 244]
 [148  70]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.32
Validation accuracy: 63.97
Validation recall: 32.11
Validation precision: 22.29
Validation AUC: 0.22535676326666448
Validation class accuracies: [0.7195402298850575, 0.3211009174311927]
TARGET: 1
target metric(test f1): 0.2631578947368421
column_sums: [774 314]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 9 epochs
Epoch 31/80
263/263 - 240s - loss: 0.2240 - accuracy: 0.9018 - val_loss: 1.1351 - val_accuracy: 0.6415
Confusion matrix: 
 [[633 237]
 [153  65]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.00
Validation accuracy: 64.15
Validation recall: 29.82
Validation precision: 21.52
Validation AUC: 0.22201991864619858
Validation class accuracies: [0.7275862068965517, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.25
column_sums: [786 302]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 10 epochs
Epoch 32/80
263/263 - 240s - loss: 0.2128 - accuracy: 0.9152 - val_loss: 1.0394 - val_accuracy: 0.6562
Confusion matrix: 
 [[658 212]
 [162  56]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.05
Validation accuracy: 65.62
Validation recall: 25.69
Validation precision: 20.90
Validation AUC: 0.22240566216356555
Validation class accuracies: [0.7563218390804598, 0.25688073394495414]
TARGET: 1
target metric(test f1): 0.23045267489711935
column_sums: [820 268]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 11 epochs
Epoch 33/80
263/263 - 240s - loss: 0.2227 - accuracy: 0.9073 - val_loss: 1.1236 - val_accuracy: 0.6553
Confusion matrix: 
 [[650 220]
 [155  63]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.15
Validation accuracy: 65.53
Validation recall: 28.90
Validation precision: 22.26
Validation AUC: 0.22138653207261522
Validation class accuracies: [0.7471264367816092, 0.2889908256880734]
TARGET: 1
target metric(test f1): 0.251497005988024
column_sums: [805 283]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 12 epochs
Epoch 34/80
263/263 - 240s - loss: 0.2034 - accuracy: 0.9197 - val_loss: 1.1392 - val_accuracy: 0.6388
Confusion matrix: 
 [[626 244]
 [149  69]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.99
Validation accuracy: 63.88
Validation recall: 31.65
Validation precision: 22.04
Validation AUC: 0.22657231526734256
Validation class accuracies: [0.7195402298850575, 0.3165137614678899]
TARGET: 1
target metric(test f1): 0.2598870056497175
column_sums: [775 313]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 13 epochs
Epoch 35/80
263/263 - 240s - loss: 0.2124 - accuracy: 0.9133 - val_loss: 1.1727 - val_accuracy: 0.6305
Confusion matrix: 
 [[615 255]
 [147  71]]
Validation f1: 26.10
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 63.05
Validation recall: 32.57
Validation precision: 21.78
Validation AUC: 0.22587157309651903
Validation class accuracies: [0.7068965517241379, 0.3256880733944954]
TARGET: 1
target metric(test f1): 0.26102941176470584
column_sums: [762 326]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 14 epochs
Epoch 36/80
263/263 - 243s - loss: 0.2189 - accuracy: 0.9118 - val_loss: 1.1130 - val_accuracy: 0.6369
Confusion matrix: 
 [[631 239]
 [156  62]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.89
Validation accuracy: 63.69
Validation recall: 28.44
Validation precision: 20.60
Validation AUC: 0.22577298772777568
Validation class accuracies: [0.725287356321839, 0.28440366972477066]
TARGET: 1
target metric(test f1): 0.23892100192678228
column_sums: [787 301]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 15 epochs
Epoch 37/80
263/263 - 240s - loss: 0.2059 - accuracy: 0.9175 - val_loss: 1.1590 - val_accuracy: 0.6360
Confusion matrix: 
 [[626 244]
 [152  66]]
Validation f1: 25.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 63.60
Validation recall: 30.28
Validation precision: 21.29
Validation AUC: 0.2255745393244395
Validation class accuracies: [0.7195402298850575, 0.30275229357798167]
TARGET: 1
target metric(test f1): 0.25
column_sums: [778 310]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 16 epochs
Epoch 38/80
263/263 - 240s - loss: 0.2070 - accuracy: 0.9168 - val_loss: 1.1662 - val_accuracy: 0.6305
Confusion matrix: 
 [[620 250]
 [152  66]]
Validation f1: 24.72
Validation accuracy: 63.05
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 30.28
Validation precision: 20.89
Validation AUC: 0.2259448393014773
Validation class accuracies: [0.7126436781609196, 0.30275229357798167]
TARGET: 1
target metric(test f1): 0.2471910112359551
column_sums: [772 316]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 17 epochs
Epoch 39/80
263/263 - 240s - loss: 0.2072 - accuracy: 0.9161 - val_loss: 1.1543 - val_accuracy: 0.6360
Confusion matrix: 
 [[628 242]
 [154  64]]
Validation f1: 24.43
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 63.60
Validation recall: 29.36
Validation precision: 20.92
Validation AUC: 0.22575937927775983
Validation class accuracies: [0.7218390804597701, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.24427480916030533
column_sums: [782 306]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 18 epochs
Epoch 40/80
263/263 - 241s - loss: 0.2213 - accuracy: 0.9137 - val_loss: 1.1973 - val_accuracy: 0.6324
Confusion matrix: 
 [[615 255]
 [145  73]]
Validation f1: 26.74
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 63.24
Validation recall: 33.49
Validation precision: 22.26
Validation AUC: 0.22686517114597804
Validation class accuracies: [0.7068965517241379, 0.3348623853211009]
TARGET: 1
target metric(test f1): 0.2673992673992674
column_sums: [760 328]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 19 epochs
Epoch 41/80
263/263 - 241s - loss: 0.1999 - accuracy: 0.9171 - val_loss: 1.2045 - val_accuracy: 0.6278
Confusion matrix: 
 [[610 260]
 [145  73]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.50
Validation accuracy: 62.78
Validation recall: 33.49
Validation precision: 21.92
Validation AUC: 0.22842630696257174
Validation class accuracies: [0.7011494252873564, 0.3348623853211009]
TARGET: 1
target metric(test f1): 0.26497277676951003
column_sums: [755 333]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 20 epochs
Epoch 42/80
263/263 - 240s - loss: 0.2072 - accuracy: 0.9154 - val_loss: 1.1481 - val_accuracy: 0.6342
Confusion matrix: 
 [[625 245]
 [153  65]]
Validation f1: 24.62
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 63.42
Validation recall: 29.82
Validation precision: 20.97
Validation AUC: 0.22625785606473456
Validation class accuracies: [0.7183908045977011, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.24621212121212122
column_sums: [778 310]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 21 epochs
Epoch 43/80
263/263 - 241s - loss: 0.2056 - accuracy: 0.9216 - val_loss: 1.2006 - val_accuracy: 0.6324
Confusion matrix: 
 [[615 255]
 [145  73]]
Validation f1: 26.74
Validation accuracy: 63.24
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 33.49
Validation precision: 22.26
Validation AUC: 0.2270042231008489
Validation class accuracies: [0.7068965517241379, 0.3348623853211009]
TARGET: 1
target metric(test f1): 0.2673992673992674
column_sums: [760 328]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 22 epochs
Epoch 44/80
263/263 - 241s - loss: 0.2057 - accuracy: 0.9178 - val_loss: 1.1772 - val_accuracy: 0.6296
Confusion matrix: 
 [[620 250]
 [153  65]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.39
Validation accuracy: 62.96
Validation recall: 29.82
Validation precision: 20.63
Validation AUC: 0.22531910455101983
Validation class accuracies: [0.7126436781609196, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.2439024390243902
column_sums: [773 315]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 23 epochs
Epoch 45/80
263/263 - 240s - loss: 0.2050 - accuracy: 0.9235 - val_loss: 1.1880 - val_accuracy: 0.6342
Confusion matrix: 
 [[621 249]
 [149  69]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.75
Validation accuracy: 63.42
Validation recall: 31.65
Validation precision: 21.70
Validation AUC: 0.2277407990343162
Validation class accuracies: [0.7137931034482758, 0.3165137614678899]
TARGET: 1
target metric(test f1): 0.2574626865671642
column_sums: [770 318]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.3656884875846501 hasn't increased by 0 in 24 epochs
Epoch 46/80
263/263 - 240s - loss: 0.1988 - accuracy: 0.9204 - val_loss: 1.1681 - val_accuracy: 0.6360
Confusion matrix: 
 [[623 247]
 [149  69]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.84
Validation accuracy: 63.60
Validation recall: 31.65
Validation precision: 21.84
Validation AUC: 0.22827948644667861
Validation class accuracies: [0.7160919540229885, 0.3165137614678899]

The metrics for the epoch with the best target metric are: 
Best cm: [[364 506]
 [ 56 162]]
Best f1: 0.3656884875846501
Best accuracy: 0.4834558823529412
Best recall: 0.7431192660550459
Best precision: 0.24251497005988024
Best AUC: 0.2372984391179331
Best epoch: 19
TARGET: 1
target metric(test f1): 0.2584269662921348
column_sums: [772 316]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 11
Starting...
CM: [[30 30]
 [ 7  8]]
F1: 0.3018867924528302
AUC: 0.4185964912280702
Accuracy: 0.5066666666666667
Precision: 0.21052631578947367
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_11.xls...
Done.
Epoch: 11
Starting...
CM: [[44 16]
 [11  4]]
F1: 0.2285714285714286
AUC: 0.3066666666666667
Accuracy: 0.64
Precision: 0.2
Recall: 0.26666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_11.xls...
Done.
Epoch: 11
Starting...
CM: [[55  5]
 [15  0]]
F1: 0.0
AUC: 0.1
Accuracy: 0.7333333333333333
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_11.xls...
Done.
Epoch: 14
Starting...
CM: [[25 35]
 [ 6  9]]
F1: 0.30508474576271183
AUC: 0.4422727272727273
Accuracy: 0.4533333333333333
Precision: 0.20454545454545456
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_14.xls...
Done.
Epoch: 14
Starting...
CM: [[41 19]
 [ 6  9]]
F1: 0.41860465116279066
AUC: 0.5007142857142857
Accuracy: 0.6666666666666666
Precision: 0.32142857142857145
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_14.xls...
Done.
Epoch: 14
Starting...
CM: [[55  5]
 [13  2]]
F1: 0.18181818181818182
AUC: 0.29619047619047617
Accuracy: 0.76
Precision: 0.2857142857142857
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_14.xls...
Done.
Epoch: 18
Starting...
CM: [[ 7 53]
 [ 1 14]]
F1: 0.34146341463414637
AUC: 0.5778109452736317
Accuracy: 0.28
Precision: 0.208955223880597
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_18.xls...
Done.
Epoch: 18
Starting...
CM: [[23 37]
 [ 2 13]]
F1: 0.4
AUC: 0.5766666666666667
Accuracy: 0.48
Precision: 0.26
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_18.xls...
Done.
Epoch: 18
Starting...
CM: [[39 21]
 [ 5 10]]
F1: 0.4347826086956521
AUC: 0.5279569892473118
Accuracy: 0.6533333333333333
Precision: 0.3225806451612903
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_18.xls...
Done.
Epoch: 19
Starting...
CM: [[ 5 55]
 [ 0 15]]
F1: 0.35294117647058826
AUC: 0.6071428571428571
Accuracy: 0.26666666666666666
Precision: 0.21428571428571427
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_19.xls...
Done.
Epoch: 19
Starting...
CM: [[ 9 51]
 [ 1 14]]
F1: 0.3500000000000001
AUC: 0.5810256410256411
Accuracy: 0.30666666666666664
Precision: 0.2153846153846154
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_19.xls...
Done.
Epoch: 19
Starting...
CM: [[19 41]
 [ 1 14]]
F1: 0.3999999999999999
AUC: 0.6006060606060606
Accuracy: 0.44
Precision: 0.2545454545454545
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_19.xls...
Done.
Epoch: 80
Starting...
CM: [[12 48]
 [ 1 14]]
F1: 0.36363636363636365
AUC: 0.5862365591397849
Accuracy: 0.3466666666666667
Precision: 0.22580645161290322
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[33 27]
 [ 7  8]]
F1: 0.32
AUC: 0.4276190476190477
Accuracy: 0.5466666666666666
Precision: 0.22857142857142856
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[44 16]
 [11  4]]
F1: 0.2285714285714286
AUC: 0.3066666666666667
Accuracy: 0.64
Precision: 0.2
Recall: 0.26666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 27307
wandb: Program ended successfully.
wandb: - 0.09MB of 0.09MB uploaded (0.00MB deduped)wandb: \ 0.09MB of 0.09MB uploaded (0.00MB deduped)wandb: | 0.09MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: - 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: | 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: - 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: | 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: - 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: | 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: - 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: | 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: - 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: | 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb: / 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210520_150709-1trejkqr/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210520_150709-1trejkqr/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9204
wandb:         val_accuracy 0.63603
wandb:             _runtime 12702
wandb:           _timestamp 1621535931
wandb:                _step 337
wandb:           train_loss 0.19879
wandb:             val_loss 1.1681
wandb:           val_recall 0.31651
wandb:        val_precision 0.21835
wandb:               val_f1 0.25843
wandb:              val_auc 0.22828
wandb:                   lr 0.0
wandb:          best_val_f1 0.36569
wandb:    best_val_accuracy 0.48346
wandb:   best_val_precision 0.24251
wandb:      best_val_recall 0.74312
wandb:             best_auc 0.2373
wandb:           best_epoch 19
wandb:           best_bd_f1 0.43478
wandb:          best_bd_auc 0.52796
wandb:     best_bd_accuracy 0.65333
wandb:    best_bd_precision 0.32258
wandb:       best_bd_recall 0.66667
wandb:        best_bd_epoch 18
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▂▂▂▂▂▂▂▂▂▃▃▃▄▄▄▅▅▆▇▇▇▇█▇███████████
wandb:     val_accuracy ████▇████▆██▆▇█▃▁▅█▃▇▅▅▇▆▆▄▅▅▄▄▄▄▄▄▄▄▄▄▄
wandb:         _runtime ▁▁▁▁▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▇▇▇▇▇▇▇▇▇▇▇▆▆▆▆▆▅▅▅▄▄▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▁▂▁▁▁▁▂▁▁▂▁▁▃█▂▁▃▃▃▂▂▂▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:       val_recall ▁▁▁▁▁▁▁▁▁▂▁▁▃▂▁▅█▂▁▆▂▄▄▂▃▃▄▃▄▄▄▄▄▄▄▄▄▄▄▄
wandb:    val_precision ▁▁▁▁▄▁▁▆▆▄▇▆▅▆▁▅▅▄█▅▅▄▅▄▅▅▅▅▅▅▅▄▅▅▅▅▅▅▄▅
wandb:           val_f1 ▁▁▁▁▃▁▁▂▃▄▁▂▅▄▁▇█▄▂█▃▅▆▄▅▅▆▅▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          val_auc █▄▁█▄▄▄▃▅▅▄▅▅▆▄▅▆▄▅█▅▄▆▆▆▆▅▅▅▅▅▅▅▅▅▆▅▅▅▅
wandb:               lr ██████████████████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 16 media file(s), 12 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2153: https://wandb.ai/arachid1/tensorboard-integration/runs/1trejkqr


 See logs at ../../new_cache/conv__2153__05_1505__v29__mod9_diffarch/logs/