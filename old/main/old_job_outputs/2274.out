Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2274
Description:  mixup
2021-06-29 20:20:11.417856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-29 20:20:14.408071: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 20:20:14.409063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-29 20:20:14.458426: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:14.459139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 20:20:14.459172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 20:20:14.462950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 20:20:14.463067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 20:20:14.464192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 20:20:14.464504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 20:20:14.465564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 20:20:14.466463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 20:20:14.466625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 20:20:14.466767: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:14.467625: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:14.468328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2274.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2274__06_2019__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 20:20:19.732018: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 20:20:19.732362: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:19.733125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 20:20:19.733185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 20:20:19.733290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 20:20:19.733326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 20:20:19.733356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 20:20:19.733387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 20:20:19.733415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 20:20:19.733442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 20:20:19.733467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 20:20:19.733618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:19.734405: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:19.735115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-29 20:20:19.735178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 20:20:20.605932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-29 20:20:20.605982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-29 20:20:20.605999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-29 20:20:20.606337: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:20.607181: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:20.607941: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 20:20:20.608659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-29 20:20:21.887015: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-29 20:20:21.889575: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-29 20:22:02.469465: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 20:22:12.439982: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2616
2021-06-29 20:22:22.477968: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 2616
2021-06-29 20:22:32.379229: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 2616
2021-06-29 20:22:42.599098: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2485 of 2616
2021-06-29 20:22:52.618723: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2514 of 2616
2021-06-29 20:23:02.788260: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2547 of 2616
2021-06-29 20:23:12.799673: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2580 of 2616
2021-06-29 20:23:22.100633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-06-29 20:23:22.115677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 20:23:23.844722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 20:23:24.367245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 2616
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
164/164 - 161s - loss: 0.3532 - accuracy: 0.8402 - val_loss: 0.2452 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08527015402766094
Validation class accuracies: [1.0, 0.0]
2021-06-29 20:24:53.039191: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 2616
2021-06-29 20:25:03.235658: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2616
2021-06-29 20:25:13.055871: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 2616
2021-06-29 20:25:23.057692: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 2616
2021-06-29 20:25:33.168531: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2474 of 2616
2021-06-29 20:25:43.576077: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2497 of 2616
2021-06-29 20:25:53.205169: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2529 of 2616
2021-06-29 20:26:03.122084: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2567 of 2616
2021-06-29 20:26:13.510305: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2607 of 2616
2021-06-29 20:26:15.654713: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
164/164 - 157s - loss: 0.1699 - accuracy: 0.8964 - val_loss: 0.2614 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1332402231319267
Validation class accuracies: [1.0, 0.0]
2021-06-29 20:27:39.751484: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2616
2021-06-29 20:27:49.818602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 2616
2021-06-29 20:27:59.944014: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 2616
2021-06-29 20:28:10.635712: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2459 of 2616
2021-06-29 20:28:20.052876: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2493 of 2616
2021-06-29 20:28:30.633305: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2534 of 2616
2021-06-29 20:28:39.726783: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2564 of 2616
2021-06-29 20:28:49.688438: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2596 of 2616
2021-06-29 20:28:58.766999: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
164/164 - 155s - loss: 0.1246 - accuracy: 0.9109 - val_loss: 0.3410 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16480157482914387
Validation class accuracies: [1.0, 0.0]
2021-06-29 20:30:25.232374: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2616
2021-06-29 20:30:35.284949: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2616
2021-06-29 20:30:45.219129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 2616
2021-06-29 20:30:55.420165: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 2616
2021-06-29 20:31:05.316410: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 2616
2021-06-29 20:31:15.818453: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2616
2021-06-29 20:31:25.205264: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2552 of 2616
2021-06-29 20:31:35.211546: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2585 of 2616
2021-06-29 20:31:43.264805: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
164/164 - 154s - loss: 0.0981 - accuracy: 0.9243 - val_loss: 0.2626 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5720052842233844
Validation class accuracies: [1.0, 0.0]
2021-06-29 20:33:09.299243: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2616
2021-06-29 20:33:19.466690: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2616
2021-06-29 20:33:29.326848: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 2616
2021-06-29 20:33:39.419544: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 2616
2021-06-29 20:33:49.411144: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2494 of 2616
2021-06-29 20:33:59.689878: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2525 of 2616
2021-06-29 20:34:09.413437: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2554 of 2616
2021-06-29 20:34:19.367762: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2588 of 2616
2021-06-29 20:34:27.269149: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 4 epochs
Epoch 5/65
164/164 - 153s - loss: 0.0795 - accuracy: 0.9300 - val_loss: 0.1433 - val_accuracy: 0.9495
Confusion matrix: 
 [[561  12]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.463 0.537]]
Validation f1: 58.67
Validation accuracy: 94.95
Validation recall: 53.66
Validation precision: 64.71
Validation AUC: 0.6595461942942255
Validation class accuracies: [0.9790575916230366, 0.5365853658536586]
2021-06-29 20:35:52.432159: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 685 of 2616
2021-06-29 20:36:02.516994: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2616
2021-06-29 20:36:12.538550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 2616
2021-06-29 20:36:22.436930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 2616
2021-06-29 20:36:33.349408: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2490 of 2616
2021-06-29 20:36:42.878806: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2524 of 2616
2021-06-29 20:36:52.449094: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2550 of 2616
2021-06-29 20:37:02.476395: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2586 of 2616
2021-06-29 20:37:11.791979: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
164/164 - 156s - loss: 0.0641 - accuracy: 0.9350 - val_loss: 0.1344 - val_accuracy: 0.9495
Confusion matrix: 
 [[554  19]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.293 0.707]]
Validation f1: 65.17
Validation accuracy: 94.95
Validation recall: 70.73
Validation precision: 60.42
Validation AUC: 0.7148187562302539
Validation class accuracies: [0.9668411867364747, 0.7073170731707317]
2021-06-29 20:38:38.461419: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 20:38:48.515887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2616
2021-06-29 20:38:58.487319: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 2616
2021-06-29 20:39:08.565655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2461 of 2616
2021-06-29 20:39:18.325910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2490 of 2616
2021-06-29 20:39:28.988730: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2529 of 2616
2021-06-29 20:39:38.364818: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2566 of 2616
2021-06-29 20:39:48.378578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2607 of 2616
2021-06-29 20:39:51.210194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 7/65
164/164 - 149s - loss: 0.0536 - accuracy: 0.9381 - val_loss: 0.1801 - val_accuracy: 0.9446
Confusion matrix: 
 [[569   4]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.732 0.268]]
Validation f1: 39.29
Validation accuracy: 94.46
Validation recall: 26.83
Validation precision: 73.33
Validation AUC: 0.4999233825618918
Validation class accuracies: [0.9930191972076788, 0.2682926829268293]
2021-06-29 20:41:17.677279: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2616
2021-06-29 20:41:27.693713: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2616
2021-06-29 20:41:37.656831: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 2616
2021-06-29 20:41:47.660118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2464 of 2616
2021-06-29 20:41:58.004272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2498 of 2616
2021-06-29 20:42:07.785944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2528 of 2616
2021-06-29 20:42:18.296429: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2566 of 2616
2021-06-29 20:42:27.788508: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2601 of 2616
2021-06-29 20:42:30.845238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6516853932584269 hasn't increased by 0 in 1 epochs
Epoch 8/65
164/164 - 149s - loss: 0.0495 - accuracy: 0.9392 - val_loss: 0.4936 - val_accuracy: 0.8518
Confusion matrix: 
 [[488  85]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.852 0.148]
 [0.146 0.854]]
Validation f1: 43.48
Validation accuracy: 85.18
Validation recall: 85.37
Validation precision: 29.17
Validation AUC: 0.5719699567601958
Validation class accuracies: [0.8516579406631762, 0.8536585365853658]
2021-06-29 20:43:56.494996: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2616
2021-06-29 20:44:06.520030: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 2616
2021-06-29 20:44:16.540796: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 2616
2021-06-29 20:44:26.580281: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2470 of 2616
2021-06-29 20:44:36.818265: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 2616
2021-06-29 20:44:46.530205: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2545 of 2616
2021-06-29 20:44:56.420230: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2574 of 2616
2021-06-29 20:45:06.514641: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2603 of 2616
2021-06-29 20:45:12.114655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6516853932584269 hasn't increased by 0 in 2 epochs
Epoch 9/65
164/164 - 152s - loss: 0.0491 - accuracy: 0.9377 - val_loss: 0.2550 - val_accuracy: 0.9137
Confusion matrix: 
 [[531  42]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.268 0.732]]
Validation f1: 53.10
Validation accuracy: 91.37
Validation recall: 73.17
Validation precision: 41.67
Validation AUC: 0.5925749935166582
Validation class accuracies: [0.9267015706806283, 0.7317073170731707]
2021-06-29 20:46:38.232759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2616
2021-06-29 20:46:48.109747: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2616
2021-06-29 20:46:58.154231: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2616
2021-06-29 20:47:08.542166: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2467 of 2616
2021-06-29 20:47:18.108491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2503 of 2616
2021-06-29 20:47:28.235258: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2537 of 2616
2021-06-29 20:47:38.744568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2576 of 2616
2021-06-29 20:47:48.523786: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2599 of 2616
2021-06-29 20:47:51.702933: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6516853932584269 hasn't increased by 0 in 3 epochs
Epoch 10/65
164/164 - 149s - loss: 0.0464 - accuracy: 0.9392 - val_loss: 0.2064 - val_accuracy: 0.9463
Confusion matrix: 
 [[550  23]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.244 0.756]]
Validation f1: 65.26
Validation accuracy: 94.63
Validation recall: 75.61
Validation precision: 57.41
Validation AUC: 0.6957283667352429
Validation class accuracies: [0.9598603839441536, 0.7560975609756098]
2021-06-29 20:49:17.212370: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2616
2021-06-29 20:49:27.022118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 2616
2021-06-29 20:49:37.028343: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 2616
2021-06-29 20:49:47.313053: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2460 of 2616
2021-06-29 20:49:57.261025: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2496 of 2616
2021-06-29 20:50:07.204423: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2520 of 2616
2021-06-29 20:50:17.091682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2556 of 2616
2021-06-29 20:50:27.200929: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 2616
2021-06-29 20:50:34.382296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 11/65
164/164 - 153s - loss: 0.0418 - accuracy: 0.9392 - val_loss: 0.1955 - val_accuracy: 0.9463
Confusion matrix: 
 [[569   4]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.707 0.293]]
Validation f1: 42.11
Validation accuracy: 94.63
Validation recall: 29.27
Validation precision: 75.00
Validation AUC: 0.5442230918569114
Validation class accuracies: [0.9930191972076788, 0.2926829268292683]
2021-06-29 20:52:00.662866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 20:52:10.632439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2616
2021-06-29 20:52:20.625235: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 2616
2021-06-29 20:52:30.608892: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2473 of 2616
2021-06-29 20:52:40.608252: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2508 of 2616
2021-06-29 20:52:50.524310: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2542 of 2616
2021-06-29 20:53:00.935138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2574 of 2616
2021-06-29 20:53:11.356852: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2606 of 2616
2021-06-29 20:53:13.212314: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6526315789473683 hasn't increased by 0 in 1 epochs
Epoch 12/65
164/164 - 149s - loss: 0.0430 - accuracy: 0.9388 - val_loss: 0.1844 - val_accuracy: 0.9495
Confusion matrix: 
 [[562  11]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.488 0.512]]
Validation f1: 57.53
Validation accuracy: 94.95
Validation recall: 51.22
Validation precision: 65.62
Validation AUC: 0.6725546203441228
Validation class accuracies: [0.9808027923211169, 0.5121951219512195]
2021-06-29 20:54:38.925635: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2616
2021-06-29 20:54:49.008585: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 2616
2021-06-29 20:54:58.970977: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 2616
2021-06-29 20:55:08.915898: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2462 of 2616
2021-06-29 20:55:18.928074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 2616
2021-06-29 20:55:29.349668: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2616
2021-06-29 20:55:39.064852: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2556 of 2616
2021-06-29 20:55:49.349440: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2598 of 2616
2021-06-29 20:55:52.576734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6526315789473683 hasn't increased by 0 in 2 epochs
Epoch 13/65
164/164 - 151s - loss: 0.0386 - accuracy: 0.9396 - val_loss: 0.1799 - val_accuracy: 0.9463
Confusion matrix: 
 [[554  19]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.341 0.659]]
Validation f1: 62.07
Validation accuracy: 94.63
Validation recall: 65.85
Validation precision: 58.70
Validation AUC: 0.6301954355679702
Validation class accuracies: [0.9668411867364747, 0.6585365853658537]
2021-06-29 20:57:19.185263: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 20:57:29.230633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2616
2021-06-29 20:57:39.248360: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 2616
2021-06-29 20:57:49.290617: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2464 of 2616
2021-06-29 20:57:59.180647: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2494 of 2616
2021-06-29 20:58:09.400975: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2527 of 2616
2021-06-29 20:58:19.807629: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2556 of 2616
2021-06-29 20:58:29.164775: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2593 of 2616
2021-06-29 20:58:34.616294: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6526315789473683 hasn't increased by 0 in 3 epochs
Epoch 14/65
164/164 - 152s - loss: 0.0397 - accuracy: 0.9396 - val_loss: 0.1877 - val_accuracy: 0.9495
Confusion matrix: 
 [[552  21]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.244 0.756]]
Validation f1: 66.67
Validation accuracy: 94.95
Validation recall: 75.61
Validation precision: 59.62
Validation AUC: 0.7045018261551537
Validation class accuracies: [0.9633507853403142, 0.7560975609756098]
2021-06-29 21:00:00.542347: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 21:00:10.685882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 2616
2021-06-29 21:00:20.679389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 2616
2021-06-29 21:00:31.266663: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2478 of 2616
2021-06-29 21:00:41.284343: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2508 of 2616
2021-06-29 21:00:51.372818: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 2616
2021-06-29 21:01:00.592653: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2616
2021-06-29 21:01:10.582370: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2606 of 2616
2021-06-29 21:01:13.270696: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 15/65
164/164 - 149s - loss: 0.0383 - accuracy: 0.9396 - val_loss: 0.2205 - val_accuracy: 0.9511
Confusion matrix: 
 [[559  14]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.39  0.61 ]]
Validation f1: 62.50
Validation accuracy: 95.11
Validation recall: 60.98
Validation precision: 64.10
Validation AUC: 0.6461595343224541
Validation class accuracies: [0.9755671902268761, 0.6097560975609756]
2021-06-29 21:02:39.834391: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 21:02:49.987384: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2616
2021-06-29 21:02:59.753755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1956 of 2616
2021-06-29 21:03:09.941344: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2470 of 2616
2021-06-29 21:03:19.799774: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2503 of 2616
2021-06-29 21:03:30.005037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2530 of 2616
2021-06-29 21:03:40.195088: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2558 of 2616
2021-06-29 21:03:50.313426: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2597 of 2616
2021-06-29 21:03:53.363555: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 1 epochs
Epoch 16/65
164/164 - 151s - loss: 0.0426 - accuracy: 0.9385 - val_loss: 0.2192 - val_accuracy: 0.9495
Confusion matrix: 
 [[570   3]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.683 0.317]]
Validation f1: 45.61
Validation accuracy: 94.95
Validation recall: 31.71
Validation precision: 81.25
Validation AUC: 0.5992843696559924
Validation class accuracies: [0.9947643979057592, 0.3170731707317073]
2021-06-29 21:05:20.952342: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 21:05:31.134439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2616
2021-06-29 21:05:41.221978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2616
2021-06-29 21:05:51.390288: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2465 of 2616
2021-06-29 21:06:01.464475: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2490 of 2616
2021-06-29 21:06:11.189284: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2523 of 2616
2021-06-29 21:06:21.213648: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2561 of 2616
2021-06-29 21:06:30.996806: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2595 of 2616
2021-06-29 21:06:37.054772: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 2 epochs
Epoch 17/65
164/164 - 152s - loss: 0.0385 - accuracy: 0.9396 - val_loss: 0.1794 - val_accuracy: 0.9479
Confusion matrix: 
 [[557  16]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.39  0.61 ]]
Validation f1: 60.98
Validation accuracy: 94.79
Validation recall: 60.98
Validation precision: 60.98
Validation AUC: 0.6174699657577458
Validation class accuracies: [0.9720767888307156, 0.6097560975609756]
2021-06-29 21:08:03.278900: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 2616
2021-06-29 21:08:13.476128: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2616
2021-06-29 21:08:23.477621: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2616
2021-06-29 21:08:33.429619: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2467 of 2616
2021-06-29 21:08:43.808076: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 2616
2021-06-29 21:08:53.365489: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2537 of 2616
2021-06-29 21:09:03.241293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2569 of 2616
2021-06-29 21:09:13.643510: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2602 of 2616
2021-06-29 21:09:18.152563: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 3 epochs
Epoch 18/65
164/164 - 150s - loss: 0.0373 - accuracy: 0.9396 - val_loss: 0.3273 - val_accuracy: 0.8974
Confusion matrix: 
 [[519  54]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.22  0.78 ]]
Validation f1: 50.39
Validation accuracy: 89.74
Validation recall: 78.05
Validation precision: 37.21
Validation AUC: 0.5757548536771542
Validation class accuracies: [0.9057591623036649, 0.7804878048780488]
2021-06-29 21:10:42.873934: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2616
2021-06-29 21:10:52.877026: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 2616
2021-06-29 21:11:02.888286: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 2616
2021-06-29 21:11:12.911889: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 2616
2021-06-29 21:11:22.941620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2513 of 2616
2021-06-29 21:11:33.215409: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2548 of 2616
2021-06-29 21:11:43.134390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2582 of 2616
2021-06-29 21:11:53.282139: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2612 of 2616
2021-06-29 21:11:54.140717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 4 epochs
Epoch 19/65
164/164 - 148s - loss: 0.0369 - accuracy: 0.9396 - val_loss: 0.2029 - val_accuracy: 0.9397
Confusion matrix: 
 [[550  23]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.341 0.659]]
Validation f1: 59.34
Validation accuracy: 93.97
Validation recall: 65.85
Validation precision: 54.00
Validation AUC: 0.6236252733394195
Validation class accuracies: [0.9598603839441536, 0.6585365853658537]
2021-06-29 21:13:21.386453: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 21:13:31.209607: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2616
2021-06-29 21:13:41.305734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2616
2021-06-29 21:13:51.661463: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2470 of 2616
2021-06-29 21:14:01.738467: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2497 of 2616
2021-06-29 21:14:11.509922: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2534 of 2616
2021-06-29 21:14:21.984392: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2568 of 2616
2021-06-29 21:14:31.454841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2605 of 2616
2021-06-29 21:14:33.040330: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 5 epochs
Epoch 20/65
164/164 - 148s - loss: 0.0386 - accuracy: 0.9392 - val_loss: 1.0511 - val_accuracy: 0.7655
Confusion matrix: 
 [[435 138]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.759 0.241]
 [0.146 0.854]]
Validation f1: 32.71
Validation accuracy: 76.55
Validation recall: 85.37
Validation precision: 20.23
Validation AUC: 0.4383372192412779
Validation class accuracies: [0.7591623036649214, 0.8536585365853658]
2021-06-29 21:15:59.666989: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 21:16:09.463507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2616
2021-06-29 21:16:19.589710: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 2616
2021-06-29 21:16:29.592763: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2469 of 2616
2021-06-29 21:16:39.470389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2496 of 2616
2021-06-29 21:16:49.911776: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2532 of 2616
2021-06-29 21:16:59.520623: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2567 of 2616
2021-06-29 21:17:09.471971: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2605 of 2616
2021-06-29 21:17:12.461443: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 21/65
164/164 - 150s - loss: 0.0371 - accuracy: 0.9392 - val_loss: 0.1664 - val_accuracy: 0.9495
Confusion matrix: 
 [[558  15]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.39  0.61 ]]
Validation f1: 61.73
Validation accuracy: 94.95
Validation recall: 60.98
Validation precision: 62.50
Validation AUC: 0.6686026681189742
Validation class accuracies: [0.9738219895287958, 0.6097560975609756]
2021-06-29 21:18:38.672456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2616
2021-06-29 21:18:48.874247: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 2616
2021-06-29 21:18:58.780227: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2081 of 2616
2021-06-29 21:19:08.818955: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2476 of 2616
2021-06-29 21:19:19.002029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2519 of 2616
2021-06-29 21:19:28.936785: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2549 of 2616
2021-06-29 21:19:38.893934: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2578 of 2616
2021-06-29 21:19:49.219194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2614 of 2616
2021-06-29 21:19:49.744163: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 7 epochs
Epoch 22/65
164/164 - 149s - loss: 0.0363 - accuracy: 0.9396 - val_loss: 0.1758 - val_accuracy: 0.9463
Confusion matrix: 
 [[552  21]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.293 0.707]]
Validation f1: 63.74
Validation accuracy: 94.63
Validation recall: 70.73
Validation precision: 58.00
Validation AUC: 0.656194127944043
Validation class accuracies: [0.9633507853403142, 0.7073170731707317]
2021-06-29 21:21:17.631529: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 21:21:27.618255: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2616
2021-06-29 21:21:37.519032: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 2616
2021-06-29 21:21:47.606152: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2470 of 2616
2021-06-29 21:21:57.624615: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2506 of 2616
2021-06-29 21:22:07.472325: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2542 of 2616
2021-06-29 21:22:17.535156: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2579 of 2616
2021-06-29 21:22:27.605386: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2615 of 2616
2021-06-29 21:22:27.788018: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 8 epochs
Epoch 23/65
164/164 - 148s - loss: 0.0359 - accuracy: 0.9396 - val_loss: 0.1971 - val_accuracy: 0.9430
Confusion matrix: 
 [[550  23]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.293 0.707]]
Validation f1: 62.37
Validation accuracy: 94.30
Validation recall: 70.73
Validation precision: 55.77
Validation AUC: 0.6613034047226415
Validation class accuracies: [0.9598603839441536, 0.7073170731707317]
2021-06-29 21:23:55.319745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 21:24:05.300624: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 2616
2021-06-29 21:24:15.267493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 2616
2021-06-29 21:24:25.191907: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2468 of 2616
2021-06-29 21:24:35.252492: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2498 of 2616
2021-06-29 21:24:45.598637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2535 of 2616
2021-06-29 21:24:55.999567: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2567 of 2616
2021-06-29 21:25:05.141520: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2605 of 2616
2021-06-29 21:25:08.225990: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 9 epochs
Epoch 24/65
164/164 - 151s - loss: 0.0349 - accuracy: 0.9396 - val_loss: 0.1836 - val_accuracy: 0.9463
Confusion matrix: 
 [[555  18]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.366 0.634]]
Validation f1: 61.18
Validation accuracy: 94.63
Validation recall: 63.41
Validation precision: 59.09
Validation AUC: 0.6545221782588965
Validation class accuracies: [0.9685863874345549, 0.6341463414634146]
2021-06-29 21:26:36.215097: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2616
2021-06-29 21:26:46.249682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 2616
2021-06-29 21:26:56.028952: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2081 of 2616
2021-06-29 21:27:06.101434: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2479 of 2616
2021-06-29 21:27:16.086436: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2519 of 2616
2021-06-29 21:27:26.566164: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2557 of 2616
2021-06-29 21:27:36.038945: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2597 of 2616
2021-06-29 21:27:43.039277: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 10 epochs
Epoch 25/65
164/164 - 145s - loss: 0.0347 - accuracy: 0.9396 - val_loss: 0.2046 - val_accuracy: 0.9414
Confusion matrix: 
 [[550  23]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.317 0.683]]
Validation f1: 60.87
Validation accuracy: 94.14
Validation recall: 68.29
Validation precision: 54.90
Validation AUC: 0.6482309883664311
Validation class accuracies: [0.9598603839441536, 0.6829268292682927]
2021-06-29 21:29:12.202515: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 2616
2021-06-29 21:29:22.145357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 2616
2021-06-29 21:29:32.059556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 2616
2021-06-29 21:29:42.594361: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2472 of 2616
2021-06-29 21:29:52.230488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2506 of 2616
2021-06-29 21:30:02.043365: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2553 of 2616
2021-06-29 21:30:12.586239: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2583 of 2616
2021-06-29 21:30:21.380573: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 11 epochs
Epoch 26/65
164/164 - 144s - loss: 0.0351 - accuracy: 0.9396 - val_loss: 0.2026 - val_accuracy: 0.9397
Confusion matrix: 
 [[551  22]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.366 0.634]]
Validation f1: 58.43
Validation accuracy: 93.97
Validation recall: 63.41
Validation precision: 54.17
Validation AUC: 0.630380152821663
Validation class accuracies: [0.9616055846422339, 0.6341463414634146]
2021-06-29 21:31:45.179312: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2616
2021-06-29 21:31:55.280251: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 2616
2021-06-29 21:32:05.128492: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 2616
2021-06-29 21:32:15.503335: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2472 of 2616
2021-06-29 21:32:25.474118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2522 of 2616
2021-06-29 21:32:35.056746: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2568 of 2616
2021-06-29 21:32:45.152835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2603 of 2616
2021-06-29 21:32:47.838196: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 27/65
164/164 - 137s - loss: 0.0346 - accuracy: 0.9396 - val_loss: 0.1869 - val_accuracy: 0.9495
Confusion matrix: 
 [[557  16]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.366 0.634]]
Validation f1: 62.65
Validation accuracy: 94.95
Validation recall: 63.41
Validation precision: 61.90
Validation AUC: 0.6583621879547203
Validation class accuracies: [0.9720767888307156, 0.6341463414634146]
2021-06-29 21:34:11.190361: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2616
2021-06-29 21:34:21.147042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 2616
2021-06-29 21:34:31.182731: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 2616
2021-06-29 21:34:41.251434: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2478 of 2616
2021-06-29 21:34:51.280686: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2527 of 2616
2021-06-29 21:35:01.467283: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2570 of 2616
2021-06-29 21:35:10.969081: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 13 epochs
Epoch 28/65
164/164 - 134s - loss: 0.0338 - accuracy: 0.9396 - val_loss: 0.1854 - val_accuracy: 0.9414
Confusion matrix: 
 [[552  21]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.366 0.634]]
Validation f1: 59.09
Validation accuracy: 94.14
Validation recall: 63.41
Validation precision: 55.32
Validation AUC: 0.6352112017479152
Validation class accuracies: [0.9633507853403142, 0.6341463414634146]
2021-06-29 21:36:34.317488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 2616
2021-06-29 21:36:44.210650: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 2616
2021-06-29 21:36:54.368067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 2616
2021-06-29 21:37:04.212782: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2472 of 2616
2021-06-29 21:37:14.644194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2517 of 2616
2021-06-29 21:37:24.278345: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2559 of 2616
2021-06-29 21:37:34.458855: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2610 of 2616
2021-06-29 21:37:35.063015: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 14 epochs
Epoch 29/65
164/164 - 135s - loss: 0.0338 - accuracy: 0.9396 - val_loss: 0.1851 - val_accuracy: 0.9430
Confusion matrix: 
 [[554  19]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.39  0.61 ]]
Validation f1: 58.82
Validation accuracy: 94.30
Validation recall: 60.98
Validation precision: 56.82
Validation AUC: 0.6363781676319352
Validation class accuracies: [0.9668411867364747, 0.6097560975609756]
2021-06-29 21:38:58.059107: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2616
2021-06-29 21:39:08.007144: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 2616
2021-06-29 21:39:17.962734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 2616
2021-06-29 21:39:28.048570: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2481 of 2616
2021-06-29 21:39:37.970636: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2528 of 2616
2021-06-29 21:39:47.976955: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 2616
2021-06-29 21:39:56.661759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 15 epochs
Epoch 30/65
164/164 - 133s - loss: 0.0344 - accuracy: 0.9396 - val_loss: 0.1923 - val_accuracy: 0.9414
Confusion matrix: 
 [[552  21]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.09
Validation accuracy: 94.14
Validation recall: 63.41
Validation precision: 55.32
Validation AUC: 0.6225117399886962
Validation class accuracies: [0.9633507853403142, 0.6341463414634146]
2021-06-29 21:41:19.759637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 2616
2021-06-29 21:41:29.959161: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 2616
2021-06-29 21:41:39.944366: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 2616
2021-06-29 21:41:49.842792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2481 of 2616
2021-06-29 21:41:59.851453: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2526 of 2616
2021-06-29 21:42:09.801371: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2570 of 2616
2021-06-29 21:42:19.925829: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2611 of 2616
2021-06-29 21:42:21.019104: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 16 epochs
Epoch 31/65
164/164 - 135s - loss: 0.0337 - accuracy: 0.9396 - val_loss: 0.1977 - val_accuracy: 0.9414
Confusion matrix: 
 [[551  22]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.341 0.659]]
Validation f1: 60.00
Validation accuracy: 94.14
Validation recall: 65.85
Validation precision: 55.10
Validation AUC: 0.63913010195543
Validation class accuracies: [0.9616055846422339, 0.6585365853658537]
2021-06-29 21:43:44.278372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 2616
2021-06-29 21:43:54.300958: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 2616
2021-06-29 21:44:04.225732: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2081 of 2616
2021-06-29 21:44:14.255649: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2474 of 2616
2021-06-29 21:44:24.314386: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2528 of 2616
2021-06-29 21:44:34.491505: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2576 of 2616
2021-06-29 21:44:44.047968: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 17 epochs
Epoch 32/65
164/164 - 134s - loss: 0.0332 - accuracy: 0.9396 - val_loss: 0.1856 - val_accuracy: 0.9414
Confusion matrix: 
 [[552  21]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.09
Validation accuracy: 94.14
Validation recall: 63.41
Validation precision: 55.32
Validation AUC: 0.6223621412681897
Validation class accuracies: [0.9633507853403142, 0.6341463414634146]
2021-06-29 21:46:07.207327: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 2616
2021-06-29 21:46:17.319228: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 2616
2021-06-29 21:46:27.203044: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 2616
2021-06-29 21:46:37.422858: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2481 of 2616
2021-06-29 21:46:47.292581: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2525 of 2616
2021-06-29 21:46:57.886360: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2566 of 2616
2021-06-29 21:47:07.449187: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2613 of 2616
2021-06-29 21:47:08.018766: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 33/65
164/164 - 134s - loss: 0.0331 - accuracy: 0.9396 - val_loss: 0.1876 - val_accuracy: 0.9414
Confusion matrix: 
 [[552  21]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.366 0.634]]
Validation f1: 59.09
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.14
Validation recall: 63.41
Validation precision: 55.32
Validation AUC: 0.619679819473816
Validation class accuracies: [0.9633507853403142, 0.6341463414634146]
2021-06-29 21:48:30.825921: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 2616
2021-06-29 21:48:40.809702: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 2616
2021-06-29 21:48:50.881197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 2616
2021-06-29 21:49:01.041939: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2487 of 2616
2021-06-29 21:49:11.066773: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2527 of 2616
2021-06-29 21:49:21.022210: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2572 of 2616
2021-06-29 21:49:30.162963: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 19 epochs
Epoch 34/65
164/164 - 133s - loss: 0.0330 - accuracy: 0.9396 - val_loss: 0.1923 - val_accuracy: 0.9446
Confusion matrix: 
 [[555  18]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.39  0.61 ]]
Validation f1: 59.52
Validation accuracy: 94.46
Validation recall: 60.98
Validation precision: 58.14
Validation AUC: 0.6180428173503585
Validation class accuracies: [0.9685863874345549, 0.6097560975609756]

The metrics for job 0 with the best target metric are: 
Best cm: [[552  21]
 [ 10  31]]
Best normalized cm: [[0.963 0.037]
 [0.244 0.756]]
Best f1: 0.67
Best accuracy: 0.95
Best recall: 0.76
Best precision: 0.60
Best AUC: 0.70
Best class accuracies: [0.9633507853403142, 0.7560975609756098]
Best epoch: 14
The number of epochs since last 1% equals the patience
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[6.235e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.035]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[5.685e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.037]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.304]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.72e-06]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[1.094e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.519]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.062]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[3.316e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[1.496e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.263e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[2.534e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[6.734e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[7.907e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[8.907e-05]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.036]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2274__06_2019__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.024]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 13786
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_202014-1vtbfcc7/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_202014-1vtbfcc7/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9396
wandb:         val_accuracy 0.94463
wandb:             _runtime 5428
wandb:           _timestamp 1625003442
wandb:                _step 249
wandb:           train_loss 0.03298
wandb:             val_loss 0.19234
wandb:           val_recall 0.60976
wandb:        val_precision 0.5814
wandb:               val_f1 0.59524
wandb:              val_auc 0.61804
wandb:                   lr 0.00013
wandb:          best_val_f1 0.66667
wandb:    best_val_accuracy 0.94951
wandb:   best_val_precision 0.59615
wandb:      best_val_recall 0.7561
wandb:             best_auc 0.7045
wandb:           best_epoch 14
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇▇█████████████████████████████
wandb:     val_accuracy ▇▇▇▇███▄▇████████▆█▁██████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▃▂▁▁▁▄▂▂▁▁▁▁▂▂▁▂▂█▁▁▁▁▂▂▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▁▁▁▅▇▃█▇▇▃▅▆▇▆▄▆▇▆█▆▇▇▆▇▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▁▁▁▇▆▇▄▅▆▇▇▆▆▇█▆▄▆▃▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_f1 ▁▁▁▁▇█▅▆▇█▅▇███▆▇▆▇▄▇██▇▇▇█▇▇▇▇▇▇▇
wandb:          val_auc ▁▂▂▆▇█▆▆▇█▆█▇█▇▇▇▆▇▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr ████████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_202014-1vtbfcc7


 See logs at ../../new_cache/conv__2274__06_2019__v39__mixup/logs/