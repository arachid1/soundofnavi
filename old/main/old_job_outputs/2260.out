Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2260
Description:  lstm
2021-06-27 18:38:56.830727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-27 18:38:59.126637: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 18:38:59.127575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-27 18:38:59.176138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:38:59.176887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 18:38:59.176918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 18:38:59.180722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 18:38:59.180806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 18:38:59.182004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 18:38:59.182308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 18:38:59.183402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 18:38:59.184379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 18:38:59.184538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 18:38:59.184649: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:38:59.185409: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:38:59.186079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2260.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2260__06_1838__v39__lstm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-27 18:39:04.033746: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 18:39:04.034020: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:39:04.034823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 18:39:04.034870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 18:39:04.034948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 18:39:04.034995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 18:39:04.035049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 18:39:04.035076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 18:39:04.035099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 18:39:04.035122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 18:39:04.035144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 18:39:04.035245: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:39:04.035998: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:39:04.036660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-27 18:39:04.036705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 18:39:04.742095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-27 18:39:04.742158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-27 18:39:04.742167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-27 18:39:04.742451: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:39:04.743347: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:39:04.744116: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:39:04.744835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-06-27 18:39:06.459170: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-27 18:39:06.460848: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-27 18:39:06.817346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 18:39:08.676723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 18:39:09.139665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 10, 125, 128, 1) 4            input_1[0][0]                        
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 10, 125, 128, 16 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed (None, 10, 125, 128, 16 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed (None, 10, 125, 128, 1) 0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed (None, 10, 125, 128, 16 2320         time_distributed[0][0]               
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed (None, 10, 125, 128, 16 6416         time_distributed_2[0][0]             
______________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed (None, 10, 125, 128, 16 32           time_distributed_4[0][0]             
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 10, 125, 128, 48 0            time_distributed_1[0][0]             
                                                                         time_distributed_3[0][0]             
                                                                         time_distributed_5[0][0]             
______________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed (None, 10, 63, 64, 48)  0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 10, 63, 64, 48)  192          time_distributed_6[0][0]             
______________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed (None, 10, 63, 64, 32)  1568         batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_9 (TimeDistributed (None, 10, 63, 64, 32)  1568         batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_11 (TimeDistribute (None, 10, 63, 64, 48)  0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_8 (TimeDistributed (None, 10, 63, 64, 32)  9248         time_distributed_7[0][0]             
______________________________________________________________________________________________________________
time_distributed_10 (TimeDistribute (None, 10, 63, 64, 32)  25632        time_distributed_9[0][0]             
______________________________________________________________________________________________________________
time_distributed_12 (TimeDistribute (None, 10, 63, 64, 32)  1568         time_distributed_11[0][0]            
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 10, 63, 64, 96)  0            time_distributed_8[0][0]             
                                                                         time_distributed_10[0][0]            
                                                                         time_distributed_12[0][0]            
______________________________________________________________________________________________________________
time_distributed_13 (TimeDistribute (None, 10, 32, 32, 96)  0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 10, 32, 32, 96)  384          time_distributed_13[0][0]            
______________________________________________________________________________________________________________
time_distributed_14 (TimeDistribute (None, 10, 96)          0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 10, 256)         230400       time_distributed_14[0][0]            
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 10, 256)         394240       bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 10, 128)         32896        bidirectional_1[0][0]                
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 10, 1)           129          dense[0][0]                          
______________________________________________________________________________________________________________
flatten (Flatten)                   (None, 10)              0            dense_1[0][0]                        
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               11           flatten[0][0]                        
==============================================================================================================
Total params: 706,672
Trainable params: 706,382
Non-trainable params: 290
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 64s - loss: 0.6554 - accuracy: 0.6534 - val_loss: 0.6704 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22771515196193565
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 58s - loss: 0.5599 - accuracy: 0.8438 - val_loss: 1.0297 - val_accuracy: 0.2410
Confusion matrix: 
 [[107 466]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.187 0.813]
 [0.    1.   ]]
Validation f1: 14.96
Validation accuracy: 24.10
Validation recall: 100.00
Validation precision: 8.09
Validation AUC: 0.4757242184046777
Validation class accuracies: [0.18673647469458987, 1.0]
Saving model...
Epoch 3/65
154/154 - 59s - loss: 0.5618 - accuracy: 0.8779 - val_loss: 2.1818 - val_accuracy: 0.0733
Confusion matrix: 
 [[  4 569]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.007 0.993]
 [0.    1.   ]]
Validation f1: 12.60
Validation accuracy: 7.33
Validation recall: 100.00
Validation precision: 6.72
Validation AUC: 0.40067517303300165
Validation class accuracies: [0.006980802792321117, 1.0]
The validation tracker metric at 0.14963503649635038 hasn't increased by 0 in 1 epochs
Epoch 4/65
154/154 - 59s - loss: 0.5093 - accuracy: 0.8735 - val_loss: 1.8436 - val_accuracy: 0.1938
Confusion matrix: 
 [[ 78 495]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.136 0.864]
 [0.    1.   ]]
Validation f1: 14.21
Validation accuracy: 19.38
Validation recall: 100.00
Validation precision: 7.65
Validation AUC: 0.5291194576551531
Validation class accuracies: [0.13612565445026178, 1.0]
The validation tracker metric at 0.14963503649635038 hasn't increased by 0 in 2 epochs
Epoch 5/65
154/154 - 59s - loss: 0.4911 - accuracy: 0.8950 - val_loss: 0.9052 - val_accuracy: 0.7410
Confusion matrix: 
 [[421 152]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.735 0.265]
 [0.171 0.829]]
Validation f1: 29.96
Validation accuracy: 74.10
Validation recall: 82.93
Validation precision: 18.28
Validation AUC: 0.5084576081786452
Validation class accuracies: [0.7347294938917975, 0.8292682926829268]
Saving model...
Epoch 6/65
154/154 - 61s - loss: 0.4764 - accuracy: 0.8784 - val_loss: 0.9226 - val_accuracy: 0.7638
Confusion matrix: 
 [[433 140]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.756 0.244]
 [0.122 0.878]]
Validation f1: 33.18
Validation accuracy: 76.38
Validation recall: 87.80
Validation precision: 20.45
Validation AUC: 0.5444064036707184
Validation class accuracies: [0.7556719022687609, 0.8780487804878049]
Saving model...
Epoch 7/65
154/154 - 59s - loss: 0.4929 - accuracy: 0.8820 - val_loss: 0.6945 - val_accuracy: 0.8567
Confusion matrix: 
 [[498  75]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.317 0.683]]
Validation f1: 38.89
Validation accuracy: 85.67
Validation recall: 68.29
Validation precision: 27.18
Validation AUC: 0.5437372164389502
Validation class accuracies: [0.8691099476439791, 0.6829268292682927]
Saving model...
Epoch 8/65
154/154 - 58s - loss: 0.4796 - accuracy: 0.8812 - val_loss: 0.8171 - val_accuracy: 0.7932
Confusion matrix: 
 [[452 121]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.146 0.854]]
Validation f1: 35.53
Validation accuracy: 79.32
Validation recall: 85.37
Validation precision: 22.44
Validation AUC: 0.5193580428003972
Validation class accuracies: [0.7888307155322862, 0.8536585365853658]
The validation tracker metric at 0.3888888888888889 hasn't increased by 0 in 1 epochs
Epoch 9/65
154/154 - 58s - loss: 0.4744 - accuracy: 0.8763 - val_loss: 0.7333 - val_accuracy: 0.8339
Confusion matrix: 
 [[477  96]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.146 0.854]]
Validation f1: 40.70
Validation accuracy: 83.39
Validation recall: 85.37
Validation precision: 26.72
Validation AUC: 0.4883192884966212
Validation class accuracies: [0.8324607329842932, 0.8536585365853658]
Saving model...
Epoch 10/65
154/154 - 58s - loss: 0.4392 - accuracy: 0.9109 - val_loss: 0.9194 - val_accuracy: 0.7362
Confusion matrix: 
 [[417 156]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.728 0.272]
 [0.146 0.854]]
Validation f1: 30.17
Validation accuracy: 73.62
Validation recall: 85.37
Validation precision: 18.32
Validation AUC: 0.41119012628436613
Validation class accuracies: [0.7277486910994765, 0.8536585365853658]
The validation tracker metric at 0.4069767441860465 hasn't increased by 0 in 1 epochs
Epoch 11/65
154/154 - 61s - loss: 0.4476 - accuracy: 0.8759 - val_loss: 0.8155 - val_accuracy: 0.7818
Confusion matrix: 
 [[448 125]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.782 0.218]
 [0.22  0.78 ]]
Validation f1: 32.32
Validation accuracy: 78.18
Validation recall: 78.05
Validation precision: 20.38
Validation AUC: 0.5161822667400527
Validation class accuracies: [0.7818499127399651, 0.7804878048780488]
The validation tracker metric at 0.4069767441860465 hasn't increased by 0 in 2 epochs
Epoch 12/65
154/154 - 66s - loss: 0.4240 - accuracy: 0.8869 - val_loss: 0.6283 - val_accuracy: 0.8746
Confusion matrix: 
 [[505  68]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.22  0.78 ]]
Validation f1: 45.39
Validation accuracy: 87.46
Validation recall: 78.05
Validation precision: 32.00
Validation AUC: 0.5505568502760443
Validation class accuracies: [0.881326352530541, 0.7804878048780488]
Saving model...
Epoch 13/65
154/154 - 66s - loss: 0.4142 - accuracy: 0.9203 - val_loss: 0.5792 - val_accuracy: 0.9104
Confusion matrix: 
 [[531  42]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.317 0.683]]
Validation f1: 50.45
Validation accuracy: 91.04
Validation recall: 68.29
Validation precision: 40.00
Validation AUC: 0.5727112952998894
Validation class accuracies: [0.9267015706806283, 0.6829268292682927]
Saving model...
Epoch 14/65
154/154 - 66s - loss: 0.4349 - accuracy: 0.9117 - val_loss: 0.6176 - val_accuracy: 0.8811
Confusion matrix: 
 [[512  61]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.293 0.707]]
Validation f1: 44.27
Validation accuracy: 88.11
Validation recall: 70.73
Validation precision: 32.22
Validation AUC: 0.5680639565904371
Validation class accuracies: [0.893542757417103, 0.7073170731707317]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 1 epochs
Epoch 15/65
154/154 - 66s - loss: 0.3921 - accuracy: 0.9353 - val_loss: 0.7683 - val_accuracy: 0.8192
Confusion matrix: 
 [[469 104]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.171 0.829]]
Validation f1: 37.99
Validation accuracy: 81.92
Validation recall: 82.93
Validation precision: 24.64
Validation AUC: 0.5331165757580971
Validation class accuracies: [0.8184991273996509, 0.8292682926829268]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 2 epochs
Epoch 16/65
154/154 - 66s - loss: 0.4096 - accuracy: 0.9125 - val_loss: 0.8959 - val_accuracy: 0.7492
Confusion matrix: 
 [[424 149]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.74  0.26 ]
 [0.122 0.878]]
Validation f1: 31.86
Validation accuracy: 74.92
Validation recall: 87.80
Validation precision: 19.46
Validation AUC: 0.4996100125814292
Validation class accuracies: [0.7399650959860384, 0.8780487804878049]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 3 epochs
Epoch 17/65
154/154 - 66s - loss: 0.4117 - accuracy: 0.9028 - val_loss: 0.7098 - val_accuracy: 0.8388
Confusion matrix: 
 [[482  91]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.195 0.805]]
Validation f1: 40.00
Validation accuracy: 83.88
Validation recall: 80.49
Validation precision: 26.61
Validation AUC: 0.5412160054970268
Validation class accuracies: [0.8411867364746946, 0.8048780487804879]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 4 epochs
Epoch 18/65
154/154 - 67s - loss: 0.4054 - accuracy: 0.9072 - val_loss: 0.5780 - val_accuracy: 0.8909
Confusion matrix: 
 [[519  54]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.317 0.683]]
Validation f1: 45.53
Validation accuracy: 89.09
Validation recall: 68.29
Validation precision: 34.15
Validation AUC: 0.5873844538627432
Validation class accuracies: [0.9057591623036649, 0.6829268292682927]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 5 epochs
Epoch 19/65
154/154 - 66s - loss: 0.3938 - accuracy: 0.9219 - val_loss: 0.8267 - val_accuracy: 0.7801
Confusion matrix: 
 [[443 130]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.122 0.878]]
Validation f1: 34.78
Validation accuracy: 78.01
Validation recall: 87.80
Validation precision: 21.69
Validation AUC: 0.5624085746249756
Validation class accuracies: [0.7731239092495636, 0.8780487804878049]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 20/65
154/154 - 66s - loss: 0.3772 - accuracy: 0.9162 - val_loss: 0.8134 - val_accuracy: 0.7948
Confusion matrix: 
 [[452 121]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.122 0.878]]
Validation f1: 36.36
Validation accuracy: 79.48
Validation recall: 87.80
Validation precision: 22.93
Validation AUC: 0.5644065255831987
Validation class accuracies: [0.7888307155322862, 0.8780487804878049]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 7 epochs
Epoch 21/65
154/154 - 65s - loss: 0.3880 - accuracy: 0.9235 - val_loss: 0.7754 - val_accuracy: 0.7964
Confusion matrix: 
 [[454 119]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.90
Validation accuracy: 79.64
Validation recall: 85.37
Validation precision: 22.73
Validation AUC: 0.5495458394984915
Validation class accuracies: [0.7923211169284468, 0.8536585365853658]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 8 epochs
Epoch 22/65
154/154 - 66s - loss: 0.3587 - accuracy: 0.9284 - val_loss: 0.7058 - val_accuracy: 0.8290
Confusion matrix: 
 [[475  98]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.171 0.829]]
Validation f1: 39.31
Validation accuracy: 82.90
Validation recall: 82.93
Validation precision: 25.76
Validation AUC: 0.5561744267001512
Validation class accuracies: [0.8289703315881326, 0.8292682926829268]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 9 epochs
Epoch 23/65
154/154 - 65s - loss: 0.3665 - accuracy: 0.9272 - val_loss: 0.6928 - val_accuracy: 0.8355
Confusion matrix: 
 [[480  93]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.195 0.805]]
Validation f1: 39.52
Validation accuracy: 83.55
Validation recall: 80.49
Validation precision: 26.19
Validation AUC: 0.5575439886208022
Validation class accuracies: [0.837696335078534, 0.8048780487804879]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 10 epochs
Epoch 24/65
154/154 - 66s - loss: 0.3646 - accuracy: 0.9317 - val_loss: 0.6485 - val_accuracy: 0.8583
Confusion matrix: 
 [[494  79]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.195 0.805]]
Validation f1: 43.14
Validation accuracy: 85.83
Validation recall: 80.49
Validation precision: 29.46
Validation AUC: 0.56840015921816
Validation class accuracies: [0.8621291448516579, 0.8048780487804879]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 11 epochs
Epoch 25/65
154/154 - 66s - loss: 0.3633 - accuracy: 0.9325 - val_loss: 0.7905 - val_accuracy: 0.8078
Confusion matrix: 
 [[461 112]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.805 0.195]
 [0.146 0.854]]
Validation f1: 37.23
Validation accuracy: 80.78
Validation recall: 85.37
Validation precision: 23.81
Validation AUC: 0.5383561014669083
Validation class accuracies: [0.8045375218150087, 0.8536585365853658]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 26/65
154/154 - 66s - loss: 0.3621 - accuracy: 0.9296 - val_loss: 0.7418 - val_accuracy: 0.8290
Confusion matrix: 
 [[475  98]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.171 0.829]]
Validation f1: 39.31
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 82.90
Validation recall: 82.93
Validation precision: 25.76
Validation AUC: 0.5662997285494371
Validation class accuracies: [0.8289703315881326, 0.8292682926829268]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 13 epochs
Epoch 27/65
154/154 - 66s - loss: 0.3576 - accuracy: 0.9321 - val_loss: 0.7015 - val_accuracy: 0.8355
Confusion matrix: 
 [[480  93]
 [  8  33]]
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.195 0.805]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.52
Validation accuracy: 83.55
Validation recall: 80.49
Validation precision: 26.19
Validation AUC: 0.5728005806581803
Validation class accuracies: [0.837696335078534, 0.8048780487804879]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 14 epochs
Epoch 28/65
154/154 - 65s - loss: 0.3482 - accuracy: 0.9386 - val_loss: 0.6965 - val_accuracy: 0.8404
Confusion matrix: 
 [[482  91]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.171 0.829]]
Validation f1: 40.96
Validation accuracy: 84.04
Validation recall: 82.93
Validation precision: 27.20
Validation AUC: 0.574194742360761
Validation class accuracies: [0.8411867364746946, 0.8292682926829268]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 15 epochs
Epoch 29/65
154/154 - 66s - loss: 0.3611 - accuracy: 0.9329 - val_loss: 0.6689 - val_accuracy: 0.8469
Confusion matrix: 
 [[487  86]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85  0.15 ]
 [0.195 0.805]]
Validation f1: 41.25
Validation accuracy: 84.69
Validation recall: 80.49
Validation precision: 27.73
Validation AUC: 0.5862536451428517
Validation class accuracies: [0.849912739965096, 0.8048780487804879]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 16 epochs
Epoch 30/65
154/154 - 66s - loss: 0.3447 - accuracy: 0.9382 - val_loss: 0.6843 - val_accuracy: 0.8371
Confusion matrix: 
 [[480  93]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.171 0.829]]
Validation f1: 40.48
Validation accuracy: 83.71
Validation recall: 82.93
Validation precision: 26.77
Validation AUC: 0.5862304808056986
Validation class accuracies: [0.837696335078534, 0.8292682926829268]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 17 epochs
Epoch 31/65
154/154 - 66s - loss: 0.3510 - accuracy: 0.9365 - val_loss: 0.7581 - val_accuracy: 0.8111
Confusion matrix: 
 [[463 110]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.808 0.192]
 [0.146 0.854]]
Validation f1: 37.63
Validation accuracy: 81.11
Validation recall: 85.37
Validation precision: 24.14
Validation AUC: 0.5765518481734554
Validation class accuracies: [0.8080279232111692, 0.8536585365853658]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 32/65
154/154 - 66s - loss: 0.3457 - accuracy: 0.9325 - val_loss: 0.6742 - val_accuracy: 0.8371
Confusion matrix: 
 [[480  93]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.171 0.829]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.48
Validation accuracy: 83.71
Validation recall: 82.93
Validation precision: 26.77
Validation AUC: 0.5924649777327878
Validation class accuracies: [0.837696335078534, 0.8292682926829268]
The validation tracker metric at 0.5045045045045045 hasn't increased by 0 in 19 epochs
Epoch 33/65
154/154 - 66s - loss: 0.3532 - accuracy: 0.9333 - val_loss: 0.6590 - val_accuracy: 0.8420
Confusion matrix: 
 [[485  88]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.22  0.78 ]]
Validation f1: 39.75
Validation accuracy: 84.20
Validation recall: 78.05
Validation precision: 26.67
Validation AUC: 0.604116314419242
Validation class accuracies: [0.8464223385689355, 0.7804878048780488]

The metrics for job 0 with the best target metric are: 
Best cm: [[531  42]
 [ 13  28]]
Best normalized cm: [[0.927 0.073]
 [0.317 0.683]]
Best f1: 0.50
Best accuracy: 0.91
Best recall: 0.68
Best precision: 0.40
Best AUC: 0.57
Best class accuracies: [0.9267015706806283, 0.6829268292682927]
Best epoch: 13
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 20707
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_183859-25uhuvne/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_183859-25uhuvne/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.93328
wandb:         val_accuracy 0.84202
wandb:             _runtime 2497
wandb:           _timestamp 1624821637
wandb:                _step 251
wandb:           train_loss 0.35322
wandb:             val_loss 0.65903
wandb:           val_recall 0.78049
wandb:        val_precision 0.26667
wandb:               val_f1 0.39752
wandb:              val_auc 0.60412
wandb:                   lr 0.00013
wandb:          best_val_f1 0.5045
wandb:    best_val_accuracy 0.91042
wandb:   best_val_precision 0.4
wandb:      best_val_recall 0.68293
wandb:             best_auc 0.57271
wandb:           best_epoch 13
wandb: Run history:
wandb:   train_accuracy ▁▆▇▆▇▇▇▇▆▇▆▇█▇█▇▇▇█▇█████████████
wandb:     val_accuracy █▂▁▂▆▇▇▇▇▆▇███▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▆▅▄▄▄▄▄▃▃▃▃▃▂▂▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▃█▇▂▃▂▂▂▂▂▁▁▁▂▂▂▁▂▂▂▂▂▁▂▂▂▂▁▁▂▁▁
wandb:       val_recall ▁███▇▇▆▇▇▇▆▆▆▆▇▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆
wandb:    val_precision ▁▂▂▂▄▅▆▅▆▄▅▇█▇▅▄▆▇▅▅▅▆▆▆▅▆▆▆▆▆▅▆▆
wandb:           val_f1 ▁▃▃▃▅▆▆▆▇▅▅▇█▇▆▅▇▇▆▆▆▆▆▇▆▆▆▇▇▇▆▇▇
wandb:          val_auc ▁▆▄▇▆▇▇▆▆▄▆▇▇▇▇▆▇█▇▇▇▇▇▇▇▇▇▇██▇██
wandb:               lr ███████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_183859-25uhuvne

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 10, 125, 128, 1) 4            input_2[0][0]                        
______________________________________________________________________________________________________________
time_distributed_15 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
time_distributed_17 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
time_distributed_19 (TimeDistribute (None, 10, 125, 128, 1) 0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
time_distributed_16 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_15[0][0]            
______________________________________________________________________________________________________________
time_distributed_18 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_17[0][0]            
______________________________________________________________________________________________________________
time_distributed_20 (TimeDistribute (None, 10, 125, 128, 16 32           time_distributed_19[0][0]            
______________________________________________________________________________________________________________
concatenate_2 (Concatenate)         (None, 10, 125, 128, 48 0            time_distributed_16[0][0]            
                                                                         time_distributed_18[0][0]            
                                                                         time_distributed_20[0][0]            
______________________________________________________________________________________________________________
time_distributed_21 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_2[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 10, 63, 64, 48)  192          time_distributed_21[0][0]            
______________________________________________________________________________________________________________
time_distributed_22 (TimeDistribute (None, 10, 63, 64, 32)  1568         batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
time_distributed_24 (TimeDistribute (None, 10, 63, 64, 32)  1568         batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
time_distributed_26 (TimeDistribute (None, 10, 63, 64, 48)  0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
time_distributed_23 (TimeDistribute (None, 10, 63, 64, 32)  9248         time_distributed_22[0][0]            
______________________________________________________________________________________________________________
time_distributed_25 (TimeDistribute (None, 10, 63, 64, 32)  25632        time_distributed_24[0][0]            
______________________________________________________________________________________________________________
time_distributed_27 (TimeDistribute (None, 10, 63, 64, 32)  1568         time_distributed_26[0][0]            
______________________________________________________________________________________________________________
concatenate_3 (Concatenate)         (None, 10, 63, 64, 96)  0            time_distributed_23[0][0]            
                                                                         time_distributed_25[0][0]            
                                                                         time_distributed_27[0][0]            
______________________________________________________________________________________________________________
time_distributed_28 (TimeDistribute (None, 10, 32, 32, 96)  0            concatenate_3[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 10, 32, 32, 96)  384          time_distributed_28[0][0]            
______________________________________________________________________________________________________________
time_distributed_29 (TimeDistribute (None, 10, 32, 32, 64)  6208         batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
time_distributed_31 (TimeDistribute (None, 10, 32, 32, 64)  6208         batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
time_distributed_33 (TimeDistribute (None, 10, 32, 32, 96)  0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
time_distributed_30 (TimeDistribute (None, 10, 32, 32, 64)  36928        time_distributed_29[0][0]            
______________________________________________________________________________________________________________
time_distributed_32 (TimeDistribute (None, 10, 32, 32, 64)  102464       time_distributed_31[0][0]            
______________________________________________________________________________________________________________
time_distributed_34 (TimeDistribute (None, 10, 32, 32, 64)  6208         time_distributed_33[0][0]            
______________________________________________________________________________________________________________
concatenate_4 (Concatenate)         (None, 10, 32, 32, 192) 0            time_distributed_30[0][0]            
                                                                         time_distributed_32[0][0]            
                                                                         time_distributed_34[0][0]            
______________________________________________________________________________________________________________
time_distributed_35 (TimeDistribute (None, 10, 16, 16, 192) 0            concatenate_4[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 10, 16, 16, 192) 768          time_distributed_35[0][0]            
______________________________________________________________________________________________________________
time_distributed_36 (TimeDistribute (None, 10, 192)         0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
bidirectional_2 (Bidirectional)     (None, 10, 256)         328704       time_distributed_36[0][0]            
______________________________________________________________________________________________________________
bidirectional_3 (Bidirectional)     (None, 10, 256)         394240       bidirectional_2[0][0]                
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 10, 128)         32896        bidirectional_3[0][0]                
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 10, 1)           129          dense_3[0][0]                        
______________________________________________________________________________________________________________
flatten_1 (Flatten)                 (None, 10)              0            dense_4[0][0]                        
______________________________________________________________________________________________________________
dense_5 (Dense)                     (None, 1)               11           flatten_1[0][0]                      
==============================================================================================================
Total params: 963,760
Trainable params: 963,086
Non-trainable params: 674
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 76s - loss: 0.7015 - accuracy: 0.5338 - val_loss: 1.3290 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.2658559036622305
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 75s - loss: 0.6195 - accuracy: 0.8251 - val_loss: 1.5490 - val_accuracy: 0.1107
Confusion matrix: 
 [[ 27 546]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.047 0.953]
 [0.    1.   ]]
Validation f1: 13.06
Validation accuracy: 11.07
Validation recall: 100.00
Validation precision: 6.98
Validation AUC: 0.21012531619721056
Validation class accuracies: [0.04712041884816754, 1.0]
Saving model...
Epoch 3/65
154/154 - 74s - loss: 0.6156 - accuracy: 0.8348 - val_loss: 0.6666 - val_accuracy: 0.9349
Confusion matrix: 
 [[555  18]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.537 0.463]]
Validation f1: 48.72
Validation accuracy: 93.49
Validation recall: 46.34
Validation precision: 51.35
Validation AUC: 0.4081556117195757
Validation class accuracies: [0.9685863874345549, 0.4634146341463415]
Saving model...
Epoch 4/65
154/154 - 75s - loss: 0.6454 - accuracy: 0.8735 - val_loss: 0.7405 - val_accuracy: 0.8730
Confusion matrix: 
 [[507  66]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.293 0.707]]
Validation f1: 42.65
Validation accuracy: 87.30
Validation recall: 70.73
Validation precision: 30.53
Validation AUC: 0.28408067333132747
Validation class accuracies: [0.8848167539267016, 0.7073170731707317]
The validation tracker metric at 0.48717948717948717 hasn't increased by 0 in 1 epochs
Epoch 5/65
154/154 - 75s - loss: 0.5740 - accuracy: 0.8832 - val_loss: 0.6817 - val_accuracy: 0.9121
Confusion matrix: 
 [[533  40]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.341 0.659]]
Validation f1: 50.00
Validation accuracy: 91.21
Validation recall: 65.85
Validation precision: 40.30
Validation AUC: 0.41576018021702127
Validation class accuracies: [0.9301919720767888, 0.6585365853658537]
Saving model...
Epoch 6/65
154/154 - 75s - loss: 0.6510 - accuracy: 0.8047 - val_loss: 1.0117 - val_accuracy: 0.6173
Confusion matrix: 
 [[338 235]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.59 0.41]
 [0.   1.  ]]
Validation f1: 25.87
Validation accuracy: 61.73
Validation recall: 100.00
Validation precision: 14.86
Validation AUC: 0.35190510827041116
Validation class accuracies: [0.5898778359511344, 1.0]
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
Epoch 7/65
154/154 - 75s - loss: 0.5847 - accuracy: 0.7718 - val_loss: 0.7012 - val_accuracy: 0.8616
Confusion matrix: 
 [[492  81]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.098 0.902]]
Validation f1: 46.54
Validation accuracy: 86.16
Validation recall: 90.24
Validation precision: 31.36
Validation AUC: 0.5277507365120956
Validation class accuracies: [0.8586387434554974, 0.9024390243902439]
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
Epoch 8/65
154/154 - 76s - loss: 0.5291 - accuracy: 0.8637 - val_loss: 0.9159 - val_accuracy: 0.7134
Confusion matrix: 
 [[400 173]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.698 0.302]
 [0.073 0.927]]
Validation f1: 30.16
Validation accuracy: 71.34
Validation recall: 92.68
Validation precision: 18.01
Validation AUC: 0.21532991621942585
Validation class accuracies: [0.6980802792321117, 0.926829268292683]
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
Epoch 9/65
154/154 - 75s - loss: 0.5104 - accuracy: 0.8544 - val_loss: 0.6579 - val_accuracy: 0.9023
Confusion matrix: 
 [[520  53]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.171 0.829]]
Validation f1: 53.12
Validation accuracy: 90.23
Validation recall: 82.93
Validation precision: 39.08
Validation AUC: 0.442315995853706
Validation class accuracies: [0.9075043630017452, 0.8292682926829268]
Saving model...
Epoch 10/65
154/154 - 75s - loss: 0.5165 - accuracy: 0.8739 - val_loss: 0.6109 - val_accuracy: 0.9251
Confusion matrix: 
 [[542  31]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.366 0.634]]
Validation f1: 53.06
Validation accuracy: 92.51
Validation recall: 63.41
Validation precision: 45.61
Validation AUC: 0.3242775313037879
Validation class accuracies: [0.9458987783595113, 0.6341463414634146]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 1 epochs
Epoch 11/65
154/154 - 74s - loss: 0.5041 - accuracy: 0.8971 - val_loss: 2.1165 - val_accuracy: 0.1010
Confusion matrix: 
 [[ 21 552]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.037 0.963]
 [0.    1.   ]]
Validation f1: 12.93
Validation accuracy: 10.10
Validation recall: 100.00
Validation precision: 6.91
Validation AUC: 0.5394990366088632
Validation class accuracies: [0.03664921465968586, 1.0]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 2 epochs
Epoch 12/65
154/154 - 75s - loss: 0.5088 - accuracy: 0.8991 - val_loss: 0.7098 - val_accuracy: 0.8632
Confusion matrix: 
 [[495  78]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.146 0.854]]
Validation f1: 45.45
Validation accuracy: 86.32
Validation recall: 85.37
Validation precision: 30.97
Validation AUC: 0.5540989656859546
Validation class accuracies: [0.8638743455497382, 0.8536585365853658]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 3 epochs
Epoch 13/65
154/154 - 75s - loss: 0.4926 - accuracy: 0.8922 - val_loss: 0.6192 - val_accuracy: 0.9023
Confusion matrix: 
 [[527  46]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.341 0.659]]
Validation f1: 47.37
Validation accuracy: 90.23
Validation recall: 65.85
Validation precision: 36.99
Validation AUC: 0.529708933989453
Validation class accuracies: [0.9197207678883071, 0.6585365853658537]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 4 epochs
Epoch 14/65
154/154 - 75s - loss: 0.4883 - accuracy: 0.8751 - val_loss: 0.5949 - val_accuracy: 0.8990
Confusion matrix: 
 [[527  46]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92 0.08]
 [0.39 0.61]]
Validation f1: 44.64
Validation accuracy: 89.90
Validation recall: 60.98
Validation precision: 35.21
Validation AUC: 0.31827575235927535
Validation class accuracies: [0.9197207678883071, 0.6097560975609756]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 5 epochs
Epoch 15/65
154/154 - 75s - loss: 0.4713 - accuracy: 0.8946 - val_loss: 2.1729 - val_accuracy: 0.1368
Confusion matrix: 
 [[ 43 530]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.075 0.925]
 [0.    1.   ]]
Validation f1: 13.40
Validation accuracy: 13.68
Validation recall: 100.00
Validation precision: 7.18
Validation AUC: 0.5508684863523573
Validation class accuracies: [0.07504363001745201, 1.0]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
154/154 - 75s - loss: 0.4935 - accuracy: 0.9170 - val_loss: 0.8696 - val_accuracy: 0.7769
Confusion matrix: 
 [[439 134]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.766 0.234]
 [0.073 0.927]]
Validation f1: 35.68
Validation accuracy: 77.69
Validation recall: 92.68
Validation precision: 22.09
Validation AUC: 0.19325629154513496
Validation class accuracies: [0.7661431064572426, 0.926829268292683]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 7 epochs
Epoch 17/65
154/154 - 75s - loss: 0.4742 - accuracy: 0.8975 - val_loss: 0.6880 - val_accuracy: 0.8599
Confusion matrix: 
 [[499  74]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.293 0.707]]
Validation f1: 40.28
Validation accuracy: 85.99
Validation recall: 70.73
Validation precision: 28.16
Validation AUC: 0.5184005542074992
Validation class accuracies: [0.8708551483420593, 0.7073170731707317]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 8 epochs
Epoch 18/65
154/154 - 75s - loss: 0.4574 - accuracy: 0.8987 - val_loss: 0.6597 - val_accuracy: 0.8762
Confusion matrix: 
 [[510  63]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.317 0.683]]
Validation f1: 42.42
Validation accuracy: 87.62
Validation recall: 68.29
Validation precision: 30.77
Validation AUC: 0.21595506516673496
Validation class accuracies: [0.8900523560209425, 0.6829268292682927]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 9 epochs
Epoch 19/65
154/154 - 75s - loss: 0.4492 - accuracy: 0.9081 - val_loss: 0.7455 - val_accuracy: 0.8257
Confusion matrix: 
 [[473 100]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.171 0.829]]
Validation f1: 38.86
Validation accuracy: 82.57
Validation recall: 82.93
Validation precision: 25.37
Validation AUC: 0.5003541817526562
Validation class accuracies: [0.8254799301919721, 0.8292682926829268]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 10 epochs
Epoch 20/65
154/154 - 75s - loss: 0.4671 - accuracy: 0.8950 - val_loss: 1.0874 - val_accuracy: 0.6580
Confusion matrix: 
 [[365 208]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.637 0.363]
 [0.049 0.951]]
Validation f1: 27.08
Validation accuracy: 65.80
Validation recall: 95.12
Validation precision: 15.79
Validation AUC: 0.5682333607729249
Validation class accuracies: [0.6369982547993019, 0.9512195121951219]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 11 epochs
Epoch 21/65
154/154 - 75s - loss: 0.4478 - accuracy: 0.8938 - val_loss: 0.8258 - val_accuracy: 0.7915
Confusion matrix: 
 [[449 124]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.784 0.216]
 [0.098 0.902]]
Validation f1: 36.63
Validation accuracy: 79.15
Validation recall: 90.24
Validation precision: 22.98
Validation AUC: 0.5614543659166712
Validation class accuracies: [0.7835951134380453, 0.9024390243902439]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
154/154 - 76s - loss: 0.4421 - accuracy: 0.8918 - val_loss: 0.7238 - val_accuracy: 0.8485
Confusion matrix: 
 [[486  87]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.146 0.854]]
Validation f1: 42.94
Validation accuracy: 84.85
Validation recall: 85.37
Validation precision: 28.69
Validation AUC: 0.5179189933098467
Validation class accuracies: [0.8481675392670157, 0.8536585365853658]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 13 epochs
Epoch 23/65
154/154 - 75s - loss: 0.4478 - accuracy: 0.8987 - val_loss: 0.7243 - val_accuracy: 0.8485
Confusion matrix: 
 [[486  87]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.146 0.854]]
Validation f1: 42.94
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 84.85
Validation recall: 85.37
Validation precision: 28.69
Validation AUC: 0.525735036245081
Validation class accuracies: [0.8481675392670157, 0.8536585365853658]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 14 epochs
Epoch 24/65
154/154 - 75s - loss: 0.4436 - accuracy: 0.9040 - val_loss: 0.7286 - val_accuracy: 0.8436
Confusion matrix: 
 [[483  90]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.146 0.854]]
Validation f1: 42.17
Validation accuracy: 84.36
Validation recall: 85.37
Validation precision: 28.00
Validation AUC: 0.5249591106211566
Validation class accuracies: [0.8429319371727748, 0.8536585365853658]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 15 epochs
Epoch 25/65
154/154 - 76s - loss: 0.4473 - accuracy: 0.8987 - val_loss: 0.6746 - val_accuracy: 0.8550
Confusion matrix: 
 [[494  79]
 [ 10  31]]
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.244 0.756]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.06
Validation accuracy: 85.50
Validation recall: 75.61
Validation precision: 28.18
Validation AUC: 0.22083562340761775
Validation class accuracies: [0.8621291448516579, 0.7560975609756098]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 16 epochs
Epoch 26/65
154/154 - 75s - loss: 0.4319 - accuracy: 0.8897 - val_loss: 0.7525 - val_accuracy: 0.8208
Confusion matrix: 
 [[469 104]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.146 0.854]]
Validation f1: 38.89
Validation accuracy: 82.08
Validation recall: 85.37
Validation precision: 25.18
Validation AUC: 0.521520299137678
Validation class accuracies: [0.8184991273996509, 0.8536585365853658]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 17 epochs
Epoch 27/65
154/154 - 75s - loss: 0.4243 - accuracy: 0.8991 - val_loss: 0.8349 - val_accuracy: 0.7720
Confusion matrix: 
 [[437 136]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.763 0.237]
 [0.098 0.902]]
Validation f1: 34.58
Validation accuracy: 77.20
Validation recall: 90.24
Validation precision: 21.39
Validation AUC: 0.49521301013062435
Validation class accuracies: [0.7626527050610821, 0.9024390243902439]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
154/154 - 75s - loss: 0.4425 - accuracy: 0.9101 - val_loss: 0.7367 - val_accuracy: 0.8274
Confusion matrix: 
 [[473 100]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.146 0.854]]
Validation f1: 39.77
Validation accuracy: 82.74
Validation recall: 85.37
Validation precision: 25.93
Validation AUC: 0.45198073687182466
Validation class accuracies: [0.8254799301919721, 0.8536585365853658]
The validation tracker metric at 0.5312499999999999 hasn't increased by 0 in 19 epochs
Epoch 29/65
154/154 - 75s - loss: 0.4223 - accuracy: 0.9125 - val_loss: 0.7341 - val_accuracy: 0.8322
Confusion matrix: 
 [[476  97]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.831 0.169]
 [0.146 0.854]]
Validation f1: 40.46
Validation accuracy: 83.22
Validation recall: 85.37
Validation precision: 26.52
Validation AUC: 0.4697671510440569
Validation class accuracies: [0.8307155322862129, 0.8536585365853658]

The metrics for job 1 with the best target metric are: 
Best cm: [[520  53]
 [  7  34]]
Best normalized cm: [[0.908 0.092]
 [0.171 0.829]]
Best f1: 0.53
Best accuracy: 0.90
Best recall: 0.83
Best precision: 0.39
Best AUC: 0.44
Best class accuracies: [0.9075043630017452, 0.8292682926829268]
Best epoch: 9
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 29656
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_192040-2z6x0fj6/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_192040-2z6x0fj6/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.91253
wandb:         val_accuracy 0.83225
wandb:             _runtime 2556
wandb:           _timestamp 1624824197
wandb:                _step 217
wandb:           train_loss 0.42233
wandb:             val_loss 0.73414
wandb:           val_recall 0.85366
wandb:        val_precision 0.26515
wandb:               val_f1 0.40462
wandb:              val_auc 0.46977
wandb:                   lr 0.00013
wandb:          best_val_f1 0.53125
wandb:    best_val_accuracy 0.90228
wandb:   best_val_precision 0.3908
wandb:      best_val_recall 0.82927
wandb:             best_auc 0.44232
wandb:           best_epoch 9
wandb: Run history:
wandb:   train_accuracy ▁▆▆▇▇▆▅▇▇▇███▇███████████████
wandb:     val_accuracy ▁▁███▅▇▆██▁▇██▂▇▇█▇▆▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▆▇▅▇▅▄▃▃▃▃▃▃▂▃▂▂▂▂▂▁▂▂▂▁▁▂▁
wandb:         val_loss ▄▅▁▂▁▃▁▂▁▁█▂▁▁█▂▁▁▂▃▂▂▂▂▁▂▂▂▂
wandb:       val_recall ██▁▄▄█▇▇▆▃█▆▄▃█▇▄▄▆▇▇▆▆▆▅▆▇▆▆
wandb:    val_precision ▁▁█▅▆▂▅▃▆▇▁▅▆▅▁▃▄▅▄▂▄▄▄▄▄▄▃▄▄
wandb:           val_f1 ▁▁▇▆▇▃▇▄██▁▇▇▇▁▅▆▆▆▄▅▆▆▆▆▆▅▆▆
wandb:          val_auc ▂▁▅▃▅▄▇▁▆▃▇█▇▃█▁▇▁▇██▇▇▇▂▇▇▆▆
wandb:               lr ███████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_192040-2z6x0fj6

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 10, 125, 128, 1) 4            input_3[0][0]                        
______________________________________________________________________________________________________________
time_distributed_37 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
time_distributed_39 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
time_distributed_41 (TimeDistribute (None, 10, 125, 128, 1) 0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
time_distributed_38 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_37[0][0]            
______________________________________________________________________________________________________________
time_distributed_40 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_39[0][0]            
______________________________________________________________________________________________________________
time_distributed_42 (TimeDistribute (None, 10, 125, 128, 16 32           time_distributed_41[0][0]            
______________________________________________________________________________________________________________
concatenate_5 (Concatenate)         (None, 10, 125, 128, 48 0            time_distributed_38[0][0]            
                                                                         time_distributed_40[0][0]            
                                                                         time_distributed_42[0][0]            
______________________________________________________________________________________________________________
time_distributed_43 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_5[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 10, 63, 64, 48)  192          time_distributed_43[0][0]            
______________________________________________________________________________________________________________
time_distributed_44 (TimeDistribute (None, 10, 63, 64, 32)  1568         batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
time_distributed_46 (TimeDistribute (None, 10, 63, 64, 32)  1568         batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
time_distributed_48 (TimeDistribute (None, 10, 63, 64, 48)  0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
time_distributed_45 (TimeDistribute (None, 10, 63, 64, 32)  9248         time_distributed_44[0][0]            
______________________________________________________________________________________________________________
time_distributed_47 (TimeDistribute (None, 10, 63, 64, 32)  25632        time_distributed_46[0][0]            
______________________________________________________________________________________________________________
time_distributed_49 (TimeDistribute (None, 10, 63, 64, 32)  1568         time_distributed_48[0][0]            
______________________________________________________________________________________________________________
concatenate_6 (Concatenate)         (None, 10, 63, 64, 96)  0            time_distributed_45[0][0]            
                                                                         time_distributed_47[0][0]            
                                                                         time_distributed_49[0][0]            
______________________________________________________________________________________________________________
time_distributed_50 (TimeDistribute (None, 10, 32, 32, 96)  0            concatenate_6[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 10, 32, 32, 96)  384          time_distributed_50[0][0]            
______________________________________________________________________________________________________________
time_distributed_51 (TimeDistribute (None, 10, 32, 32, 64)  55360        batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
time_distributed_52 (TimeDistribute (None, 10, 32, 32, 64)  1656         time_distributed_51[0][0]            
______________________________________________________________________________________________________________
time_distributed_53 (TimeDistribute (None, 10, 32, 32, 64)  256          time_distributed_52[0][0]            
______________________________________________________________________________________________________________
time_distributed_54 (TimeDistribute (None, 10, 64)          0            time_distributed_53[0][0]            
______________________________________________________________________________________________________________
bidirectional_4 (Bidirectional)     (None, 10, 256)         197632       time_distributed_54[0][0]            
______________________________________________________________________________________________________________
bidirectional_5 (Bidirectional)     (None, 10, 256)         394240       bidirectional_4[0][0]                
______________________________________________________________________________________________________________
dense_6 (Dense)                     (None, 10, 128)         32896        bidirectional_5[0][0]                
______________________________________________________________________________________________________________
dense_7 (Dense)                     (None, 10, 1)           129          dense_6[0][0]                        
______________________________________________________________________________________________________________
flatten_2 (Flatten)                 (None, 10)              0            dense_7[0][0]                        
______________________________________________________________________________________________________________
dense_8 (Dense)                     (None, 1)               11           flatten_2[0][0]                      
==============================================================================================================
Total params: 731,176
Trainable params: 730,758
Non-trainable params: 418
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 77s - loss: 0.6578 - accuracy: 0.7392 - val_loss: 0.9174 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.2871075387493548
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 76s - loss: 0.7463 - accuracy: 0.4955 - val_loss: 0.3450 - val_accuracy: 0.8860
Confusion matrix: 
 [[534  39]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.756 0.244]]
Validation f1: 22.22
Validation accuracy: 88.60
Validation recall: 24.39
Validation precision: 20.41
Validation AUC: 0.1153304149943395
Validation class accuracies: [0.9319371727748691, 0.24390243902439024]
Saving model...
Epoch 3/65
154/154 - 77s - loss: 0.7705 - accuracy: 0.3218 - val_loss: 0.6949 - val_accuracy: 0.2248
Confusion matrix: 
 [[ 97 476]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.169 0.831]
 [0.    1.   ]]
Validation f1: 14.70
Validation accuracy: 22.48
Validation recall: 100.00
Validation precision: 7.93
Validation AUC: 0.08100132123816589
Validation class accuracies: [0.16928446771378708, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 1 epochs
Epoch 4/65
154/154 - 77s - loss: 0.7576 - accuracy: 0.1953 - val_loss: 0.6784 - val_accuracy: 0.2231
Confusion matrix: 
 [[ 96 477]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.168 0.832]
 [0.    1.   ]]
Validation f1: 14.67
Validation accuracy: 22.31
Validation recall: 100.00
Validation precision: 7.92
Validation AUC: 0.18983990400533218
Validation class accuracies: [0.16753926701570682, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 2 epochs
Epoch 5/65
154/154 - 77s - loss: 0.6722 - accuracy: 0.2242 - val_loss: 0.7456 - val_accuracy: 0.2182
Confusion matrix: 
 [[ 93 480]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.162 0.838]
 [0.    1.   ]]
Validation f1: 14.59
Validation accuracy: 21.82
Validation recall: 100.00
Validation precision: 7.87
Validation AUC: 0.2655911862178451
Validation class accuracies: [0.16230366492146597, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 3 epochs
Epoch 6/65
154/154 - 76s - loss: 0.6491 - accuracy: 0.2555 - val_loss: 0.7560 - val_accuracy: 0.2248
Confusion matrix: 
 [[100 473]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.175 0.825]
 [0.073 0.927]]
Validation f1: 13.77
Validation accuracy: 22.48
Validation recall: 92.68
Validation precision: 7.44
Validation AUC: 0.43033729842426444
Validation class accuracies: [0.17452006980802792, 0.926829268292683]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 4 epochs
Epoch 7/65
154/154 - 76s - loss: 0.6115 - accuracy: 0.2372 - val_loss: 0.7564 - val_accuracy: 0.2182
Confusion matrix: 
 [[ 94 479]
 [  1  40]]
Normalized Confusion matrix: 
 [[0.164 0.836]
 [0.024 0.976]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.29
Validation accuracy: 21.82
Validation recall: 97.56
Validation precision: 7.71
Validation AUC: 0.2422592365953541
Validation class accuracies: [0.16404886561954624, 0.975609756097561]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 5 epochs
Epoch 8/65
154/154 - 76s - loss: 0.6142 - accuracy: 0.2490 - val_loss: 0.7656 - val_accuracy: 0.2085
Confusion matrix: 
 [[ 87 486]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.152 0.848]
 [0.    1.   ]]
Validation f1: 14.44
Validation accuracy: 20.85
Validation recall: 100.00
Validation precision: 7.78
Validation AUC: 0.24151497418579107
Validation class accuracies: [0.1518324607329843, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 9/65
154/154 - 77s - loss: 0.6241 - accuracy: 0.2372 - val_loss: 0.7290 - val_accuracy: 0.2052
Confusion matrix: 
 [[ 85 488]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.148 0.852]
 [0.    1.   ]]
Validation f1: 14.39
Validation accuracy: 20.52
Validation recall: 100.00
Validation precision: 7.75
Validation AUC: 0.2949397550362071
Validation class accuracies: [0.14834205933682373, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 7 epochs
Epoch 10/65
154/154 - 76s - loss: 0.6309 - accuracy: 0.2290 - val_loss: 0.7480 - val_accuracy: 0.1808
Confusion matrix: 
 [[ 70 503]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.122 0.878]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.02
Validation accuracy: 18.08
Validation recall: 100.00
Validation precision: 7.54
Validation AUC: 0.3216765553266886
Validation class accuracies: [0.12216404886561955, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 8 epochs
Epoch 11/65
154/154 - 76s - loss: 0.6393 - accuracy: 0.2144 - val_loss: 0.8016 - val_accuracy: 0.1857
Confusion matrix: 
 [[ 73 500]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.127 0.873]
 [0.    1.   ]]
Validation f1: 14.09
Validation accuracy: 18.57
Validation recall: 100.00
Validation precision: 7.58
Validation AUC: 0.23579970670435318
Validation class accuracies: [0.1273996509598604, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 9 epochs
Epoch 12/65
154/154 - 76s - loss: 0.6178 - accuracy: 0.2266 - val_loss: 0.7462 - val_accuracy: 0.2101
Confusion matrix: 
 [[ 88 485]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.154 0.846]
 [0.    1.   ]]
Validation f1: 14.46
Validation accuracy: 21.01
Validation recall: 100.00
Validation precision: 7.79
Validation AUC: 0.5386640558100495
Validation class accuracies: [0.15357766143106458, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 10 epochs
Epoch 13/65
154/154 - 77s - loss: 0.6043 - accuracy: 0.2364 - val_loss: 0.7414 - val_accuracy: 0.2020
Confusion matrix: 
 [[ 83 490]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.145 0.855]
 [0.    1.   ]]
Validation f1: 14.34
Validation accuracy: 20.20
Validation recall: 100.00
Validation precision: 7.72
Validation AUC: 0.49487152672026713
Validation class accuracies: [0.14485165794066318, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 11 epochs
Epoch 14/65
154/154 - 76s - loss: 0.5892 - accuracy: 0.2396 - val_loss: 0.7717 - val_accuracy: 0.2020
Confusion matrix: 
 [[ 83 490]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.145 0.855]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.34
Validation accuracy: 20.20
Validation recall: 100.00
Validation precision: 7.72
Validation AUC: 0.2839903833093268
Validation class accuracies: [0.14485165794066318, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 15/65
154/154 - 76s - loss: 0.5997 - accuracy: 0.2429 - val_loss: 0.7618 - val_accuracy: 0.1987
Confusion matrix: 
 [[ 81 492]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.141 0.859]
 [0.    1.   ]]
Validation f1: 14.29
Validation accuracy: 19.87
Validation recall: 100.00
Validation precision: 7.69
Validation AUC: 0.3461596338226879
Validation class accuracies: [0.14136125654450263, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 13 epochs
Epoch 16/65
154/154 - 75s - loss: 0.5756 - accuracy: 0.2449 - val_loss: 0.7438 - val_accuracy: 0.1954
Confusion matrix: 
 [[ 79 494]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.138 0.862]
 [0.    1.   ]]
Validation f1: 14.24
Validation accuracy: 19.54
Validation recall: 100.00
Validation precision: 7.66
Validation AUC: 0.42782702186387117
Validation class accuracies: [0.13787085514834205, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 14 epochs
Epoch 17/65
154/154 - 76s - loss: 0.5749 - accuracy: 0.2347 - val_loss: 0.7458 - val_accuracy: 0.1938
Confusion matrix: 
 [[ 78 495]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.136 0.864]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.21
Validation accuracy: 19.38
Validation recall: 100.00
Validation precision: 7.65
Validation AUC: 0.4151322162742608
Validation class accuracies: [0.13612565445026178, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 15 epochs
Epoch 18/65
154/154 - 76s - loss: 0.5711 - accuracy: 0.2449 - val_loss: 0.7205 - val_accuracy: 0.2166
Confusion matrix: 
 [[ 92 481]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.161 0.839]
 [0.    1.   ]]
Validation f1: 14.56
Validation accuracy: 21.66
Validation recall: 100.00
Validation precision: 7.85
Validation AUC: 0.45924113886319373
Validation class accuracies: [0.16055846422338568, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 16 epochs
Epoch 19/65
154/154 - 76s - loss: 0.5739 - accuracy: 0.2486 - val_loss: 0.7307 - val_accuracy: 0.2166
Confusion matrix: 
 [[ 92 481]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.161 0.839]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.56
Validation accuracy: 21.66
Validation recall: 100.00
Validation precision: 7.85
Validation AUC: 0.40734225571533655
Validation class accuracies: [0.16055846422338568, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 17 epochs
Epoch 20/65
154/154 - 76s - loss: 0.5832 - accuracy: 0.2535 - val_loss: 0.7301 - val_accuracy: 0.2166
Confusion matrix: 
 [[ 92 481]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.161 0.839]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.56
Validation accuracy: 21.66
Validation recall: 100.00
Validation precision: 7.85
Validation AUC: 0.39780764025394094
Validation class accuracies: [0.16055846422338568, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 21/65
154/154 - 76s - loss: 0.5768 - accuracy: 0.2563 - val_loss: 0.7291 - val_accuracy: 0.2101
Confusion matrix: 
 [[ 88 485]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.154 0.846]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.46
Validation accuracy: 21.01
Validation recall: 100.00
Validation precision: 7.79
Validation AUC: 0.43448568775913804
Validation class accuracies: [0.15357766143106458, 1.0]
The validation tracker metric at 0.22222222222222224 hasn't increased by 0 in 19 epochs
Epoch 22/65
154/154 - 76s - loss: 0.5764 - accuracy: 0.2587 - val_loss: 0.7263 - val_accuracy: 0.2134
Confusion matrix: 
 [[ 90 483]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.157 0.843]
 [0.    1.   ]]
Validation f1: 14.51
Validation accuracy: 21.34
Validation recall: 100.00
Validation precision: 7.82
Validation AUC: 0.41392181378629905
Validation class accuracies: [0.15706806282722513, 1.0]

The metrics for job 2 with the best target metric are: 
Best cm: [[534  39]
 [ 31  10]]
Best normalized cm: [[0.932 0.068]
 [0.756 0.244]]
Best f1: 0.22
Best accuracy: 0.89
Best recall: 0.24
Best precision: 0.20
Best AUC: 0.12
Best class accuracies: [0.9319371727748691, 0.24390243902439024]
Best epoch: 2
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 6063
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_200321-1f2pnnxb/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_200321-1f2pnnxb/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.25875
wandb:         val_accuracy 0.21336
wandb:             _runtime 1967
wandb:           _timestamp 1624826168
wandb:                _step 159
wandb:           train_loss 0.57642
wandb:             val_loss 0.72634
wandb:           val_recall 1.0
wandb:        val_precision 0.07824
wandb:               val_f1 0.14513
wandb:              val_auc 0.41392
wandb:                   lr 0.00013
wandb:          best_val_f1 0.22222
wandb:    best_val_accuracy 0.88599
wandb:   best_val_precision 0.20408
wandb:      best_val_recall 0.2439
wandb:             best_auc 0.11533
wandb:           best_epoch 2
wandb: Run history:
wandb:   train_accuracy █▅▃▁▁▂▂▂▂▁▁▁▂▂▂▂▂▂▂▂▂▂
wandb:     val_accuracy ▁█▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss ▄▇██▅▄▂▃▃▃▃▃▂▂▂▁▁▁▁▁▁▁
wandb:         val_loss █▁▅▅▆▆▆▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆
wandb:       val_recall █▁███▇████████████████
wandb:    val_precision ▁█▂▂▂▁▂▂▂▁▁▂▂▂▂▂▁▂▂▂▂▂
wandb:           val_f1 ▁█▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_auc ▄▂▁▃▄▆▃▃▄▅▃█▇▄▅▆▆▇▆▆▆▆
wandb:               lr ████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_200321-1f2pnnxb

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 10, 125, 128, 1) 4            input_4[0][0]                        
______________________________________________________________________________________________________________
time_distributed_55 (TimeDistribute (None, 10, 125, 128, 8) 80           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
time_distributed_56 (TimeDistribute (None, 10, 125, 128, 8) 162          time_distributed_55[0][0]            
______________________________________________________________________________________________________________
time_distributed_57 (TimeDistribute (None, 10, 125, 128, 8) 32           time_distributed_56[0][0]            
______________________________________________________________________________________________________________
time_distributed_58 (TimeDistribute (None, 10, 125, 128, 16 144          time_distributed_57[0][0]            
______________________________________________________________________________________________________________
time_distributed_60 (TimeDistribute (None, 10, 125, 128, 16 144          time_distributed_57[0][0]            
______________________________________________________________________________________________________________
time_distributed_62 (TimeDistribute (None, 10, 125, 128, 8) 0            time_distributed_57[0][0]            
______________________________________________________________________________________________________________
time_distributed_59 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_58[0][0]            
______________________________________________________________________________________________________________
time_distributed_61 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_60[0][0]            
______________________________________________________________________________________________________________
time_distributed_63 (TimeDistribute (None, 10, 125, 128, 16 144          time_distributed_62[0][0]            
______________________________________________________________________________________________________________
concatenate_56151 (Concatenate)     (None, 10, 125, 128, 48 0            time_distributed_59[0][0]            
                                                                         time_distributed_61[0][0]            
                                                                         time_distributed_63[0][0]            
______________________________________________________________________________________________________________
time_distributed_64 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_56151[0][0]              
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 10, 63, 64, 48)  192          time_distributed_64[0][0]            
______________________________________________________________________________________________________________
time_distributed_65 (TimeDistribute (None, 10, 63, 64, 32)  1568         batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
time_distributed_67 (TimeDistribute (None, 10, 63, 64, 32)  1568         batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
time_distributed_69 (TimeDistribute (None, 10, 63, 64, 48)  0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
time_distributed_66 (TimeDistribute (None, 10, 63, 64, 32)  9248         time_distributed_65[0][0]            
______________________________________________________________________________________________________________
time_distributed_68 (TimeDistribute (None, 10, 63, 64, 32)  25632        time_distributed_67[0][0]            
______________________________________________________________________________________________________________
time_distributed_70 (TimeDistribute (None, 10, 63, 64, 32)  1568         time_distributed_69[0][0]            
______________________________________________________________________________________________________________
concatenate_56152 (Concatenate)     (None, 10, 63, 64, 96)  0            time_distributed_66[0][0]            
                                                                         time_distributed_68[0][0]            
                                                                         time_distributed_70[0][0]            
______________________________________________________________________________________________________________
time_distributed_71 (TimeDistribute (None, 10, 32, 32, 96)  0            concatenate_56152[0][0]              
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 10, 32, 32, 96)  384          time_distributed_71[0][0]            
______________________________________________________________________________________________________________
time_distributed_72 (TimeDistribute (None, 10, 96)          0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
bidirectional_6 (Bidirectional)     (None, 10, 256)         230400       time_distributed_72[0][0]            
______________________________________________________________________________________________________________
bidirectional_7 (Bidirectional)     (None, 10, 256)         394240       bidirectional_6[0][0]                
______________________________________________________________________________________________________________
dense_9 (Dense)                     (None, 10, 128)         32896        bidirectional_7[0][0]                
______________________________________________________________________________________________________________
dense_10 (Dense)                    (None, 10, 1)           129          dense_9[0][0]                        
______________________________________________________________________________________________________________
flatten_3 (Flatten)                 (None, 10)              0            dense_10[0][0]                       
______________________________________________________________________________________________________________
dense_11 (Dense)                    (None, 1)               11           flatten_3[0][0]                      
==============================================================================================================
Total params: 707,282
Trainable params: 706,976
Non-trainable params: 306
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 96s - loss: 0.7958 - accuracy: 0.7644 - val_loss: 0.7293 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.05233985539920569
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 94s - loss: 0.7151 - accuracy: 0.8421 - val_loss: 1.1470 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.05833530714004811
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 94s - loss: 0.7381 - accuracy: 0.5338 - val_loss: 0.7245 - val_accuracy: 0.1971
Confusion matrix: 
 [[ 82 491]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.143 0.857]
 [0.049 0.951]]
Validation f1: 13.66
Validation accuracy: 19.71
Validation recall: 95.12
Validation precision: 7.36
Validation AUC: 0.0954677204277488
Validation class accuracies: [0.1431064572425829, 0.9512195121951219]
Saving model...
Epoch 4/65
154/154 - 93s - loss: 0.6959 - accuracy: 0.6550 - val_loss: 0.3365 - val_accuracy: 0.8990
Confusion matrix: 
 [[532  41]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.512 0.488]]
Validation f1: 39.22
Validation accuracy: 89.90
Validation recall: 48.78
Validation precision: 32.79
Validation AUC: 0.19892451861513794
Validation class accuracies: [0.9284467713787086, 0.4878048780487805]
Saving model...
Epoch 5/65
154/154 - 95s - loss: 0.6158 - accuracy: 0.7661 - val_loss: 0.4227 - val_accuracy: 0.8029
Confusion matrix: 
 [[457 116]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.798 0.202]
 [0.122 0.878]]
Validation f1: 37.31
Validation accuracy: 80.29
Validation recall: 87.80
Validation precision: 23.68
Validation AUC: 0.16015569181148331
Validation class accuracies: [0.7975567190226877, 0.8780487804878049]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 94s - loss: 0.6806 - accuracy: 0.7482 - val_loss: 0.7630 - val_accuracy: 0.1954
Confusion matrix: 
 [[ 79 494]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.138 0.862]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.24
Validation accuracy: 19.54
Validation recall: 100.00
Validation precision: 7.66
Validation AUC: 0.04124748490945674
Validation class accuracies: [0.13787085514834205, 1.0]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 2 epochs
Epoch 7/65
154/154 - 94s - loss: 0.6246 - accuracy: 0.8295 - val_loss: 0.4292 - val_accuracy: 0.7492
Confusion matrix: 
 [[423 150]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.738 0.262]
 [0.098 0.902]]
Validation f1: 32.46
Validation accuracy: 74.92
Validation recall: 90.24
Validation precision: 19.79
Validation AUC: 0.10339039300491404
Validation class accuracies: [0.7382198952879581, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 3 epochs
Epoch 8/65
154/154 - 93s - loss: 0.6146 - accuracy: 0.7172 - val_loss: 0.8108 - val_accuracy: 0.1384
Confusion matrix: 
 [[ 44 529]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.077 0.923]
 [0.    1.   ]]
Validation f1: 13.42
Validation accuracy: 13.84
Validation recall: 100.00
Validation precision: 7.19
Validation AUC: 0.03700361010830325
Validation class accuracies: [0.07678883071553229, 1.0]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 4 epochs
Epoch 9/65
154/154 - 94s - loss: 0.6349 - accuracy: 0.6790 - val_loss: 0.4531 - val_accuracy: 0.6564
Confusion matrix: 
 [[362 211]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.632 0.368]
 [0.    1.   ]]
Validation f1: 27.99
Validation accuracy: 65.64
Validation recall: 100.00
Validation precision: 16.27
Validation AUC: 0.09151785714285714
Validation class accuracies: [0.631762652705061, 1.0]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 5 epochs
Epoch 10/65
154/154 - 94s - loss: 0.5887 - accuracy: 0.8124 - val_loss: 0.5152 - val_accuracy: 0.5879
Confusion matrix: 
 [[320 253]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.558 0.442]
 [0.    1.   ]]
Validation f1: 24.48
Validation accuracy: 58.79
Validation recall: 100.00
Validation precision: 13.95
Validation AUC: 0.582
Validation class accuracies: [0.5584642233856894, 1.0]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
154/154 - 93s - loss: 0.5598 - accuracy: 0.7982 - val_loss: 0.4331 - val_accuracy: 0.7036
Confusion matrix: 
 [[394 179]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.688 0.312]
 [0.073 0.927]]
Validation f1: 29.46
Validation accuracy: 70.36
Validation recall: 92.68
Validation precision: 17.51
Validation AUC: 0.5590469846950928
Validation class accuracies: [0.68760907504363, 0.926829268292683]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 7 epochs
Epoch 12/65
154/154 - 95s - loss: 0.5632 - accuracy: 0.7750 - val_loss: 0.4352 - val_accuracy: 0.6889
Confusion matrix: 
 [[385 188]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.672 0.328]
 [0.073 0.927]]
Validation f1: 28.46
Validation accuracy: 68.89
Validation recall: 92.68
Validation precision: 16.81
Validation AUC: 0.5600313673546016
Validation class accuracies: [0.6719022687609075, 0.926829268292683]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 8 epochs
Epoch 13/65
154/154 - 94s - loss: 0.5506 - accuracy: 0.7937 - val_loss: 0.4020 - val_accuracy: 0.7573
Confusion matrix: 
 [[428 145]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.747 0.253]
 [0.098 0.902]]
Validation f1: 33.18
Validation accuracy: 75.73
Validation recall: 90.24
Validation precision: 20.33
Validation AUC: 0.5448368191589736
Validation class accuracies: [0.7469458987783595, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 9 epochs
Epoch 14/65
154/154 - 94s - loss: 0.5487 - accuracy: 0.8043 - val_loss: 0.4201 - val_accuracy: 0.7345
Confusion matrix: 
 [[414 159]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.723 0.277]
 [0.098 0.902]]
Validation f1: 31.22
Validation accuracy: 73.45
Validation recall: 90.24
Validation precision: 18.88
Validation AUC: 0.5618447786633782
Validation class accuracies: [0.7225130890052356, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 10 epochs
Epoch 15/65
154/154 - 94s - loss: 0.5341 - accuracy: 0.8198 - val_loss: 0.4059 - val_accuracy: 0.7378
Confusion matrix: 
 [[416 157]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.098 0.902]]
Validation f1: 31.49
Validation accuracy: 73.78
Validation recall: 90.24
Validation precision: 19.07
Validation AUC: 0.5646384568074603
Validation class accuracies: [0.7260034904013961, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 11 epochs
Epoch 16/65
154/154 - 94s - loss: 0.5408 - accuracy: 0.8072 - val_loss: 0.3698 - val_accuracy: 0.7915
Confusion matrix: 
 [[448 125]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.782 0.218]
 [0.073 0.927]]
Validation f1: 37.25
Validation accuracy: 79.15
Validation recall: 92.68
Validation precision: 23.31
Validation AUC: 0.5866479102302227
Validation class accuracies: [0.7818499127399651, 0.926829268292683]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 17/65
154/154 - 94s - loss: 0.5286 - accuracy: 0.8617 - val_loss: 0.3650 - val_accuracy: 0.7932
Confusion matrix: 
 [[451 122]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.122 0.878]]
Validation f1: 36.18
Validation accuracy: 79.32
Validation recall: 87.80
Validation precision: 22.78
Validation AUC: 0.5614401936362906
Validation class accuracies: [0.787085514834206, 0.8780487804878049]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 13 epochs
Epoch 18/65
154/154 - 94s - loss: 0.5272 - accuracy: 0.8572 - val_loss: 0.3625 - val_accuracy: 0.7866
Confusion matrix: 
 [[446 127]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.778 0.222]
 [0.098 0.902]]
Validation f1: 36.10
Validation accuracy: 78.66
Validation recall: 90.24
Validation precision: 22.56
Validation AUC: 0.5751260583490019
Validation class accuracies: [0.7783595113438045, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 14 epochs
Epoch 19/65
154/154 - 94s - loss: 0.5207 - accuracy: 0.8491 - val_loss: 0.3667 - val_accuracy: 0.7834
Confusion matrix: 
 [[444 129]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.098 0.902]]
Validation f1: 35.75
Validation accuracy: 78.34
Validation recall: 90.24
Validation precision: 22.29
Validation AUC: 0.5722801172330573
Validation class accuracies: [0.774869109947644, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 15 epochs
Epoch 20/65
154/154 - 93s - loss: 0.5199 - accuracy: 0.8515 - val_loss: 0.3707 - val_accuracy: 0.7622
Confusion matrix: 
 [[431 142]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.752 0.248]
 [0.098 0.902]]
Validation f1: 33.64
Validation accuracy: 76.22
Validation recall: 90.24
Validation precision: 20.67
Validation AUC: 0.5602232007716506
Validation class accuracies: [0.7521815008726004, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 16 epochs
Epoch 21/65
154/154 - 94s - loss: 0.5124 - accuracy: 0.8401 - val_loss: 0.3841 - val_accuracy: 0.7459
Confusion matrix: 
 [[420 153]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.733 0.267]
 [0.073 0.927]]
Validation f1: 32.76
Validation accuracy: 74.59
Validation recall: 92.68
Validation precision: 19.90
Validation AUC: 0.1277764759834327
Validation class accuracies: [0.7329842931937173, 0.926829268292683]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 17 epochs
Epoch 22/65
154/154 - 94s - loss: 0.5110 - accuracy: 0.8478 - val_loss: 0.3591 - val_accuracy: 0.7785
Confusion matrix: 
 [[441 132]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77  0.23 ]
 [0.098 0.902]]
Validation f1: 35.24
Validation accuracy: 77.85
Validation recall: 90.24
Validation precision: 21.89
Validation AUC: 0.14216911682751127
Validation class accuracies: [0.7696335078534031, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 23/65
154/154 - 95s - loss: 0.5110 - accuracy: 0.8596 - val_loss: 0.3630 - val_accuracy: 0.7785
Confusion matrix: 
 [[441 132]
 [  4  37]]
Normalized Confusion matrix: 
 [[0.77  0.23 ]
 [0.098 0.902]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.24
Validation accuracy: 77.85
Validation recall: 90.24
Validation precision: 21.89
Validation AUC: 0.14294227707772755
Validation class accuracies: [0.7696335078534031, 0.9024390243902439]
The validation tracker metric at 0.39215686274509803 hasn't increased by 0 in 19 epochs
Epoch 24/65
154/154 - 94s - loss: 0.5216 - accuracy: 0.8592 - val_loss: 0.3639 - val_accuracy: 0.7801
Confusion matrix: 
 [[442 131]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.771 0.229]
 [0.098 0.902]]
Validation f1: 35.41
Validation accuracy: 78.01
Validation recall: 90.24
Validation precision: 22.02
Validation AUC: 0.5688583365972963
Validation class accuracies: [0.7713787085514834, 0.9024390243902439]

The metrics for job 3 with the best target metric are: 
Best cm: [[532  41]
 [ 21  20]]
Best normalized cm: [[0.928 0.072]
 [0.512 0.488]]
Best f1: 0.39
Best accuracy: 0.90
Best recall: 0.49
Best precision: 0.33
Best AUC: 0.20
Best class accuracies: [0.9284467713787086, 0.4878048780487805]
Best epoch: 4
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 12352
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_203612-2u94hnz4/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_203612-2u94hnz4/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.85924
wandb:         val_accuracy 0.78013
wandb:             _runtime 2568
wandb:           _timestamp 1624828740
wandb:                _step 176
wandb:           train_loss 0.5216
wandb:             val_loss 0.36388
wandb:           val_recall 0.90244
wandb:        val_precision 0.22024
wandb:               val_f1 0.35407
wandb:              val_auc 0.56886
wandb:                   lr 0.00013
wandb:          best_val_f1 0.39216
wandb:    best_val_accuracy 0.89902
wandb:   best_val_precision 0.32787
wandb:      best_val_recall 0.4878
wandb:             best_auc 0.19892
wandb:           best_epoch 4
wandb: Run history:
wandb:   train_accuracy ▆█▁▄▆▆▇▅▄▇▇▆▇▇▇▇████████
wandb:     val_accuracy ▁▁▂█▇▂▇▂▆▅▆▆▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▇▆▄▅▄▄▄▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb:         val_loss ▄█▄▁▂▅▂▅▂▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb:       val_recall ██▇▁▆█▇███▇▇▇▇▇▇▆▇▇▇▇▇▇▇
wandb:    val_precision ▁▁▁█▆▁▅▁▄▃▄▄▅▄▄▅▅▅▅▅▅▅▅▅
wandb:           val_f1 ▁▁▁█▇▁▆▁▅▄▅▅▆▆▆▇▇▇▇▇▆▇▇▇
wandb:          val_auc ▁▁▂▃▃▁▂▁▂███▇███████▂▂▂█
wandb:               lr ██████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_203612-2u94hnz4

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_5 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 10, 125, 128, 1) 4            input_5[0][0]                        
______________________________________________________________________________________________________________
time_distributed_73 (TimeDistribute (None, 10, 125, 128, 8) 80           batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
time_distributed_74 (TimeDistribute (None, 10, 125, 128, 8) 162          time_distributed_73[0][0]            
______________________________________________________________________________________________________________
time_distributed_75 (TimeDistribute (None, 10, 125, 128, 8) 32           time_distributed_74[0][0]            
______________________________________________________________________________________________________________
time_distributed_76 (TimeDistribute (None, 10, 125, 128, 16 144          time_distributed_75[0][0]            
______________________________________________________________________________________________________________
time_distributed_78 (TimeDistribute (None, 10, 125, 128, 16 144          time_distributed_75[0][0]            
______________________________________________________________________________________________________________
time_distributed_80 (TimeDistribute (None, 10, 125, 128, 8) 0            time_distributed_75[0][0]            
______________________________________________________________________________________________________________
time_distributed_77 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_76[0][0]            
______________________________________________________________________________________________________________
time_distributed_79 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_78[0][0]            
______________________________________________________________________________________________________________
time_distributed_81 (TimeDistribute (None, 10, 125, 128, 16 144          time_distributed_80[0][0]            
______________________________________________________________________________________________________________
concatenate_117401 (Concatenate)    (None, 10, 125, 128, 48 0            time_distributed_77[0][0]            
                                                                         time_distributed_79[0][0]            
                                                                         time_distributed_81[0][0]            
______________________________________________________________________________________________________________
time_distributed_82 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_117401[0][0]             
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 10, 63, 64, 48)  192          time_distributed_82[0][0]            
______________________________________________________________________________________________________________
time_distributed_83 (TimeDistribute (None, 10, 63, 64, 32)  1568         batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
time_distributed_85 (TimeDistribute (None, 10, 63, 64, 32)  1568         batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
time_distributed_87 (TimeDistribute (None, 10, 63, 64, 48)  0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
time_distributed_84 (TimeDistribute (None, 10, 63, 64, 32)  9248         time_distributed_83[0][0]            
______________________________________________________________________________________________________________
time_distributed_86 (TimeDistribute (None, 10, 63, 64, 32)  25632        time_distributed_85[0][0]            
______________________________________________________________________________________________________________
time_distributed_88 (TimeDistribute (None, 10, 63, 64, 32)  1568         time_distributed_87[0][0]            
______________________________________________________________________________________________________________
concatenate_117402 (Concatenate)    (None, 10, 63, 64, 96)  0            time_distributed_84[0][0]            
                                                                         time_distributed_86[0][0]            
                                                                         time_distributed_88[0][0]            
______________________________________________________________________________________________________________
time_distributed_89 (TimeDistribute (None, 10, 32, 32, 96)  0            concatenate_117402[0][0]             
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormal (None, 10, 32, 32, 96)  384          time_distributed_89[0][0]            
______________________________________________________________________________________________________________
time_distributed_90 (TimeDistribute (None, 10, 32, 32, 64)  55360        batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
time_distributed_91 (TimeDistribute (None, 10, 32, 32, 64)  1656         time_distributed_90[0][0]            
______________________________________________________________________________________________________________
time_distributed_92 (TimeDistribute (None, 10, 32, 32, 64)  256          time_distributed_91[0][0]            
______________________________________________________________________________________________________________
time_distributed_93 (TimeDistribute (None, 10, 64)          0            time_distributed_92[0][0]            
______________________________________________________________________________________________________________
bidirectional_8 (Bidirectional)     (None, 10, 256)         197632       time_distributed_93[0][0]            
______________________________________________________________________________________________________________
bidirectional_9 (Bidirectional)     (None, 10, 256)         394240       bidirectional_8[0][0]                
______________________________________________________________________________________________________________
dense_12 (Dense)                    (None, 10, 128)         32896        bidirectional_9[0][0]                
______________________________________________________________________________________________________________
dense_13 (Dense)                    (None, 10, 1)           129          dense_12[0][0]                       
______________________________________________________________________________________________________________
flatten_4 (Flatten)                 (None, 10)              0            dense_13[0][0]                       
______________________________________________________________________________________________________________
dense_14 (Dense)                    (None, 1)               11           flatten_4[0][0]                      
==============================================================================================================
Total params: 731,786
Trainable params: 731,352
Non-trainable params: 434
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 102s - loss: 0.7354 - accuracy: 0.7124 - val_loss: 0.7205 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.5333876221498371
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 102s - loss: 0.7193 - accuracy: 0.6172 - val_loss: 0.7467 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.5333876221498371
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 102s - loss: 0.6939 - accuracy: 0.5606 - val_loss: 0.5103 - val_accuracy: 0.4935
Confusion matrix: 
 [[262 311]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.457 0.543]
 [0.    1.   ]]
Validation f1: 20.87
Validation accuracy: 49.35
Validation recall: 100.00
Validation precision: 11.65
Validation AUC: 0.5262206991784782
Validation class accuracies: [0.4572425828970332, 1.0]
Saving model...
Epoch 4/65
154/154 - 101s - loss: 0.6268 - accuracy: 0.6241 - val_loss: 0.5932 - val_accuracy: 0.3746
Confusion matrix: 
 [[193 380]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.337 0.663]
 [0.098 0.902]]
Validation f1: 16.16
Validation accuracy: 37.46
Validation recall: 90.24
Validation precision: 8.87
Validation AUC: 0.4218036081387903
Validation class accuracies: [0.3368237347294939, 0.9024390243902439]
The validation tracker metric at 0.20865139949109415 hasn't increased by 0 in 1 epochs
Epoch 5/65
154/154 - 101s - loss: 0.6732 - accuracy: 0.6737 - val_loss: 0.3891 - val_accuracy: 0.7280
Confusion matrix: 
 [[406 167]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.709 0.291]
 [0.    1.   ]]
Validation f1: 32.93
Validation accuracy: 72.80
Validation recall: 100.00
Validation precision: 19.71
Validation AUC: 0.41896529801424576
Validation class accuracies: [0.7085514834205934, 1.0]
Saving model...
Epoch 6/65
154/154 - 102s - loss: 0.5656 - accuracy: 0.7941 - val_loss: 0.6958 - val_accuracy: 0.2606
Confusion matrix: 
 [[119 454]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.208 0.792]
 [0.    1.   ]]
Validation f1: 15.30
Validation accuracy: 26.06
Validation recall: 100.00
Validation precision: 8.28
Validation AUC: 0.11166665992270777
Validation class accuracies: [0.20767888307155322, 1.0]
The validation tracker metric at 0.3293172690763052 hasn't increased by 0 in 1 epochs
Epoch 7/65
154/154 - 102s - loss: 0.5709 - accuracy: 0.7457 - val_loss: 0.6057 - val_accuracy: 0.4007
Confusion matrix: 
 [[206 367]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.36  0.64 ]
 [0.024 0.976]]
Validation f1: 17.86
Validation accuracy: 40.07
Validation recall: 97.56
Validation precision: 9.83
Validation AUC: 0.46101941892732523
Validation class accuracies: [0.35951134380453753, 0.975609756097561]
The validation tracker metric at 0.3293172690763052 hasn't increased by 0 in 2 epochs
Epoch 8/65
154/154 - 102s - loss: 0.5673 - accuracy: 0.7071 - val_loss: 0.6867 - val_accuracy: 0.3013
Confusion matrix: 
 [[144 429]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.251 0.749]
 [0.    1.   ]]
Validation f1: 16.05
Validation accuracy: 30.13
Validation recall: 100.00
Validation precision: 8.72
Validation AUC: 0.557909604519774
Validation class accuracies: [0.2513089005235602, 1.0]
The validation tracker metric at 0.3293172690763052 hasn't increased by 0 in 3 epochs
Epoch 9/65
154/154 - 102s - loss: 0.5480 - accuracy: 0.7303 - val_loss: 0.2561 - val_accuracy: 0.8632
Confusion matrix: 
 [[495  78]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.45
Validation accuracy: 86.32
Validation recall: 85.37
Validation precision: 30.97
Validation AUC: 0.535841006040717
Validation class accuracies: [0.8638743455497382, 0.8536585365853658]
Saving model...
Epoch 10/65
154/154 - 102s - loss: 0.5659 - accuracy: 0.8161 - val_loss: 0.3809 - val_accuracy: 0.7101
Confusion matrix: 
 [[395 178]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.689 0.311]
 [0.    1.   ]]
Validation f1: 31.54
Validation accuracy: 71.01
Validation recall: 100.00
Validation precision: 18.72
Validation AUC: 0.5990338164251208
Validation class accuracies: [0.6893542757417103, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 1 epochs
Epoch 11/65
154/154 - 102s - loss: 0.6189 - accuracy: 0.8401 - val_loss: 0.3069 - val_accuracy: 0.8355
Confusion matrix: 
 [[483  90]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.268 0.732]]
Validation f1: 37.27
Validation accuracy: 83.55
Validation recall: 73.17
Validation precision: 25.00
Validation AUC: 0.4330795069694659
Validation class accuracies: [0.8429319371727748, 0.7317073170731707]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 2 epochs
Epoch 12/65
154/154 - 102s - loss: 1.0788 - accuracy: 0.8743 - val_loss: 0.4630 - val_accuracy: 0.8029
Confusion matrix: 
 [[493  80]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86 0.14]
 [1.   0.  ]]
Validation f1: 0.00
Validation accuracy: 80.29
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0399765459092659
Validation class accuracies: [0.8603839441535777, 0.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 3 epochs
Epoch 13/65
154/154 - 102s - loss: 0.9495 - accuracy: 0.9101 - val_loss: 0.5166 - val_accuracy: 0.9121
Confusion matrix: 
 [[560  13]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 91.21
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.042095227380779685
Validation class accuracies: [0.9773123909249564, 0.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 4 epochs
Epoch 14/65
154/154 - 102s - loss: 0.8446 - accuracy: 0.9268 - val_loss: 0.6134 - val_accuracy: 0.9251
Confusion matrix: 
 [[568   5]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 92.51
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.043796326447030465
Validation class accuracies: [0.9912739965095986, 0.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 5 epochs
Epoch 15/65
154/154 - 102s - loss: 0.8091 - accuracy: 0.9284 - val_loss: 0.6770 - val_accuracy: 0.9202
Confusion matrix: 
 [[565   8]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 92.02
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.04300335827714931
Validation class accuracies: [0.9860383944153578, 0.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
154/154 - 102s - loss: 0.7974 - accuracy: 0.6684 - val_loss: 0.7053 - val_accuracy: 0.0928
Confusion matrix: 
 [[ 16 557]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.028 0.972]
 [0.    1.   ]]
Validation f1: 12.83
Validation accuracy: 9.28
Validation recall: 100.00
Validation precision: 6.86
Validation AUC: 0.04332783070665276
Validation class accuracies: [0.027923211169284468, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 7 epochs
Epoch 17/65
154/154 - 102s - loss: 0.7930 - accuracy: 0.0679 - val_loss: 0.7249 - val_accuracy: 0.0814
Confusion matrix: 
 [[  9 564]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.016 0.984]
 [0.    1.   ]]
Validation f1: 12.69
Validation accuracy: 8.14
Validation recall: 100.00
Validation precision: 6.78
Validation AUC: 0.042506664599879375
Validation class accuracies: [0.015706806282722512, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 8 epochs
Epoch 18/65
154/154 - 101s - loss: 0.7902 - accuracy: 0.0647 - val_loss: 0.7409 - val_accuracy: 0.1140
Confusion matrix: 
 [[ 29 544]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.051 0.949]
 [0.    1.   ]]
Validation f1: 13.10
Validation accuracy: 11.40
Validation recall: 100.00
Validation precision: 7.01
Validation AUC: 0.046166713300320045
Validation class accuracies: [0.0506108202443281, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 9 epochs
Epoch 19/65
154/154 - 101s - loss: 0.7884 - accuracy: 0.0655 - val_loss: 0.7555 - val_accuracy: 0.0879
Confusion matrix: 
 [[ 13 560]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.023 0.977]
 [0.    1.   ]]
Validation f1: 12.77
Validation accuracy: 8.79
Validation recall: 100.00
Validation precision: 6.82
Validation AUC: 0.0438934603426541
Validation class accuracies: [0.02268760907504363, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 10 epochs
Epoch 20/65
154/154 - 102s - loss: 0.7871 - accuracy: 0.0655 - val_loss: 0.7682 - val_accuracy: 0.0847
Confusion matrix: 
 [[ 11 562]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.019 0.981]
 [0.    1.   ]]
Validation f1: 12.73
Validation accuracy: 8.47
Validation recall: 100.00
Validation precision: 6.80
Validation AUC: 0.043263576518035224
Validation class accuracies: [0.019197207678883072, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 11 epochs
Epoch 21/65
154/154 - 102s - loss: 0.7860 - accuracy: 0.0659 - val_loss: 0.7788 - val_accuracy: 0.0847
Confusion matrix: 
 [[ 11 562]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.019 0.981]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.73
Validation accuracy: 8.47
Validation recall: 100.00
Validation precision: 6.80
Validation AUC: 0.04319785186008604
Validation class accuracies: [0.019197207678883072, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
154/154 - 102s - loss: 0.7857 - accuracy: 0.0659 - val_loss: 0.7821 - val_accuracy: 0.0896
Confusion matrix: 
 [[ 14 559]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.024 0.976]
 [0.    1.   ]]
Validation f1: 12.79
Validation accuracy: 8.96
Validation recall: 100.00
Validation precision: 6.83
Validation AUC: 0.043180580105349683
Validation class accuracies: [0.02443280977312391, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 13 epochs
Epoch 23/65
154/154 - 102s - loss: 0.7856 - accuracy: 0.0651 - val_loss: 0.7851 - val_accuracy: 0.0896
Confusion matrix: 
 [[ 14 559]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.024 0.976]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.79
Validation accuracy: 8.96
Validation recall: 100.00
Validation precision: 6.83
Validation AUC: 0.043290432149658636
Validation class accuracies: [0.02443280977312391, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 14 epochs
Epoch 24/65
154/154 - 102s - loss: 0.7856 - accuracy: 0.0647 - val_loss: 0.7880 - val_accuracy: 0.0896
Confusion matrix: 
 [[ 14 559]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.024 0.976]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.79
Validation accuracy: 8.96
Validation recall: 100.00
Validation precision: 6.83
Validation AUC: 0.04366502497504138
Validation class accuracies: [0.02443280977312391, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 15 epochs
Epoch 25/65
154/154 - 102s - loss: 0.7855 - accuracy: 0.0655 - val_loss: 0.7912 - val_accuracy: 0.0896
Confusion matrix: 
 [[ 14 559]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.024 0.976]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.79
Validation accuracy: 8.96
Validation recall: 100.00
Validation precision: 6.83
Validation AUC: 0.04441499341286932
Validation class accuracies: [0.02443280977312391, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 16 epochs
Epoch 26/65
154/154 - 102s - loss: 0.7852 - accuracy: 0.0655 - val_loss: 0.7932 - val_accuracy: 0.0928
Confusion matrix: 
 [[ 16 557]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.028 0.972]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.83
Validation accuracy: 9.28
Validation recall: 100.00
Validation precision: 6.86
Validation AUC: 0.04540946467438885
Validation class accuracies: [0.027923211169284468, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 17 epochs
Epoch 27/65
154/154 - 102s - loss: 0.7846 - accuracy: 0.0659 - val_loss: 0.7964 - val_accuracy: 0.0879
Confusion matrix: 
 [[ 13 560]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.023 0.977]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.77
Validation accuracy: 8.79
Validation recall: 100.00
Validation precision: 6.82
Validation AUC: 0.04446376415470205
Validation class accuracies: [0.02268760907504363, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
154/154 - 102s - loss: 0.7851 - accuracy: 0.0667 - val_loss: 0.7977 - val_accuracy: 0.0847
Confusion matrix: 
 [[ 11 562]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.019 0.981]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.73
Validation accuracy: 8.47
Validation recall: 100.00
Validation precision: 6.80
Validation AUC: 0.044027672843669444
Validation class accuracies: [0.019197207678883072, 1.0]
The validation tracker metric at 0.45454545454545453 hasn't increased by 0 in 19 epochs
Epoch 29/65
154/154 - 102s - loss: 0.7847 - accuracy: 0.0663 - val_loss: 0.7990 - val_accuracy: 0.0831
Confusion matrix: 
 [[ 10 563]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.017 0.983]
 [0.    1.   ]]
Validation f1: 12.71
Validation accuracy: 8.31
Validation recall: 100.00
Validation precision: 6.79
Validation AUC: 0.04409522263578603
Validation class accuracies: [0.017452006980802792, 1.0]

The metrics for job 4 with the best target metric are: 
Best cm: [[495  78]
 [  6  35]]
Best normalized cm: [[0.864 0.136]
 [0.146 0.854]]
Best f1: 0.45
Best accuracy: 0.86
Best recall: 0.85
Best precision: 0.31
Best AUC: 0.54
Best class accuracies: [0.8638743455497382, 0.8536585365853658]
Best epoch: 9
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 20281
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_211904-2phwai50/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_211904-2phwai50/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.06631
wandb:         val_accuracy 0.08306
wandb:             _runtime 3335
wandb:           _timestamp 1624832080
wandb:                _step 214
wandb:           train_loss 0.78472
wandb:             val_loss 0.79903
wandb:           val_recall 1.0
wandb:        val_precision 0.06788
wandb:               val_f1 0.12713
wandb:              val_auc 0.0441
wandb:                   lr 0.00013
wandb:          best_val_f1 0.45455
wandb:    best_val_accuracy 0.86319
wandb:   best_val_precision 0.30973
wandb:      best_val_recall 0.85366
wandb:             best_auc 0.53584
wandb:           best_epoch 9
wandb: Run history:
wandb:   train_accuracy ▆▅▅▆▆▇▇▆▆▇▇████▆▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     val_accuracy ▁▁▄▄▆▃▄▃▇▆▇▇███▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ▃▃▃▂▃▁▁▁▁▁▂█▆▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         val_loss ▇▇▄▅▃▇▆▇▁▃▂▄▄▆▆▇▇▇▇██████████
wandb:       val_recall ███▇████▇█▆▁▁▁▁██████████████
wandb:    val_precision ▃▃▄▃▅▃▃▃█▅▇▁▁▁▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_f1 ▃▃▄▃▆▃▄▃█▆▇▁▁▁▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:          val_auc ▇▇▇▆▆▂▆▇▇█▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               lr ███████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_211904-2phwai50

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_6 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormal (None, 10, 125, 128, 1) 4            input_6[0][0]                        
______________________________________________________________________________________________________________
time_distributed_94 (TimeDistribute (None, 10, 125, 128, 8) 80           batch_normalization_20[0][0]         
______________________________________________________________________________________________________________
time_distributed_95 (TimeDistribute (None, 10, 125, 128, 8) 162          time_distributed_94[0][0]            
______________________________________________________________________________________________________________
time_distributed_96 (TimeDistribute (None, 10, 125, 128, 8) 32           time_distributed_95[0][0]            
______________________________________________________________________________________________________________
time_distributed_97 (TimeDistribute (None, 10, 125, 128, 16 144          time_distributed_96[0][0]            
______________________________________________________________________________________________________________
time_distributed_99 (TimeDistribute (None, 10, 125, 128, 16 144          time_distributed_96[0][0]            
______________________________________________________________________________________________________________
time_distributed_101 (TimeDistribut (None, 10, 125, 128, 8) 0            time_distributed_96[0][0]            
______________________________________________________________________________________________________________
time_distributed_98 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_97[0][0]            
______________________________________________________________________________________________________________
time_distributed_100 (TimeDistribut (None, 10, 125, 128, 16 6416         time_distributed_99[0][0]            
______________________________________________________________________________________________________________
time_distributed_102 (TimeDistribut (None, 10, 125, 128, 16 144          time_distributed_101[0][0]           
______________________________________________________________________________________________________________
concatenate_265419 (Concatenate)    (None, 10, 125, 128, 48 0            time_distributed_98[0][0]            
                                                                         time_distributed_100[0][0]           
                                                                         time_distributed_102[0][0]           
______________________________________________________________________________________________________________
time_distributed_103 (TimeDistribut (None, 10, 63, 64, 48)  0            concatenate_265419[0][0]             
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormal (None, 10, 63, 64, 48)  192          time_distributed_103[0][0]           
______________________________________________________________________________________________________________
time_distributed_104 (TimeDistribut (None, 10, 63, 64, 32)  1568         batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
time_distributed_106 (TimeDistribut (None, 10, 63, 64, 32)  1568         batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
time_distributed_108 (TimeDistribut (None, 10, 63, 64, 48)  0            batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
time_distributed_105 (TimeDistribut (None, 10, 63, 64, 32)  9248         time_distributed_104[0][0]           
______________________________________________________________________________________________________________
time_distributed_107 (TimeDistribut (None, 10, 63, 64, 32)  25632        time_distributed_106[0][0]           
______________________________________________________________________________________________________________
time_distributed_109 (TimeDistribut (None, 10, 63, 64, 32)  1568         time_distributed_108[0][0]           
______________________________________________________________________________________________________________
concatenate_265420 (Concatenate)    (None, 10, 63, 64, 96)  0            time_distributed_105[0][0]           
                                                                         time_distributed_107[0][0]           
                                                                         time_distributed_109[0][0]           
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormal (None, 10, 63, 64, 96)  384          concatenate_265420[0][0]             
______________________________________________________________________________________________________________
time_distributed_110 (TimeDistribut (None, 10, 63, 64, 64)  55360        batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
time_distributed_111 (TimeDistribut (None, 10, 63, 64, 64)  1656         time_distributed_110[0][0]           
______________________________________________________________________________________________________________
time_distributed_112 (TimeDistribut (None, 10, 32, 32, 64)  0            time_distributed_111[0][0]           
______________________________________________________________________________________________________________
time_distributed_113 (TimeDistribut (None, 10, 32, 32, 64)  256          time_distributed_112[0][0]           
______________________________________________________________________________________________________________
time_distributed_114 (TimeDistribut (None, 10, 64)          0            time_distributed_113[0][0]           
______________________________________________________________________________________________________________
bidirectional_10 (Bidirectional)    (None, 10, 256)         197632       time_distributed_114[0][0]           
______________________________________________________________________________________________________________
bidirectional_11 (Bidirectional)    (None, 10, 256)         394240       bidirectional_10[0][0]               
______________________________________________________________________________________________________________
dense_15 (Dense)                    (None, 10, 128)         32896        bidirectional_11[0][0]               
______________________________________________________________________________________________________________
dense_16 (Dense)                    (None, 10, 1)           129          dense_15[0][0]                       
______________________________________________________________________________________________________________
flatten_5 (Flatten)                 (None, 10)              0            dense_16[0][0]                       
______________________________________________________________________________________________________________
dense_17 (Dense)                    (None, 1)               11           flatten_5[0][0]                      
==============================================================================================================
Total params: 731,786
Trainable params: 731,352
Non-trainable params: 434
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 127s - loss: 0.5967 - accuracy: 0.7441 - val_loss: 1.1217 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.040897981246245066
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 124s - loss: 0.5604 - accuracy: 0.7177 - val_loss: 1.1728 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.1640084179333321
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 123s - loss: 0.7193 - accuracy: 0.7087 - val_loss: 0.8115 - val_accuracy: 0.1156
Confusion matrix: 
 [[ 30 543]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.052 0.948]
 [0.    1.   ]]
Validation f1: 13.12
Validation accuracy: 11.56
Validation recall: 100.00
Validation precision: 7.02
Validation AUC: 0.1547760049583893
Validation class accuracies: [0.05235602094240838, 1.0]
Saving model...
Epoch 4/65
154/154 - 123s - loss: 0.6651 - accuracy: 0.6574 - val_loss: 0.9308 - val_accuracy: 0.3436
Confusion matrix: 
 [[171 402]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.298 0.702]
 [0.024 0.976]]
Validation f1: 16.56
Validation accuracy: 34.36
Validation recall: 97.56
Validation precision: 9.05
Validation AUC: 0.27977672641758566
Validation class accuracies: [0.29842931937172773, 0.975609756097561]
Saving model...
Epoch 5/65
154/154 - 123s - loss: 0.6081 - accuracy: 0.5879 - val_loss: 0.6322 - val_accuracy: 0.5440
Confusion matrix: 
 [[298 275]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.52  0.48 ]
 [0.122 0.878]]
Validation f1: 20.45
Validation accuracy: 54.40
Validation recall: 87.80
Validation precision: 11.58
Validation AUC: 0.28749548859213536
Validation class accuracies: [0.5200698080279232, 0.8780487804878049]
Saving model...
Epoch 6/65
154/154 - 124s - loss: 0.6342 - accuracy: 0.5553 - val_loss: 0.5277 - val_accuracy: 0.5651
Confusion matrix: 
 [[321 252]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.56  0.44 ]
 [0.366 0.634]]
Validation f1: 16.30
Validation accuracy: 56.51
Validation recall: 63.41
Validation precision: 9.35
Validation AUC: 0.2495104805938519
Validation class accuracies: [0.5602094240837696, 0.6341463414634146]
The validation tracker metric at 0.20454545454545453 hasn't increased by 0 in 1 epochs
Epoch 7/65
154/154 - 124s - loss: 0.5656 - accuracy: 0.5561 - val_loss: 0.6205 - val_accuracy: 0.5212
Confusion matrix: 
 [[279 294]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.487 0.513]
 [0.    1.   ]]
Validation f1: 21.81
Validation accuracy: 52.12
Validation recall: 100.00
Validation precision: 12.24
Validation AUC: 0.29625488352977386
Validation class accuracies: [0.4869109947643979, 1.0]
Saving model...
Epoch 8/65
154/154 - 124s - loss: 0.5562 - accuracy: 0.4817 - val_loss: 0.5348 - val_accuracy: 0.6336
Confusion matrix: 
 [[351 222]
 [  3  38]]
Normalized Confusion matrix: 
 [[0.613 0.387]
 [0.073 0.927]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.25
Validation accuracy: 63.36
Validation recall: 92.68
Validation precision: 14.62
Validation AUC: 0.296015687795403
Validation class accuracies: [0.612565445026178, 0.926829268292683]
Saving model...
Epoch 9/65
154/154 - 124s - loss: 0.5026 - accuracy: 0.5883 - val_loss: 0.5041 - val_accuracy: 0.6971
Confusion matrix: 
 [[388 185]
 [  1  40]]
Normalized Confusion matrix: 
 [[0.677 0.323]
 [0.024 0.976]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 30.08
Validation accuracy: 69.71
Validation recall: 97.56
Validation precision: 17.78
Validation AUC: 0.37718359302458115
Validation class accuracies: [0.6771378708551483, 0.975609756097561]
Saving model...
Epoch 10/65
154/154 - 124s - loss: 0.4992 - accuracy: 0.6798 - val_loss: 0.4589 - val_accuracy: 0.7443
Confusion matrix: 
 [[424 149]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.74  0.26 ]
 [0.195 0.805]]
Validation f1: 29.60
Validation accuracy: 74.43
Validation recall: 80.49
Validation precision: 18.13
Validation AUC: 0.35612344665193607
Validation class accuracies: [0.7399650959860384, 0.8048780487804879]
The validation tracker metric at 0.3007518796992481 hasn't increased by 0 in 1 epochs
Epoch 11/65
154/154 - 123s - loss: 0.4826 - accuracy: 0.7018 - val_loss: 0.4882 - val_accuracy: 0.7248
Confusion matrix: 
 [[409 164]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.714 0.286]
 [0.122 0.878]]
Validation f1: 29.88
Validation accuracy: 72.48
Validation recall: 87.80
Validation precision: 18.00
Validation AUC: 0.34167167316616814
Validation class accuracies: [0.7137870855148342, 0.8780487804878049]
The validation tracker metric at 0.3007518796992481 hasn't increased by 0 in 2 epochs
Epoch 12/65
154/154 - 124s - loss: 0.4738 - accuracy: 0.7295 - val_loss: 0.6035 - val_accuracy: 0.6857
Confusion matrix: 
 [[380 193]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.663 0.337]
 [0.    1.   ]]
Validation f1: 29.82
Validation accuracy: 68.57
Validation recall: 100.00
Validation precision: 17.52
Validation AUC: 0.33618696792295466
Validation class accuracies: [0.6631762652705061, 1.0]
The validation tracker metric at 0.3007518796992481 hasn't increased by 0 in 3 epochs
Epoch 13/65
154/154 - 124s - loss: 0.4816 - accuracy: 0.6924 - val_loss: 0.5154 - val_accuracy: 0.7476
Confusion matrix: 
 [[421 152]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.735 0.265]
 [0.073 0.927]]
Validation f1: 32.90
Validation accuracy: 74.76
Validation recall: 92.68
Validation precision: 20.00
Validation AUC: 0.3525600993025369
Validation class accuracies: [0.7347294938917975, 0.926829268292683]
Saving model...
Epoch 14/65
154/154 - 124s - loss: 0.5058 - accuracy: 0.6932 - val_loss: 0.5485 - val_accuracy: 0.6857
Confusion matrix: 
 [[386 187]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.674 0.326]
 [0.146 0.854]]
Validation f1: 26.62
Validation accuracy: 68.57
Validation recall: 85.37
Validation precision: 15.77
Validation AUC: 0.3678791168802687
Validation class accuracies: [0.6736474694589878, 0.8536585365853658]
The validation tracker metric at 0.329004329004329 hasn't increased by 0 in 1 epochs
Epoch 15/65
154/154 - 120s - loss: 0.5056 - accuracy: 0.6823 - val_loss: 0.5299 - val_accuracy: 0.6954
Confusion matrix: 
 [[391 182]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.682 0.318]
 [0.122 0.878]]
Validation f1: 27.80
Validation accuracy: 69.54
Validation recall: 87.80
Validation precision: 16.51
Validation AUC: 0.30495509462699943
Validation class accuracies: [0.6823734729493892, 0.8780487804878049]
The validation tracker metric at 0.329004329004329 hasn't increased by 0 in 2 epochs
Epoch 16/65
154/154 - 112s - loss: 0.4929 - accuracy: 0.6786 - val_loss: 0.6098 - val_accuracy: 0.6808
Confusion matrix: 
 [[382 191]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.667 0.333]
 [0.122 0.878]]
Validation f1: 26.87
Validation accuracy: 68.08
Validation recall: 87.80
Validation precision: 15.86
Validation AUC: 0.30404839235379166
Validation class accuracies: [0.6666666666666666, 0.8780487804878049]
The validation tracker metric at 0.329004329004329 hasn't increased by 0 in 3 epochs
Epoch 17/65
154/154 - 113s - loss: 0.5250 - accuracy: 0.6029 - val_loss: 0.6371 - val_accuracy: 0.6173
Confusion matrix: 
 [[338 235]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.59 0.41]
 [0.   1.  ]]
Validation f1: 25.87
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 61.73
Validation recall: 100.00
Validation precision: 14.86
Validation AUC: 0.36370593104698223
Validation class accuracies: [0.5898778359511344, 1.0]
The validation tracker metric at 0.329004329004329 hasn't increased by 0 in 4 epochs
Epoch 18/65
154/154 - 113s - loss: 0.5061 - accuracy: 0.6607 - val_loss: 0.3793 - val_accuracy: 0.8632
Confusion matrix: 
 [[508  65]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.463 0.537]]
Validation f1: 34.38
Validation accuracy: 86.32
Validation recall: 53.66
Validation precision: 25.29
Validation AUC: 0.43315274518215247
Validation class accuracies: [0.8865619546247818, 0.5365853658536586]
Saving model...
Epoch 19/65
154/154 - 112s - loss: 0.5588 - accuracy: 0.6957 - val_loss: 0.8103 - val_accuracy: 0.4055
Confusion matrix: 
 [[208 365]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.363 0.637]
 [0.    1.   ]]
Validation f1: 18.34
Validation accuracy: 40.55
Validation recall: 100.00
Validation precision: 10.10
Validation AUC: 0.06749839151954573
Validation class accuracies: [0.36300174520069806, 1.0]
The validation tracker metric at 0.34375 hasn't increased by 0 in 1 epochs
Epoch 20/65
154/154 - 112s - loss: 0.5566 - accuracy: 0.8019 - val_loss: 0.5007 - val_accuracy: 0.7948
Confusion matrix: 
 [[452 121]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.36
Validation accuracy: 79.48
Validation recall: 87.80
Validation precision: 22.93
Validation AUC: 0.4961582511785328
Validation class accuracies: [0.7888307155322862, 0.8780487804878049]
Saving model...
Epoch 21/65
154/154 - 113s - loss: 0.5140 - accuracy: 0.8104 - val_loss: 0.4951 - val_accuracy: 0.8192
Confusion matrix: 
 [[468 105]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.146 0.854]]
Validation f1: 38.67
Validation accuracy: 81.92
Validation recall: 85.37
Validation precision: 25.00
Validation AUC: 0.47540754582209516
Validation class accuracies: [0.8167539267015707, 0.8536585365853658]
Saving model...
Epoch 22/65
154/154 - 113s - loss: 0.5168 - accuracy: 0.8287 - val_loss: 0.5733 - val_accuracy: 0.7622
Confusion matrix: 
 [[432 141]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.754 0.246]
 [0.122 0.878]]
Validation f1: 33.03
Validation accuracy: 76.22
Validation recall: 87.80
Validation precision: 20.34
Validation AUC: 0.5738043923546079
Validation class accuracies: [0.7539267015706806, 0.8780487804878049]
The validation tracker metric at 0.3867403314917127 hasn't increased by 0 in 1 epochs
Epoch 23/65
154/154 - 112s - loss: 0.5024 - accuracy: 0.8454 - val_loss: 0.5096 - val_accuracy: 0.8371
Confusion matrix: 
 [[480  93]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.171 0.829]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.48
Validation accuracy: 83.71
Validation recall: 82.93
Validation precision: 26.77
Validation AUC: 0.5205430774807213
Validation class accuracies: [0.837696335078534, 0.8292682926829268]
Saving model...
Epoch 24/65
154/154 - 113s - loss: 0.4967 - accuracy: 0.8458 - val_loss: 0.5076 - val_accuracy: 0.8404
Confusion matrix: 
 [[481  92]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.146 0.854]]
Validation f1: 41.67
Validation accuracy: 84.04
Validation recall: 85.37
Validation precision: 27.56
Validation AUC: 0.5325349549979164
Validation class accuracies: [0.8394415357766143, 0.8536585365853658]
Saving model...
Epoch 25/65
154/154 - 112s - loss: 0.5366 - accuracy: 0.8320 - val_loss: 0.6208 - val_accuracy: 0.7899
Confusion matrix: 
 [[456 117]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.293 0.707]]
Validation f1: 31.02
Validation accuracy: 78.99
Validation recall: 70.73
Validation precision: 19.86
Validation AUC: 0.42903391779210615
Validation class accuracies: [0.7958115183246073, 0.7073170731707317]
The validation tracker metric at 0.41666666666666663 hasn't increased by 0 in 1 epochs
Epoch 26/65
154/154 - 112s - loss: 0.5395 - accuracy: 0.8299 - val_loss: 0.5515 - val_accuracy: 0.8143
Confusion matrix: 
 [[471 102]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.293 0.707]]
Validation f1: 33.72
Validation accuracy: 81.43
Validation recall: 70.73
Validation precision: 22.14
Validation AUC: 0.4076434517277055
Validation class accuracies: [0.8219895287958116, 0.7073170731707317]
The validation tracker metric at 0.41666666666666663 hasn't increased by 0 in 2 epochs
Epoch 27/65
154/154 - 112s - loss: 0.5208 - accuracy: 0.8198 - val_loss: 0.5591 - val_accuracy: 0.8078
Confusion matrix: 
 [[464 109]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81 0.19]
 [0.22 0.78]]
Validation f1: 35.16
Validation accuracy: 80.78
Validation recall: 78.05
Validation precision: 22.70
Validation AUC: 0.477939932108205
Validation class accuracies: [0.8097731239092496, 0.7804878048780488]
The validation tracker metric at 0.41666666666666663 hasn't increased by 0 in 3 epochs
Epoch 28/65
154/154 - 112s - loss: 0.4885 - accuracy: 0.8316 - val_loss: 0.5648 - val_accuracy: 0.8062
Confusion matrix: 
 [[462 111]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.195 0.805]]
Validation f1: 35.68
Validation accuracy: 80.62
Validation recall: 80.49
Validation precision: 22.92
Validation AUC: 0.47812498332411163
Validation class accuracies: [0.806282722513089, 0.8048780487804879]
The validation tracker metric at 0.41666666666666663 hasn't increased by 0 in 4 epochs
Epoch 29/65
154/154 - 112s - loss: 0.4981 - accuracy: 0.8413 - val_loss: 0.6031 - val_accuracy: 0.7769
Confusion matrix: 
 [[447 126]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.268 0.732]]
Validation f1: 30.46
Validation accuracy: 77.69
Validation recall: 73.17
Validation precision: 19.23
Validation AUC: 0.5030462249817523
Validation class accuracies: [0.7801047120418848, 0.7317073170731707]
The validation tracker metric at 0.41666666666666663 hasn't increased by 0 in 5 epochs
Epoch 30/65
154/154 - 112s - loss: 0.5088 - accuracy: 0.7970 - val_loss: 0.5537 - val_accuracy: 0.8078
Confusion matrix: 
 [[461 112]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.805 0.195]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.23
Validation accuracy: 80.78
Validation recall: 85.37
Validation precision: 23.81
Validation AUC: 0.4989391527851553
Validation class accuracies: [0.8045375218150087, 0.8536585365853658]
The validation tracker metric at 0.41666666666666663 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 31/65
154/154 - 112s - loss: 0.4740 - accuracy: 0.8442 - val_loss: 0.5540 - val_accuracy: 0.8160
Confusion matrix: 
 [[466 107]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.813 0.187]
 [0.146 0.854]]
Validation f1: 38.25
Validation accuracy: 81.60
Validation recall: 85.37
Validation precision: 24.65
Validation AUC: 0.539853431389312
Validation class accuracies: [0.8132635253054101, 0.8536585365853658]
The validation tracker metric at 0.41666666666666663 hasn't increased by 0 in 7 epochs
Epoch 32/65
154/154 - 112s - loss: 0.4653 - accuracy: 0.8434 - val_loss: 0.5191 - val_accuracy: 0.8339
Confusion matrix: 
 [[479  94]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.836 0.164]
 [0.195 0.805]]
Validation f1: 39.29
Validation accuracy: 83.39
Validation recall: 80.49
Validation precision: 25.98
Validation AUC: 0.4775926023879566
Validation class accuracies: [0.8359511343804538, 0.8048780487804879]
The validation tracker metric at 0.41666666666666663 hasn't increased by 0 in 8 epochs
Epoch 33/65
154/154 - 112s - loss: 0.4747 - accuracy: 0.8718 - val_loss: 0.4995 - val_accuracy: 0.8453
Confusion matrix: 
 [[484  89]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.845 0.155]
 [0.146 0.854]]
Validation f1: 42.42
Validation accuracy: 84.53
Validation recall: 85.37
Validation precision: 28.23
Validation AUC: 0.5013944093925494
Validation class accuracies: [0.8446771378708552, 0.8536585365853658]
Saving model...
Epoch 34/65
154/154 - 113s - loss: 0.4848 - accuracy: 0.8861 - val_loss: 0.5170 - val_accuracy: 0.8453
Confusion matrix: 
 [[485  88]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.171 0.829]]
Validation f1: 41.72
Validation accuracy: 84.53
Validation recall: 82.93
Validation precision: 27.87
Validation AUC: 0.4934650506062276
Validation class accuracies: [0.8464223385689355, 0.8292682926829268]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 1 epochs
Epoch 35/65
154/154 - 112s - loss: 0.4719 - accuracy: 0.8544 - val_loss: 0.5693 - val_accuracy: 0.8062
Confusion matrix: 
 [[460 113]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.803 0.197]
 [0.146 0.854]]
Validation f1: 37.04
Validation accuracy: 80.62
Validation recall: 85.37
Validation precision: 23.65
Validation AUC: 0.5423434944111067
Validation class accuracies: [0.8027923211169284, 0.8536585365853658]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 2 epochs
Epoch 36/65
154/154 - 112s - loss: 0.4795 - accuracy: 0.8324 - val_loss: 0.5809 - val_accuracy: 0.7932
Confusion matrix: 
 [[450 123]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.098 0.902]]
Validation f1: 36.82
Validation accuracy: 79.32
Validation recall: 90.24
Validation precision: 23.12
Validation AUC: 0.5458691583917303
Validation class accuracies: [0.7853403141361257, 0.9024390243902439]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 3 epochs
Epoch 37/65
154/154 - 112s - loss: 0.4649 - accuracy: 0.8515 - val_loss: 0.5535 - val_accuracy: 0.8078
Confusion matrix: 
 [[461 112]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.805 0.195]
 [0.146 0.854]]
Validation f1: 37.23
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 80.78
Validation recall: 85.37
Validation precision: 23.81
Validation AUC: 0.5377819320990443
Validation class accuracies: [0.8045375218150087, 0.8536585365853658]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 4 epochs
Epoch 38/65
154/154 - 112s - loss: 0.4676 - accuracy: 0.8645 - val_loss: 0.5232 - val_accuracy: 0.8290
Confusion matrix: 
 [[475  98]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.171 0.829]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.31
Validation accuracy: 82.90
Validation recall: 82.93
Validation precision: 25.76
Validation AUC: 0.497094662635894
Validation class accuracies: [0.8289703315881326, 0.8292682926829268]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 5 epochs
Epoch 39/65
154/154 - 112s - loss: 0.4611 - accuracy: 0.8710 - val_loss: 0.5141 - val_accuracy: 0.8388
Confusion matrix: 
 [[481  92]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.171 0.829]]
Validation f1: 40.72
Validation accuracy: 83.88
Validation recall: 82.93
Validation precision: 26.98
Validation AUC: 0.5128154560313972
Validation class accuracies: [0.8394415357766143, 0.8292682926829268]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 40/65
154/154 - 112s - loss: 0.4539 - accuracy: 0.8723 - val_loss: 0.5512 - val_accuracy: 0.8143
Confusion matrix: 
 [[464 109]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.122 0.878]]
Validation f1: 38.71
Validation accuracy: 81.43
Validation recall: 87.80
Validation precision: 24.83
Validation AUC: 0.5319989990879124
Validation class accuracies: [0.8097731239092496, 0.8780487804878049]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 7 epochs
Epoch 41/65
154/154 - 112s - loss: 0.4635 - accuracy: 0.8592 - val_loss: 0.5452 - val_accuracy: 0.8143
Confusion matrix: 
 [[466 107]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.813 0.187]
 [0.171 0.829]]
Validation f1: 37.36
Validation accuracy: 81.43
Validation recall: 82.93
Validation precision: 24.11
Validation AUC: 0.5027916378767548
Validation class accuracies: [0.8132635253054101, 0.8292682926829268]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 8 epochs
Epoch 42/65
154/154 - 112s - loss: 0.4643 - accuracy: 0.8596 - val_loss: 0.5496 - val_accuracy: 0.8143
Confusion matrix: 
 [[466 107]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.813 0.187]
 [0.171 0.829]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.36
Validation accuracy: 81.43
Validation recall: 82.93
Validation precision: 24.11
Validation AUC: 0.5039474916975359
Validation class accuracies: [0.8132635253054101, 0.8292682926829268]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 9 epochs
Epoch 43/65
154/154 - 113s - loss: 0.4530 - accuracy: 0.8641 - val_loss: 0.5324 - val_accuracy: 0.8257
Confusion matrix: 
 [[471 102]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.122 0.878]]
Validation f1: 40.22
Validation accuracy: 82.57
Validation recall: 87.80
Validation precision: 26.09
Validation AUC: 0.5039819222380859
Validation class accuracies: [0.8219895287958116, 0.8780487804878049]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 10 epochs
Epoch 44/65
154/154 - 112s - loss: 0.4581 - accuracy: 0.8723 - val_loss: 0.5312 - val_accuracy: 0.8225
Confusion matrix: 
 [[470 103]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82  0.18 ]
 [0.146 0.854]]
Validation f1: 39.11
Validation accuracy: 82.25
Validation recall: 85.37
Validation precision: 25.36
Validation AUC: 0.5056986411821776
Validation class accuracies: [0.8202443280977313, 0.8536585365853658]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 11 epochs
Epoch 45/65
154/154 - 112s - loss: 0.4510 - accuracy: 0.8686 - val_loss: 0.5221 - val_accuracy: 0.8355
Confusion matrix: 
 [[479  94]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.836 0.164]
 [0.171 0.829]]
Validation f1: 40.24
Validation accuracy: 83.55
Validation recall: 82.93
Validation precision: 26.56
Validation AUC: 0.5261775420995006
Validation class accuracies: [0.8359511343804538, 0.8292682926829268]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 46/65
154/154 - 112s - loss: 0.4617 - accuracy: 0.8792 - val_loss: 0.5240 - val_accuracy: 0.8388
Confusion matrix: 
 [[479  94]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.836 0.164]
 [0.122 0.878]]
Validation f1: 42.11
Validation accuracy: 83.88
Validation recall: 87.80
Validation precision: 27.69
Validation AUC: 0.5062018630792525
Validation class accuracies: [0.8359511343804538, 0.8780487804878049]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 13 epochs
Epoch 47/65
154/154 - 112s - loss: 0.4609 - accuracy: 0.8727 - val_loss: 0.5186 - val_accuracy: 0.8420
Confusion matrix: 
 [[482  91]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.146 0.854]]
Validation f1: 41.92
Validation accuracy: 84.20
Validation recall: 85.37
Validation precision: 27.78
Validation AUC: 0.525936413192839
Validation class accuracies: [0.8411867364746946, 0.8536585365853658]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 14 epochs
Epoch 48/65
154/154 - 112s - loss: 0.4479 - accuracy: 0.8828 - val_loss: 0.5148 - val_accuracy: 0.8420
Confusion matrix: 
 [[482  91]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.92
Validation accuracy: 84.20
Validation recall: 85.37
Validation precision: 27.78
Validation AUC: 0.5076509856122113
Validation class accuracies: [0.8411867364746946, 0.8536585365853658]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 15 epochs
Epoch 49/65
154/154 - 112s - loss: 0.4557 - accuracy: 0.8775 - val_loss: 0.5222 - val_accuracy: 0.8388
Confusion matrix: 
 [[480  93]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.146 0.854]]
Validation f1: 41.42
Validation accuracy: 83.88
Validation recall: 85.37
Validation precision: 27.34
Validation AUC: 0.5075785385963302
Validation class accuracies: [0.837696335078534, 0.8536585365853658]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 16 epochs
Epoch 50/65
154/154 - 112s - loss: 0.4617 - accuracy: 0.8747 - val_loss: 0.5218 - val_accuracy: 0.8339
Confusion matrix: 
 [[478  95]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.834 0.166]
 [0.171 0.829]]
Validation f1: 40.00
Validation accuracy: 83.39
Validation recall: 82.93
Validation precision: 26.36
Validation AUC: 0.5148663217852043
Validation class accuracies: [0.8342059336823735, 0.8292682926829268]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 17 epochs
Epoch 51/65
154/154 - 113s - loss: 0.4555 - accuracy: 0.8739 - val_loss: 0.5354 - val_accuracy: 0.8257
Confusion matrix: 
 [[471 102]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.22
Validation accuracy: 82.57
Validation recall: 87.80
Validation precision: 26.09
Validation AUC: 0.5128194647712393
Validation class accuracies: [0.8219895287958116, 0.8780487804878049]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 52/65
154/154 - 113s - loss: 0.4430 - accuracy: 0.8666 - val_loss: 0.5331 - val_accuracy: 0.8257
Confusion matrix: 
 [[472 101]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.824 0.176]
 [0.146 0.854]]
Validation f1: 39.55
Validation accuracy: 82.57
Validation recall: 85.37
Validation precision: 25.74
Validation AUC: 0.5102758764698236
Validation class accuracies: [0.8237347294938918, 0.8536585365853658]
The validation tracker metric at 0.42424242424242425 hasn't increased by 0 in 19 epochs
Epoch 53/65
154/154 - 113s - loss: 0.4522 - accuracy: 0.8710 - val_loss: 0.5304 - val_accuracy: 0.8274
Confusion matrix: 
 [[473 100]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.77
Validation accuracy: 82.74
Validation recall: 85.37
Validation precision: 25.93
Validation AUC: 0.4974073937703279
Validation class accuracies: [0.8254799301919721, 0.8536585365853658]

The metrics for job 5 with the best target metric are: 
Best cm: [[484  89]
 [  6  35]]
Best normalized cm: [[0.845 0.155]
 [0.146 0.854]]
Best f1: 0.42
Best accuracy: 0.85
Best recall: 0.85
Best precision: 0.28
Best AUC: 0.50
Best class accuracies: [0.8446771378708552, 0.8536585365853658]
Best epoch: 33
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 30481
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_221443-1rzdyl3l/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_221443-1rzdyl3l/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.87103
wandb:         val_accuracy 0.82736
wandb:             _runtime 6684
wandb:           _timestamp 1624838768
wandb:                _step 412
wandb:           train_loss 0.45218
wandb:             val_loss 0.53039
wandb:           val_recall 0.85366
wandb:        val_precision 0.25926
wandb:               val_f1 0.39773
wandb:              val_auc 0.49741
wandb:                   lr 6e-05
wandb:          best_val_f1 0.42424
wandb:    best_val_accuracy 0.84528
wandb:   best_val_precision 0.28226
wandb:      best_val_recall 0.85366
wandb:             best_auc 0.50139
wandb:           best_epoch 33
wandb: Run history:
wandb:   train_accuracy ▅▄▄▂▁▁▂▄▄▄▄▄▂▃▄▆▇▇▇▇▇▇▆▇██▇▇██▇▇████████
wandb:     val_accuracy ▁▁▁▅▅▅▇▇▇▇▆▇▆█▄█▇█▇██▇████▇█████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ▅▄█▅▆▄▂▂▂▂▂▂▃▂▄▃▃▂▃▃▃▂▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ██▅▃▂▃▂▂▂▂▂▂▃▁▅▂▃▂▃▃▃▃▃▃▂▂▃▃▂▂▂▃▂▂▂▂▂▂▂▂
wandb:       val_recall ███▆▂██▅▆▇▆▆█▁█▆▆▅▄▄▅▄▆▆▆▅▆▆▅▅▅▅▆▅▆▆▆▅▆▆
wandb:    val_precision ▁▁▁▃▂▃▅▅▅▅▄▄▄▇▂▇▅█▅▆▆▅▇▇██▇▇▇█▇▇▇▇███▇▇▇
wandb:           val_f1 ▁▁▁▃▂▃▅▅▅▆▄▅▄▆▂▇▆█▅▆▆▅▇▇██▇▇▇█▇▇▇▇███▇▇▇
wandb:          val_auc ▁▃▂▄▄▄▅▅▅▅▅▄▅▆▁▇█▇▆▆▇▇▇█▇▇██▇▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr ███████████████████████▄▄▄▄▄▄▄▂▂▂▂▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_221443-1rzdyl3l

-----------------------

 See logs at ../../new_cache/conv__2260__06_1838__v39__lstm/logs/