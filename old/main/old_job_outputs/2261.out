Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2261
Description:  lstm
2021-06-27 18:51:12.888456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-27 18:51:15.750274: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 18:51:15.751300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-27 18:51:15.801186: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:15.802209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 18:51:15.802248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 18:51:15.806856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 18:51:15.806983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 18:51:15.808463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 18:51:15.808840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 18:51:15.810204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 18:51:15.811475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 18:51:15.811786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 18:51:15.811993: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:15.812788: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:15.813452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2261.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2261__06_1850__v39__lstm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-27 18:51:21.105159: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 18:51:21.105520: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:21.106621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 18:51:21.106698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 18:51:21.106791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 18:51:21.106830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 18:51:21.106860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 18:51:21.106894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 18:51:21.106921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 18:51:21.106960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 18:51:21.107004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 18:51:21.107155: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:21.108374: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:21.109189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-27 18:51:21.109266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 18:51:21.957819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-27 18:51:21.957866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-27 18:51:21.957874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-27 18:51:21.958158: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:21.958984: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:21.959736: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 18:51:21.960422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-27 18:51:23.952533: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-27 18:51:23.954641: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-27 18:51:24.344510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 18:51:26.362469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 18:51:26.902421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 10, 125, 128, 1) 4            input_1[0][0]                        
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 10, 125, 128, 16 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed (None, 10, 125, 128, 16 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed (None, 10, 125, 128, 1) 0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed (None, 10, 125, 128, 16 2320         time_distributed[0][0]               
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed (None, 10, 125, 128, 16 6416         time_distributed_2[0][0]             
______________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed (None, 10, 125, 128, 16 32           time_distributed_4[0][0]             
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 10, 125, 128, 48 0            time_distributed_1[0][0]             
                                                                         time_distributed_3[0][0]             
                                                                         time_distributed_5[0][0]             
______________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed (None, 10, 63, 64, 48)  0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 10, 63, 64, 48)  192          time_distributed_6[0][0]             
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 10, 63, 64, 48)  0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed (None, 10, 48)          0            dropout[0][0]                        
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 10, 128)         57856        time_distributed_7[0][0]             
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 10, 128)         98816        bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 10, 64)          8256         bidirectional_1[0][0]                
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 10, 1)           65           dense[0][0]                          
______________________________________________________________________________________________________________
flatten (Flatten)                   (None, 10)              0            dense_1[0][0]                        
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               11           flatten[0][0]                        
==============================================================================================================
Total params: 174,032
Trainable params: 173,934
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 68s - loss: 0.7424 - accuracy: 0.0928 - val_loss: 1.2323 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.21999789290946192
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 61s - loss: 0.6496 - accuracy: 0.6306 - val_loss: 1.4777 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.04353958616177368
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 61s - loss: 0.6557 - accuracy: 0.7445 - val_loss: 0.9489 - val_accuracy: 0.5912
Confusion matrix: 
 [[329 244]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.574 0.426]
 [0.171 0.829]]
Validation f1: 21.32
Validation accuracy: 59.12
Validation recall: 82.93
Validation precision: 12.23
Validation AUC: 0.21167614506815235
Validation class accuracies: [0.5741710296684118, 0.8292682926829268]
Saving model...
Epoch 4/65
154/154 - 61s - loss: 0.7103 - accuracy: 0.8779 - val_loss: 0.6993 - val_accuracy: 0.8925
Confusion matrix: 
 [[542  31]
 [ 35   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.854 0.146]]
Validation f1: 15.38
Validation accuracy: 89.25
Validation recall: 14.63
Validation precision: 16.22
Validation AUC: 0.1229864364153617
Validation class accuracies: [0.9458987783595113, 0.14634146341463414]
The validation tracker metric at 0.21316614420062696 hasn't increased by 0 in 1 epochs
Epoch 5/65
154/154 - 61s - loss: 0.7381 - accuracy: 0.8934 - val_loss: 0.8979 - val_accuracy: 0.7020
Confusion matrix: 
 [[396 177]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.691 0.309]
 [0.146 0.854]]
Validation f1: 27.67
Validation accuracy: 70.20
Validation recall: 85.37
Validation precision: 16.51
Validation AUC: 0.17201015145808307
Validation class accuracies: [0.6910994764397905, 0.8536585365853658]
Saving model...
Epoch 6/65
154/154 - 62s - loss: 0.5875 - accuracy: 0.8316 - val_loss: 0.9562 - val_accuracy: 0.6808
Confusion matrix: 
 [[379 194]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.661 0.339]
 [0.049 0.951]]
Validation f1: 28.47
Validation accuracy: 68.08
Validation recall: 95.12
Validation precision: 16.74
Validation AUC: 0.1953700671730717
Validation class accuracies: [0.6614310645724258, 0.9512195121951219]
Saving model...
Epoch 7/65
154/154 - 62s - loss: 0.5512 - accuracy: 0.8474 - val_loss: 0.6700 - val_accuracy: 0.9397
Confusion matrix: 
 [[551  22]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.366 0.634]]
Validation f1: 58.43
Validation accuracy: 93.97
Validation recall: 63.41
Validation precision: 54.17
Validation AUC: 0.400088557279367
Validation class accuracies: [0.9616055846422339, 0.6341463414634146]
Saving model...
Epoch 8/65
154/154 - 61s - loss: 0.5741 - accuracy: 0.8548 - val_loss: 0.8712 - val_accuracy: 0.7883
Confusion matrix: 
 [[451 122]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.195 0.805]]
Validation f1: 33.67
Validation accuracy: 78.83
Validation recall: 80.49
Validation precision: 21.29
Validation AUC: 0.17950036408879994
Validation class accuracies: [0.787085514834206, 0.8048780487804879]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 1 epochs
Epoch 9/65
154/154 - 60s - loss: 0.5323 - accuracy: 0.8657 - val_loss: 0.8063 - val_accuracy: 0.8094
Confusion matrix: 
 [[460 113]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.803 0.197]
 [0.098 0.902]]
Validation f1: 38.74
Validation accuracy: 80.94
Validation recall: 90.24
Validation precision: 24.67
Validation AUC: 0.2918771243850441
Validation class accuracies: [0.8027923211169284, 0.9024390243902439]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 2 epochs
Epoch 10/65
154/154 - 61s - loss: 0.5185 - accuracy: 0.8666 - val_loss: 0.7483 - val_accuracy: 0.8599
Confusion matrix: 
 [[494  79]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.171 0.829]]
Validation f1: 44.16
Validation accuracy: 85.99
Validation recall: 82.93
Validation precision: 30.09
Validation AUC: 0.3064287364186703
Validation class accuracies: [0.8621291448516579, 0.8292682926829268]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 3 epochs
Epoch 11/65
154/154 - 61s - loss: 0.4998 - accuracy: 0.8975 - val_loss: 0.7379 - val_accuracy: 0.8599
Confusion matrix: 
 [[495  78]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.195 0.805]]
Validation f1: 43.42
Validation accuracy: 85.99
Validation recall: 80.49
Validation precision: 29.73
Validation AUC: 0.2908067152889142
Validation class accuracies: [0.8638743455497382, 0.8048780487804879]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 4 epochs
Epoch 12/65
154/154 - 61s - loss: 0.5079 - accuracy: 0.8755 - val_loss: 0.6813 - val_accuracy: 0.8990
Confusion matrix: 
 [[518  55]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.171 0.829]]
Validation f1: 52.31
Validation accuracy: 89.90
Validation recall: 82.93
Validation precision: 38.20
Validation AUC: 0.5430925977739631
Validation class accuracies: [0.9040139616055847, 0.8292682926829268]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 5 epochs
Epoch 13/65
154/154 - 61s - loss: 0.5006 - accuracy: 0.8885 - val_loss: 0.8924 - val_accuracy: 0.7557
Confusion matrix: 
 [[426 147]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.743 0.257]
 [0.073 0.927]]
Validation f1: 33.63
Validation accuracy: 75.57
Validation recall: 92.68
Validation precision: 20.54
Validation AUC: 0.23665752245639426
Validation class accuracies: [0.743455497382199, 0.926829268292683]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 14/65
154/154 - 61s - loss: 0.4887 - accuracy: 0.8678 - val_loss: 0.7443 - val_accuracy: 0.8355
Confusion matrix: 
 [[478  95]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.834 0.166]
 [0.146 0.854]]
Validation f1: 40.94
Validation accuracy: 83.55
Validation recall: 85.37
Validation precision: 26.92
Validation AUC: 0.31778693438141414
Validation class accuracies: [0.8342059336823735, 0.8536585365853658]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 7 epochs
Epoch 15/65
154/154 - 62s - loss: 0.4671 - accuracy: 0.8885 - val_loss: 0.7747 - val_accuracy: 0.8160
Confusion matrix: 
 [[465 108]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.812 0.188]
 [0.122 0.878]]
Validation f1: 38.92
Validation accuracy: 81.60
Validation recall: 87.80
Validation precision: 25.00
Validation AUC: 0.2967660158760873
Validation class accuracies: [0.8115183246073299, 0.8780487804878049]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 8 epochs
Epoch 16/65
154/154 - 62s - loss: 0.4642 - accuracy: 0.8873 - val_loss: 0.7611 - val_accuracy: 0.8274
Confusion matrix: 
 [[472 101]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.824 0.176]
 [0.122 0.878]]
Validation f1: 40.45
Validation accuracy: 82.74
Validation recall: 87.80
Validation precision: 26.28
Validation AUC: 0.29157040371431114
Validation class accuracies: [0.8237347294938918, 0.8780487804878049]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 9 epochs
Epoch 17/65
154/154 - 62s - loss: 0.4574 - accuracy: 0.9007 - val_loss: 0.9120 - val_accuracy: 0.7394
Confusion matrix: 
 [[416 157]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.073 0.927]]
Validation f1: 32.20
Validation accuracy: 73.94
Validation recall: 92.68
Validation precision: 19.49
Validation AUC: 0.22130459840623593
Validation class accuracies: [0.7260034904013961, 0.926829268292683]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 10 epochs
Epoch 18/65
154/154 - 62s - loss: 0.4624 - accuracy: 0.8808 - val_loss: 0.7899 - val_accuracy: 0.8062
Confusion matrix: 
 [[457 116]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.798 0.202]
 [0.073 0.927]]
Validation f1: 38.97
Validation accuracy: 80.62
Validation recall: 92.68
Validation precision: 24.68
Validation AUC: 0.34140542273172053
Validation class accuracies: [0.7975567190226877, 0.926829268292683]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 11 epochs
Epoch 19/65
154/154 - 62s - loss: 0.4710 - accuracy: 0.8934 - val_loss: 0.7930 - val_accuracy: 0.8029
Confusion matrix: 
 [[455 118]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.794 0.206]
 [0.073 0.927]]
Validation f1: 38.58
Validation accuracy: 80.29
Validation recall: 92.68
Validation precision: 24.36
Validation AUC: 0.29149396333786476
Validation class accuracies: [0.794066317626527, 0.926829268292683]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 20/65
154/154 - 62s - loss: 0.4638 - accuracy: 0.8784 - val_loss: 0.7445 - val_accuracy: 0.8339
Confusion matrix: 
 [[476  97]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.831 0.169]
 [0.122 0.878]]
Validation f1: 41.38
Validation accuracy: 83.39
Validation recall: 87.80
Validation precision: 27.07
Validation AUC: 0.3226649280415704
Validation class accuracies: [0.8307155322862129, 0.8780487804878049]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 13 epochs
Epoch 21/65
154/154 - 62s - loss: 0.4617 - accuracy: 0.8812 - val_loss: 0.7762 - val_accuracy: 0.8143
Confusion matrix: 
 [[465 108]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.812 0.188]
 [0.146 0.854]]
Validation f1: 38.04
Validation accuracy: 81.43
Validation recall: 85.37
Validation precision: 24.48
Validation AUC: 0.25590164006491534
Validation class accuracies: [0.8115183246073299, 0.8536585365853658]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 14 epochs
Epoch 22/65
154/154 - 61s - loss: 0.4433 - accuracy: 0.9024 - val_loss: 0.7619 - val_accuracy: 0.8274
Confusion matrix: 
 [[472 101]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.824 0.176]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.45
Validation accuracy: 82.74
Validation recall: 87.80
Validation precision: 26.28
Validation AUC: 0.28807395798155766
Validation class accuracies: [0.8237347294938918, 0.8780487804878049]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 15 epochs
Epoch 23/65
154/154 - 62s - loss: 0.4496 - accuracy: 0.8889 - val_loss: 0.7412 - val_accuracy: 0.8420
Confusion matrix: 
 [[482  91]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.146 0.854]]
Validation f1: 41.92
Validation accuracy: 84.20
Validation recall: 85.37
Validation precision: 27.78
Validation AUC: 0.2987091917864562
Validation class accuracies: [0.8411867364746946, 0.8536585365853658]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 16 epochs
Epoch 24/65
154/154 - 59s - loss: 0.4601 - accuracy: 0.8861 - val_loss: 0.7616 - val_accuracy: 0.8306
Confusion matrix: 
 [[474  99]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.827 0.173]
 [0.122 0.878]]
Validation f1: 40.91
Validation accuracy: 83.06
Validation recall: 87.80
Validation precision: 26.67
Validation AUC: 0.28083015705449293
Validation class accuracies: [0.8272251308900523, 0.8780487804878049]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 17 epochs
Epoch 25/65
154/154 - 60s - loss: 0.4547 - accuracy: 0.8792 - val_loss: 0.7699 - val_accuracy: 0.8225
Confusion matrix: 
 [[470 103]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82  0.18 ]
 [0.146 0.854]]
Validation f1: 39.11
Validation accuracy: 82.25
Validation recall: 85.37
Validation precision: 25.36
Validation AUC: 0.277406595933154
Validation class accuracies: [0.8202443280977313, 0.8536585365853658]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 26/65
154/154 - 60s - loss: 0.4503 - accuracy: 0.8930 - val_loss: 0.7468 - val_accuracy: 0.8339
Confusion matrix: 
 [[477  96]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.146 0.854]]
Validation f1: 40.70
Validation accuracy: 83.39
Validation recall: 85.37
Validation precision: 26.72
Validation AUC: 0.2847238028326962
Validation class accuracies: [0.8324607329842932, 0.8536585365853658]
The validation tracker metric at 0.5842696629213483 hasn't increased by 0 in 19 epochs
Epoch 27/65
154/154 - 62s - loss: 0.4508 - accuracy: 0.8902 - val_loss: 0.7352 - val_accuracy: 0.8436
Confusion matrix: 
 [[483  90]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.146 0.854]]
Validation f1: 42.17
Validation accuracy: 84.36
Validation recall: 85.37
Validation precision: 28.00
Validation AUC: 0.29854783648471767
Validation class accuracies: [0.8429319371727748, 0.8536585365853658]

The metrics for job 0 with the best target metric are: 
Best cm: [[551  22]
 [ 15  26]]
Best normalized cm: [[0.962 0.038]
 [0.366 0.634]]
Best f1: 0.58
Best accuracy: 0.94
Best recall: 0.63
Best precision: 0.54
Best AUC: 0.40
Best class accuracies: [0.9616055846422339, 0.6341463414634146]
Best epoch: 7
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 22887
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_185116-37l7zqsp/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_185116-37l7zqsp/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.89015
wandb:         val_accuracy 0.84365
wandb:             _runtime 2003
wandb:           _timestamp 1624821879
wandb:                _step 203
wandb:           train_loss 0.45081
wandb:             val_loss 0.73516
wandb:           val_recall 0.85366
wandb:        val_precision 0.28
wandb:               val_f1 0.42169
wandb:              val_auc 0.29855
wandb:                   lr 0.00013
wandb:          best_val_f1 0.58427
wandb:    best_val_accuracy 0.93974
wandb:   best_val_precision 0.54167
wandb:      best_val_recall 0.63415
wandb:             best_auc 0.40009
wandb:           best_epoch 7
wandb: Run history:
wandb:   train_accuracy ▁▆▇██▇█████████████████████
wandb:     val_accuracy ▁▁▅█▆▆█▇▇▇▇█▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▆▇█▄▄▄▃▃▂▃▂▂▂▁▁▁▂▁▁▁▁▁▁▁▁
wandb:         val_loss ▆█▃▁▃▃▁▃▂▂▂▁▃▂▂▂▃▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ██▇▁▇█▅▆▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:    val_precision ▁▁▂▂▂▂█▃▄▄▄▆▃▄▄▄▃▄▄▄▄▄▄▄▄▄▄
wandb:           val_f1 ▁▁▂▁▃▃█▄▅▆▆▇▄▅▅▅▄▅▅▅▅▅▅▅▅▅▆
wandb:          val_auc ▃▁▃▂▃▃▆▃▄▅▄█▄▅▅▄▃▅▄▅▄▄▅▄▄▄▅
wandb:               lr █████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_185116-37l7zqsp

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 10, 125, 128, 1) 4            input_2[0][0]                        
______________________________________________________________________________________________________________
time_distributed_8 (TimeDistributed (None, 10, 125, 128, 16 32           batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
time_distributed_10 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
time_distributed_12 (TimeDistribute (None, 10, 125, 128, 1) 0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
time_distributed_9 (TimeDistributed (None, 10, 125, 128, 16 2320         time_distributed_8[0][0]             
______________________________________________________________________________________________________________
time_distributed_11 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_10[0][0]            
______________________________________________________________________________________________________________
time_distributed_13 (TimeDistribute (None, 10, 125, 128, 16 32           time_distributed_12[0][0]            
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 10, 125, 128, 48 0            time_distributed_9[0][0]             
                                                                         time_distributed_11[0][0]            
                                                                         time_distributed_13[0][0]            
______________________________________________________________________________________________________________
time_distributed_14 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 10, 63, 64, 48)  192          time_distributed_14[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 10, 63, 64, 48)  0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
time_distributed_15 (TimeDistribute (None, 10, 48)          0            dropout_1[0][0]                      
______________________________________________________________________________________________________________
bidirectional_2 (Bidirectional)     (None, 10, 256)         181248       time_distributed_15[0][0]            
______________________________________________________________________________________________________________
bidirectional_3 (Bidirectional)     (None, 10, 256)         394240       bidirectional_2[0][0]                
______________________________________________________________________________________________________________
bidirectional_4 (Bidirectional)     (None, 10, 256)         394240       bidirectional_3[0][0]                
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 10, 64)          16448        bidirectional_4[0][0]                
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 10, 128)         8320         dense_3[0][0]                        
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 10, 128)         0            dense_4[0][0]                        
______________________________________________________________________________________________________________
dense_5 (Dense)                     (None, 10, 1)           129          dropout_2[0][0]                      
______________________________________________________________________________________________________________
flatten_1 (Flatten)                 (None, 10)              0            dense_5[0][0]                        
______________________________________________________________________________________________________________
dense_6 (Dense)                     (None, 1)               11           flatten_1[0][0]                      
==============================================================================================================
Total params: 1,003,664
Trainable params: 1,003,566
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 61s - loss: 0.8127 - accuracy: 0.5944 - val_loss: 0.7864 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.07477049545416956
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 61s - loss: 0.7942 - accuracy: 0.2258 - val_loss: 0.7262 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.07133726070168546
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 60s - loss: 0.7927 - accuracy: 0.0643 - val_loss: 0.7334 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.07046315908580114
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 4/65
154/154 - 60s - loss: 0.7895 - accuracy: 0.0651 - val_loss: 0.7519 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.07561779626667003
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 3 epochs
Epoch 5/65
154/154 - 59s - loss: 0.7824 - accuracy: 0.0769 - val_loss: 0.7615 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.08886614576110356
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 4 epochs
Epoch 6/65
154/154 - 60s - loss: 0.7693 - accuracy: 0.1103 - val_loss: 0.8668 - val_accuracy: 0.1417
Confusion matrix: 
 [[ 54 519]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.094 0.906]
 [0.195 0.805]]
Validation f1: 11.13
Validation accuracy: 14.17
Validation recall: 80.49
Validation precision: 5.98
Validation AUC: 0.21362136211384955
Validation class accuracies: [0.09424083769633508, 0.8048780487804879]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 5 epochs
Epoch 7/65
154/154 - 60s - loss: 0.7987 - accuracy: 0.2933 - val_loss: 0.7221 - val_accuracy: 0.2264
Confusion matrix: 
 [[108 465]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.188 0.812]
 [0.244 0.756]]
Validation f1: 11.55
Validation accuracy: 22.64
Validation recall: 75.61
Validation precision: 6.25
Validation AUC: 0.05653554479037973
Validation class accuracies: [0.18848167539267016, 0.7560975609756098]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 8/65
154/154 - 60s - loss: 0.7890 - accuracy: 0.2815 - val_loss: 0.7343 - val_accuracy: 0.2427
Confusion matrix: 
 [[118 455]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.206 0.794]
 [0.244 0.756]]
Validation f1: 11.76
Validation accuracy: 24.27
Validation recall: 75.61
Validation precision: 6.38
Validation AUC: 0.06381661213483729
Validation class accuracies: [0.20593368237347295, 0.7560975609756098]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 7 epochs
Epoch 9/65
154/154 - 60s - loss: 0.7872 - accuracy: 0.2880 - val_loss: 0.7370 - val_accuracy: 0.2410
Confusion matrix: 
 [[117 456]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.204 0.796]
 [0.244 0.756]]
Validation f1: 11.74
Validation accuracy: 24.10
Validation recall: 75.61
Validation precision: 6.37
Validation AUC: 0.10185196934002395
Validation class accuracies: [0.20418848167539266, 0.7560975609756098]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 8 epochs
Epoch 10/65
154/154 - 59s - loss: 0.7845 - accuracy: 0.2819 - val_loss: 0.7500 - val_accuracy: 0.2296
Confusion matrix: 
 [[110 463]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.192 0.808]
 [0.244 0.756]]
Validation f1: 11.59
Validation accuracy: 22.96
Validation recall: 75.61
Validation precision: 6.28
Validation AUC: 0.06130090069244823
Validation class accuracies: [0.19197207678883071, 0.7560975609756098]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 9 epochs
Epoch 11/65
154/154 - 58s - loss: 0.7795 - accuracy: 0.1871 - val_loss: 0.7576 - val_accuracy: 0.2280
Confusion matrix: 
 [[109 464]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.19  0.81 ]
 [0.244 0.756]]
Validation f1: 11.57
Validation accuracy: 22.80
Validation recall: 75.61
Validation precision: 6.26
Validation AUC: 0.09956797066301917
Validation class accuracies: [0.19022687609075042, 0.7560975609756098]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 10 epochs
Epoch 12/65
154/154 - 60s - loss: 0.7796 - accuracy: 0.1863 - val_loss: 0.7555 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.0822496640774002
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 11 epochs
Epoch 13/65
154/154 - 60s - loss: 0.7760 - accuracy: 0.0671 - val_loss: 0.7604 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.10087731158565662
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 14/65
154/154 - 60s - loss: 0.7789 - accuracy: 0.0651 - val_loss: 0.8136 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.07236859344527584
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 13 epochs
Epoch 15/65
154/154 - 60s - loss: 0.7767 - accuracy: 0.0655 - val_loss: 0.7823 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.14277217414491974
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 14 epochs
Epoch 16/65
154/154 - 59s - loss: 0.7730 - accuracy: 0.0679 - val_loss: 0.7861 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.0706493253423396
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 15 epochs
Epoch 17/65
154/154 - 60s - loss: 0.7692 - accuracy: 0.0667 - val_loss: 0.7786 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.14153175286452266
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 16 epochs
Epoch 18/65
154/154 - 60s - loss: 0.7620 - accuracy: 0.0679 - val_loss: 0.7905 - val_accuracy: 0.0765
Confusion matrix: 
 [[  6 567]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.01 0.99]
 [0.   1.  ]]
Validation f1: 12.63
Validation accuracy: 7.65
Validation recall: 100.00
Validation precision: 6.74
Validation AUC: 0.1435611680423887
Validation class accuracies: [0.010471204188481676, 1.0]
Saving model...
Epoch 19/65
154/154 - 61s - loss: 0.7661 - accuracy: 0.0732 - val_loss: 0.7872 - val_accuracy: 0.0879
Confusion matrix: 
 [[ 13 560]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.023 0.977]
 [0.    1.   ]]
Validation f1: 12.77
Validation accuracy: 8.79
Validation recall: 100.00
Validation precision: 6.82
Validation AUC: 0.14648735676814184
Validation class accuracies: [0.02268760907504363, 1.0]
Saving model...
Epoch 20/65
154/154 - 60s - loss: 0.7580 - accuracy: 0.0903 - val_loss: 0.7938 - val_accuracy: 0.1270
Confusion matrix: 
 [[ 37 536]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.065 0.935]
 [0.    1.   ]]
Validation f1: 13.27
Validation accuracy: 12.70
Validation recall: 100.00
Validation precision: 7.11
Validation AUC: 0.14984585147202878
Validation class accuracies: [0.06457242582897033, 1.0]
Saving model...
Epoch 21/65
154/154 - 59s - loss: 0.7431 - accuracy: 0.1123 - val_loss: 0.8621 - val_accuracy: 0.0847
Confusion matrix: 
 [[ 11 562]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.019 0.981]
 [0.    1.   ]]
Validation f1: 12.73
Validation accuracy: 8.47
Validation recall: 100.00
Validation precision: 6.80
Validation AUC: 0.11490606937147532
Validation class accuracies: [0.019197207678883072, 1.0]
The validation tracker metric at 0.1326860841423948 hasn't increased by 0 in 1 epochs
Epoch 22/65
154/154 - 59s - loss: 0.7304 - accuracy: 0.0936 - val_loss: 0.7959 - val_accuracy: 0.1026
Confusion matrix: 
 [[ 22 551]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.038 0.962]
 [0.    1.   ]]
Validation f1: 12.95
Validation accuracy: 10.26
Validation recall: 100.00
Validation precision: 6.93
Validation AUC: 0.19188704160119924
Validation class accuracies: [0.038394415357766144, 1.0]
The validation tracker metric at 0.1326860841423948 hasn't increased by 0 in 2 epochs
Epoch 23/65
154/154 - 61s - loss: 0.6961 - accuracy: 0.0887 - val_loss: 0.8816 - val_accuracy: 0.0831
Confusion matrix: 
 [[ 10 563]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.017 0.983]
 [0.    1.   ]]
Validation f1: 12.71
Validation accuracy: 8.31
Validation recall: 100.00
Validation precision: 6.79
Validation AUC: 0.23299405570760678
Validation class accuracies: [0.017452006980802792, 1.0]
The validation tracker metric at 0.1326860841423948 hasn't increased by 0 in 3 epochs
Epoch 24/65
154/154 - 60s - loss: 0.6610 - accuracy: 0.0899 - val_loss: 0.8559 - val_accuracy: 0.0928
Confusion matrix: 
 [[ 16 557]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.028 0.972]
 [0.    1.   ]]
Validation f1: 12.83
Validation accuracy: 9.28
Validation recall: 100.00
Validation precision: 6.86
Validation AUC: 0.2701137472550471
Validation class accuracies: [0.027923211169284468, 1.0]
The validation tracker metric at 0.1326860841423948 hasn't increased by 0 in 4 epochs
Epoch 25/65
154/154 - 60s - loss: 0.6459 - accuracy: 0.1017 - val_loss: 0.9490 - val_accuracy: 0.1091
Confusion matrix: 
 [[ 26 547]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.045 0.955]
 [0.    1.   ]]
Validation f1: 13.04
Validation accuracy: 10.91
Validation recall: 100.00
Validation precision: 6.97
Validation AUC: 0.17207023986736147
Validation class accuracies: [0.04537521815008726, 1.0]
The validation tracker metric at 0.1326860841423948 hasn't increased by 0 in 5 epochs
Epoch 26/65
154/154 - 59s - loss: 0.6437 - accuracy: 0.1314 - val_loss: 0.8812 - val_accuracy: 0.1254
Confusion matrix: 
 [[ 36 537]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.063 0.937]
 [0.    1.   ]]
Validation f1: 13.25
Validation accuracy: 12.54
Validation recall: 100.00
Validation precision: 7.09
Validation AUC: 0.25463302333648036
Validation class accuracies: [0.06282722513089005, 1.0]
The validation tracker metric at 0.1326860841423948 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 27/65
154/154 - 59s - loss: 0.6313 - accuracy: 0.1363 - val_loss: 0.8372 - val_accuracy: 0.1287
Confusion matrix: 
 [[ 38 535]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.066 0.934]
 [0.    1.   ]]
Validation f1: 13.29
Validation accuracy: 12.87
Validation recall: 100.00
Validation precision: 7.12
Validation AUC: 0.3293272229123342
Validation class accuracies: [0.06631762652705062, 1.0]
Saving model...
Epoch 28/65
154/154 - 59s - loss: 0.6235 - accuracy: 0.1363 - val_loss: 0.8435 - val_accuracy: 0.1287
Confusion matrix: 
 [[ 38 535]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.066 0.934]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.29
Validation accuracy: 12.87
Validation recall: 100.00
Validation precision: 7.12
Validation AUC: 0.31642915574281094
Validation class accuracies: [0.06631762652705062, 1.0]
The validation tracker metric at 0.13290113452188004 hasn't increased by 0 in 1 epochs
Epoch 29/65
154/154 - 59s - loss: 0.6267 - accuracy: 0.1363 - val_loss: 0.8465 - val_accuracy: 0.1352
Confusion matrix: 
 [[ 42 531]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.073 0.927]
 [0.    1.   ]]
Validation f1: 13.38
Validation accuracy: 13.52
Validation recall: 100.00
Validation precision: 7.17
Validation AUC: 0.2996360976942955
Validation class accuracies: [0.07329842931937172, 1.0]
Saving model...
Epoch 30/65
154/154 - 59s - loss: 0.6260 - accuracy: 0.1334 - val_loss: 0.8526 - val_accuracy: 0.1352
Confusion matrix: 
 [[ 42 531]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.073 0.927]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.38
Validation accuracy: 13.52
Validation recall: 100.00
Validation precision: 7.17
Validation AUC: 0.2925620657284438
Validation class accuracies: [0.07329842931937172, 1.0]
The validation tracker metric at 0.13376835236541598 hasn't increased by 0 in 1 epochs
Epoch 31/65
154/154 - 59s - loss: 0.6248 - accuracy: 0.1436 - val_loss: 0.8571 - val_accuracy: 0.1336
Confusion matrix: 
 [[ 41 532]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.072 0.928]
 [0.    1.   ]]
Validation f1: 13.36
Validation accuracy: 13.36
Validation recall: 100.00
Validation precision: 7.16
Validation AUC: 0.30044782313731194
Validation class accuracies: [0.07155322862129145, 1.0]
The validation tracker metric at 0.13376835236541598 hasn't increased by 0 in 2 epochs
Epoch 32/65
154/154 - 59s - loss: 0.6135 - accuracy: 0.1282 - val_loss: 0.8637 - val_accuracy: 0.1287
Confusion matrix: 
 [[ 38 535]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.066 0.934]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.29
Validation accuracy: 12.87
Validation recall: 100.00
Validation precision: 7.12
Validation AUC: 0.28973188901510094
Validation class accuracies: [0.06631762652705062, 1.0]
The validation tracker metric at 0.13376835236541598 hasn't increased by 0 in 3 epochs
Epoch 33/65
154/154 - 57s - loss: 0.6176 - accuracy: 0.1330 - val_loss: 0.8595 - val_accuracy: 0.1352
Confusion matrix: 
 [[ 42 531]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.073 0.927]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.38
Validation accuracy: 13.52
Validation recall: 100.00
Validation precision: 7.17
Validation AUC: 0.2941243753931095
Validation class accuracies: [0.07329842931937172, 1.0]
The validation tracker metric at 0.13376835236541598 hasn't increased by 0 in 4 epochs
Epoch 34/65
154/154 - 60s - loss: 0.6110 - accuracy: 0.1420 - val_loss: 0.8703 - val_accuracy: 0.1368
Confusion matrix: 
 [[ 43 530]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.075 0.925]
 [0.    1.   ]]
Validation f1: 13.40
Validation accuracy: 13.68
Validation recall: 100.00
Validation precision: 7.18
Validation AUC: 0.2871818361359269
Validation class accuracies: [0.07504363001745201, 1.0]
Saving model...
Epoch 35/65
154/154 - 61s - loss: 0.6160 - accuracy: 0.1485 - val_loss: 0.8392 - val_accuracy: 0.1368
Confusion matrix: 
 [[ 43 530]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.075 0.925]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.40
Validation accuracy: 13.68
Validation recall: 100.00
Validation precision: 7.18
Validation AUC: 0.2889361490254785
Validation class accuracies: [0.07504363001745201, 1.0]
The validation tracker metric at 0.13398692810457516 hasn't increased by 0 in 1 epochs
Epoch 36/65
154/154 - 60s - loss: 0.6195 - accuracy: 0.1534 - val_loss: 0.8399 - val_accuracy: 0.1368
Confusion matrix: 
 [[ 43 530]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.075 0.925]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.40
Validation accuracy: 13.68
Validation recall: 100.00
Validation precision: 7.18
Validation AUC: 0.30825342845386566
Validation class accuracies: [0.07504363001745201, 1.0]
The validation tracker metric at 0.13398692810457516 hasn't increased by 0 in 2 epochs
Epoch 37/65
154/154 - 59s - loss: 0.6136 - accuracy: 0.1465 - val_loss: 0.8371 - val_accuracy: 0.1368
Confusion matrix: 
 [[ 43 530]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.075 0.925]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.40
Validation accuracy: 13.68
Validation recall: 100.00
Validation precision: 7.18
Validation AUC: 0.30502664035766497
Validation class accuracies: [0.07504363001745201, 1.0]
The validation tracker metric at 0.13398692810457516 hasn't increased by 0 in 3 epochs
Epoch 38/65
154/154 - 60s - loss: 0.6187 - accuracy: 0.1522 - val_loss: 0.8442 - val_accuracy: 0.1368
Confusion matrix: 
 [[ 43 530]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.075 0.925]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.40
Validation accuracy: 13.68
Validation recall: 100.00
Validation precision: 7.18
Validation AUC: 0.30002076635755554
Validation class accuracies: [0.07504363001745201, 1.0]
The validation tracker metric at 0.13398692810457516 hasn't increased by 0 in 4 epochs
Epoch 39/65
154/154 - 61s - loss: 0.6140 - accuracy: 0.1461 - val_loss: 0.8533 - val_accuracy: 0.1384
Confusion matrix: 
 [[ 44 529]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.077 0.923]
 [0.    1.   ]]
Validation f1: 13.42
Validation accuracy: 13.84
Validation recall: 100.00
Validation precision: 7.19
Validation AUC: 0.2956673172085119
Validation class accuracies: [0.07678883071553229, 1.0]
Saving model...
Epoch 40/65
154/154 - 61s - loss: 0.6208 - accuracy: 0.1566 - val_loss: 0.8594 - val_accuracy: 0.1384
Confusion matrix: 
 [[ 44 529]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.077 0.923]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.42
Validation accuracy: 13.84
Validation recall: 100.00
Validation precision: 7.19
Validation AUC: 0.25814744093485814
Validation class accuracies: [0.07678883071553229, 1.0]
The validation tracker metric at 0.1342062193126023 hasn't increased by 0 in 1 epochs
Epoch 41/65
154/154 - 59s - loss: 0.6112 - accuracy: 0.1680 - val_loss: 0.8438 - val_accuracy: 0.1466
Confusion matrix: 
 [[ 49 524]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.086 0.914]
 [0.    1.   ]]
Validation f1: 13.53
Validation accuracy: 14.66
Validation recall: 100.00
Validation precision: 7.26
Validation AUC: 0.2637253848831838
Validation class accuracies: [0.08551483420593368, 1.0]
Saving model...
Epoch 42/65
154/154 - 58s - loss: 0.6136 - accuracy: 0.1656 - val_loss: 0.8540 - val_accuracy: 0.1482
Confusion matrix: 
 [[ 50 523]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.087 0.913]
 [0.    1.   ]]
Validation f1: 13.55
Validation accuracy: 14.82
Validation recall: 100.00
Validation precision: 7.27
Validation AUC: 0.2940064200637247
Validation class accuracies: [0.08726003490401396, 1.0]
Saving model...
Epoch 43/65
154/154 - 60s - loss: 0.6174 - accuracy: 0.1676 - val_loss: 0.8516 - val_accuracy: 0.1498
Confusion matrix: 
 [[ 51 522]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.089 0.911]
 [0.    1.   ]]
Validation f1: 13.58
Validation accuracy: 14.98
Validation recall: 100.00
Validation precision: 7.28
Validation AUC: 0.27207633343126364
Validation class accuracies: [0.08900523560209424, 1.0]
Saving model...
Epoch 44/65
154/154 - 60s - loss: 0.6050 - accuracy: 0.1741 - val_loss: 0.8467 - val_accuracy: 0.1531
Confusion matrix: 
 [[ 53 520]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.092 0.908]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.62
Validation accuracy: 15.31
Validation recall: 100.00
Validation precision: 7.31
Validation AUC: 0.28482314375873036
Validation class accuracies: [0.0924956369982548, 1.0]
Saving model...
Epoch 45/65
154/154 - 60s - loss: 0.6054 - accuracy: 0.1745 - val_loss: 0.8383 - val_accuracy: 0.1531
Confusion matrix: 
 [[ 53 520]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.092 0.908]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.62
Validation accuracy: 15.31
Validation recall: 100.00
Validation precision: 7.31
Validation AUC: 0.27311913633817764
Validation class accuracies: [0.0924956369982548, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 1 epochs
Epoch 46/65
154/154 - 59s - loss: 0.6088 - accuracy: 0.1660 - val_loss: 0.8235 - val_accuracy: 0.1498
Confusion matrix: 
 [[ 51 522]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.089 0.911]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.58
Validation accuracy: 14.98
Validation recall: 100.00
Validation precision: 7.28
Validation AUC: 0.3002077764674465
Validation class accuracies: [0.08900523560209424, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 2 epochs
Epoch 47/65
154/154 - 59s - loss: 0.6086 - accuracy: 0.1713 - val_loss: 0.8281 - val_accuracy: 0.1498
Confusion matrix: 
 [[ 51 522]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.089 0.911]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.58
Validation accuracy: 14.98
Validation recall: 100.00
Validation precision: 7.28
Validation AUC: 0.27877039928847824
Validation class accuracies: [0.08900523560209424, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 3 epochs
Epoch 48/65
154/154 - 59s - loss: 0.6052 - accuracy: 0.1753 - val_loss: 0.8405 - val_accuracy: 0.1515
Confusion matrix: 
 [[ 52 521]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.091 0.909]
 [0.    1.   ]]
Validation f1: 13.60
Validation accuracy: 15.15
Validation recall: 100.00
Validation precision: 7.30
Validation AUC: 0.29779352498932316
Validation class accuracies: [0.09075043630017451, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 4 epochs
Epoch 49/65
154/154 - 60s - loss: 0.6118 - accuracy: 0.1574 - val_loss: 0.8218 - val_accuracy: 0.1450
Confusion matrix: 
 [[ 48 525]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.084 0.916]
 [0.    1.   ]]
Validation f1: 13.51
Validation accuracy: 14.50
Validation recall: 100.00
Validation precision: 7.24
Validation AUC: 0.26094429678441206
Validation class accuracies: [0.08376963350785341, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 5 epochs
Epoch 50/65
154/154 - 60s - loss: 0.6159 - accuracy: 0.1558 - val_loss: 0.8365 - val_accuracy: 0.1417
Confusion matrix: 
 [[ 46 527]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.08 0.92]
 [0.   1.  ]]
Validation f1: 13.46
Validation accuracy: 14.17
Validation recall: 100.00
Validation precision: 7.22
Validation AUC: 0.30055960802389114
Validation class accuracies: [0.08027923211169284, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 51/65
154/154 - 58s - loss: 0.6042 - accuracy: 0.1530 - val_loss: 0.8333 - val_accuracy: 0.1401
Confusion matrix: 
 [[ 45 528]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.079 0.921]
 [0.    1.   ]]
Validation f1: 13.44
Validation accuracy: 14.01
Validation recall: 100.00
Validation precision: 7.21
Validation AUC: 0.2694300724199124
Validation class accuracies: [0.07853403141361257, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 7 epochs
Epoch 52/65
154/154 - 59s - loss: 0.6043 - accuracy: 0.1603 - val_loss: 0.8440 - val_accuracy: 0.1433
Confusion matrix: 
 [[ 47 526]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.082 0.918]
 [0.    1.   ]]
Validation f1: 13.49
Validation accuracy: 14.33
Validation recall: 100.00
Validation precision: 7.23
Validation AUC: 0.2863560802676355
Validation class accuracies: [0.08202443280977312, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 8 epochs
Epoch 53/65
154/154 - 59s - loss: 0.6063 - accuracy: 0.1648 - val_loss: 0.8477 - val_accuracy: 0.1450
Confusion matrix: 
 [[ 48 525]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.084 0.916]
 [0.    1.   ]]
Validation f1: 13.51
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 14.50
Validation recall: 100.00
Validation precision: 7.24
Validation AUC: 0.28836503528709506
Validation class accuracies: [0.08376963350785341, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 9 epochs
Epoch 54/65
154/154 - 60s - loss: 0.6064 - accuracy: 0.1591 - val_loss: 0.8431 - val_accuracy: 0.1450
Confusion matrix: 
 [[ 48 525]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.084 0.916]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.51
Validation accuracy: 14.50
Validation recall: 100.00
Validation precision: 7.24
Validation AUC: 0.27260327243152066
Validation class accuracies: [0.08376963350785341, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 10 epochs
Epoch 55/65
154/154 - 59s - loss: 0.6096 - accuracy: 0.1668 - val_loss: 0.8327 - val_accuracy: 0.1450
Confusion matrix: 
 [[ 48 525]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.084 0.916]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.51
Validation accuracy: 14.50
Validation recall: 100.00
Validation precision: 7.24
Validation AUC: 0.2682715143764456
Validation class accuracies: [0.08376963350785341, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 11 epochs
Epoch 56/65
154/154 - 59s - loss: 0.6059 - accuracy: 0.1526 - val_loss: 0.8350 - val_accuracy: 0.1417
Confusion matrix: 
 [[ 46 527]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.08 0.92]
 [0.   1.  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.46
Validation accuracy: 14.17
Validation recall: 100.00
Validation precision: 7.22
Validation AUC: 0.27603875721018567
Validation class accuracies: [0.08027923211169284, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 57/65
154/154 - 58s - loss: 0.6068 - accuracy: 0.1583 - val_loss: 0.8389 - val_accuracy: 0.1417
Confusion matrix: 
 [[ 46 527]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.08 0.92]
 [0.   1.  ]]
Validation f1: 13.46
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 14.17
Validation recall: 100.00
Validation precision: 7.22
Validation AUC: 0.27870860376705503
Validation class accuracies: [0.08027923211169284, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 13 epochs
Epoch 58/65
154/154 - 59s - loss: 0.6104 - accuracy: 0.1570 - val_loss: 0.8410 - val_accuracy: 0.1450
Confusion matrix: 
 [[ 48 525]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.084 0.916]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.51
Validation accuracy: 14.50
Validation recall: 100.00
Validation precision: 7.24
Validation AUC: 0.2841180373959667
Validation class accuracies: [0.08376963350785341, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 14 epochs
Epoch 59/65
154/154 - 60s - loss: 0.5979 - accuracy: 0.1591 - val_loss: 0.8377 - val_accuracy: 0.1450
Confusion matrix: 
 [[ 48 525]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.084 0.916]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.51
Validation accuracy: 14.50
Validation recall: 100.00
Validation precision: 7.24
Validation AUC: 0.2896715064142515
Validation class accuracies: [0.08376963350785341, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 15 epochs
Epoch 60/65
154/154 - 57s - loss: 0.6060 - accuracy: 0.1660 - val_loss: 0.8363 - val_accuracy: 0.1466
Confusion matrix: 
 [[ 49 524]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.086 0.914]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.53
Validation accuracy: 14.66
Validation recall: 100.00
Validation precision: 7.26
Validation AUC: 0.29017261733335814
Validation class accuracies: [0.08551483420593368, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 16 epochs
Epoch 61/65
154/154 - 56s - loss: 0.6042 - accuracy: 0.1640 - val_loss: 0.8339 - val_accuracy: 0.1498
Confusion matrix: 
 [[ 51 522]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.089 0.911]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.58
Validation accuracy: 14.98
Validation recall: 100.00
Validation precision: 7.28
Validation AUC: 0.29499047426912733
Validation class accuracies: [0.08900523560209424, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 17 epochs
Epoch 62/65
154/154 - 58s - loss: 0.6011 - accuracy: 0.1664 - val_loss: 0.8389 - val_accuracy: 0.1466
Confusion matrix: 
 [[ 49 524]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.086 0.914]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.53
Validation accuracy: 14.66
Validation recall: 100.00
Validation precision: 7.26
Validation AUC: 0.28592958846029004
Validation class accuracies: [0.08551483420593368, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 63/65
154/154 - 56s - loss: 0.5971 - accuracy: 0.1664 - val_loss: 0.8373 - val_accuracy: 0.1466
Confusion matrix: 
 [[ 49 524]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.086 0.914]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.53
Validation accuracy: 14.66
Validation recall: 100.00
Validation precision: 7.26
Validation AUC: 0.28720142283204614
Validation class accuracies: [0.08551483420593368, 1.0]
The validation tracker metric at 0.13621262458471764 hasn't increased by 0 in 19 epochs
Epoch 64/65
154/154 - 56s - loss: 0.6010 - accuracy: 0.1623 - val_loss: 0.8374 - val_accuracy: 0.1498
Confusion matrix: 
 [[ 51 522]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.089 0.911]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.58
Validation accuracy: 14.98
Validation recall: 100.00
Validation precision: 7.28
Validation AUC: 0.2854483559756306
Validation class accuracies: [0.08900523560209424, 1.0]

The metrics for job 1 with the best target metric are: 
Best cm: [[ 53 520]
 [  0  41]]
Best normalized cm: [[0.092 0.908]
 [0.    1.   ]]
Best f1: 0.14
Best accuracy: 0.15
Best recall: 1.00
Best precision: 0.07
Best AUC: 0.28
Best class accuracies: [0.0924956369982548, 1.0]
Best epoch: 44
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 30451
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_192442-2phhkb2z/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_192442-2phhkb2z/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.16233
wandb:         val_accuracy 0.14984
wandb:             _runtime 4577
wandb:           _timestamp 1624826459
wandb:                _step 483
wandb:           train_loss 0.60103
wandb:             val_loss 0.83745
wandb:           val_recall 1.0
wandb:        val_precision 0.07282
wandb:               val_f1 0.13576
wandb:              val_auc 0.28545
wandb:                   lr 2e-05
wandb:          best_val_f1 0.13621
wandb:    best_val_accuracy 0.15309
wandb:   best_val_precision 0.07308
wandb:      best_val_recall 1.0
wandb:             best_auc 0.28482
wandb:           best_epoch 44
wandb: Run history:
wandb:   train_accuracy █▃▁▁▄▄▄▃▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:     val_accuracy ▁▁▁▁▇██▁▁▁▁▁▃▂▂▃▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▇█▇▇▇▇▇▇▆▆▅▄▃▂▂▂▂▂▁▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▁▂▂▁▁▂▂▂▃▃▃▃▃▆█▆▅▅▅▅▆▅▅▅▅▅▅▄▄▄▄▅▅▄▅▅▅▅▅
wandb:       val_recall ████▁▁▁█████████████████████████████████
wandb:    val_precision ▄▄▄▄▁▂▁▄▄▄▄▄▇▅▅▆▇▇▇▇▇▇▇▇▇██████▇▇██▇████
wandb:           val_f1 ▄▄▄▄▁▂▁▄▄▄▄▅▇▆▅▆▇▇▇▇▇▇▇▇▇██████▇███▇████
wandb:          val_auc ▁▁▂▂▁▂▁▂▂▃▃▃▄▅▆▄▆█▇█▇▇██▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr █████▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_192442-2phhkb2z

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 10, 125, 128, 1) 4            input_3[0][0]                        
______________________________________________________________________________________________________________
time_distributed_16 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
time_distributed_18 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
time_distributed_20 (TimeDistribute (None, 10, 125, 128, 1) 0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
time_distributed_17 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_16[0][0]            
______________________________________________________________________________________________________________
time_distributed_19 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_18[0][0]            
______________________________________________________________________________________________________________
time_distributed_21 (TimeDistribute (None, 10, 125, 128, 16 32           time_distributed_20[0][0]            
______________________________________________________________________________________________________________
concatenate_2 (Concatenate)         (None, 10, 125, 128, 48 0            time_distributed_17[0][0]            
                                                                         time_distributed_19[0][0]            
                                                                         time_distributed_21[0][0]            
______________________________________________________________________________________________________________
time_distributed_22 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_2[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 10, 63, 64, 48)  192          time_distributed_22[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 10, 63, 64, 48)  0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
time_distributed_23 (TimeDistribute (None, 10, 48)          0            dropout_3[0][0]                      
______________________________________________________________________________________________________________
lstm_5 (LSTM)                       (None, 10, 128)         90624        time_distributed_23[0][0]            
______________________________________________________________________________________________________________
lstm_6 (LSTM)                       (None, 10, 128)         131584       lstm_5[0][0]                         
______________________________________________________________________________________________________________
lstm_7 (LSTM)                       (None, 10, 128)         131584       lstm_6[0][0]                         
______________________________________________________________________________________________________________
dense_7 (Dense)                     (None, 10, 64)          8256         lstm_7[0][0]                         
______________________________________________________________________________________________________________
dense_8 (Dense)                     (None, 10, 128)         8320         dense_7[0][0]                        
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 10, 128)         0            dense_8[0][0]                        
______________________________________________________________________________________________________________
dense_9 (Dense)                     (None, 10, 1)           129          dropout_4[0][0]                      
______________________________________________________________________________________________________________
flatten_2 (Flatten)                 (None, 10)              0            dense_9[0][0]                        
______________________________________________________________________________________________________________
dense_10 (Dense)                    (None, 1)               11           flatten_2[0][0]                      
==============================================================================================================
Total params: 379,536
Trainable params: 379,438
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 57s - loss: 0.7924 - accuracy: 0.4357 - val_loss: 0.7462 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.1521953322581345
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 55s - loss: 0.7233 - accuracy: 0.3820 - val_loss: 1.0825 - val_accuracy: 0.0993
Confusion matrix: 
 [[ 20 553]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.035 0.965]
 [0.    1.   ]]
Validation f1: 12.91
Validation accuracy: 9.93
Validation recall: 100.00
Validation precision: 6.90
Validation AUC: 0.04876817485509702
Validation class accuracies: [0.034904013961605584, 1.0]
Saving model...
Epoch 3/65
154/154 - 55s - loss: 0.6916 - accuracy: 0.6973 - val_loss: 0.8921 - val_accuracy: 0.0684
Confusion matrix: 
 [[  1 572]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
Validation f1: 12.54
Validation accuracy: 6.84
Validation recall: 100.00
Validation precision: 6.69
Validation AUC: 0.5262522158768933
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.12913385826771656 hasn't increased by 0 in 1 epochs
Epoch 4/65
154/154 - 57s - loss: 0.6779 - accuracy: 0.6123 - val_loss: 0.5252 - val_accuracy: 0.8713
Confusion matrix: 
 [[518  55]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.585 0.415]]
Validation f1: 30.09
Validation accuracy: 87.13
Validation recall: 41.46
Validation precision: 23.61
Validation AUC: 0.19490511575079433
Validation class accuracies: [0.9040139616055847, 0.4146341463414634]
Saving model...
Epoch 5/65
154/154 - 55s - loss: 0.6461 - accuracy: 0.6684 - val_loss: 1.0081 - val_accuracy: 0.1564
Confusion matrix: 
 [[ 55 518]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.096 0.904]
 [0.    1.   ]]
Validation f1: 13.67
Validation accuracy: 15.64
Validation recall: 100.00
Validation precision: 7.33
Validation AUC: 0.2135674063178188
Validation class accuracies: [0.09598603839441536, 1.0]
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 57s - loss: 0.6277 - accuracy: 0.5907 - val_loss: 0.6382 - val_accuracy: 0.7573
Confusion matrix: 
 [[433 140]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.756 0.244]
 [0.22  0.78 ]]
Validation f1: 30.05
Validation accuracy: 75.73
Validation recall: 78.05
Validation precision: 18.60
Validation AUC: 0.2219306668732652
Validation class accuracies: [0.7556719022687609, 0.7804878048780488]
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 2 epochs
Epoch 7/65
154/154 - 57s - loss: 0.5380 - accuracy: 0.7596 - val_loss: 0.7026 - val_accuracy: 0.6857
Confusion matrix: 
 [[382 191]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.667 0.333]
 [0.049 0.951]]
Validation f1: 28.78
Validation accuracy: 68.57
Validation recall: 95.12
Validation precision: 16.96
Validation AUC: 0.4631120112316596
Validation class accuracies: [0.6666666666666666, 0.9512195121951219]
The validation tracker metric at 0.30088495575221236 hasn't increased by 0 in 3 epochs
Epoch 8/65
154/154 - 54s - loss: 0.5434 - accuracy: 0.7042 - val_loss: 0.5969 - val_accuracy: 0.8029
Confusion matrix: 
 [[464 109]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.293 0.707]]
Validation f1: 32.40
Validation accuracy: 80.29
Validation recall: 70.73
Validation precision: 21.01
Validation AUC: 0.35512735558678526
Validation class accuracies: [0.8097731239092496, 0.7073170731707317]
Saving model...
Epoch 9/65
154/154 - 57s - loss: 0.5156 - accuracy: 0.7856 - val_loss: 0.6236 - val_accuracy: 0.7622
Confusion matrix: 
 [[429 144]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.749 0.251]
 [0.049 0.951]]
Validation f1: 34.82
Validation accuracy: 76.22
Validation recall: 95.12
Validation precision: 21.31
Validation AUC: 0.49079572925954196
Validation class accuracies: [0.7486910994764397, 0.9512195121951219]
Saving model...
Epoch 10/65
154/154 - 56s - loss: 0.5193 - accuracy: 0.8377 - val_loss: 0.6066 - val_accuracy: 0.7948
Confusion matrix: 
 [[453 120]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.791 0.209]
 [0.146 0.854]]
Validation f1: 35.71
Validation accuracy: 79.48
Validation recall: 85.37
Validation precision: 22.58
Validation AUC: 0.4548994255189184
Validation class accuracies: [0.7905759162303665, 0.8536585365853658]
Saving model...
Epoch 11/65
154/154 - 55s - loss: 0.5465 - accuracy: 0.6473 - val_loss: 0.5712 - val_accuracy: 0.7622
Confusion matrix: 
 [[430 143]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.75  0.25 ]
 [0.073 0.927]]
Validation f1: 34.23
Validation accuracy: 76.22
Validation recall: 92.68
Validation precision: 20.99
Validation AUC: 0.5093924455027041
Validation class accuracies: [0.7504363001745201, 0.926829268292683]
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 1 epochs
Epoch 12/65
154/154 - 58s - loss: 0.4976 - accuracy: 0.7644 - val_loss: 0.5670 - val_accuracy: 0.7671
Confusion matrix: 
 [[436 137]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.761 0.239]
 [0.146 0.854]]
Validation f1: 32.86
Validation accuracy: 76.71
Validation recall: 85.37
Validation precision: 20.35
Validation AUC: 0.5407272089762777
Validation class accuracies: [0.7609075043630017, 0.8536585365853658]
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 2 epochs
Epoch 13/65
154/154 - 56s - loss: 0.4931 - accuracy: 0.8312 - val_loss: 0.5896 - val_accuracy: 0.7557
Confusion matrix: 
 [[429 144]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.749 0.251]
 [0.146 0.854]]
Validation f1: 31.82
Validation accuracy: 75.57
Validation recall: 85.37
Validation precision: 19.55
Validation AUC: 0.5041746705464022
Validation class accuracies: [0.7486910994764397, 0.8536585365853658]
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 3 epochs
Epoch 14/65
154/154 - 56s - loss: 0.4821 - accuracy: 0.7970 - val_loss: 0.5967 - val_accuracy: 0.7590
Confusion matrix: 
 [[431 142]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.752 0.248]
 [0.146 0.854]]
Validation f1: 32.11
Validation accuracy: 75.90
Validation recall: 85.37
Validation precision: 19.77
Validation AUC: 0.3930812166423761
Validation class accuracies: [0.7521815008726004, 0.8536585365853658]
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 4 epochs
Epoch 15/65
154/154 - 57s - loss: 0.4834 - accuracy: 0.8474 - val_loss: 0.6858 - val_accuracy: 0.7313
Confusion matrix: 
 [[411 162]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.717 0.283]
 [0.073 0.927]]
Validation f1: 31.54
Validation accuracy: 73.13
Validation recall: 92.68
Validation precision: 19.00
Validation AUC: 0.44811447600712173
Validation class accuracies: [0.7172774869109948, 0.926829268292683]
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 5 epochs
Epoch 16/65
154/154 - 55s - loss: 0.4486 - accuracy: 0.8377 - val_loss: 0.6917 - val_accuracy: 0.7329
Confusion matrix: 
 [[412 161]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.719 0.281]
 [0.073 0.927]]
Validation f1: 31.67
Validation accuracy: 73.29
Validation recall: 92.68
Validation precision: 19.10
Validation AUC: 0.4053434632260009
Validation class accuracies: [0.7190226876090751, 0.926829268292683]
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
154/154 - 57s - loss: 0.4302 - accuracy: 0.8238 - val_loss: 0.7101 - val_accuracy: 0.7215
Confusion matrix: 
 [[403 170]
 [  1  40]]
Normalized Confusion matrix: 
 [[0.703 0.297]
 [0.024 0.976]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 31.87
Validation accuracy: 72.15
Validation recall: 97.56
Validation precision: 19.05
Validation AUC: 0.3527350587389012
Validation class accuracies: [0.7033158813263525, 0.975609756097561]
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 7 epochs
Epoch 18/65
154/154 - 57s - loss: 0.4545 - accuracy: 0.8088 - val_loss: 0.6197 - val_accuracy: 0.7801
Confusion matrix: 
 [[443 130]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.122 0.878]]
Validation f1: 34.78
Validation accuracy: 78.01
Validation recall: 87.80
Validation precision: 21.69
Validation AUC: 0.5008516810472019
Validation class accuracies: [0.7731239092495636, 0.8780487804878049]
The validation tracker metric at 0.35714285714285715 hasn't increased by 0 in 8 epochs
Epoch 19/65
154/154 - 55s - loss: 0.4263 - accuracy: 0.8759 - val_loss: 0.6083 - val_accuracy: 0.7932
Confusion matrix: 
 [[450 123]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.098 0.902]]
Validation f1: 36.82
Validation accuracy: 79.32
Validation recall: 90.24
Validation precision: 23.12
Validation AUC: 0.43740911217630696
Validation class accuracies: [0.7853403141361257, 0.9024390243902439]
Saving model...
Epoch 20/65
154/154 - 57s - loss: 0.4408 - accuracy: 0.8438 - val_loss: 0.5293 - val_accuracy: 0.8208
Confusion matrix: 
 [[470 103]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82  0.18 ]
 [0.171 0.829]]
Validation f1: 38.20
Validation accuracy: 82.08
Validation recall: 82.93
Validation precision: 24.82
Validation AUC: 0.465733999502156
Validation class accuracies: [0.8202443280977313, 0.8292682926829268]
Saving model...
Epoch 21/65
154/154 - 56s - loss: 0.4262 - accuracy: 0.8397 - val_loss: 0.6082 - val_accuracy: 0.7948
Confusion matrix: 
 [[451 122]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.098 0.902]]
Validation f1: 37.00
Validation accuracy: 79.48
Validation recall: 90.24
Validation precision: 23.27
Validation AUC: 0.36855925937882683
Validation class accuracies: [0.787085514834206, 0.9024390243902439]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 1 epochs
Epoch 22/65
154/154 - 55s - loss: 0.4301 - accuracy: 0.8397 - val_loss: 0.5680 - val_accuracy: 0.8029
Confusion matrix: 
 [[458 115]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.799 0.201]
 [0.146 0.854]]
Validation f1: 36.65
Validation accuracy: 80.29
Validation recall: 85.37
Validation precision: 23.33
Validation AUC: 0.41462737334284666
Validation class accuracies: [0.7993019197207679, 0.8536585365853658]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 2 epochs
Epoch 23/65
154/154 - 58s - loss: 0.4192 - accuracy: 0.8580 - val_loss: 0.5519 - val_accuracy: 0.8013
Confusion matrix: 
 [[456 117]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.122 0.878]]
Validation f1: 37.11
Validation accuracy: 80.13
Validation recall: 87.80
Validation precision: 23.53
Validation AUC: 0.37390252627986253
Validation class accuracies: [0.7958115183246073, 0.8780487804878049]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 3 epochs
Epoch 24/65
154/154 - 55s - loss: 0.4091 - accuracy: 0.8377 - val_loss: 0.5630 - val_accuracy: 0.7801
Confusion matrix: 
 [[444 129]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.146 0.854]]
Validation f1: 34.15
Validation accuracy: 78.01
Validation recall: 85.37
Validation precision: 21.34
Validation AUC: 0.43846917253335144
Validation class accuracies: [0.774869109947644, 0.8536585365853658]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 4 epochs
Epoch 25/65
154/154 - 56s - loss: 0.4090 - accuracy: 0.8548 - val_loss: 0.5269 - val_accuracy: 0.8078
Confusion matrix: 
 [[462 111]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.171 0.829]]
Validation f1: 36.56
Validation accuracy: 80.78
Validation recall: 82.93
Validation precision: 23.45
Validation AUC: 0.4618801844884532
Validation class accuracies: [0.806282722513089, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 5 epochs
Epoch 26/65
154/154 - 57s - loss: 0.4159 - accuracy: 0.8576 - val_loss: 0.5313 - val_accuracy: 0.7997
Confusion matrix: 
 [[457 116]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.798 0.202]
 [0.171 0.829]]
Validation f1: 35.60
Validation accuracy: 79.97
Validation recall: 82.93
Validation precision: 22.67
Validation AUC: 0.4276786129928663
Validation class accuracies: [0.7975567190226877, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 27/65
154/154 - 55s - loss: 0.4047 - accuracy: 0.8446 - val_loss: 0.5357 - val_accuracy: 0.8062
Confusion matrix: 
 [[462 111]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.806 0.194]
 [0.195 0.805]]
Validation f1: 35.68
Validation accuracy: 80.62
Validation recall: 80.49
Validation precision: 22.92
Validation AUC: 0.37930467687157987
Validation class accuracies: [0.806282722513089, 0.8048780487804879]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 7 epochs
Epoch 28/65
154/154 - 57s - loss: 0.4102 - accuracy: 0.8495 - val_loss: 0.5696 - val_accuracy: 0.7801
Confusion matrix: 
 [[443 130]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.78
Validation accuracy: 78.01
Validation recall: 87.80
Validation precision: 21.69
Validation AUC: 0.3456319345257604
Validation class accuracies: [0.7731239092495636, 0.8780487804878049]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 8 epochs
Epoch 29/65
154/154 - 57s - loss: 0.4115 - accuracy: 0.8381 - val_loss: 0.6001 - val_accuracy: 0.7622
Confusion matrix: 
 [[431 142]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.752 0.248]
 [0.098 0.902]]
Validation f1: 33.64
Validation accuracy: 76.22
Validation recall: 90.24
Validation precision: 20.67
Validation AUC: 0.4300251706953153
Validation class accuracies: [0.7521815008726004, 0.9024390243902439]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 9 epochs
Epoch 30/65
154/154 - 55s - loss: 0.4048 - accuracy: 0.8426 - val_loss: 0.5525 - val_accuracy: 0.7866
Confusion matrix: 
 [[449 124]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.784 0.216]
 [0.171 0.829]]
Validation f1: 34.17
Validation accuracy: 78.66
Validation recall: 82.93
Validation precision: 21.52
Validation AUC: 0.4122494126484318
Validation class accuracies: [0.7835951134380453, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 10 epochs
Epoch 31/65
154/154 - 57s - loss: 0.3987 - accuracy: 0.8519 - val_loss: 0.5512 - val_accuracy: 0.7834
Confusion matrix: 
 [[447 126]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.171 0.829]]
Validation f1: 33.83
Validation accuracy: 78.34
Validation recall: 82.93
Validation precision: 21.25
Validation AUC: 0.4025222884054643
Validation class accuracies: [0.7801047120418848, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 11 epochs
Epoch 32/65
154/154 - 55s - loss: 0.4058 - accuracy: 0.8617 - val_loss: 0.5429 - val_accuracy: 0.7883
Confusion matrix: 
 [[450 123]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.171 0.829]]
Validation f1: 34.34
Validation accuracy: 78.83
Validation recall: 82.93
Validation precision: 21.66
Validation AUC: 0.3771876490586161
Validation class accuracies: [0.7853403141361257, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 33/65
154/154 - 55s - loss: 0.4062 - accuracy: 0.8600 - val_loss: 0.5665 - val_accuracy: 0.7801
Confusion matrix: 
 [[443 130]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.78
Validation accuracy: 78.01
Validation recall: 87.80
Validation precision: 21.69
Validation AUC: 0.38801972787670463
Validation class accuracies: [0.7731239092495636, 0.8780487804878049]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 13 epochs
Epoch 34/65
154/154 - 55s - loss: 0.3981 - accuracy: 0.8564 - val_loss: 0.5647 - val_accuracy: 0.7883
Confusion matrix: 
 [[448 125]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.782 0.218]
 [0.122 0.878]]
Validation f1: 35.64
Validation accuracy: 78.83
Validation recall: 87.80
Validation precision: 22.36
Validation AUC: 0.3759992243682934
Validation class accuracies: [0.7818499127399651, 0.8780487804878049]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 14 epochs
Epoch 35/65
154/154 - 54s - loss: 0.4188 - accuracy: 0.8495 - val_loss: 0.5538 - val_accuracy: 0.7866
Confusion matrix: 
 [[449 124]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.784 0.216]
 [0.171 0.829]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.17
Validation accuracy: 78.66
Validation recall: 82.93
Validation precision: 21.52
Validation AUC: 0.4026515960669986
Validation class accuracies: [0.7835951134380453, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 15 epochs
Epoch 36/65
154/154 - 57s - loss: 0.3935 - accuracy: 0.8556 - val_loss: 0.5559 - val_accuracy: 0.7834
Confusion matrix: 
 [[447 126]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.171 0.829]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 33.83
Validation accuracy: 78.34
Validation recall: 82.93
Validation precision: 21.25
Validation AUC: 0.39451940021558785
Validation class accuracies: [0.7801047120418848, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 16 epochs
Epoch 37/65
154/154 - 54s - loss: 0.4016 - accuracy: 0.8560 - val_loss: 0.5358 - val_accuracy: 0.7899
Confusion matrix: 
 [[451 122]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.171 0.829]]
Validation f1: 34.52
Validation accuracy: 78.99
Validation recall: 82.93
Validation precision: 21.79
Validation AUC: 0.4122082015471114
Validation class accuracies: [0.787085514834206, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 17 epochs
Epoch 38/65
154/154 - 57s - loss: 0.3955 - accuracy: 0.8690 - val_loss: 0.5387 - val_accuracy: 0.7915
Confusion matrix: 
 [[452 121]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.171 0.829]]
Validation f1: 34.69
Validation accuracy: 79.15
Validation recall: 82.93
Validation precision: 21.94
Validation AUC: 0.40477286235716187
Validation class accuracies: [0.7888307155322862, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 39/65
154/154 - 55s - loss: 0.3879 - accuracy: 0.8617 - val_loss: 0.5456 - val_accuracy: 0.7883
Confusion matrix: 
 [[450 123]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.171 0.829]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.34
Validation accuracy: 78.83
Validation recall: 82.93
Validation precision: 21.66
Validation AUC: 0.405930741514453
Validation class accuracies: [0.7853403141361257, 0.8292682926829268]
The validation tracker metric at 0.38202247191011235 hasn't increased by 0 in 19 epochs
Epoch 40/65
154/154 - 55s - loss: 0.3881 - accuracy: 0.8653 - val_loss: 0.5414 - val_accuracy: 0.7899
Confusion matrix: 
 [[451 122]
 [  7  34]]
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.171 0.829]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.52
Validation accuracy: 78.99
Validation recall: 82.93
Validation precision: 21.79
Validation AUC: 0.4228372215311591
Validation class accuracies: [0.787085514834206, 0.8292682926829268]

The metrics for job 2 with the best target metric are: 
Best cm: [[470 103]
 [  7  34]]
Best normalized cm: [[0.82  0.18 ]
 [0.171 0.829]]
Best f1: 0.38
Best accuracy: 0.82
Best recall: 0.83
Best precision: 0.25
Best AUC: 0.47
Best class accuracies: [0.8202443280977313, 0.8292682926829268]
Best epoch: 20
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 13272
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_204103-1iagawx1/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_204103-1iagawx1/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.86534
wandb:         val_accuracy 0.7899
wandb:             _runtime 2700
wandb:           _timestamp 1624829164
wandb:                _step 303
wandb:           train_loss 0.38814
wandb:             val_loss 0.54138
wandb:           val_recall 0.82927
wandb:        val_precision 0.21795
wandb:               val_f1 0.34518
wandb:              val_auc 0.42284
wandb:                   lr 6e-05
wandb:          best_val_f1 0.38202
wandb:    best_val_accuracy 0.82085
wandb:   best_val_precision 0.24818
wandb:      best_val_recall 0.82927
wandb:             best_auc 0.46573
wandb:           best_epoch 20
wandb: Run history:
wandb:   train_accuracy ▂▁▅▄▅▄▆▆▇▇▅▆▇▇█▇▇▇██▇▇█▇████▇███████████
wandb:     val_accuracy ▁▁▁█▂▇▆▇▇▇▇▇▇▇▇▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▆▆▅▅▄▄▃▃▄▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁
wandb:         val_loss ▄█▆▁▇▂▃▂▂▂▂▂▂▂▃▃▃▂▂▁▂▂▁▁▁▁▁▂▂▁▁▁▂▁▁▁▁▁▁▁
wandb:       val_recall ███▁█▅▇▄▇▆▇▆▆▆▇▇█▇▇▆▇▆▇▆▆▆▆▇▇▆▆▆▇▇▆▆▆▆▆▆
wandb:    val_precision ▁▁▁█▁▆▅▇▇▇▇▆▆▆▆▆▆▇▇█▇▇█▇▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_f1 ▁▁▁▆▁▆▅▆▇▇▇▇▆▆▆▆▆▇█████▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▂▁█▃▃▃▇▅▇▇██▇▆▇▆▅▇▇▇▆▆▆▇▇▆▆▅▆▆▆▆▆▆▆▆▆▆▆▆
wandb:               lr ████████████████▄▄▄▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_204103-1iagawx1

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 10, 125, 128, 1) 4            input_4[0][0]                        
______________________________________________________________________________________________________________
time_distributed_24 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
time_distributed_26 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
time_distributed_28 (TimeDistribute (None, 10, 125, 128, 1) 0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
time_distributed_25 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_24[0][0]            
______________________________________________________________________________________________________________
time_distributed_27 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_26[0][0]            
______________________________________________________________________________________________________________
time_distributed_29 (TimeDistribute (None, 10, 125, 128, 16 32           time_distributed_28[0][0]            
______________________________________________________________________________________________________________
concatenate_3 (Concatenate)         (None, 10, 125, 128, 48 0            time_distributed_25[0][0]            
                                                                         time_distributed_27[0][0]            
                                                                         time_distributed_29[0][0]            
______________________________________________________________________________________________________________
time_distributed_30 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_3[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 10, 63, 64, 48)  192          time_distributed_30[0][0]            
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 10, 63, 64, 48)  0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
time_distributed_31 (TimeDistribute (None, 10, 48)          0            dropout_5[0][0]                      
______________________________________________________________________________________________________________
lstm_8 (LSTM)                       (None, 10, 128)         90624        time_distributed_31[0][0]            
______________________________________________________________________________________________________________
dense_11 (Dense)                    (None, 10, 128)         16512        lstm_8[0][0]                         
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 10, 128)         0            dense_11[0][0]                       
______________________________________________________________________________________________________________
dense_12 (Dense)                    (None, 10, 1)           129          dropout_6[0][0]                      
______________________________________________________________________________________________________________
flatten_3 (Flatten)                 (None, 10)              0            dense_12[0][0]                       
______________________________________________________________________________________________________________
dense_13 (Dense)                    (None, 1)               11           flatten_3[0][0]                      
==============================================================================================================
Total params: 116,304
Trainable params: 116,206
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 57s - loss: 0.7826 - accuracy: 0.2368 - val_loss: 1.0679 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.15806882879852188
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 54s - loss: 0.6787 - accuracy: 0.6513 - val_loss: 1.2886 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.037021997305448875
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 56s - loss: 0.5995 - accuracy: 0.8222 - val_loss: 0.6138 - val_accuracy: 0.9169
Confusion matrix: 
 [[538  35]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.39  0.61 ]]
Validation f1: 49.50
Validation accuracy: 91.69
Validation recall: 60.98
Validation precision: 41.67
Validation AUC: 0.4023673895320055
Validation class accuracies: [0.9389179755671903, 0.6097560975609756]
Saving model...
Epoch 4/65
154/154 - 55s - loss: 0.5788 - accuracy: 0.8283 - val_loss: 0.9715 - val_accuracy: 0.5879
Confusion matrix: 
 [[324 249]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.565 0.435]
 [0.098 0.902]]
Validation f1: 22.63
Validation accuracy: 58.79
Validation recall: 90.24
Validation precision: 12.94
Validation AUC: 0.23129038516472725
Validation class accuracies: [0.5654450261780105, 0.9024390243902439]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 1 epochs
Epoch 5/65
154/154 - 54s - loss: 0.5768 - accuracy: 0.8434 - val_loss: 0.7554 - val_accuracy: 0.7590
Confusion matrix: 
 [[429 144]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.749 0.251]
 [0.098 0.902]]
Validation f1: 33.33
Validation accuracy: 75.90
Validation recall: 90.24
Validation precision: 20.44
Validation AUC: 0.47596349543975314
Validation class accuracies: [0.7486910994764397, 0.9024390243902439]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 2 epochs
Epoch 6/65
154/154 - 57s - loss: 0.5268 - accuracy: 0.8548 - val_loss: 0.7360 - val_accuracy: 0.7427
Confusion matrix: 
 [[416 157]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.024 0.976]]
Validation f1: 33.61
Validation accuracy: 74.27
Validation recall: 97.56
Validation precision: 20.30
Validation AUC: 0.5841422345437618
Validation class accuracies: [0.7260034904013961, 0.975609756097561]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 3 epochs
Epoch 7/65
154/154 - 54s - loss: 0.4926 - accuracy: 0.8718 - val_loss: 0.9153 - val_accuracy: 0.6173
Confusion matrix: 
 [[338 235]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.59 0.41]
 [0.   1.  ]]
Validation f1: 25.87
Validation accuracy: 61.73
Validation recall: 100.00
Validation precision: 14.86
Validation AUC: 0.5715237565657402
Validation class accuracies: [0.5898778359511344, 1.0]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 4 epochs
Epoch 8/65
154/154 - 57s - loss: 0.4694 - accuracy: 0.8393 - val_loss: 0.5009 - val_accuracy: 0.8730
Confusion matrix: 
 [[501  72]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.874 0.126]
 [0.146 0.854]]
Validation f1: 47.30
Validation accuracy: 87.30
Validation recall: 85.37
Validation precision: 32.71
Validation AUC: 0.5612990006690554
Validation class accuracies: [0.8743455497382199, 0.8536585365853658]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 5 epochs
Epoch 9/65
154/154 - 54s - loss: 0.4593 - accuracy: 0.8454 - val_loss: 0.6226 - val_accuracy: 0.7818
Confusion matrix: 
 [[445 128]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.777 0.223]
 [0.146 0.854]]
Validation f1: 34.31
Validation accuracy: 78.18
Validation recall: 85.37
Validation precision: 21.47
Validation AUC: 0.49262164188106733
Validation class accuracies: [0.7766143106457243, 0.8536585365853658]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 10/65
154/154 - 55s - loss: 0.4422 - accuracy: 0.8393 - val_loss: 0.8017 - val_accuracy: 0.6759
Confusion matrix: 
 [[374 199]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.653 0.347]
 [0.    1.   ]]
Validation f1: 29.18
Validation accuracy: 67.59
Validation recall: 100.00
Validation precision: 17.08
Validation AUC: 0.42657947547448993
Validation class accuracies: [0.6527050610820244, 1.0]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 7 epochs
Epoch 11/65
154/154 - 57s - loss: 0.4151 - accuracy: 0.8609 - val_loss: 0.5935 - val_accuracy: 0.8013
Confusion matrix: 
 [[453 120]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.791 0.209]
 [0.049 0.951]]
Validation f1: 39.00
Validation accuracy: 80.13
Validation recall: 95.12
Validation precision: 24.53
Validation AUC: 0.4368355017327482
Validation class accuracies: [0.7905759162303665, 0.9512195121951219]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 8 epochs
Epoch 12/65
154/154 - 55s - loss: 0.4244 - accuracy: 0.8816 - val_loss: 0.5883 - val_accuracy: 0.7964
Confusion matrix: 
 [[454 119]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.146 0.854]]
Validation f1: 35.90
Validation accuracy: 79.64
Validation recall: 85.37
Validation precision: 22.73
Validation AUC: 0.4122807978307822
Validation class accuracies: [0.7923211169284468, 0.8536585365853658]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 9 epochs
Epoch 13/65
154/154 - 57s - loss: 0.4281 - accuracy: 0.8523 - val_loss: 0.4695 - val_accuracy: 0.8713
Confusion matrix: 
 [[500  73]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.146 0.854]]
Validation f1: 46.98
Validation accuracy: 87.13
Validation recall: 85.37
Validation precision: 32.41
Validation AUC: 0.4988211646372763
Validation class accuracies: [0.8726003490401396, 0.8536585365853658]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 10 epochs
Epoch 14/65
154/154 - 54s - loss: 0.4269 - accuracy: 0.8800 - val_loss: 0.5976 - val_accuracy: 0.7899
Confusion matrix: 
 [[448 125]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.782 0.218]
 [0.098 0.902]]
Validation f1: 36.45
Validation accuracy: 78.99
Validation recall: 90.24
Validation precision: 22.84
Validation AUC: 0.4157699860683948
Validation class accuracies: [0.7818499127399651, 0.9024390243902439]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 11 epochs
Epoch 15/65
154/154 - 57s - loss: 0.4085 - accuracy: 0.8531 - val_loss: 0.5711 - val_accuracy: 0.8013
Confusion matrix: 
 [[456 117]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.11
Validation accuracy: 80.13
Validation recall: 87.80
Validation precision: 23.53
Validation AUC: 0.4180296611367791
Validation class accuracies: [0.7958115183246073, 0.8780487804878049]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 16/65
154/154 - 55s - loss: 0.3949 - accuracy: 0.8784 - val_loss: 0.5616 - val_accuracy: 0.8094
Confusion matrix: 
 [[459 114]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.801 0.199]
 [0.073 0.927]]
Validation f1: 39.38
Validation accuracy: 80.94
Validation recall: 92.68
Validation precision: 25.00
Validation AUC: 0.4099503012503021
Validation class accuracies: [0.8010471204188482, 0.926829268292683]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 13 epochs
Epoch 17/65
154/154 - 54s - loss: 0.4085 - accuracy: 0.8633 - val_loss: 0.5560 - val_accuracy: 0.8029
Confusion matrix: 
 [[456 117]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.098 0.902]]
Validation f1: 37.95
Validation accuracy: 80.29
Validation recall: 90.24
Validation precision: 24.03
Validation AUC: 0.4188355777276594
Validation class accuracies: [0.7958115183246073, 0.9024390243902439]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 14 epochs
Epoch 18/65
154/154 - 57s - loss: 0.4150 - accuracy: 0.8674 - val_loss: 0.5552 - val_accuracy: 0.8046
Confusion matrix: 
 [[457 116]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.798 0.202]
 [0.098 0.902]]
Validation f1: 38.14
Validation accuracy: 80.46
Validation recall: 90.24
Validation precision: 24.18
Validation AUC: 0.42122421393856707
Validation class accuracies: [0.7975567190226877, 0.9024390243902439]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 15 epochs
Epoch 19/65
154/154 - 55s - loss: 0.3957 - accuracy: 0.8706 - val_loss: 0.5379 - val_accuracy: 0.8160
Confusion matrix: 
 [[464 109]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.098 0.902]]
Validation f1: 39.57
Validation accuracy: 81.60
Validation recall: 90.24
Validation precision: 25.34
Validation AUC: 0.42220786250776177
Validation class accuracies: [0.8097731239092496, 0.9024390243902439]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 16 epochs
Epoch 20/65
154/154 - 57s - loss: 0.3829 - accuracy: 0.8820 - val_loss: 0.5689 - val_accuracy: 0.7964
Confusion matrix: 
 [[452 121]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.098 0.902]]
Validation f1: 37.19
Validation accuracy: 79.64
Validation recall: 90.24
Validation precision: 23.42
Validation AUC: 0.40430856310912805
Validation class accuracies: [0.7888307155322862, 0.9024390243902439]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 17 epochs
Epoch 21/65
154/154 - 54s - loss: 0.3870 - accuracy: 0.8727 - val_loss: 0.5067 - val_accuracy: 0.8371
Confusion matrix: 
 [[478  95]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.834 0.166]
 [0.122 0.878]]
Validation f1: 41.86
Validation accuracy: 83.71
Validation recall: 87.80
Validation precision: 27.48
Validation AUC: 0.420954550418327
Validation class accuracies: [0.8342059336823735, 0.8780487804878049]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 22/65
154/154 - 56s - loss: 0.4060 - accuracy: 0.8845 - val_loss: 0.5428 - val_accuracy: 0.8143
Confusion matrix: 
 [[463 110]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.808 0.192]
 [0.098 0.902]]
Validation f1: 39.36
Validation accuracy: 81.43
Validation recall: 90.24
Validation precision: 25.17
Validation AUC: 0.40736078036934903
Validation class accuracies: [0.8080279232111692, 0.9024390243902439]
The validation tracker metric at 0.4950495049504951 hasn't increased by 0 in 19 epochs
Epoch 23/65
154/154 - 57s - loss: 0.3859 - accuracy: 0.8828 - val_loss: 0.5565 - val_accuracy: 0.8062
Confusion matrix: 
 [[458 115]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.799 0.201]
 [0.098 0.902]]
Validation f1: 38.34
Validation accuracy: 80.62
Validation recall: 90.24
Validation precision: 24.34
Validation AUC: 0.4015866096744609
Validation class accuracies: [0.7993019197207679, 0.9024390243902439]

The metrics for job 3 with the best target metric are: 
Best cm: [[538  35]
 [ 16  25]]
Best normalized cm: [[0.939 0.061]
 [0.39  0.61 ]]
Best f1: 0.50
Best accuracy: 0.92
Best recall: 0.61
Best precision: 0.42
Best AUC: 0.40
Best class accuracies: [0.9389179755671903, 0.6097560975609756]
Best epoch: 3
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 21609
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_212608-2d4j57je/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_212608-2d4j57je/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.88283
wandb:         val_accuracy 0.80619
wandb:             _runtime 1544
wandb:           _timestamp 1624830713
wandb:                _step 166
wandb:           train_loss 0.38585
wandb:             val_loss 0.55646
wandb:           val_recall 0.90244
wandb:        val_precision 0.24342
wandb:               val_f1 0.38342
wandb:              val_auc 0.40159
wandb:                   lr 0.00013
wandb:          best_val_f1 0.49505
wandb:    best_val_accuracy 0.91694
wandb:   best_val_precision 0.41667
wandb:      best_val_recall 0.60976
wandb:             best_auc 0.40237
wandb:           best_epoch 3
wandb: Run history:
wandb:   train_accuracy ▁▅▇▇███████████████████
wandb:     val_accuracy ▁▁█▅▇▇▆█▇▆▇▇█▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▅▄▄▄▃▃▂▂▂▂▂▂▁▁▁▂▁▁▁▁▁
wandb:         val_loss ▆█▂▅▃▃▅▁▂▄▂▂▁▂▂▂▂▂▂▂▁▂▂
wandb:       val_recall ██▁▆▆██▅▅█▇▅▅▆▆▇▆▆▆▆▆▆▆
wandb:    val_precision ▁▁█▂▄▄▃▆▄▃▅▄▆▄▄▅▄▅▅▄▅▅▅
wandb:           val_f1 ▁▁█▃▅▅▄█▅▄▆▅█▆▆▆▆▆▆▆▇▆▆
wandb:          val_auc ▃▁▆▃▇███▇▆▆▆▇▆▆▆▆▆▆▆▆▆▆
wandb:               lr █████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_212608-2d4j57je

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_5 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 10, 125, 128, 1) 4            input_5[0][0]                        
______________________________________________________________________________________________________________
time_distributed_32 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
time_distributed_34 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
time_distributed_36 (TimeDistribute (None, 10, 125, 128, 1) 0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
time_distributed_33 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_32[0][0]            
______________________________________________________________________________________________________________
time_distributed_35 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_34[0][0]            
______________________________________________________________________________________________________________
time_distributed_37 (TimeDistribute (None, 10, 125, 128, 16 32           time_distributed_36[0][0]            
______________________________________________________________________________________________________________
concatenate_4 (Concatenate)         (None, 10, 125, 128, 48 0            time_distributed_33[0][0]            
                                                                         time_distributed_35[0][0]            
                                                                         time_distributed_37[0][0]            
______________________________________________________________________________________________________________
time_distributed_38 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_4[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 10, 63, 64, 48)  192          time_distributed_38[0][0]            
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 10, 63, 64, 48)  0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
time_distributed_39 (TimeDistribute (None, 10, 48)          0            dropout_7[0][0]                      
______________________________________________________________________________________________________________
lstm_9 (LSTM)                       (None, 10, 128)         90624        time_distributed_39[0][0]            
______________________________________________________________________________________________________________
dense_14 (Dense)                    (None, 10, 128)         16512        lstm_9[0][0]                         
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 10, 128)         0            dense_14[0][0]                       
______________________________________________________________________________________________________________
dense_15 (Dense)                    (None, 10, 1)           129          dropout_8[0][0]                      
______________________________________________________________________________________________________________
flatten_4 (Flatten)                 (None, 10)              0            dense_15[0][0]                       
______________________________________________________________________________________________________________
dense_16 (Dense)                    (None, 128)             1408         flatten_4[0][0]                      
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 128)             0            dense_16[0][0]                       
______________________________________________________________________________________________________________
dense_17 (Dense)                    (None, 1)               129          dropout_9[0][0]                      
==============================================================================================================
Total params: 117,830
Trainable params: 117,732
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 54s - loss: 0.7646 - accuracy: 0.2095 - val_loss: 1.0515 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.4988753430984326
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 56s - loss: 0.7219 - accuracy: 0.6892 - val_loss: 2.1929 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.11229559217540133
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 54s - loss: 0.6092 - accuracy: 0.7596 - val_loss: 1.7172 - val_accuracy: 0.1678
Confusion matrix: 
 [[ 62 511]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.108 0.892]
 [0.    1.   ]]
Validation f1: 13.83
Validation accuracy: 16.78
Validation recall: 100.00
Validation precision: 7.43
Validation AUC: 0.2819644578135853
Validation class accuracies: [0.1082024432809773, 1.0]
Saving model...
Epoch 4/65
154/154 - 55s - loss: 0.5075 - accuracy: 0.8430 - val_loss: 1.2433 - val_accuracy: 0.4788
Confusion matrix: 
 [[253 320]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.442 0.558]
 [0.    1.   ]]
Validation f1: 20.40
Validation accuracy: 47.88
Validation recall: 100.00
Validation precision: 11.36
Validation AUC: 0.34557438294213094
Validation class accuracies: [0.44153577661431065, 1.0]
Saving model...
Epoch 5/65
154/154 - 56s - loss: 0.4943 - accuracy: 0.8247 - val_loss: 0.5072 - val_accuracy: 0.8274
Confusion matrix: 
 [[472 101]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.824 0.176]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.45
Validation accuracy: 82.74
Validation recall: 87.80
Validation precision: 26.28
Validation AUC: 0.5622310045641927
Validation class accuracies: [0.8237347294938918, 0.8780487804878049]
Saving model...
Epoch 6/65
154/154 - 54s - loss: 0.4674 - accuracy: 0.8352 - val_loss: 0.3558 - val_accuracy: 0.9121
Confusion matrix: 
 [[529  44]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.244 0.756]]
Validation f1: 53.45
Validation accuracy: 91.21
Validation recall: 75.61
Validation precision: 41.33
Validation AUC: 0.5528099425897781
Validation class accuracies: [0.9232111692844677, 0.7560975609756098]
Saving model...
Epoch 7/65
154/154 - 56s - loss: 0.4369 - accuracy: 0.8344 - val_loss: 0.6168 - val_accuracy: 0.7345
Confusion matrix: 
 [[412 161]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.719 0.281]
 [0.049 0.951]]
Validation f1: 32.37
Validation accuracy: 73.45
Validation recall: 95.12
Validation precision: 19.50
Validation AUC: 0.4892026391570711
Validation class accuracies: [0.7190226876090751, 0.9512195121951219]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 1 epochs
Epoch 8/65
154/154 - 54s - loss: 0.4600 - accuracy: 0.8226 - val_loss: 0.4398 - val_accuracy: 0.8664
Confusion matrix: 
 [[499  74]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.195 0.805]]
Validation f1: 44.59
Validation accuracy: 86.64
Validation recall: 80.49
Validation precision: 30.84
Validation AUC: 0.55624451591396
Validation class accuracies: [0.8708551483420593, 0.8048780487804879]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 2 epochs
Epoch 9/65
154/154 - 57s - loss: 0.4076 - accuracy: 0.8572 - val_loss: 0.4734 - val_accuracy: 0.8485
Confusion matrix: 
 [[486  87]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.146 0.854]]
Validation f1: 42.94
Validation accuracy: 84.85
Validation recall: 85.37
Validation precision: 28.69
Validation AUC: 0.5434600070288653
Validation class accuracies: [0.8481675392670157, 0.8536585365853658]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 3 epochs
Epoch 10/65
154/154 - 54s - loss: 0.3958 - accuracy: 0.8649 - val_loss: 0.3921 - val_accuracy: 0.8746
Confusion matrix: 
 [[506  67]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.244 0.756]]
Validation f1: 44.60
Validation accuracy: 87.46
Validation recall: 75.61
Validation precision: 31.63
Validation AUC: 0.5556877179520814
Validation class accuracies: [0.8830715532286213, 0.7560975609756098]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 4 epochs
Epoch 11/65
154/154 - 54s - loss: 0.3831 - accuracy: 0.8645 - val_loss: 0.5330 - val_accuracy: 0.8176
Confusion matrix: 
 [[469 104]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.195 0.805]]
Validation f1: 37.08
Validation accuracy: 81.76
Validation recall: 80.49
Validation precision: 24.09
Validation AUC: 0.562379521808109
Validation class accuracies: [0.8184991273996509, 0.8048780487804879]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 5 epochs
Epoch 12/65
154/154 - 56s - loss: 0.4015 - accuracy: 0.8820 - val_loss: 0.3511 - val_accuracy: 0.9007
Confusion matrix: 
 [[522  51]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.244 0.756]]
Validation f1: 50.41
Validation accuracy: 90.07
Validation recall: 75.61
Validation precision: 37.80
Validation AUC: 0.5616279967951125
Validation class accuracies: [0.9109947643979057, 0.7560975609756098]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
154/154 - 54s - loss: 0.3894 - accuracy: 0.8889 - val_loss: 0.5292 - val_accuracy: 0.8176
Confusion matrix: 
 [[467 106]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.815 0.185]
 [0.146 0.854]]
Validation f1: 38.46
Validation accuracy: 81.76
Validation recall: 85.37
Validation precision: 24.82
Validation AUC: 0.5632473123068024
Validation class accuracies: [0.8150087260034904, 0.8536585365853658]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 7 epochs
Epoch 14/65
154/154 - 57s - loss: 0.3875 - accuracy: 0.8678 - val_loss: 0.5049 - val_accuracy: 0.8208
Confusion matrix: 
 [[471 102]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.195 0.805]]
Validation f1: 37.50
Validation accuracy: 82.08
Validation recall: 80.49
Validation precision: 24.44
Validation AUC: 0.5716544839782652
Validation class accuracies: [0.8219895287958116, 0.8048780487804879]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 8 epochs
Epoch 15/65
154/154 - 54s - loss: 0.3780 - accuracy: 0.8731 - val_loss: 0.4890 - val_accuracy: 0.8388
Confusion matrix: 
 [[482  91]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.195 0.805]]
Validation f1: 40.00
Validation accuracy: 83.88
Validation recall: 80.49
Validation precision: 26.61
Validation AUC: 0.5694909397279849
Validation class accuracies: [0.8411867364746946, 0.8048780487804879]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 9 epochs
Epoch 16/65
154/154 - 56s - loss: 0.3718 - accuracy: 0.8869 - val_loss: 0.6006 - val_accuracy: 0.7850
Confusion matrix: 
 [[447 126]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.146 0.854]]
Validation f1: 34.65
Validation accuracy: 78.50
Validation recall: 85.37
Validation precision: 21.74
Validation AUC: 0.5740040270629148
Validation class accuracies: [0.7801047120418848, 0.8536585365853658]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 10 epochs
Epoch 17/65
154/154 - 55s - loss: 0.3807 - accuracy: 0.8889 - val_loss: 0.5541 - val_accuracy: 0.8111
Confusion matrix: 
 [[464 109]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.171 0.829]]
Validation f1: 36.96
Validation accuracy: 81.11
Validation recall: 82.93
Validation precision: 23.78
Validation AUC: 0.5773353904278092
Validation class accuracies: [0.8097731239092496, 0.8292682926829268]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 11 epochs
Epoch 18/65
154/154 - 54s - loss: 0.3717 - accuracy: 0.8897 - val_loss: 0.5634 - val_accuracy: 0.8192
Confusion matrix: 
 [[466 107]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.813 0.187]
 [0.098 0.902]]
Validation f1: 40.00
Validation accuracy: 81.92
Validation recall: 90.24
Validation precision: 25.69
Validation AUC: 0.5776889624137757
Validation class accuracies: [0.8132635253054101, 0.9024390243902439]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 19/65
154/154 - 57s - loss: 0.3686 - accuracy: 0.8767 - val_loss: 0.4826 - val_accuracy: 0.8420
Confusion matrix: 
 [[483  90]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.171 0.829]]
Validation f1: 41.21
Validation accuracy: 84.20
Validation recall: 82.93
Validation precision: 27.42
Validation AUC: 0.5774383198956522
Validation class accuracies: [0.8429319371727748, 0.8292682926829268]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 13 epochs
Epoch 20/65
154/154 - 54s - loss: 0.3508 - accuracy: 0.8902 - val_loss: 0.5420 - val_accuracy: 0.8225
Confusion matrix: 
 [[470 103]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.82  0.18 ]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.11
Validation accuracy: 82.25
Validation recall: 85.37
Validation precision: 25.36
Validation AUC: 0.579231080487053
Validation class accuracies: [0.8202443280977313, 0.8536585365853658]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 14 epochs
Epoch 21/65
154/154 - 54s - loss: 0.3680 - accuracy: 0.8889 - val_loss: 0.5107 - val_accuracy: 0.8322
Confusion matrix: 
 [[477  96]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.171 0.829]]
Validation f1: 39.77
Validation accuracy: 83.22
Validation recall: 82.93
Validation precision: 26.15
Validation AUC: 0.5841448804226084
Validation class accuracies: [0.8324607329842932, 0.8292682926829268]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 15 epochs
Epoch 22/65
154/154 - 52s - loss: 0.3746 - accuracy: 0.8755 - val_loss: 0.4283 - val_accuracy: 0.8648
Confusion matrix: 
 [[500  73]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.244 0.756]]
Validation f1: 42.76
Validation accuracy: 86.48
Validation recall: 75.61
Validation precision: 29.81
Validation AUC: 0.5675049751176403
Validation class accuracies: [0.8726003490401396, 0.7560975609756098]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 16 epochs
Epoch 23/65
154/154 - 56s - loss: 0.3572 - accuracy: 0.8714 - val_loss: 0.5079 - val_accuracy: 0.8274
Confusion matrix: 
 [[475  98]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.195 0.805]]
Validation f1: 38.37
Validation accuracy: 82.74
Validation recall: 80.49
Validation precision: 25.19
Validation AUC: 0.5793782907259899
Validation class accuracies: [0.8289703315881326, 0.8048780487804879]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 17 epochs
Epoch 24/65
154/154 - 52s - loss: 0.3686 - accuracy: 0.8637 - val_loss: 0.5249 - val_accuracy: 0.8176
Confusion matrix: 
 [[469 104]
 [  8  33]]
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.195 0.805]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.08
Validation accuracy: 81.76
Validation recall: 80.49
Validation precision: 24.09
Validation AUC: 0.5868627811973962
Validation class accuracies: [0.8184991273996509, 0.8048780487804879]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 25/65
154/154 - 55s - loss: 0.3536 - accuracy: 0.8788 - val_loss: 0.5617 - val_accuracy: 0.7964
Confusion matrix: 
 [[453 120]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.791 0.209]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.55
Validation accuracy: 79.64
Validation recall: 87.80
Validation precision: 23.08
Validation AUC: 0.58611622315693
Validation class accuracies: [0.7905759162303665, 0.8780487804878049]
The validation tracker metric at 0.5344827586206896 hasn't increased by 0 in 19 epochs
Epoch 26/65
154/154 - 52s - loss: 0.3399 - accuracy: 0.8889 - val_loss: 0.5393 - val_accuracy: 0.8192
Confusion matrix: 
 [[468 105]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.146 0.854]]
Validation f1: 38.67
Validation accuracy: 81.92
Validation recall: 85.37
Validation precision: 25.00
Validation AUC: 0.5813355540708242
Validation class accuracies: [0.8167539267015707, 0.8536585365853658]

The metrics for job 4 with the best target metric are: 
Best cm: [[529  44]
 [ 10  31]]
Best normalized cm: [[0.923 0.077]
 [0.244 0.756]]
Best f1: 0.53
Best accuracy: 0.91
Best recall: 0.76
Best precision: 0.41
Best AUC: 0.55
Best class accuracies: [0.9232111692844677, 0.7560975609756098]
Best epoch: 6
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 26372
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_215156-2jx0pknv/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_215156-2jx0pknv/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.88893
wandb:         val_accuracy 0.81922
wandb:             _runtime 1720
wandb:           _timestamp 1624832437
wandb:                _step 196
wandb:           train_loss 0.3399
wandb:             val_loss 0.53934
wandb:           val_recall 0.85366
wandb:        val_precision 0.25
wandb:               val_f1 0.38674
wandb:              val_auc 0.58134
wandb:                   lr 0.00013
wandb:          best_val_f1 0.53448
wandb:    best_val_accuracy 0.91205
wandb:   best_val_precision 0.41333
wandb:      best_val_recall 0.7561
wandb:             best_auc 0.55281
wandb:           best_epoch 6
wandb: Run history:
wandb:   train_accuracy ▁▆▇█▇▇▇▇██████████████████
wandb:     val_accuracy ▁▁▂▄▇█▇█▇█▇█▇▇▇▇▇▇▇▇▇█▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▅▄▄▃▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▂▁▁▁▁
wandb:         val_loss ▄█▆▄▂▁▂▁▁▁▂▁▂▂▂▂▂▂▁▂▂▁▂▂▂▂
wandb:       val_recall ████▅▁▇▂▄▁▂▁▄▂▂▄▃▅▃▄▃▁▂▂▅▄
wandb:    val_precision ▁▁▁▂▅█▄▆▅▆▅▇▅▅▅▄▄▅▅▅▅▆▅▅▄▅
wandb:           val_f1 ▁▁▁▂▆█▄▆▆▆▅▇▅▅▆▅▅▆▆▆▆▆▅▅▅▅
wandb:          val_auc ▇▁▄▄█▇▇█▇█████████████████
wandb:               lr ████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_215156-2jx0pknv

-----------------------
New
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_6 (InputLayer)                [(None, 10, 125, 128, 1 0                                                 
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 10, 125, 128, 1) 4            input_6[0][0]                        
______________________________________________________________________________________________________________
time_distributed_40 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
time_distributed_42 (TimeDistribute (None, 10, 125, 128, 16 32           batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
time_distributed_44 (TimeDistribute (None, 10, 125, 128, 1) 0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
time_distributed_41 (TimeDistribute (None, 10, 125, 128, 16 2320         time_distributed_40[0][0]            
______________________________________________________________________________________________________________
time_distributed_43 (TimeDistribute (None, 10, 125, 128, 16 6416         time_distributed_42[0][0]            
______________________________________________________________________________________________________________
time_distributed_45 (TimeDistribute (None, 10, 125, 128, 16 32           time_distributed_44[0][0]            
______________________________________________________________________________________________________________
concatenate_5 (Concatenate)         (None, 10, 125, 128, 48 0            time_distributed_41[0][0]            
                                                                         time_distributed_43[0][0]            
                                                                         time_distributed_45[0][0]            
______________________________________________________________________________________________________________
time_distributed_46 (TimeDistribute (None, 10, 63, 64, 48)  0            concatenate_5[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 10, 63, 64, 48)  192          time_distributed_46[0][0]            
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 10, 63, 64, 48)  0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
time_distributed_47 (TimeDistribute (None, 10, 48)          0            dropout_10[0][0]                     
______________________________________________________________________________________________________________
lstm_10 (LSTM)                      (None, 10, 128)         90624        time_distributed_47[0][0]            
______________________________________________________________________________________________________________
dense_18 (Dense)                    (None, 10, 1)           129          lstm_10[0][0]                        
______________________________________________________________________________________________________________
flatten_5 (Flatten)                 (None, 10)              0            dense_18[0][0]                       
______________________________________________________________________________________________________________
dense_19 (Dense)                    (None, 1)               11           flatten_5[0][0]                      
==============================================================================================================
Total params: 99,792
Trainable params: 99,694
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 56s - loss: 0.7801 - accuracy: 0.7600 - val_loss: 0.7543 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.20541971370318907
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 52s - loss: 0.6732 - accuracy: 0.6371 - val_loss: 0.7911 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.32553196844863497
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 54s - loss: 0.5996 - accuracy: 0.7160 - val_loss: 0.6049 - val_accuracy: 0.4560
Confusion matrix: 
 [[239 334]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.417 0.583]
 [0.    1.   ]]
Validation f1: 19.71
Validation accuracy: 45.60
Validation recall: 100.00
Validation precision: 10.93
Validation AUC: 0.15157947856490506
Validation class accuracies: [0.41710296684118675, 1.0]
Saving model...
Epoch 4/65
154/154 - 52s - loss: 0.6162 - accuracy: 0.7705 - val_loss: 0.3021 - val_accuracy: 0.8746
Confusion matrix: 
 [[504  69]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.195 0.805]]
Validation f1: 46.15
Validation accuracy: 87.46
Validation recall: 80.49
Validation precision: 32.35
Validation AUC: 0.48298281045174246
Validation class accuracies: [0.8795811518324608, 0.8048780487804879]
Saving model...
Epoch 5/65
154/154 - 53s - loss: 0.5635 - accuracy: 0.7941 - val_loss: 0.4221 - val_accuracy: 0.7182
Confusion matrix: 
 [[400 173]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.698 0.302]
 [0.    1.   ]]
Validation f1: 32.16
Validation accuracy: 71.82
Validation recall: 100.00
Validation precision: 19.16
Validation AUC: 0.2505885825804559
Validation class accuracies: [0.6980802792321117, 1.0]
The validation tracker metric at 0.46153846153846156 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 53s - loss: 0.5579 - accuracy: 0.7669 - val_loss: 0.2468 - val_accuracy: 0.9267
Confusion matrix: 
 [[544  29]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.39  0.61 ]]
Validation f1: 52.63
Validation accuracy: 92.67
Validation recall: 60.98
Validation precision: 46.30
Validation AUC: 0.5405307442492631
Validation class accuracies: [0.9493891797556719, 0.6097560975609756]
Saving model...
Epoch 7/65
154/154 - 52s - loss: 0.5511 - accuracy: 0.8206 - val_loss: 0.2792 - val_accuracy: 0.8941
Confusion matrix: 
 [[516  57]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.195 0.805]]
Validation f1: 50.38
Validation accuracy: 89.41
Validation recall: 80.49
Validation precision: 36.67
Validation AUC: 0.5626794319952866
Validation class accuracies: [0.900523560209424, 0.8048780487804879]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 1 epochs
Epoch 8/65
154/154 - 55s - loss: 0.5114 - accuracy: 0.8539 - val_loss: 0.4338 - val_accuracy: 0.7492
Confusion matrix: 
 [[420 153]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.733 0.267]
 [0.024 0.976]]
Validation f1: 34.19
Validation accuracy: 74.92
Validation recall: 97.56
Validation precision: 20.73
Validation AUC: 0.3328800306202798
Validation class accuracies: [0.7329842931937173, 0.975609756097561]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 2 epochs
Epoch 9/65
154/154 - 52s - loss: 0.4992 - accuracy: 0.8108 - val_loss: 1.1136 - val_accuracy: 0.0814
Confusion matrix: 
 [[  9 564]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.016 0.984]
 [0.    1.   ]]
Validation f1: 12.69
Validation accuracy: 8.14
Validation recall: 100.00
Validation precision: 6.78
Validation AUC: 0.20704965997128524
Validation class accuracies: [0.015706806282722512, 1.0]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 3 epochs
Epoch 10/65
154/154 - 56s - loss: 0.5066 - accuracy: 0.8165 - val_loss: 0.4361 - val_accuracy: 0.7508
Confusion matrix: 
 [[420 153]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.733 0.267]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.89
Validation accuracy: 75.08
Validation recall: 100.00
Validation precision: 21.13
Validation AUC: 0.5355674183126848
Validation class accuracies: [0.7329842931937173, 1.0]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 4 epochs
Epoch 11/65
154/154 - 52s - loss: 0.4823 - accuracy: 0.8491 - val_loss: 0.4038 - val_accuracy: 0.8029
Confusion matrix: 
 [[456 117]
 [  4  37]]
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.098 0.902]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.95
Validation accuracy: 80.29
Validation recall: 90.24
Validation precision: 24.03
Validation AUC: 0.5451263814746068
Validation class accuracies: [0.7958115183246073, 0.9024390243902439]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 5 epochs
Epoch 12/65
154/154 - 55s - loss: 0.4763 - accuracy: 0.8295 - val_loss: 0.2842 - val_accuracy: 0.9088
Confusion matrix: 
 [[527  46]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.244 0.756]]
Validation f1: 52.54
Validation accuracy: 90.88
Validation recall: 75.61
Validation precision: 40.26
Validation AUC: 0.5547252860393838
Validation class accuracies: [0.9197207678883071, 0.7560975609756098]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
154/154 - 52s - loss: 0.4603 - accuracy: 0.8426 - val_loss: 0.3749 - val_accuracy: 0.8355
Confusion matrix: 
 [[476  97]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.831 0.169]
 [0.098 0.902]]
Validation f1: 42.29
Validation accuracy: 83.55
Validation recall: 90.24
Validation precision: 27.61
Validation AUC: 0.5743182920228997
Validation class accuracies: [0.8307155322862129, 0.9024390243902439]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 7 epochs
Epoch 14/65
154/154 - 56s - loss: 0.4339 - accuracy: 0.8519 - val_loss: 0.3854 - val_accuracy: 0.8192
Confusion matrix: 
 [[467 106]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.815 0.185]
 [0.122 0.878]]
Validation f1: 39.34
Validation accuracy: 81.92
Validation recall: 87.80
Validation precision: 25.35
Validation AUC: 0.5615512138508452
Validation class accuracies: [0.8150087260034904, 0.8780487804878049]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 8 epochs
Epoch 15/65
154/154 - 52s - loss: 0.4545 - accuracy: 0.8535 - val_loss: 0.4363 - val_accuracy: 0.7752
Confusion matrix: 
 [[437 136]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.763 0.237]
 [0.049 0.951]]
Validation f1: 36.11
Validation accuracy: 77.52
Validation recall: 95.12
Validation precision: 22.29
Validation AUC: 0.5514988745617642
Validation class accuracies: [0.7626527050610821, 0.9512195121951219]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 9 epochs
Epoch 16/65
154/154 - 55s - loss: 0.4466 - accuracy: 0.8499 - val_loss: 0.3373 - val_accuracy: 0.8681
Confusion matrix: 
 [[498  75]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.146 0.854]]
Validation f1: 46.36
Validation accuracy: 86.81
Validation recall: 85.37
Validation precision: 31.82
Validation AUC: 0.5838497319231486
Validation class accuracies: [0.8691099476439791, 0.8536585365853658]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 10 epochs
Epoch 17/65
154/154 - 52s - loss: 0.4291 - accuracy: 0.8645 - val_loss: 0.4727 - val_accuracy: 0.7606
Confusion matrix: 
 [[430 143]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.75  0.25 ]
 [0.098 0.902]]
Validation f1: 33.48
Validation accuracy: 76.06
Validation recall: 90.24
Validation precision: 20.56
Validation AUC: 0.5415407823504338
Validation class accuracies: [0.7504363001745201, 0.9024390243902439]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 11 epochs
Epoch 18/65
154/154 - 55s - loss: 0.4455 - accuracy: 0.8242 - val_loss: 0.3685 - val_accuracy: 0.8388
Confusion matrix: 
 [[479  94]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.836 0.164]
 [0.122 0.878]]
Validation f1: 42.11
Validation accuracy: 83.88
Validation recall: 87.80
Validation precision: 27.69
Validation AUC: 0.5660421710905713
Validation class accuracies: [0.8359511343804538, 0.8780487804878049]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 19/65
154/154 - 52s - loss: 0.4283 - accuracy: 0.8576 - val_loss: 0.3853 - val_accuracy: 0.8306
Confusion matrix: 
 [[473 100]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.098 0.902]]
Validation f1: 41.57
Validation accuracy: 83.06
Validation recall: 90.24
Validation precision: 27.01
Validation AUC: 0.5697853163212621
Validation class accuracies: [0.8254799301919721, 0.9024390243902439]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 13 epochs
Epoch 20/65
154/154 - 54s - loss: 0.4248 - accuracy: 0.8531 - val_loss: 0.4154 - val_accuracy: 0.8078
Confusion matrix: 
 [[456 117]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.024 0.976]]
Validation f1: 40.40
Validation accuracy: 80.78
Validation recall: 97.56
Validation precision: 25.48
Validation AUC: 0.5714732478168306
Validation class accuracies: [0.7958115183246073, 0.975609756097561]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 14 epochs
Epoch 21/65
154/154 - 52s - loss: 0.4303 - accuracy: 0.8609 - val_loss: 0.3777 - val_accuracy: 0.8306
Confusion matrix: 
 [[474  99]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.827 0.173]
 [0.122 0.878]]
Validation f1: 40.91
Validation accuracy: 83.06
Validation recall: 87.80
Validation precision: 26.67
Validation AUC: 0.5688316781509193
Validation class accuracies: [0.8272251308900523, 0.8780487804878049]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 15 epochs
Epoch 22/65
154/154 - 52s - loss: 0.4289 - accuracy: 0.8572 - val_loss: 0.4020 - val_accuracy: 0.8094
Confusion matrix: 
 [[461 112]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.805 0.195]
 [0.122 0.878]]
Validation f1: 38.10
Validation accuracy: 80.94
Validation recall: 87.80
Validation precision: 24.32
Validation AUC: 0.5653508952417762
Validation class accuracies: [0.8045375218150087, 0.8780487804878049]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 16 epochs
Epoch 23/65
154/154 - 53s - loss: 0.4275 - accuracy: 0.8641 - val_loss: 0.4099 - val_accuracy: 0.8062
Confusion matrix: 
 [[458 115]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.799 0.201]
 [0.098 0.902]]
Validation f1: 38.34
Validation accuracy: 80.62
Validation recall: 90.24
Validation precision: 24.34
Validation AUC: 0.5695146388611927
Validation class accuracies: [0.7993019197207679, 0.9024390243902439]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 17 epochs
Epoch 24/65
154/154 - 52s - loss: 0.4132 - accuracy: 0.8678 - val_loss: 0.4218 - val_accuracy: 0.7997
Confusion matrix: 
 [[453 120]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.791 0.209]
 [0.073 0.927]]
Validation f1: 38.19
Validation accuracy: 79.97
Validation recall: 92.68
Validation precision: 24.05
Validation AUC: 0.5667697360388497
Validation class accuracies: [0.7905759162303665, 0.926829268292683]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 25/65
154/154 - 55s - loss: 0.4292 - accuracy: 0.8584 - val_loss: 0.4079 - val_accuracy: 0.8078
Confusion matrix: 
 [[459 114]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.801 0.199]
 [0.098 0.902]]
Validation f1: 38.54
Validation accuracy: 80.78
Validation recall: 90.24
Validation precision: 24.50
Validation AUC: 0.567525884030107
Validation class accuracies: [0.8010471204188482, 0.9024390243902439]
The validation tracker metric at 0.5263157894736843 hasn't increased by 0 in 19 epochs
Epoch 26/65
154/154 - 52s - loss: 0.4226 - accuracy: 0.8657 - val_loss: 0.4133 - val_accuracy: 0.8046
Confusion matrix: 
 [[457 116]
 [  4  37]]
Normalized Confusion matrix: 
 [[0.798 0.202]
 [0.098 0.902]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.14
Validation accuracy: 80.46
Validation recall: 90.24
Validation precision: 24.18
Validation AUC: 0.5661985024792998
Validation class accuracies: [0.7975567190226877, 0.9024390243902439]

The metrics for job 5 with the best target metric are: 
Best cm: [[544  29]
 [ 16  25]]
Best normalized cm: [[0.949 0.051]
 [0.39  0.61 ]]
Best f1: 0.53
Best accuracy: 0.93
Best recall: 0.61
Best precision: 0.46
Best AUC: 0.54
Best class accuracies: [0.9493891797556719, 0.6097560975609756]
Best epoch: 6
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 31546
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_222041-yz1n2ipv/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_222041-yz1n2ipv/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.86574
wandb:         val_accuracy 0.80456
wandb:             _runtime 1677
wandb:           _timestamp 1624834118
wandb:                _step 193
wandb:           train_loss 0.42255
wandb:             val_loss 0.41331
wandb:           val_recall 0.90244
wandb:        val_precision 0.24183
wandb:               val_f1 0.38144
wandb:              val_auc 0.5662
wandb:                   lr 0.00013
wandb:          best_val_f1 0.52632
wandb:    best_val_accuracy 0.92671
wandb:   best_val_precision 0.46296
wandb:      best_val_recall 0.60976
wandb:             best_auc 0.54053
wandb:           best_epoch 6
wandb: Run history:
wandb:   train_accuracy ▅▁▃▅▆▅▇█▆▆▇▇▇██▇█▇████████
wandb:     val_accuracy ▁▁▄█▆██▇▁▇▇█▇▇▇█▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▅▅▄▄▄▃▃▃▂▂▂▁▂▂▁▂▁▁▁▁▁▁▁▁
wandb:         val_loss ▅▅▄▁▂▁▁▃█▃▂▁▂▂▃▂▃▂▂▂▂▂▂▂▂▂
wandb:       val_recall ███▅█▁▅███▆▄▆▆▇▅▆▆▆█▆▆▆▇▆▆
wandb:    val_precision ▁▁▂▆▃█▆▃▁▄▄▇▅▄▄▅▃▅▅▄▅▄▄▄▄▄
wandb:           val_f1 ▁▁▂▇▄██▅▁▅▅█▆▆▅▇▅▆▆▆▆▅▆▅▆▅
wandb:          val_auc ▂▄▁▆▃▇█▄▂▇▇███▇█▇█████████
wandb:               lr ████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_222041-yz1n2ipv

-----------------------

 See logs at ../../new_cache/conv__2261__06_1850__v39__lstm/logs/