Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2115
Description:  mod9
2021-05-09 20:36:02.620776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 20:36:04.852820: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 20:36:04.853851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-09 20:36:04.902583: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:04.903392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 20:36:04.903421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 20:36:04.907068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 20:36:04.907149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 20:36:04.908257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 20:36:04.908554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 20:36:04.909631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 20:36:04.910515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 20:36:04.910698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 20:36:04.910804: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:04.911542: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:04.912297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-09 20:36:05.096773: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 20:36:05.096977: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:05.097716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 20:36:05.097749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 20:36:05.097789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 20:36:05.097804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 20:36:05.097821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 20:36:05.097836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 20:36:05.097861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 20:36:05.097878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 20:36:05.097892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 20:36:05.097974: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:05.098766: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:05.099429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-09 20:36:05.099464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 20:36:05.803323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-09 20:36:05.803370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-09 20:36:05.803378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-09 20:36:05.803657: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:05.804394: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:05.805074: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 20:36:05.805734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2115.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2115__05_2035__v29__mod9/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 3, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
Original number of folders: 453
here
With concat = False and six = False, size of training set: 6092...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        2021-05-09 20:36:41.320327: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-09 20:36:41.321943: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-09 20:36:44.234605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 20:36:44.936186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 20:36:44.943735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/40
381/381 - 750s - loss: 0.7891 - accuracy: 0.4989 - val_loss: 0.9043 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2278873838119433
Validation class accuracies: [0.0, 1.0]
Epoch 2/40
381/381 - 739s - loss: 0.7315 - accuracy: 0.5030 - val_loss: 1.1146 - val_accuracy: 0.2068
Confusion matrix: 
 [[  9 861]
 [  2 216]]
Validation f1: 33.36
Validation accuracy: 20.68
Validation recall: 99.08
Validation precision: 20.06
Validation AUC: 0.18610671221320457
Validation class accuracies: [0.010344827586206896, 0.9908256880733946]
Epoch 3/40
381/381 - 740s - loss: 0.7271 - accuracy: 0.5117 - val_loss: 0.8770 - val_accuracy: 0.3107
Confusion matrix: 
 [[154 716]
 [ 34 184]]
Validation f1: 32.92
Validation accuracy: 31.07
Validation recall: 84.40
Validation precision: 20.44
Validation AUC: 0.20115324149318048
Validation class accuracies: [0.17701149425287357, 0.8440366972477065]
Epoch 4/40
381/381 - 738s - loss: 0.7157 - accuracy: 0.5181 - val_loss: 0.8371 - val_accuracy: 0.4007
Confusion matrix: 
 [[297 573]
 [ 79 139]]
Validation f1: 29.89
Validation accuracy: 40.07
Validation recall: 63.76
Validation precision: 19.52
Validation AUC: 0.19327255851744288
Validation class accuracies: [0.3413793103448276, 0.6376146788990825]
Epoch 5/40
381/381 - 738s - loss: 0.7056 - accuracy: 0.5337 - val_loss: 0.7663 - val_accuracy: 0.4678
Confusion matrix: 
 [[357 513]
 [ 66 152]]
Validation f1: 34.43
Validation accuracy: 46.78
Validation recall: 69.72
Validation precision: 22.86
Validation AUC: 0.2319471467650639
Validation class accuracies: [0.4103448275862069, 0.6972477064220184]
Epoch 6/40
381/381 - 738s - loss: 0.6949 - accuracy: 0.5427 - val_loss: 1.0709 - val_accuracy: 0.4099
Confusion matrix: 
 [[266 604]
 [ 38 180]]
Validation f1: 35.93
Validation accuracy: 40.99
Validation recall: 82.57
Validation precision: 22.96
Validation AUC: 0.22956800734000218
Validation class accuracies: [0.3057471264367816, 0.8256880733944955]
Saving model...
Epoch 7/40
381/381 - 738s - loss: 0.6905 - accuracy: 0.5530 - val_loss: 1.1612 - val_accuracy: 0.2739
Confusion matrix: 
 [[147 723]
 [ 67 151]]
Validation f1: 27.66
Validation accuracy: 27.39
Validation recall: 69.27
Validation precision: 17.28
Validation AUC: 0.17448371105798804
Validation class accuracies: [0.16896551724137931, 0.6926605504587156]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 1 epochs
Epoch 8/40
381/381 - 739s - loss: 0.6796 - accuracy: 0.5566 - val_loss: 0.9834 - val_accuracy: 0.2748
Confusion matrix: 
 [[119 751]
 [ 38 180]]
Validation f1: 31.33
Validation accuracy: 27.48
Validation recall: 82.57
Validation precision: 19.33
Validation AUC: 0.20123656000449458
Validation class accuracies: [0.1367816091954023, 0.8256880733944955]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 2 epochs
Epoch 9/40
381/381 - 738s - loss: 0.6647 - accuracy: 0.5768 - val_loss: 0.7993 - val_accuracy: 0.5643
Confusion matrix: 
 [[556 314]
 [160  58]]
Validation f1: 19.66
Validation accuracy: 56.43
Validation recall: 26.61
Validation precision: 15.59
Validation AUC: 0.17975432374106437
Validation class accuracies: [0.639080459770115, 0.26605504587155965]
Lr has been adjusted to 0.0005000000237487257
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 3 epochs
Epoch 10/40
381/381 - 738s - loss: 0.6441 - accuracy: 0.5959 - val_loss: 0.7295 - val_accuracy: 0.6774
Confusion matrix: 
 [[712 158]
 [193  25]]
Validation f1: 12.47
Validation accuracy: 67.74
Validation recall: 11.47
Validation precision: 13.66
Validation AUC: 0.1662940189883661
Validation class accuracies: [0.8183908045977012, 0.11467889908256881]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 4 epochs
Epoch 11/40
381/381 - 739s - loss: 0.6233 - accuracy: 0.6207 - val_loss: 1.0556 - val_accuracy: 0.3860
Confusion matrix: 
 [[325 545]
 [123  95]]
Validation f1: 22.14
Validation accuracy: 38.60
Validation recall: 43.58
Validation precision: 14.84
Validation AUC: 0.15533454604683003
Validation class accuracies: [0.3735632183908046, 0.43577981651376146]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 5 epochs
Epoch 12/40
381/381 - 740s - loss: 0.6046 - accuracy: 0.6410 - val_loss: 0.9597 - val_accuracy: 0.4118
Confusion matrix: 
 [[328 542]
 [ 98 120]]
Validation f1: 27.27
Validation accuracy: 41.18
Validation recall: 55.05
Validation precision: 18.13
Validation AUC: 0.1746343412235878
Validation class accuracies: [0.37701149425287356, 0.5504587155963303]
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 6 epochs
Epoch 13/40
381/381 - 738s - loss: 0.5573 - accuracy: 0.6838 - val_loss: 1.2879 - val_accuracy: 0.3520
Confusion matrix: 
 [[226 644]
 [ 61 157]]
Validation f1: 30.81
Validation accuracy: 35.20
Validation recall: 72.02
Validation precision: 19.60
Validation AUC: 0.1869995582176769
Validation class accuracies: [0.2597701149425287, 0.7201834862385321]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 7 epochs
Epoch 14/40
381/381 - 738s - loss: 0.5370 - accuracy: 0.7027 - val_loss: 1.3038 - val_accuracy: 0.3336
Confusion matrix: 
 [[215 655]
 [ 70 148]]
Validation f1: 28.99
Validation accuracy: 33.36
Validation recall: 67.89
Validation precision: 18.43
Validation AUC: 0.17676818675670544
Validation class accuracies: [0.2471264367816092, 0.6788990825688074]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 8 epochs
Epoch 15/40
381/381 - 742s - loss: 0.4960 - accuracy: 0.7349 - val_loss: 1.0688 - val_accuracy: 0.4311
Confusion matrix: 
 [[365 505]
 [114 104]]
Validation f1: 25.15
Validation accuracy: 43.11
Validation recall: 47.71
Validation precision: 17.08
Validation AUC: 0.17391261178230197
Validation class accuracies: [0.41954022988505746, 0.47706422018348627]
Lr has been adjusted to 0.0001250000059371814
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 9 epochs
Epoch 16/40
381/381 - 737s - loss: 0.4433 - accuracy: 0.7745 - val_loss: 1.3790 - val_accuracy: 0.4136
Confusion matrix: 
 [[313 557]
 [ 81 137]]
Validation f1: 30.04
Validation accuracy: 41.36
Validation recall: 62.84
Validation precision: 19.74
Validation AUC: 0.19650041320506356
Validation class accuracies: [0.35977011494252875, 0.6284403669724771]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 10 epochs
Epoch 17/40
381/381 - 739s - loss: 0.4337 - accuracy: 0.7820 - val_loss: 1.4368 - val_accuracy: 0.4081
Confusion matrix: 
 [[317 553]
 [ 91 127]]
Validation f1: 28.29
Validation accuracy: 40.81
Validation recall: 58.26
Validation precision: 18.68
Validation AUC: 0.17648874756567437
Validation class accuracies: [0.364367816091954, 0.5825688073394495]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 11 epochs
Epoch 18/40
381/381 - 740s - loss: 0.4119 - accuracy: 0.7992 - val_loss: 1.4115 - val_accuracy: 0.4357
Confusion matrix: 
 [[356 514]
 [100 118]]
Validation f1: 27.76
Validation accuracy: 43.57
Validation recall: 54.13
Validation precision: 18.67
Validation AUC: 0.18900029350675088
Validation class accuracies: [0.4091954022988506, 0.5412844036697247]
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 12 epochs
Epoch 19/40
381/381 - 739s - loss: 0.3888 - accuracy: 0.8125 - val_loss: 1.3347 - val_accuracy: 0.4770
Confusion matrix: 
 [[407 463]
 [106 112]]
Validation f1: 28.25
Validation accuracy: 47.70
Validation recall: 51.38
Validation precision: 19.48
Validation AUC: 0.19316157443834242
Validation class accuracies: [0.46781609195402296, 0.5137614678899083]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 13 epochs
Epoch 20/40
381/381 - 739s - loss: 0.3659 - accuracy: 0.8267 - val_loss: 1.5286 - val_accuracy: 0.4375
Confusion matrix: 
 [[353 517]
 [ 95 123]]
Validation f1: 28.67
Validation accuracy: 43.75
Validation recall: 56.42
Validation precision: 19.22
Validation AUC: 0.18710576923026492
Validation class accuracies: [0.4057471264367816, 0.5642201834862385]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 14 epochs
Epoch 21/40
381/381 - 740s - loss: 0.3591 - accuracy: 0.8286 - val_loss: 1.5930 - val_accuracy: 0.4421
Confusion matrix: 
 [[358 512]
 [ 95 123]]
Validation f1: 28.84
Validation accuracy: 44.21
Validation recall: 56.42
Validation precision: 19.37
Validation AUC: 0.18439061475503124
Validation class accuracies: [0.4114942528735632, 0.5642201834862385]
Lr has been adjusted to 3.125000148429535e-05
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 15 epochs
Epoch 22/40
381/381 - 738s - loss: 0.3609 - accuracy: 0.8283 - val_loss: 1.4677 - val_accuracy: 0.4733
Confusion matrix: 
 [[403 467]
 [106 112]]
Validation f1: 28.11
Validation accuracy: 47.33
Validation recall: 51.38
Validation precision: 19.34
Validation AUC: 0.19227927860595187
Validation class accuracies: [0.4632183908045977, 0.5137614678899083]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 16 epochs
Epoch 23/40
381/381 - 741s - loss: 0.3385 - accuracy: 0.8383 - val_loss: 1.5949 - val_accuracy: 0.4651
Confusion matrix: 
 [[391 479]
 [103 115]]
Validation f1: 28.33
Validation accuracy: 46.51
Validation recall: 52.75
Validation precision: 19.36
Validation AUC: 0.19126822909214186
Validation class accuracies: [0.4494252873563218, 0.5275229357798165]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 17 epochs
Epoch 24/40
381/381 - 740s - loss: 0.3417 - accuracy: 0.8350 - val_loss: 1.6096 - val_accuracy: 0.4688
Confusion matrix: 
 [[395 475]
 [103 115]]
Validation f1: 28.47
Validation accuracy: 46.88
Validation recall: 52.75
Validation precision: 19.49
Validation AUC: 0.19288735983859862
Validation class accuracies: [0.4540229885057471, 0.5275229357798165]
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 18 epochs
Epoch 25/40
381/381 - 740s - loss: 0.3374 - accuracy: 0.8436 - val_loss: 1.6667 - val_accuracy: 0.4651
Confusion matrix: 
 [[391 479]
 [103 115]]
Validation f1: 28.33
Validation accuracy: 46.51
Validation recall: 52.75
Validation precision: 19.36
Validation AUC: 0.19152856493535383
Validation class accuracies: [0.4494252873563218, 0.5275229357798165]
The validation tracker metric at 0.35928143712574845 hasn't increased by 0.01 in 19 epochs
Epoch 26/40
381/381 - 739s - loss: 0.3493 - accuracy: 0.8416 - val_loss: 1.5037 - val_accuracy: 0.4798
Confusion matrix: 
 [[414 456]
 [110 108]]
Validation f1: 27.62
Validation accuracy: 47.98
Validation recall: 49.54
Validation precision: 19.15
Validation AUC: 0.1932660824597715
Validation class accuracies: [0.47586206896551725, 0.4954128440366973]

The metrics for the epoch with the best target metric are: 
Best cm: [[266 604]
 [ 38 180]]
Best f1: 0.35928143712574845
Best accuracy: 0.4099264705882353
Best recall: 0.8256880733944955
Best precision: 0.22959183673469388
Best AUC: 0.22956800734000218
Best epoch: 6
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 40
Starting...
CM: [[ 1 59]
 [ 0 15]]
F1: 0.3370786516853933
Accuracy: 0.21333333333333335
Precision: 0.20270270270270271
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2115__05_2035__v29__mod9/validation_sheet_40.xls...
Done.
Epoch: 6
Starting...
CM: [[ 2 58]
 [ 0 15]]
F1: 0.3409090909090909
Accuracy: 0.22666666666666666
Precision: 0.2054794520547945
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2115__05_2035__v29__mod9/validation_sheet_6.xls...
Done.

 See logs at ../../new_cache/conv__2115__05_2035__v29__mod9/logs/