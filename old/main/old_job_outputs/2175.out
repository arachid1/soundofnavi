Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2175
Description:  pitchshifting_1000_wclause
2021-06-01 04:22:58.682911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:18: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-01 04:23:03.280592: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-01 04:23:03.282075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-01 04:23:03.370721: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:03.371802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-01 04:23:03.371853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 04:23:03.376907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 04:23:03.377036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-01 04:23:03.378653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-01 04:23:03.379048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-01 04:23:03.380719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-01 04:23:03.381936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-01 04:23:03.382151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 04:23:03.382367: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:03.383584: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:03.384629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2175.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2175__06_0414__v29__pitchshifting_1000_wclause/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.31 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2175
wandb: â­ï¸ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: ðŸš€ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2xf7rjnq
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210601_042303-2xf7rjnq
wandb: Run `wandb offline` to turn off syncing.
2021-06-01 04:23:10.415402: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-01 04:23:10.415796: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:10.416947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-01 04:23:10.417053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 04:23:10.417150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 04:23:10.417215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-01 04:23:10.417259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-01 04:23:10.417298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-01 04:23:10.417335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-01 04:23:10.417372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-01 04:23:10.417410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 04:23:10.431835: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:10.433193: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:10.434240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-01 04:23:10.434335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 04:23:11.494010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-01 04:23:11.494068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-01 04:23:11.494085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-01 04:23:11.494489: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:11.495892: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:11.496960: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 04:23:11.498004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:05.0, compute capability: 7.0)
2021-06-01 04:24:19.494614: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-01 04:24:19.501305: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-01 04:24:20.234074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 04:24:23.115920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 04:24:23.721738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11

Original number of folders: 453
Augmenting audios...
Length of training samples after augmentation: 5196
The new LR is: 0.0008075442648190916
With concat = False and six = False, size of training set: 5196...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/80
325/325 - 205s - loss: 0.6330 - accuracy: 0.7169 - val_loss: 0.6441 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2593432726309194
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
325/325 - 193s - loss: 0.5884 - accuracy: 0.7242 - val_loss: 0.9814 - val_accuracy: 0.7132
Confusion matrix: 
 [[731 139]
 [173  45]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.39
Validation accuracy: 71.32
Validation recall: 20.64
Validation precision: 24.46
Validation AUC: 0.2393283711149242
Validation class accuracies: [0.8402298850574713, 0.20642201834862386]
TARGET: 1
target metric(test f1): 0.22388059701492535
column_sums: [904 184]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 3/80
325/325 - 196s - loss: 0.5861 - accuracy: 0.7250 - val_loss: 0.5261 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20773918113774126
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
325/325 - 202s - loss: 0.5841 - accuracy: 0.7234 - val_loss: 0.6212 - val_accuracy: 0.7960
Confusion matrix: 
 [[865   5]
 [217   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 0.89
Validation accuracy: 79.60
Validation recall: 0.46
Validation precision: 16.67
Validation AUC: 0.22507991674757827
Validation class accuracies: [0.9942528735632183, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.00892857142857143
column_sums: [1082    6]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
325/325 - 203s - loss: 0.5798 - accuracy: 0.7256 - val_loss: 0.5724 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19072338688447993
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
325/325 - 204s - loss: 0.5772 - accuracy: 0.7273 - val_loss: 0.5960 - val_accuracy: 0.7711
Confusion matrix: 
 [[825  45]
 [204  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.11
Validation accuracy: 77.11
Validation recall: 6.42
Validation precision: 23.73
Validation AUC: 0.23610346007829222
Validation class accuracies: [0.9482758620689655, 0.06422018348623854]
TARGET: 1
target metric(test f1): 0.10108303249097474
column_sums: [1029   59]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
325/325 - 205s - loss: 0.5728 - accuracy: 0.7277 - val_loss: 0.5163 - val_accuracy: 0.7941
Confusion matrix: 
 [[857  13]
 [211   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 5.88
Validation accuracy: 79.41
Validation recall: 3.21
Validation precision: 35.00
Validation AUC: 0.2187588140160928
Validation class accuracies: [0.9850574712643678, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.058823529411764705
column_sums: [1068   20]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
325/325 - 209s - loss: 0.5692 - accuracy: 0.7279 - val_loss: 0.5160 - val_accuracy: 0.7877
Confusion matrix: 
 [[850  20]
 [211   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 5.71
Validation accuracy: 78.77
Validation recall: 3.21
Validation precision: 25.93
Validation AUC: 0.24365051518030073
Validation class accuracies: [0.9770114942528736, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.057142857142857155
column_sums: [1061   27]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
325/325 - 211s - loss: 0.5662 - accuracy: 0.7313 - val_loss: 0.6348 - val_accuracy: 0.7151
Confusion matrix: 
 [[739 131]
 [179  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.10
Validation accuracy: 71.51
Validation recall: 17.89
Validation precision: 22.94
Validation AUC: 0.21434246955499298
Validation class accuracies: [0.8494252873563218, 0.17889908256880735]
TARGET: 1
target metric(test f1): 0.20103092783505155
column_sums: [918 170]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22388059701492535 hasn't increased by 0 in 1 epochs
Epoch 10/80
325/325 - 211s - loss: 0.5630 - accuracy: 0.7304 - val_loss: 0.5712 - val_accuracy: 0.7757
Confusion matrix: 
 [[832  38]
 [206  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 8.96
Validation accuracy: 77.57
Validation recall: 5.50
Validation precision: 24.00
Validation AUC: 0.24264386379466776
Validation class accuracies: [0.9563218390804598, 0.05504587155963303]
TARGET: 1
target metric(test f1): 0.08955223880597016
column_sums: [1038   50]
cm_sum: 1088
The training is defaulting to either class.
Epoch 11/80
325/325 - 209s - loss: 0.5599 - accuracy: 0.7304 - val_loss: 0.7618 - val_accuracy: 0.6976
Confusion matrix: 
 [[703 167]
 [162  56]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.40
Validation accuracy: 69.76
Validation recall: 25.69
Validation precision: 25.11
Validation AUC: 0.23867782194791498
Validation class accuracies: [0.8080459770114943, 0.25688073394495414]
TARGET: 1
target metric(test f1): 0.25396825396825395
column_sums: [865 223]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 12/80
325/325 - 171s - loss: 0.5561 - accuracy: 0.7317 - val_loss: 0.5914 - val_accuracy: 0.7252
Confusion matrix: 
 [[750 120]
 [179  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.69
Validation accuracy: 72.52
Validation recall: 17.89
Validation precision: 24.53
Validation AUC: 0.218181922661286
Validation class accuracies: [0.8620689655172413, 0.17889908256880735]
TARGET: 1
target metric(test f1): 0.20689655172413796
column_sums: [929 159]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.25396825396825395 hasn't increased by 0 in 1 epochs
Epoch 13/80
325/325 - 165s - loss: 0.5458 - accuracy: 0.7390 - val_loss: 1.0485 - val_accuracy: 0.5046
Confusion matrix: 
 [[396 474]
 [ 65 153]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.21
Validation accuracy: 50.46
Validation recall: 70.18
Validation precision: 24.40
Validation AUC: 0.2485570262779311
Validation class accuracies: [0.45517241379310347, 0.7018348623853211]
TARGET: 1
target metric(test f1): 0.36213017751479293
column_sums: [461 627]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 14/80
325/325 - 154s - loss: 0.5408 - accuracy: 0.7421 - val_loss: 0.6206 - val_accuracy: 0.6958
Confusion matrix: 
 [[713 157]
 [174  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.00
Validation accuracy: 69.58
Validation recall: 20.18
Validation precision: 21.89
Validation AUC: 0.2374697337534643
Validation class accuracies: [0.8195402298850575, 0.2018348623853211]
TARGET: 1
target metric(test f1): 0.21002386634844872
column_sums: [887 201]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.36213017751479293 hasn't increased by 0 in 1 epochs
Epoch 15/80
325/325 - 153s - loss: 0.5293 - accuracy: 0.7442 - val_loss: 0.7463 - val_accuracy: 0.7022
Confusion matrix: 
 [[722 148]
 [176  42]]
Validation f1: 20.59
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 70.22
Validation recall: 19.27
Validation precision: 22.11
Validation AUC: 0.21943339289634112
Validation class accuracies: [0.8298850574712644, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.2058823529411765
column_sums: [898 190]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.36213017751479293 hasn't increased by 0 in 2 epochs
Epoch 16/80
325/325 - 153s - loss: 0.5155 - accuracy: 0.7517 - val_loss: 0.8115 - val_accuracy: 0.5561
Confusion matrix: 
 [[513 357]
 [126  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.59
Validation accuracy: 55.61
Validation recall: 42.20
Validation precision: 20.49
Validation AUC: 0.2109884369704198
Validation class accuracies: [0.5896551724137931, 0.42201834862385323]
TARGET: 1
target metric(test f1): 0.27586206896551724
column_sums: [639 449]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.36213017751479293 hasn't increased by 0 in 3 epochs
Epoch 17/80
325/325 - 153s - loss: 0.5034 - accuracy: 0.7648 - val_loss: 0.6475 - val_accuracy: 0.7619
Confusion matrix: 
 [[811  59]
 [200  18]]
Validation f1: 12.20
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 76.19
Validation recall: 8.26
Validation precision: 23.38
Validation AUC: 0.21823657936823682
Validation class accuracies: [0.9321839080459771, 0.08256880733944955]
TARGET: 1
target metric(test f1): 0.12203389830508475
column_sums: [1011   77]
cm_sum: 1088
The training is defaulting to either class.
Epoch 18/80
325/325 - 155s - loss: 0.4822 - accuracy: 0.7723 - val_loss: 0.6993 - val_accuracy: 0.7730
Confusion matrix: 
 [[827  43]
 [204  14]]
Validation f1: 10.18
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 77.30
Validation recall: 6.42
Validation precision: 24.56
Validation AUC: 0.19626500596574745
Validation class accuracies: [0.9505747126436782, 0.06422018348623854]
TARGET: 1
target metric(test f1): 0.10181818181818181
column_sums: [1031   57]
cm_sum: 1088
The training is defaulting to either class.
Epoch 19/80
325/325 - 154s - loss: 0.4687 - accuracy: 0.7769 - val_loss: 0.6767 - val_accuracy: 0.6774
Confusion matrix: 
 [[694 176]
 [175  43]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 19.68
Validation accuracy: 67.74
Validation recall: 19.72
Validation precision: 19.63
Validation AUC: 0.20427548354839697
Validation class accuracies: [0.7977011494252874, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.1967963386727689
column_sums: [869 219]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.36213017751479293 hasn't increased by 0 in 4 epochs
Epoch 20/80
325/325 - 156s - loss: 0.4008 - accuracy: 0.8197 - val_loss: 0.7542 - val_accuracy: 0.6544
Confusion matrix: 
 [[659 211]
 [165  53]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 21.99
Validation accuracy: 65.44
Validation recall: 24.31
Validation precision: 20.08
Validation AUC: 0.2152950094248721
Validation class accuracies: [0.7574712643678161, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.21991701244813275
column_sums: [824 264]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.36213017751479293 hasn't increased by 0 in 5 epochs
Epoch 21/80
325/325 - 154s - loss: 0.3707 - accuracy: 0.8353 - val_loss: 0.7127 - val_accuracy: 0.7040
Confusion matrix: 
 [[733 137]
 [185  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.01
Validation accuracy: 70.40
Validation recall: 15.14
Validation precision: 19.41
Validation AUC: 0.2023601742018143
Validation class accuracies: [0.8425287356321839, 0.15137614678899083]
TARGET: 1
target metric(test f1): 0.17010309278350516
column_sums: [918 170]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.36213017751479293 hasn't increased by 0 in 6 epochs
Epoch 22/80
325/325 - 155s - loss: 0.3440 - accuracy: 0.8483 - val_loss: 0.7560 - val_accuracy: 0.6847
Confusion matrix: 
 [[702 168]
 [175  43]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.05
Validation accuracy: 68.47
Validation recall: 19.72
Validation precision: 20.38
Validation AUC: 0.22099126120071622
Validation class accuracies: [0.8068965517241379, 0.19724770642201836]
local_gc_exec.sh: line 6:  9520 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2175__06_0414__v29__pitchshifting_1000_wclause/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
