Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2289
Description:  augmix
2021-07-06 12:49:05.721720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-07-06 12:49:07.884900: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-06 12:49:07.885845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-06 12:49:07.933398: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:07.934102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-06 12:49:07.934131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:49:07.937607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:49:07.937695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-06 12:49:07.938767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-06 12:49:07.939056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-06 12:49:07.940131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-06 12:49:07.941032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-06 12:49:07.941179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:49:07.941282: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:07.941996: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:07.942653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2289.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2289__07_1248__v39__augmix
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-06 12:49:12.593127: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-06 12:49:12.593373: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:12.594122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-06 12:49:12.594164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:49:12.594213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:49:12.594234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-06 12:49:12.594255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-06 12:49:12.594274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-06 12:49:12.594294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-06 12:49:12.594314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-06 12:49:12.594332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:49:12.594418: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:12.595145: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:12.595881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-06 12:49:12.595926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:49:13.289654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-06 12:49:13.289695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-06 12:49:13.289704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-06 12:49:13.289971: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:13.290729: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:13.291418: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:49:13.292112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-07-06 12:49:14.852632: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-07-06 12:49:14.854246: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-06 12:49:15.201781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:49:17.022384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:49:17.471803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 25, 50, 128, 1) 0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 25, 50, 128, 1)  4            input_1[0][0]                        
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 25, 50, 128, 16) 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed (None, 25, 50, 128, 16) 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed (None, 25, 50, 128, 1)  0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed (None, 25, 50, 128, 16) 2320         time_distributed[0][0]               
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed (None, 25, 50, 128, 16) 6416         time_distributed_2[0][0]             
______________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed (None, 25, 50, 128, 16) 32           time_distributed_4[0][0]             
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 25, 50, 128, 48) 0            time_distributed_1[0][0]             
                                                                         time_distributed_3[0][0]             
                                                                         time_distributed_5[0][0]             
______________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed (None, 25, 25, 64, 48)  0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 25, 25, 64, 48)  192          time_distributed_6[0][0]             
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 25, 25, 64, 48)  0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed (None, 25, 48)          0            dropout[0][0]                        
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 25, 256)         181248       time_distributed_7[0][0]             
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 25, 256)         394240       bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 25, 128)         32896        bidirectional_1[0][0]                
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 25, 1)           129          dense[0][0]                          
______________________________________________________________________________________________________________
flatten (Flatten)                   (None, 25)              0            dense_1[0][0]                        
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               26           flatten[0][0]                        
==============================================================================================================
Total params: 617,567
Trainable params: 617,469
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 54s - loss: 0.7815 - accuracy: 0.1347 - val_loss: 1.0002 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.07239172320184684
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 47s - loss: 0.7804 - accuracy: 0.0643 - val_loss: 1.0201 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.06162978078706679
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 47s - loss: 0.7795 - accuracy: 0.0647 - val_loss: 0.8455 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.08330133928827257
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 2 epochs
Epoch 4/65
154/154 - 47s - loss: 0.7816 - accuracy: 0.0643 - val_loss: 0.7847 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.08798312777609132
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 3 epochs
Epoch 5/65
154/154 - 52s - loss: 0.7786 - accuracy: 0.0643 - val_loss: 0.7700 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.17092495886634035
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 4 epochs
Epoch 6/65
154/154 - 58s - loss: 0.7881 - accuracy: 0.1176 - val_loss: 0.8527 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.05701842191226976
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 7/65
154/154 - 58s - loss: 0.7813 - accuracy: 0.0757 - val_loss: 0.8313 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.22002421240113976
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 6 epochs
Epoch 8/65
154/154 - 59s - loss: 0.7862 - accuracy: 0.0765 - val_loss: 0.8165 - val_accuracy: 0.0700
Confusion matrix: 
 [[  2 571]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.003 0.997]
 [0.    1.   ]]
Validation f1: 12.56
Validation accuracy: 7.00
Validation recall: 100.00
Validation precision: 6.70
Validation AUC: 0.22823137542699148
Validation class accuracies: [0.0034904013961605585, 1.0]
Saving model...
Epoch 9/65
154/154 - 58s - loss: 0.7810 - accuracy: 0.0724 - val_loss: 0.8037 - val_accuracy: 0.0749
Confusion matrix: 
 [[  5 568]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.009 0.991]
 [0.    1.   ]]
Validation f1: 12.62
Validation accuracy: 7.49
Validation recall: 100.00
Validation precision: 6.73
Validation AUC: 0.24327023396126707
Validation class accuracies: [0.008726003490401396, 1.0]
Saving model...
Epoch 10/65
154/154 - 58s - loss: 0.7788 - accuracy: 0.1143 - val_loss: 0.7968 - val_accuracy: 0.0831
Confusion matrix: 
 [[ 10 563]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.017 0.983]
 [0.    1.   ]]
Validation f1: 12.71
Validation accuracy: 8.31
Validation recall: 100.00
Validation precision: 6.79
Validation AUC: 0.16904829184748155
Validation class accuracies: [0.017452006980802792, 1.0]
Saving model...
Epoch 11/65
154/154 - 60s - loss: 0.7781 - accuracy: 0.1241 - val_loss: 0.8032 - val_accuracy: 0.0945
Confusion matrix: 
 [[ 17 556]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.03 0.97]
 [0.   1.  ]]
Validation f1: 12.85
Validation accuracy: 9.45
Validation recall: 100.00
Validation precision: 6.87
Validation AUC: 0.24652732316693088
Validation class accuracies: [0.029668411867364748, 1.0]
Saving model...
Epoch 12/65
154/154 - 59s - loss: 0.7860 - accuracy: 0.1139 - val_loss: 0.8057 - val_accuracy: 0.1221
Confusion matrix: 
 [[ 38 535]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.066 0.934]
 [0.098 0.902]]
Validation f1: 12.07
Validation accuracy: 12.21
Validation recall: 90.24
Validation precision: 6.47
Validation AUC: 0.2427712225633474
Validation class accuracies: [0.06631762652705062, 0.9024390243902439]
The validation tracker metric at 0.12852664576802506 hasn't increased by 0 in 1 epochs
Epoch 13/65
154/154 - 59s - loss: 0.7795 - accuracy: 0.2327 - val_loss: 0.7805 - val_accuracy: 0.4886
Confusion matrix: 
 [[273 300]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.476 0.524]
 [0.341 0.659]]
Validation f1: 14.67
Validation accuracy: 48.86
Validation recall: 65.85
Validation precision: 8.26
Validation AUC: 0.19009820617417716
Validation class accuracies: [0.47643979057591623, 0.6585365853658537]
Saving model...
Epoch 14/65
154/154 - 58s - loss: 0.7700 - accuracy: 0.2124 - val_loss: 0.8004 - val_accuracy: 0.1515
Confusion matrix: 
 [[ 52 521]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.091 0.909]
 [0.    1.   ]]
Validation f1: 13.60
Validation accuracy: 15.15
Validation recall: 100.00
Validation precision: 7.30
Validation AUC: 0.07472960803839697
Validation class accuracies: [0.09075043630017451, 1.0]
The validation tracker metric at 0.1467391304347826 hasn't increased by 0 in 1 epochs
Epoch 15/65
154/154 - 58s - loss: 0.7732 - accuracy: 0.2327 - val_loss: 0.8027 - val_accuracy: 0.2313
Confusion matrix: 
 [[102 471]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.178 0.822]
 [0.024 0.976]]
Validation f1: 14.49
Validation accuracy: 23.13
Validation recall: 97.56
Validation precision: 7.83
Validation AUC: 0.07254572451087653
Validation class accuracies: [0.17801047120418848, 0.975609756097561]
The validation tracker metric at 0.1467391304347826 hasn't increased by 0 in 2 epochs
Epoch 16/65
154/154 - 58s - loss: 0.7675 - accuracy: 0.3446 - val_loss: 0.8054 - val_accuracy: 0.1906
Confusion matrix: 
 [[ 76 497]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.133 0.867]
 [0.    1.   ]]
Validation f1: 14.16
Validation accuracy: 19.06
Validation recall: 100.00
Validation precision: 7.62
Validation AUC: 0.07498362085625421
Validation class accuracies: [0.13263525305410123, 1.0]
The validation tracker metric at 0.1467391304347826 hasn't increased by 0 in 3 epochs
Epoch 17/65
154/154 - 58s - loss: 0.7700 - accuracy: 0.3548 - val_loss: 0.8089 - val_accuracy: 0.1417
Confusion matrix: 
 [[ 46 527]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.08 0.92]
 [0.   1.  ]]
Validation f1: 13.46
Validation accuracy: 14.17
Validation recall: 100.00
Validation precision: 7.22
Validation AUC: 0.07828275522460137
Validation class accuracies: [0.08027923211169284, 1.0]
The validation tracker metric at 0.1467391304347826 hasn't increased by 0 in 4 epochs
Epoch 18/65
154/154 - 58s - loss: 0.7669 - accuracy: 0.3629 - val_loss: 0.7898 - val_accuracy: 0.3827
Confusion matrix: 
 [[199 374]
 [  5  36]]
Normalized Confusion matrix: 
 [[0.347 0.653]
 [0.122 0.878]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 15.96
Validation accuracy: 38.27
Validation recall: 87.80
Validation precision: 8.78
Validation AUC: 0.13777209835390902
Validation class accuracies: [0.3472949389179756, 0.8780487804878049]
Saving model...
Epoch 19/65
154/154 - 58s - loss: 0.7658 - accuracy: 0.4015 - val_loss: 0.8068 - val_accuracy: 0.3225
Confusion matrix: 
 [[157 416]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.274 0.726]
 [0.    1.   ]]
Validation f1: 16.47
Validation accuracy: 32.25
Validation recall: 100.00
Validation precision: 8.97
Validation AUC: 0.07770232050928749
Validation class accuracies: [0.27399650959860383, 1.0]
Saving model...
Epoch 20/65
154/154 - 58s - loss: 0.7678 - accuracy: 0.4382 - val_loss: 0.8059 - val_accuracy: 0.3697
Confusion matrix: 
 [[189 384]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.33  0.67 ]
 [0.073 0.927]]
Validation f1: 16.41
Validation accuracy: 36.97
Validation recall: 92.68
Validation precision: 9.00
Validation AUC: 0.074444826151519
Validation class accuracies: [0.3298429319371728, 0.926829268292683]
The validation tracker metric at 0.16465863453815263 hasn't increased by 0 in 1 epochs
Epoch 21/65
154/154 - 58s - loss: 0.7617 - accuracy: 0.4520 - val_loss: 0.8095 - val_accuracy: 0.3388
Confusion matrix: 
 [[168 405]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.293 0.707]
 [0.024 0.976]]
Validation f1: 16.46
Validation accuracy: 33.88
Validation recall: 97.56
Validation precision: 8.99
Validation AUC: 0.07441398670108246
Validation class accuracies: [0.2931937172774869, 0.975609756097561]
The validation tracker metric at 0.16465863453815263 hasn't increased by 0 in 2 epochs
Epoch 22/65
154/154 - 58s - loss: 0.7587 - accuracy: 0.4740 - val_loss: 0.8074 - val_accuracy: 0.3436
Confusion matrix: 
 [[170 403]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.297 0.703]
 [0.    1.   ]]
Validation f1: 16.91
Validation accuracy: 34.36
Validation recall: 100.00
Validation precision: 9.23
Validation AUC: 0.09278049354415034
Validation class accuracies: [0.29668411867364747, 1.0]
Saving model...
Epoch 23/65
154/154 - 57s - loss: 0.7597 - accuracy: 0.4784 - val_loss: 0.7960 - val_accuracy: 0.3746
Confusion matrix: 
 [[190 383]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.332 0.668]
 [0.024 0.976]]
Validation f1: 17.24
Validation accuracy: 37.46
Validation recall: 97.56
Validation precision: 9.46
Validation AUC: 0.0778842823982029
Validation class accuracies: [0.33158813263525305, 0.975609756097561]
Saving model...
Epoch 24/65
154/154 - 58s - loss: 0.7512 - accuracy: 0.4988 - val_loss: 0.7938 - val_accuracy: 0.4007
Confusion matrix: 
 [[207 366]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.361 0.639]
 [0.049 0.951]]
Validation f1: 17.49
Validation accuracy: 40.07
Validation recall: 95.12
Validation precision: 9.63
Validation AUC: 0.09437012369957407
Validation class accuracies: [0.3612565445026178, 0.9512195121951219]
Saving model...
Epoch 25/65
154/154 - 58s - loss: 0.7588 - accuracy: 0.4955 - val_loss: 0.7859 - val_accuracy: 0.4251
Confusion matrix: 
 [[223 350]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.389 0.611]
 [0.073 0.927]]
Validation f1: 17.72
Validation accuracy: 42.51
Validation recall: 92.68
Validation precision: 9.79
Validation AUC: 0.12584512388720293
Validation class accuracies: [0.38917975567190227, 0.926829268292683]
Saving model...
Epoch 26/65
154/154 - 58s - loss: 0.7496 - accuracy: 0.5191 - val_loss: 0.7919 - val_accuracy: 0.4072
Confusion matrix: 
 [[210 363]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.366 0.634]
 [0.024 0.976]]
Validation f1: 18.02
Validation accuracy: 40.72
Validation recall: 97.56
Validation precision: 9.93
Validation AUC: 0.09635721489201991
Validation class accuracies: [0.36649214659685864, 0.975609756097561]
Saving model...
Epoch 27/65
154/154 - 57s - loss: 0.7494 - accuracy: 0.5175 - val_loss: 0.7856 - val_accuracy: 0.4397
Confusion matrix: 
 [[233 340]
 [  4  37]]
Normalized Confusion matrix: 
 [[0.407 0.593]
 [0.098 0.902]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.70
Validation accuracy: 43.97
Validation recall: 90.24
Validation precision: 9.81
Validation AUC: 0.07675697722235628
Validation class accuracies: [0.40663176265270506, 0.9024390243902439]
The validation tracker metric at 0.18018018018018017 hasn't increased by 0 in 1 epochs
Epoch 28/65
154/154 - 58s - loss: 0.7540 - accuracy: 0.5244 - val_loss: 0.7913 - val_accuracy: 0.4039
Confusion matrix: 
 [[207 366]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.361 0.639]
 [0.    1.   ]]
Validation f1: 18.30
Validation accuracy: 40.39
Validation recall: 100.00
Validation precision: 10.07
Validation AUC: 0.07989024072362354
Validation class accuracies: [0.3612565445026178, 1.0]
Saving model...
Epoch 29/65
154/154 - 58s - loss: 0.7481 - accuracy: 0.5240 - val_loss: 0.7909 - val_accuracy: 0.3893
Confusion matrix: 
 [[198 375]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.346 0.654]
 [0.    1.   ]]
Validation f1: 17.94
Validation accuracy: 38.93
Validation recall: 100.00
Validation precision: 9.86
Validation AUC: 0.07931270225432169
Validation class accuracies: [0.34554973821989526, 1.0]
The validation tracker metric at 0.18303571428571427 hasn't increased by 0 in 1 epochs
Epoch 30/65
154/154 - 57s - loss: 0.7484 - accuracy: 0.5183 - val_loss: 0.7900 - val_accuracy: 0.4055
Confusion matrix: 
 [[210 363]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.366 0.634]
 [0.049 0.951]]
Validation f1: 17.61
Validation accuracy: 40.55
Validation recall: 95.12
Validation precision: 9.70
Validation AUC: 0.07799388034454369
Validation class accuracies: [0.36649214659685864, 0.9512195121951219]
The validation tracker metric at 0.18303571428571427 hasn't increased by 0 in 2 epochs
Epoch 31/65
154/154 - 57s - loss: 0.7507 - accuracy: 0.5578 - val_loss: 0.7854 - val_accuracy: 0.4153
Confusion matrix: 
 [[216 357]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.377 0.623]
 [0.049 0.951]]
Validation f1: 17.85
Validation accuracy: 41.53
Validation recall: 95.12
Validation precision: 9.85
Validation AUC: 0.08005952492784904
Validation class accuracies: [0.3769633507853403, 0.9512195121951219]
The validation tracker metric at 0.18303571428571427 hasn't increased by 0 in 3 epochs
Epoch 32/65
154/154 - 58s - loss: 0.7507 - accuracy: 0.5704 - val_loss: 0.7808 - val_accuracy: 0.3974
Confusion matrix: 
 [[203 370]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.354 0.646]
 [0.    1.   ]]
Validation f1: 18.14
Validation accuracy: 39.74
Validation recall: 100.00
Validation precision: 9.98
Validation AUC: 0.10503329029743322
Validation class accuracies: [0.3542757417102967, 1.0]
The validation tracker metric at 0.18303571428571427 hasn't increased by 0 in 4 epochs
Epoch 33/65
154/154 - 57s - loss: 0.7474 - accuracy: 0.5521 - val_loss: 0.7812 - val_accuracy: 0.4365
Confusion matrix: 
 [[229 344]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.4   0.6  ]
 [0.049 0.951]]
Validation f1: 18.40
Validation accuracy: 43.65
Validation recall: 95.12
Validation precision: 10.18
Validation AUC: 0.0981797884551471
Validation class accuracies: [0.39965095986038396, 0.9512195121951219]
Saving model...
Epoch 34/65
154/154 - 57s - loss: 0.7461 - accuracy: 0.5667 - val_loss: 0.7929 - val_accuracy: 0.4381
Confusion matrix: 
 [[230 343]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.401 0.599]
 [0.049 0.951]]
Validation f1: 18.44
Validation accuracy: 43.81
Validation recall: 95.12
Validation precision: 10.21
Validation AUC: 0.08939913001908628
Validation class accuracies: [0.4013961605584642, 0.9512195121951219]
Saving model...
Epoch 35/65
154/154 - 57s - loss: 0.7398 - accuracy: 0.5602 - val_loss: 0.7918 - val_accuracy: 0.4121
Confusion matrix: 
 [[214 359]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.373 0.627]
 [0.049 0.951]]
Validation f1: 17.77
Validation accuracy: 41.21
Validation recall: 95.12
Validation precision: 9.80
Validation AUC: 0.14794079739553995
Validation class accuracies: [0.37347294938917974, 0.9512195121951219]
The validation tracker metric at 0.18439716312056736 hasn't increased by 0 in 1 epochs
Epoch 36/65
154/154 - 58s - loss: 0.7490 - accuracy: 0.5602 - val_loss: 0.7699 - val_accuracy: 0.4528
Confusion matrix: 
 [[239 334]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.417 0.583]
 [0.049 0.951]]
Validation f1: 18.84
Validation accuracy: 45.28
Validation recall: 95.12
Validation precision: 10.46
Validation AUC: 0.09299498515947088
Validation class accuracies: [0.41710296684118675, 0.9512195121951219]
Saving model...
Epoch 37/65
154/154 - 58s - loss: 0.7423 - accuracy: 0.5924 - val_loss: 0.7662 - val_accuracy: 0.4593
Confusion matrix: 
 [[245 328]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.428 0.572]
 [0.098 0.902]]
Validation f1: 18.23
Validation accuracy: 45.93
Validation recall: 90.24
Validation precision: 10.14
Validation AUC: 0.0977027316053495
Validation class accuracies: [0.42757417102966844, 0.9024390243902439]
The validation tracker metric at 0.18840579710144928 hasn't increased by 0 in 1 epochs
Epoch 38/65
154/154 - 57s - loss: 0.7438 - accuracy: 0.5797 - val_loss: 0.7554 - val_accuracy: 0.4446
Confusion matrix: 
 [[235 338]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.41  0.59 ]
 [0.073 0.927]]
Validation f1: 18.23
Validation accuracy: 44.46
Validation recall: 92.68
Validation precision: 10.11
Validation AUC: 0.09143174750656943
Validation class accuracies: [0.41012216404886565, 0.926829268292683]
The validation tracker metric at 0.18840579710144928 hasn't increased by 0 in 2 epochs
Epoch 39/65
154/154 - 57s - loss: 0.7443 - accuracy: 0.5907 - val_loss: 0.7551 - val_accuracy: 0.4691
Confusion matrix: 
 [[250 323]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.436 0.564]
 [0.073 0.927]]
Validation f1: 18.91
Validation accuracy: 46.91
Validation recall: 92.68
Validation precision: 10.53
Validation AUC: 0.09023444981556952
Validation class accuracies: [0.4363001745200698, 0.926829268292683]
Saving model...
Epoch 40/65
154/154 - 58s - loss: 0.7407 - accuracy: 0.5976 - val_loss: 0.7651 - val_accuracy: 0.4332
Confusion matrix: 
 [[227 346]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.396 0.604]
 [0.049 0.951]]
Validation f1: 18.31
Validation accuracy: 43.32
Validation recall: 95.12
Validation precision: 10.13
Validation AUC: 0.1014683733639658
Validation class accuracies: [0.3961605584642234, 0.9512195121951219]
The validation tracker metric at 0.1890547263681592 hasn't increased by 0 in 1 epochs
Epoch 41/65
154/154 - 57s - loss: 0.7460 - accuracy: 0.5578 - val_loss: 0.7618 - val_accuracy: 0.4723
Confusion matrix: 
 [[252 321]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.44  0.56 ]
 [0.073 0.927]]
Validation f1: 19.00
Validation accuracy: 47.23
Validation recall: 92.68
Validation precision: 10.58
Validation AUC: 0.09936688434445756
Validation class accuracies: [0.4397905759162304, 0.926829268292683]
Saving model...
Epoch 42/65
154/154 - 57s - loss: 0.7417 - accuracy: 0.5797 - val_loss: 0.7722 - val_accuracy: 0.4332
Confusion matrix: 
 [[228 345]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.398 0.602]
 [0.073 0.927]]
Validation f1: 17.92
Validation accuracy: 43.32
Validation recall: 92.68
Validation precision: 9.92
Validation AUC: 0.08785264510757129
Validation class accuracies: [0.39790575916230364, 0.926829268292683]
The validation tracker metric at 0.18999999999999997 hasn't increased by 0 in 1 epochs
Epoch 43/65
154/154 - 57s - loss: 0.7425 - accuracy: 0.5500 - val_loss: 0.7758 - val_accuracy: 0.4625
Confusion matrix: 
 [[246 327]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.429 0.571]
 [0.073 0.927]]
Validation f1: 18.72
Validation accuracy: 46.25
Validation recall: 92.68
Validation precision: 10.41
Validation AUC: 0.11356465495794486
Validation class accuracies: [0.4293193717277487, 0.926829268292683]
The validation tracker metric at 0.18999999999999997 hasn't increased by 0 in 2 epochs
Epoch 44/65
154/154 - 50s - loss: 0.7407 - accuracy: 0.5903 - val_loss: 0.7630 - val_accuracy: 0.4463
Confusion matrix: 
 [[235 338]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.41  0.59 ]
 [0.049 0.951]]
Validation f1: 18.66
Validation accuracy: 44.63
Validation recall: 95.12
Validation precision: 10.34
Validation AUC: 0.09477193006156431
Validation class accuracies: [0.41012216404886565, 0.9512195121951219]
The validation tracker metric at 0.18999999999999997 hasn't increased by 0 in 3 epochs
Epoch 45/65
154/154 - 46s - loss: 0.7437 - accuracy: 0.5704 - val_loss: 0.7576 - val_accuracy: 0.4283
Confusion matrix: 
 [[224 349]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.391 0.609]
 [0.049 0.951]]
Validation f1: 18.18
Validation accuracy: 42.83
Validation recall: 95.12
Validation precision: 10.05
Validation AUC: 0.113112764946563
Validation class accuracies: [0.39092495636998253, 0.9512195121951219]
The validation tracker metric at 0.18999999999999997 hasn't increased by 0 in 4 epochs
Epoch 46/65
154/154 - 46s - loss: 0.7405 - accuracy: 0.5883 - val_loss: 0.7402 - val_accuracy: 0.5000
Confusion matrix: 
 [[271 302]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.473 0.527]
 [0.122 0.878]]
Validation f1: 19.00
Validation accuracy: 50.00
Validation recall: 87.80
Validation precision: 10.65
Validation AUC: 0.1752558175692174
Validation class accuracies: [0.47294938917975565, 0.8780487804878049]
The validation tracker metric at 0.18999999999999997 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 47/65
154/154 - 46s - loss: 0.7415 - accuracy: 0.6062 - val_loss: 0.7441 - val_accuracy: 0.4902
Confusion matrix: 
 [[263 310]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.459 0.541]
 [0.073 0.927]]
Validation f1: 19.54
Validation accuracy: 49.02
Validation recall: 92.68
Validation precision: 10.92
Validation AUC: 0.1672114050793695
Validation class accuracies: [0.45898778359511344, 0.926829268292683]
Saving model...
Epoch 48/65
154/154 - 46s - loss: 0.7395 - accuracy: 0.6062 - val_loss: 0.7407 - val_accuracy: 0.5000
Confusion matrix: 
 [[270 303]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.471 0.529]
 [0.098 0.902]]
Validation f1: 19.42
Validation accuracy: 50.00
Validation recall: 90.24
Validation precision: 10.88
Validation AUC: 0.17475554449283467
Validation class accuracies: [0.4712041884816754, 0.9024390243902439]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 1 epochs
Epoch 49/65
154/154 - 46s - loss: 0.7397 - accuracy: 0.6046 - val_loss: 0.7464 - val_accuracy: 0.4707
Confusion matrix: 
 [[251 322]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.438 0.562]
 [0.073 0.927]]
Validation f1: 18.95
Validation accuracy: 47.07
Validation recall: 92.68
Validation precision: 10.56
Validation AUC: 0.16294179624014274
Validation class accuracies: [0.43804537521815007, 0.926829268292683]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 2 epochs
Epoch 50/65
154/154 - 46s - loss: 0.7412 - accuracy: 0.5838 - val_loss: 0.7498 - val_accuracy: 0.4756
Confusion matrix: 
 [[254 319]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.443 0.557]
 [0.073 0.927]]
Validation f1: 19.10
Validation accuracy: 47.56
Validation recall: 92.68
Validation precision: 10.64
Validation AUC: 0.11450594098541068
Validation class accuracies: [0.4432809773123909, 0.926829268292683]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 3 epochs
Epoch 51/65
154/154 - 46s - loss: 0.7384 - accuracy: 0.6082 - val_loss: 0.7497 - val_accuracy: 0.4625
Confusion matrix: 
 [[246 327]
 [  3  38]]
Normalized Confusion matrix: 
 [[0.429 0.571]
 [0.073 0.927]]
Validation f1: 18.72
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 46.25
Validation recall: 92.68
Validation precision: 10.41
Validation AUC: 0.13001119814713435
Validation class accuracies: [0.4293193717277487, 0.926829268292683]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 4 epochs
Epoch 52/65
154/154 - 46s - loss: 0.7444 - accuracy: 0.6208 - val_loss: 0.7478 - val_accuracy: 0.4772
Confusion matrix: 
 [[255 318]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.445 0.555]
 [0.073 0.927]]
Validation f1: 19.14
Validation accuracy: 47.72
Validation recall: 92.68
Validation precision: 10.67
Validation AUC: 0.14300151093714086
Validation class accuracies: [0.44502617801047123, 0.926829268292683]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 53/65
154/154 - 47s - loss: 0.7426 - accuracy: 0.5952 - val_loss: 0.7491 - val_accuracy: 0.4739
Confusion matrix: 
 [[253 320]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.442 0.558]
 [0.073 0.927]]
Validation f1: 19.05
Validation accuracy: 47.39
Validation recall: 92.68
Validation precision: 10.61
Validation AUC: 0.12888561694911793
Validation class accuracies: [0.44153577661431065, 0.926829268292683]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 6 epochs
Epoch 54/65
154/154 - 46s - loss: 0.7317 - accuracy: 0.6094 - val_loss: 0.7479 - val_accuracy: 0.4837
Confusion matrix: 
 [[259 314]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.452 0.548]
 [0.073 0.927]]
Validation f1: 19.34
Validation accuracy: 48.37
Validation recall: 92.68
Validation precision: 10.80
Validation AUC: 0.1268035345431378
Validation class accuracies: [0.45200698080279234, 0.926829268292683]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 7 epochs
Epoch 55/65
154/154 - 44s - loss: 0.7380 - accuracy: 0.6086 - val_loss: 0.7467 - val_accuracy: 0.4886
Confusion matrix: 
 [[262 311]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.457 0.543]
 [0.073 0.927]]
Validation f1: 19.49
Validation accuracy: 48.86
Validation recall: 92.68
Validation precision: 10.89
Validation AUC: 0.1299453270176407
Validation class accuracies: [0.4572425828970332, 0.926829268292683]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 8 epochs
Epoch 56/65
154/154 - 43s - loss: 0.7412 - accuracy: 0.6131 - val_loss: 0.7471 - val_accuracy: 0.4886
Confusion matrix: 
 [[262 311]
 [  3  38]]
Normalized Confusion matrix: 
 [[0.457 0.543]
 [0.073 0.927]]
Validation f1: 19.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 48.86
Validation recall: 92.68
Validation precision: 10.89
Validation AUC: 0.12685805543058773
Validation class accuracies: [0.4572425828970332, 0.926829268292683]
The validation tracker metric at 0.19537275064267354 hasn't increased by 0 in 9 epochs
Epoch 57/65
154/154 - 44s - loss: 0.7360 - accuracy: 0.6147 - val_loss: 0.7456 - val_accuracy: 0.4984
Confusion matrix: 
 [[268 305]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.468 0.532]
 [0.073 0.927]]
Validation f1: 19.79
Validation accuracy: 49.84
Validation recall: 92.68
Validation precision: 11.08
Validation AUC: 0.12983623086974955
Validation class accuracies: [0.4677137870855148, 0.926829268292683]
Saving model...
Epoch 58/65
154/154 - 43s - loss: 0.7412 - accuracy: 0.6184 - val_loss: 0.7465 - val_accuracy: 0.4919
Confusion matrix: 
 [[264 309]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.461 0.539]
 [0.073 0.927]]
Validation f1: 19.59
Validation accuracy: 49.19
Validation recall: 92.68
Validation precision: 10.95
Validation AUC: 0.1273416483644433
Validation class accuracies: [0.4607329842931937, 0.926829268292683]
The validation tracker metric at 0.19791666666666666 hasn't increased by 0 in 1 epochs
Epoch 59/65
154/154 - 43s - loss: 0.7428 - accuracy: 0.6115 - val_loss: 0.7457 - val_accuracy: 0.4967
Confusion matrix: 
 [[267 306]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.466 0.534]
 [0.073 0.927]]
Validation f1: 19.74
Validation accuracy: 49.67
Validation recall: 92.68
Validation precision: 11.05
Validation AUC: 0.12710303342709445
Validation class accuracies: [0.46596858638743455, 0.926829268292683]
The validation tracker metric at 0.19791666666666666 hasn't increased by 0 in 2 epochs
Epoch 60/65
154/154 - 43s - loss: 0.7383 - accuracy: 0.6143 - val_loss: 0.7469 - val_accuracy: 0.4870
Confusion matrix: 
 [[261 312]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.455 0.545]
 [0.073 0.927]]
Validation f1: 19.44
Validation accuracy: 48.70
Validation recall: 92.68
Validation precision: 10.86
Validation AUC: 0.12966292772047236
Validation class accuracies: [0.45549738219895286, 0.926829268292683]
The validation tracker metric at 0.19791666666666666 hasn't increased by 0 in 3 epochs
Epoch 61/65
154/154 - 43s - loss: 0.7400 - accuracy: 0.6062 - val_loss: 0.7460 - val_accuracy: 0.4919
Confusion matrix: 
 [[264 309]
 [  3  38]]
Normalized Confusion matrix: 
 [[0.461 0.539]
 [0.073 0.927]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 19.59
Validation accuracy: 49.19
Validation recall: 92.68
Validation precision: 10.95
Validation AUC: 0.12974976067178104
Validation class accuracies: [0.4607329842931937, 0.926829268292683]
The validation tracker metric at 0.19791666666666666 hasn't increased by 0 in 4 epochs
Epoch 62/65
154/154 - 43s - loss: 0.7367 - accuracy: 0.6204 - val_loss: 0.7457 - val_accuracy: 0.4935
Confusion matrix: 
 [[265 308]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.462 0.538]
 [0.073 0.927]]
Validation f1: 19.64
Validation accuracy: 49.35
Validation recall: 92.68
Validation precision: 10.98
Validation AUC: 0.11902838740007533
Validation class accuracies: [0.462478184991274, 0.926829268292683]
The validation tracker metric at 0.19791666666666666 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 3.906250185536919e-06
Epoch 63/65
154/154 - 43s - loss: 0.7326 - accuracy: 0.6155 - val_loss: 0.7450 - val_accuracy: 0.4935
Confusion matrix: 
 [[265 308]
 [  3  38]]
Normalized Confusion matrix: 
 [[0.462 0.538]
 [0.073 0.927]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 19.64
Validation accuracy: 49.35
Validation recall: 92.68
Validation precision: 10.98
Validation AUC: 0.13030245917081074
Validation class accuracies: [0.462478184991274, 0.926829268292683]
The validation tracker metric at 0.19791666666666666 hasn't increased by 0 in 6 epochs
Epoch 64/65
154/154 - 43s - loss: 0.7339 - accuracy: 0.6155 - val_loss: 0.7469 - val_accuracy: 0.4902
Confusion matrix: 
 [[263 310]
 [  3  38]]
Normalized Confusion matrix: 
 [[0.459 0.541]
 [0.073 0.927]]
Validation f1: 19.54
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 49.02
Validation recall: 92.68
Validation precision: 10.92
Validation AUC: 0.11708647784504644
Validation class accuracies: [0.45898778359511344, 0.926829268292683]
The validation tracker metric at 0.19791666666666666 hasn't increased by 0 in 7 epochs
Epoch 65/65
154/154 - 43s - loss: 0.7381 - accuracy: 0.6196 - val_loss: 0.7474 - val_accuracy: 0.4870
Confusion matrix: 
 [[261 312]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.455 0.545]
 [0.073 0.927]]
Validation f1: 19.44
Validation accuracy: 48.70
Validation recall: 92.68
Validation precision: 10.86
Validation AUC: 0.11857127208029616
Validation class accuracies: [0.45549738219895286, 0.926829268292683]

The metrics for job 0 with the best target metric are: 
Best cm: [[268 305]
 [  3  38]]
Best normalized cm: [[0.468 0.532]
 [0.073 0.927]]
Best f1: 0.20
Best accuracy: 0.50
Best recall: 0.93
Best precision: 0.11
Best AUC: 0.13
Best class accuracies: [0.4677137870855148, 0.926829268292683]
Best epoch: 57
The validation tracker metric at 0.19791666666666666 hasn't increased by 0 in 8 epochs
wandb: Waiting for W&B process to finish, PID 4560
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_124908-1euqbsg2/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_124908-1euqbsg2/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.61961
wandb:         val_accuracy 0.48697
wandb:             _runtime 4135
wandb:           _timestamp 1625579883
wandb:                _step 517
wandb:           train_loss 0.7381
wandb:             val_loss 0.74741
wandb:           val_recall 0.92683
wandb:        val_precision 0.10857
wandb:               val_f1 0.19437
wandb:              val_auc 0.11857
wandb:                   lr 0.0
wandb:          best_val_f1 0.19792
wandb:    best_val_accuracy 0.49837
wandb:   best_val_precision 0.11079
wandb:      best_val_recall 0.92683
wandb:             best_auc 0.12984
wandb:           best_epoch 57
wandb: Run history:
wandb:   train_accuracy ▂▁▁▁▁▁▂▂▃▃▅▅▆▆▆▆▇▇▇▇▇▇█▇█▇▇▇████████████
wandb:     val_accuracy ▁▁▁▁▁▁▁▂▂▄▂▅▆▅▆▇▇▆▆▆▇▇▇▇▇▇▇▇███▇████████
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ▇▇▇▇▇▇▇█▆▆▆▅▆▄▅▄▃▄▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▂
wandb:         val_loss ██▂▂▃▃▂▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ███████▂█▇██▄█▇▄▂█▅█▅▅▂▄▅▄▄▅▁▂▄▄▄▄▄▄▄▄▄▄
wandb:    val_precision ▁▁▁▁▁▁▁▁▂▃▂▅▅▅▆▆▆▇▆▆▇▆▇▇▇▆▇▇▇█▇▇▇███████
wandb:           val_f1 ▁▁▁▁▁▂▂▁▂▃▂▅▅▅▆▆▆▇▆▇▇▆▇▇▇▆▇▇▇█▇▇▇███████
wandb:          val_auc ▁▁▂▅▇█▅█▂▁▂▂▁▂▂▃▂▂▂▃▂▄▂▂▃▂▃▃▅▅▃▄▄▄▄▄▄▄▄▃
wandb:               lr ████▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_124908-1euqbsg2


 See logs at ../../new_cache/conv__2289__07_1248__v39__augmix/logs/