Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2258
Description:  lstm
2021-06-27 16:30:07.977395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-27 16:30:10.600221: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 16:30:10.601171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-27 16:30:10.648941: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:10.649669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 16:30:10.649695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 16:30:10.653135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 16:30:10.653221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 16:30:10.654276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 16:30:10.654565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 16:30:10.655601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 16:30:10.656470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 16:30:10.656629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 16:30:10.656731: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:10.657485: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:10.658149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2258.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2258__06_1629__v39__lstm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-27 16:30:15.910019: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-27 16:30:15.910352: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:15.911556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-27 16:30:15.911624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 16:30:15.911708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 16:30:15.911737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-27 16:30:15.911773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-27 16:30:15.911801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-27 16:30:15.911836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-27 16:30:15.911864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-27 16:30:15.911895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 16:30:15.912022: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:15.912854: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:15.913530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-27 16:30:15.913582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-27 16:30:16.632228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-27 16:30:16.632271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-27 16:30:16.632279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-27 16:30:16.632549: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:16.633347: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:16.634064: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-27 16:30:16.634688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-27 16:30:18.443347: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-27 16:30:18.444916: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-27 16:30:18.888521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-27 16:30:21.243558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-27 16:30:21.759595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 10, 125, 128, 1)]                   0                
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)               (None, 10, 125, 128, 16)                    160              
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed)             (None, 10, 125, 128, 16)                    414              
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed)             (None, 10, 63, 64, 16)                      0                
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed)             (None, 10, 63, 64, 16)                      64               
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed)             (None, 10, 16)                              0                
______________________________________________________________________________________________________________
bidirectional (Bidirectional)                    (None, 10, 256)                             148480           
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)                  (None, 10, 256)                             394240           
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 10, 128)                             32896            
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 10, 1)                               129              
______________________________________________________________________________________________________________
flatten (Flatten)                                (None, 10)                                  0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   11               
==============================================================================================================
Total params: 576,394
Trainable params: 576,362
Non-trainable params: 32
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 95s - loss: 0.7933 - accuracy: 0.1086 - val_loss: 0.7827 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.07421653142918339
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
154/154 - 91s - loss: 0.7765 - accuracy: 0.1127 - val_loss: 0.8479 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.3779056154265173
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
154/154 - 93s - loss: 0.7149 - accuracy: 0.4235 - val_loss: 0.7465 - val_accuracy: 0.4463
Confusion matrix: 
 [[235 338]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.41  0.59 ]
 [0.049 0.951]]
Validation f1: 18.66
Validation accuracy: 44.63
Validation recall: 95.12
Validation precision: 10.34
Validation AUC: 0.11062564700638065
Validation class accuracies: [0.41012216404886565, 0.9512195121951219]
Saving model...
Epoch 4/65
154/154 - 90s - loss: 0.7509 - accuracy: 0.3983 - val_loss: 0.7102 - val_accuracy: 0.0635
Confusion matrix: 
 [[  0 573]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.    1.   ]
 [0.049 0.951]]
Validation f1: 11.94
Validation accuracy: 6.35
Validation recall: 95.12
Validation precision: 6.37
Validation AUC: 0.611939502817144
Validation class accuracies: [0.0, 0.9512195121951219]
The validation tracker metric at 0.18660287081339713 hasn't increased by 0 in 1 epochs
Epoch 5/65
154/154 - 92s - loss: 0.7370 - accuracy: 0.0773 - val_loss: 0.7790 - val_accuracy: 0.1270
Confusion matrix: 
 [[ 44 529]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.077 0.923]
 [0.171 0.829]]
Validation f1: 11.26
Validation accuracy: 12.70
Validation recall: 82.93
Validation precision: 6.04
Validation AUC: 0.1393724721157808
Validation class accuracies: [0.07678883071553229, 0.8292682926829268]
The validation tracker metric at 0.18660287081339713 hasn't increased by 0 in 2 epochs
Epoch 6/65
154/154 - 90s - loss: 0.6598 - accuracy: 0.6216 - val_loss: 0.5030 - val_accuracy: 0.9381
Confusion matrix: 
 [[566   7]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.756 0.244]]
Validation f1: 34.48
Validation accuracy: 93.81
Validation recall: 24.39
Validation precision: 58.82
Validation AUC: 0.34805603205451346
Validation class accuracies: [0.987783595113438, 0.24390243902439024]
Saving model...
Epoch 7/65
154/154 - 91s - loss: 0.5743 - accuracy: 0.7799 - val_loss: 0.4857 - val_accuracy: 0.9137
Confusion matrix: 
 [[529  44]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.22  0.78 ]]
Validation f1: 54.70
Validation accuracy: 91.37
Validation recall: 78.05
Validation precision: 42.11
Validation AUC: 0.3677717148723408
Validation class accuracies: [0.9232111692844677, 0.7804878048780488]
Saving model...
Epoch 8/65
154/154 - 93s - loss: 0.5511 - accuracy: 0.8320 - val_loss: 0.4779 - val_accuracy: 0.9300
Confusion matrix: 
 [[545  28]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.366 0.634]]
Validation f1: 54.74
Validation accuracy: 93.00
Validation recall: 63.41
Validation precision: 48.15
Validation AUC: 0.45981741262872855
Validation class accuracies: [0.9511343804537522, 0.6341463414634146]
Saving model...
Epoch 9/65
154/154 - 90s - loss: 0.5277 - accuracy: 0.8613 - val_loss: 0.3960 - val_accuracy: 0.9283
Confusion matrix: 
 [[546  27]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.415 0.585]]
Validation f1: 52.17
Validation accuracy: 92.83
Validation recall: 58.54
Validation precision: 47.06
Validation AUC: 0.45110357708665727
Validation class accuracies: [0.9528795811518325, 0.5853658536585366]
The validation tracker metric at 0.5473684210526316 hasn't increased by 0 in 1 epochs
Epoch 10/65
154/154 - 92s - loss: 0.5246 - accuracy: 0.8015 - val_loss: 0.3938 - val_accuracy: 0.9316
Confusion matrix: 
 [[543  30]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.293 0.707]]
Validation f1: 58.00
Validation accuracy: 93.16
Validation recall: 70.73
Validation precision: 49.15
Validation AUC: 0.3441603023003301
Validation class accuracies: [0.9476439790575916, 0.7073170731707317]
Saving model...
Epoch 11/65
154/154 - 90s - loss: 0.5102 - accuracy: 0.7954 - val_loss: 0.5842 - val_accuracy: 0.8013
Confusion matrix: 
 [[460 113]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.803 0.197]
 [0.22  0.78 ]]
Validation f1: 34.41
Validation accuracy: 80.13
Validation recall: 78.05
Validation precision: 22.07
Validation AUC: 0.26169928810918675
Validation class accuracies: [0.8027923211169284, 0.7804878048780488]
The validation tracker metric at 0.58 hasn't increased by 0 in 1 epochs
Epoch 12/65
154/154 - 91s - loss: 0.5415 - accuracy: 0.7457 - val_loss: 0.4227 - val_accuracy: 0.8779
Confusion matrix: 
 [[513  60]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.366 0.634]]
Validation f1: 40.94
Validation accuracy: 87.79
Validation recall: 63.41
Validation precision: 30.23
Validation AUC: 0.41137533223443673
Validation class accuracies: [0.8952879581151832, 0.6341463414634146]
The validation tracker metric at 0.58 hasn't increased by 0 in 2 epochs
Epoch 13/65
154/154 - 92s - loss: 0.5090 - accuracy: 0.8153 - val_loss: 0.5764 - val_accuracy: 0.7883
Confusion matrix: 
 [[444 129]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.024 0.976]]
Validation f1: 38.10
Validation accuracy: 78.83
Validation recall: 97.56
Validation precision: 23.67
Validation AUC: 0.3097542944058535
Validation class accuracies: [0.774869109947644, 0.975609756097561]
The validation tracker metric at 0.58 hasn't increased by 0 in 3 epochs
Epoch 14/65
154/154 - 90s - loss: 0.4821 - accuracy: 0.8967 - val_loss: 0.4358 - val_accuracy: 0.8909
Confusion matrix: 
 [[514  59]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.195 0.805]]
Validation f1: 49.62
Validation accuracy: 89.09
Validation recall: 80.49
Validation precision: 35.87
Validation AUC: 0.44956903736037235
Validation class accuracies: [0.8970331588132635, 0.8048780487804879]
The validation tracker metric at 0.58 hasn't increased by 0 in 4 epochs
Epoch 15/65
154/154 - 92s - loss: 0.4635 - accuracy: 0.8434 - val_loss: 0.5158 - val_accuracy: 0.8339
Confusion matrix: 
 [[477  96]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.146 0.854]]
Validation f1: 40.70
Validation accuracy: 83.39
Validation recall: 85.37
Validation precision: 26.72
Validation AUC: 0.3184730362394121
Validation class accuracies: [0.8324607329842932, 0.8536585365853658]
The validation tracker metric at 0.58 hasn't increased by 0 in 5 epochs
Epoch 16/65
154/154 - 90s - loss: 0.4817 - accuracy: 0.8771 - val_loss: 0.9967 - val_accuracy: 0.5521
Confusion matrix: 
 [[298 275]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.52 0.48]
 [0.   1.  ]]
Validation f1: 22.97
Validation accuracy: 55.21
Validation recall: 100.00
Validation precision: 12.97
Validation AUC: 0.1508331007197557
Validation class accuracies: [0.5200698080279232, 1.0]
The validation tracker metric at 0.58 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
154/154 - 92s - loss: 0.4424 - accuracy: 0.8576 - val_loss: 0.5397 - val_accuracy: 0.8339
Confusion matrix: 
 [[472 101]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.824 0.176]
 [0.024 0.976]]
Validation f1: 43.96
Validation accuracy: 83.39
Validation recall: 97.56
Validation precision: 28.37
Validation AUC: 0.3370633757454831
Validation class accuracies: [0.8237347294938918, 0.975609756097561]
The validation tracker metric at 0.58 hasn't increased by 0 in 7 epochs
Epoch 18/65
154/154 - 92s - loss: 0.4505 - accuracy: 0.8190 - val_loss: 0.4764 - val_accuracy: 0.8567
Confusion matrix: 
 [[491  82]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.857 0.143]
 [0.146 0.854]]
Validation f1: 44.30
Validation accuracy: 85.67
Validation recall: 85.37
Validation precision: 29.91
Validation AUC: 0.457477670112906
Validation class accuracies: [0.8568935427574171, 0.8536585365853658]
The validation tracker metric at 0.58 hasn't increased by 0 in 8 epochs
Epoch 19/65
154/154 - 90s - loss: 0.4416 - accuracy: 0.8775 - val_loss: 0.5547 - val_accuracy: 0.8143
Confusion matrix: 
 [[463 110]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.808 0.192]
 [0.098 0.902]]
Validation f1: 39.36
Validation accuracy: 81.43
Validation recall: 90.24
Validation precision: 25.17
Validation AUC: 0.37385081554941024
Validation class accuracies: [0.8080279232111692, 0.9024390243902439]
The validation tracker metric at 0.58 hasn't increased by 0 in 9 epochs
Epoch 20/65
154/154 - 91s - loss: 0.4433 - accuracy: 0.8523 - val_loss: 0.5631 - val_accuracy: 0.8208
Confusion matrix: 
 [[468 105]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.122 0.878]]
Validation f1: 39.56
Validation accuracy: 82.08
Validation recall: 87.80
Validation precision: 25.53
Validation AUC: 0.39005394680446837
Validation class accuracies: [0.8167539267015707, 0.8780487804878049]
The validation tracker metric at 0.58 hasn't increased by 0 in 10 epochs
Epoch 21/65
154/154 - 90s - loss: 0.4319 - accuracy: 0.8649 - val_loss: 0.5217 - val_accuracy: 0.8388
Confusion matrix: 
 [[480  93]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.146 0.854]]
Validation f1: 41.42
Validation accuracy: 83.88
Validation recall: 85.37
Validation precision: 27.34
Validation AUC: 0.3615330380563965
Validation class accuracies: [0.837696335078534, 0.8536585365853658]
The validation tracker metric at 0.58 hasn't increased by 0 in 11 epochs
Epoch 22/65
154/154 - 91s - loss: 0.4293 - accuracy: 0.8804 - val_loss: 0.4633 - val_accuracy: 0.8648
Confusion matrix: 
 [[498  75]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.195 0.805]]
Validation f1: 44.30
Validation accuracy: 86.48
Validation recall: 80.49
Validation precision: 30.56
Validation AUC: 0.33607579619610856
Validation class accuracies: [0.8691099476439791, 0.8048780487804879]
The validation tracker metric at 0.58 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
154/154 - 91s - loss: 0.4311 - accuracy: 0.8747 - val_loss: 0.5386 - val_accuracy: 0.8274
Confusion matrix: 
 [[472 101]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.824 0.176]
 [0.122 0.878]]
Validation f1: 40.45
Validation accuracy: 82.74
Validation recall: 87.80
Validation precision: 26.28
Validation AUC: 0.310479404955417
Validation class accuracies: [0.8237347294938918, 0.8780487804878049]
The validation tracker metric at 0.58 hasn't increased by 0 in 13 epochs
Epoch 24/65
154/154 - 90s - loss: 0.4270 - accuracy: 0.8613 - val_loss: 0.6058 - val_accuracy: 0.7883
Confusion matrix: 
 [[444 129]
 [  1  40]]
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.024 0.976]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.10
Validation accuracy: 78.83
Validation recall: 97.56
Validation precision: 23.67
Validation AUC: 0.2858269112197067
Validation class accuracies: [0.774869109947644, 0.975609756097561]
The validation tracker metric at 0.58 hasn't increased by 0 in 14 epochs
Epoch 25/65
154/154 - 91s - loss: 0.4341 - accuracy: 0.8320 - val_loss: 0.5234 - val_accuracy: 0.8322
Confusion matrix: 
 [[476  97]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.831 0.169]
 [0.146 0.854]]
Validation f1: 40.46
Validation accuracy: 83.22
Validation recall: 85.37
Validation precision: 26.52
Validation AUC: 0.40367291170833036
Validation class accuracies: [0.8307155322862129, 0.8536585365853658]
The validation tracker metric at 0.58 hasn't increased by 0 in 15 epochs
Epoch 26/65
154/154 - 91s - loss: 0.4168 - accuracy: 0.8637 - val_loss: 0.5178 - val_accuracy: 0.8322
Confusion matrix: 
 [[476  97]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.831 0.169]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.46
Validation accuracy: 83.22
Validation recall: 85.37
Validation precision: 26.52
Validation AUC: 0.4111862766365687
Validation class accuracies: [0.8307155322862129, 0.8536585365853658]
The validation tracker metric at 0.58 hasn't increased by 0 in 16 epochs
Epoch 27/65
154/154 - 90s - loss: 0.4320 - accuracy: 0.8466 - val_loss: 0.5047 - val_accuracy: 0.8420
Confusion matrix: 
 [[482  91]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.146 0.854]]
Validation f1: 41.92
Validation accuracy: 84.20
Validation recall: 85.37
Validation precision: 27.78
Validation AUC: 0.41813456933122534
Validation class accuracies: [0.8411867364746946, 0.8536585365853658]
The validation tracker metric at 0.58 hasn't increased by 0 in 17 epochs
Epoch 28/65
154/154 - 91s - loss: 0.4123 - accuracy: 0.8637 - val_loss: 0.5136 - val_accuracy: 0.8355
Confusion matrix: 
 [[477  96]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.122 0.878]]
Validation f1: 41.62
Validation accuracy: 83.55
Validation recall: 87.80
Validation precision: 27.27
Validation AUC: 0.43238838892003706
Validation class accuracies: [0.8324607329842932, 0.8780487804878049]
The validation tracker metric at 0.58 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 29/65
154/154 - 90s - loss: 0.4200 - accuracy: 0.8523 - val_loss: 0.5022 - val_accuracy: 0.8355
Confusion matrix: 
 [[478  95]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.834 0.166]
 [0.146 0.854]]
Validation f1: 40.94
Validation accuracy: 83.55
Validation recall: 85.37
Validation precision: 26.92
Validation AUC: 0.4131194592796154
Validation class accuracies: [0.8342059336823735, 0.8536585365853658]
The validation tracker metric at 0.58 hasn't increased by 0 in 19 epochs
Epoch 30/65
154/154 - 92s - loss: 0.4087 - accuracy: 0.8544 - val_loss: 0.4880 - val_accuracy: 0.8436
Confusion matrix: 
 [[483  90]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.146 0.854]]
Validation f1: 42.17
Validation accuracy: 84.36
Validation recall: 85.37
Validation precision: 28.00
Validation AUC: 0.4035947469935547
Validation class accuracies: [0.8429319371727748, 0.8536585365853658]

The metrics for job 0 with the best target metric are: 
Best cm: [[543  30]
 [ 12  29]]
Best normalized cm: [[0.948 0.052]
 [0.293 0.707]]
Best f1: 0.58
Best accuracy: 0.93
Best recall: 0.71
Best precision: 0.49
Best AUC: 0.34
Best class accuracies: [0.9476439790575916, 0.7073170731707317]
Best epoch: 10
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 3016
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_163010-3k4o596c/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_163010-3k4o596c/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.85435
wandb:         val_accuracy 0.84365
wandb:             _runtime 3056
wandb:           _timestamp 1624814467
wandb:                _step 227
wandb:           train_loss 0.40867
wandb:             val_loss 0.48801
wandb:           val_recall 0.85366
wandb:        val_precision 0.28
wandb:               val_f1 0.42169
wandb:              val_auc 0.40359
wandb:                   lr 0.00013
wandb:          best_val_f1 0.58
wandb:    best_val_accuracy 0.9316
wandb:   best_val_precision 0.49153
wandb:      best_val_recall 0.70732
wandb:             best_auc 0.34416
wandb:           best_epoch 10
wandb: Run history:
wandb:   train_accuracy ▁▁▄▄▁▆▇▇█▇▇▇▇████▇██████▇█████
wandb:     val_accuracy ▁▁▄▁▂█████▇█▇█▇▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ██▇▇▇▆▄▄▃▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▆▆▅▅▅▂▂▂▁▁▃▁▃▁▂█▃▂▃▃▂▂▃▃▃▂▂▂▂▂
wandb:       val_recall ████▆▁▆▅▄▅▆▅█▆▇██▇▇▇▇▆▇█▇▇▇▇▇▇
wandb:    val_precision ▁▁▂▁▁█▆▇▆▇▃▄▃▅▄▂▄▄▄▄▄▄▄▃▄▄▄▄▄▄
wandb:           val_f1 ▁▁▂▁▁▄██▇█▄▅▅▇▅▃▆▆▅▅▆▆▅▅▅▅▆▆▅▆
wandb:          val_auc ▁▅▁█▂▅▅▆▆▅▃▅▄▆▄▂▄▆▅▅▅▄▄▄▅▅▅▆▅▅
wandb:               lr ████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210627_163010-3k4o596c


 See logs at ../../new_cache/conv__2258__06_1629__v39__lstm/logs/