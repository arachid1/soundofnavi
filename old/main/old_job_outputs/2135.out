Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2135
Description:  mixednet_oversampled
2021-05-13 12:29:39.244244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 12:29:41.878888: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-13 12:29:41.880072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-13 12:29:41.928892: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:41.929912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-13 12:29:41.929955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 12:29:41.934638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 12:29:41.934848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 12:29:41.936672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-13 12:29:41.937111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-13 12:29:41.938624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-13 12:29:41.939897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-13 12:29:41.940102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-13 12:29:41.940303: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:41.941411: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:41.942338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2135.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2135__05_1229__v29__mixednet_oversampled/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 22, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2135
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/vj4j7k8e
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_122942-vj4j7k8e
wandb: Run `wandb offline` to turn off syncing.
2021-05-13 12:29:48.032531: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-13 12:29:48.032873: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:48.033854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-13 12:29:48.033918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 12:29:48.034001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 12:29:48.034032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 12:29:48.034061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-13 12:29:48.034092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-13 12:29:48.034121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-13 12:29:48.034150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-13 12:29:48.034178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-13 12:29:48.034305: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:48.035314: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:48.036207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-13 12:29:48.036286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 12:29:48.855673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-13 12:29:48.855727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-13 12:29:48.855745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-13 12:29:48.856084: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:48.857235: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:48.858276: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 12:29:48.859260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-13 12:30:33.245829: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-13 12:30:33.247334: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-13 12:30:35.099119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 12:30:35.850292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 12:30:35.901154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
1150
3046
With concat = False and six = False, size of training set: 6092...
...and size of validation set: 1088
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,967
Trainable params: 105,471
Non-trainable params: 496
_________________________________________________________________
Epoch 1/80
381/381 - 222s - loss: 0.6791 - accuracy: 0.5696 - val_loss: 0.6422 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19179717160321136
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.19179717160321136
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
381/381 - 213s - loss: 0.6464 - accuracy: 0.6269 - val_loss: 0.5768 - val_accuracy: 0.7757
Confusion matrix: 
 [[833  37]
 [207  11]]
Validation f1: 8.27
Validation accuracy: 77.57
Validation recall: 5.05
Validation precision: 22.92
Validation AUC: 0.19666124437335625
Validation class accuracies: [0.957471264367816, 0.05045871559633028]
TARGET: 0
target metric(test auc): 0.19666124437335625
column_sums: [1040   48]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
381/381 - 212s - loss: 0.6033 - accuracy: 0.6707 - val_loss: 0.7023 - val_accuracy: 0.5579
Confusion matrix: 
 [[506 364]
 [117 101]]
Validation f1: 29.58
Validation accuracy: 55.79
Validation recall: 46.33
Validation precision: 21.72
Validation AUC: 0.239046433266133
Validation class accuracies: [0.5816091954022988, 0.463302752293578]
TARGET: 0
target metric(test auc): 0.239046433266133
column_sums: [623 465]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 4/80
381/381 - 213s - loss: 0.5336 - accuracy: 0.7352 - val_loss: 0.6613 - val_accuracy: 0.6425
Confusion matrix: 
 [[628 242]
 [147  71]]
Validation f1: 26.74
Validation accuracy: 64.25
Validation recall: 32.57
Validation precision: 22.68
Validation AUC: 0.22805526948498028
Validation class accuracies: [0.7218390804597701, 0.3256880733944954]
TARGET: 0
target metric(test auc): 0.22805526948498028
column_sums: [775 313]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 1 epochs
Epoch 5/80
381/381 - 212s - loss: 0.4317 - accuracy: 0.8079 - val_loss: 0.7904 - val_accuracy: 0.6039
Confusion matrix: 
 [[601 269]
 [162  56]]
Validation f1: 20.63
Validation accuracy: 60.39
Validation recall: 25.69
Validation precision: 17.23
Validation AUC: 0.19285212396906254
Validation class accuracies: [0.6908045977011494, 0.25688073394495414]
TARGET: 0
target metric(test auc): 0.19285212396906254
column_sums: [763 325]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 2 epochs
Epoch 6/80
381/381 - 211s - loss: 0.3347 - accuracy: 0.8661 - val_loss: 1.2258 - val_accuracy: 0.4651
Confusion matrix: 
 [[368 502]
 [ 80 138]]
Validation f1: 32.17
Validation accuracy: 46.51
Validation recall: 63.30
Validation precision: 21.56
Validation AUC: 0.22131939294263878
Validation class accuracies: [0.42298850574712643, 0.6330275229357798]
TARGET: 0
target metric(test auc): 0.22131939294263878
column_sums: [448 640]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 3 epochs
Epoch 7/80
381/381 - 212s - loss: 0.2609 - accuracy: 0.9022 - val_loss: 1.3577 - val_accuracy: 0.4577
Confusion matrix: 
 [[370 500]
 [ 90 128]]
Validation f1: 30.26
Validation accuracy: 45.77
Validation recall: 58.72
Validation precision: 20.38
Validation AUC: 0.22512896636656535
Validation class accuracies: [0.42528735632183906, 0.5871559633027523]
TARGET: 0
target metric(test auc): 0.22512896636656535
column_sums: [460 628]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 4 epochs
Epoch 8/80
381/381 - 214s - loss: 0.1796 - accuracy: 0.9457 - val_loss: 0.8037 - val_accuracy: 0.6976
Confusion matrix: 
 [[709 161]
 [168  50]]
Validation f1: 23.31
Validation accuracy: 69.76
Validation recall: 22.94
Validation precision: 23.70
Validation AUC: 0.2210902357838239
Validation class accuracies: [0.8149425287356322, 0.22935779816513763]
TARGET: 0
target metric(test auc): 0.2210902357838239
column_sums: [877 211]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 5 epochs
Epoch 9/80
381/381 - 217s - loss: 0.1546 - accuracy: 0.9568 - val_loss: 0.8127 - val_accuracy: 0.7151
Confusion matrix: 
 [[737 133]
 [177  41]]
Validation f1: 20.92
Validation accuracy: 71.51
Validation recall: 18.81
Validation precision: 23.56
Validation AUC: 0.21964683070477697
Validation class accuracies: [0.8471264367816091, 0.18807339449541285]
TARGET: 0
target metric(test auc): 0.21964683070477697
column_sums: [914 174]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 6 epochs
Epoch 10/80
381/381 - 222s - loss: 0.1422 - accuracy: 0.9599 - val_loss: 0.8640 - val_accuracy: 0.6737
Confusion matrix: 
 [[680 190]
 [165  53]]
Validation f1: 22.99
Validation accuracy: 67.37
Validation recall: 24.31
Validation precision: 21.81
Validation AUC: 0.2296095625615483
Validation class accuracies: [0.7816091954022989, 0.24311926605504589]
TARGET: 0
target metric(test auc): 0.2296095625615483
column_sums: [845 243]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 7 epochs
Epoch 11/80
381/381 - 214s - loss: 0.1353 - accuracy: 0.9626 - val_loss: 0.8631 - val_accuracy: 0.7206
Confusion matrix: 
 [[746 124]
 [180  38]]
Validation f1: 20.00
Validation accuracy: 72.06
Validation recall: 17.43
Validation precision: 23.46
Validation AUC: 0.21764389471695195
Validation class accuracies: [0.8574712643678161, 0.1743119266055046]
TARGET: 0
target metric(test auc): 0.21764389471695195
column_sums: [926 162]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 8 epochs
Epoch 12/80
381/381 - 213s - loss: 0.1203 - accuracy: 0.9705 - val_loss: 0.8820 - val_accuracy: 0.6829
Confusion matrix: 
 [[689 181]
 [164  54]]
Validation f1: 23.84
Validation accuracy: 68.29
Validation recall: 24.77
Validation precision: 22.98
Validation AUC: 0.22653111178130952
Validation class accuracies: [0.7919540229885057, 0.24770642201834864]
TARGET: 0
target metric(test auc): 0.22653111178130952
column_sums: [853 235]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 9 epochs
Epoch 13/80
381/381 - 212s - loss: 0.1144 - accuracy: 0.9713 - val_loss: 0.8877 - val_accuracy: 0.6811
Confusion matrix: 
 [[689 181]
 [166  52]]
Validation f1: 23.06
Validation accuracy: 68.11
Validation recall: 23.85
Validation precision: 22.32
Validation AUC: 0.22426988935037578
Validation class accuracies: [0.7919540229885057, 0.23853211009174313]
TARGET: 0
target metric(test auc): 0.22426988935037578
column_sums: [855 233]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 10 epochs
Epoch 14/80
381/381 - 224s - loss: 0.1208 - accuracy: 0.9652 - val_loss: 0.8871 - val_accuracy: 0.6811
Confusion matrix: 
 [[689 181]
 [166  52]]
Validation f1: 23.06
Validation accuracy: 68.11
Validation recall: 23.85
Validation precision: 22.32
Validation AUC: 0.22832434070154534
Validation class accuracies: [0.7919540229885057, 0.23853211009174313]
TARGET: 0
target metric(test auc): 0.22832434070154534
column_sums: [855 233]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 11 epochs
Epoch 15/80
381/381 - 211s - loss: 0.1114 - accuracy: 0.9736 - val_loss: 0.9381 - val_accuracy: 0.6553
Confusion matrix: 
 [[654 216]
 [159  59]]
Validation f1: 23.94
Validation accuracy: 65.53
Validation recall: 27.06
Validation precision: 21.45
Validation AUC: 0.22738083154107003
Validation class accuracies: [0.7517241379310344, 0.2706422018348624]
TARGET: 0
target metric(test auc): 0.22738083154107003
column_sums: [813 275]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 12 epochs
Epoch 16/80
381/381 - 214s - loss: 0.1026 - accuracy: 0.9764 - val_loss: 0.8895 - val_accuracy: 0.6967
Confusion matrix: 
 [[710 160]
 [170  48]]
Validation f1: 22.54
Validation accuracy: 69.67
Validation recall: 22.02
Validation precision: 23.08
Validation AUC: 0.22314280142447845
Validation class accuracies: [0.8160919540229885, 0.22018348623853212]
TARGET: 0
target metric(test auc): 0.22314280142447845
column_sums: [880 208]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 13 epochs
Epoch 17/80
381/381 - 214s - loss: 0.1088 - accuracy: 0.9705 - val_loss: 0.8889 - val_accuracy: 0.6921
Confusion matrix: 
 [[706 164]
 [171  47]]
Validation f1: 21.91
Validation accuracy: 69.21
Validation recall: 21.56
Validation precision: 22.27
Validation AUC: 0.2220644258209477
Validation class accuracies: [0.8114942528735632, 0.21559633027522937]
TARGET: 0
target metric(test auc): 0.2220644258209477
column_sums: [877 211]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 14 epochs
Epoch 18/80
381/381 - 213s - loss: 0.1047 - accuracy: 0.9744 - val_loss: 0.9044 - val_accuracy: 0.6783
Confusion matrix: 
 [[688 182]
 [168  50]]
Validation f1: 22.22
Validation accuracy: 67.83
Validation recall: 22.94
Validation precision: 21.55
Validation AUC: 0.22509443470370383
Validation class accuracies: [0.7908045977011494, 0.22935779816513763]
TARGET: 0
target metric(test auc): 0.22509443470370383
column_sums: [856 232]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 15 epochs
Epoch 19/80
381/381 - 214s - loss: 0.1088 - accuracy: 0.9739 - val_loss: 0.8920 - val_accuracy: 0.6875
Confusion matrix: 
 [[701 169]
 [171  47]]
Validation f1: 21.66
Validation accuracy: 68.75
Validation recall: 21.56
Validation precision: 21.76
Validation AUC: 0.2240372011025101
Validation class accuracies: [0.8057471264367816, 0.21559633027522937]
TARGET: 0
target metric(test auc): 0.2240372011025101
column_sums: [872 216]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 16 epochs
Epoch 20/80
381/381 - 208s - loss: 0.1015 - accuracy: 0.9767 - val_loss: 0.8975 - val_accuracy: 0.6930
Confusion matrix: 
 [[704 166]
 [168  50]]
Validation f1: 23.04
Validation accuracy: 69.30
Validation recall: 22.94
Validation precision: 23.15
Validation AUC: 0.2233452506237727
Validation class accuracies: [0.8091954022988506, 0.22935779816513763]
TARGET: 0
target metric(test auc): 0.2233452506237727
column_sums: [872 216]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 17 epochs
Epoch 21/80
381/381 - 209s - loss: 0.1051 - accuracy: 0.9744 - val_loss: 0.9010 - val_accuracy: 0.6829
Confusion matrix: 
 [[695 175]
 [170  48]]
Validation f1: 21.77
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.29
Validation recall: 22.02
Validation precision: 21.52
Validation AUC: 0.22335368265285005
Validation class accuracies: [0.7988505747126436, 0.22018348623853212]
TARGET: 0
target metric(test auc): 0.22335368265285005
column_sums: [865 223]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 18 epochs
Epoch 22/80
381/381 - 207s - loss: 0.1084 - accuracy: 0.9719 - val_loss: 0.8945 - val_accuracy: 0.6884
Confusion matrix: 
 [[701 169]
 [170  48]]
Validation f1: 22.07
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.84
Validation recall: 22.02
Validation precision: 22.12
Validation AUC: 0.22342075571047199
Validation class accuracies: [0.8057471264367816, 0.22018348623853212]
TARGET: 0
target metric(test auc): 0.22342075571047199
column_sums: [871 217]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 19 epochs
Epoch 23/80
381/381 - 207s - loss: 0.1007 - accuracy: 0.9778 - val_loss: 0.8882 - val_accuracy: 0.6994
Confusion matrix: 
 [[715 155]
 [172  46]]
Validation f1: 21.96
Validation accuracy: 69.94
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 21.10
Validation precision: 22.89
Validation AUC: 0.22249786561841317
Validation class accuracies: [0.8218390804597702, 0.21100917431192662]
TARGET: 0
target metric(test auc): 0.22249786561841317
column_sums: [887 201]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 20 epochs
Epoch 24/80
381/381 - 208s - loss: 0.1065 - accuracy: 0.9760 - val_loss: 0.8897 - val_accuracy: 0.7013
Confusion matrix: 
 [[716 154]
 [171  47]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 22.43
Validation accuracy: 70.13
Validation recall: 21.56
Validation precision: 23.38
Validation AUC: 0.22279701438601965
Validation class accuracies: [0.8229885057471265, 0.21559633027522937]
TARGET: 0
target metric(test auc): 0.22279701438601965
column_sums: [887 201]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.239046433266133 hasn't increased by 0 in 21 epochs
Epoch 25/80
381/381 - 209s - loss: 0.1058 - accuracy: 0.9723 - val_loss: 0.8881 - val_accuracy: 0.7068
Confusion matrix: 
 [[723 147]
 [172  46]]
Validation f1: 22.38
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 70.68
Validation recall: 21.10
Validation precision: 23.83
Validation AUC: 0.22270432668701023
Validation class accuracies: [0.8310344827586207, 0.21100917431192662]

The metrics for the epoch with the best target metric are: 
Best cm: [[506 364]
 [117 101]]
Best f1: 0.2957540263543192
Best accuracy: 0.5579044117647058
Best recall: 0.463302752293578
Best precision: 0.2172043010752688
Best AUC: 0.239046433266133
Best epoch: 3
TARGET: 0
target metric(test auc): 0.22270432668701023
column_sums: [895 193]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 3
Starting...
CM: [[ 7 53]
 [ 0 15]]
F1: 0.36144578313253006
AUC: 0.6102941176470589
Accuracy: 0.29333333333333333
Precision: 0.22058823529411764
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2135__05_1229__v29__mixednet_oversampled/validation_sheet_3.xls...
Done.
Epoch: 80
Starting...
CM: [[16 44]
 [ 6  9]]
F1: 0.2647058823529412
AUC: 0.4249056603773585
Accuracy: 0.3333333333333333
Precision: 0.16981132075471697
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2135__05_1229__v29__mixednet_oversampled/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 9672
wandb: Program ended successfully.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.04MB uploaded (0.00MB deduped)wandb: / 0.03MB of 0.04MB uploaded (0.00MB deduped)wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: / 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: / 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_122942-vj4j7k8e/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_122942-vj4j7k8e/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.97226
wandb:         val_accuracy 0.7068
wandb:             _runtime 5964
wandb:           _timestamp 1620914946
wandb:                _step 178
wandb:           train_loss 0.10576
wandb:             val_loss 0.88813
wandb:           val_recall 0.21101
wandb:        val_precision 0.23834
wandb:               val_f1 0.22384
wandb:              val_auc 0.2227
wandb:                   lr 0.0
wandb:          best_val_f1 0.29575
wandb:    best_val_accuracy 0.5579
wandb:   best_val_precision 0.2172
wandb:      best_val_recall 0.4633
wandb:             best_auc 0.23905
wandb:           best_epoch 3
wandb:           best_bd_f1 0.36145
wandb:          best_bd_auc 0.61029
wandb:     best_bd_accuracy 0.29333
wandb:    best_bd_precision 0.22059
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 3
wandb: Run history:
wandb:   train_accuracy ▁▂▃▄▅▆▇▇█████████████████
wandb:     val_accuracy ██▃▅▄▁▁▆▆▅▆▆▆▆▅▆▆▆▆▆▆▆▆▆▆
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss ██▇▆▅▄▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▂▂▃▇█▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:       val_recall ▁▂▆▅▄█▇▄▃▄▃▄▄▄▄▃▃▄▃▄▃▃▃▃▃
wandb:    val_precision ▁█▇█▆▇▇██▇████▇██▇▇█▇▇███
wandb:           val_f1 ▁▃▇▇▅██▆▆▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          val_auc ▁▂█▆▁▅▆▅▅▇▅▆▆▆▆▆▅▆▆▆▆▆▆▆▆
wandb:               lr ███████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 4 media file(s), 3 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2135: https://wandb.ai/arachid1/tensorboard-integration/runs/vj4j7k8e


 See logs at ../../new_cache/conv__2135__05_1229__v29__mixednet_oversampled/logs/