Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2042
Description:  new_mixednet
2021-04-07 10:27:58.751173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 10:28:06.137552: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-07 10:28:06.138845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-07 10:28:06.205868: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:06.206889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-07 10:28:06.206935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 10:28:06.226845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 10:28:06.226981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 10:28:06.229425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-07 10:28:06.234319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-07 10:28:06.237387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-07 10:28:06.241362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-07 10:28:06.244238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 10:28:06.244444: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:06.245654: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:06.246588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-07 10:28:06.254908: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-07 10:28:06.255101: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:06.256119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-07 10:28:06.256154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 10:28:06.256202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 10:28:06.256223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 10:28:06.256243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-07 10:28:06.256263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-07 10:28:06.256294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-07 10:28:06.256315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-07 10:28:06.256335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 10:28:06.256448: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:06.257508: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:06.258454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-07 10:28:06.258510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-07 10:28:07.125154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-07 10:28:07.125211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-07 10:28:07.125223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-07 10:28:07.125586: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:07.126725: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:07.127871: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-07 10:28:07.128806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:05.0, compute capability: 7.0)
2021-04-07 10:28:07.788402: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-07 10:28:07.788456: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-07 10:28:07.788503: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-07 10:28:07.788829: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-07 10:28:07.797927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-07 10:28:08.039935: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-07 10:28:08.042911: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-07 10:28:09.137774: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-07 10:28:09.139272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-07 10:28:11.626444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-07 10:28:12.196674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-07 10:28:12.208407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-07 10:28:15.613146: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-07 10:28:15.613202: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-07 10:28:16.600442: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-07 10:28:16.603428: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-07 10:28:16.661254: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 608 callback api events and 604 activity events. 
2021-04-07 10:28:16.692584: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2042.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_1027___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___new_mixednet___2042/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 128, 1250, 12)     336       
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 625, 12)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 64, 625, 12)       48        
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 64, 625, 16)       1744      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 64, 625, 16)       2320      
_________________________________________________________________
average_pooling2d_2 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 32, 313, 32)       9248      
_________________________________________________________________
average_pooling2d_3 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 157, 64)       36928     
_________________________________________________________________
average_pooling2d_4 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 8, 79, 128)        147584    
_________________________________________________________________
average_pooling2d_5 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 128)               16512     
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 258       
=================================================================
Total params: 319,230
Trainable params: 318,726
Non-trainable params: 504
_________________________________________________________________
Epoch 1/40
872/872 - 467s - loss: 0.3147 - calc_accuracy: 0.6603 - val_loss: 0.4449 - val_calc_accuracy: 0.6830
Epoch 2/40
872/872 - 450s - loss: 0.2566 - calc_accuracy: 0.7356 - val_loss: 0.3029 - val_calc_accuracy: 0.7659
Epoch 3/40
872/872 - 453s - loss: 0.2295 - calc_accuracy: 0.7635 - val_loss: 0.2894 - val_calc_accuracy: 0.7895
Epoch 4/40
872/872 - 453s - loss: 0.1993 - calc_accuracy: 0.7957 - val_loss: 0.2241 - val_calc_accuracy: 0.8336
Epoch 5/40
872/872 - 457s - loss: 0.1818 - calc_accuracy: 0.8180 - val_loss: 0.2197 - val_calc_accuracy: 0.8408
Epoch 6/40
872/872 - 463s - loss: 0.1662 - calc_accuracy: 0.8325 - val_loss: 0.2148 - val_calc_accuracy: 0.8488
Epoch 7/40
872/872 - 454s - loss: 0.1514 - calc_accuracy: 0.8486 - val_loss: 0.2691 - val_calc_accuracy: 0.8023
Epoch 8/40
872/872 - 450s - loss: 0.1426 - calc_accuracy: 0.8560 - val_loss: 0.2243 - val_calc_accuracy: 0.8479
Epoch 9/40
872/872 - 453s - loss: 0.1310 - calc_accuracy: 0.8688 - val_loss: 0.1942 - val_calc_accuracy: 0.8586
Epoch 10/40
872/872 - 455s - loss: 0.1223 - calc_accuracy: 0.8778 - val_loss: 0.1865 - val_calc_accuracy: 0.8766
Epoch 11/40
872/872 - 464s - loss: 0.1130 - calc_accuracy: 0.8868 - val_loss: 0.2069 - val_calc_accuracy: 0.8612
Epoch 12/40
872/872 - 452s - loss: 0.1012 - calc_accuracy: 0.8949 - val_loss: 0.1674 - val_calc_accuracy: 0.8821
Epoch 13/40
872/872 - 457s - loss: 0.0964 - calc_accuracy: 0.9036 - val_loss: 0.1893 - val_calc_accuracy: 0.8818
Epoch 14/40
872/872 - 455s - loss: 0.0852 - calc_accuracy: 0.9151 - val_loss: 0.1853 - val_calc_accuracy: 0.8804
Epoch 15/40
872/872 - 461s - loss: 0.0786 - calc_accuracy: 0.9187 - val_loss: 0.1810 - val_calc_accuracy: 0.8876
Epoch 16/40
872/872 - 453s - loss: 0.0739 - calc_accuracy: 0.9234 - val_loss: 0.1963 - val_calc_accuracy: 0.8881
Epoch 17/40
872/872 - 463s - loss: 0.0623 - calc_accuracy: 0.9352 - val_loss: 0.2298 - val_calc_accuracy: 0.8671
Epoch 18/40
872/872 - 460s - loss: 0.0588 - calc_accuracy: 0.9426 - val_loss: 0.1946 - val_calc_accuracy: 0.8896
Epoch 19/40
872/872 - 456s - loss: 0.0490 - calc_accuracy: 0.9489 - val_loss: 0.2047 - val_calc_accuracy: 0.8823
Epoch 20/40
872/872 - 460s - loss: 0.0496 - calc_accuracy: 0.9504 - val_loss: 0.2170 - val_calc_accuracy: 0.8712
Epoch 21/40
872/872 - 366s - loss: 0.0435 - calc_accuracy: 0.9561 - val_loss: 0.2346 - val_calc_accuracy: 0.8755

Epoch 00021: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 22/40
872/872 - 327s - loss: 0.0340 - calc_accuracy: 0.9677 - val_loss: 0.2011 - val_calc_accuracy: 0.8979
Epoch 23/40
872/872 - 328s - loss: 0.0342 - calc_accuracy: 0.9684 - val_loss: 0.2101 - val_calc_accuracy: 0.8956
Epoch 24/40
872/872 - 327s - loss: 0.0319 - calc_accuracy: 0.9702 - val_loss: 0.2008 - val_calc_accuracy: 0.8967
Epoch 25/40
872/872 - 327s - loss: 0.0303 - calc_accuracy: 0.9720 - val_loss: 0.2216 - val_calc_accuracy: 0.8938

Epoch 00025: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 26/40
872/872 - 327s - loss: 0.0212 - calc_accuracy: 0.9806 - val_loss: 0.2290 - val_calc_accuracy: 0.9044
Epoch 27/40
872/872 - 327s - loss: 0.0202 - calc_accuracy: 0.9809 - val_loss: 0.2287 - val_calc_accuracy: 0.8998
Epoch 28/40
872/872 - 327s - loss: 0.0186 - calc_accuracy: 0.9824 - val_loss: 0.2226 - val_calc_accuracy: 0.9075
Epoch 29/40
872/872 - 327s - loss: 0.0175 - calc_accuracy: 0.9838 - val_loss: 0.2287 - val_calc_accuracy: 0.9040
Epoch 30/40
872/872 - 327s - loss: 0.0146 - calc_accuracy: 0.9865 - val_loss: 0.2350 - val_calc_accuracy: 0.9039
Epoch 31/40
872/872 - 327s - loss: 0.0186 - calc_accuracy: 0.9840 - val_loss: 0.2369 - val_calc_accuracy: 0.9022

Epoch 00031: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 00031: early stopping

 See logs at ../../cache/conv___04_1027___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___new_mixednet___2042/logs/