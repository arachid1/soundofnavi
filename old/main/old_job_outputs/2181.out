Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2181
Description:  lowlr_increasing
2021-06-01 21:31:07.512897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:18: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-01 21:31:09.913336: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-01 21:31:09.914508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-01 21:31:09.969274: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:09.970099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-01 21:31:09.970137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 21:31:10.001267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 21:31:10.001356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-01 21:31:10.007117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-01 21:31:10.017238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-01 21:31:10.022616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-01 21:31:10.030010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-01 21:31:10.033265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 21:31:10.033441: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:10.034324: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:10.035049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2181.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 4, 'min_lr': 1e-06}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
Audio augmentations params: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v36'}
Spectrogram augmentations params: {'ADD': 0, 'QUANTITY': 50, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 0, 'LOUDNESS': 0}
-----------------------
wandb: wandb version 0.10.31 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2181
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/28t8r2th
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210601_213110-28t8r2th
wandb: Run `wandb offline` to turn off syncing.
2021-06-01 21:31:50.397425: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-01 21:31:50.397779: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:50.398555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-01 21:31:50.398611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 21:31:50.398705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 21:31:50.398730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-01 21:31:50.398758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-01 21:31:50.398781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-01 21:31:50.398801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-01 21:31:50.398822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-01 21:31:50.398842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 21:31:50.398938: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:50.399715: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:50.400447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-01 21:31:50.400564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-01 21:31:51.137554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-01 21:31:51.137618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-01 21:31:51.137628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-01 21:31:51.138075: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:51.139026: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:51.139952: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-01 21:31:51.141077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-06-01 21:31:52.313472: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-01 21:31:52.317163: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-01 21:31:52.672707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-01 21:31:54.360540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-01 21:31:54.706862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11

Original number of folders: 453
4212
With concat = False and six = False, size of training set: 4212...
...and size of validation set: 1072
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/80
264/264 - 130s - loss: 0.6632 - accuracy: 0.6508 - val_loss: 0.5939 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2715549857282804
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/80
264/264 - 126s - loss: 0.5752 - accuracy: 0.7391 - val_loss: 0.5851 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27006112094483725
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/80
264/264 - 126s - loss: 0.5689 - accuracy: 0.7412 - val_loss: 0.5900 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Validation f1: 0.00
Validation accuracy: 73.13
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31139139094507534
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/80
264/264 - 126s - loss: 0.5573 - accuracy: 0.7415 - val_loss: 0.5952 - val_accuracy: 0.7257
Confusion matrix: 
 [[772  12]
 [282   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 3.92
Validation accuracy: 72.57
Validation recall: 2.08
Validation precision: 33.33
Validation AUC: 0.3000361929666481
Validation class accuracies: [0.9846938775510204, 0.020833333333333332]
TARGET: 1
target metric(test f1): 0.0392156862745098
inside not defaulting
Saving model...
Epoch 5/80
264/264 - 126s - loss: 0.5426 - accuracy: 0.7443 - val_loss: 0.5957 - val_accuracy: 0.7285
Confusion matrix: 
 [[772  12]
 [279   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 5.83
Validation accuracy: 72.85
Validation recall: 3.12
Validation precision: 42.86
Validation AUC: 0.30681879258052996
Validation class accuracies: [0.9846938775510204, 0.03125]
TARGET: 1
target metric(test f1): 0.05825242718446602
inside not defaulting
Saving model...
Epoch 6/80
264/264 - 126s - loss: 0.5461 - accuracy: 0.7426 - val_loss: 0.6540 - val_accuracy: 0.7192
Confusion matrix: 
 [[762  22]
 [279   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 5.64
Validation accuracy: 71.92
Validation recall: 3.12
Validation precision: 29.03
Validation AUC: 0.331416596060812
Validation class accuracies: [0.9719387755102041, 0.03125]
TARGET: 1
target metric(test f1): 0.05642633228840126
inside not defaulting
The validation tracker metric at 0.05825242718446602 hasn't increased by 0 in 1 epochs
Epoch 7/80
264/264 - 126s - loss: 0.5477 - accuracy: 0.7419 - val_loss: 0.6441 - val_accuracy: 0.7118
Confusion matrix: 
 [[762  22]
 [287   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 0.64
Validation accuracy: 71.18
Validation recall: 0.35
Validation precision: 4.35
Validation AUC: 0.3047545317466679
Validation class accuracies: [0.9719387755102041, 0.003472222222222222]
TARGET: 1
target metric(test f1): 0.006430868167202572
inside not defaulting
The validation tracker metric at 0.05825242718446602 hasn't increased by 0 in 2 epochs
Epoch 8/80
264/264 - 126s - loss: 0.5317 - accuracy: 0.7526 - val_loss: 0.6167 - val_accuracy: 0.7024
Confusion matrix: 
 [[720  64]
 [255  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 17.14
Validation accuracy: 70.24
Validation recall: 11.46
Validation precision: 34.02
Validation AUC: 0.32741268179744654
Validation class accuracies: [0.9183673469387755, 0.11458333333333333]
TARGET: 1
target metric(test f1): 0.17142857142857143
inside not defaulting
Saving model...
Epoch 9/80
264/264 - 126s - loss: 0.5142 - accuracy: 0.7607 - val_loss: 0.6169 - val_accuracy: 0.7257
Confusion matrix: 
 [[770  14]
 [280   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 5.16
Validation accuracy: 72.57
Validation recall: 2.78
Validation precision: 36.36
Validation AUC: 0.33443060106828865
Validation class accuracies: [0.9821428571428571, 0.027777777777777776]
TARGET: 1
target metric(test f1): 0.051612903225806445
inside not defaulting
The validation tracker metric at 0.17142857142857143 hasn't increased by 0 in 1 epochs
Epoch 10/80
264/264 - 126s - loss: 0.5119 - accuracy: 0.7593 - val_loss: 0.6518 - val_accuracy: 0.6978
Confusion matrix: 
 [[715  69]
 [255  33]]
Validation f1: 16.92
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 69.78
Validation recall: 11.46
Validation precision: 32.35
Validation AUC: 0.3387849643562287
Validation class accuracies: [0.9119897959183674, 0.11458333333333333]
TARGET: 1
target metric(test f1): 0.16923076923076924
inside not defaulting
The validation tracker metric at 0.17142857142857143 hasn't increased by 0 in 2 epochs
Epoch 11/80
264/264 - 126s - loss: 0.5181 - accuracy: 0.7517 - val_loss: 0.6257 - val_accuracy: 0.6959
Confusion matrix: 
 [[705  79]
 [247  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.10
Validation accuracy: 69.59
Validation recall: 14.24
Validation precision: 34.17
Validation AUC: 0.31033311337947356
Validation class accuracies: [0.8992346938775511, 0.1423611111111111]
TARGET: 1
target metric(test f1): 0.20098039215686272
inside not defaulting
Saving model...
Epoch 12/80
264/264 - 126s - loss: 0.4880 - accuracy: 0.7723 - val_loss: 0.7076 - val_accuracy: 0.6959
Confusion matrix: 
 [[710  74]
 [252  36]]
Validation f1: 18.09
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 69.59
Validation recall: 12.50
Validation precision: 32.73
Validation AUC: 0.30581155476830907
Validation class accuracies: [0.9056122448979592, 0.125]
TARGET: 1
target metric(test f1): 0.18090452261306533
inside not defaulting
The validation tracker metric at 0.20098039215686272 hasn't increased by 0 in 1 epochs
Epoch 13/80
264/264 - 126s - loss: 0.4475 - accuracy: 0.8018 - val_loss: 0.6818 - val_accuracy: 0.6875
Confusion matrix: 
 [[710  74]
 [261  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.88
Validation accuracy: 68.75
Validation recall: 9.38
Validation precision: 26.73
Validation AUC: 0.2942007512828116
Validation class accuracies: [0.9056122448979592, 0.09375]
TARGET: 1
target metric(test f1): 0.13881748071979436
inside not defaulting
The validation tracker metric at 0.20098039215686272 hasn't increased by 0 in 2 epochs
Epoch 14/80
264/264 - 126s - loss: 0.4318 - accuracy: 0.8079 - val_loss: 0.7175 - val_accuracy: 0.6688
Confusion matrix: 
 [[680 104]
 [251  37]]
Validation f1: 17.25
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 66.88
Validation recall: 12.85
Validation precision: 26.24
Validation AUC: 0.2985208692081755
Validation class accuracies: [0.8673469387755102, 0.1284722222222222]
TARGET: 1
target metric(test f1): 0.17249417249417248
inside not defaulting
The validation tracker metric at 0.20098039215686272 hasn't increased by 0 in 3 epochs
Epoch 15/80
264/264 - 126s - loss: 0.4279 - accuracy: 0.8041 - val_loss: 0.7567 - val_accuracy: 0.6856
Confusion matrix: 
 [[708  76]
 [261  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 13.81
Validation accuracy: 68.56
Validation recall: 9.38
Validation precision: 26.21
Validation AUC: 0.2885121484038538
Validation class accuracies: [0.9030612244897959, 0.09375]
TARGET: 1
target metric(test f1): 0.13810741687979539
inside not defaulting
The validation tracker metric at 0.20098039215686272 hasn't increased by 0 in 4 epochs
Epoch 16/80
264/264 - 126s - loss: 0.3895 - accuracy: 0.8283 - val_loss: 0.8524 - val_accuracy: 0.6828
Confusion matrix: 
 [[710  74]
 [266  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 11.46
Validation accuracy: 68.28
Validation recall: 7.64
Validation precision: 22.92
Validation AUC: 0.2902372245023912
Validation class accuracies: [0.9056122448979592, 0.0763888888888889]
TARGET: 1
target metric(test f1): 0.11458333333333333
inside not defaulting
The validation tracker metric at 0.20098039215686272 hasn't increased by 0 in 5 epochs
Epoch 17/80
264/264 - 126s - loss: 0.3470 - accuracy: 0.8542 - val_loss: 0.8833 - val_accuracy: 0.6418
Confusion matrix: 
 [[609 175]
 [209  79]]
Validation f1: 29.15
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 64.18
Validation recall: 27.43
Validation precision: 31.10
Validation AUC: 0.30437886391613334
Validation class accuracies: [0.7767857142857143, 0.2743055555555556]
TARGET: 1
target metric(test f1): 0.2915129151291513
inside not defaulting
Saving model...
Epoch 18/80
264/264 - 126s - loss: 0.3422 - accuracy: 0.8590 - val_loss: 0.9014 - val_accuracy: 0.6493
Confusion matrix: 
 [[648 136]
 [240  48]]
Validation f1: 20.34
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 64.93
Validation recall: 16.67
Validation precision: 26.09
Validation AUC: 0.29463703717037015
Validation class accuracies: [0.826530612244898, 0.16666666666666666]
TARGET: 1
target metric(test f1): 0.20338983050847456
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 1 epochs
Epoch 19/80
264/264 - 126s - loss: 0.3293 - accuracy: 0.8609 - val_loss: 1.0763 - val_accuracy: 0.6772
Confusion matrix: 
 [[675 109]
 [237  51]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.77
Validation accuracy: 67.72
Validation recall: 17.71
Validation precision: 31.87
Validation AUC: 0.31640902220417066
Validation class accuracies: [0.860969387755102, 0.17708333333333334]
TARGET: 1
target metric(test f1): 0.2276785714285714
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 2 epochs
Epoch 20/80
264/264 - 126s - loss: 0.3169 - accuracy: 0.8680 - val_loss: 0.9574 - val_accuracy: 0.6567
Confusion matrix: 
 [[649 135]
 [233  55]]
Validation f1: 23.01
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 65.67
Validation recall: 19.10
Validation precision: 28.95
Validation AUC: 0.29913354001133363
Validation class accuracies: [0.8278061224489796, 0.1909722222222222]
TARGET: 1
target metric(test f1): 0.2301255230125523
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 3 epochs
Epoch 21/80
264/264 - 127s - loss: 0.2981 - accuracy: 0.8815 - val_loss: 0.9784 - val_accuracy: 0.6446
Confusion matrix: 
 [[622 162]
 [219  69]]
Validation f1: 26.59
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 64.46
Validation recall: 23.96
Validation precision: 29.87
Validation AUC: 0.287753669522879
Validation class accuracies: [0.7933673469387755, 0.23958333333333334]
TARGET: 1
target metric(test f1): 0.2658959537572254
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 4 epochs
Epoch 22/80
264/264 - 132s - loss: 0.2812 - accuracy: 0.8922 - val_loss: 1.0526 - val_accuracy: 0.6119
Confusion matrix: 
 [[573 211]
 [205  83]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.52
Validation accuracy: 61.19
Validation recall: 28.82
Validation precision: 28.23
Validation AUC: 0.292577603491684
Validation class accuracies: [0.7308673469387755, 0.2881944444444444]
TARGET: 1
target metric(test f1): 0.28522336769759443
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 5 epochs
Epoch 23/80
264/264 - 133s - loss: 0.2830 - accuracy: 0.8870 - val_loss: 1.0249 - val_accuracy: 0.6493
Confusion matrix: 
 [[632 152]
 [224  64]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.40
Validation accuracy: 64.93
Validation recall: 22.22
Validation precision: 29.63
Validation AUC: 0.2767689416012318
Validation class accuracies: [0.8061224489795918, 0.2222222222222222]
TARGET: 1
target metric(test f1): 0.25396825396825395
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 6 epochs
Epoch 24/80
264/264 - 134s - loss: 0.2812 - accuracy: 0.8870 - val_loss: 1.0657 - val_accuracy: 0.6362
Confusion matrix: 
 [[613 171]
 [219  69]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.14
Validation accuracy: 63.62
Validation recall: 23.96
Validation precision: 28.75
Validation AUC: 0.2834778294254081
Validation class accuracies: [0.7818877551020408, 0.23958333333333334]
TARGET: 1
target metric(test f1): 0.26136363636363635
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 7 epochs
Epoch 25/80
264/264 - 133s - loss: 0.2669 - accuracy: 0.8932 - val_loss: 1.0431 - val_accuracy: 0.6427
Confusion matrix: 
 [[615 169]
 [214  74]]
Validation f1: 27.87
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 64.27
Validation recall: 25.69
Validation precision: 30.45
Validation AUC: 0.2780822814260503
Validation class accuracies: [0.7844387755102041, 0.2569444444444444]
TARGET: 1
target metric(test f1): 0.2787193973634652
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 8 epochs
Epoch 26/80
264/264 - 133s - loss: 0.2553 - accuracy: 0.8936 - val_loss: 1.0725 - val_accuracy: 0.6334
Confusion matrix: 
 [[607 177]
 [216  72]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.82
Validation accuracy: 63.34
Validation recall: 25.00
Validation precision: 28.92
Validation AUC: 0.27832424222184715
Validation class accuracies: [0.7742346938775511, 0.25]
TARGET: 1
target metric(test f1): 0.2681564245810055
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 9 epochs
Epoch 27/80
264/264 - 134s - loss: 0.2608 - accuracy: 0.8922 - val_loss: 1.0697 - val_accuracy: 0.6567
Confusion matrix: 
 [[656 128]
 [240  48]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.69
Validation accuracy: 65.67
Validation recall: 16.67
Validation precision: 27.27
Validation AUC: 0.2744470690898668
Validation class accuracies: [0.8367346938775511, 0.16666666666666666]
TARGET: 1
target metric(test f1): 0.20689655172413793
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 10 epochs
Epoch 28/80
264/264 - 133s - loss: 0.2580 - accuracy: 0.8984 - val_loss: 1.1107 - val_accuracy: 0.6343
Confusion matrix: 
 [[609 175]
 [217  71]]
Validation f1: 26.59
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 63.43
Validation recall: 24.65
Validation precision: 28.86
Validation AUC: 0.27954983924809906
Validation class accuracies: [0.7767857142857143, 0.2465277777777778]
TARGET: 1
target metric(test f1): 0.26591760299625467
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 11 epochs
Epoch 29/80
264/264 - 132s - loss: 0.2616 - accuracy: 0.8946 - val_loss: 1.0753 - val_accuracy: 0.6465
Confusion matrix: 
 [[631 153]
 [226  62]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.65
Validation accuracy: 64.65
Validation recall: 21.53
Validation precision: 28.84
Validation AUC: 0.27656974578812865
Validation class accuracies: [0.8048469387755102, 0.2152777777777778]
TARGET: 1
target metric(test f1): 0.24652087475149106
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 12 epochs
Epoch 30/80
264/264 - 134s - loss: 0.2450 - accuracy: 0.9053 - val_loss: 1.1354 - val_accuracy: 0.6325
Confusion matrix: 
 [[610 174]
 [220  68]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.66
Validation accuracy: 63.25
Validation recall: 23.61
Validation precision: 28.10
Validation AUC: 0.2825105391542372
Validation class accuracies: [0.7780612244897959, 0.2361111111111111]
TARGET: 1
target metric(test f1): 0.25660377358490566
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 13 epochs
Epoch 31/80
264/264 - 133s - loss: 0.2604 - accuracy: 0.8993 - val_loss: 1.1253 - val_accuracy: 0.6278
Confusion matrix: 
 [[596 188]
 [211  77]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.85
Validation accuracy: 62.78
Validation recall: 26.74
Validation precision: 29.06
Validation AUC: 0.28376779397702756
Validation class accuracies: [0.7602040816326531, 0.2673611111111111]
TARGET: 1
target metric(test f1): 0.27848101265822783
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 14 epochs
Epoch 32/80
264/264 - 133s - loss: 0.2551 - accuracy: 0.8972 - val_loss: 1.1129 - val_accuracy: 0.6287
Confusion matrix: 
 [[602 182]
 [216  72]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.57
Validation accuracy: 62.87
Validation recall: 25.00
Validation precision: 28.35
Validation AUC: 0.28135762654373886
Validation class accuracies: [0.7678571428571429, 0.25]
TARGET: 1
target metric(test f1): 0.2656826568265683
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 15 epochs
Epoch 33/80
264/264 - 134s - loss: 0.2561 - accuracy: 0.8955 - val_loss: 1.0988 - val_accuracy: 0.6325
Confusion matrix: 
 [[609 175]
 [219  69]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.94
Validation accuracy: 63.25
Validation recall: 23.96
Validation precision: 28.28
Validation AUC: 0.2786114504830093
Validation class accuracies: [0.7767857142857143, 0.23958333333333334]
TARGET: 1
target metric(test f1): 0.2593984962406015
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 16 epochs
Epoch 34/80
264/264 - 133s - loss: 0.2520 - accuracy: 0.8989 - val_loss: 1.1110 - val_accuracy: 0.6325
Confusion matrix: 
 [[607 177]
 [217  71]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.49
Validation accuracy: 63.25
Validation recall: 24.65
Validation precision: 28.63
Validation AUC: 0.28076887083610547
Validation class accuracies: [0.7742346938775511, 0.2465277777777778]
TARGET: 1
target metric(test f1): 0.2649253731343284
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 17 epochs
Epoch 35/80
264/264 - 132s - loss: 0.2483 - accuracy: 0.9019 - val_loss: 1.0863 - val_accuracy: 0.6334
Confusion matrix: 
 [[615 169]
 [224  64]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.57
Validation accuracy: 63.34
Validation recall: 22.22
Validation precision: 27.47
Validation AUC: 0.2777485593580834
Validation class accuracies: [0.7844387755102041, 0.2222222222222222]
TARGET: 1
target metric(test f1): 0.2456813819577735
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 18 epochs
Epoch 36/80
264/264 - 132s - loss: 0.2444 - accuracy: 0.9012 - val_loss: 1.1264 - val_accuracy: 0.6287
Confusion matrix: 
 [[604 180]
 [218  70]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.02
Validation accuracy: 62.87
Validation recall: 24.31
Validation precision: 28.00
Validation AUC: 0.2803078023561349
Validation class accuracies: [0.7704081632653061, 0.24305555555555555]
TARGET: 1
target metric(test f1): 0.26022304832713755
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 19 epochs
Epoch 37/80
264/264 - 132s - loss: 0.2498 - accuracy: 0.9022 - val_loss: 1.1163 - val_accuracy: 0.6325
Confusion matrix: 
 [[612 172]
 [222  66]]
Validation f1: 25.10
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 63.25
Validation recall: 22.92
Validation precision: 27.73
Validation AUC: 0.2796800710597438
Validation class accuracies: [0.7806122448979592, 0.22916666666666666]
TARGET: 1
target metric(test f1): 0.2509505703422053
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 20 epochs
Epoch 38/80
264/264 - 133s - loss: 0.2493 - accuracy: 0.9010 - val_loss: 1.1277 - val_accuracy: 0.6306
Confusion matrix: 
 [[608 176]
 [220  68]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.56
Validation accuracy: 63.06
Validation recall: 23.61
Validation precision: 27.87
Validation AUC: 0.27985422607943705
Validation class accuracies: [0.7755102040816326, 0.2361111111111111]
TARGET: 1
target metric(test f1): 0.25563909774436094
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 21 epochs
Epoch 39/80
264/264 - 133s - loss: 0.2440 - accuracy: 0.9038 - val_loss: 1.1219 - val_accuracy: 0.6381
Confusion matrix: 
 [[616 168]
 [220  68]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.95
Validation accuracy: 63.81
Validation recall: 23.61
Validation precision: 28.81
Validation AUC: 0.27982664133822654
Validation class accuracies: [0.7857142857142857, 0.2361111111111111]
TARGET: 1
target metric(test f1): 0.25954198473282447
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 22 epochs
Epoch 40/80
264/264 - 133s - loss: 0.2469 - accuracy: 0.9008 - val_loss: 1.1513 - val_accuracy: 0.6315
Confusion matrix: 
 [[607 177]
 [218  70]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.17
Validation accuracy: 63.15
Validation recall: 24.31
Validation precision: 28.34
Validation AUC: 0.28117392962965265
Validation class accuracies: [0.7742346938775511, 0.24305555555555555]
TARGET: 1
target metric(test f1): 0.2616822429906542
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 23 epochs
Epoch 41/80
264/264 - 132s - loss: 0.2461 - accuracy: 0.8981 - val_loss: 1.1406 - val_accuracy: 0.6278
Confusion matrix: 
 [[603 181]
 [218  70]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.97
Validation accuracy: 62.78
Validation recall: 24.31
Validation precision: 27.89
Validation AUC: 0.279235127256411
Validation class accuracies: [0.7691326530612245, 0.24305555555555555]
TARGET: 1
target metric(test f1): 0.2597402597402597
inside not defaulting
The validation tracker metric at 0.2915129151291513 hasn't increased by 0 in 24 epochs
Epoch 42/80
264/264 - 133s - loss: 0.2337 - accuracy: 0.9088 - val_loss: 1.1193 - val_accuracy: 0.6362
Confusion matrix: 
 [[615 169]
 [221  67]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.57
Validation accuracy: 63.62
Validation recall: 23.26
Validation precision: 28.39
Validation AUC: 0.2783182358674835
Validation class accuracies: [0.7844387755102041, 0.2326388888888889]

The metrics for the epoch with the best target metric are: 
Best cm: [[609 175]
 [209  79]]
Best f1: 0.2915129151291513
Best accuracy: 0.6417910447761194
Best recall: 0.2743055555555556
Best precision: 0.3110236220472441
Best AUC: 0.30437886391613334
Best epoch: 17
TARGET: 1
target metric(test f1): 0.25572519083969464
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[15 38]
 [ 3 19]]
F1: 0.481012658227848
AUC: 0.6184848484848484
Accuracy: 0.4533333333333333
Precision: 0.3333333333333333
Recall: 0.8636363636363636
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[27 26]
 [13  9]]
F1: 0.31578947368421045
AUC: 0.4197835497835498
Accuracy: 0.48
Precision: 0.2571428571428571
Recall: 0.4090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[40 13]
 [18  4]]
F1: 0.20512820512820512
AUC: 0.32855614973262026
Accuracy: 0.5866666666666667
Precision: 0.23529411764705882
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_80.xls...
Done.
Epoch: epoch11
Starting...
CM: [[31 22]
 [11 11]]
F1: 0.4
AUC: 0.49
Accuracy: 0.56
Precision: 0.3333333333333333
Recall: 0.5
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch11.xls...
Done.
Epoch: epoch11
Starting...
CM: [[43 10]
 [15  7]]
F1: 0.358974358974359
AUC: 0.46497326203208555
Accuracy: 0.6666666666666666
Precision: 0.4117647058823529
Recall: 0.3181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch11.xls...
Done.
Epoch: epoch11
Starting...
CM: [[50  3]
 [21  1]]
F1: 0.07692307692307693
AUC: 0.2877272727272727
Accuracy: 0.68
Precision: 0.25
Recall: 0.045454545454545456
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch11.xls...
Done.
Epoch: epoch17
Starting...
CM: [[16 37]
 [ 3 19]]
F1: 0.48717948717948717
AUC: 0.6214610389610391
Accuracy: 0.4666666666666667
Precision: 0.3392857142857143
Recall: 0.8636363636363636
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch17.xls...
Done.
Epoch: epoch17
Starting...
CM: [[27 26]
 [ 9 13]]
F1: 0.4262295081967213
AUC: 0.5221212121212121
Accuracy: 0.5333333333333333
Precision: 0.3333333333333333
Recall: 0.5909090909090909
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch17.xls...
Done.
Epoch: epoch17
Starting...
CM: [[42 11]
 [17  5]]
F1: 0.2631578947368421
AUC: 0.38321969696969693
Accuracy: 0.6266666666666667
Precision: 0.3125
Recall: 0.22727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch17.xls...
Done.
Epoch: epoch4
Starting...
CM: [[51  2]
 [19  3]]
F1: 0.22222222222222218
AUC: 0.4948484848484848
Accuracy: 0.72
Precision: 0.6
Recall: 0.13636363636363635
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch4.xls...
Done.
Epoch: epoch4
Starting...
CM: [[51  2]
 [22  0]]
F1: 0.0
AUC: 0.14666666666666667
Accuracy: 0.68
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch4.xls...
Done.
Epoch: epoch4
Starting...
CM: [[52  1]
 [22  0]]
F1: 0.0
AUC: 0.14666666666666667
Accuracy: 0.6933333333333334
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch4.xls...
Done.
Epoch: epoch5
Starting...
CM: [[46  7]
 [19  3]]
F1: 0.18749999999999997
AUC: 0.3448484848484848
Accuracy: 0.6533333333333333
Precision: 0.3
Recall: 0.13636363636363635
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch5.xls...
Done.
Epoch: epoch5
Starting...
CM: [[53  0]
 [22  0]]
F1: 0.0
AUC: 0.6466666666666667
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch5.xls...
Done.
Epoch: epoch5
Starting...
CM: [[53  0]
 [22  0]]
F1: 0.0
AUC: 0.6466666666666667
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch5.xls...
Done.
Epoch: epoch8
Starting...
CM: [[32 21]
 [11 11]]
F1: 0.4074074074074074
AUC: 0.49520833333333336
Accuracy: 0.5733333333333334
Precision: 0.34375
Recall: 0.5
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch8.xls...
Done.
Epoch: epoch8
Starting...
CM: [[45  8]
 [18  4]]
F1: 0.23529411764705885
AUC: 0.37757575757575756
Accuracy: 0.6533333333333333
Precision: 0.3333333333333333
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch8.xls...
Done.
Epoch: epoch8
Starting...
CM: [[50  3]
 [21  1]]
F1: 0.07692307692307693
AUC: 0.2877272727272727
Accuracy: 0.68
Precision: 0.25
Recall: 0.045454545454545456
Ended. Saving the Excel Sheet ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/validation_sheet_epoch8.xls...
Done.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
wandb: Waiting for W&B process to finish, PID 17184
wandb: Program ended successfully.
wandb: - 0.11MB of 0.11MB uploaded (0.00MB deduped)wandb: \ 0.11MB of 0.11MB uploaded (0.00MB deduped)wandb: | 0.11MB of 0.13MB uploaded (0.00MB deduped)wandb: / 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb: - 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb: \ 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb: | 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb: / 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210601_213110-28t8r2th/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210601_213110-28t8r2th/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.90883
wandb:         val_accuracy 0.63619
wandb:             _runtime 6923
wandb:           _timestamp 1622589993
wandb:                _step 310
wandb:           train_loss 0.23372
wandb:             val_loss 1.11931
wandb:           val_recall 0.23264
wandb:        val_precision 0.2839
wandb:               val_f1 0.25573
wandb:              val_auc 0.27832
wandb:                   lr <tensorflow_addons.o...
wandb:          best_val_f1 0.29151
wandb:    best_val_accuracy 0.64179
wandb:   best_val_precision 0.31102
wandb:      best_val_recall 0.27431
wandb:             best_auc 0.30438
wandb:           best_epoch 17
wandb:           best_bd_f1 0.48718
wandb:          best_bd_auc 0.62146
wandb:     best_bd_accuracy 0.46667
wandb:    best_bd_precision 0.33929
wandb:       best_bd_recall 0.86364
wandb:        best_bd_epoch epoch17
wandb: Run history:
wandb:   train_accuracy ▁▃▃▃▄▃▃▄▄▄▄▄▅▅▅▆▇▇▇▇█▇▇█████████████████
wandb:     val_accuracy █████▇▇▆█▆▆▆▅▄▅▅▃▃▅▄▁▃▂▃▂▄▂▃▂▂▂▂▂▂▂▂▂▃▂▂
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▆▆▆▆▆▆▆▆▆▅▄▄▄▄▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▁▁▂▂▁▁▂▂▃▂▃▃▄▅▅▇▆▇▆▇▇▇▇▇▇███▇█▇██████
wandb:       val_recall ▁▁▁▂▂▂▁▄▂▄▄▄▃▄▃▃█▅▅▆█▆▇▇▇▅▇▆▇▇▇▇▇▆▇▇▇▇▇▇
wandb:    val_precision ▁▁▁▆█▆▂▇▇▆▇▆▅▅▅▅▆▅▆▆▆▆▆▆▆▅▆▆▆▆▆▆▆▅▆▆▆▆▆▆
wandb:           val_f1 ▁▁▁▂▂▂▁▅▂▅▆▅▄▅▄▄█▆▆▇█▇▇█▇▆▇▇▇█▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▁▅▄▅▇▅▇██▅▅▃▄▃▃▄▄▆▄▃▂▂▂▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb: 
wandb: Synced 6 W&B file(s), 17 media file(s), 12 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2181: https://wandb.ai/arachid1/tensorboard-integration/runs/28t8r2th


 See logs at ../../new_cache/conv__2181__06_2130__v29__lowlr_increasing/logs/