Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2239
Description:  vizs
2021-06-22 18:42:46.842164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-22 18:42:49.098669: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-22 18:42:49.099750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-22 18:42:49.112909: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:49.113580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-22 18:42:49.113606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 18:42:49.116928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 18:42:49.117006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-22 18:42:49.118035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-22 18:42:49.118298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-22 18:42:49.119256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-22 18:42:49.120088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-22 18:42:49.120229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 18:42:49.120340: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:49.121102: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:49.121960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2239.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2239__06_1842__v39__vizs
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 300, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-22 18:42:54.276691: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-22 18:42:54.276936: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:54.277632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-22 18:42:54.277671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 18:42:54.277715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 18:42:54.277735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-22 18:42:54.277754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-22 18:42:54.277772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-22 18:42:54.277790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-22 18:42:54.277809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-22 18:42:54.277832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 18:42:54.277918: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:54.278596: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:54.279231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-22 18:42:54.279274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 18:42:55.005503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-22 18:42:55.005546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-22 18:42:55.005554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-22 18:42:55.005833: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:55.006572: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:55.007242: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 18:42:55.007873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-22 18:42:56.268848: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-22 18:42:56.270399: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-22 18:42:56.605165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 18:42:58.550601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 18:42:59.033423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
154/154 - 237s - loss: 0.8239 - accuracy: 0.7070 - val_loss: 0.2555 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.13288978841724708
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 235s - loss: 0.4854 - accuracy: 0.7871 - val_loss: 0.2626 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.10255359404474045
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 235s - loss: 0.4690 - accuracy: 0.8002 - val_loss: 0.2744 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19317067729448917
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 235s - loss: 0.3954 - accuracy: 0.8103 - val_loss: 0.1797 - val_accuracy: 0.9447
Confusion matrix: 
 [[573   0]
 [ 34   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.   0.  ]
 [0.81 0.19]]
Validation f1: 32.00
Validation accuracy: 94.47
Validation recall: 19.05
Validation precision: 100.00
Validation AUC: 0.5965900662038073
Validation class accuracies: [1.0, 0.19047619047619047]
Saving model...
Epoch 5/65
154/154 - 235s - loss: 0.4076 - accuracy: 0.8262 - val_loss: 1.6951 - val_accuracy: 0.5740
Confusion matrix: 
 [[311 262]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.543 0.457]
 [0.    1.   ]]
Validation f1: 24.28
Validation accuracy: 57.40
Validation recall: 100.00
Validation precision: 13.82
Validation AUC: 0.6011613281498113
Validation class accuracies: [0.5427574171029669, 1.0]
The validation tracker metric at 0.32 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 235s - loss: 0.3350 - accuracy: 0.8246 - val_loss: 5.6657 - val_accuracy: 0.1057
Confusion matrix: 
 [[ 23 550]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.04 0.96]
 [0.   1.  ]]
Validation f1: 13.25
Validation accuracy: 10.57
Validation recall: 100.00
Validation precision: 7.09
Validation AUC: 0.48720977517979874
Validation class accuracies: [0.04013961605584642, 1.0]
The validation tracker metric at 0.32 hasn't increased by 0 in 2 epochs
Epoch 7/65
154/154 - 235s - loss: 0.3548 - accuracy: 0.8421 - val_loss: 1.4214 - val_accuracy: 0.5707
Confusion matrix: 
 [[310 263]
 [  1  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.541 0.459]
 [0.024 0.976]]
Validation f1: 23.70
Validation accuracy: 57.07
Validation recall: 97.62
Validation precision: 13.49
Validation AUC: 0.5989613936304237
Validation class accuracies: [0.5410122164048866, 0.9761904761904762]
The validation tracker metric at 0.32 hasn't increased by 0 in 3 epochs
Epoch 8/65
154/154 - 235s - loss: 0.3196 - accuracy: 0.8254 - val_loss: 0.6739 - val_accuracy: 0.6992
Confusion matrix: 
 [[390 183]
 [  2  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.681 0.319]
 [0.048 0.952]]
Validation f1: 30.19
Validation accuracy: 69.92
Validation recall: 95.24
Validation precision: 17.94
Validation AUC: 0.6774748088535618
Validation class accuracies: [0.680628272251309, 0.9523809523809523]
The validation tracker metric at 0.32 hasn't increased by 0 in 4 epochs
Epoch 9/65
154/154 - 235s - loss: 0.3049 - accuracy: 0.8755 - val_loss: 0.4737 - val_accuracy: 0.8179
Confusion matrix: 
 [[471 102]
 [ 10  32]]
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.238 0.762]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.36
Validation accuracy: 81.79
Validation recall: 76.19
Validation precision: 23.88
Validation AUC: 0.5698876749541104
Validation class accuracies: [0.8219895287958116, 0.7619047619047619]
Saving model...
Epoch 10/65
154/154 - 235s - loss: 0.2547 - accuracy: 0.8746 - val_loss: 3.1183 - val_accuracy: 0.2748
Confusion matrix: 
 [[127 446]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.222 0.778]
 [0.    1.   ]]
Validation f1: 15.85
Validation accuracy: 27.48
Validation recall: 100.00
Validation precision: 8.61
Validation AUC: 0.6002334507136114
Validation class accuracies: [0.22164048865619546, 1.0]
The validation tracker metric at 0.36363636363636365 hasn't increased by 0 in 1 epochs
Epoch 11/65
154/154 - 235s - loss: 0.2404 - accuracy: 0.8848 - val_loss: 2.3097 - val_accuracy: 0.4634
Confusion matrix: 
 [[243 330]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.424 0.576]
 [0.    1.   ]]
Validation f1: 20.29
Validation accuracy: 46.34
Validation recall: 100.00
Validation precision: 11.29
Validation AUC: 0.5868862479564565
Validation class accuracies: [0.42408376963350786, 1.0]
The validation tracker metric at 0.36363636363636365 hasn't increased by 0 in 2 epochs
Epoch 12/65
154/154 - 235s - loss: 0.2208 - accuracy: 0.9023 - val_loss: 0.2039 - val_accuracy: 0.9415
Confusion matrix: 
 [[553  20]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.381 0.619]]
Validation f1: 59.09
Validation accuracy: 94.15
Validation recall: 61.90
Validation precision: 56.52
Validation AUC: 0.6259729785377017
Validation class accuracies: [0.9650959860383944, 0.6190476190476191]
Saving model...
Epoch 13/65
154/154 - 235s - loss: 0.1913 - accuracy: 0.9141 - val_loss: 0.5463 - val_accuracy: 0.8016
Confusion matrix: 
 [[459 114]
 [  8  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.801 0.199]
 [0.19  0.81 ]]
Validation f1: 35.79
Validation accuracy: 80.16
Validation recall: 80.95
Validation precision: 22.97
Validation AUC: 0.6713065716624864
Validation class accuracies: [0.8010471204188482, 0.8095238095238095]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 1 epochs
Epoch 14/65
154/154 - 235s - loss: 0.2096 - accuracy: 0.9064 - val_loss: 7.0575 - val_accuracy: 0.2602
Confusion matrix: 
 [[118 455]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.206 0.794]
 [0.    1.   ]]
Validation f1: 15.58
Validation accuracy: 26.02
Validation recall: 100.00
Validation precision: 8.45
Validation AUC: 0.5783269311225017
Validation class accuracies: [0.20593368237347295, 1.0]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 2 epochs
Epoch 15/65
154/154 - 234s - loss: 0.2548 - accuracy: 0.8767 - val_loss: 2.8459 - val_accuracy: 0.3203
Confusion matrix: 
 [[155 418]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.271 0.729]
 [0.    1.   ]]
Validation f1: 16.73
Validation accuracy: 32.03
Validation recall: 100.00
Validation precision: 9.13
Validation AUC: 0.6825890001082486
Validation class accuracies: [0.2705061082024433, 1.0]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 3 epochs
Epoch 16/65
154/154 - 235s - loss: 0.2015 - accuracy: 0.9145 - val_loss: 0.1987 - val_accuracy: 0.9415
Confusion matrix: 
 [[555  18]
 [ 18  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.429 0.571]]
Validation f1: 57.14
Validation accuracy: 94.15
Validation recall: 57.14
Validation precision: 57.14
Validation AUC: 0.6170129785971994
Validation class accuracies: [0.9685863874345549, 0.5714285714285714]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 4 epochs
Epoch 17/65
154/154 - 236s - loss: 0.1365 - accuracy: 0.9373 - val_loss: 0.2842 - val_accuracy: 0.9089
Confusion matrix: 
 [[536  37]
 [ 19  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.452 0.548]]
Validation f1: 45.10
Validation accuracy: 90.89
Validation recall: 54.76
Validation precision: 38.33
Validation AUC: 0.5318575534933844
Validation class accuracies: [0.9354275741710296, 0.5476190476190477]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 5 epochs
Epoch 18/65
154/154 - 235s - loss: 0.1528 - accuracy: 0.9333 - val_loss: 0.4997 - val_accuracy: 0.8732
Confusion matrix: 
 [[521  52]
 [ 26  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.619 0.381]]
Validation f1: 29.09
Validation accuracy: 87.32
Validation recall: 38.10
Validation precision: 23.53
Validation AUC: 0.2078189988232657
Validation class accuracies: [0.9092495636998255, 0.38095238095238093]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 19/65
154/154 - 235s - loss: 0.1094 - accuracy: 0.9528 - val_loss: 0.2128 - val_accuracy: 0.9447
Confusion matrix: 
 [[550  23]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.262 0.738]]
Validation f1: 64.58
Validation accuracy: 94.47
Validation recall: 73.81
Validation precision: 57.41
Validation AUC: 0.707280612481353
Validation class accuracies: [0.9598603839441536, 0.7380952380952381]
Saving model...
Epoch 20/65
154/154 - 235s - loss: 0.0984 - accuracy: 0.9540 - val_loss: 0.8976 - val_accuracy: 0.7398
Confusion matrix: 
 [[420 153]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.733 0.267]
 [0.167 0.833]]
Validation f1: 30.43
Validation accuracy: 73.98
Validation recall: 83.33
Validation precision: 18.62
Validation AUC: 0.5862612389158501
Validation class accuracies: [0.7329842931937173, 0.8333333333333334]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 1 epochs
Epoch 21/65
154/154 - 235s - loss: 0.0591 - accuracy: 0.9731 - val_loss: 0.2279 - val_accuracy: 0.9398
Confusion matrix: 
 [[547  26]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.262 0.738]]
Validation f1: 62.63
Validation accuracy: 93.98
Validation recall: 73.81
Validation precision: 54.39
Validation AUC: 0.6603997986004246
Validation class accuracies: [0.9546247818499127, 0.7380952380952381]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 2 epochs
Epoch 22/65
154/154 - 235s - loss: 0.0758 - accuracy: 0.9703 - val_loss: 0.2673 - val_accuracy: 0.9317
Confusion matrix: 
 [[542  31]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.262 0.738]]
Validation f1: 59.62
Validation accuracy: 93.17
Validation recall: 73.81
Validation precision: 50.00
Validation AUC: 0.7003683311454766
Validation class accuracies: [0.9458987783595113, 0.7380952380952381]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 3 epochs
Epoch 23/65
154/154 - 235s - loss: 0.0638 - accuracy: 0.9715 - val_loss: 0.2680 - val_accuracy: 0.9203
Confusion matrix: 
 [[535  38]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.262 0.738]]
Validation f1: 55.86
Validation accuracy: 92.03
Validation recall: 73.81
Validation precision: 44.93
Validation AUC: 0.6818051077595555
Validation class accuracies: [0.9336823734729494, 0.7380952380952381]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 4 epochs
Epoch 24/65
154/154 - 235s - loss: 0.0460 - accuracy: 0.9849 - val_loss: 3.2625 - val_accuracy: 0.4504
Confusion matrix: 
 [[238 335]
 [  3  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.415 0.585]
 [0.071 0.929]]
Validation f1: 18.75
Validation accuracy: 45.04
Validation recall: 92.86
Validation precision: 10.43
Validation AUC: 0.40935053577173974
Validation class accuracies: [0.41535776614310643, 0.9285714285714286]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 5 epochs
Epoch 25/65
154/154 - 235s - loss: 0.0433 - accuracy: 0.9805 - val_loss: 0.2878 - val_accuracy: 0.9220
Confusion matrix: 
 [[537  36]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.286 0.714]]
Validation f1: 55.56
Validation accuracy: 92.20
Validation recall: 71.43
Validation precision: 45.45
Validation AUC: 0.6398877238825685
Validation class accuracies: [0.93717277486911, 0.7142857142857143]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 26/65
154/154 - 235s - loss: 0.0259 - accuracy: 0.9902 - val_loss: 0.2892 - val_accuracy: 0.9285
Confusion matrix: 
 [[541  32]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.286 0.714]]
Validation f1: 57.69
Validation accuracy: 92.85
Validation recall: 71.43
Validation precision: 48.39
Validation AUC: 0.6557024087515299
Validation class accuracies: [0.944153577661431, 0.7142857142857143]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 7 epochs
Epoch 27/65
154/154 - 235s - loss: 0.0242 - accuracy: 0.9943 - val_loss: 0.4902 - val_accuracy: 0.8862
Confusion matrix: 
 [[515  58]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.286 0.714]]
Validation f1: 46.15
Validation accuracy: 88.62
Validation recall: 71.43
Validation precision: 34.09
Validation AUC: 0.6216889731478006
Validation class accuracies: [0.8987783595113438, 0.7142857142857143]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 8 epochs
Epoch 28/65
154/154 - 235s - loss: 0.0212 - accuracy: 0.9927 - val_loss: 0.4391 - val_accuracy: 0.8943
Confusion matrix: 
 [[519  54]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.262 0.738]]
Validation f1: 48.82
Validation accuracy: 89.43
Validation recall: 73.81
Validation precision: 36.47
Validation AUC: 0.6565523140224521
Validation class accuracies: [0.9057591623036649, 0.7380952380952381]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 9 epochs
Epoch 29/65
154/154 - 235s - loss: 0.0269 - accuracy: 0.9882 - val_loss: 0.3359 - val_accuracy: 0.9220
Confusion matrix: 
 [[539  34]
 [ 14  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.333 0.667]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.85
Validation accuracy: 92.20
Validation recall: 66.67
Validation precision: 45.16
Validation AUC: 0.6619330670346016
Validation class accuracies: [0.9406631762652705, 0.6666666666666666]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 10 epochs
Epoch 30/65
154/154 - 235s - loss: 0.0224 - accuracy: 0.9931 - val_loss: 1.2571 - val_accuracy: 0.7366
Confusion matrix: 
 [[413 160]
 [  2  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.721 0.279]
 [0.048 0.952]]
Validation f1: 33.06
Validation accuracy: 73.66
Validation recall: 95.24
Validation precision: 20.00
Validation AUC: 0.6389276823969148
Validation class accuracies: [0.7207678883071553, 0.9523809523809523]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 11 epochs
Epoch 31/65
154/154 - 235s - loss: 0.0181 - accuracy: 0.9939 - val_loss: 0.8506 - val_accuracy: 0.8325
Confusion matrix: 
 [[478  95]
 [  8  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.834 0.166]
 [0.19  0.81 ]]
Validation f1: 39.77
Validation accuracy: 83.25
Validation recall: 80.95
Validation precision: 26.36
Validation AUC: 0.6423927336078894
Validation class accuracies: [0.8342059336823735, 0.8095238095238095]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 32/65
154/154 - 235s - loss: 0.0191 - accuracy: 0.9910 - val_loss: 0.4530 - val_accuracy: 0.8943
Confusion matrix: 
 [[520  53]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.286 0.714]]
Validation f1: 48.00
Validation accuracy: 89.43
Validation recall: 71.43
Validation precision: 36.14
Validation AUC: 0.6292434723953196
Validation class accuracies: [0.9075043630017452, 0.7142857142857143]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 13 epochs
Epoch 33/65
154/154 - 235s - loss: 0.0134 - accuracy: 0.9972 - val_loss: 0.4699 - val_accuracy: 0.8959
Confusion matrix: 
 [[520  53]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.262 0.738]]
Validation f1: 49.21
Validation accuracy: 89.59
Validation recall: 73.81
Validation precision: 36.90
Validation AUC: 0.6382074817339507
Validation class accuracies: [0.9075043630017452, 0.7380952380952381]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 14 epochs
Epoch 34/65
154/154 - 235s - loss: 0.0222 - accuracy: 0.9923 - val_loss: 0.4315 - val_accuracy: 0.9057
Confusion matrix: 
 [[527  46]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.286 0.714]]
Validation f1: 50.85
Validation accuracy: 90.57
Validation recall: 71.43
Validation precision: 39.47
Validation AUC: 0.6287448979295048
Validation class accuracies: [0.9197207678883071, 0.7142857142857143]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 15 epochs
Epoch 35/65
154/154 - 235s - loss: 0.0134 - accuracy: 0.9947 - val_loss: 0.3998 - val_accuracy: 0.9073
Confusion matrix: 
 [[529  44]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.31  0.69 ]]
Validation f1: 50.43
Validation accuracy: 90.73
Validation recall: 69.05
Validation precision: 39.73
Validation AUC: 0.6371938304455957
Validation class accuracies: [0.9232111692844677, 0.6904761904761905]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 16 epochs
Epoch 36/65
154/154 - 236s - loss: 0.0129 - accuracy: 0.9959 - val_loss: 0.4707 - val_accuracy: 0.8976
Confusion matrix: 
 [[522  51]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.286 0.714]]
Validation f1: 48.78
Validation accuracy: 89.76
Validation recall: 71.43
Validation precision: 37.04
Validation AUC: 0.6336118379740788
Validation class accuracies: [0.9109947643979057, 0.7142857142857143]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 17 epochs
Epoch 37/65
154/154 - 235s - loss: 0.0108 - accuracy: 0.9980 - val_loss: 0.4972 - val_accuracy: 0.8911
Confusion matrix: 
 [[518  55]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.286 0.714]]
Validation f1: 47.24
Validation accuracy: 89.11
Validation recall: 71.43
Validation precision: 35.29
Validation AUC: 0.6432656862329531
Validation class accuracies: [0.9040139616055847, 0.7142857142857143]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 38/65
154/154 - 235s - loss: 0.0108 - accuracy: 0.9972 - val_loss: 0.4839 - val_accuracy: 0.8943
Confusion matrix: 
 [[518  55]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.238 0.762]]
Validation f1: 49.61
Validation accuracy: 89.43
Validation recall: 76.19
Validation precision: 36.78
Validation AUC: 0.6503672924696771
Validation class accuracies: [0.9040139616055847, 0.7619047619047619]
The validation tracker metric at 0.6458333333333334 hasn't increased by 0 in 19 epochs
Epoch 39/65
154/154 - 235s - loss: 0.0119 - accuracy: 0.9951 - val_loss: 0.5030 - val_accuracy: 0.8911
Confusion matrix: 
 [[518  55]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.24
Validation accuracy: 89.11
Validation recall: 71.43
Validation precision: 35.29
Validation AUC: 0.6496825353732569
Validation class accuracies: [0.9040139616055847, 0.7142857142857143]

The metrics for job 0 with the best target metric are: 
Best cm: [[550  23]
 [ 11  31]]
Best normalized cm: [[0.96  0.04 ]
 [0.262 0.738]]
Best f1: 0.65
Best accuracy: 0.94
Best recall: 0.74
Best precision: 0.57
Best AUC: 0.71
Best class accuracies: [0.9598603839441536, 0.7380952380952381]
Best epoch: 19
The number of epochs since last 1% equals the patience
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_218_1b1_Pl_sc_Meditron_5_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_219_2b1_Ar_mc_LittC2SE_2_label_1_pred_1.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_204_7p5_Ll_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_222_1b1_Lr_sc_Meditron_2_label_0_pred_1.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_221_2b3_Lr_mc_LittC2SE_1_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_218_1p1_Ar_sc_Litt3200_2_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_213_1p5_Pl_mc_AKGC417L_3_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_221_2b3_Al_mc_LittC2SE_0_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_218_1b1_Al_sc_Meditron_4_label_0_pred_0.png
-----------------------
Mixednet
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 67s - loss: 0.4640 - accuracy: 0.7184 - val_loss: 0.3998 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1203566818709859
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 62s - loss: 0.3342 - accuracy: 0.8360 - val_loss: 0.2876 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.11592846318373111
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 62s - loss: 0.2643 - accuracy: 0.8848 - val_loss: 0.2787 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31711615364188217
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 63s - loss: 0.1930 - accuracy: 0.9076 - val_loss: 0.2327 - val_accuracy: 0.9740
Confusion matrix: 
 [[569   4]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.286 0.714]]
Validation f1: 78.95
Validation accuracy: 97.40
Validation recall: 71.43
Validation precision: 88.24
Validation AUC: 0.7373456688555725
Validation class accuracies: [0.9930191972076788, 0.7142857142857143]
Saving model...
Epoch 5/65
154/154 - 65s - loss: 0.1451 - accuracy: 0.9487 - val_loss: 2.0332 - val_accuracy: 0.4699
Confusion matrix: 
 [[247 326]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.431 0.569]
 [0.    1.   ]]
Validation f1: 20.49
Validation accuracy: 46.99
Validation recall: 100.00
Validation precision: 11.41
Validation AUC: 0.6535405779581945
Validation class accuracies: [0.43106457242582896, 1.0]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 62s - loss: 0.1078 - accuracy: 0.9597 - val_loss: 0.1617 - val_accuracy: 0.9431
Confusion matrix: 
 [[554  19]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.381 0.619]]
Validation f1: 59.77
Validation accuracy: 94.31
Validation recall: 61.90
Validation precision: 57.78
Validation AUC: 0.6832777644155256
Validation class accuracies: [0.9668411867364747, 0.6190476190476191]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 2 epochs
Epoch 7/65
154/154 - 62s - loss: 0.0759 - accuracy: 0.9715 - val_loss: 0.2905 - val_accuracy: 0.9154
Confusion matrix: 
 [[534  39]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.31  0.69 ]]
Validation f1: 52.73
Validation accuracy: 91.54
Validation recall: 69.05
Validation precision: 42.65
Validation AUC: 0.6520103422950357
Validation class accuracies: [0.9319371727748691, 0.6904761904761905]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 3 epochs
Epoch 8/65
154/154 - 63s - loss: 0.0577 - accuracy: 0.9809 - val_loss: 0.2263 - val_accuracy: 0.9220
Confusion matrix: 
 [[544  29]
 [ 19  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.452 0.548]]
Validation f1: 48.94
Validation accuracy: 92.20
Validation recall: 54.76
Validation precision: 44.23
Validation AUC: 0.6373225313676742
Validation class accuracies: [0.9493891797556719, 0.5476190476190477]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 4 epochs
Epoch 9/65
154/154 - 65s - loss: 0.0501 - accuracy: 0.9858 - val_loss: 1.0140 - val_accuracy: 0.7041
Confusion matrix: 
 [[395 178]
 [  4  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.689 0.311]
 [0.095 0.905]]
Validation f1: 29.46
Validation accuracy: 70.41
Validation recall: 90.48
Validation precision: 17.59
Validation AUC: 0.6911251609864538
Validation class accuracies: [0.6893542757417103, 0.9047619047619048]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 5 epochs
Epoch 10/65
154/154 - 63s - loss: 0.0337 - accuracy: 0.9882 - val_loss: 0.4293 - val_accuracy: 0.8846
Confusion matrix: 
 [[512  61]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.238 0.762]]
Validation f1: 47.41
Validation accuracy: 88.46
Validation recall: 76.19
Validation precision: 34.41
Validation AUC: 0.679610320394125
Validation class accuracies: [0.893542757417103, 0.7619047619047619]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
154/154 - 62s - loss: 0.0195 - accuracy: 0.9967 - val_loss: 0.4101 - val_accuracy: 0.8992
Confusion matrix: 
 [[522  51]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.262 0.738]]
Validation f1: 50.00
Validation accuracy: 89.92
Validation recall: 73.81
Validation precision: 37.80
Validation AUC: 0.6644386228922603
Validation class accuracies: [0.9109947643979057, 0.7380952380952381]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 7 epochs
Epoch 12/65
154/154 - 62s - loss: 0.0142 - accuracy: 0.9972 - val_loss: 0.3254 - val_accuracy: 0.9073
Confusion matrix: 
 [[529  44]
 [ 13  29]]
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.31  0.69 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.43
Validation accuracy: 90.73
Validation recall: 69.05
Validation precision: 39.73
Validation AUC: 0.6552922983871667
Validation class accuracies: [0.9232111692844677, 0.6904761904761905]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 8 epochs
Epoch 13/65
154/154 - 63s - loss: 0.0120 - accuracy: 0.9984 - val_loss: 0.2921 - val_accuracy: 0.9236
Confusion matrix: 
 [[540  33]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.333 0.667]]
Validation f1: 54.37
Validation accuracy: 92.36
Validation recall: 66.67
Validation precision: 45.90
Validation AUC: 0.6567484542804026
Validation class accuracies: [0.9424083769633508, 0.6666666666666666]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 9 epochs
Epoch 14/65
154/154 - 63s - loss: 0.0114 - accuracy: 0.9996 - val_loss: 0.3350 - val_accuracy: 0.9154
Confusion matrix: 
 [[533  40]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.286 0.714]]
Validation f1: 53.57
Validation accuracy: 91.54
Validation recall: 71.43
Validation precision: 42.86
Validation AUC: 0.6706214258431316
Validation class accuracies: [0.9301919720767888, 0.7142857142857143]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 10 epochs
Epoch 15/65
154/154 - 62s - loss: 0.0095 - accuracy: 0.9996 - val_loss: 0.4299 - val_accuracy: 0.9057
Confusion matrix: 
 [[525  48]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.238 0.762]]
Validation f1: 52.46
Validation accuracy: 90.57
Validation recall: 76.19
Validation precision: 40.00
Validation AUC: 0.6487219498821427
Validation class accuracies: [0.9162303664921466, 0.7619047619047619]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 11 epochs
Epoch 16/65
154/154 - 62s - loss: 0.0095 - accuracy: 1.0000 - val_loss: 0.3743 - val_accuracy: 0.9138
Confusion matrix: 
 [[531  42]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.262 0.738]]
Validation f1: 53.91
Validation accuracy: 91.38
Validation recall: 73.81
Validation precision: 42.47
Validation AUC: 0.6534337515791377
Validation class accuracies: [0.9267015706806283, 0.7380952380952381]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 17/65
154/154 - 62s - loss: 0.0108 - accuracy: 0.9992 - val_loss: 0.3388 - val_accuracy: 0.9220
Confusion matrix: 
 [[536  37]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.262 0.738]]
Validation f1: 56.36
Validation accuracy: 92.20
Validation recall: 73.81
Validation precision: 45.59
Validation AUC: 0.6555397693985349
Validation class accuracies: [0.9354275741710296, 0.7380952380952381]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 13 epochs
Epoch 18/65
154/154 - 63s - loss: 0.0070 - accuracy: 1.0000 - val_loss: 0.3378 - val_accuracy: 0.9220
Confusion matrix: 
 [[537  36]
 [ 12  30]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.286 0.714]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.56
Validation accuracy: 92.20
Validation recall: 71.43
Validation precision: 45.45
Validation AUC: 0.649069492681469
Validation class accuracies: [0.93717277486911, 0.7142857142857143]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 14 epochs
Epoch 19/65
154/154 - 62s - loss: 0.0072 - accuracy: 1.0000 - val_loss: 0.3450 - val_accuracy: 0.9220
Confusion matrix: 
 [[536  37]
 [ 11  31]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.262 0.738]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.36
Validation accuracy: 92.20
Validation recall: 73.81
Validation precision: 45.59
Validation AUC: 0.6575831531165032
Validation class accuracies: [0.9354275741710296, 0.7380952380952381]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 15 epochs
Epoch 20/65
154/154 - 62s - loss: 0.0070 - accuracy: 1.0000 - val_loss: 0.3478 - val_accuracy: 0.9236
Confusion matrix: 
 [[537  36]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.262 0.738]]
Validation f1: 56.88
Validation accuracy: 92.36
Validation recall: 73.81
Validation precision: 46.27
Validation AUC: 0.657014137401375
Validation class accuracies: [0.93717277486911, 0.7380952380952381]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 16 epochs
Epoch 21/65
154/154 - 62s - loss: 0.0056 - accuracy: 1.0000 - val_loss: 0.3692 - val_accuracy: 0.9203
Confusion matrix: 
 [[535  38]
 [ 11  31]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.262 0.738]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.86
Validation accuracy: 92.03
Validation recall: 73.81
Validation precision: 44.93
Validation AUC: 0.6566230614293317
Validation class accuracies: [0.9336823734729494, 0.7380952380952381]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 17 epochs
Epoch 22/65
154/154 - 63s - loss: 0.0048 - accuracy: 1.0000 - val_loss: 0.3435 - val_accuracy: 0.9285
Confusion matrix: 
 [[540  33]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.262 0.738]]
Validation f1: 58.49
Validation accuracy: 92.85
Validation recall: 73.81
Validation precision: 48.44
Validation AUC: 0.6498770351559837
Validation class accuracies: [0.9424083769633508, 0.7380952380952381]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 23/65
154/154 - 62s - loss: 0.0053 - accuracy: 0.9996 - val_loss: 0.3603 - val_accuracy: 0.9187
Confusion matrix: 
 [[534  39]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.262 0.738]]
Validation f1: 55.36
Validation accuracy: 91.87
Validation recall: 73.81
Validation precision: 44.29
Validation AUC: 0.655473642532147
Validation class accuracies: [0.9319371727748691, 0.7380952380952381]
The validation tracker metric at 0.7894736842105262 hasn't increased by 0 in 19 epochs
Epoch 24/65
154/154 - 62s - loss: 0.0048 - accuracy: 1.0000 - val_loss: 0.3571 - val_accuracy: 0.9236
Confusion matrix: 
 [[537  36]
 [ 11  31]]
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.262 0.738]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.88
Validation accuracy: 92.36
Validation recall: 73.81
Validation precision: 46.27
Validation AUC: 0.6525905777521226
Validation class accuracies: [0.93717277486911, 0.7380952380952381]

The metrics for job 1 with the best target metric are: 
Best cm: [[569   4]
 [ 12  30]]
Best normalized cm: [[0.993 0.007]
 [0.286 0.714]]
Best f1: 0.79
Best accuracy: 0.97
Best recall: 0.71
Best precision: 0.88
Best AUC: 0.74
Best class accuracies: [0.9930191972076788, 0.7142857142857143]
Best epoch: 4
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/helpers.py:59: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig = plt.figure(figsize=(20, 10))
[34m[1mwandb[0m: [32m[41mERROR[0m Attempted to change value of key "weight_decay" from 0.001 to 1e-05
[34m[1mwandb[0m: [32m[41mERROR[0m If you really want to do this, pass allow_val_change=True to config.update()
The number of epochs since last 1% equals the patience
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_223_1b1_Al_sc_Meditron_4_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_BP37_pneumonia,Crep,A R L,70,F_0_label_1_pred_1.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_205_4b2_Pl_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_221_2b1_Al_mc_LittC2SE_1_label_0_pred_1.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_1.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_208_1b1_Ll_sc_Meditron_0_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_BP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_218_1b1_Al_sc_Meditron_4_label_0_pred_0.png
../../new_cache/conv__2239__06_1842__v39__vizs/icbhi_212_2b2_Tc_mc_LittC2SE_0_label_0_pred_1.png
-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 1e-05, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2239.py", line 420, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params, model9, job_count=2)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2239.py", line 230, in train_model
    config.weight_decay = weight_decay
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/sdk/wandb_config.py", line 139, in __setitem__
    key, val = self._sanitize(key, val)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/sdk/wandb_config.py", line 237, in _sanitize
    ).format(key, self._items[key], val)
wandb.sdk.lib.config_util.ConfigError: Attempted to change value of key "weight_decay" from 0.001 to 1e-05
If you really want to do this, pass allow_val_change=True to config.update()
wandb: Waiting for W&B process to finish, PID 11682
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210622_184249-1j2a0ela/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210622_184249-1j2a0ela/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.92358
wandb:             _runtime 11490
wandb:           _timestamp 1624398860
wandb:                _step 455
wandb:           train_loss 0.00483
wandb:             val_loss 0.35706
wandb:           val_recall 0.7381
wandb:        val_precision 0.46269
wandb:               val_f1 0.56881
wandb:              val_auc 0.65259
wandb:                   lr 0.00013
wandb:          best_val_f1 0.78947
wandb:    best_val_accuracy 0.97398
wandb:   best_val_precision 0.88235
wandb:      best_val_recall 0.71429
wandb:             best_auc 0.73735
wandb:           best_epoch 4
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210622_184249-1j2a0ela


 See logs at ../../new_cache/conv__2239__06_1842__v39__vizs/logs/