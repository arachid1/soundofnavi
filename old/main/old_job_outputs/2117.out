Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2117
Description:  mixednet_manualclassweights
2021-05-10 02:26:46.761053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 02:26:49.056219: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 02:26:49.057194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-10 02:26:49.109075: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:49.109847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 02:26:49.109878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 02:26:49.113898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 02:26:49.113992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 02:26:49.115251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 02:26:49.115571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 02:26:49.116649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 02:26:49.117675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 02:26:49.117852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 02:26:49.117968: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:49.118803: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:49.119484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-10 02:26:49.314899: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 02:26:49.315137: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:49.315932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 02:26:49.315969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 02:26:49.316015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 02:26:49.316034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 02:26:49.316051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 02:26:49.316068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 02:26:49.316095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 02:26:49.316113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 02:26:49.316130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 02:26:49.316221: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:49.316998: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:49.317699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-10 02:26:49.317749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 02:26:50.061851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-10 02:26:50.061900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-10 02:26:50.061910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-10 02:26:50.062236: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:50.063301: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:50.064110: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 02:26:50.064817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-10 02:27:26.684852: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-10 02:27:26.686600: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-10 02:27:28.331542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 02:27:29.053463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 02:27:29.061513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2117.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2117__05_0226__v29__mixednet_manualclassweights/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 32, 'LR': 0.0001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 3, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 1, 1: 2.649}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 159s - loss: 0.9987 - accuracy: 0.5591 - val_loss: 0.6812 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16112497730942796
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
132/132 - 150s - loss: 0.9821 - accuracy: 0.6018 - val_loss: 0.6804 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19931806181505884
Validation class accuracies: [1.0, 0.0]
Epoch 3/40
132/132 - 150s - loss: 0.9711 - accuracy: 0.6049 - val_loss: 0.6679 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20448481053704837
Validation class accuracies: [1.0, 0.0]
Epoch 4/40
132/132 - 150s - loss: 0.9634 - accuracy: 0.6058 - val_loss: 0.6550 - val_accuracy: 0.7969
Confusion matrix: 
 [[865   5]
 [216   2]]
Validation f1: 1.78
Validation accuracy: 79.69
Validation recall: 0.92
Validation precision: 28.57
Validation AUC: 0.19344779982202992
Validation class accuracies: [0.9942528735632183, 0.009174311926605505]
Epoch 5/40
132/132 - 149s - loss: 0.9555 - accuracy: 0.6213 - val_loss: 0.6714 - val_accuracy: 0.6774
Confusion matrix: 
 [[695 175]
 [176  42]]
Validation f1: 19.31
Validation accuracy: 67.74
Validation recall: 19.27
Validation precision: 19.35
Validation AUC: 0.21546236193500068
Validation class accuracies: [0.7988505747126436, 0.1926605504587156]
Epoch 6/40
132/132 - 150s - loss: 0.9528 - accuracy: 0.6132 - val_loss: 0.7092 - val_accuracy: 0.5579
Confusion matrix: 
 [[505 365]
 [116 102]]
Validation f1: 29.78
Validation accuracy: 55.79
Validation recall: 46.79
Validation precision: 21.84
Validation AUC: 0.21927489772473657
Validation class accuracies: [0.5804597701149425, 0.46788990825688076]
Saving model...
Epoch 7/40
132/132 - 150s - loss: 0.9454 - accuracy: 0.6344 - val_loss: 0.6709 - val_accuracy: 0.6434
Confusion matrix: 
 [[616 254]
 [134  84]]
Validation f1: 30.22
Validation accuracy: 64.34
Validation recall: 38.53
Validation precision: 24.85
Validation AUC: 0.23664754930034199
Validation class accuracies: [0.7080459770114943, 0.3853211009174312]
The validation tracker metric at 0.2978102189781022 hasn't increased by 0.01 in 1 epochs
Saving model...
Epoch 8/40
132/132 - 149s - loss: 0.9383 - accuracy: 0.6308 - val_loss: 0.8106 - val_accuracy: 0.2638
Confusion matrix: 
 [[126 744]
 [ 57 161]]
Validation f1: 28.67
Validation accuracy: 26.38
Validation recall: 73.85
Validation precision: 17.79
Validation AUC: 0.20225827304805685
Validation class accuracies: [0.14482758620689656, 0.7385321100917431]
The validation tracker metric at 0.2978102189781022 hasn't increased by 0.01 in 2 epochs
Epoch 9/40
132/132 - 150s - loss: 0.9310 - accuracy: 0.6411 - val_loss: 0.7919 - val_accuracy: 0.4357
Confusion matrix: 
 [[313 557]
 [ 57 161]]
Validation f1: 34.40
Validation accuracy: 43.57
Validation recall: 73.85
Validation precision: 22.42
Validation AUC: 0.22616631395595904
Validation class accuracies: [0.35977011494252875, 0.7385321100917431]
Saving model...
Epoch 10/40
132/132 - 149s - loss: 0.9274 - accuracy: 0.6475 - val_loss: 0.8559 - val_accuracy: 0.2472
Confusion matrix: 
 [[ 86 784]
 [ 35 183]]
Validation f1: 30.89
Validation accuracy: 24.72
Validation recall: 83.94
Validation precision: 18.92
Validation AUC: 0.21022049631487721
Validation class accuracies: [0.09885057471264368, 0.8394495412844036]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 1 epochs
Epoch 11/40
132/132 - 149s - loss: 0.9209 - accuracy: 0.6585 - val_loss: 0.7516 - val_accuracy: 0.5349
Confusion matrix: 
 [[452 418]
 [ 88 130]]
Validation f1: 33.94
Validation accuracy: 53.49
Validation recall: 59.63
Validation precision: 23.72
Validation AUC: 0.2335136643785956
Validation class accuracies: [0.5195402298850574, 0.5963302752293578]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 2 epochs
Epoch 12/40
132/132 - 150s - loss: 0.9168 - accuracy: 0.6542 - val_loss: 0.7427 - val_accuracy: 0.4458
Confusion matrix: 
 [[347 523]
 [ 80 138]]
Validation f1: 31.40
Validation accuracy: 44.58
Validation recall: 63.30
Validation precision: 20.88
Validation AUC: 0.22183692053967008
Validation class accuracies: [0.3988505747126437, 0.6330275229357798]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 3 epochs
Epoch 13/40
132/132 - 149s - loss: 0.9081 - accuracy: 0.6642 - val_loss: 0.7140 - val_accuracy: 0.5331
Confusion matrix: 
 [[467 403]
 [105 113]]
Validation f1: 30.79
Validation accuracy: 53.31
Validation recall: 51.83
Validation precision: 21.90
Validation AUC: 0.22058529557906584
Validation class accuracies: [0.5367816091954023, 0.518348623853211]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 4 epochs
Epoch 14/40
132/132 - 149s - loss: 0.9089 - accuracy: 0.6633 - val_loss: 0.6955 - val_accuracy: 0.5515
Confusion matrix: 
 [[502 368]
 [120  98]]
Validation f1: 28.65
Validation accuracy: 55.15
Validation recall: 44.95
Validation precision: 21.03
Validation AUC: 0.22497833129251799
Validation class accuracies: [0.5770114942528736, 0.44954128440366975]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 5 epochs
Epoch 15/40
132/132 - 149s - loss: 0.9044 - accuracy: 0.6735 - val_loss: 0.7210 - val_accuracy: 0.5386
Confusion matrix: 
 [[477 393]
 [109 109]]
Validation f1: 30.28
Validation accuracy: 53.86
Validation recall: 50.00
Validation precision: 21.71
Validation AUC: 0.2218961763919602
Validation class accuracies: [0.5482758620689655, 0.5]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 6 epochs
Epoch 16/40
132/132 - 148s - loss: 0.9026 - accuracy: 0.6675 - val_loss: 0.6837 - val_accuracy: 0.6075
Confusion matrix: 
 [[574 296]
 [131  87]]
Validation f1: 28.95
Validation accuracy: 60.75
Validation recall: 39.91
Validation precision: 22.72
Validation AUC: 0.22550499597293838
Validation class accuracies: [0.6597701149425287, 0.39908256880733944]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 7 epochs
Epoch 17/40
132/132 - 149s - loss: 0.9022 - accuracy: 0.6809 - val_loss: 0.6954 - val_accuracy: 0.5754
Confusion matrix: 
 [[535 335]
 [127  91]]
Validation f1: 28.26
Validation accuracy: 57.54
Validation recall: 41.74
Validation precision: 21.36
Validation AUC: 0.2237805380971582
Validation class accuracies: [0.6149425287356322, 0.41743119266055045]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 8 epochs
Epoch 18/40
132/132 - 150s - loss: 0.8992 - accuracy: 0.6756 - val_loss: 0.7025 - val_accuracy: 0.5597
Confusion matrix: 
 [[508 362]
 [117 101]]
Validation f1: 29.66
Validation accuracy: 55.97
Validation recall: 46.33
Validation precision: 21.81
Validation AUC: 0.22139431607446983
Validation class accuracies: [0.5839080459770115, 0.463302752293578]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 9 epochs
Epoch 19/40
132/132 - 149s - loss: 0.8971 - accuracy: 0.6728 - val_loss: 0.7001 - val_accuracy: 0.5625
Confusion matrix: 
 [[518 352]
 [124  94]]
Validation f1: 28.31
Validation accuracy: 56.25
Validation recall: 43.12
Validation precision: 21.08
Validation AUC: 0.22338859913568898
Validation class accuracies: [0.5954022988505747, 0.43119266055045874]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 10 epochs
Epoch 20/40
132/132 - 149s - loss: 0.8963 - accuracy: 0.6792 - val_loss: 0.6925 - val_accuracy: 0.5772
Confusion matrix: 
 [[537 333]
 [127  91]]
Validation f1: 28.35
Validation accuracy: 57.72
Validation recall: 41.74
Validation precision: 21.46
Validation AUC: 0.22454180265488694
Validation class accuracies: [0.6172413793103448, 0.41743119266055045]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 11 epochs
Epoch 21/40
132/132 - 149s - loss: 0.8950 - accuracy: 0.6845 - val_loss: 0.7012 - val_accuracy: 0.5643
Confusion matrix: 
 [[517 353]
 [121  97]]
Validation f1: 29.04
Validation accuracy: 56.43
Validation recall: 44.50
Validation precision: 21.56
Validation AUC: 0.22300893846082115
Validation class accuracies: [0.5942528735632184, 0.44495412844036697]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 12 epochs
Epoch 22/40
132/132 - 149s - loss: 0.8962 - accuracy: 0.6878 - val_loss: 0.6966 - val_accuracy: 0.5708
Confusion matrix: 
 [[530 340]
 [127  91]]
Validation f1: 28.04
Validation accuracy: 57.08
Validation recall: 41.74
Validation precision: 21.11
Validation AUC: 0.22371623507084656
Validation class accuracies: [0.6091954022988506, 0.41743119266055045]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 13 epochs
Epoch 23/40
132/132 - 149s - loss: 0.8948 - accuracy: 0.6845 - val_loss: 0.6978 - val_accuracy: 0.5708
Confusion matrix: 
 [[526 344]
 [123  95]]
Validation f1: 28.92
Validation accuracy: 57.08
Validation recall: 43.58
Validation precision: 21.64
Validation AUC: 0.22276163617274042
Validation class accuracies: [0.6045977011494252, 0.43577981651376146]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 14 epochs
Epoch 24/40
132/132 - 149s - loss: 0.8946 - accuracy: 0.6823 - val_loss: 0.6937 - val_accuracy: 0.5763
Confusion matrix: 
 [[535 335]
 [126  92]]
Validation f1: 28.53
Validation accuracy: 57.63
Validation recall: 42.20
Validation precision: 21.55
Validation AUC: 0.22335265939071758
Validation class accuracies: [0.6149425287356322, 0.42201834862385323]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 15 epochs
Epoch 25/40
132/132 - 149s - loss: 0.8941 - accuracy: 0.6826 - val_loss: 0.6970 - val_accuracy: 0.5708
Confusion matrix: 
 [[527 343]
 [124  94]]
Validation f1: 28.70
Validation accuracy: 57.08
Validation recall: 43.12
Validation precision: 21.51
Validation AUC: 0.2229024339117707
Validation class accuracies: [0.6057471264367816, 0.43119266055045874]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 16 epochs
Epoch 26/40
132/132 - 150s - loss: 0.8915 - accuracy: 0.6873 - val_loss: 0.6949 - val_accuracy: 0.5754
Confusion matrix: 
 [[535 335]
 [127  91]]
Validation f1: 28.26
Validation accuracy: 57.54
Validation recall: 41.74
Validation precision: 21.36
Validation AUC: 0.2236664415521989
Validation class accuracies: [0.6149425287356322, 0.41743119266055045]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 17 epochs
Epoch 27/40
132/132 - 149s - loss: 0.8957 - accuracy: 0.6783 - val_loss: 0.6960 - val_accuracy: 0.5726
Confusion matrix: 
 [[531 339]
 [126  92]]
Validation f1: 28.35
Validation accuracy: 57.26
Validation recall: 42.20
Validation precision: 21.35
Validation AUC: 0.22343739014277128
Validation class accuracies: [0.6103448275862069, 0.42201834862385323]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 18 epochs
Epoch 28/40
132/132 - 149s - loss: 0.8968 - accuracy: 0.6795 - val_loss: 0.6932 - val_accuracy: 0.5781
Confusion matrix: 
 [[538 332]
 [127  91]]
Validation f1: 28.39
Validation accuracy: 57.81
Validation recall: 41.74
Validation precision: 21.51
Validation AUC: 0.22392784218691283
Validation class accuracies: [0.6183908045977011, 0.41743119266055045]
The validation tracker metric at 0.344017094017094 hasn't increased by 0.01 in 19 epochs
Epoch 29/40
132/132 - 150s - loss: 0.8923 - accuracy: 0.6823 - val_loss: 0.6923 - val_accuracy: 0.5781
Confusion matrix: 
 [[538 332]
 [127  91]]
Validation f1: 28.39
Validation accuracy: 57.81
Validation recall: 41.74
Validation precision: 21.51
Validation AUC: 0.223570136909436
Validation class accuracies: [0.6183908045977011, 0.41743119266055045]

The metrics for the epoch with the best target metric are: 
Best cm: [[313 557]
 [ 57 161]]
Best f1: 0.344017094017094
Best accuracy: 0.43566176470588236
Best recall: 0.7385321100917431
Best precision: 0.22423398328690808
Best AUC: 0.22616631395595904
Best epoch: 9
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 40
Starting...
CM: [[13 47]
 [ 1 14]]
F1: 0.3684210526315789
Accuracy: 0.36
Precision: 0.22950819672131148
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2117__05_0226__v29__mixednet_manualclassweights/validation_sheet_40.xls...
Done.
Epoch: 6
Starting...
CM: [[ 8 52]
 [ 0 15]]
F1: 0.36585365853658536
Accuracy: 0.30666666666666664
Precision: 0.22388059701492538
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2117__05_0226__v29__mixednet_manualclassweights/validation_sheet_6.xls...
Done.
Epoch: 7
Starting...
CM: [[16 44]
 [ 1 14]]
F1: 0.3835616438356165
Accuracy: 0.4
Precision: 0.2413793103448276
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2117__05_0226__v29__mixednet_manualclassweights/validation_sheet_7.xls...
Done.
Epoch: 9
Starting...
CM: [[ 3 57]
 [ 0 15]]
F1: 0.3448275862068966
Accuracy: 0.24
Precision: 0.20833333333333334
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2117__05_0226__v29__mixednet_manualclassweights/validation_sheet_9.xls...
Done.

 See logs at ../../new_cache/conv__2117__05_0226__v29__mixednet_manualclassweights/logs/