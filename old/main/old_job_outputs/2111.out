Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2111
Description:  mixednet
2021-05-09 00:47:39.683460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 00:47:42.321493: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 00:47:42.322571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-09 00:47:42.374126: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:42.374909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 00:47:42.374938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 00:47:42.378805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 00:47:42.378882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 00:47:42.380060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 00:47:42.380364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 00:47:42.381460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 00:47:42.382537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 00:47:42.382703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 00:47:42.382818: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:42.383631: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:42.384343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2111.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2111__05_0047__v29__mixednet/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 32, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 5, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2111
wandb: ‚≠êÔ∏è View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: üöÄ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1rssbxx8
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_004742-1rssbxx8
wandb: Run `wandb offline` to turn off syncing.
2021-05-09 00:47:48.464551: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 00:47:48.465084: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:48.466476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 00:47:48.466554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 00:47:48.466641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 00:47:48.466675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 00:47:48.466706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 00:47:48.466735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 00:47:48.466783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 00:47:48.466821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 00:47:48.466974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 00:47:48.467140: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:48.468477: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:48.469645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-09 00:47:48.469752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 00:47:49.284307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-09 00:47:49.284350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-09 00:47:49.284361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-09 00:47:49.284636: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:49.285497: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:49.286329: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:47:49.287051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-09 00:48:32.244124: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-09 00:48:32.245874: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-09 00:48:33.931840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 00:48:34.653364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 00:48:34.660257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 157s - loss: 0.6750 - accuracy: 0.6080 - val_loss: 0.6748 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2048156722641625
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
132/132 - 148s - loss: 0.6625 - accuracy: 0.6320 - val_loss: 0.6621 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2522682276291147
Validation class accuracies: [1.0, 0.0]
Epoch 3/40
132/132 - 148s - loss: 0.6453 - accuracy: 0.6592 - val_loss: 0.6179 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20987493404904298
Validation class accuracies: [1.0, 0.0]
Epoch 4/40
132/132 - 148s - loss: 0.6345 - accuracy: 0.6532 - val_loss: 0.5811 - val_accuracy: 0.7996
Confusion matrix: 
 [[868   2]
 [216   2]]
Validation f1: 1.80
Validation accuracy: 79.96
Validation recall: 0.92
Validation precision: 50.00
Validation AUC: 0.21657019199002644
Validation class accuracies: [0.9977011494252873, 0.009174311926605505]
Epoch 5/40
132/132 - 148s - loss: 0.6159 - accuracy: 0.6876 - val_loss: 0.6451 - val_accuracy: 0.7114
Confusion matrix: 
 [[735 135]
 [179  39]]
Validation f1: 19.90
Validation accuracy: 71.14
Validation recall: 17.89
Validation precision: 22.41
Validation AUC: 0.22458412727897514
Validation class accuracies: [0.8448275862068966, 0.17889908256880735]
Saving model...
Epoch 6/40
132/132 - 148s - loss: 0.5882 - accuracy: 0.7107 - val_loss: 0.5962 - val_accuracy: 0.7702
Confusion matrix: 
 [[822  48]
 [202  16]]
Validation f1: 11.35
Validation accuracy: 77.02
Validation recall: 7.34
Validation precision: 25.00
Validation AUC: 0.20217085229502085
Validation class accuracies: [0.9448275862068966, 0.07339449541284404]
The validation tracker metric at 0.1989795918367347 hasn't increased by 0.01 in 1 epochs
Epoch 7/40
132/132 - 148s - loss: 0.5472 - accuracy: 0.7474 - val_loss: 0.6099 - val_accuracy: 0.7335
Confusion matrix: 
 [[767 103]
 [187  31]]
Validation f1: 17.61
Validation accuracy: 73.35
Validation recall: 14.22
Validation precision: 23.13
Validation AUC: 0.20642868955193688
Validation class accuracies: [0.8816091954022989, 0.14220183486238533]
The validation tracker metric at 0.1989795918367347 hasn't increased by 0.01 in 2 epochs
Epoch 8/40
132/132 - 149s - loss: 0.4881 - accuracy: 0.7903 - val_loss: 0.8353 - val_accuracy: 0.5193
Confusion matrix: 
 [[486 384]
 [139  79]]
Validation f1: 23.20
Validation accuracy: 51.93
Validation recall: 36.24
Validation precision: 17.06
Validation AUC: 0.2007007689822688
Validation class accuracies: [0.5586206896551724, 0.3623853211009174]
Saving model...
Epoch 9/40
132/132 - 151s - loss: 0.4357 - accuracy: 0.8141 - val_loss: 0.7401 - val_accuracy: 0.6673
Confusion matrix: 
 [[661 209]
 [153  65]]
Validation f1: 26.42
Validation accuracy: 66.73
Validation recall: 29.82
Validation precision: 23.72
Validation AUC: 0.2217708037013434
Validation class accuracies: [0.7597701149425288, 0.2981651376146789]
Saving model...
Epoch 10/40
132/132 - 148s - loss: 0.3728 - accuracy: 0.8522 - val_loss: 0.8850 - val_accuracy: 0.5322
Confusion matrix: 
 [[488 382]
 [127  91]]
Validation f1: 26.34
Validation accuracy: 53.22
Validation recall: 41.74
Validation precision: 19.24
Validation AUC: 0.21239587587111225
Validation class accuracies: [0.5609195402298851, 0.41743119266055045]
The validation tracker metric at 0.26422764227642276 hasn't increased by 0.01 in 1 epochs
Epoch 11/40
132/132 - 148s - loss: 0.3014 - accuracy: 0.8966 - val_loss: 0.8720 - val_accuracy: 0.5763
Confusion matrix: 
 [[537 333]
 [128  90]]
Validation f1: 28.08
Validation accuracy: 57.63
Validation recall: 41.28
Validation precision: 21.28
Validation AUC: 0.20428498442447335
Validation class accuracies: [0.6172413793103448, 0.41284403669724773]
Saving model...
Epoch 12/40
132/132 - 151s - loss: 0.2538 - accuracy: 0.9149 - val_loss: 0.7628 - val_accuracy: 0.7188
Confusion matrix: 
 [[753 117]
 [189  29]]
Validation f1: 15.93
Validation accuracy: 71.88
Validation recall: 13.30
Validation precision: 19.86
Validation AUC: 0.2015224438938014
Validation class accuracies: [0.8655172413793103, 0.13302752293577982]
The validation tracker metric at 0.28081123244929795 hasn't increased by 0.01 in 1 epochs
Epoch 13/40
132/132 - 148s - loss: 0.1961 - accuracy: 0.9423 - val_loss: 0.9584 - val_accuracy: 0.6158
Confusion matrix: 
 [[594 276]
 [142  76]]
Validation f1: 26.67
Validation accuracy: 61.58
Validation recall: 34.86
Validation precision: 21.59
Validation AUC: 0.22028215949205585
Validation class accuracies: [0.6827586206896552, 0.3486238532110092]
The validation tracker metric at 0.28081123244929795 hasn't increased by 0.01 in 2 epochs
Epoch 14/40
132/132 - 148s - loss: 0.1655 - accuracy: 0.9495 - val_loss: 1.1175 - val_accuracy: 0.5230
Confusion matrix: 
 [[480 390]
 [129  89]]
Validation f1: 25.54
Validation accuracy: 52.30
Validation recall: 40.83
Validation precision: 18.58
Validation AUC: 0.19765871492601159
Validation class accuracies: [0.5517241379310345, 0.40825688073394495]
The validation tracker metric at 0.28081123244929795 hasn't increased by 0.01 in 3 epochs
Epoch 15/40
132/132 - 148s - loss: 0.1166 - accuracy: 0.9750 - val_loss: 1.1796 - val_accuracy: 0.7858
Confusion matrix: 
 [[845  25]
 [208  10]]
Validation f1: 7.91
Validation accuracy: 78.58
Validation recall: 4.59
Validation precision: 28.57
Validation AUC: 0.20788524600153446
Validation class accuracies: [0.9712643678160919, 0.045871559633027525]
The validation tracker metric at 0.28081123244929795 hasn't increased by 0.01 in 4 epochs
Epoch 16/40
132/132 - 148s - loss: 0.1104 - accuracy: 0.9719 - val_loss: 1.0199 - val_accuracy: 0.6241
Confusion matrix: 
 [[606 264]
 [145  73]]
Validation f1: 26.31
Validation accuracy: 62.41
Validation recall: 33.49
Validation precision: 21.66
Validation AUC: 0.22395340660841226
Validation class accuracies: [0.696551724137931, 0.3348623853211009]
Lr has been adjusted to 0.0005000000237487257
The validation tracker metric at 0.28081123244929795 hasn't increased by 0.01 in 5 epochs
Epoch 17/40
132/132 - 149s - loss: 0.0683 - accuracy: 0.9874 - val_loss: 1.1063 - val_accuracy: 0.6268
Confusion matrix: 
 [[605 265]
 [141  77]]
Validation f1: 27.50
Validation accuracy: 62.68
Validation recall: 35.32
Validation precision: 22.51
Validation AUC: 0.2101703412801657
Validation class accuracies: [0.6954022988505747, 0.3532110091743119]
The validation tracker metric at 0.28081123244929795 hasn't increased by 0.01 in 6 epochs
Epoch 18/40
132/132 - 149s - loss: 0.0703 - accuracy: 0.9845 - val_loss: 1.3958 - val_accuracy: 0.5404
Confusion matrix: 
 [[482 388]
 [112 106]]
Validation f1: 29.78
Validation accuracy: 54.04
Validation recall: 48.62
Validation precision: 21.46
Validation AUC: 0.2210299149962397
Validation class accuracies: [0.5540229885057472, 0.48623853211009177]
Saving model...
Epoch 19/40
132/132 - 149s - loss: 0.0511 - accuracy: 0.9945 - val_loss: 1.1614 - val_accuracy: 0.6195
Confusion matrix: 
 [[604 266]
 [148  70]]
Validation f1: 25.27
Validation accuracy: 61.95
Validation recall: 32.11
Validation precision: 20.83
Validation AUC: 0.2097421336370887
Validation class accuracies: [0.6942528735632184, 0.3211009174311927]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 1 epochs
Epoch 20/40
132/132 - 150s - loss: 0.0501 - accuracy: 0.9919 - val_loss: 1.3156 - val_accuracy: 0.5901
Confusion matrix: 
 [[558 312]
 [134  84]]
Validation f1: 27.36
Validation accuracy: 59.01
Validation recall: 38.53
Validation precision: 21.21
Validation AUC: 0.21782094565130358
Validation class accuracies: [0.6413793103448275, 0.3853211009174312]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 2 epochs
Epoch 21/40
132/132 - 150s - loss: 0.0446 - accuracy: 0.9952 - val_loss: 1.1579 - val_accuracy: 0.6324
Confusion matrix: 
 [[623 247]
 [153  65]]
Validation f1: 24.53
Validation accuracy: 63.24
Validation recall: 29.82
Validation precision: 20.83
Validation AUC: 0.21764793408210326
Validation class accuracies: [0.7160919540229885, 0.2981651376146789]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 3 epochs
Epoch 22/40
132/132 - 148s - loss: 0.0443 - accuracy: 0.9917 - val_loss: 1.1028 - val_accuracy: 0.6654
Confusion matrix: 
 [[672 198]
 [166  52]]
Validation f1: 22.22
Validation accuracy: 66.54
Validation recall: 23.85
Validation precision: 20.80
Validation AUC: 0.20966879950284942
Validation class accuracies: [0.7724137931034483, 0.23853211009174313]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 4 epochs
Epoch 23/40
132/132 - 150s - loss: 0.0385 - accuracy: 0.9938 - val_loss: 1.1464 - val_accuracy: 0.6434
Confusion matrix: 
 [[641 229]
 [159  59]]
Validation f1: 23.32
Validation accuracy: 64.34
Validation recall: 27.06
Validation precision: 20.49
Validation AUC: 0.21660222469650747
Validation class accuracies: [0.7367816091954023, 0.2706422018348624]
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 5 epochs
Epoch 24/40
132/132 - 149s - loss: 0.0322 - accuracy: 0.9957 - val_loss: 1.0930 - val_accuracy: 0.6636
Confusion matrix: 
 [[674 196]
 [170  48]]
Validation f1: 20.78
Validation accuracy: 66.36
Validation recall: 22.02
Validation precision: 19.67
Validation AUC: 0.20720059730243526
Validation class accuracies: [0.774712643678161, 0.22018348623853212]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 6 epochs
Epoch 25/40
132/132 - 156s - loss: 0.0319 - accuracy: 0.9962 - val_loss: 1.0866 - val_accuracy: 0.6912
Confusion matrix: 
 [[709 161]
 [175  43]]
Validation f1: 20.38
Validation accuracy: 69.12
Validation recall: 19.72
Validation precision: 21.08
Validation AUC: 0.21275371289172385
Validation class accuracies: [0.8149425287356322, 0.19724770642201836]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 7 epochs
Epoch 26/40
132/132 - 149s - loss: 0.0296 - accuracy: 0.9974 - val_loss: 1.0868 - val_accuracy: 0.7178
Confusion matrix: 
 [[748 122]
 [185  33]]
Validation f1: 17.69
Validation accuracy: 71.78
Validation recall: 15.14
Validation precision: 21.29
Validation AUC: 0.20871740359808974
Validation class accuracies: [0.8597701149425288, 0.15137614678899083]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 8 epochs
Epoch 27/40
132/132 - 148s - loss: 0.0270 - accuracy: 0.9979 - val_loss: 1.1248 - val_accuracy: 0.7436
Confusion matrix: 
 [[777  93]
 [186  32]]
Validation f1: 18.66
Validation accuracy: 74.36
Validation recall: 14.68
Validation precision: 25.60
Validation AUC: 0.21110560705048237
Validation class accuracies: [0.8931034482758621, 0.14678899082568808]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 9 epochs
Epoch 28/40
132/132 - 149s - loss: 0.0292 - accuracy: 0.9967 - val_loss: 1.1187 - val_accuracy: 0.6958
Confusion matrix: 
 [[713 157]
 [174  44]]
Validation f1: 21.00
Validation accuracy: 69.58
Validation recall: 20.18
Validation precision: 21.89
Validation AUC: 0.21077773120841825
Validation class accuracies: [0.8195402298850575, 0.2018348623853211]
Lr has been adjusted to 0.0001250000059371814
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 10 epochs
Epoch 29/40
132/132 - 150s - loss: 0.0256 - accuracy: 0.9971 - val_loss: 1.1558 - val_accuracy: 0.6608
Confusion matrix: 
 [[670 200]
 [169  49]]
Validation f1: 20.99
Validation accuracy: 66.08
Validation recall: 22.48
Validation precision: 19.68
Validation AUC: 0.21047386054779746
Validation class accuracies: [0.7701149425287356, 0.22477064220183487]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 11 epochs
Epoch 30/40
132/132 - 148s - loss: 0.0258 - accuracy: 0.9971 - val_loss: 1.2528 - val_accuracy: 0.6176
Confusion matrix: 
 [[609 261]
 [155  63]]
Validation f1: 23.25
Validation accuracy: 61.76
Validation recall: 28.90
Validation precision: 19.44
Validation AUC: 0.21100194651685578
Validation class accuracies: [0.7, 0.2889908256880734]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 12 epochs
Epoch 31/40
132/132 - 149s - loss: 0.0234 - accuracy: 0.9981 - val_loss: 1.2031 - val_accuracy: 0.6397
Confusion matrix: 
 [[641 229]
 [163  55]]
Validation f1: 21.91
Validation accuracy: 63.97
Validation recall: 25.23
Validation precision: 19.37
Validation AUC: 0.2101155670676285
Validation class accuracies: [0.7367816091954023, 0.25229357798165136]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 13 epochs
Epoch 32/40
132/132 - 148s - loss: 0.0250 - accuracy: 0.9964 - val_loss: 1.1607 - val_accuracy: 0.6719
Confusion matrix: 
 [[681 189]
 [168  50]]
Validation f1: 21.88
Validation accuracy: 67.19
Validation recall: 22.94
Validation precision: 20.92
Validation AUC: 0.21048613784975917
Validation class accuracies: [0.7827586206896552, 0.22935779816513763]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 14 epochs
Epoch 33/40
132/132 - 147s - loss: 0.0259 - accuracy: 0.9957 - val_loss: 1.1502 - val_accuracy: 0.6774
Confusion matrix: 
 [[691 179]
 [172  46]]
Validation f1: 20.77
Validation accuracy: 67.74
Validation recall: 21.10
Validation precision: 20.44
Validation AUC: 0.2079775730788047
Validation class accuracies: [0.7942528735632184, 0.21100917431192662]
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 15 epochs
Epoch 34/40
132/132 - 149s - loss: 0.0208 - accuracy: 0.9969 - val_loss: 1.1892 - val_accuracy: 0.6507
Confusion matrix: 
 [[656 214]
 [166  52]]
Validation f1: 21.49
Validation accuracy: 65.07
Validation recall: 23.85
Validation precision: 19.55
Validation AUC: 0.20808552948500297
Validation class accuracies: [0.7540229885057471, 0.23853211009174313]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 16 epochs
Epoch 35/40
132/132 - 150s - loss: 0.0231 - accuracy: 0.9979 - val_loss: 1.1511 - val_accuracy: 0.6958
Confusion matrix: 
 [[718 152]
 [179  39]]
Validation f1: 19.07
Validation accuracy: 69.58
Validation recall: 17.89
Validation precision: 20.42
Validation AUC: 0.20513213894094762
Validation class accuracies: [0.825287356321839, 0.17889908256880735]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 17 epochs
Epoch 36/40
132/132 - 148s - loss: 0.0242 - accuracy: 0.9983 - val_loss: 1.1686 - val_accuracy: 0.6691
Confusion matrix: 
 [[681 189]
 [171  47]]
Validation f1: 20.70
Validation accuracy: 66.91
Validation recall: 21.56
Validation precision: 19.92
Validation AUC: 0.2073124525261878
Validation class accuracies: [0.7827586206896552, 0.21559633027522937]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 18 epochs
Epoch 37/40
132/132 - 149s - loss: 0.0213 - accuracy: 0.9983 - val_loss: 1.1568 - val_accuracy: 0.7068
Confusion matrix: 
 [[736 134]
 [185  33]]
Validation f1: 17.14
Validation accuracy: 70.68
Validation recall: 15.14
Validation precision: 19.76
Validation AUC: 0.20552359097914163
Validation class accuracies: [0.8459770114942529, 0.15137614678899083]
The validation tracker metric at 0.29775280898876405 hasn't increased by 0.01 in 19 epochs
Epoch 38/40
132/132 - 153s - loss: 0.0245 - accuracy: 0.9962 - val_loss: 1.2180 - val_accuracy: 0.6443
Confusion matrix: 
 [[646 224]
 [163  55]]
Validation f1: 22.13
Validation accuracy: 64.43
Validation recall: 25.23
Validation precision: 19.71
Validation AUC: 0.20748785924260565
Validation class accuracies: [0.7425287356321839, 0.25229357798165136]

The metrics for the epoch with the best target metric are: 
Best cm: [[482 388]
 [112 106]]
Best f1: 0.29775280898876405
Best accuracy: 0.5404411764705882
Best recall: 0.48623853211009177
Best precision: 0.2145748987854251
Best AUC: 0.2210299149962397
Best epoch: 17
Lr has been adjusted to 3.125000148429535e-05
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 10
Starting...
F1: 0.33333333333333337
Accuracy: 0.25333333333333335
Precision: 0.2028985507246377
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2111__05_0047__v29__mixednet/validation_sheet_10.xls...
Done.
Epoch: 4
Starting...
F1: 0.4285714285714285
Accuracy: 0.5733333333333334
Precision: 0.2926829268292683
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2111__05_0047__v29__mixednet/validation_sheet_4.xls...
Done.
Epoch: 8
Starting...
F1: 0.3333333333333333
Accuracy: 0.36
Precision: 0.21052631578947367
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2111__05_0047__v29__mixednet/validation_sheet_8.xls...
Done.
Epoch: 40
Starting...
F1: 0.27848101265822783
Accuracy: 0.24
Precision: 0.171875
Recall: 0.7333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2111__05_0047__v29__mixednet/validation_sheet_40.xls...
Done.
Epoch: 17
Starting...
F1: 0.3448275862068966
Accuracy: 0.24
Precision: 0.20833333333333334
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2111__05_0047__v29__mixednet/validation_sheet_17.xls...
Done.
Epoch: 7
Starting...
F1: 0.3058823529411765
Accuracy: 0.21333333333333335
Precision: 0.18571428571428572
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2111__05_0047__v29__mixednet/validation_sheet_7.xls...
Done.
wandb: Waiting for W&B process to finish, PID 7239
wandb: Program ended successfully.
wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_004742-1rssbxx8/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_004742-1rssbxx8/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99619
wandb:         val_accuracy 0.6443
wandb:             _runtime 6476
wandb:           _timestamp 1620527738
wandb:                _step 270
wandb:           train_loss 0.02448
wandb:             val_loss 1.21797
wandb:           val_recall 0.25229
wandb:        val_precision 0.19713
wandb:               val_f1 0.22133
wandb:              val_auc 0.20749
wandb:                   lr 6e-05
wandb:          best_val_f1 0.29775
wandb:    best_val_accuracy 0.54044
wandb:   best_val_precision 0.21457
wandb:      best_val_recall 0.48624
wandb:             best_auc 0.22103
wandb:           best_epoch 17
wandb:           best_bd_f1 0.42857
wandb:     best_bd_accuracy 0.57333
wandb:    best_bd_precision 0.29268
wandb:       best_bd_recall 0.8
wandb:        best_bd_epoch 4
wandb: Run history:
wandb:   train_accuracy ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:     val_accuracy ‚ñà‚ñà‚ñà‚ñà‚ñÜ‚ñá‚ñÜ‚ñÅ‚ñÖ‚ñÅ‚ñÇ‚ñÜ‚ñÉ‚ñÅ‚ñà‚ñÑ‚ñÑ‚ñÇ‚ñÑ‚ñÉ‚ñÑ‚ñÖ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñá‚ñÖ‚ñÖ‚ñÉ‚ñÑ‚ñÖ‚ñÖ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÑ
wandb:         _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:       _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:            _step ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:       train_loss ‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÖ‚ñÖ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:         val_loss ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÉ‚ñÇ‚ñÑ‚ñÉ‚ñÉ‚ñÑ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñà‚ñÜ‚ñá‚ñÜ‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ
wandb:       val_recall ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÑ‚ñÇ‚ñÉ‚ñÜ‚ñÖ‚ñá‚ñá‚ñÉ‚ñÜ‚ñá‚ñÇ‚ñÜ‚ñÜ‚ñà‚ñÜ‚ñá‚ñÖ‚ñÑ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÖ
wandb:    val_precision ‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñÑ‚ñÖ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ
wandb:           val_f1 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÜ‚ñÑ‚ñÖ‚ñÜ‚ñá‚ñá‚ñà‚ñÖ‚ñá‚ñá‚ñÉ‚ñá‚ñá‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÖ‚ñÜ
wandb:          val_auc ‚ñÇ‚ñà‚ñÉ‚ñÉ‚ñÑ‚ñÇ‚ñÇ‚ñÅ‚ñÑ‚ñÉ‚ñÇ‚ñÅ‚ñÑ‚ñÅ‚ñÇ‚ñÑ‚ñÉ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ
wandb:               lr ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Synced 6 W&B file(s), 5 media file(s), 5 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2111: https://wandb.ai/arachid1/tensorboard-integration/runs/1rssbxx8


 See logs at ../../new_cache/conv__2111__05_0047__v29__mixednet/logs/