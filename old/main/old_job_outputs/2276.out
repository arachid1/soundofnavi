Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2276
Description:  mixup
2021-06-30 03:41:40.351252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-30 03:41:42.471253: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-30 03:41:42.472175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-30 03:41:42.517654: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:42.518333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-30 03:41:42.518366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-30 03:41:42.521855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-30 03:41:42.521954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-30 03:41:42.523025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-30 03:41:42.523338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-30 03:41:42.524331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-30 03:41:42.525197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-30 03:41:42.525384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-30 03:41:42.525508: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:42.526207: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:42.526839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2276.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2276__06_0341__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v48'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-30 03:41:47.352774: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-30 03:41:47.353051: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:47.353858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-30 03:41:47.353912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-30 03:41:47.353990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-30 03:41:47.354017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-30 03:41:47.354042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-30 03:41:47.354066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-30 03:41:47.354090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-30 03:41:47.354114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-30 03:41:47.354137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-30 03:41:47.354240: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:47.355031: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:47.355751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-30 03:41:47.355799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-30 03:41:48.042746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-30 03:41:48.042791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-30 03:41:48.042800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-30 03:41:48.043064: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:48.043807: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:48.044470: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-30 03:41:48.045099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-30 03:41:49.084473: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-30 03:41:49.085893: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-30 03:43:08.382606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 03:43:18.413997: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 4374
2021-06-30 03:43:28.376865: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 4374
2021-06-30 03:43:38.401314: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 4374
2021-06-30 03:43:48.286701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 03:43:58.472913: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 4374
2021-06-30 03:44:08.225335: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3921 of 4374
2021-06-30 03:44:18.068235: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-06-30 03:44:18.100067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-30 03:44:19.698959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-30 03:44:20.143612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3974
-----------------------
Number of train recordings: 3974 with pneumonia: 474 and non-pneumonia: 3500
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 4374
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
274/274 - 186s - loss: 0.3130 - accuracy: 0.8795 - val_loss: 0.2523 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27909725150708997
Validation class accuracies: [1.0, 0.0]
2021-06-30 03:46:26.076566: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 03:46:36.020878: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 03:46:46.072906: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 4374
2021-06-30 03:46:56.020908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 4374
2021-06-30 03:47:06.142589: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 4374
2021-06-30 03:47:16.056323: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3665 of 4374
2021-06-30 03:47:25.958270: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4283 of 4374
2021-06-30 03:47:27.625269: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
274/274 - 174s - loss: 0.1702 - accuracy: 0.9236 - val_loss: 0.2480 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.10383465141457297
Validation class accuracies: [1.0, 0.0]
2021-06-30 03:49:32.817937: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 4374
2021-06-30 03:49:42.994659: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 4374
2021-06-30 03:49:52.816719: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 4374
2021-06-30 03:50:02.893007: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2785 of 4374
2021-06-30 03:50:13.003904: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 4374
2021-06-30 03:50:22.792333: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4162 of 4374
2021-06-30 03:50:26.714015: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
274/274 - 165s - loss: 0.1013 - accuracy: 0.9566 - val_loss: 0.2316 - val_accuracy: 0.9414
Confusion matrix: 
 [[571   2]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.829 0.171]]
Validation f1: 28.00
Validation accuracy: 94.14
Validation recall: 17.07
Validation precision: 77.78
Validation AUC: 0.3431158293419767
Validation class accuracies: [0.9965095986038395, 0.17073170731707318]
2021-06-30 03:52:26.796796: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 03:52:36.942904: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 03:52:46.861803: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 03:52:56.834088: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 03:53:06.782744: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 4374
2021-06-30 03:53:16.785263: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4125 of 4374
2021-06-30 03:53:23.186823: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
274/274 - 167s - loss: 0.0525 - accuracy: 0.9771 - val_loss: 0.1490 - val_accuracy: 0.9560
Confusion matrix: 
 [[568   5]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.537 0.463]]
Validation f1: 58.46
Validation accuracy: 95.60
Validation recall: 46.34
Validation precision: 79.17
Validation AUC: 0.6741220792168025
Validation class accuracies: [0.9912739965095986, 0.4634146341463415]
2021-06-30 03:55:23.403354: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 03:55:33.420055: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 03:55:43.375686: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 4374
2021-06-30 03:55:53.440308: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2673 of 4374
2021-06-30 03:56:03.267030: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3233 of 4374
2021-06-30 03:56:13.303135: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3825 of 4374
2021-06-30 03:56:23.264985: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4265 of 4374
2021-06-30 03:56:26.004862: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
274/274 - 174s - loss: 0.0265 - accuracy: 0.9867 - val_loss: 0.1906 - val_accuracy: 0.9511
Confusion matrix: 
 [[566   7]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.561 0.439]]
Validation f1: 54.55
Validation accuracy: 95.11
Validation recall: 43.90
Validation precision: 72.00
Validation AUC: 0.6049433864396682
Validation class accuracies: [0.987783595113438, 0.43902439024390244]
2021-06-30 03:58:26.062043: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 03:58:35.986157: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 4374
2021-06-30 03:58:46.185317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 4374
2021-06-30 03:58:56.222281: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 4374
2021-06-30 03:59:06.090014: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 4374
2021-06-30 03:59:16.165213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 4374
2021-06-30 03:59:25.986136: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4042 of 4374
2021-06-30 03:59:34.576730: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5846153846153846 hasn't increased by 0 in 1 epochs
Epoch 6/65
274/274 - 182s - loss: 0.0211 - accuracy: 0.9865 - val_loss: 0.3718 - val_accuracy: 0.9414
Confusion matrix: 
 [[573   0]
 [ 36   5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.878 0.122]]
Validation f1: 21.74
Validation accuracy: 94.14
Validation recall: 12.20
Validation precision: 100.00
Validation AUC: 0.5537313720993118
Validation class accuracies: [1.0, 0.12195121951219512]
2021-06-30 04:01:38.886960: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 04:01:48.942182: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 04:01:59.069472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 4374
2021-06-30 04:02:09.106071: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 4374
2021-06-30 04:02:18.929675: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 04:02:29.006279: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3377 of 4374
2021-06-30 04:02:38.901479: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4066 of 4374
2021-06-30 04:02:44.548436: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5846153846153846 hasn't increased by 0 in 2 epochs
Epoch 7/65
274/274 - 178s - loss: 0.0198 - accuracy: 0.9874 - val_loss: 0.1629 - val_accuracy: 0.9528
Confusion matrix: 
 [[564   9]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.488 0.512]]
Validation f1: 59.15
Validation accuracy: 95.28
Validation recall: 51.22
Validation precision: 70.00
Validation AUC: 0.660585579737348
Validation class accuracies: [0.9842931937172775, 0.5121951219512195]
2021-06-30 04:04:48.810279: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 04:04:58.920250: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1089 of 4374
2021-06-30 04:05:08.811298: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1633 of 4374
2021-06-30 04:05:18.645853: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4374
2021-06-30 04:05:28.747072: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3073 of 4374
2021-06-30 04:05:38.810866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3793 of 4374
2021-06-30 04:05:48.622095: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4365 of 4374
2021-06-30 04:05:48.762924: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 8/65
274/274 - 176s - loss: 0.0135 - accuracy: 0.9883 - val_loss: 0.1601 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
Validation f1: 66.67
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.65394849638955
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
2021-06-30 04:07:54.157256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 04:08:04.029859: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 04:08:14.059805: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 04:08:24.100658: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 04:08:34.180741: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 4374
2021-06-30 04:08:44.027792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4229 of 4374
2021-06-30 04:08:46.666382: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 9/65
274/274 - 164s - loss: 0.0128 - accuracy: 0.9883 - val_loss: 0.2105 - val_accuracy: 0.9609
Confusion matrix: 
 [[569   4]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.488 0.512]]
Validation f1: 63.64
Validation accuracy: 96.09
Validation recall: 51.22
Validation precision: 84.00
Validation AUC: 0.681846959088087
Validation class accuracies: [0.9930191972076788, 0.5121951219512195]
2021-06-30 04:10:47.129517: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 04:10:57.150601: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 04:11:07.127904: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 04:11:17.330837: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 04:11:27.258166: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 4374
2021-06-30 04:11:37.121838: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4003 of 4374
2021-06-30 04:11:46.621111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 1 epochs
Epoch 10/65
274/274 - 171s - loss: 0.0156 - accuracy: 0.9872 - val_loss: 0.1920 - val_accuracy: 0.9528
Confusion matrix: 
 [[571   2]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.659 0.341]]
Validation f1: 49.12
Validation accuracy: 95.28
Validation recall: 34.15
Validation precision: 87.50
Validation AUC: 0.6719880474710185
Validation class accuracies: [0.9965095986038395, 0.34146341463414637]
2021-06-30 04:13:46.967102: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 04:13:56.979358: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 4374
2021-06-30 04:14:06.851589: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 4374
2021-06-30 04:14:16.905473: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2513 of 4374
2021-06-30 04:14:27.058877: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3105 of 4374
2021-06-30 04:14:37.029265: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3681 of 4374
2021-06-30 04:14:46.857168: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4162 of 4374
2021-06-30 04:14:52.239863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 2 epochs
Epoch 11/65
274/274 - 176s - loss: 0.0109 - accuracy: 0.9883 - val_loss: 0.2023 - val_accuracy: 0.9479
Confusion matrix: 
 [[570   3]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.707 0.293]]
Validation f1: 42.86
Validation accuracy: 94.79
Validation recall: 29.27
Validation precision: 80.00
Validation AUC: 0.6590115926171828
Validation class accuracies: [0.9947643979057592, 0.2926829268292683]
2021-06-30 04:16:54.801846: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 04:17:04.901333: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 04:17:14.785500: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 4374
2021-06-30 04:17:24.886763: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 4374
2021-06-30 04:17:34.960054: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 4374
2021-06-30 04:17:44.738628: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 4374
2021-06-30 04:17:54.737398: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4000 of 4374
2021-06-30 04:18:04.720637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4360 of 4374
2021-06-30 04:18:04.961794: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 3 epochs
Epoch 12/65
274/274 - 183s - loss: 0.0100 - accuracy: 0.9883 - val_loss: 0.1853 - val_accuracy: 0.9495
Confusion matrix: 
 [[555  18]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.317 0.683]]
Validation f1: 64.37
Validation accuracy: 94.95
Validation recall: 68.29
Validation precision: 60.87
Validation AUC: 0.6891594802370039
Validation class accuracies: [0.9685863874345549, 0.6829268292682927]
2021-06-30 04:20:08.837248: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 04:20:18.895465: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 04:20:28.903856: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4374
2021-06-30 04:20:38.992128: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-30 04:20:48.694553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2817 of 4374
2021-06-30 04:20:58.751932: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3537 of 4374
2021-06-30 04:21:08.721040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4188 of 4374
2021-06-30 04:21:12.110356: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 4 epochs
Epoch 13/65
274/274 - 176s - loss: 0.0116 - accuracy: 0.9883 - val_loss: 0.2274 - val_accuracy: 0.9349
Confusion matrix: 
 [[545  28]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.293 0.707]]
Validation f1: 59.18
Validation accuracy: 93.49
Validation recall: 70.73
Validation precision: 50.88
Validation AUC: 0.6835933348123636
Validation class accuracies: [0.9511343804537522, 0.7073170731707317]
2021-06-30 04:23:16.166119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 433 of 4374
2021-06-30 04:23:25.807979: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 4374
2021-06-30 04:23:35.935574: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 4374
2021-06-30 04:23:45.864147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2545 of 4374
2021-06-30 04:23:55.843147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3249 of 4374
2021-06-30 04:24:05.801165: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3983 of 4374
2021-06-30 04:24:12.945499: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 5 epochs
Epoch 14/65
274/274 - 168s - loss: 0.0110 - accuracy: 0.9886 - val_loss: 0.2076 - val_accuracy: 0.9381
Confusion matrix: 
 [[553  20]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.439 0.561]]
Validation f1: 54.76
Validation accuracy: 93.81
Validation recall: 56.10
Validation precision: 53.49
Validation AUC: 0.6326526747489958
Validation class accuracies: [0.9650959860383944, 0.5609756097560976]
2021-06-30 04:26:13.007765: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 04:26:23.106783: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 04:26:33.066708: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 4374
2021-06-30 04:26:43.063651: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 4374
2021-06-30 04:26:53.151836: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3553 of 4374
2021-06-30 04:27:03.076559: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4157 of 4374
2021-06-30 04:27:08.697454: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 15/65
274/274 - 167s - loss: 0.0110 - accuracy: 0.9879 - val_loss: 0.2086 - val_accuracy: 0.9430
Confusion matrix: 
 [[553  20]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.366 0.634]]
Validation f1: 59.77
Validation accuracy: 94.30
Validation recall: 63.41
Validation precision: 56.52
Validation AUC: 0.651327363540202
Validation class accuracies: [0.9650959860383944, 0.6341463414634146]
2021-06-30 04:29:09.049852: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 04:29:18.903908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 04:29:29.081111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 04:29:39.057490: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2753 of 4374
2021-06-30 04:29:48.931852: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3313 of 4374
2021-06-30 04:29:59.062372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3905 of 4374
2021-06-30 04:30:08.901583: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4314 of 4374
2021-06-30 04:30:10.376734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 7 epochs
Epoch 16/65
274/274 - 172s - loss: 0.0088 - accuracy: 0.9886 - val_loss: 0.1780 - val_accuracy: 0.9625
Confusion matrix: 
 [[567   6]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.415 0.585]]
Validation f1: 67.61
Validation accuracy: 96.25
Validation recall: 58.54
Validation precision: 80.00
Validation AUC: 0.6950370432382891
Validation class accuracies: [0.9895287958115183, 0.5853658536585366]
2021-06-30 04:32:10.408950: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 4374
2021-06-30 04:32:20.443957: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 4374
2021-06-30 04:32:30.302921: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1793 of 4374
2021-06-30 04:32:40.317768: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 4374
2021-06-30 04:32:50.369774: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 4374
2021-06-30 04:33:00.461859: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 4374
2021-06-30 04:33:10.299514: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4090 of 4374
2021-06-30 04:33:17.624385: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 17/65
274/274 - 180s - loss: 0.0088 - accuracy: 0.9881 - val_loss: 0.2013 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.6609868308463944
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
2021-06-30 04:35:21.977639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 04:35:32.082279: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 04:35:41.859042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4374
2021-06-30 04:35:52.005280: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4374
2021-06-30 04:36:02.096291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 4374
2021-06-30 04:36:12.021499: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3393 of 4374
2021-06-30 04:36:21.848315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4004 of 4374
2021-06-30 04:36:28.629109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.676056338028169 hasn't increased by 0 in 1 epochs
Epoch 18/65
274/274 - 179s - loss: 0.0086 - accuracy: 0.9886 - val_loss: 0.2203 - val_accuracy: 0.9577
Confusion matrix: 
 [[571   2]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.585 0.415]]
Validation f1: 56.67
Validation accuracy: 95.77
Validation recall: 41.46
Validation precision: 89.47
Validation AUC: 0.6870105213003559
Validation class accuracies: [0.9965095986038395, 0.4146341463414634]
2021-06-30 04:38:32.508314: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 04:38:42.507411: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 04:38:52.802652: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 4374
2021-06-30 04:39:02.586056: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2305 of 4374
2021-06-30 04:39:12.603543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3025 of 4374
2021-06-30 04:39:22.490530: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3729 of 4374
2021-06-30 04:39:32.461366: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4336 of 4374
2021-06-30 04:39:33.112639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.676056338028169 hasn't increased by 0 in 2 epochs
Epoch 19/65
274/274 - 174s - loss: 0.0081 - accuracy: 0.9886 - val_loss: 0.1910 - val_accuracy: 0.9577
Confusion matrix: 
 [[565   8]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.439 0.561]]
Validation f1: 63.89
Validation accuracy: 95.77
Validation recall: 56.10
Validation precision: 74.19
Validation AUC: 0.6811969924282143
Validation class accuracies: [0.9860383944153578, 0.5609756097560976]
2021-06-30 04:41:38.803277: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 04:41:48.774651: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 04:41:58.926853: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 04:42:08.826643: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 04:42:18.936775: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 4374
2021-06-30 04:42:28.737676: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4236 of 4374
2021-06-30 04:42:31.272412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.676056338028169 hasn't increased by 0 in 3 epochs
Epoch 20/65
274/274 - 164s - loss: 0.0086 - accuracy: 0.9886 - val_loss: 0.2981 - val_accuracy: 0.9560
Confusion matrix: 
 [[572   1]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.634 0.366]]
Validation f1: 52.63
Validation accuracy: 95.60
Validation recall: 36.59
Validation precision: 93.75
Validation AUC: 0.642716655598081
Validation class accuracies: [0.9982547993019197, 0.36585365853658536]
2021-06-30 04:44:31.238397: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 04:44:41.407046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 04:44:51.424624: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 04:45:01.280509: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 04:45:11.264566: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3537 of 4374
2021-06-30 04:45:21.240565: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4067 of 4374
2021-06-30 04:45:29.340516: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.676056338028169 hasn't increased by 0 in 4 epochs
Epoch 21/65
274/274 - 169s - loss: 0.0081 - accuracy: 0.9886 - val_loss: 0.1978 - val_accuracy: 0.9691
Confusion matrix: 
 [[572   1]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.439 0.561]]
Validation f1: 70.77
Validation accuracy: 96.91
Validation recall: 56.10
Validation precision: 95.83
Validation AUC: 0.7277867148994722
Validation class accuracies: [0.9982547993019197, 0.5609756097560976]
2021-06-30 04:47:29.505201: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 04:47:39.397477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 4374
2021-06-30 04:47:49.373046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 4374
2021-06-30 04:47:59.591058: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2561 of 4374
2021-06-30 04:48:09.433860: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3137 of 4374
2021-06-30 04:48:19.464652: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3729 of 4374
2021-06-30 04:48:29.368439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4199 of 4374
2021-06-30 04:48:33.798573: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 22/65
274/274 - 175s - loss: 0.0086 - accuracy: 0.9886 - val_loss: 0.1946 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.7125101880871738
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
2021-06-30 04:50:35.640991: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 04:50:45.750107: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 04:50:55.597830: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 4374
2021-06-30 04:51:05.771225: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 4374
2021-06-30 04:51:15.741098: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 4374
2021-06-30 04:51:25.557428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 4374
2021-06-30 04:51:35.567585: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4024 of 4374
2021-06-30 04:51:45.561881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4328 of 4374
2021-06-30 04:51:46.981589: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 1 epochs
Epoch 23/65
274/274 - 184s - loss: 0.0084 - accuracy: 0.9886 - val_loss: 0.2046 - val_accuracy: 0.9560
Confusion matrix: 
 [[569   4]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.561 0.439]]
Validation f1: 57.14
Validation accuracy: 95.60
Validation recall: 43.90
Validation precision: 81.82
Validation AUC: 0.6978642864694014
Validation class accuracies: [0.9930191972076788, 0.43902439024390244]
2021-06-30 04:53:51.061656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 04:54:01.191583: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 04:54:10.975887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4374
2021-06-30 04:54:21.108181: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4374
2021-06-30 04:54:30.947613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2785 of 4374
2021-06-30 04:54:41.151764: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 4374
2021-06-30 04:54:50.964719: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4168 of 4374
2021-06-30 04:54:54.694457: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 2 epochs
Epoch 24/65
274/274 - 176s - loss: 0.0075 - accuracy: 0.9886 - val_loss: 0.1979 - val_accuracy: 0.9511
Confusion matrix: 
 [[566   7]
 [ 23  18]]
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.561 0.439]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.55
Validation accuracy: 95.11
Validation recall: 43.90
Validation precision: 72.00
Validation AUC: 0.6528081870715635
Validation class accuracies: [0.987783595113438, 0.43902439024390244]
2021-06-30 04:56:58.691715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 4374
2021-06-30 04:57:08.719511: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 4374
2021-06-30 04:57:18.671239: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1793 of 4374
2021-06-30 04:57:28.658297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2513 of 4374
2021-06-30 04:57:38.635973: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3217 of 4374
2021-06-30 04:57:48.758175: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3953 of 4374
2021-06-30 04:57:56.237081: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 3 epochs
Epoch 25/65
274/274 - 170s - loss: 0.0071 - accuracy: 0.9886 - val_loss: 0.1981 - val_accuracy: 0.9414
Confusion matrix: 
 [[558  15]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.512 0.488]]
Validation f1: 52.63
Validation accuracy: 94.14
Validation recall: 48.78
Validation precision: 57.14
Validation AUC: 0.6569940320644759
Validation class accuracies: [0.9738219895287958, 0.4878048780487805]
2021-06-30 04:59:57.133621: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 05:00:07.267496: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 05:00:17.294091: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 05:00:27.282554: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 05:00:37.351577: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 4374
2021-06-30 05:00:47.117843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4233 of 4374
2021-06-30 05:00:50.263627: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 4 epochs
Epoch 26/65
274/274 - 164s - loss: 0.0072 - accuracy: 0.9883 - val_loss: 0.2040 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.6677526895027346
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-30 05:02:50.620059: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 05:03:00.556288: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 05:03:10.522751: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 4374
2021-06-30 05:03:20.481954: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2753 of 4374
2021-06-30 05:03:30.549469: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3329 of 4374
2021-06-30 05:03:40.633157: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3921 of 4374
2021-06-30 05:03:50.450231: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4326 of 4374
2021-06-30 05:03:51.636909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 5 epochs
Epoch 27/65
274/274 - 172s - loss: 0.0076 - accuracy: 0.9886 - val_loss: 0.2181 - val_accuracy: 0.9528
Confusion matrix: 
 [[565   8]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.512 0.488]]
Validation f1: 57.97
Validation accuracy: 95.28
Validation recall: 48.78
Validation precision: 71.43
Validation AUC: 0.6172432543601765
Validation class accuracies: [0.9860383944153578, 0.4878048780487805]
2021-06-30 05:05:51.702761: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 4374
2021-06-30 05:06:01.683340: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 4374
2021-06-30 05:06:11.743177: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 4374
2021-06-30 05:06:21.795607: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 4374
2021-06-30 05:06:31.683299: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 4374
2021-06-30 05:06:41.881274: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 4374
2021-06-30 05:06:51.637277: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4109 of 4374
2021-06-30 05:06:58.457572: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 28/65
274/274 - 180s - loss: 0.0069 - accuracy: 0.9886 - val_loss: 0.1979 - val_accuracy: 0.9609
Confusion matrix: 
 [[564   9]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.366 0.634]]
Validation f1: 68.42
Validation accuracy: 96.09
Validation recall: 63.41
Validation precision: 74.29
Validation AUC: 0.7033060822349103
Validation class accuracies: [0.9842931937172775, 0.6341463414634146]
2021-06-30 05:09:03.001699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 05:09:13.074129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 05:09:23.112230: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 4374
2021-06-30 05:09:32.993483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4374
2021-06-30 05:09:43.122291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 4374
2021-06-30 05:09:53.229439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3425 of 4374
2021-06-30 05:10:02.936710: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3999 of 4374
2021-06-30 05:10:09.900497: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 7 epochs
Epoch 29/65
274/274 - 180s - loss: 0.0072 - accuracy: 0.9886 - val_loss: 0.2001 - val_accuracy: 0.9511
Confusion matrix: 
 [[559  14]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.39  0.61 ]]
Validation f1: 62.50
Validation accuracy: 95.11
Validation recall: 60.98
Validation precision: 64.10
Validation AUC: 0.6924246099150976
Validation class accuracies: [0.9755671902268761, 0.6097560975609756]
2021-06-30 05:12:13.873498: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 05:12:23.999025: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 05:12:34.074960: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 4374
2021-06-30 05:12:43.847437: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4374
2021-06-30 05:12:53.956072: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 4374
2021-06-30 05:13:03.992178: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 4374
2021-06-30 05:13:13.822100: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4324 of 4374
2021-06-30 05:13:14.693563: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 8 epochs
Epoch 30/65
274/274 - 173s - loss: 0.0061 - accuracy: 0.9886 - val_loss: 0.1819 - val_accuracy: 0.9609
Confusion matrix: 
 [[564   9]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 68.42
Validation accuracy: 96.09
Validation recall: 63.41
Validation precision: 74.29
Validation AUC: 0.7033937653060378
Validation class accuracies: [0.9842931937172775, 0.6341463414634146]
2021-06-30 05:15:20.258477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 05:15:30.293359: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 05:15:40.108828: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 05:15:50.064450: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 05:16:00.095353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 4374
2021-06-30 05:16:10.067026: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4234 of 4374
2021-06-30 05:16:12.606375: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 9 epochs
Epoch 31/65
274/274 - 163s - loss: 0.0063 - accuracy: 0.9886 - val_loss: 0.1972 - val_accuracy: 0.9511
Confusion matrix: 
 [[563  10]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.488 0.512]]
Validation f1: 58.33
Validation accuracy: 95.11
Validation recall: 51.22
Validation precision: 67.74
Validation AUC: 0.6800228607763733
Validation class accuracies: [0.9825479930191972, 0.5121951219512195]
2021-06-30 05:18:12.548543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 05:18:22.420417: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 05:18:32.473283: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 05:18:42.617530: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 4374
2021-06-30 05:18:52.419289: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 4374
2021-06-30 05:19:02.429785: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4103 of 4374
2021-06-30 05:19:09.564296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 10 epochs
Epoch 32/65
274/274 - 168s - loss: 0.0063 - accuracy: 0.9886 - val_loss: 0.1916 - val_accuracy: 0.9479
Confusion matrix: 
 [[560  13]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.463 0.537]]
Validation f1: 57.89
Validation accuracy: 94.79
Validation recall: 53.66
Validation precision: 62.86
Validation AUC: 0.681187961526353
Validation class accuracies: [0.9773123909249564, 0.5365853658536586]
2021-06-30 05:21:09.725912: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 05:21:19.576777: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 05:21:29.542385: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 4374
2021-06-30 05:21:39.612540: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2609 of 4374
2021-06-30 05:21:49.572756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3185 of 4374
2021-06-30 05:21:59.685485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3777 of 4374
2021-06-30 05:22:09.590021: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4234 of 4374
2021-06-30 05:22:13.129652: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 11 epochs
Epoch 33/65
274/274 - 175s - loss: 0.0070 - accuracy: 0.9886 - val_loss: 0.2054 - val_accuracy: 0.9528
Confusion matrix: 
 [[563  10]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.463 0.537]]
Validation f1: 60.27
Validation accuracy: 95.28
Validation recall: 53.66
Validation precision: 68.75
Validation AUC: 0.687106861052403
Validation class accuracies: [0.9825479930191972, 0.5365853658536586]
2021-06-30 05:24:14.670739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 05:24:24.646584: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 05:24:34.764176: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 4374
2021-06-30 05:24:44.680395: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2593 of 4374
2021-06-30 05:24:54.714499: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3313 of 4374
2021-06-30 05:25:04.604882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4023 of 4374
2021-06-30 05:25:12.401038: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 34/65
274/274 - 174s - loss: 0.0067 - accuracy: 0.9886 - val_loss: 0.2001 - val_accuracy: 0.9544
Confusion matrix: 
 [[564   9]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.463 0.537]]
Validation f1: 61.11
Validation accuracy: 95.44
Validation recall: 53.66
Validation precision: 70.97
Validation AUC: 0.6848474913969171
Validation class accuracies: [0.9842931937172775, 0.5365853658536586]
2021-06-30 05:27:18.015277: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 05:27:27.980596: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 05:27:38.050372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 05:27:48.080074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 05:27:58.133881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 4374
2021-06-30 05:28:07.957496: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4224 of 4374
2021-06-30 05:28:10.662605: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 13 epochs
Epoch 35/65
274/274 - 164s - loss: 0.0068 - accuracy: 0.9886 - val_loss: 0.2015 - val_accuracy: 0.9577
Confusion matrix: 
 [[567   6]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.488 0.512]]
Validation f1: 61.76
Validation accuracy: 95.77
Validation recall: 51.22
Validation precision: 77.78
Validation AUC: 0.6866494597358773
Validation class accuracies: [0.9895287958115183, 0.5121951219512195]
2021-06-30 05:30:10.835316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 05:30:20.910689: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 05:30:30.739417: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 05:30:40.751233: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 05:30:50.733079: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 4374
2021-06-30 05:31:00.702613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4028 of 4374
2021-06-30 05:31:09.554024: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 14 epochs
Epoch 36/65
274/274 - 170s - loss: 0.0061 - accuracy: 0.9886 - val_loss: 0.2082 - val_accuracy: 0.9560
Confusion matrix: 
 [[566   7]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.488 0.512]]
Validation f1: 60.87
Validation accuracy: 95.60
Validation recall: 51.22
Validation precision: 75.00
Validation AUC: 0.6793086682979241
Validation class accuracies: [0.987783595113438, 0.5121951219512195]
2021-06-30 05:33:09.432158: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 05:33:19.576745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 4374
2021-06-30 05:33:29.667537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 4374
2021-06-30 05:33:39.469386: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2529 of 4374
2021-06-30 05:33:49.549049: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3121 of 4374
2021-06-30 05:33:59.416188: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3697 of 4374
2021-06-30 05:34:09.409836: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4183 of 4374
2021-06-30 05:34:14.199637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 15 epochs
Epoch 37/65
274/274 - 176s - loss: 0.0065 - accuracy: 0.9886 - val_loss: 0.2072 - val_accuracy: 0.9560
Confusion matrix: 
 [[567   6]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.512 0.488]]
Validation f1: 59.70
Validation accuracy: 95.60
Validation recall: 48.78
Validation precision: 76.92
Validation AUC: 0.6729315944586124
Validation class accuracies: [0.9895287958115183, 0.4878048780487805]
2021-06-30 05:36:16.684420: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 05:36:26.640556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 05:36:36.539452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 4374
2021-06-30 05:36:46.666164: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 4374
2021-06-30 05:36:56.448537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 4374
2021-06-30 05:37:06.482775: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 4374
2021-06-30 05:37:16.449358: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4013 of 4374
2021-06-30 05:37:26.465060: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4336 of 4374
2021-06-30 05:37:27.144283: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 16 epochs
Epoch 38/65
274/274 - 183s - loss: 0.0064 - accuracy: 0.9886 - val_loss: 0.1996 - val_accuracy: 0.9528
Confusion matrix: 
 [[563  10]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.27
Validation accuracy: 95.28
Validation recall: 53.66
Validation precision: 68.75
Validation AUC: 0.6837443097128546
Validation class accuracies: [0.9825479930191972, 0.5365853658536586]
2021-06-30 05:39:30.759713: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 05:39:40.897352: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 05:39:50.946746: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 4374
2021-06-30 05:40:00.937813: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4374
2021-06-30 05:40:10.741995: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2817 of 4374
2021-06-30 05:40:20.743989: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3537 of 4374
2021-06-30 05:40:30.721926: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4193 of 4374
2021-06-30 05:40:33.951912: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 17 epochs
Epoch 39/65
274/274 - 176s - loss: 0.0063 - accuracy: 0.9886 - val_loss: 0.1996 - val_accuracy: 0.9511
Confusion matrix: 
 [[561  12]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.439 0.561]]
Validation f1: 60.53
Validation accuracy: 95.11
Validation recall: 56.10
Validation precision: 65.71
Validation AUC: 0.6858623573545728
Validation class accuracies: [0.9790575916230366, 0.5609756097560976]
2021-06-30 05:42:37.981822: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 4374
2021-06-30 05:42:47.833868: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1057 of 4374
2021-06-30 05:42:57.894083: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1793 of 4374
2021-06-30 05:43:07.838649: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2513 of 4374
2021-06-30 05:43:17.954462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3249 of 4374
2021-06-30 05:43:27.885163: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3953 of 4374
2021-06-30 05:43:35.332909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 40/65
274/274 - 170s - loss: 0.0067 - accuracy: 0.9883 - val_loss: 0.2084 - val_accuracy: 0.9544
Confusion matrix: 
 [[566   7]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.512 0.488]]
Validation f1: 58.82
Validation accuracy: 95.44
Validation recall: 48.78
Validation precision: 74.07
Validation AUC: 0.6801480042626008
Validation class accuracies: [0.987783595113438, 0.4878048780487805]
2021-06-30 05:45:36.966328: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 05:45:47.150893: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 4374
2021-06-30 05:45:57.057917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 4374
2021-06-30 05:46:06.995867: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 4374
2021-06-30 05:46:16.955753: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3617 of 4374
2021-06-30 05:46:26.958747: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4256 of 4374
2021-06-30 05:46:29.071130: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.7076923076923077 hasn't increased by 0 in 19 epochs
Epoch 41/65
274/274 - 163s - loss: 0.0069 - accuracy: 0.9886 - val_loss: 0.1984 - val_accuracy: 0.9544
Confusion matrix: 
 [[564   9]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.11
Validation accuracy: 95.44
Validation recall: 53.66
Validation precision: 70.97
Validation AUC: 0.6829340594135858
Validation class accuracies: [0.9842931937172775, 0.5365853658536586]

The metrics for job 0 with the best target metric are: 
Best cm: [[572   1]
 [ 18  23]]
Best normalized cm: [[0.998 0.002]
 [0.439 0.561]]
Best f1: 0.71
Best accuracy: 0.97
Best recall: 0.56
Best precision: 0.96
Best AUC: 0.73
Best class accuracies: [0.9982547993019197, 0.5609756097560976]
Best epoch: 21
The number of epochs since last 1% equals the patience
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.529e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.895e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.101]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[7.463e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[3.746e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.484]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.205e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[4.688e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[3.862e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[1.585e-08]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[8.107e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[2.201e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[4.227e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[7.881e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.462e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[1.188e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.717e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[7.495e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[1.178e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[5.255e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[9.383e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2276__06_0341__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.024]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 7343
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_034142-2mxm2hab/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_034142-2mxm2hab/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98857
wandb:         val_accuracy 0.9544
wandb:             _runtime 7596
wandb:           _timestamp 1625032098
wandb:                _step 304
wandb:           train_loss 0.00686
wandb:             val_loss 0.19837
wandb:           val_recall 0.53659
wandb:        val_precision 0.70968
wandb:               val_f1 0.61111
wandb:              val_auc 0.68293
wandb:                   lr 6e-05
wandb:          best_val_f1 0.70769
wandb:    best_val_accuracy 0.96906
wandb:   best_val_precision 0.95833
wandb:      best_val_recall 0.56098
wandb:             best_auc 0.72779
wandb:           best_epoch 21
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_034142-2mxm2hab

-----------------------
Changing augmentation to v43,v48
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v43,v48'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-30 05:50:33.506272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 4374
2021-06-30 05:50:43.465444: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1422 of 4374
2021-06-30 05:50:53.632330: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 05:51:03.540435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 05:51:13.681162: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 4374
2021-06-30 05:51:23.477769: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4235 of 4374
2021-06-30 05:51:25.985350: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3974
-----------------------
Number of train recordings: 3974 with pneumonia: 474 and non-pneumonia: 3500
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 4374
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_5 (MixDepthGroupCo (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_6 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_7 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_8 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_9 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
274/274 - 164s - loss: 0.2617 - accuracy: 0.9042 - val_loss: 0.2631 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08116053320624038
Validation class accuracies: [1.0, 0.0]
2021-06-30 05:53:25.902457: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 718 of 4374
2021-06-30 05:53:35.915900: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 05:53:45.990160: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 05:53:56.084933: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 05:54:06.046908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 4374
2021-06-30 05:54:15.949637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4125 of 4374
2021-06-30 05:54:22.320691: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
274/274 - 167s - loss: 0.1002 - accuracy: 0.9604 - val_loss: 0.3422 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.41245265217606886
Validation class accuracies: [1.0, 0.0]
2021-06-30 05:56:22.034863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 05:56:31.971229: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 05:56:41.908752: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2105 of 4374
2021-06-30 05:56:52.065970: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2673 of 4374
2021-06-30 05:57:02.032306: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3233 of 4374
2021-06-30 05:57:11.908603: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3810 of 4374
2021-06-30 05:57:21.945264: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4261 of 4374
2021-06-30 05:57:24.849901: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
274/274 - 174s - loss: 0.0522 - accuracy: 0.9787 - val_loss: 0.1543 - val_accuracy: 0.9625
Confusion matrix: 
 [[572   1]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.537 0.463]]
Validation f1: 62.30
Validation accuracy: 96.25
Validation recall: 46.34
Validation precision: 95.00
Validation AUC: 0.7192837343851101
Validation class accuracies: [0.9982547993019197, 0.4634146341463415]
2021-06-30 05:59:24.715079: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 593 of 4374
2021-06-30 05:59:34.673195: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 05:59:44.705279: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4374
2021-06-30 05:59:54.771327: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4374
2021-06-30 06:00:04.717474: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 4374
2021-06-30 06:00:14.666623: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 4374
2021-06-30 06:00:24.620348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4054 of 4374
2021-06-30 06:00:32.750997: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
274/274 - 182s - loss: 0.0294 - accuracy: 0.9856 - val_loss: 0.1975 - val_accuracy: 0.9479
Confusion matrix: 
 [[553  20]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.293 0.707]]
Validation f1: 64.44
Validation accuracy: 94.79
Validation recall: 70.73
Validation precision: 59.18
Validation AUC: 0.6866704846165027
Validation class accuracies: [0.9650959860383944, 0.7073170731707317]
2021-06-30 06:02:38.361899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 06:02:48.328631: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 06:02:58.273424: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 4374
2021-06-30 06:03:08.403578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 4374
2021-06-30 06:03:18.330503: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 4374
2021-06-30 06:03:28.254533: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3393 of 4374
2021-06-30 06:03:38.244582: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4083 of 4374
2021-06-30 06:03:43.569163: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
274/274 - 179s - loss: 0.0210 - accuracy: 0.9877 - val_loss: 0.1670 - val_accuracy: 0.9528
Confusion matrix: 
 [[560  13]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.39  0.61 ]]
Validation f1: 63.29
Validation accuracy: 95.28
Validation recall: 60.98
Validation precision: 65.79
Validation AUC: 0.679657350092845
Validation class accuracies: [0.9773123909249564, 0.6097560975609756]
2021-06-30 06:05:48.175711: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 06:05:58.320856: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 4374
2021-06-30 06:06:08.196403: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1649 of 4374
2021-06-30 06:06:18.119626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 4374
2021-06-30 06:06:28.140309: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3057 of 4374
2021-06-30 06:06:38.099052: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3777 of 4374
2021-06-30 06:06:48.017488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4373 of 4374
2021-06-30 06:06:48.031117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6444444444444445 hasn't increased by 0 in 1 epochs
Epoch 6/65
274/274 - 176s - loss: 0.0145 - accuracy: 0.9895 - val_loss: 0.2189 - val_accuracy: 0.9544
Confusion matrix: 
 [[562  11]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.415 0.585]]
Validation f1: 63.16
Validation accuracy: 95.44
Validation recall: 58.54
Validation precision: 68.57
Validation AUC: 0.6667080495608849
Validation class accuracies: [0.9808027923211169, 0.5853658536585366]
2021-06-30 06:08:53.490569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 06:09:03.535571: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 06:09:13.335479: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 06:09:23.478097: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 4374
2021-06-30 06:09:33.464878: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 4374
2021-06-30 06:09:43.324318: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4221 of 4374
2021-06-30 06:09:46.100735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6444444444444445 hasn't increased by 0 in 2 epochs
Epoch 7/65
274/274 - 165s - loss: 0.0119 - accuracy: 0.9897 - val_loss: 0.2051 - val_accuracy: 0.9674
Confusion matrix: 
 [[573   0]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.488 0.512]]
Validation f1: 67.74
Validation accuracy: 96.74
Validation recall: 51.22
Validation precision: 100.00
Validation AUC: 0.7208358054988127
Validation class accuracies: [1.0, 0.5121951219512195]
2021-06-30 06:11:47.944138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 06:11:57.996359: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 06:12:07.794371: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2136 of 4374
2021-06-30 06:12:17.988992: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 4374
2021-06-30 06:12:27.794789: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3393 of 4374
2021-06-30 06:12:37.874125: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3969 of 4374
2021-06-30 06:12:47.814001: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4352 of 4374
2021-06-30 06:12:48.368480: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 8/65
274/274 - 172s - loss: 0.0112 - accuracy: 0.9890 - val_loss: 0.3684 - val_accuracy: 0.9121
Confusion matrix: 
 [[532  41]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.317 0.683]]
Validation f1: 50.91
Validation accuracy: 91.21
Validation recall: 68.29
Validation precision: 40.58
Validation AUC: 0.650009274845661
Validation class accuracies: [0.9284467713787086, 0.6829268292682927]
2021-06-30 06:14:49.117770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 06:14:59.007409: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1311 of 4374
2021-06-30 06:15:09.072119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 4374
2021-06-30 06:15:19.130559: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2465 of 4374
2021-06-30 06:15:29.134128: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3057 of 4374
2021-06-30 06:15:39.161981: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3649 of 4374
2021-06-30 06:15:49.090031: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4148 of 4374
2021-06-30 06:15:54.844841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 1 epochs
Epoch 9/65
274/274 - 179s - loss: 0.0122 - accuracy: 0.9893 - val_loss: 0.2377 - val_accuracy: 0.9511
Confusion matrix: 
 [[559  14]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.39  0.61 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.50
Validation accuracy: 95.11
Validation recall: 60.98
Validation precision: 64.10
Validation AUC: 0.6710609112610386
Validation class accuracies: [0.9755671902268761, 0.6097560975609756]
2021-06-30 06:17:59.519671: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 06:18:09.582316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 06:18:19.616462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4374
2021-06-30 06:18:29.526313: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 4374
2021-06-30 06:18:39.568655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 4374
2021-06-30 06:18:49.849789: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 4374
2021-06-30 06:18:59.544185: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3937 of 4374
2021-06-30 06:19:07.159233: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 2 epochs
Epoch 10/65
274/274 - 181s - loss: 0.0098 - accuracy: 0.9897 - val_loss: 0.2288 - val_accuracy: 0.9495
Confusion matrix: 
 [[562  11]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.488 0.512]]
Validation f1: 57.53
Validation accuracy: 94.95
Validation recall: 51.22
Validation precision: 65.62
Validation AUC: 0.6477949449952941
Validation class accuracies: [0.9808027923211169, 0.5121951219512195]
2021-06-30 06:21:11.594739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 06:21:21.784396: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 06:21:31.725045: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 4374
2021-06-30 06:21:41.599924: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 4374
2021-06-30 06:21:51.734685: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 4374
2021-06-30 06:22:01.782317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3665 of 4374
2021-06-30 06:22:11.592884: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4282 of 4374
2021-06-30 06:22:13.269215: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 3 epochs
Epoch 11/65
274/274 - 175s - loss: 0.0127 - accuracy: 0.9877 - val_loss: 0.2853 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.661205812194659
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
2021-06-30 06:24:20.635837: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 4374
2021-06-30 06:24:30.715204: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 4374
2021-06-30 06:24:40.616719: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 4374
2021-06-30 06:24:50.550557: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2817 of 4374
2021-06-30 06:25:00.592457: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3553 of 4374
2021-06-30 06:25:10.570517: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4176 of 4374
2021-06-30 06:25:14.260885: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 4 epochs
Epoch 12/65
274/274 - 165s - loss: 0.0085 - accuracy: 0.9890 - val_loss: 0.2417 - val_accuracy: 0.9577
Confusion matrix: 
 [[570   3]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.561 0.439]]
Validation f1: 58.06
Validation accuracy: 95.77
Validation recall: 43.90
Validation precision: 85.71
Validation AUC: 0.6655353310120105
Validation class accuracies: [0.9947643979057592, 0.43902439024390244]
2021-06-30 06:27:14.925934: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 06:27:24.948261: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 06:27:35.033796: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 06:27:45.109959: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 06:27:54.917661: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 4374
2021-06-30 06:28:04.925563: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4107 of 4374
2021-06-30 06:28:11.806262: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 5 epochs
Epoch 13/65
274/274 - 169s - loss: 0.0096 - accuracy: 0.9893 - val_loss: 0.2133 - val_accuracy: 0.9577
Confusion matrix: 
 [[563  10]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.39  0.61 ]]
Validation f1: 65.79
Validation accuracy: 95.77
Validation recall: 60.98
Validation precision: 71.43
Validation AUC: 0.6782977983133993
Validation class accuracies: [0.9825479930191972, 0.6097560975609756]
2021-06-30 06:30:13.148665: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 06:30:23.246502: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 06:30:33.123929: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 4374
2021-06-30 06:30:43.184453: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2625 of 4374
2021-06-30 06:30:53.185466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3201 of 4374
2021-06-30 06:31:03.301684: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3793 of 4374
2021-06-30 06:31:13.165609: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4238 of 4374
2021-06-30 06:31:16.640749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 14/65
274/274 - 175s - loss: 0.0073 - accuracy: 0.9897 - val_loss: 0.2358 - val_accuracy: 0.9511
Confusion matrix: 
 [[559  14]
 [ 16  25]]
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.39  0.61 ]]
Validation f1: 62.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.11
Validation recall: 60.98
Validation precision: 64.10
Validation AUC: 0.6579996773607375
Validation class accuracies: [0.9755671902268761, 0.6097560975609756]
2021-06-30 06:33:18.131576: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 06:33:28.018257: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 4374
2021-06-30 06:33:38.107108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 4374
2021-06-30 06:33:47.900626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 4374
2021-06-30 06:33:57.992894: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 06:34:08.013441: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 4374
2021-06-30 06:34:17.861719: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4031 of 4374
2021-06-30 06:34:27.211082: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 7 epochs
Epoch 15/65
274/274 - 184s - loss: 0.0072 - accuracy: 0.9897 - val_loss: 0.2388 - val_accuracy: 0.9609
Confusion matrix: 
 [[570   3]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.512 0.488]]
Validation f1: 62.50
Validation accuracy: 96.09
Validation recall: 48.78
Validation precision: 86.96
Validation AUC: 0.6814068230842577
Validation class accuracies: [0.9947643979057592, 0.4878048780487805]
2021-06-30 06:36:32.915216: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 06:36:42.809897: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 06:36:52.706880: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1743 of 4374
2021-06-30 06:37:02.807761: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 4374
2021-06-30 06:37:12.718846: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2769 of 4374
2021-06-30 06:37:22.829848: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3441 of 4374
2021-06-30 06:37:32.715586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4119 of 4374
2021-06-30 06:37:37.400399: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 8 epochs
Epoch 16/65
274/274 - 176s - loss: 0.0079 - accuracy: 0.9897 - val_loss: 0.2303 - val_accuracy: 0.9479
Confusion matrix: 
 [[557  16]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.39  0.61 ]]
Validation f1: 60.98
Validation accuracy: 94.79
Validation recall: 60.98
Validation precision: 60.98
Validation AUC: 0.653482767362327
Validation class accuracies: [0.9720767888307156, 0.6097560975609756]
2021-06-30 06:39:37.944079: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 593 of 4374
2021-06-30 06:39:47.956361: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1185 of 4374
2021-06-30 06:39:58.103471: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1777 of 4374
2021-06-30 06:40:08.010343: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 4374
2021-06-30 06:40:18.043579: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 4374
2021-06-30 06:40:27.938695: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 4374
2021-06-30 06:40:37.983935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3969 of 4374
2021-06-30 06:40:47.904954: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4353 of 4374
2021-06-30 06:40:48.397361: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 9 epochs
Epoch 17/65
274/274 - 183s - loss: 0.0076 - accuracy: 0.9897 - val_loss: 0.2449 - val_accuracy: 0.9577
Confusion matrix: 
 [[564   9]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.415 0.585]]
Validation f1: 64.86
Validation accuracy: 95.77
Validation recall: 58.54
Validation precision: 72.73
Validation AUC: 0.6577088890995424
Validation class accuracies: [0.9842931937172775, 0.5853658536585366]
2021-06-30 06:42:50.098513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4374
2021-06-30 06:43:00.056627: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 4374
2021-06-30 06:43:09.931902: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 4374
2021-06-30 06:43:20.103544: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2481 of 4374
2021-06-30 06:43:29.961841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3057 of 4374
2021-06-30 06:43:40.095752: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3649 of 4374
2021-06-30 06:43:49.877429: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4141 of 4374
2021-06-30 06:43:55.832671: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 10 epochs
Epoch 18/65
274/274 - 179s - loss: 0.0070 - accuracy: 0.9897 - val_loss: 0.2484 - val_accuracy: 0.9658
Confusion matrix: 
 [[572   1]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.488 0.512]]
Validation f1: 66.67
Validation accuracy: 96.58
Validation recall: 51.22
Validation precision: 95.45
Validation AUC: 0.7003692915177638
Validation class accuracies: [0.9982547993019197, 0.5121951219512195]
2021-06-30 06:46:00.888512: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 06:46:10.935305: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4374
2021-06-30 06:46:20.969303: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 4374
2021-06-30 06:46:30.817138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4374
2021-06-30 06:46:40.998213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 4374
2021-06-30 06:46:51.037507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 4374
2021-06-30 06:47:00.843551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3937 of 4374
2021-06-30 06:47:08.608365: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 11 epochs
Epoch 19/65
274/274 - 182s - loss: 0.0063 - accuracy: 0.9897 - val_loss: 0.2092 - val_accuracy: 0.9544
Confusion matrix: 
 [[559  14]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.341 0.659]]
Validation f1: 65.85
Validation accuracy: 95.44
Validation recall: 65.85
Validation precision: 65.85
Validation AUC: 0.6569589241396232
Validation class accuracies: [0.9755671902268761, 0.6585365853658537]
2021-06-30 06:49:14.223984: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 06:49:24.079199: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 06:49:34.262470: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 4374
2021-06-30 06:49:44.251935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 4374
2021-06-30 06:49:54.167124: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2945 of 4374
2021-06-30 06:50:04.097715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3665 of 4374
2021-06-30 06:50:14.057824: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4284 of 4374
2021-06-30 06:50:15.696680: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 20/65
274/274 - 176s - loss: 0.0053 - accuracy: 0.9897 - val_loss: 0.2427 - val_accuracy: 0.9593
Confusion matrix: 
 [[567   6]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.463 0.537]]
Validation f1: 63.77
Validation accuracy: 95.93
Validation recall: 53.66
Validation precision: 78.57
Validation AUC: 0.6773768636610139
Validation class accuracies: [0.9895287958115183, 0.5365853658536586]
2021-06-30 06:52:24.005415: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 06:52:34.107945: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4374
2021-06-30 06:52:43.980703: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 06:52:54.072144: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 06:53:04.120413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 4374
2021-06-30 06:53:13.921654: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4233 of 4374
2021-06-30 06:53:16.519959: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 13 epochs
Epoch 21/65
274/274 - 165s - loss: 0.0059 - accuracy: 0.9897 - val_loss: 0.2286 - val_accuracy: 0.9625
Confusion matrix: 
 [[568   5]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.439 0.561]]
Validation f1: 66.67
Validation accuracy: 96.25
Validation recall: 56.10
Validation precision: 82.14
Validation AUC: 0.6808857188367575
Validation class accuracies: [0.9912739965095986, 0.5609756097560976]
2021-06-30 06:55:17.715898: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 06:55:27.848749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 06:55:37.855428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4374
2021-06-30 06:55:47.823824: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 06:55:57.806483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 4374
2021-06-30 06:56:07.665608: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4119 of 4374
2021-06-30 06:56:14.295446: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 14 epochs
Epoch 22/65
274/274 - 169s - loss: 0.0077 - accuracy: 0.9897 - val_loss: 0.2076 - val_accuracy: 0.9544
Confusion matrix: 
 [[562  11]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.415 0.585]]
Validation f1: 63.16
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.44
Validation recall: 58.54
Validation precision: 68.57
Validation AUC: 0.6688357214244015
Validation class accuracies: [0.9808027923211169, 0.5853658536585366]
2021-06-30 06:58:15.577692: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 06:58:25.686053: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 06:58:35.497920: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 4374
2021-06-30 06:58:45.610587: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2641 of 4374
2021-06-30 06:58:55.593255: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3217 of 4374
2021-06-30 06:59:05.583596: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3793 of 4374
2021-06-30 06:59:15.484216: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4241 of 4374
2021-06-30 06:59:18.887333: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 15 epochs
Epoch 23/65
274/274 - 176s - loss: 0.0068 - accuracy: 0.9897 - val_loss: 0.2276 - val_accuracy: 0.9609
Confusion matrix: 
 [[568   5]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.463 0.537]]
Validation f1: 64.71
Validation accuracy: 96.09
Validation recall: 53.66
Validation precision: 81.48
Validation AUC: 0.670775849008318
Validation class accuracies: [0.9912739965095986, 0.5365853658536586]
2021-06-30 07:01:20.745003: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4374
2021-06-30 07:01:30.784396: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 4374
2021-06-30 07:01:40.658414: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 4374
2021-06-30 07:01:50.662042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2305 of 4374
2021-06-30 07:02:00.743298: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 4374
2021-06-30 07:02:10.840456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 4374
2021-06-30 07:02:20.651346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4034 of 4374
2021-06-30 07:02:29.838009: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 16 epochs
Epoch 24/65
274/274 - 183s - loss: 0.0056 - accuracy: 0.9897 - val_loss: 0.2124 - val_accuracy: 0.9560
Confusion matrix: 
 [[563  10]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.415 0.585]]
Validation f1: 64.00
Validation accuracy: 95.60
Validation recall: 58.54
Validation precision: 70.59
Validation AUC: 0.6699187173059722
Validation class accuracies: [0.9825479930191972, 0.5853658536585366]
2021-06-30 07:04:35.342483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 07:04:45.277477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4374
2021-06-30 07:04:55.297021: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4374
2021-06-30 07:05:05.439033: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4374
2021-06-30 07:05:15.404154: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2801 of 4374
2021-06-30 07:05:25.304037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3425 of 4374
2021-06-30 07:05:35.288120: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4108 of 4374
2021-06-30 07:05:40.219869: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 17 epochs
Epoch 25/65
274/274 - 179s - loss: 0.0067 - accuracy: 0.9897 - val_loss: 0.2237 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6601632404026878
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-30 07:07:45.373431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4374
2021-06-30 07:07:55.588546: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 4374
2021-06-30 07:08:05.271063: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 4374
2021-06-30 07:08:15.421905: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 4374
2021-06-30 07:08:25.468263: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3137 of 4374
2021-06-30 07:08:35.274649: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3841 of 4374
2021-06-30 07:08:44.274801: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 26/65
274/274 - 174s - loss: 0.0064 - accuracy: 0.9897 - val_loss: 0.2279 - val_accuracy: 0.9560
Confusion matrix: 
 [[564   9]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.439 0.561]]
Validation f1: 63.01
Validation accuracy: 95.60
Validation recall: 56.10
Validation precision: 71.88
Validation AUC: 0.658463670640117
Validation class accuracies: [0.9842931937172775, 0.5609756097560976]
2021-06-30 07:10:49.090743: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4374
2021-06-30 07:10:59.103561: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4374
2021-06-30 07:11:08.977356: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 4374
2021-06-30 07:11:19.136520: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 4374
2021-06-30 07:11:29.167180: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3617 of 4374
2021-06-30 07:11:38.997606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4248 of 4374
2021-06-30 07:11:41.215508: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6774193548387097 hasn't increased by 0 in 19 epochs
Epoch 27/65
274/274 - 165s - loss: 0.0052 - accuracy: 0.9897 - val_loss: 0.2310 - val_accuracy: 0.9544
Confusion matrix: 
 [[564   9]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.11
Validation accuracy: 95.44
Validation recall: 53.66
Validation precision: 70.97
Validation AUC: 0.6610839270339804
Validation class accuracies: [0.9842931937172775, 0.5365853658536586]

The metrics for job 1 with the best target metric are: 
Best cm: [[573   0]
 [ 20  21]]
Best normalized cm: [[1.    0.   ]
 [0.488 0.512]]
Best f1: 0.68
Best accuracy: 0.97
Best recall: 0.51
Best precision: 1.00
Best AUC: 0.72
Best class accuracies: [1.0, 0.5121951219512195]
Best epoch: 7
The number of epochs since last 1% equals the patience
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_213_2p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[1.594e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_203_2p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_213_1p2_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[2.397e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_221_2b3_Al_mc_LittC2SE_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_205_1b3_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[2.418e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_3b2_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_2b3_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_213_1p5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_2b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[1.355e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_222_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.523e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_203_2p3_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[7.811e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[3.528e-08]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_221_2b3_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_211_2p4_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_223_1b1_Lr_sc_Meditron_0_label_0_pred_0.png, [[5.637e-08]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[2.399e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_204_7p5_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.634e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_217_1b1_Tc_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_218_1b1_Pl_sc_Meditron_9_label_0_pred_0.png, [[3.697e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_205_1b3_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[4.377e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_221_2b2_Ar_mc_LittC2SE_0_label_0_pred_1.png, [[0.634]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_3b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.574e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_2b4_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[2.397e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_211_1p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[1.421e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_203_2p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_204_7p5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_2b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.422e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[4.176e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_219_2b1_Tc_mc_LittC2SE_3_label_1_pred_1.png, [[0.731]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_221_2b2_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.351]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_221_2b3_Pr_mc_LittC2SE_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_205_2b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[4.173e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_223_1b1_Ll_sc_Meditron_0_label_0_pred_0.png, [[1.289e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_3b2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_222_1b1_Lr_sc_Meditron_9_label_0_pred_0.png, [[4.e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_218_1b1_Ar_sc_Meditron_11_label_0_pred_0.png, [[0.019]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_211_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[3.735e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_2b4_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[3.808e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_223_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[3.529e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_203_2p3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[9.035e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_3b2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[2.705e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_207_2b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_205_2b3_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[4.476e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_215_1b3_Tc_sc_Meditron_1_label_0_pred_0.png, [[1.834e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/1/icbhi_222_1b1_Pr_sc_Meditron_11_label_0_pred_0.png, [[2.057e-06]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 27250
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_054854-hweqic2n/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_054854-hweqic2n/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98971
wandb:         val_accuracy 0.9544
wandb:             _runtime 5078
wandb:           _timestamp 1625037212
wandb:                _step 197
wandb:           train_loss 0.00519
wandb:             val_loss 0.23103
wandb:           val_recall 0.53659
wandb:        val_precision 0.70968
wandb:               val_f1 0.61111
wandb:              val_auc 0.66108
wandb:                   lr 0.00013
wandb:          best_val_f1 0.67742
wandb:    best_val_accuracy 0.96743
wandb:   best_val_precision 1.0
wandb:      best_val_recall 0.5122
wandb:             best_auc 0.72084
wandb:           best_epoch 7
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_054854-hweqic2n

-----------------------
Changing augmentation to v42,v43,v48
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43,v48'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-30 07:15:57.199030: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 5132
2021-06-30 07:16:07.240690: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 5132
2021-06-30 07:16:17.200260: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 5132
2021-06-30 07:16:27.342923: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 5132
2021-06-30 07:16:37.316657: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 5132
2021-06-30 07:16:47.162224: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4305 of 5132
2021-06-30 07:16:57.168567: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4960 of 5132
2021-06-30 07:17:01.566462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2932
-----------------------
Number of train recordings: 2932 with pneumonia: 632 and non-pneumonia: 2300
Length of training samples after audio augmentation: 4732
-----------------------
Number of train recordings: 4732 with pneumonia: 632 and non-pneumonia: 4100
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 5132
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_3 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_10 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_11 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_12 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_13 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_14 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
321/321 - 194s - loss: 0.2943 - accuracy: 0.8864 - val_loss: 0.2501 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1555399646362621
Validation class accuracies: [1.0, 0.0]
2021-06-30 07:19:19.985139: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 5132
2021-06-30 07:19:29.964312: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 5132
2021-06-30 07:19:40.141779: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 5132
2021-06-30 07:19:49.973032: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2497 of 5132
2021-06-30 07:20:00.106975: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3089 of 5132
2021-06-30 07:20:09.899440: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3665 of 5132
2021-06-30 07:20:19.859398: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4241 of 5132
2021-06-30 07:20:29.909525: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4798 of 5132
2021-06-30 07:20:38.566877: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
321/321 - 209s - loss: 0.1100 - accuracy: 0.9577 - val_loss: 0.2848 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2385467796652438
Validation class accuracies: [1.0, 0.0]
2021-06-30 07:23:00.738248: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 07:23:10.591685: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 5132
2021-06-30 07:23:20.711691: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 5132
2021-06-30 07:23:30.688138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 5132
2021-06-30 07:23:40.720731: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 5132
2021-06-30 07:23:50.619377: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3553 of 5132
2021-06-30 07:24:00.764414: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4273 of 5132
2021-06-30 07:24:10.605579: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4926 of 5132
2021-06-30 07:24:14.289677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
321/321 - 200s - loss: 0.0556 - accuracy: 0.9797 - val_loss: 0.2399 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.5661111013756078
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
2021-06-30 07:26:30.042551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 5132
2021-06-30 07:26:40.038513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 5132
2021-06-30 07:26:50.204175: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 5132
2021-06-30 07:27:00.010630: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 5132
2021-06-30 07:27:10.135092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3617 of 5132
2021-06-30 07:27:20.105542: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4321 of 5132
2021-06-30 07:27:30.076186: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4842 of 5132
2021-06-30 07:27:37.562768: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
321/321 - 194s - loss: 0.0211 - accuracy: 0.9910 - val_loss: 0.2628 - val_accuracy: 0.9283
Confusion matrix: 
 [[544  29]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.366 0.634]]
Validation f1: 54.17
Validation accuracy: 92.83
Validation recall: 63.41
Validation precision: 47.27
Validation AUC: 0.603858229770949
Validation class accuracies: [0.9493891797556719, 0.6341463414634146]
2021-06-30 07:29:53.316737: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 5132
2021-06-30 07:30:03.378734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 5132
2021-06-30 07:30:13.220199: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 5132
2021-06-30 07:30:23.186253: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 5132
2021-06-30 07:30:33.357813: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 5132
2021-06-30 07:30:43.188524: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 5132
2021-06-30 07:30:53.277952: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4161 of 5132
2021-06-30 07:31:03.208625: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4737 of 5132
2021-06-30 07:31:13.161350: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5101 of 5132
2021-06-30 07:31:14.102380: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 1 epochs
Epoch 5/65
321/321 - 210s - loss: 0.0158 - accuracy: 0.9910 - val_loss: 0.2818 - val_accuracy: 0.9511
Confusion matrix: 
 [[564   9]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.512 0.488]]
Validation f1: 57.14
Validation accuracy: 95.11
Validation recall: 48.78
Validation precision: 68.97
Validation AUC: 0.5808324919580099
Validation class accuracies: [0.9842931937172775, 0.4878048780487805]
2021-06-30 07:33:34.709112: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 07:33:44.635659: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 5132
2021-06-30 07:33:54.922188: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1633 of 5132
2021-06-30 07:34:04.713699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 5132
2021-06-30 07:34:14.748577: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 5132
2021-06-30 07:34:24.765993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3681 of 5132
2021-06-30 07:34:34.614768: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4385 of 5132
2021-06-30 07:34:44.614119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5019 of 5132
2021-06-30 07:34:46.654609: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
321/321 - 199s - loss: 0.0116 - accuracy: 0.9920 - val_loss: 0.2666 - val_accuracy: 0.9365
Confusion matrix: 
 [[553  20]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.463 0.537]]
Validation f1: 53.01
Validation accuracy: 93.65
Validation recall: 53.66
Validation precision: 52.38
Validation AUC: 0.5980845607445275
Validation class accuracies: [0.9650959860383944, 0.5365853658536586]
2021-06-30 07:37:02.311651: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 5132
2021-06-30 07:37:12.371857: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 5132
2021-06-30 07:37:22.323914: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 5132
2021-06-30 07:37:32.429796: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 5132
2021-06-30 07:37:42.290542: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 5132
2021-06-30 07:37:52.381457: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4161 of 5132
2021-06-30 07:38:02.349795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4721 of 5132
2021-06-30 07:38:12.338460: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5116 of 5132
2021-06-30 07:38:12.712783: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 1 epochs
Epoch 7/65
321/321 - 197s - loss: 0.0108 - accuracy: 0.9914 - val_loss: 0.4059 - val_accuracy: 0.8550
Confusion matrix: 
 [[498  75]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.341 0.659]]
Validation f1: 37.76
Validation accuracy: 85.50
Validation recall: 65.85
Validation precision: 26.47
Validation AUC: 0.4678778903988834
Validation class accuracies: [0.8691099476439791, 0.6585365853658537]
2021-06-30 07:40:28.760360: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 5132
2021-06-30 07:40:38.746795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 5132
2021-06-30 07:40:48.577367: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 5132
2021-06-30 07:40:58.721644: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 5132
2021-06-30 07:41:08.636699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 5132
2021-06-30 07:41:18.657723: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 5132
2021-06-30 07:41:28.746262: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4049 of 5132
2021-06-30 07:41:38.775576: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4561 of 5132
2021-06-30 07:41:48.552991: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4993 of 5132
2021-06-30 07:41:51.013587: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 2 epochs
Epoch 8/65
321/321 - 211s - loss: 0.0089 - accuracy: 0.9922 - val_loss: 0.2688 - val_accuracy: 0.9381
Confusion matrix: 
 [[552  21]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.415 0.585]]
Validation f1: 55.81
Validation accuracy: 93.81
Validation recall: 58.54
Validation precision: 53.33
Validation AUC: 0.615063678866538
Validation class accuracies: [0.9633507853403142, 0.5853658536585366]
2021-06-30 07:44:10.709908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 07:44:20.912623: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 5132
2021-06-30 07:44:30.713448: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 5132
2021-06-30 07:44:40.639974: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 5132
2021-06-30 07:44:50.773365: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3153 of 5132
2021-06-30 07:45:00.745990: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3873 of 5132
2021-06-30 07:45:10.802031: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4609 of 5132
2021-06-30 07:45:19.801804: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 3 epochs
Epoch 9/65
321/321 - 197s - loss: 0.0110 - accuracy: 0.9920 - val_loss: 0.2720 - val_accuracy: 0.9511
Confusion matrix: 
 [[565   8]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.537 0.463]]
Validation f1: 55.88
Validation accuracy: 95.11
Validation recall: 46.34
Validation precision: 70.37
Validation AUC: 0.5789305843513066
Validation class accuracies: [0.9860383944153578, 0.4634146341463415]
2021-06-30 07:47:39.236370: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 5132
2021-06-30 07:47:49.191367: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 5132
2021-06-30 07:47:59.191235: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 5132
2021-06-30 07:48:09.335365: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 5132
2021-06-30 07:48:19.361534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2753 of 5132
2021-06-30 07:48:29.431335: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3345 of 5132
2021-06-30 07:48:39.301834: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3921 of 5132
2021-06-30 07:48:49.377922: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4513 of 5132
2021-06-30 07:48:59.174804: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4971 of 5132
2021-06-30 07:49:04.092246: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 4 epochs
Epoch 10/65
321/321 - 214s - loss: 0.0089 - accuracy: 0.9920 - val_loss: 0.3511 - val_accuracy: 0.9593
Confusion matrix: 
 [[572   1]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.585 0.415]]
Validation f1: 57.63
Validation accuracy: 95.93
Validation recall: 41.46
Validation precision: 94.44
Validation AUC: 0.5910053536680787
Validation class accuracies: [0.9982547993019197, 0.4146341463414634]
2021-06-30 07:51:24.148090: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 07:51:34.222342: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 5132
2021-06-30 07:51:44.306173: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 5132
2021-06-30 07:51:54.061560: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 5132
2021-06-30 07:52:04.192123: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 5132
2021-06-30 07:52:14.145676: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 5132
2021-06-30 07:52:24.076871: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3985 of 5132
2021-06-30 07:52:34.074795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4705 of 5132
2021-06-30 07:52:41.672138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 11/65
321/321 - 206s - loss: 0.0080 - accuracy: 0.9918 - val_loss: 0.3114 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.6350846509393432
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
2021-06-30 07:55:01.377693: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 07:55:11.482717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 5132
2021-06-30 07:55:21.549550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1681 of 5132
2021-06-30 07:55:31.329247: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 5132
2021-06-30 07:55:41.511638: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 5132
2021-06-30 07:55:51.465139: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3697 of 5132
2021-06-30 07:56:01.350048: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4417 of 5132
2021-06-30 07:56:11.356506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5051 of 5132
2021-06-30 07:56:12.786883: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.576271186440678 hasn't increased by 0 in 1 epochs
Epoch 12/65
321/321 - 200s - loss: 0.0081 - accuracy: 0.9922 - val_loss: 0.2593 - val_accuracy: 0.9495
Confusion matrix: 
 [[564   9]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.537 0.463]]
Validation f1: 55.07
Validation accuracy: 94.95
Validation recall: 46.34
Validation precision: 67.86
Validation AUC: 0.5671871479443403
Validation class accuracies: [0.9842931937172775, 0.4634146341463415]
2021-06-30 07:58:34.124923: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 593 of 5132
2021-06-30 07:58:44.195387: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 5132
2021-06-30 07:58:54.123801: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 5132
2021-06-30 07:59:04.023923: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2753 of 5132
2021-06-30 07:59:14.179012: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 5132
2021-06-30 07:59:24.169469: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4193 of 5132
2021-06-30 07:59:34.019810: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4865 of 5132
2021-06-30 07:59:38.896091: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.576271186440678 hasn't increased by 0 in 2 epochs
Epoch 13/65
321/321 - 192s - loss: 0.0077 - accuracy: 0.9920 - val_loss: 0.3410 - val_accuracy: 0.9267
Confusion matrix: 
 [[542  31]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.55
Validation accuracy: 92.67
Validation recall: 65.85
Validation precision: 46.55
Validation AUC: 0.5871208276103467
Validation class accuracies: [0.9458987783595113, 0.6585365853658537]
2021-06-30 08:01:54.665966: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 5132
2021-06-30 08:02:04.559227: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 5132
2021-06-30 08:02:14.530498: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 5132
2021-06-30 08:02:24.562508: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 5132
2021-06-30 08:02:34.624522: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 5132
2021-06-30 08:02:44.653389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4321 of 5132
2021-06-30 08:02:54.488422: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4958 of 5132
2021-06-30 08:02:58.542402: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.576271186440678 hasn't increased by 0 in 3 epochs
Epoch 14/65
321/321 - 191s - loss: 0.0075 - accuracy: 0.9920 - val_loss: 0.2834 - val_accuracy: 0.9528
Confusion matrix: 
 [[565   8]
 [ 21  20]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.512 0.488]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.97
Validation accuracy: 95.28
Validation recall: 48.78
Validation precision: 71.43
Validation AUC: 0.6367204267427334
Validation class accuracies: [0.9860383944153578, 0.4878048780487805]
2021-06-30 08:05:14.446560: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 5132
2021-06-30 08:05:24.303460: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 5132
2021-06-30 08:05:34.487652: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 5132
2021-06-30 08:05:44.476345: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 5132
2021-06-30 08:05:54.513487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3553 of 5132
2021-06-30 08:06:04.311753: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4113 of 5132
2021-06-30 08:06:14.530211: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4689 of 5132
2021-06-30 08:06:24.321646: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5084 of 5132
2021-06-30 08:06:25.478985: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 15/65
321/321 - 198s - loss: 0.0072 - accuracy: 0.9922 - val_loss: 0.4400 - val_accuracy: 0.9511
Confusion matrix: 
 [[570   3]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.659 0.341]]
Validation f1: 48.28
Validation accuracy: 95.11
Validation recall: 34.15
Validation precision: 82.35
Validation AUC: 0.5198474578804779
Validation class accuracies: [0.9947643979057592, 0.34146341463414637]
2021-06-30 08:08:41.331979: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 5132
2021-06-30 08:08:51.243296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 5132
2021-06-30 08:09:01.376428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2017 of 5132
2021-06-30 08:09:11.337293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2577 of 5132
2021-06-30 08:09:21.261975: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3153 of 5132
2021-06-30 08:09:31.353421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3745 of 5132
2021-06-30 08:09:41.216708: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4321 of 5132
2021-06-30 08:09:51.205118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4850 of 5132
2021-06-30 08:09:58.523048: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 1 epochs
Epoch 16/65
321/321 - 204s - loss: 0.0071 - accuracy: 0.9918 - val_loss: 0.3245 - val_accuracy: 0.9479
Confusion matrix: 
 [[561  12]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.76
Validation accuracy: 94.79
Validation recall: 51.22
Validation precision: 63.64
Validation AUC: 0.591280391099009
Validation class accuracies: [0.9790575916230366, 0.5121951219512195]
2021-06-30 08:12:14.808725: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 5132
2021-06-30 08:12:24.948486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 5132
2021-06-30 08:12:34.995001: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 5132
2021-06-30 08:12:44.845466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2305 of 5132
2021-06-30 08:12:54.924898: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 5132
2021-06-30 08:13:04.885332: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 5132
2021-06-30 08:13:14.932723: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4065 of 5132
2021-06-30 08:13:24.754272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4641 of 5132
2021-06-30 08:13:34.741602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5031 of 5132
2021-06-30 08:13:38.043390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 2 epochs
Epoch 17/65
321/321 - 212s - loss: 0.0087 - accuracy: 0.9922 - val_loss: 0.3381 - val_accuracy: 0.9495
Confusion matrix: 
 [[567   6]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99 0.01]
 [0.61 0.39]]
Validation f1: 50.79
Validation accuracy: 94.95
Validation recall: 39.02
Validation precision: 72.73
Validation AUC: 0.577630976370997
Validation class accuracies: [0.9895287958115183, 0.3902439024390244]
2021-06-30 08:15:57.714366: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 08:16:07.747306: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 5132
2021-06-30 08:16:17.781530: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 5132
2021-06-30 08:16:27.642944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 5132
2021-06-30 08:16:37.745042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 5132
2021-06-30 08:16:47.968732: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3409 of 5132
2021-06-30 08:16:57.762169: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4017 of 5132
2021-06-30 08:17:07.715960: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4733 of 5132
2021-06-30 08:17:15.027683: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5797101449275363 hasn't increased by 0 in 3 epochs
Epoch 18/65
321/321 - 206s - loss: 0.0074 - accuracy: 0.9922 - val_loss: 0.2818 - val_accuracy: 0.9463
Confusion matrix: 
 [[557  16]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.415 0.585]]
Validation f1: 59.26
Validation accuracy: 94.63
Validation recall: 58.54
Validation precision: 60.00
Validation AUC: 0.6365630692517913
Validation class accuracies: [0.9720767888307156, 0.5853658536585366]
2021-06-30 08:19:34.676806: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 08:19:44.723839: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 5132
2021-06-30 08:19:54.545439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 5132
2021-06-30 08:20:04.731680: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 5132
2021-06-30 08:20:14.741513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 5132
2021-06-30 08:20:24.629261: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3713 of 5132
2021-06-30 08:20:34.706503: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4449 of 5132
2021-06-30 08:20:44.551623: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5057 of 5132
2021-06-30 08:20:45.903546: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 19/65
321/321 - 200s - loss: 0.0069 - accuracy: 0.9916 - val_loss: 0.4500 - val_accuracy: 0.9479
Confusion matrix: 
 [[573   0]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.   0.  ]
 [0.78 0.22]]
Validation f1: 36.00
Validation accuracy: 94.79
Validation recall: 21.95
Validation precision: 100.00
Validation AUC: 0.576924612540523
Validation class accuracies: [1.0, 0.21951219512195122]
2021-06-30 08:23:07.873373: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 5132
2021-06-30 08:23:17.863697: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 5132
2021-06-30 08:23:27.938899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 5132
2021-06-30 08:23:37.821421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 5132
2021-06-30 08:23:47.857984: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3601 of 5132
2021-06-30 08:23:57.812161: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4305 of 5132
2021-06-30 08:24:07.780458: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4959 of 5132
2021-06-30 08:24:10.905360: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 1 epochs
Epoch 20/65
321/321 - 190s - loss: 0.0077 - accuracy: 0.9920 - val_loss: 0.4132 - val_accuracy: 0.9072
Confusion matrix: 
 [[529  44]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.317 0.683]]
Validation f1: 49.56
Validation accuracy: 90.72
Validation recall: 68.29
Validation precision: 38.89
Validation AUC: 0.5918798608873075
Validation class accuracies: [0.9232111692844677, 0.6829268292682927]
2021-06-30 08:26:26.650911: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 5132
2021-06-30 08:26:36.639483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 5132
2021-06-30 08:26:46.697402: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 5132
2021-06-30 08:26:56.669133: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 5132
2021-06-30 08:27:06.794887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3553 of 5132
2021-06-30 08:27:16.774576: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4273 of 5132
2021-06-30 08:27:26.617677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4859 of 5132
2021-06-30 08:27:33.571534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 2 epochs
Epoch 21/65
321/321 - 194s - loss: 0.0069 - accuracy: 0.9922 - val_loss: 0.3378 - val_accuracy: 0.9430
Confusion matrix: 
 [[559  14]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.512 0.488]]
Validation f1: 53.33
Validation accuracy: 94.30
Validation recall: 48.78
Validation precision: 58.82
Validation AUC: 0.5729748253271842
Validation class accuracies: [0.9755671902268761, 0.4878048780487805]
2021-06-30 08:29:49.387205: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 5132
2021-06-30 08:29:59.317024: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 5132
2021-06-30 08:30:09.356759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2145 of 5132
2021-06-30 08:30:19.530395: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 5132
2021-06-30 08:30:29.493094: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3441 of 5132
2021-06-30 08:30:39.411833: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4001 of 5132
2021-06-30 08:30:49.505543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4593 of 5132
2021-06-30 08:30:59.291113: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5024 of 5132
2021-06-30 08:31:01.953543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 3 epochs
Epoch 22/65
321/321 - 199s - loss: 0.0052 - accuracy: 0.9922 - val_loss: 0.3570 - val_accuracy: 0.9349
Confusion matrix: 
 [[550  23]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.415 0.585]]
Validation f1: 54.55
Validation accuracy: 93.49
Validation recall: 58.54
Validation precision: 51.06
Validation AUC: 0.5893292608969999
Validation class accuracies: [0.9598603839441536, 0.5853658536585366]
2021-06-30 08:33:17.247773: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 5132
2021-06-30 08:33:27.232632: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1345 of 5132
2021-06-30 08:33:37.287319: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 5132
2021-06-30 08:33:47.304123: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2497 of 5132
2021-06-30 08:33:57.420322: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3089 of 5132
2021-06-30 08:34:07.309230: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3665 of 5132
2021-06-30 08:34:17.360338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4257 of 5132
2021-06-30 08:34:27.237518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4803 of 5132
2021-06-30 08:34:35.676622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 4 epochs
Epoch 23/65
321/321 - 206s - loss: 0.0058 - accuracy: 0.9922 - val_loss: 0.3676 - val_accuracy: 0.9528
Confusion matrix: 
 [[567   6]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.561 0.439]]
Validation f1: 55.38
Validation accuracy: 95.28
Validation recall: 43.90
Validation precision: 75.00
Validation AUC: 0.6115052480504996
Validation class accuracies: [0.9895287958115183, 0.43902439024390244]
2021-06-30 08:36:54.987756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 5132
2021-06-30 08:37:04.929465: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 5132
2021-06-30 08:37:14.963269: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 5132
2021-06-30 08:37:24.850156: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2305 of 5132
2021-06-30 08:37:34.988234: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 5132
2021-06-30 08:37:45.067045: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 5132
2021-06-30 08:37:54.823444: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4065 of 5132
2021-06-30 08:38:04.877296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4593 of 5132
2021-06-30 08:38:14.827490: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5010 of 5132
2021-06-30 08:38:17.046059: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 5 epochs
Epoch 24/65
321/321 - 210s - loss: 0.0063 - accuracy: 0.9922 - val_loss: 0.4767 - val_accuracy: 0.9397
Confusion matrix: 
 [[573   0]
 [ 37   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.902 0.098]]
Validation f1: 17.78
Validation accuracy: 93.97
Validation recall: 9.76
Validation precision: 100.00
Validation AUC: 0.5818395083162015
Validation class accuracies: [1.0, 0.0975609756097561]
2021-06-30 08:40:36.561845: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 08:40:46.665483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 5132
2021-06-30 08:40:56.669302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 5132
2021-06-30 08:41:06.678136: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 5132
2021-06-30 08:41:16.725245: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2833 of 5132
2021-06-30 08:41:26.596570: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3425 of 5132
2021-06-30 08:41:36.532615: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4145 of 5132
2021-06-30 08:41:46.464049: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4838 of 5132
2021-06-30 08:41:51.824860: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 25/65
321/321 - 204s - loss: 0.0060 - accuracy: 0.9922 - val_loss: 0.3319 - val_accuracy: 0.9267
Confusion matrix: 
 [[543  30]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.366 0.634]]
Validation f1: 53.61
Validation accuracy: 92.67
Validation recall: 63.41
Validation precision: 46.43
Validation AUC: 0.6219634795127843
Validation class accuracies: [0.9476439790575916, 0.6341463414634146]
2021-06-30 08:44:12.366282: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 5132
2021-06-30 08:44:22.281444: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 5132
2021-06-30 08:44:32.390280: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 5132
2021-06-30 08:44:42.451518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 5132
2021-06-30 08:44:52.375688: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3153 of 5132
2021-06-30 08:45:02.414602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3873 of 5132
2021-06-30 08:45:12.204661: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4577 of 5132
2021-06-30 08:45:21.709618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 7 epochs
Epoch 26/65
321/321 - 200s - loss: 0.0054 - accuracy: 0.9922 - val_loss: 0.3029 - val_accuracy: 0.9446
Confusion matrix: 
 [[557  16]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.439 0.561]]
Validation f1: 57.50
Validation accuracy: 94.46
Validation recall: 56.10
Validation precision: 58.97
Validation AUC: 0.6319332622924135
Validation class accuracies: [0.9720767888307156, 0.5609756097560976]
2021-06-30 08:47:41.487287: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 5132
2021-06-30 08:47:51.363517: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 5132
2021-06-30 08:48:01.405016: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 5132
2021-06-30 08:48:11.568497: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 5132
2021-06-30 08:48:21.467589: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3585 of 5132
2021-06-30 08:48:31.470061: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4305 of 5132
2021-06-30 08:48:41.335577: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4946 of 5132
2021-06-30 08:48:44.722234: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 8 epochs
Epoch 27/65
321/321 - 191s - loss: 0.0051 - accuracy: 0.9920 - val_loss: 0.3849 - val_accuracy: 0.9104
Confusion matrix: 
 [[532  41]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.341 0.659]]
Validation f1: 49.54
Validation accuracy: 91.04
Validation recall: 65.85
Validation precision: 39.71
Validation AUC: 0.5874861116224278
Validation class accuracies: [0.9284467713787086, 0.6585365853658537]
2021-06-30 08:51:02.292251: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 5132
2021-06-30 08:51:12.168186: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1377 of 5132
2021-06-30 08:51:22.170056: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 5132
2021-06-30 08:51:32.118310: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2737 of 5132
2021-06-30 08:51:42.129758: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3409 of 5132
2021-06-30 08:51:52.220639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3985 of 5132
2021-06-30 08:52:02.170953: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4497 of 5132
2021-06-30 08:52:12.077651: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4938 of 5132
2021-06-30 08:52:17.374317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 9 epochs
Epoch 28/65
321/321 - 204s - loss: 0.0062 - accuracy: 0.9920 - val_loss: 0.3705 - val_accuracy: 0.9495
Confusion matrix: 
 [[564   9]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.537 0.463]]
Validation f1: 55.07
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.95
Validation recall: 46.34
Validation precision: 67.86
Validation AUC: 0.5915603132792404
Validation class accuracies: [0.9842931937172775, 0.4634146341463415]
2021-06-30 08:54:36.234718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 5132
2021-06-30 08:54:46.233976: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 5132
2021-06-30 08:54:56.393540: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 5132
2021-06-30 08:55:06.285760: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2481 of 5132
2021-06-30 08:55:16.248557: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 5132
2021-06-30 08:55:26.165910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3521 of 5132
2021-06-30 08:55:36.378220: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4065 of 5132
2021-06-30 08:55:46.203039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4577 of 5132
2021-06-30 08:55:56.204040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4987 of 5132
2021-06-30 08:56:00.126781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 10 epochs
Epoch 29/65
321/321 - 212s - loss: 0.0054 - accuracy: 0.9922 - val_loss: 0.3138 - val_accuracy: 0.9495
Confusion matrix: 
 [[562  11]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.53
Validation accuracy: 94.95
Validation recall: 51.22
Validation precision: 65.62
Validation AUC: 0.6237557317655333
Validation class accuracies: [0.9808027923211169, 0.5121951219512195]
2021-06-30 08:58:18.304747: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 5132
2021-06-30 08:58:28.140919: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 5132
2021-06-30 08:58:38.197861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 5132
2021-06-30 08:58:48.155358: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 5132
2021-06-30 08:58:58.269583: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2641 of 5132
2021-06-30 08:59:08.169162: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3153 of 5132
2021-06-30 08:59:18.137998: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3665 of 5132
2021-06-30 08:59:28.330196: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4193 of 5132
2021-06-30 08:59:38.248007: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4705 of 5132
2021-06-30 08:59:48.136851: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5059 of 5132
2021-06-30 08:59:50.254752: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 11 epochs
Epoch 30/65
321/321 - 224s - loss: 0.0045 - accuracy: 0.9922 - val_loss: 0.3359 - val_accuracy: 0.9511
Confusion matrix: 
 [[563  10]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.33
Validation accuracy: 95.11
Validation recall: 51.22
Validation precision: 67.74
Validation AUC: 0.6231493191583983
Validation class accuracies: [0.9825479930191972, 0.5121951219512195]
2021-06-30 09:02:14.521586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 5132
2021-06-30 09:02:24.372542: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1057 of 5132
2021-06-30 09:02:34.415428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 5132
2021-06-30 09:02:44.446237: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 5132
2021-06-30 09:02:54.482388: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2641 of 5132
2021-06-30 09:03:04.466144: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3153 of 5132
2021-06-30 09:03:14.623675: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3697 of 5132
2021-06-30 09:03:24.484474: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4081 of 5132
2021-06-30 09:03:34.348213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4657 of 5132
2021-06-30 09:03:43.763771: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 31/65
321/321 - 220s - loss: 0.0050 - accuracy: 0.9922 - val_loss: 0.3127 - val_accuracy: 0.9397
Confusion matrix: 
 [[554  19]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.439 0.561]]
Validation f1: 55.42
Validation accuracy: 93.97
Validation recall: 56.10
Validation precision: 54.76
Validation AUC: 0.6215194290636711
Validation class accuracies: [0.9668411867364747, 0.5609756097560976]
2021-06-30 09:06:06.787916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 5132
2021-06-30 09:06:16.803004: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1057 of 5132
2021-06-30 09:06:26.700170: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 5132
2021-06-30 09:06:36.941400: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2065 of 5132
2021-06-30 09:06:46.565688: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2513 of 5132
2021-06-30 09:06:56.726310: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3169 of 5132
2021-06-30 09:07:06.744218: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3825 of 5132
2021-06-30 09:07:16.557098: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4465 of 5132
2021-06-30 09:07:26.540858: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5024 of 5132
2021-06-30 09:07:28.618153: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 13 epochs
Epoch 32/65
321/321 - 211s - loss: 0.0046 - accuracy: 0.9922 - val_loss: 0.3061 - val_accuracy: 0.9414
Confusion matrix: 
 [[556  17]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.463 0.537]]
Validation f1: 55.00
Validation accuracy: 94.14
Validation recall: 53.66
Validation precision: 56.41
Validation AUC: 0.627237318317792
Validation class accuracies: [0.9703315881326352, 0.5365853658536586]
2021-06-30 09:09:49.467948: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 417 of 5132
2021-06-30 09:09:59.697537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1025 of 5132
2021-06-30 09:10:09.653153: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 5132
2021-06-30 09:10:19.657068: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 5132
2021-06-30 09:10:29.564088: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3057 of 5132
2021-06-30 09:10:39.503776: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3729 of 5132
2021-06-30 09:10:49.518727: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4417 of 5132
2021-06-30 09:10:59.447426: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5013 of 5132
2021-06-30 09:11:01.714395: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 14 epochs
Epoch 33/65
321/321 - 199s - loss: 0.0050 - accuracy: 0.9922 - val_loss: 0.3181 - val_accuracy: 0.9414
Confusion matrix: 
 [[555  18]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.439 0.561]]
Validation f1: 56.10
Validation accuracy: 94.14
Validation recall: 56.10
Validation precision: 56.10
Validation AUC: 0.6086980800014001
Validation class accuracies: [0.9685863874345549, 0.5609756097560976]
2021-06-30 09:13:17.927513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 5132
2021-06-30 09:13:27.875238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1361 of 5132
2021-06-30 09:13:37.912541: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 5132
2021-06-30 09:13:47.958952: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2753 of 5132
2021-06-30 09:13:57.911081: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3441 of 5132
2021-06-30 09:14:07.879056: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4129 of 5132
2021-06-30 09:14:17.745362: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4803 of 5132
2021-06-30 09:14:24.127701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 15 epochs
Epoch 34/65
321/321 - 193s - loss: 0.0046 - accuracy: 0.9922 - val_loss: 0.3139 - val_accuracy: 0.9446
Confusion matrix: 
 [[558  15]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.463 0.537]]
Validation f1: 56.41
Validation accuracy: 94.46
Validation recall: 53.66
Validation precision: 59.46
Validation AUC: 0.6104013854887539
Validation class accuracies: [0.9738219895287958, 0.5365853658536586]
2021-06-30 09:16:40.435941: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 5132
2021-06-30 09:16:50.402412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 5132
2021-06-30 09:17:00.471716: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1873 of 5132
2021-06-30 09:17:10.376772: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 5132
2021-06-30 09:17:20.301102: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 5132
2021-06-30 09:17:30.550538: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3569 of 5132
2021-06-30 09:17:40.293678: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4129 of 5132
2021-06-30 09:17:50.457921: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4577 of 5132
2021-06-30 09:18:00.273592: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4990 of 5132
2021-06-30 09:18:03.961132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 16 epochs
Epoch 35/65
321/321 - 210s - loss: 0.0044 - accuracy: 0.9922 - val_loss: 0.3037 - val_accuracy: 0.9479
Confusion matrix: 
 [[562  11]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.512 0.488]]
Validation f1: 55.56
Validation accuracy: 94.79
Validation recall: 48.78
Validation precision: 64.52
Validation AUC: 0.61757019204574
Validation class accuracies: [0.9808027923211169, 0.4878048780487805]
2021-06-30 09:20:20.799832: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 5132
2021-06-30 09:20:30.988624: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1057 of 5132
2021-06-30 09:20:40.802073: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 5132
2021-06-30 09:20:50.846704: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 5132
2021-06-30 09:21:00.822677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2721 of 5132
2021-06-30 09:21:10.820255: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3281 of 5132
2021-06-30 09:21:20.984298: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3857 of 5132
2021-06-30 09:21:30.845526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4337 of 5132
2021-06-30 09:21:40.807993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4850 of 5132
2021-06-30 09:21:46.086500: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 17 epochs
Epoch 36/65
321/321 - 214s - loss: 0.0043 - accuracy: 0.9922 - val_loss: 0.2981 - val_accuracy: 0.9495
Confusion matrix: 
 [[562  11]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.53
Validation accuracy: 94.95
Validation recall: 51.22
Validation precision: 65.62
Validation AUC: 0.6297711368008453
Validation class accuracies: [0.9808027923211169, 0.5121951219512195]
2021-06-30 09:24:06.828601: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 5132
2021-06-30 09:24:16.756351: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 5132
2021-06-30 09:24:26.860353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 5132
2021-06-30 09:24:36.912126: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2433 of 5132
2021-06-30 09:24:46.812989: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3137 of 5132
2021-06-30 09:24:56.825234: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3857 of 5132
2021-06-30 09:25:06.702206: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4561 of 5132
2021-06-30 09:25:16.618774: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 37/65
321/321 - 197s - loss: 0.0048 - accuracy: 0.9922 - val_loss: 0.2923 - val_accuracy: 0.9463
Confusion matrix: 
 [[559  14]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.463 0.537]]
Validation f1: 57.14
Validation accuracy: 94.63
Validation recall: 53.66
Validation precision: 61.11
Validation AUC: 0.6352848495500455
Validation class accuracies: [0.9755671902268761, 0.5365853658536586]
2021-06-30 09:27:33.328188: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 5132
2021-06-30 09:27:43.409909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 5132
2021-06-30 09:27:53.368256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 5132
2021-06-30 09:28:03.463910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2801 of 5132
2021-06-30 09:28:13.423345: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3361 of 5132
2021-06-30 09:28:23.372560: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3921 of 5132
2021-06-30 09:28:33.392489: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4497 of 5132
2021-06-30 09:28:43.397537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4959 of 5132
2021-06-30 09:28:47.792593: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5925925925925926 hasn't increased by 0 in 19 epochs
Epoch 38/65
321/321 - 202s - loss: 0.0043 - accuracy: 0.9922 - val_loss: 0.3181 - val_accuracy: 0.9528
Confusion matrix: 
 [[566   7]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.537 0.463]]
Validation f1: 56.72
Validation accuracy: 95.28
Validation recall: 46.34
Validation precision: 73.08
Validation AUC: 0.6279220087970702
Validation class accuracies: [0.987783595113438, 0.4634146341463415]

The metrics for job 3 with the best target metric are: 
Best cm: [[557  16]
 [ 17  24]]
Best normalized cm: [[0.972 0.028]
 [0.415 0.585]]
Best f1: 0.59
Best accuracy: 0.95
Best recall: 0.59
Best precision: 0.60
Best AUC: 0.64
Best class accuracies: [0.9720767888307156, 0.5853658536585366]
Best epoch: 18
The number of epochs since last 1% equals the patience
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_207_2b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[3.431e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_207_3b2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_223_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[0.025]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_211_1p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[2.517e-09]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_217_1b1_Tc_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_213_1p2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[1.039e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_205_2b4_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[3.086e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_219_2b1_Ar_mc_LittC2SE_1_label_1_pred_1.png, [[0.975]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_223_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_213_2p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_205_3b4_Al_mc_AKGC417L_0_label_0_pred_0.png, [[9.863e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_223_1b1_Ll_sc_Meditron_5_label_0_pred_0.png, [[9.212e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_207_2b4_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_204_7p5_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[1.192e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_204_7p5_Al_mc_AKGC417L_1_label_0_pred_0.png, [[5.59e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_213_2p2_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[2.252e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_213_1p5_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[4.735e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_218_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[8.032e-08]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_211_1p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[1.459e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[4.387e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_219_2b3_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[0.989]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_221_2b2_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_223_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_218_1b1_Ar_sc_Meditron_13_label_0_pred_0.png, [[0.05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_207_2b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[6.886e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_207_2b4_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[1.248e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[2.376e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_210_1b1_Al_sc_Meditron_2_label_0_pred_0.png, [[6.644e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_222_1b1_Ar_sc_Meditron_13_label_0_pred_0.png, [[8.508e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_203_2p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_222_1b1_Pr_sc_Meditron_4_label_0_pred_0.png, [[6.843e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_205_3b4_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[5.201e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_218_1p1_Pr_sc_Litt3200_2_label_0_pred_0.png, [[0.16]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_0_label_1_pred_1.png, [[0.996]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_218_1b1_Ar_sc_Meditron_6_label_0_pred_0.png, [[3.208e-08]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_213_2p2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[3.125e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_207_3b2_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[5.294e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_222_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_213_1p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[8.451e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_218_1b1_Al_sc_Meditron_0_label_0_pred_0.png, [[1.43e-08]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_204_2b5_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_205_1b3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_216_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_207_2b4_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[6.528e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/3/icbhi_221_2b3_Lr_mc_LittC2SE_3_label_0_pred_0.png, [[0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 3094
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_071406-23xt4pie/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_071406-23xt4pie/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99221
wandb:         val_accuracy 0.95277
wandb:             _runtime 8209
wandb:           _timestamp 1625045456
wandb:                _step 280
wandb:           train_loss 0.00432
wandb:             val_loss 0.31809
wandb:           val_recall 0.46341
wandb:        val_precision 0.73077
wandb:               val_f1 0.56716
wandb:              val_auc 0.62792
wandb:                   lr 0.00013
wandb:          best_val_f1 0.59259
wandb:    best_val_accuracy 0.94625
wandb:   best_val_precision 0.6
wandb:      best_val_recall 0.58537
wandb:             best_auc 0.63656
wandb:           best_epoch 18
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_071406-23xt4pie

-----------------------
Model 9 with new params
Changing augmentation to frequency masking
Audio Augmentation Parameters: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43,v48'}
Spec Augmentation Parameters: {'ADD': 1, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-30 09:37:11.992863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 433 of 3616
2021-06-30 09:37:22.096717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 3616
2021-06-30 09:37:32.078419: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3616
2021-06-30 09:37:41.928326: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2545 of 3616
2021-06-30 09:37:51.944254: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3253 of 3616
2021-06-30 09:37:58.664449: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_20
Length of training samples after spec augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_21
Length of training samples after spec augmentation: 3216
-----------------------
Number of train recordings: 3216 with pneumonia: 316 and non-pneumonia: 2900
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3616
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_4 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_15 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_16 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_17 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_18 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_19 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_3 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
226/226 - 144s - loss: 0.2899 - accuracy: 0.8977 - val_loss: 0.2513 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08712159796149647
Validation class accuracies: [1.0, 0.0]
2021-06-30 09:39:47.180510: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 401 of 3616
2021-06-30 09:39:56.996808: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 3616
2021-06-30 09:40:06.991583: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 3616
2021-06-30 09:40:16.979728: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2561 of 3616
2021-06-30 09:40:26.989610: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3255 of 3616
2021-06-30 09:40:33.643969: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
226/226 - 144s - loss: 0.1144 - accuracy: 0.9511 - val_loss: 0.4487 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.187999844334795
Validation class accuracies: [1.0, 0.0]
2021-06-30 09:42:22.627158: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 417 of 3616
2021-06-30 09:42:32.587021: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 3616
2021-06-30 09:42:42.589907: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 3616
2021-06-30 09:42:52.519771: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2545 of 3616
2021-06-30 09:43:02.530970: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3257 of 3616
2021-06-30 09:43:09.223685: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
226/226 - 144s - loss: 0.0648 - accuracy: 0.9721 - val_loss: 0.3812 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6429503155225423
Validation class accuracies: [1.0, 0.0]
2021-06-30 09:44:57.995488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 449 of 3616
2021-06-30 09:45:07.997638: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1089 of 3616
2021-06-30 09:45:17.938788: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1809 of 3616
2021-06-30 09:45:27.924504: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2529 of 3616
2021-06-30 09:45:37.832318: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3237 of 3616
2021-06-30 09:45:44.735572: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
226/226 - 144s - loss: 0.0423 - accuracy: 0.9790 - val_loss: 0.3178 - val_accuracy: 0.9121
Confusion matrix: 
 [[529  44]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.244 0.756]]
Validation f1: 53.45
Validation accuracy: 91.21
Validation recall: 75.61
Validation precision: 41.33
Validation AUC: 0.6201178677463892
Validation class accuracies: [0.9232111692844677, 0.7560975609756098]
2021-06-30 09:47:33.801839: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3616
2021-06-30 09:47:43.730067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 3616
2021-06-30 09:47:53.722620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1793 of 3616
2021-06-30 09:48:03.597138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2513 of 3616
2021-06-30 09:48:13.533880: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3240 of 3616
2021-06-30 09:48:20.406387: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
226/226 - 144s - loss: 0.0280 - accuracy: 0.9820 - val_loss: 0.2384 - val_accuracy: 0.9414
Confusion matrix: 
 [[555  18]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.10
Validation accuracy: 94.14
Validation recall: 56.10
Validation precision: 56.10
Validation AUC: 0.5755401508400443
Validation class accuracies: [0.9685863874345549, 0.5609756097560976]
2021-06-30 09:50:09.036282: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 497 of 3616
2021-06-30 09:50:19.089916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1025 of 3616
2021-06-30 09:50:28.956156: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 3616
2021-06-30 09:50:39.077797: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2465 of 3616
2021-06-30 09:50:49.118039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3201 of 3616
2021-06-30 09:50:56.662128: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
226/226 - 144s - loss: 0.0232 - accuracy: 0.9837 - val_loss: 0.1408 - val_accuracy: 0.9528
Confusion matrix: 
 [[556  17]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.293 0.707]]
Validation f1: 66.67
Validation accuracy: 95.28
Validation recall: 70.73
Validation precision: 63.04
Validation AUC: 0.766785286113015
Validation class accuracies: [0.9703315881326352, 0.7073170731707317]
2021-06-30 09:52:44.651579: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 545 of 3616
2021-06-30 09:52:54.532326: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 3616
2021-06-30 09:53:04.619180: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 3616
2021-06-30 09:53:14.450737: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 3616
2021-06-30 09:53:24.417472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3137 of 3616
2021-06-30 09:53:33.180966: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 7/65
226/226 - 145s - loss: 0.0178 - accuracy: 0.9856 - val_loss: 0.3044 - val_accuracy: 0.9023
Confusion matrix: 
 [[526  47]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.317 0.683]]
Validation f1: 48.28
Validation accuracy: 90.23
Validation recall: 68.29
Validation precision: 37.33
Validation AUC: 0.6119776578470334
Validation class accuracies: [0.9179755671902269, 0.6829268292682927]
2021-06-30 09:55:21.330234: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3616
2021-06-30 09:55:30.950453: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 3616
2021-06-30 09:55:41.075831: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 3616
2021-06-30 09:55:50.970764: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3616
2021-06-30 09:56:01.059197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3137 of 3616
2021-06-30 09:56:09.480881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 1 epochs
Epoch 8/65
226/226 - 146s - loss: 0.0176 - accuracy: 0.9856 - val_loss: 0.1913 - val_accuracy: 0.9446
Confusion matrix: 
 [[551  22]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.293 0.707]]
Validation f1: 63.04
Validation accuracy: 94.46
Validation recall: 70.73
Validation precision: 56.86
Validation AUC: 0.6853035607595988
Validation class accuracies: [0.9616055846422339, 0.7073170731707317]
2021-06-30 09:57:58.301035: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 09:58:08.276577: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3616
2021-06-30 09:58:18.328217: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 3616
2021-06-30 09:58:28.145430: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3616
2021-06-30 09:58:38.354304: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3137 of 3616
2021-06-30 09:58:46.649199: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 2 epochs
Epoch 9/65
226/226 - 145s - loss: 0.0120 - accuracy: 0.9864 - val_loss: 0.2072 - val_accuracy: 0.9511
Confusion matrix: 
 [[556  17]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.317 0.683]]
Validation f1: 65.12
Validation accuracy: 95.11
Validation recall: 68.29
Validation precision: 62.22
Validation AUC: 0.7034582397357942
Validation class accuracies: [0.9703315881326352, 0.6829268292682927]
2021-06-30 10:00:34.758393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:00:44.511403: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1025 of 3616
2021-06-30 10:00:54.700680: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1665 of 3616
2021-06-30 10:01:04.604844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 3616
2021-06-30 10:01:14.583472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3089 of 3616
2021-06-30 10:01:23.631461: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 3 epochs
Epoch 10/65
226/226 - 146s - loss: 0.0119 - accuracy: 0.9867 - val_loss: 0.1709 - val_accuracy: 0.9609
Confusion matrix: 
 [[565   8]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.39  0.61 ]]
Validation f1: 67.57
Validation accuracy: 96.09
Validation recall: 60.98
Validation precision: 75.76
Validation AUC: 0.7074947058880017
Validation class accuracies: [0.9860383944153578, 0.6097560975609756]
2021-06-30 10:03:11.880580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:03:21.965444: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 3616
2021-06-30 10:03:31.645861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1633 of 3616
2021-06-30 10:03:41.786937: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2353 of 3616
2021-06-30 10:03:51.747249: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3073 of 3616
2021-06-30 10:04:01.044076: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 11/65
226/226 - 146s - loss: 0.0148 - accuracy: 0.9867 - val_loss: 0.2206 - val_accuracy: 0.9267
Confusion matrix: 
 [[540  33]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.293 0.707]]
Validation f1: 56.31
Validation accuracy: 92.67
Validation recall: 70.73
Validation precision: 46.77
Validation AUC: 0.7329096074524646
Validation class accuracies: [0.9424083769633508, 0.7073170731707317]
2021-06-30 10:05:49.409799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:05:59.176179: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 3616
2021-06-30 10:06:09.243930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 3616
2021-06-30 10:06:19.172139: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2338 of 3616
2021-06-30 10:06:29.200780: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3057 of 3616
2021-06-30 10:06:38.548703: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 1 epochs
Epoch 12/65
226/226 - 145s - loss: 0.0131 - accuracy: 0.9864 - val_loss: 0.2404 - val_accuracy: 0.9397
Confusion matrix: 
 [[549  24]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.317 0.683]]
Validation f1: 60.22
Validation accuracy: 93.97
Validation recall: 68.29
Validation precision: 53.85
Validation AUC: 0.6537827775276135
Validation class accuracies: [0.9581151832460733, 0.6829268292682927]
2021-06-30 10:08:25.842266: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:08:36.116537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 3616
2021-06-30 10:08:45.855690: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 3616
2021-06-30 10:08:55.890925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 3616
2021-06-30 10:09:05.811654: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3041 of 3616
2021-06-30 10:09:15.529471: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 2 epochs
Epoch 13/65
226/226 - 146s - loss: 0.0164 - accuracy: 0.9851 - val_loss: 0.2836 - val_accuracy: 0.9560
Confusion matrix: 
 [[573   0]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.659 0.341]]
Validation f1: 50.91
Validation accuracy: 95.60
Validation recall: 34.15
Validation precision: 100.00
Validation AUC: 0.6727931465914174
Validation class accuracies: [1.0, 0.34146341463414637]
2021-06-30 10:11:03.107986: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:11:13.282673: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 3616
2021-06-30 10:11:23.197954: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 3616
2021-06-30 10:11:33.216160: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 3616
2021-06-30 10:11:43.259717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3057 of 3616
2021-06-30 10:11:52.750865: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 3 epochs
Epoch 14/65
226/226 - 147s - loss: 0.0119 - accuracy: 0.9867 - val_loss: 0.2435 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.6811687295862906
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
2021-06-30 10:13:41.151871: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:13:51.045445: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 3616
2021-06-30 10:14:01.177316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 3616
2021-06-30 10:14:11.100274: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 3616
2021-06-30 10:14:21.101621: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3041 of 3616
2021-06-30 10:14:30.939506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 4 epochs
Epoch 15/65
226/226 - 146s - loss: 0.0104 - accuracy: 0.9864 - val_loss: 0.2445 - val_accuracy: 0.9300
Confusion matrix: 
 [[544  29]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.341 0.659]]
Validation f1: 55.67
Validation accuracy: 93.00
Validation recall: 65.85
Validation precision: 48.21
Validation AUC: 0.6394813056396301
Validation class accuracies: [0.9493891797556719, 0.6585365853658537]
2021-06-30 10:16:18.722275: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:16:28.811123: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 3616
2021-06-30 10:16:38.788866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 3616
2021-06-30 10:16:48.602967: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2305 of 3616
2021-06-30 10:16:58.595341: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3025 of 3616
2021-06-30 10:17:08.455200: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 5 epochs
Epoch 16/65
226/226 - 146s - loss: 0.0113 - accuracy: 0.9864 - val_loss: 0.2181 - val_accuracy: 0.9381
Confusion matrix: 
 [[553  20]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.76
Validation accuracy: 93.81
Validation recall: 56.10
Validation precision: 53.49
Validation AUC: 0.6252265982788119
Validation class accuracies: [0.9650959860383944, 0.5609756097560976]
2021-06-30 10:18:56.182458: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:19:06.374467: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 3616
2021-06-30 10:19:16.182578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 3616
2021-06-30 10:19:26.244438: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 3616
2021-06-30 10:19:36.134249: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 3616
2021-06-30 10:19:46.064004: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3605 of 3616
2021-06-30 10:19:46.235458: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
226/226 - 147s - loss: 0.0135 - accuracy: 0.9853 - val_loss: 0.1924 - val_accuracy: 0.9365
Confusion matrix: 
 [[548  25]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.06
Validation accuracy: 93.65
Validation recall: 65.85
Validation precision: 51.92
Validation AUC: 0.6939071505196223
Validation class accuracies: [0.956369982547993, 0.6585365853658537]
2021-06-30 10:21:34.713180: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:21:44.637453: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 3616
2021-06-30 10:21:54.657615: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 3616
2021-06-30 10:22:04.484442: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 3616
2021-06-30 10:22:14.543272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 3616
2021-06-30 10:22:24.478713: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3602 of 3616
2021-06-30 10:22:24.719434: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 7 epochs
Epoch 18/65
226/226 - 147s - loss: 0.0083 - accuracy: 0.9867 - val_loss: 0.2273 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.317 0.683]]
Validation f1: 62.92
Validation accuracy: 94.63
Validation recall: 68.29
Validation precision: 58.33
Validation AUC: 0.6898661485257855
Validation class accuracies: [0.9650959860383944, 0.6829268292682927]
2021-06-30 10:24:12.697475: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:24:22.637105: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 3616
2021-06-30 10:24:32.927639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 3616
2021-06-30 10:24:42.622003: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 3616
2021-06-30 10:24:52.869681: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 3616
2021-06-30 10:25:02.653249: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3599 of 3616
2021-06-30 10:25:02.935946: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 8 epochs
Epoch 19/65
226/226 - 147s - loss: 0.0086 - accuracy: 0.9867 - val_loss: 0.1932 - val_accuracy: 0.9593
Confusion matrix: 
 [[563  10]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.366 0.634]]
Validation f1: 67.53
Validation accuracy: 95.93
Validation recall: 63.41
Validation precision: 72.22
Validation AUC: 0.6949496159492559
Validation class accuracies: [0.9825479930191972, 0.6341463414634146]
2021-06-30 10:26:51.582492: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:27:01.590275: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 3616
2021-06-30 10:27:11.677513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 3616
2021-06-30 10:27:21.634018: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 3616
2021-06-30 10:27:31.539324: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-30 10:27:41.562431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3594 of 3616
2021-06-30 10:27:41.921015: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 9 epochs
Epoch 20/65
226/226 - 147s - loss: 0.0097 - accuracy: 0.9867 - val_loss: 0.2654 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.658095834098468
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
2021-06-30 10:29:30.436001: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:29:40.507038: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 3616
2021-06-30 10:29:50.343856: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 3616
2021-06-30 10:30:00.498419: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2305 of 3616
2021-06-30 10:30:10.304567: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 3616
2021-06-30 10:30:20.304820: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3610 of 3616
2021-06-30 10:30:20.394090: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 10 epochs
Epoch 21/65
226/226 - 147s - loss: 0.0085 - accuracy: 0.9867 - val_loss: 0.2081 - val_accuracy: 0.9463
Confusion matrix: 
 [[554  19]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.341 0.659]]
Validation f1: 62.07
Validation accuracy: 94.63
Validation recall: 65.85
Validation precision: 58.70
Validation AUC: 0.6789088140458674
Validation class accuracies: [0.9668411867364747, 0.6585365853658537]
2021-06-30 10:32:08.542423: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:32:18.520072: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 3616
2021-06-30 10:32:28.436046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 3616
2021-06-30 10:32:38.463507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 3616
2021-06-30 10:32:48.529983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3025 of 3616
2021-06-30 10:32:58.330787: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 11 epochs
Epoch 22/65
226/226 - 147s - loss: 0.0084 - accuracy: 0.9867 - val_loss: 0.2970 - val_accuracy: 0.9251
Confusion matrix: 
 [[540  33]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.317 0.683]]
Validation f1: 54.90
Validation accuracy: 92.51
Validation recall: 68.29
Validation precision: 45.90
Validation AUC: 0.6241477133435932
Validation class accuracies: [0.9424083769633508, 0.6829268292682927]
2021-06-30 10:34:46.867236: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:34:56.666858: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 3616
2021-06-30 10:35:07.022873: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1601 of 3616
2021-06-30 10:35:16.663046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 3616
2021-06-30 10:35:26.792941: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-30 10:35:36.673930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3593 of 3616
2021-06-30 10:35:37.063499: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
226/226 - 147s - loss: 0.0093 - accuracy: 0.9867 - val_loss: 0.2146 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6641394650472431
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
2021-06-30 10:37:25.095086: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3616
2021-06-30 10:37:34.910224: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 3616
2021-06-30 10:37:45.276452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 3616
2021-06-30 10:37:54.893595: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3616
2021-06-30 10:38:05.040742: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-30 10:38:14.946050: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3592 of 3616
2021-06-30 10:38:15.307949: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 13 epochs
Epoch 24/65
226/226 - 148s - loss: 0.0102 - accuracy: 0.9859 - val_loss: 0.2121 - val_accuracy: 0.9446
Confusion matrix: 
 [[553  20]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.341 0.659]]
Validation f1: 61.36
Validation accuracy: 94.46
Validation recall: 65.85
Validation precision: 57.45
Validation AUC: 0.6883680393503288
Validation class accuracies: [0.9650959860383944, 0.6585365853658537]
2021-06-30 10:40:04.541111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3616
2021-06-30 10:40:14.689566: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 3616
2021-06-30 10:40:24.736491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1585 of 3616
2021-06-30 10:40:34.727422: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3616
2021-06-30 10:40:44.726699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2961 of 3616
2021-06-30 10:40:54.578419: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3562 of 3616
2021-06-30 10:40:55.540751: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 14 epochs
Epoch 25/65
226/226 - 146s - loss: 0.0076 - accuracy: 0.9867 - val_loss: 0.2292 - val_accuracy: 0.9430
Confusion matrix: 
 [[552  21]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.341 0.659]]
Validation f1: 60.67
Validation accuracy: 94.30
Validation recall: 65.85
Validation precision: 56.25
Validation AUC: 0.6754222677594995
Validation class accuracies: [0.9633507853403142, 0.6585365853658537]
2021-06-30 10:42:40.183331: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 693 of 3616
2021-06-30 10:42:50.393892: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3616
2021-06-30 10:43:00.369212: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 3616
2021-06-30 10:43:10.284302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2913 of 3616
2021-06-30 10:43:20.196040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3566 of 3616
2021-06-30 10:43:21.057988: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 15 epochs
Epoch 26/65
226/226 - 136s - loss: 0.0083 - accuracy: 0.9867 - val_loss: 0.2298 - val_accuracy: 0.9300
Confusion matrix: 
 [[544  29]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.67
Validation accuracy: 93.00
Validation recall: 65.85
Validation precision: 48.21
Validation AUC: 0.6756042855120404
Validation class accuracies: [0.9493891797556719, 0.6585365853658537]
2021-06-30 10:45:04.598630: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-30 10:45:14.496403: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 3616
2021-06-30 10:45:24.516100: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3616
2021-06-30 10:45:34.595857: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2977 of 3616
2021-06-30 10:45:44.412682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 16 epochs
Epoch 27/65
226/226 - 135s - loss: 0.0090 - accuracy: 0.9867 - val_loss: 0.2133 - val_accuracy: 0.9463
Confusion matrix: 
 [[554  19]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.07
Validation accuracy: 94.63
Validation recall: 65.85
Validation precision: 58.70
Validation AUC: 0.6897496786419492
Validation class accuracies: [0.9668411867364747, 0.6585365853658537]
2021-06-30 10:47:27.742287: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-30 10:47:37.888851: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3616
2021-06-30 10:47:47.695454: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3616
2021-06-30 10:47:57.725610: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 3616
2021-06-30 10:48:07.218006: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 17 epochs
Epoch 28/65
226/226 - 134s - loss: 0.0077 - accuracy: 0.9867 - val_loss: 0.2119 - val_accuracy: 0.9349
Confusion matrix: 
 [[547  26]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.341 0.659]]
Validation f1: 57.45
Validation accuracy: 93.49
Validation recall: 65.85
Validation precision: 50.94
Validation AUC: 0.6846083078840113
Validation class accuracies: [0.9546247818499127, 0.6585365853658537]
2021-06-30 10:49:50.898819: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3616
2021-06-30 10:50:00.941186: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3616
2021-06-30 10:50:10.864842: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3616
2021-06-30 10:50:20.978449: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3009 of 3616
2021-06-30 10:50:30.407219: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 29/65
226/226 - 135s - loss: 0.0082 - accuracy: 0.9867 - val_loss: 0.2065 - val_accuracy: 0.9414
Confusion matrix: 
 [[551  22]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.341 0.659]]
Validation f1: 60.00
Validation accuracy: 94.14
Validation recall: 65.85
Validation precision: 55.10
Validation AUC: 0.6925866610453711
Validation class accuracies: [0.9616055846422339, 0.6585365853658537]
2021-06-30 10:52:14.187428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 3616
2021-06-30 10:52:24.235825: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3616
2021-06-30 10:52:34.194740: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 3616
2021-06-30 10:52:44.121616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2993 of 3616
2021-06-30 10:52:53.648066: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6756756756756757 hasn't increased by 0 in 19 epochs
Epoch 30/65
226/226 - 135s - loss: 0.0082 - accuracy: 0.9867 - val_loss: 0.2111 - val_accuracy: 0.9430
Confusion matrix: 
 [[551  22]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.317 0.683]]
Validation f1: 61.54
Validation accuracy: 94.30
Validation recall: 68.29
Validation precision: 56.00
Validation AUC: 0.6886539951252608
Validation class accuracies: [0.9616055846422339, 0.6829268292682927]

The metrics for job 4 with the best target metric are: 
Best cm: [[565   8]
 [ 16  25]]
Best normalized cm: [[0.986 0.014]
 [0.39  0.61 ]]
Best f1: 0.68
Best accuracy: 0.96
Best recall: 0.61
Best precision: 0.76
Best AUC: 0.71
Best class accuracies: [0.9860383944153578, 0.6097560975609756]
Best epoch: 10
The number of epochs since last 1% equals the patience
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_213_2p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.761e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_222_1b1_Pr_sc_Meditron_10_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/jordan_EP36_pneumonia,Crep,P R M,36,F_4_label_1_pred_1.png, [[0.997]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_207_2b2_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_222_1b1_Ar_sc_Meditron_6_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_213_1p2_Lr_mc_AKGC417L_3_label_0_pred_0.png, [[8.745e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_205_1b3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[4.181e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_205_3b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_207_3b2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[1.817e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_218_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[8.877e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_212_2b2_Tc_mc_LittC2SE_1_label_0_pred_1.png, [[0.841]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_212_2b2_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.387]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_204_7p5_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[1.271e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_203_2p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_205_4b2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_205_2b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_221_2b3_Pr_mc_LittC2SE_0_label_0_pred_0.png, [[0.053]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_207_3b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_218_1p1_Pr_sc_Litt3200_2_label_0_pred_0.png, [[0.171]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_207_2b3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[8.318e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_207_3b2_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[4.01e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_213_1p5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.505e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_213_2p2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_226_1b1_Pl_sc_LittC2SE_3_label_1_pred_0.png, [[0.094]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_218_1b1_Ar_sc_Meditron_10_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_226_1b1_Al_sc_Meditron_0_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[1.695e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_218_1p1_Pr_sc_Litt3200_3_label_0_pred_0.png, [[0.058]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_205_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_207_2b2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[7.64e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_211_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[2.651e-06]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_207_2b4_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[2.387e-05]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_223_1b1_Ll_sc_Meditron_2_label_0_pred_0.png, [[8.845e-07]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_221_2b2_Ar_mc_LittC2SE_2_label_0_pred_1.png, [[0.995]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_204_2b5_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_222_1b1_Lr_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2276__06_0341__v39__mixup/4/icbhi_203_2p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[2.298e-06]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 17464
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_093138-e877i0rj/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_093138-e877i0rj/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98673
wandb:         val_accuracy 0.943
wandb:             _runtime 4968
wandb:           _timestamp 1625050467
wandb:                _step 221
wandb:           train_loss 0.0082
wandb:             val_loss 0.21108
wandb:           val_recall 0.68293
wandb:        val_precision 0.56
wandb:               val_f1 0.61538
wandb:              val_auc 0.68865
wandb:                   lr 0.00013
wandb:          best_val_f1 0.67568
wandb:    best_val_accuracy 0.96091
wandb:   best_val_precision 0.75758
wandb:      best_val_recall 0.60976
wandb:             best_auc 0.70749
wandb:           best_epoch 10
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210630_093138-e877i0rj

-----------------------

 See logs at ../../new_cache/conv__2276__06_0341__v39__mixup/logs/