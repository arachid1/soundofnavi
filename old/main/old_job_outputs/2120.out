Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2120
Description:  mod9_redogoodone
2021-05-10 15:19:21.082404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 15:19:23.395267: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 15:19:23.396334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-10 15:19:23.436543: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:23.437281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 15:19:23.437311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 15:19:23.441221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 15:19:23.441305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 15:19:23.442482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 15:19:23.442790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 15:19:23.443857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 15:19:23.444819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 15:19:23.444980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 15:19:23.445095: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:23.445939: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:23.446710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2120.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 5.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2120
wandb: ‚≠êÔ∏è View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: üöÄ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/315iffu7
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_151923-315iffu7
wandb: Run `wandb offline` to turn off syncing.
2021-05-10 15:19:28.659445: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 15:19:28.659693: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:28.660489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 15:19:28.660539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 15:19:28.660604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 15:19:28.660638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 15:19:28.660668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 15:19:28.660697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 15:19:28.660727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 15:19:28.660762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 15:19:28.660792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 15:19:28.660908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:28.661709: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:28.662489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-10 15:19:28.662546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 15:19:29.401640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-10 15:19:29.401683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-10 15:19:29.401692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-10 15:19:29.401972: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:29.402839: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:29.403561: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 15:19:29.404246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-10 15:20:06.407962: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-10 15:20:06.410101: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-10 15:20:09.384919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 15:20:10.060985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 15:20:10.070745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/40
263/263 - 525s - loss: 0.7247 - accuracy: 0.5484 - val_loss: 0.6357 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22436224824347467
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
263/263 - 515s - loss: 0.6859 - accuracy: 0.5853 - val_loss: 0.6413 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1755390865228437
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0.05 in 1 epochs
Epoch 3/40
263/263 - 515s - loss: 0.6804 - accuracy: 0.5968 - val_loss: 0.6439 - val_accuracy: 0.7950
Confusion matrix: 
 [[862   8]
 [215   3]]
Validation f1: 2.62
Validation accuracy: 79.50
Validation recall: 1.38
Validation precision: 27.27
Validation AUC: 0.18588584554380547
Validation class accuracies: [0.9908045977011494, 0.013761467889908258]
The validation tracker metric at 0 hasn't increased by 0.05 in 2 epochs
Saving model...
Epoch 4/40
263/263 - 516s - loss: 0.6765 - accuracy: 0.6025 - val_loss: 0.6686 - val_accuracy: 0.7151
Confusion matrix: 
 [[750 120]
 [190  28]]
Validation f1: 15.30
Validation accuracy: 71.51
Validation recall: 12.84
Validation precision: 18.92
Validation AUC: 0.20272710268325397
Validation class accuracies: [0.8620689655172413, 0.12844036697247707]
Saving model...
Epoch 5/40
263/263 - 516s - loss: 0.6703 - accuracy: 0.6304 - val_loss: 0.6531 - val_accuracy: 0.7592
Confusion matrix: 
 [[799  71]
 [191  27]]
Validation f1: 17.09
Validation accuracy: 75.92
Validation recall: 12.39
Validation precision: 27.55
Validation AUC: 0.23558887216365368
Validation class accuracies: [0.9183908045977012, 0.12385321100917432]
The validation tracker metric at 0.15300546448087432 hasn't increased by 0.05 in 1 epochs
Saving model...
Epoch 6/40
263/263 - 514s - loss: 0.6676 - accuracy: 0.6428 - val_loss: 0.6938 - val_accuracy: 0.5460
Confusion matrix: 
 [[492 378]
 [116 102]]
Validation f1: 29.23
Validation accuracy: 54.60
Validation recall: 46.79
Validation precision: 21.25
Validation AUC: 0.2276402217153731
Validation class accuracies: [0.5655172413793104, 0.46788990825688076]
Saving model...
Epoch 7/40
263/263 - 516s - loss: 0.6644 - accuracy: 0.6501 - val_loss: 0.6424 - val_accuracy: 0.7711
Confusion matrix: 
 [[830  40]
 [209   9]]
Validation f1: 6.74
Validation accuracy: 77.11
Validation recall: 4.13
Validation precision: 18.37
Validation AUC: 0.21154055584185436
Validation class accuracies: [0.9540229885057471, 0.04128440366972477]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 1 epochs
Epoch 8/40
263/263 - 516s - loss: 0.6616 - accuracy: 0.6609 - val_loss: 0.6685 - val_accuracy: 0.6939
Confusion matrix: 
 [[727 143]
 [190  28]]
Validation f1: 14.40
Validation accuracy: 69.39
Validation recall: 12.84
Validation precision: 16.37
Validation AUC: 0.19042226132659346
Validation class accuracies: [0.835632183908046, 0.12844036697247707]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 2 epochs
Epoch 9/40
263/263 - 517s - loss: 0.6508 - accuracy: 0.6878 - val_loss: 0.6708 - val_accuracy: 0.6875
Confusion matrix: 
 [[700 170]
 [170  48]]
Validation f1: 22.02
Validation accuracy: 68.75
Validation recall: 22.02
Validation precision: 22.02
Validation AUC: 0.23070761126166053
Validation class accuracies: [0.8045977011494253, 0.22018348623853212]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 3 epochs
Epoch 10/40
263/263 - 517s - loss: 0.6456 - accuracy: 0.6988 - val_loss: 0.6653 - val_accuracy: 0.6958
Confusion matrix: 
 [[706 164]
 [167  51]]
Validation f1: 23.56
Validation accuracy: 69.58
Validation recall: 23.39
Validation precision: 23.72
Validation AUC: 0.2321448544883899
Validation class accuracies: [0.8114942528735632, 0.23394495412844038]
Lr has been adjusted to 7.499999628635123e-05
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 4 epochs
Epoch 11/40
263/263 - 517s - loss: 0.6301 - accuracy: 0.7448 - val_loss: 0.7465 - val_accuracy: 0.4871
Confusion matrix: 
 [[414 456]
 [102 116]]
Validation f1: 29.37
Validation accuracy: 48.71
Validation recall: 53.21
Validation precision: 20.28
Validation AUC: 0.20892812738397504
Validation class accuracies: [0.47586206896551725, 0.5321100917431193]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 5 epochs
Saving model...
Epoch 12/40
263/263 - 516s - loss: 0.6225 - accuracy: 0.7531 - val_loss: 0.6684 - val_accuracy: 0.7068
Confusion matrix: 
 [[731 139]
 [180  38]]
Validation f1: 19.24
Validation accuracy: 70.68
Validation recall: 17.43
Validation precision: 21.47
Validation AUC: 0.22323768251156556
Validation class accuracies: [0.8402298850574713, 0.1743119266055046]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 6 epochs
Epoch 13/40
263/263 - 514s - loss: 0.6135 - accuracy: 0.7767 - val_loss: 0.7427 - val_accuracy: 0.5588
Confusion matrix: 
 [[500 370]
 [110 108]]
Validation f1: 31.03
Validation accuracy: 55.88
Validation recall: 49.54
Validation precision: 22.59
Validation AUC: 0.21834717717643015
Validation class accuracies: [0.5747126436781609, 0.4954128440366973]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 7 epochs
Saving model...
Epoch 14/40
263/263 - 516s - loss: 0.6057 - accuracy: 0.7958 - val_loss: 0.7222 - val_accuracy: 0.6324
Confusion matrix: 
 [[627 243]
 [157  61]]
Validation f1: 23.37
Validation accuracy: 63.24
Validation recall: 27.98
Validation precision: 20.07
Validation AUC: 0.1993470336013209
Validation class accuracies: [0.7206896551724138, 0.2798165137614679]
Lr has been adjusted to 5.624999903375283e-05
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 8 epochs
Epoch 15/40
263/263 - 516s - loss: 0.5905 - accuracy: 0.8248 - val_loss: 0.6739 - val_accuracy: 0.7261
Confusion matrix: 
 [[767 103]
 [195  23]]
Validation f1: 13.37
Validation accuracy: 72.61
Validation recall: 10.55
Validation precision: 18.25
Validation AUC: 0.2133664322873272
Validation class accuracies: [0.8816091954022989, 0.10550458715596331]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 9 epochs
Epoch 16/40
263/263 - 516s - loss: 0.5841 - accuracy: 0.8480 - val_loss: 0.6868 - val_accuracy: 0.6847
Confusion matrix: 
 [[702 168]
 [175  43]]
Validation f1: 20.05
Validation accuracy: 68.47
Validation recall: 19.72
Validation precision: 20.38
Validation AUC: 0.21376125698206544
Validation class accuracies: [0.8068965517241379, 0.19724770642201836]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 10 epochs
Epoch 17/40
263/263 - 515s - loss: 0.5776 - accuracy: 0.8601 - val_loss: 0.7376 - val_accuracy: 0.5671
Confusion matrix: 
 [[517 353]
 [118 100]]
Validation f1: 29.81
Validation accuracy: 56.71
Validation recall: 45.87
Validation precision: 22.08
Validation AUC: 0.23411442820050174
Validation class accuracies: [0.5942528735632184, 0.45871559633027525]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 11 epochs
Epoch 18/40
263/263 - 515s - loss: 0.5745 - accuracy: 0.8687 - val_loss: 0.7318 - val_accuracy: 0.5800
Confusion matrix: 
 [[540 330]
 [127  91]]
Validation f1: 28.48
Validation accuracy: 58.00
Validation recall: 41.74
Validation precision: 21.62
Validation AUC: 0.20628368279074544
Validation class accuracies: [0.6206896551724138, 0.41743119266055045]
Lr has been adjusted to 4.2187501094304025e-05
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 12 epochs
Epoch 19/40
263/263 - 517s - loss: 0.5639 - accuracy: 0.8880 - val_loss: 0.7037 - val_accuracy: 0.7004
Confusion matrix: 
 [[727 143]
 [183  35]]
Validation f1: 17.68
Validation accuracy: 70.04
Validation recall: 16.06
Validation precision: 19.66
Validation AUC: 0.2047615954308819
Validation class accuracies: [0.835632183908046, 0.16055045871559634]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 13 epochs
Epoch 20/40
263/263 - 520s - loss: 0.5598 - accuracy: 0.9063 - val_loss: 0.7254 - val_accuracy: 0.6066
Confusion matrix: 
 [[578 292]
 [136  82]]
Validation f1: 27.70
Validation accuracy: 60.66
Validation recall: 37.61
Validation precision: 21.93
Validation AUC: 0.2203551233327257
Validation class accuracies: [0.664367816091954, 0.3761467889908257]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 14 epochs
Epoch 21/40
263/263 - 524s - loss: 0.5591 - accuracy: 0.9054 - val_loss: 0.7305 - val_accuracy: 0.5699
Confusion matrix: 
 [[529 341]
 [127  91]]
Validation f1: 28.00
Validation accuracy: 56.99
Validation recall: 41.74
Validation precision: 21.06
Validation AUC: 0.20966550083175894
Validation class accuracies: [0.6080459770114942, 0.41743119266055045]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 15 epochs
Epoch 22/40
263/263 - 525s - loss: 0.5567 - accuracy: 0.9111 - val_loss: 0.6921 - val_accuracy: 0.7417
Confusion matrix: 
 [[786  84]
 [197  21]]
Validation f1: 13.00
Validation accuracy: 74.17
Validation recall: 9.63
Validation precision: 20.00
Validation AUC: 0.2241488373183665
Validation class accuracies: [0.903448275862069, 0.0963302752293578]
Lr has been adjusted to 3.164062582072802e-05
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 16 epochs
Epoch 23/40
263/263 - 523s - loss: 0.5503 - accuracy: 0.9283 - val_loss: 0.6961 - val_accuracy: 0.7105
Confusion matrix: 
 [[741 129]
 [186  32]]
Validation f1: 16.89
Validation accuracy: 71.05
Validation recall: 14.68
Validation precision: 19.88
Validation AUC: 0.21521133925964764
Validation class accuracies: [0.8517241379310345, 0.14678899082568808]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 17 epochs
Epoch 24/40
263/263 - 518s - loss: 0.5500 - accuracy: 0.9256 - val_loss: 0.6902 - val_accuracy: 0.7215
Confusion matrix: 
 [[759 111]
 [192  26]]
Validation f1: 14.65
Validation accuracy: 72.15
Validation recall: 11.93
Validation precision: 18.98
Validation AUC: 0.2199755164808338
Validation class accuracies: [0.8724137931034482, 0.11926605504587157]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 18 epochs
Epoch 25/40
263/263 - 519s - loss: 0.5483 - accuracy: 0.9299 - val_loss: 0.7090 - val_accuracy: 0.6232
Confusion matrix: 
 [[600 270]
 [140  78]]
Validation f1: 27.56
Validation accuracy: 62.32
Validation recall: 35.78
Validation precision: 22.41
Validation AUC: 0.2254294675138904
Validation class accuracies: [0.6896551724137931, 0.3577981651376147]
The validation tracker metric at 0.2922636103151863 hasn't increased by 0.05 in 19 epochs
Epoch 26/40
263/263 - 519s - loss: 0.5489 - accuracy: 0.9304 - val_loss: 0.6997 - val_accuracy: 0.7289
Confusion matrix: 
 [[779  91]
 [204  14]]
Validation f1: 8.67
Validation accuracy: 72.89
Validation recall: 6.42
Validation precision: 13.33
Validation AUC: 0.20368934274546063
Validation class accuracies: [0.8954022988505748, 0.06422018348623854]

The metrics for the epoch with the best target metric are: 
Best cm: [[500 370]
 [110 108]]
Best f1: 0.3103448275862069
Best accuracy: 0.5588235294117647
Best recall: 0.4954128440366973
Best precision: 0.22594142259414227
Best AUC: 0.21834717717643015
Best epoch: 13
Lr has been adjusted to 2.3730470275040716e-05
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 11
Starting...
CM: [[ 2 58]
 [ 0 15]]
F1: 0.3409090909090909
Accuracy: 0.22666666666666666
Precision: 0.2054794520547945
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/validation_sheet_11.xls...
Done.
Epoch: 13
Starting...
CM: [[ 5 55]
 [ 0 15]]
F1: 0.35294117647058826
Accuracy: 0.26666666666666666
Precision: 0.21428571428571427
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/validation_sheet_13.xls...
Done.
Epoch: 3
Starting...
CM: [[58  2]
 [14  1]]
F1: 0.1111111111111111
Accuracy: 0.7866666666666666
Precision: 0.3333333333333333
Recall: 0.06666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/validation_sheet_3.xls...
Done.
Epoch: 4
Starting...
CM: [[23 37]
 [ 8  7]]
F1: 0.23728813559322037
Accuracy: 0.4
Precision: 0.1590909090909091
Recall: 0.4666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/validation_sheet_4.xls...
Done.
Epoch: 40
Starting...
CM: [[30 30]
 [13  2]]
F1: 0.0851063829787234
Accuracy: 0.4266666666666667
Precision: 0.0625
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/validation_sheet_40.xls...
Done.
Epoch: 5
Starting...
CM: [[42 18]
 [ 7  8]]
F1: 0.3902439024390244
Accuracy: 0.6666666666666666
Precision: 0.3076923076923077
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/validation_sheet_5.xls...
Done.
Epoch: 6
Starting...
CM: [[ 1 59]
 [ 1 14]]
F1: 0.3181818181818181
Accuracy: 0.2
Precision: 0.1917808219178082
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/validation_sheet_6.xls...
Done.
wandb: Waiting for W&B process to finish, PID 1562
wandb: Program ended successfully.
wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.02MB uploaded (0.00MB deduped)wandb: | 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: / 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: | 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_151923-315iffu7/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210510_151923-315iffu7/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.93041
wandb:         val_accuracy 0.72886
wandb:             _runtime 14077
wandb:           _timestamp 1620674040
wandb:                _step 187
wandb:           train_loss 0.54893
wandb:             val_loss 0.69971
wandb:           val_recall 0.06422
wandb:        val_precision 0.13333
wandb:               val_f1 0.08669
wandb:              val_auc 0.20369
wandb:                   lr 3e-05
wandb:          best_val_f1 0.31034
wandb:    best_val_accuracy 0.55882
wandb:   best_val_precision 0.22594
wandb:      best_val_recall 0.49541
wandb:             best_auc 0.21835
wandb:           best_epoch 13
wandb:           best_bd_f1 0.39024
wandb:     best_bd_accuracy 0.66667
wandb:    best_bd_precision 0.30769
wandb:       best_bd_recall 0.53333
wandb:        best_bd_epoch 5
wandb: Run history:
wandb:   train_accuracy ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:     val_accuracy ‚ñà‚ñà‚ñà‚ñÜ‚ñá‚ñÇ‚ñá‚ñÜ‚ñÖ‚ñÜ‚ñÅ‚ñÜ‚ñÉ‚ñÑ‚ñÜ‚ñÖ‚ñÉ‚ñÉ‚ñÜ‚ñÑ‚ñÉ‚ñá‚ñÜ‚ñÜ‚ñÑ‚ñÜ
wandb:         _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:       _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:            _step ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:       train_loss ‚ñà‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:         val_loss ‚ñÅ‚ñÅ‚ñÇ‚ñÉ‚ñÇ‚ñÖ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñà‚ñÉ‚ñà‚ñÜ‚ñÉ‚ñÑ‚ñá‚ñá‚ñÖ‚ñá‚ñá‚ñÖ‚ñÖ‚ñÑ‚ñÜ‚ñÖ
wandb:       val_recall ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñá‚ñÇ‚ñÉ‚ñÑ‚ñÑ‚ñà‚ñÉ‚ñà‚ñÖ‚ñÇ‚ñÑ‚ñá‚ñÜ‚ñÉ‚ñÜ‚ñÜ‚ñÇ‚ñÉ‚ñÉ‚ñÜ‚ñÇ
wandb:    val_precision ‚ñÅ‚ñÅ‚ñà‚ñÜ‚ñà‚ñÜ‚ñÜ‚ñÖ‚ñá‚ñá‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÑ
wandb:           val_f1 ‚ñÅ‚ñÅ‚ñÇ‚ñÑ‚ñÖ‚ñà‚ñÉ‚ñÑ‚ñÜ‚ñÜ‚ñà‚ñÖ‚ñà‚ñÜ‚ñÑ‚ñÜ‚ñà‚ñá‚ñÖ‚ñá‚ñá‚ñÑ‚ñÖ‚ñÑ‚ñá‚ñÉ
wandb:          val_auc ‚ñá‚ñÅ‚ñÇ‚ñÑ‚ñà‚ñá‚ñÖ‚ñÉ‚ñá‚ñà‚ñÖ‚ñá‚ñÜ‚ñÑ‚ñÖ‚ñÖ‚ñà‚ñÖ‚ñÑ‚ñÜ‚ñÖ‚ñá‚ñÜ‚ñÜ‚ñá‚ñÑ
wandb:               lr ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Synced 6 W&B file(s), 6 media file(s), 6 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2120: https://wandb.ai/arachid1/tensorboard-integration/runs/315iffu7


 See logs at ../../new_cache/conv__2120__05_1513__v29__mod9_redogoodone/logs/