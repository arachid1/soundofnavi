Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2207
Description:  new_lstm
2021-06-09 01:21:23.711454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-09 01:21:25.970304: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-09 01:21:25.971307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-09 01:21:25.981365: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:21:25.981965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-09 01:21:25.981991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-09 01:21:25.986324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-09 01:21:25.986407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-09 01:21:25.987517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-09 01:21:25.987809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-09 01:21:25.988810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-09 01:21:25.989723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-09 01:21:25.989881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-09 01:21:25.989993: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:21:25.990607: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:21:25.991223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2207.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2207__06_0121__v29__new_lstm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 32, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 50, 'FACTOR': 0.75, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 10, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-09 01:22:04.905190: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-09 01:22:04.905553: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:22:04.906304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-09 01:22:04.906357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-09 01:22:04.906427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-09 01:22:04.906450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-09 01:22:04.906473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-09 01:22:04.906496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-09 01:22:04.906518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-09 01:22:04.906539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-09 01:22:04.906560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-09 01:22:04.906660: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:22:04.907395: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:22:04.908082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-09 01:22:04.908133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-09 01:22:05.590366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-09 01:22:05.590412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-09 01:22:05.590421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-09 01:22:05.590705: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:22:05.591424: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:22:05.592038: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-09 01:22:05.592597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-06-09 01:22:07.335288: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-09 01:22:07.337801: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-09 01:22:07.951016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-09 01:22:09.510362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-09 01:22:09.850478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.6724137931034483, 1: 1.95}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 5, 250, 128, 1) 0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 5, 250, 128, 1)  4            input_1[0][0]                        
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 5, 250, 128, 16) 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed (None, 5, 250, 128, 16) 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed (None, 5, 250, 128, 1)  0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed (None, 5, 250, 128, 16) 2320         time_distributed[0][0]               
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed (None, 5, 250, 128, 16) 6416         time_distributed_2[0][0]             
______________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed (None, 5, 250, 128, 16) 32           time_distributed_4[0][0]             
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 5, 250, 128, 48) 0            time_distributed_1[0][0]             
                                                                         time_distributed_3[0][0]             
                                                                         time_distributed_5[0][0]             
______________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed (None, 5, 125, 64, 48)  0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 5, 125, 64, 48)  192          time_distributed_6[0][0]             
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 5, 125, 64, 48)  0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed (None, 5, 125, 64, 48)  1242         dropout[0][0]                        
______________________________________________________________________________________________________________
time_distributed_8 (TimeDistributed (None, 5, 125, 64, 48)  1242         time_distributed_7[0][0]             
______________________________________________________________________________________________________________
time_distributed_9 (TimeDistributed (None, 5, 48)           0            time_distributed_8[0][0]             
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 5, 256)          181248       time_distributed_9[0][0]             
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 5, 256)          394240       bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 5, 1)            257          bidirectional_1[0][0]                
______________________________________________________________________________________________________________
flatten (Flatten)                   (None, 5)               0            dense[0][0]                          
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 64)              384          flatten[0][0]                        
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 64)              0            dense_1[0][0]                        
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               65           dropout_1[0][0]                      
==============================================================================================================
Total params: 587,706
Trainable params: 587,608
Non-trainable params: 98
______________________________________________________________________________________________________________
Epoch 1/50
132/132 - 95s - loss: 0.6946 - accuracy: 0.5273 - val_loss: 0.6896 - val_accuracy: 0.7164
Confusion matrix: 
 [[756  28]
 [276  12]]
Normalized Confusion matrix: 
 [[0.964 0.036]
 [0.958 0.042]]
Validation f1: 7.32
Validation accuracy: 71.64
Validation recall: 4.17
Validation precision: 30.00
Validation AUC: 0.33236904898110153
Validation class accuracies: [0.9642857142857143, 0.041666666666666664]
Saving model...
Epoch 2/50
132/132 - 90s - loss: 0.6913 - accuracy: 0.4606 - val_loss: 0.6511 - val_accuracy: 0.7323
Confusion matrix: 
 [[784   0]
 [287   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.997 0.003]]
Validation f1: 0.69
Validation accuracy: 73.23
Validation recall: 0.35
Validation precision: 100.00
Validation AUC: 0.33562962281440034
Validation class accuracies: [1.0, 0.003472222222222222]
The validation tracker metric at 0.07317073170731707 hasn't increased by 0 in 1 epochs
Epoch 3/50
132/132 - 90s - loss: 0.6900 - accuracy: 0.4698 - val_loss: 0.6624 - val_accuracy: 0.5737
Confusion matrix: 
 [[436 348]
 [109 179]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.556 0.444]
 [0.378 0.622]]
Validation f1: 43.93
Validation accuracy: 57.37
Validation recall: 62.15
Validation precision: 33.97
Validation AUC: 0.3387996894453052
Validation class accuracies: [0.5561224489795918, 0.6215277777777778]
Saving model...
Epoch 4/50
132/132 - 90s - loss: 0.6886 - accuracy: 0.4269 - val_loss: 0.7177 - val_accuracy: 0.2976
Confusion matrix: 
 [[ 56 728]
 [ 25 263]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.071 0.929]
 [0.087 0.913]]
Validation f1: 41.13
Validation accuracy: 29.76
Validation recall: 91.32
Validation precision: 26.54
Validation AUC: 0.3266956292425172
Validation class accuracies: [0.07142857142857142, 0.9131944444444444]
The validation tracker metric at 0.43926380368098156 hasn't increased by 0 in 1 epochs
Epoch 5/50
132/132 - 90s - loss: 0.6892 - accuracy: 0.4162 - val_loss: 0.6796 - val_accuracy: 0.4851
Confusion matrix: 
 [[293 491]
 [ 61 227]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.374 0.626]
 [0.212 0.788]]
Validation f1: 45.13
Validation accuracy: 48.51
Validation recall: 78.82
Validation precision: 31.62
Validation AUC: 0.3398353478717119
Validation class accuracies: [0.3737244897959184, 0.7881944444444444]
Saving model...
Epoch 6/50
132/132 - 90s - loss: 0.6884 - accuracy: 0.4122 - val_loss: 0.7077 - val_accuracy: 0.3601
Confusion matrix: 
 [[132 652]
 [ 34 254]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.168 0.832]
 [0.118 0.882]]
Validation f1: 42.55
Validation accuracy: 36.01
Validation recall: 88.19
Validation precision: 28.04
Validation AUC: 0.3271138328850024
Validation class accuracies: [0.1683673469387755, 0.8819444444444444]
The validation tracker metric at 0.4512922465208748 hasn't increased by 0 in 1 epochs
Epoch 7/50
132/132 - 90s - loss: 0.6899 - accuracy: 0.4084 - val_loss: 0.6908 - val_accuracy: 0.4366
Confusion matrix: 
 [[230 554]
 [ 50 238]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.293 0.707]
 [0.174 0.826]]
Validation f1: 44.07
Validation accuracy: 43.66
Validation recall: 82.64
Validation precision: 30.05
Validation AUC: 0.3396386442171577
Validation class accuracies: [0.29336734693877553, 0.8263888888888888]
The validation tracker metric at 0.4512922465208748 hasn't increased by 0 in 2 epochs
Epoch 8/50
132/132 - 90s - loss: 0.6881 - accuracy: 0.4359 - val_loss: 0.6576 - val_accuracy: 0.5989
Confusion matrix: 
 [[486 298]
 [132 156]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.62  0.38 ]
 [0.458 0.542]]
Validation f1: 42.05
Validation accuracy: 59.89
Validation recall: 54.17
Validation precision: 34.36
Validation AUC: 0.3385832967666407
Validation class accuracies: [0.6198979591836735, 0.5416666666666666]
The validation tracker metric at 0.4512922465208748 hasn't increased by 0 in 3 epochs
Epoch 9/50
132/132 - 91s - loss: 0.6871 - accuracy: 0.4525 - val_loss: 0.6692 - val_accuracy: 0.5420
Confusion matrix: 
 [[383 401]
 [ 90 198]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.489 0.511]
 [0.312 0.688]]
Validation f1: 44.64
Validation accuracy: 54.20
Validation recall: 68.75
Validation precision: 33.06
Validation AUC: 0.33892173918805457
Validation class accuracies: [0.4885204081632653, 0.6875]
The validation tracker metric at 0.4512922465208748 hasn't increased by 0 in 4 epochs
Epoch 10/50
132/132 - 91s - loss: 0.6870 - accuracy: 0.4568 - val_loss: 0.6776 - val_accuracy: 0.4981
Confusion matrix: 
 [[309 475]
 [ 63 225]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.394 0.606]
 [0.219 0.781]]
Validation f1: 45.55
Validation accuracy: 49.81
Validation recall: 78.12
Validation precision: 32.14
Validation AUC: 0.3386817254566311
Validation class accuracies: [0.39413265306122447, 0.78125]
Saving model...
Epoch 11/50
132/132 - 91s - loss: 0.6885 - accuracy: 0.4198 - val_loss: 0.6962 - val_accuracy: 0.4328
Confusion matrix: 
 [[222 562]
 [ 46 242]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.283 0.717]
 [0.16  0.84 ]]
Validation f1: 44.32
Validation accuracy: 43.28
Validation recall: 84.03
Validation precision: 30.10
Validation AUC: 0.33867345085312583
Validation class accuracies: [0.28316326530612246, 0.8402777777777778]
The validation tracker metric at 0.4554655870445345 hasn't increased by 0 in 1 epochs
Epoch 12/50
132/132 - 91s - loss: 0.6873 - accuracy: 0.4217 - val_loss: 0.6697 - val_accuracy: 0.5177
Confusion matrix: 
 [[347 437]
 [ 80 208]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.443 0.557]
 [0.278 0.722]]
Validation f1: 44.59
Validation accuracy: 51.77
Validation recall: 72.22
Validation precision: 32.25
Validation AUC: 0.33756972419917664
Validation class accuracies: [0.44260204081632654, 0.7222222222222222]
The validation tracker metric at 0.4554655870445345 hasn't increased by 0 in 2 epochs
Epoch 13/50
132/132 - 91s - loss: 0.6871 - accuracy: 0.4250 - val_loss: 0.6671 - val_accuracy: 0.5280
Confusion matrix: 
 [[363 421]
 [ 85 203]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.463 0.537]
 [0.295 0.705]]
Validation f1: 44.52
Validation accuracy: 52.80
Validation recall: 70.49
Validation precision: 32.53
Validation AUC: 0.3373954274717299
Validation class accuracies: [0.4630102040816326, 0.7048611111111112]
The validation tracker metric at 0.4554655870445345 hasn't increased by 0 in 3 epochs
Epoch 14/50
132/132 - 91s - loss: 0.6873 - accuracy: 0.4205 - val_loss: 0.6784 - val_accuracy: 0.4907
Confusion matrix: 
 [[298 486]
 [ 60 228]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.38  0.62 ]
 [0.208 0.792]]
Validation f1: 45.51
Validation accuracy: 49.07
Validation recall: 79.17
Validation precision: 31.93
Validation AUC: 0.3379519312821372
Validation class accuracies: [0.38010204081632654, 0.7916666666666666]
The validation tracker metric at 0.4554655870445345 hasn't increased by 0 in 4 epochs
Epoch 15/50
132/132 - 91s - loss: 0.6868 - accuracy: 0.4022 - val_loss: 0.6881 - val_accuracy: 0.4356
Confusion matrix: 
 [[227 557]
 [ 48 240]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.29  0.71 ]
 [0.167 0.833]]
Validation f1: 44.24
Validation accuracy: 43.56
Validation recall: 83.33
Validation precision: 30.11
Validation AUC: 0.3379718434965402
Validation class accuracies: [0.2895408163265306, 0.8333333333333334]
The validation tracker metric at 0.4554655870445345 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.000750000006519258
Epoch 16/50
132/132 - 92s - loss: 0.6867 - accuracy: 0.4124 - val_loss: 0.6697 - val_accuracy: 0.5009
Confusion matrix: 
 [[310 474]
 [ 61 227]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.395 0.605]
 [0.212 0.788]]
Validation f1: 45.90
Validation accuracy: 50.09
Validation recall: 78.82
Validation precision: 32.38
Validation AUC: 0.3383041760458612
Validation class accuracies: [0.39540816326530615, 0.7881944444444444]
Saving model...
Epoch 17/50
132/132 - 92s - loss: 0.6858 - accuracy: 0.4141 - val_loss: 0.6597 - val_accuracy: 0.5401
Confusion matrix: 
 [[374 410]
 [ 83 205]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.477 0.523]
 [0.288 0.712]]
Validation f1: 45.40
Validation accuracy: 54.01
Validation recall: 71.18
Validation precision: 33.33
Validation AUC: 0.3396545164661109
Validation class accuracies: [0.4770408163265306, 0.7118055555555556]
The validation tracker metric at 0.4590495449949445 hasn't increased by 0 in 1 epochs
Epoch 18/50
132/132 - 92s - loss: 0.6858 - accuracy: 0.4138 - val_loss: 0.6570 - val_accuracy: 0.5410
Confusion matrix: 
 [[375 409]
 [ 83 205]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.478 0.522]
 [0.288 0.712]]
Validation f1: 45.45
Validation accuracy: 54.10
Validation recall: 71.18
Validation precision: 33.39
Validation AUC: 0.33960030960641185
Validation class accuracies: [0.47831632653061223, 0.7118055555555556]
The validation tracker metric at 0.4590495449949445 hasn't increased by 0 in 2 epochs
Epoch 19/50
132/132 - 93s - loss: 0.6859 - accuracy: 0.4314 - val_loss: 0.6711 - val_accuracy: 0.4925
Confusion matrix: 
 [[300 484]
 [ 60 228]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.383 0.617]
 [0.208 0.792]]
Validation f1: 45.60
Validation accuracy: 49.25
Validation recall: 79.17
Validation precision: 32.02
Validation AUC: 0.33833449838325363
Validation class accuracies: [0.3826530612244898, 0.7916666666666666]
The validation tracker metric at 0.4590495449949445 hasn't increased by 0 in 3 epochs
Epoch 20/50
132/132 - 93s - loss: 0.6855 - accuracy: 0.4219 - val_loss: 0.6670 - val_accuracy: 0.5009
Confusion matrix: 
 [[310 474]
 [ 61 227]]
Normalized Confusion matrix: 
 [[0.395 0.605]
 [0.212 0.788]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.90
Validation accuracy: 50.09
Validation recall: 78.82
Validation precision: 32.38
Validation AUC: 0.33814449234495225
Validation class accuracies: [0.39540816326530615, 0.7881944444444444]
The validation tracker metric at 0.4590495449949445 hasn't increased by 0 in 4 epochs
Epoch 21/50
132/132 - 93s - loss: 0.6862 - accuracy: 0.4055 - val_loss: 0.6604 - val_accuracy: 0.5205
Confusion matrix: 
 [[340 444]
 [ 70 218]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.434 0.566]
 [0.243 0.757]]
Validation f1: 45.89
Validation accuracy: 52.05
Validation recall: 75.69
Validation precision: 32.93
Validation AUC: 0.3404853198917681
Validation class accuracies: [0.4336734693877551, 0.7569444444444444]
The validation tracker metric at 0.4590495449949445 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005624999757856131
Epoch 22/50
132/132 - 92s - loss: 0.6852 - accuracy: 0.4112 - val_loss: 0.6583 - val_accuracy: 0.5233
Confusion matrix: 
 [[350 434]
 [ 77 211]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.446 0.554]
 [0.267 0.733]]
Validation f1: 45.23
Validation accuracy: 52.33
Validation recall: 73.26
Validation precision: 32.71
Validation AUC: 0.3410483380716937
Validation class accuracies: [0.44642857142857145, 0.7326388888888888]
The validation tracker metric at 0.4590495449949445 hasn't increased by 0 in 6 epochs
Epoch 23/50
132/132 - 93s - loss: 0.6866 - accuracy: 0.4209 - val_loss: 0.6688 - val_accuracy: 0.5159
Confusion matrix: 
 [[332 452]
 [ 67 221]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.423 0.577]
 [0.233 0.767]]
Validation f1: 45.99
Validation accuracy: 51.59
Validation recall: 76.74
Validation precision: 32.84
Validation AUC: 0.3409351026017492
Validation class accuracies: [0.42346938775510207, 0.7673611111111112]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
