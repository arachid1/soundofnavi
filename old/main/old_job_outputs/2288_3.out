Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2288
Description:  augmix
2021-07-06 12:44:27.859066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-07-06 12:44:30.113453: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-06 12:44:30.114359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-06 12:44:30.161302: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:44:30.162011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-06 12:44:30.162040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:44:30.165661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:44:30.165751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-06 12:44:30.166863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-06 12:44:30.167165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-06 12:44:30.168175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-06 12:44:30.169057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-06 12:44:30.169211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:44:30.169320: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:44:30.170043: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:44:30.170674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2288.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2288__07_1243__v39__augmix
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-06 12:53:27.868087: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-06 12:53:27.868453: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:53:27.869165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-06 12:53:27.869233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:53:27.869336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:53:27.869373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-06 12:53:27.869413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-06 12:53:27.869448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-06 12:53:27.869480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-06 12:53:27.869518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-06 12:53:27.869549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:53:27.869673: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:53:27.870390: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:53:27.871038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-06 12:53:27.871095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:53:28.719443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-06 12:53:28.719491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-06 12:53:28.719502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-06 12:53:28.719836: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:53:28.720934: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:53:28.721619: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:53:28.722258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-07-06 12:53:30.141548: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-07-06 12:53:30.143843: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-06 12:53:30.638894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:53:33.302379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:53:33.866456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_6
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_7
Length of training samples after augmix augmentation: 3016
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
189/189 - 87s - loss: 0.4901 - accuracy: 0.7066 - val_loss: 0.4700 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08956464077768098
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
189/189 - 80s - loss: 0.3161 - accuracy: 0.8408 - val_loss: 0.2897 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5003163715169516
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
189/189 - 80s - loss: 0.2213 - accuracy: 0.8975 - val_loss: 0.1925 - val_accuracy: 0.9365
Confusion matrix: 
 [[573   0]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.951 0.049]]
Validation f1: 9.30
Validation accuracy: 93.65
Validation recall: 4.88
Validation precision: 100.00
Validation AUC: 0.6521969828450338
Validation class accuracies: [1.0, 0.04878048780487805]
Saving model...
Epoch 4/65
189/189 - 80s - loss: 0.1612 - accuracy: 0.9224 - val_loss: 0.2485 - val_accuracy: 0.9137
Confusion matrix: 
 [[531  42]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.268 0.732]]
Validation f1: 53.10
Validation accuracy: 91.37
Validation recall: 73.17
Validation precision: 41.67
Validation AUC: 0.6640965772541304
Validation class accuracies: [0.9267015706806283, 0.7317073170731707]
Saving model...
Epoch 5/65
189/189 - 82s - loss: 0.1846 - accuracy: 0.9297 - val_loss: 0.2179 - val_accuracy: 0.9414
Confusion matrix: 
 [[552  21]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.09
Validation accuracy: 94.14
Validation recall: 63.41
Validation precision: 55.32
Validation AUC: 0.6251315931336091
Validation class accuracies: [0.9633507853403142, 0.6341463414634146]
Saving model...
Epoch 6/65
189/189 - 81s - loss: 0.1086 - accuracy: 0.9539 - val_loss: 2.3318 - val_accuracy: 0.5570
Confusion matrix: 
 [[301 272]
 [  0  41]]
Normalized Confusion matrix: 
 [[0.525 0.475]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.16
Validation accuracy: 55.70
Validation recall: 100.00
Validation precision: 13.10
Validation AUC: 0.5243519600857117
Validation class accuracies: [0.525305410122164, 1.0]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 1 epochs
Epoch 7/65
189/189 - 81s - loss: 0.1292 - accuracy: 0.9443 - val_loss: 0.2247 - val_accuracy: 0.9332
Confusion matrix: 
 [[544  29]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.293 0.707]]
Validation f1: 58.59
Validation accuracy: 93.32
Validation recall: 70.73
Validation precision: 50.00
Validation AUC: 0.7076424836528209
Validation class accuracies: [0.9493891797556719, 0.7073170731707317]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 2 epochs
Epoch 8/65
189/189 - 81s - loss: 0.0682 - accuracy: 0.9712 - val_loss: 0.2876 - val_accuracy: 0.9218
Confusion matrix: 
 [[536  37]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.268 0.732]]
Validation f1: 55.56
Validation accuracy: 92.18
Validation recall: 73.17
Validation precision: 44.78
Validation AUC: 0.7226884147913926
Validation class accuracies: [0.9354275741710296, 0.7317073170731707]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 3 epochs
Epoch 9/65
189/189 - 81s - loss: 0.0485 - accuracy: 0.9824 - val_loss: 0.2152 - val_accuracy: 0.9397
Confusion matrix: 
 [[548  25]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.293 0.707]]
Validation f1: 61.05
Validation accuracy: 93.97
Validation recall: 70.73
Validation precision: 53.70
Validation AUC: 0.720511740541897
Validation class accuracies: [0.956369982547993, 0.7073170731707317]
Saving model...
Epoch 10/65
189/189 - 81s - loss: 0.0361 - accuracy: 0.9881 - val_loss: 0.4411 - val_accuracy: 0.8844
Confusion matrix: 
 [[513  60]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.80
Validation accuracy: 88.44
Validation recall: 73.17
Validation precision: 33.33
Validation AUC: 0.6737810606694415
Validation class accuracies: [0.8952879581151832, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 1 epochs
Epoch 11/65
189/189 - 80s - loss: 0.0315 - accuracy: 0.9894 - val_loss: 0.2440 - val_accuracy: 0.9365
Confusion matrix: 
 [[546  27]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.293 0.707]]
Validation f1: 59.79
Validation accuracy: 93.65
Validation recall: 70.73
Validation precision: 51.79
Validation AUC: 0.7253441404885358
Validation class accuracies: [0.9528795811518325, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 2 epochs
Epoch 12/65
189/189 - 81s - loss: 0.0210 - accuracy: 0.9940 - val_loss: 0.3317 - val_accuracy: 0.9137
Confusion matrix: 
 [[531  42]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.10
Validation accuracy: 91.37
Validation recall: 73.17
Validation precision: 41.67
Validation AUC: 0.698107535974874
Validation class accuracies: [0.9267015706806283, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 3 epochs
Epoch 13/65
189/189 - 81s - loss: 0.0155 - accuracy: 0.9970 - val_loss: 0.2679 - val_accuracy: 0.9283
Confusion matrix: 
 [[541  32]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.293 0.707]]
Validation f1: 56.86
Validation accuracy: 92.83
Validation recall: 70.73
Validation precision: 47.54
Validation AUC: 0.7159730792712399
Validation class accuracies: [0.944153577661431, 0.7073170731707317]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 4 epochs
Epoch 14/65
189/189 - 81s - loss: 0.0425 - accuracy: 0.9871 - val_loss: 0.5692 - val_accuracy: 0.8811
Confusion matrix: 
 [[511  62]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.268 0.732]]
Validation f1: 45.11
Validation accuracy: 88.11
Validation recall: 73.17
Validation precision: 32.61
Validation AUC: 0.7293119834751857
Validation class accuracies: [0.8917975567190227, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 15/65
189/189 - 82s - loss: 0.0587 - accuracy: 0.9784 - val_loss: 0.4283 - val_accuracy: 0.8958
Confusion matrix: 
 [[518  55]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.22  0.78 ]]
Validation f1: 50.00
Validation accuracy: 89.58
Validation recall: 78.05
Validation precision: 36.78
Validation AUC: 0.7358758511020543
Validation class accuracies: [0.9040139616055847, 0.7804878048780488]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 6 epochs
Epoch 16/65
189/189 - 81s - loss: 0.0204 - accuracy: 0.9944 - val_loss: 0.3208 - val_accuracy: 0.9218
Confusion matrix: 
 [[535  38]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.244 0.756]]
Validation f1: 56.36
Validation accuracy: 92.18
Validation recall: 75.61
Validation precision: 44.93
Validation AUC: 0.7337024843301375
Validation class accuracies: [0.9336823734729494, 0.7560975609756098]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 7 epochs
Epoch 17/65
189/189 - 81s - loss: 0.0229 - accuracy: 0.9927 - val_loss: 0.2942 - val_accuracy: 0.9300
Confusion matrix: 
 [[541  32]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.268 0.732]]
Validation f1: 58.25
Validation accuracy: 93.00
Validation recall: 73.17
Validation precision: 48.39
Validation AUC: 0.7382745819014558
Validation class accuracies: [0.944153577661431, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 8 epochs
Epoch 18/65
189/189 - 81s - loss: 0.0146 - accuracy: 0.9980 - val_loss: 0.2950 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.7293028206319309
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 9 epochs
Epoch 19/65
189/189 - 82s - loss: 0.0131 - accuracy: 0.9977 - val_loss: 0.2850 - val_accuracy: 0.9349
Confusion matrix: 
 [[544  29]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.268 0.732]]
Validation f1: 60.00
Validation accuracy: 93.49
Validation recall: 73.17
Validation precision: 50.85
Validation AUC: 0.7343331695214762
Validation class accuracies: [0.9493891797556719, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 20/65
189/189 - 81s - loss: 0.0100 - accuracy: 0.9980 - val_loss: 0.3019 - val_accuracy: 0.9300
Confusion matrix: 
 [[541  32]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.25
Validation accuracy: 93.00
Validation recall: 73.17
Validation precision: 48.39
Validation AUC: 0.728375857983491
Validation class accuracies: [0.944153577661431, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 11 epochs
Epoch 21/65
189/189 - 81s - loss: 0.0122 - accuracy: 0.9990 - val_loss: 0.3020 - val_accuracy: 0.9300
Confusion matrix: 
 [[541  32]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.25
Validation accuracy: 93.00
Validation recall: 73.17
Validation precision: 48.39
Validation AUC: 0.7284820862166386
Validation class accuracies: [0.944153577661431, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 12 epochs
Epoch 22/65
189/189 - 81s - loss: 0.0135 - accuracy: 0.9973 - val_loss: 0.2898 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.7288044333671926
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 13 epochs
Epoch 23/65
189/189 - 81s - loss: 0.0118 - accuracy: 0.9960 - val_loss: 0.2894 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.7281590450637794
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 14 epochs
Epoch 24/65
189/189 - 81s - loss: 0.0105 - accuracy: 0.9980 - val_loss: 0.2982 - val_accuracy: 0.9316
Confusion matrix: 
 [[542  31]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.268 0.732]]
Validation f1: 58.82
Validation accuracy: 93.16
Validation recall: 73.17
Validation precision: 49.18
Validation AUC: 0.7288710241582952
Validation class accuracies: [0.9458987783595113, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 25/65
189/189 - 81s - loss: 0.0095 - accuracy: 0.9990 - val_loss: 0.2960 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.728373104748908
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 16 epochs
Epoch 26/65
189/189 - 81s - loss: 0.0096 - accuracy: 0.9987 - val_loss: 0.2971 - val_accuracy: 0.9316
Confusion matrix: 
 [[542  31]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.82
Validation accuracy: 93.16
Validation recall: 73.17
Validation precision: 49.18
Validation AUC: 0.727892175961118
Validation class accuracies: [0.9458987783595113, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 17 epochs
Epoch 27/65
189/189 - 82s - loss: 0.0116 - accuracy: 0.9980 - val_loss: 0.2881 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.728684286331699
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 18 epochs
Epoch 28/65
189/189 - 81s - loss: 0.0119 - accuracy: 0.9983 - val_loss: 0.2916 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.7282763875676295
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]
The validation tracker metric at 0.6105263157894738 hasn't increased by 0 in 19 epochs
Epoch 29/65
189/189 - 81s - loss: 0.0093 - accuracy: 0.9990 - val_loss: 0.2903 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.7271906079727276
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]

The metrics for job 0 with the best target metric are: 
Best cm: [[548  25]
 [ 12  29]]
Best normalized cm: [[0.956 0.044]
 [0.293 0.707]]
Best f1: 0.61
Best accuracy: 0.94
Best recall: 0.71
Best precision: 0.54
Best AUC: 0.72
Best class accuracies: [0.956369982547993, 0.7073170731707317]
Best epoch: 9
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.166]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[4.191e-05]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.213]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.053]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.111]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.445e-05]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.076]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.999]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.06]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[1.716e-05]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[5.487e-05]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[8.951e-05]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.007]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.136]]
../../new_cache/conv__2288__07_1243__v39__augmix/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.797]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 4445
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_124430-2w837nab/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_124430-2w837nab/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99901
wandb:         val_accuracy 0.93322
wandb:             _runtime 3246
wandb:           _timestamp 1625578716
wandb:                _step 214
wandb:           train_loss 0.00934
wandb:             val_loss 0.29032
wandb:           val_recall 0.73171
wandb:        val_precision 0.5
wandb:               val_f1 0.59406
wandb:              val_auc 0.72719
wandb:                   lr 2e-05
wandb:          best_val_f1 0.61053
wandb:    best_val_accuracy 0.93974
wandb:   best_val_precision 0.53704
wandb:      best_val_recall 0.70732
wandb:             best_auc 0.72051
wandb:           best_epoch 9
wandb: Run history:
wandb:   train_accuracy ▁▄▆▆▆▇▇▇█████████████████████
wandb:     val_accuracy ███▇█▁███▇█▇█▇▇██████████████
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▄▂▃▂▂▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▁▁▁█▁▁▁▂▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▁▁▆▅█▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▁█▄▅▂▅▄▅▃▅▄▄▃▄▄▄▅▅▄▄▅▅▄▅▄▅▅▅
wandb:           val_f1 ▁▁▂▇█▄█▇█▆█▇█▆▇▇█████████████
wandb:          val_auc ▁▅▇▇▇▆███▇███████████████████
wandb:               lr ██████████████▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_124430-2w837nab

-----------------------
158/800
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
local_gc_exec.sh: line 6:  4417 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2288__07_1243__v39__augmix/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 12 leaked semaphores to clean up at shutdown
  len(cache))
