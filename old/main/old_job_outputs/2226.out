Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2226
Description:  v43
2021-06-16 16:29:56.881295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-16 16:29:59.099556: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 16:29:59.100594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-16 16:29:59.146989: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:29:59.147668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 16:29:59.147698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 16:29:59.151501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 16:29:59.151588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 16:29:59.152841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 16:29:59.153139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 16:29:59.154134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 16:29:59.155073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 16:29:59.155246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 16:29:59.155357: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:29:59.156105: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:29:59.156729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2226.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2226__06_1629__v39__v43
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 148, 'WAV_PATH': 'v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 250, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-16 16:30:03.871558: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 16:30:03.871846: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:30:03.872609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 16:30:03.872651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 16:30:03.872699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 16:30:03.872719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 16:30:03.872739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 16:30:03.872759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 16:30:03.872778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 16:30:03.872797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 16:30:03.872815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 16:30:03.872906: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:30:03.873622: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:30:03.874286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-16 16:30:03.874335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 16:30:04.578807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-16 16:30:04.578859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-16 16:30:04.578869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-16 16:30:04.579192: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:30:04.580051: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:30:04.580775: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:30:04.581435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2582
-----------------------
Number of train recordings: 2582 with pneumonia: 232 and non-pneumonia: 2350
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-16 16:30:05.861148: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-16 16:30:05.862812: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-16 16:30:06.237605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 16:30:08.026753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 16:30:08.483080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
162/162 - 236s - loss: 1.0121 - accuracy: 0.5651 - val_loss: 0.4205 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1460012134457689
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
162/162 - 234s - loss: 0.5670 - accuracy: 0.6778 - val_loss: 0.3072 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.13406633573459786
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
162/162 - 234s - loss: 0.4186 - accuracy: 0.7928 - val_loss: 0.3617 - val_accuracy: 0.9008
Confusion matrix: 
 [[539  34]
 [ 26   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.812 0.188]]
Validation f1: 16.67
Validation accuracy: 90.08
Validation recall: 18.75
Validation precision: 15.00
Validation AUC: 0.0878340731076751
Validation class accuracies: [0.9406631762652705, 0.1875]
Saving model...
Epoch 4/65
162/162 - 234s - loss: 0.3417 - accuracy: 0.8300 - val_loss: 3.8001 - val_accuracy: 0.1488
Confusion matrix: 
 [[ 58 515]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.101 0.899]
 [0.    1.   ]]
Validation f1: 11.05
Validation accuracy: 14.88
Validation recall: 100.00
Validation precision: 5.85
Validation AUC: 0.3937966718973114
Validation class accuracies: [0.1012216404886562, 1.0]
The validation tracker metric at 0.16666666666666663 hasn't increased by 0 in 1 epochs
Epoch 5/65
162/162 - 233s - loss: 0.2471 - accuracy: 0.8768 - val_loss: 0.4141 - val_accuracy: 0.8281
Confusion matrix: 
 [[481  92]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.375 0.625]]
Validation f1: 27.78
Validation accuracy: 82.81
Validation recall: 62.50
Validation precision: 17.86
Validation AUC: 0.39866678249392223
Validation class accuracies: [0.8394415357766143, 0.625]
Saving model...
Epoch 6/65
162/162 - 233s - loss: 0.2898 - accuracy: 0.8633 - val_loss: 2.0398 - val_accuracy: 0.4149
Confusion matrix: 
 [[227 346]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.396 0.604]
 [0.25  0.75 ]]
Validation f1: 11.94
Validation accuracy: 41.49
Validation recall: 75.00
Validation precision: 6.49
Validation AUC: 0.37382233330544545
Validation class accuracies: [0.3961605584642234, 0.75]
The validation tracker metric at 0.2777777777777778 hasn't increased by 0 in 1 epochs
Epoch 7/65
162/162 - 234s - loss: 0.2142 - accuracy: 0.8954 - val_loss: 0.2391 - val_accuracy: 0.9273
Confusion matrix: 
 [[542  31]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.406 0.594]]
Validation f1: 46.34
Validation accuracy: 92.73
Validation recall: 59.38
Validation precision: 38.00
Validation AUC: 0.5263027069958135
Validation class accuracies: [0.9458987783595113, 0.59375]
Saving model...
Epoch 8/65
162/162 - 233s - loss: 0.1878 - accuracy: 0.9148 - val_loss: 3.3329 - val_accuracy: 0.3785
Confusion matrix: 
 [[206 367]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.36  0.64 ]
 [0.281 0.719]]
Validation f1: 10.90
Validation accuracy: 37.85
Validation recall: 71.88
Validation precision: 5.90
Validation AUC: 0.1772274123388657
Validation class accuracies: [0.35951134380453753, 0.71875]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 1 epochs
Epoch 9/65
162/162 - 233s - loss: 0.1579 - accuracy: 0.9272 - val_loss: 0.2334 - val_accuracy: 0.9256
Confusion matrix: 
 [[545  28]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.531 0.469]]
Validation f1: 40.00
Validation accuracy: 92.56
Validation recall: 46.88
Validation precision: 34.88
Validation AUC: 0.4455467911413166
Validation class accuracies: [0.9511343804537522, 0.46875]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 2 epochs
Epoch 10/65
162/162 - 233s - loss: 0.1193 - accuracy: 0.9485 - val_loss: 0.2819 - val_accuracy: 0.9322
Confusion matrix: 
 [[554  19]
 [ 22  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.688 0.312]]
Validation f1: 32.79
Validation accuracy: 93.22
Validation recall: 31.25
Validation precision: 34.48
Validation AUC: 0.29683545866724803
Validation class accuracies: [0.9668411867364747, 0.3125]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 3 epochs
Epoch 11/65
162/162 - 233s - loss: 0.1341 - accuracy: 0.9376 - val_loss: 0.4097 - val_accuracy: 0.8826
Confusion matrix: 
 [[515  58]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.406 0.594]]
Validation f1: 34.86
Validation accuracy: 88.26
Validation recall: 59.38
Validation precision: 24.68
Validation AUC: 0.5243100616351541
Validation class accuracies: [0.8987783595113438, 0.59375]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 4 epochs
Epoch 12/65
162/162 - 234s - loss: 0.1019 - accuracy: 0.9524 - val_loss: 0.2158 - val_accuracy: 0.9421
Confusion matrix: 
 [[562  11]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.75  0.25 ]]
Validation f1: 31.37
Validation accuracy: 94.21
Validation recall: 25.00
Validation precision: 42.11
Validation AUC: 0.28292997451549545
Validation class accuracies: [0.9808027923211169, 0.25]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 5 epochs
Epoch 13/65
162/162 - 233s - loss: 0.1460 - accuracy: 0.9357 - val_loss: 0.6405 - val_accuracy: 0.7570
Confusion matrix: 
 [[443 130]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.531 0.469]]
Validation f1: 16.95
Validation accuracy: 75.70
Validation recall: 46.88
Validation precision: 10.34
Validation AUC: 0.17616805337372113
Validation class accuracies: [0.7731239092495636, 0.46875]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 14/65
162/162 - 233s - loss: 0.1057 - accuracy: 0.9562 - val_loss: 0.2987 - val_accuracy: 0.9008
Confusion matrix: 
 [[530  43]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.531 0.469]]
Validation f1: 33.33
Validation accuracy: 90.08
Validation recall: 46.88
Validation precision: 25.86
Validation AUC: 0.3981033740750251
Validation class accuracies: [0.924956369982548, 0.46875]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 7 epochs
Epoch 15/65
162/162 - 233s - loss: 0.0608 - accuracy: 0.9744 - val_loss: 0.2253 - val_accuracy: 0.9355
Confusion matrix: 
 [[551  22]
 [ 17  15]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.531 0.469]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.48
Validation accuracy: 93.55
Validation recall: 46.88
Validation precision: 40.54
Validation AUC: 0.38031368747577204
Validation class accuracies: [0.9616055846422339, 0.46875]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 8 epochs
Epoch 16/65
162/162 - 233s - loss: 0.0612 - accuracy: 0.9713 - val_loss: 0.1937 - val_accuracy: 0.9537
Confusion matrix: 
 [[568   5]
 [ 23   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.719 0.281]]
Validation f1: 39.13
Validation accuracy: 95.37
Validation recall: 28.12
Validation precision: 64.29
Validation AUC: 0.38498534796083783
Validation class accuracies: [0.9912739965095986, 0.28125]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 9 epochs
Epoch 17/65
162/162 - 233s - loss: 0.1005 - accuracy: 0.9547 - val_loss: 0.3113 - val_accuracy: 0.9438
Confusion matrix: 
 [[571   2]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 94.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.11973519239717548
Validation class accuracies: [0.9965095986038395, 0.0]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 10 epochs
Epoch 18/65
162/162 - 233s - loss: 0.0715 - accuracy: 0.9713 - val_loss: 0.5906 - val_accuracy: 0.8231
Confusion matrix: 
 [[476  97]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.831 0.169]
 [0.312 0.688]]
Validation f1: 29.14
Validation accuracy: 82.31
Validation recall: 68.75
Validation precision: 18.49
Validation AUC: 0.4907111252846057
Validation class accuracies: [0.8307155322862129, 0.6875]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 11 epochs
Epoch 19/65
162/162 - 233s - loss: 0.0724 - accuracy: 0.9667 - val_loss: 0.2683 - val_accuracy: 0.9488
Confusion matrix: 
 [[571   2]
 [ 29   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.906 0.094]]
Validation f1: 16.22
Validation accuracy: 94.88
Validation recall: 9.38
Validation precision: 60.00
Validation AUC: 0.2101025327554883
Validation class accuracies: [0.9965095986038395, 0.09375]
The validation tracker metric at 0.46341463414634143 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 20/65
162/162 - 233s - loss: 0.0574 - accuracy: 0.9682 - val_loss: 0.1952 - val_accuracy: 0.9587
Confusion matrix: 
 [[569   4]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.656 0.344]]
Validation f1: 46.81
Validation accuracy: 95.87
Validation recall: 34.38
Validation precision: 73.33
Validation AUC: 0.4622637366216625
Validation class accuracies: [0.9930191972076788, 0.34375]
Saving model...
Epoch 21/65
162/162 - 233s - loss: 0.0403 - accuracy: 0.9822 - val_loss: 0.1853 - val_accuracy: 0.9537
Confusion matrix: 
 [[568   5]
 [ 23   9]]
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.719 0.281]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 39.13
Validation accuracy: 95.37
Validation recall: 28.12
Validation precision: 64.29
Validation AUC: 0.45540121714220855
Validation class accuracies: [0.9912739965095986, 0.28125]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 1 epochs
Epoch 22/65
162/162 - 234s - loss: 0.0350 - accuracy: 0.9845 - val_loss: 0.2145 - val_accuracy: 0.9421
Confusion matrix: 
 [[558  15]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.625 0.375]]
Validation f1: 40.68
Validation accuracy: 94.21
Validation recall: 37.50
Validation precision: 44.44
Validation AUC: 0.3984874095431204
Validation class accuracies: [0.9738219895287958, 0.375]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 2 epochs
Epoch 23/65
162/162 - 234s - loss: 0.0269 - accuracy: 0.9895 - val_loss: 0.1897 - val_accuracy: 0.9488
Confusion matrix: 
 [[562  11]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.625 0.375]]
Validation f1: 43.64
Validation accuracy: 94.88
Validation recall: 37.50
Validation precision: 52.17
Validation AUC: 0.4499835830902881
Validation class accuracies: [0.9808027923211169, 0.375]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 3 epochs
Epoch 24/65
162/162 - 233s - loss: 0.0300 - accuracy: 0.9861 - val_loss: 0.2361 - val_accuracy: 0.9521
Confusion matrix: 
 [[572   1]
 [ 28   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.875 0.125]]
Validation f1: 21.62
Validation accuracy: 95.21
Validation recall: 12.50
Validation precision: 80.00
Validation AUC: 0.3636851702774409
Validation class accuracies: [0.9982547993019197, 0.125]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 4 epochs
Epoch 25/65
162/162 - 233s - loss: 0.0227 - accuracy: 0.9919 - val_loss: 0.2146 - val_accuracy: 0.9488
Confusion matrix: 
 [[568   5]
 [ 26   6]]
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.812 0.188]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.91
Validation accuracy: 94.88
Validation recall: 18.75
Validation precision: 54.55
Validation AUC: 0.33171948041374727
Validation class accuracies: [0.9912739965095986, 0.1875]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 5 epochs
Epoch 26/65
162/162 - 234s - loss: 0.0260 - accuracy: 0.9880 - val_loss: 0.2459 - val_accuracy: 0.9504
Confusion matrix: 
 [[569   4]
 [ 26   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.812 0.188]]
Validation f1: 28.57
Validation accuracy: 95.04
Validation recall: 18.75
Validation precision: 60.00
Validation AUC: 0.3253065013432518
Validation class accuracies: [0.9930191972076788, 0.1875]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 27/65
162/162 - 234s - loss: 0.0282 - accuracy: 0.9880 - val_loss: 0.2102 - val_accuracy: 0.9372
Confusion matrix: 
 [[555  18]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.625 0.375]]
Validation f1: 38.71
Validation accuracy: 93.72
Validation recall: 37.50
Validation precision: 40.00
Validation AUC: 0.42253954795675175
Validation class accuracies: [0.9685863874345549, 0.375]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 7 epochs
Epoch 28/65
162/162 - 233s - loss: 0.0229 - accuracy: 0.9907 - val_loss: 0.2069 - val_accuracy: 0.9537
Confusion matrix: 
 [[567   6]
 [ 22  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.688 0.312]]
Validation f1: 41.67
Validation accuracy: 95.37
Validation recall: 31.25
Validation precision: 62.50
Validation AUC: 0.4267684377990595
Validation class accuracies: [0.9895287958115183, 0.3125]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 8 epochs
Epoch 29/65
162/162 - 233s - loss: 0.0180 - accuracy: 0.9915 - val_loss: 0.2239 - val_accuracy: 0.9504
Confusion matrix: 
 [[568   5]
 [ 25   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.781 0.219]]
Validation f1: 31.82
Validation accuracy: 95.04
Validation recall: 21.88
Validation precision: 58.33
Validation AUC: 0.33842158042234893
Validation class accuracies: [0.9912739965095986, 0.21875]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 9 epochs
Epoch 30/65
162/162 - 233s - loss: 0.0373 - accuracy: 0.9880 - val_loss: 0.2256 - val_accuracy: 0.9421
Confusion matrix: 
 [[557  16]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.594 0.406]]
Validation f1: 42.62
Validation accuracy: 94.21
Validation recall: 40.62
Validation precision: 44.83
Validation AUC: 0.39483430979174466
Validation class accuracies: [0.9720767888307156, 0.40625]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 10 epochs
Epoch 31/65
162/162 - 233s - loss: 0.0374 - accuracy: 0.9857 - val_loss: 0.2490 - val_accuracy: 0.9405
Confusion matrix: 
 [[555  18]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.562 0.438]]
Validation f1: 43.75
Validation accuracy: 94.05
Validation recall: 43.75
Validation precision: 43.75
Validation AUC: 0.4561355719675241
Validation class accuracies: [0.9685863874345549, 0.4375]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 11 epochs
Epoch 32/65
162/162 - 233s - loss: 0.0183 - accuracy: 0.9895 - val_loss: 0.2502 - val_accuracy: 0.9388
Confusion matrix: 
 [[557  16]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.656 0.344]]
Validation f1: 37.29
Validation accuracy: 93.88
Validation recall: 34.38
Validation precision: 40.74
Validation AUC: 0.3167714239688323
Validation class accuracies: [0.9720767888307156, 0.34375]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 33/65
162/162 - 233s - loss: 0.0169 - accuracy: 0.9942 - val_loss: 0.2304 - val_accuracy: 0.9488
Confusion matrix: 
 [[565   8]
 [ 23   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.719 0.281]]
Validation f1: 36.73
Validation accuracy: 94.88
Validation recall: 28.12
Validation precision: 52.94
Validation AUC: 0.36334259330114704
Validation class accuracies: [0.9860383944153578, 0.28125]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 13 epochs
Epoch 34/65
162/162 - 233s - loss: 0.0172 - accuracy: 0.9946 - val_loss: 0.2128 - val_accuracy: 0.9537
Confusion matrix: 
 [[567   6]
 [ 22  10]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.688 0.312]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.67
Validation accuracy: 95.37
Validation recall: 31.25
Validation precision: 62.50
Validation AUC: 0.43455598297037834
Validation class accuracies: [0.9895287958115183, 0.3125]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 14 epochs
Epoch 35/65
162/162 - 233s - loss: 0.0130 - accuracy: 0.9946 - val_loss: 0.2092 - val_accuracy: 0.9521
Confusion matrix: 
 [[564   9]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.625 0.375]]
Validation f1: 45.28
Validation accuracy: 95.21
Validation recall: 37.50
Validation precision: 57.14
Validation AUC: 0.43899545152267977
Validation class accuracies: [0.9842931937172775, 0.375]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 15 epochs
Epoch 36/65
162/162 - 233s - loss: 0.0133 - accuracy: 0.9954 - val_loss: 0.2220 - val_accuracy: 0.9504
Confusion matrix: 
 [[565   8]
 [ 22  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.688 0.312]]
Validation f1: 40.00
Validation accuracy: 95.04
Validation recall: 31.25
Validation precision: 55.56
Validation AUC: 0.3845297957965491
Validation class accuracies: [0.9860383944153578, 0.3125]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 16 epochs
Epoch 37/65
162/162 - 233s - loss: 0.0122 - accuracy: 0.9950 - val_loss: 0.2151 - val_accuracy: 0.9537
Confusion matrix: 
 [[567   6]
 [ 22  10]]
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.688 0.312]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.67
Validation accuracy: 95.37
Validation recall: 31.25
Validation precision: 62.50
Validation AUC: 0.42335813734895344
Validation class accuracies: [0.9895287958115183, 0.3125]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 17 epochs
Epoch 38/65
162/162 - 233s - loss: 0.0129 - accuracy: 0.9950 - val_loss: 0.2283 - val_accuracy: 0.9537
Confusion matrix: 
 [[569   4]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.75  0.25 ]]
Validation f1: 36.36
Validation accuracy: 95.37
Validation recall: 25.00
Validation precision: 66.67
Validation AUC: 0.3854133147431739
Validation class accuracies: [0.9930191972076788, 0.25]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 39/65
162/162 - 233s - loss: 0.0091 - accuracy: 0.9977 - val_loss: 0.2273 - val_accuracy: 0.9537
Confusion matrix: 
 [[569   4]
 [ 24   8]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.75  0.25 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.36
Validation accuracy: 95.37
Validation recall: 25.00
Validation precision: 66.67
Validation AUC: 0.37914448547978935
Validation class accuracies: [0.9930191972076788, 0.25]
The validation tracker metric at 0.4680851063829787 hasn't increased by 0 in 19 epochs
Epoch 40/65
162/162 - 233s - loss: 0.0118 - accuracy: 0.9969 - val_loss: 0.2263 - val_accuracy: 0.9554
Confusion matrix: 
 [[569   4]
 [ 23   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.719 0.281]]
Validation f1: 40.00
Validation accuracy: 95.54
Validation recall: 28.12
Validation precision: 69.23
Validation AUC: 0.39562379966077227
Validation class accuracies: [0.9930191972076788, 0.28125]

The metrics for job 0 with the best target metric are: 
Best cm: [[569   4]
 [ 21  11]]
Best normalized cm: [[0.993 0.007]
 [0.656 0.344]]
Best f1: 0.47
Best accuracy: 0.96
Best recall: 0.34
Best precision: 0.73
Best AUC: 0.46
Best class accuracies: [0.9930191972076788, 0.34375]
Best epoch: 20
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 11804
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_162959-29o9a7lo/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_162959-29o9a7lo/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9969
wandb:         val_accuracy 0.95537
wandb:             _runtime 9888
wandb:           _timestamp 1623870887
wandb:                _step 291
wandb:           train_loss 0.01177
wandb:             val_loss 0.22633
wandb:           val_recall 0.28125
wandb:        val_precision 0.69231
wandb:               val_f1 0.4
wandb:              val_auc 0.39562
wandb:                   lr 3e-05
wandb:          best_val_f1 0.46809
wandb:    best_val_accuracy 0.95868
wandb:   best_val_precision 0.73333
wandb:      best_val_recall 0.34375
wandb:             best_auc 0.46226
wandb:           best_epoch 20
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_162959-29o9a7lo


 See logs at ../../new_cache/conv__2226__06_1629__v39__v43/logs/