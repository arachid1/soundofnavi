Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2262
Description:  augmented_mod9
2021-06-28 02:18:53.028669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-28 02:18:55.260559: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-28 02:18:55.261545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-28 02:18:55.309279: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:18:55.310045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-28 02:18:55.310076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 02:18:55.313695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 02:18:55.313787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-28 02:18:55.314910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-28 02:18:55.315246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-28 02:18:55.316265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-28 02:18:55.317208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-28 02:18:55.317381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 02:18:55.317493: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:18:55.318273: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:18:55.318997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2262.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2262__06_0215__v39__augmented_mod9
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-28 02:19:00.198415: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-28 02:19:00.198679: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:19:00.199548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-28 02:19:00.199600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 02:19:00.199658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 02:19:00.199681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-28 02:19:00.199703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-28 02:19:00.199725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-28 02:19:00.199747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-28 02:19:00.199773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-28 02:19:00.199794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 02:19:00.199902: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:19:00.200695: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:19:00.201388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-28 02:19:00.201433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 02:19:00.917938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-28 02:19:00.917999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-28 02:19:00.918008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-28 02:19:00.918288: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:19:00.919209: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:19:00.920027: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:19:00.920836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3174
-----------------------
Number of train recordings: 3174 with pneumonia: 474 and non-pneumonia: 2700
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-28 02:19:02.263271: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-28 02:19:02.265230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-28 02:19:02.610276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 02:19:04.493028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 02:19:04.961124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
199/199 - 305s - loss: 1.0626 - accuracy: 0.5239 - val_loss: 1.9853 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.08132165811936055
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
199/199 - 299s - loss: 0.6638 - accuracy: 0.6285 - val_loss: 0.5152 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3758662121766684
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
199/199 - 300s - loss: 0.5451 - accuracy: 0.6919 - val_loss: 0.7865 - val_accuracy: 0.6336
Confusion matrix: 
 [[352 221]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.614 0.386]
 [0.098 0.902]]
Validation f1: 24.75
Validation accuracy: 63.36
Validation recall: 90.24
Validation precision: 14.34
Validation AUC: 0.502551900466693
Validation class accuracies: [0.6143106457242583, 0.9024390243902439]
Saving model...
Epoch 4/65
199/199 - 300s - loss: 0.4968 - accuracy: 0.7489 - val_loss: 0.4755 - val_accuracy: 0.7687
Confusion matrix: 
 [[434 139]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.757 0.243]
 [0.073 0.927]]
Validation f1: 34.86
Validation accuracy: 76.87
Validation recall: 92.68
Validation precision: 21.47
Validation AUC: 0.3949409382829353
Validation class accuracies: [0.7574171029668412, 0.926829268292683]
Saving model...
Epoch 5/65
199/199 - 300s - loss: 0.5531 - accuracy: 0.7174 - val_loss: 2.2622 - val_accuracy: 0.4316
Confusion matrix: 
 [[224 349]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.391 0.609]
 [0.    1.   ]]
Validation f1: 19.03
Validation accuracy: 43.16
Validation recall: 100.00
Validation precision: 10.51
Validation AUC: 0.5114123555650447
Validation class accuracies: [0.39092495636998253, 1.0]
The validation tracker metric at 0.3486238532110092 hasn't increased by 0 in 1 epochs
Epoch 6/65
199/199 - 300s - loss: 0.3686 - accuracy: 0.7943 - val_loss: 1.5015 - val_accuracy: 0.5928
Confusion matrix: 
 [[323 250]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.564 0.436]
 [0.    1.   ]]
Validation f1: 24.70
Validation accuracy: 59.28
Validation recall: 100.00
Validation precision: 14.09
Validation AUC: 0.3160922605355141
Validation class accuracies: [0.5636998254799301, 1.0]
The validation tracker metric at 0.3486238532110092 hasn't increased by 0 in 2 epochs
Epoch 7/65
199/199 - 300s - loss: 0.3812 - accuracy: 0.7990 - val_loss: 0.6262 - val_accuracy: 0.7785
Confusion matrix: 
 [[448 125]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.782 0.218]
 [0.268 0.732]]
Validation f1: 30.61
Validation accuracy: 77.85
Validation recall: 73.17
Validation precision: 19.35
Validation AUC: 0.4901170587628814
Validation class accuracies: [0.7818499127399651, 0.7317073170731707]
The validation tracker metric at 0.3486238532110092 hasn't increased by 0 in 3 epochs
Epoch 8/65
199/199 - 300s - loss: 0.3456 - accuracy: 0.8330 - val_loss: 3.1561 - val_accuracy: 0.5000
Confusion matrix: 
 [[266 307]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.464 0.536]
 [0.    1.   ]]
Validation f1: 21.08
Validation accuracy: 50.00
Validation recall: 100.00
Validation precision: 11.78
Validation AUC: 0.09469393087138471
Validation class accuracies: [0.4642233856893543, 1.0]
The validation tracker metric at 0.3486238532110092 hasn't increased by 0 in 4 epochs
Epoch 9/65
199/199 - 300s - loss: 0.3092 - accuracy: 0.8485 - val_loss: 1.2166 - val_accuracy: 0.5016
Confusion matrix: 
 [[268 305]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.468 0.532]
 [0.024 0.976]]
Validation f1: 20.73
Validation accuracy: 50.16
Validation recall: 97.56
Validation precision: 11.59
Validation AUC: 0.653846999312836
Validation class accuracies: [0.4677137870855148, 0.975609756097561]
The validation tracker metric at 0.3486238532110092 hasn't increased by 0 in 5 epochs
Epoch 10/65
199/199 - 301s - loss: 0.2117 - accuracy: 0.8869 - val_loss: 0.2346 - val_accuracy: 0.9511
Confusion matrix: 
 [[562  11]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.463 0.537]]
Validation f1: 59.46
Validation accuracy: 95.11
Validation recall: 53.66
Validation precision: 66.67
Validation AUC: 0.585625166516428
Validation class accuracies: [0.9808027923211169, 0.5365853658536586]
Saving model...
Epoch 11/65
199/199 - 301s - loss: 0.4107 - accuracy: 0.8283 - val_loss: 1.6206 - val_accuracy: 0.3664
Confusion matrix: 
 [[184 389]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.321 0.679]
 [0.    1.   ]]
Validation f1: 17.41
Validation accuracy: 36.64
Validation recall: 100.00
Validation precision: 9.53
Validation AUC: 0.42143101050496184
Validation class accuracies: [0.32111692844677137, 1.0]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 1 epochs
Epoch 12/65
199/199 - 300s - loss: 0.2705 - accuracy: 0.8648 - val_loss: 1.7358 - val_accuracy: 0.4723
Confusion matrix: 
 [[249 324]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.435 0.565]
 [0.    1.   ]]
Validation f1: 20.20
Validation accuracy: 47.23
Validation recall: 100.00
Validation precision: 11.23
Validation AUC: 0.6794351434547105
Validation class accuracies: [0.43455497382198954, 1.0]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 2 epochs
Epoch 13/65
199/199 - 300s - loss: 0.2033 - accuracy: 0.8907 - val_loss: 0.2005 - val_accuracy: 0.9300
Confusion matrix: 
 [[545  28]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.366 0.634]]
Validation f1: 54.74
Validation accuracy: 93.00
Validation recall: 63.41
Validation precision: 48.15
Validation AUC: 0.6979966996293524
Validation class accuracies: [0.9511343804537522, 0.6341463414634146]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 3 epochs
Epoch 14/65
199/199 - 300s - loss: 0.2069 - accuracy: 0.8992 - val_loss: 0.5248 - val_accuracy: 0.8176
Confusion matrix: 
 [[467 106]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.815 0.185]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.46
Validation accuracy: 81.76
Validation recall: 85.37
Validation precision: 24.82
Validation AUC: 0.5576363816592982
Validation class accuracies: [0.8150087260034904, 0.8536585365853658]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 4 epochs
Epoch 15/65
199/199 - 300s - loss: 0.1594 - accuracy: 0.9168 - val_loss: 0.6791 - val_accuracy: 0.7606
Confusion matrix: 
 [[434 139]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.757 0.243]
 [0.195 0.805]]
Validation f1: 30.99
Validation accuracy: 76.06
Validation recall: 80.49
Validation precision: 19.19
Validation AUC: 0.5674648238930027
Validation class accuracies: [0.7574171029668412, 0.8048780487804879]
The validation tracker metric at 0.5945945945945946 hasn't increased by 0 in 5 epochs
Epoch 16/65
199/199 - 300s - loss: 0.1559 - accuracy: 0.9260 - val_loss: 0.2033 - val_accuracy: 0.9381
Confusion matrix: 
 [[548  25]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.317 0.683]]
Validation f1: 59.57
Validation accuracy: 93.81
Validation recall: 68.29
Validation precision: 52.83
Validation AUC: 0.7011074651916507
Validation class accuracies: [0.956369982547993, 0.6829268292682927]
Saving model...
Epoch 17/65
199/199 - 300s - loss: 0.0951 - accuracy: 0.9512 - val_loss: 0.9738 - val_accuracy: 0.7980
Confusion matrix: 
 [[452 121]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.073 0.927]]
Validation f1: 38.00
Validation accuracy: 79.80
Validation recall: 92.68
Validation precision: 23.90
Validation AUC: 0.5787573532760428
Validation class accuracies: [0.7888307155322862, 0.926829268292683]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 1 epochs
Epoch 18/65
199/199 - 300s - loss: 0.1499 - accuracy: 0.9342 - val_loss: 1.4890 - val_accuracy: 0.6678
Confusion matrix: 
 [[370 203]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.646 0.354]
 [0.024 0.976]]
Validation f1: 28.17
Validation accuracy: 66.78
Validation recall: 97.56
Validation precision: 16.46
Validation AUC: 0.6140086782535472
Validation class accuracies: [0.6457242582897034, 0.975609756097561]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 2 epochs
Epoch 19/65
199/199 - 301s - loss: 0.1416 - accuracy: 0.9323 - val_loss: 0.2943 - val_accuracy: 0.9186
Confusion matrix: 
 [[533  40]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.244 0.756]]
Validation f1: 55.36
Validation accuracy: 91.86
Validation recall: 75.61
Validation precision: 43.66
Validation AUC: 0.6391026495849205
Validation class accuracies: [0.9301919720767888, 0.7560975609756098]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 3 epochs
Epoch 20/65
199/199 - 301s - loss: 0.0967 - accuracy: 0.9556 - val_loss: 1.3467 - val_accuracy: 0.6645
Confusion matrix: 
 [[374 199]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.653 0.347]
 [0.171 0.829]]
Validation f1: 24.82
Validation accuracy: 66.45
Validation recall: 82.93
Validation precision: 14.59
Validation AUC: 0.22579054074795052
Validation class accuracies: [0.6527050610820244, 0.8292682926829268]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 4 epochs
Epoch 21/65
199/199 - 300s - loss: 0.0580 - accuracy: 0.9720 - val_loss: 0.2618 - val_accuracy: 0.9235
Confusion matrix: 
 [[544  29]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.439 0.561]]
Validation f1: 49.46
Validation accuracy: 92.35
Validation recall: 56.10
Validation precision: 44.23
Validation AUC: 0.5739572830363541
Validation class accuracies: [0.9493891797556719, 0.5609756097560976]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 5 epochs
Epoch 22/65
199/199 - 300s - loss: 0.0334 - accuracy: 0.9836 - val_loss: 0.2611 - val_accuracy: 0.9251
Confusion matrix: 
 [[539  34]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.293 0.707]]
Validation f1: 55.77
Validation accuracy: 92.51
Validation recall: 70.73
Validation precision: 46.03
Validation AUC: 0.7064344455229643
Validation class accuracies: [0.9406631762652705, 0.7073170731707317]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 23/65
199/199 - 300s - loss: 0.0756 - accuracy: 0.9666 - val_loss: 0.4741 - val_accuracy: 0.8583
Confusion matrix: 
 [[494  79]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.195 0.805]]
Validation f1: 43.14
Validation accuracy: 85.83
Validation recall: 80.49
Validation precision: 29.46
Validation AUC: 0.6390506248466103
Validation class accuracies: [0.8621291448516579, 0.8048780487804879]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 7 epochs
Epoch 24/65
199/199 - 300s - loss: 0.0357 - accuracy: 0.9865 - val_loss: 0.2444 - val_accuracy: 0.9365
Confusion matrix: 
 [[548  25]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.341 0.659]]
Validation f1: 58.06
Validation accuracy: 93.65
Validation recall: 65.85
Validation precision: 51.92
Validation AUC: 0.6254500567987201
Validation class accuracies: [0.956369982547993, 0.6585365853658537]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 8 epochs
Epoch 25/65
199/199 - 300s - loss: 0.0506 - accuracy: 0.9805 - val_loss: 0.2200 - val_accuracy: 0.9479
Confusion matrix: 
 [[561  12]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.488 0.512]]
Validation f1: 56.76
Validation accuracy: 94.79
Validation recall: 51.22
Validation precision: 63.64
Validation AUC: 0.6325377188478404
Validation class accuracies: [0.9790575916230366, 0.5121951219512195]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 9 epochs
Epoch 26/65
199/199 - 300s - loss: 0.0339 - accuracy: 0.9868 - val_loss: 0.2407 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6445815942639073
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 10 epochs
Epoch 27/65
199/199 - 300s - loss: 0.0149 - accuracy: 0.9953 - val_loss: 0.2798 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
Validation f1: 56.84
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.6271373556081328
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 11 epochs
Epoch 28/65
199/199 - 300s - loss: 0.0115 - accuracy: 0.9962 - val_loss: 0.3173 - val_accuracy: 0.9202
Confusion matrix: 
 [[537  36]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.317 0.683]]
Validation f1: 53.33
Validation accuracy: 92.02
Validation recall: 68.29
Validation precision: 43.75
Validation AUC: 0.6264010210496126
Validation class accuracies: [0.93717277486911, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 29/65
199/199 - 301s - loss: 0.0126 - accuracy: 0.9956 - val_loss: 0.3643 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.5798027256929303
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 13 epochs
Epoch 30/65
199/199 - 300s - loss: 0.0105 - accuracy: 0.9975 - val_loss: 0.3827 - val_accuracy: 0.9153
Confusion matrix: 
 [[533  40]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.293 0.707]]
Validation f1: 52.73
Validation accuracy: 91.53
Validation recall: 70.73
Validation precision: 42.03
Validation AUC: 0.5789154600593132
Validation class accuracies: [0.9301919720767888, 0.7073170731707317]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 14 epochs
Epoch 31/65
199/199 - 300s - loss: 0.0107 - accuracy: 0.9965 - val_loss: 0.2860 - val_accuracy: 0.9251
Confusion matrix: 
 [[540  33]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.317 0.683]]
Validation f1: 54.90
Validation accuracy: 92.51
Validation recall: 68.29
Validation precision: 45.90
Validation AUC: 0.6270605482295694
Validation class accuracies: [0.9424083769633508, 0.6829268292682927]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 15 epochs
Epoch 32/65
199/199 - 300s - loss: 0.0335 - accuracy: 0.9880 - val_loss: 0.1886 - val_accuracy: 0.9495
Confusion matrix: 
 [[553  20]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.268 0.732]]
Validation f1: 65.93
Validation accuracy: 94.95
Validation recall: 73.17
Validation precision: 60.00
Validation AUC: 0.6953219051978069
Validation class accuracies: [0.9650959860383944, 0.7317073170731707]
Saving model...
Epoch 33/65
199/199 - 300s - loss: 0.0183 - accuracy: 0.9940 - val_loss: 0.2559 - val_accuracy: 0.9349
Confusion matrix: 
 [[545  28]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.293 0.707]]
Validation f1: 59.18
Validation accuracy: 93.49
Validation recall: 70.73
Validation precision: 50.88
Validation AUC: 0.6664974290189292
Validation class accuracies: [0.9511343804537522, 0.7073170731707317]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 1 epochs
Epoch 34/65
199/199 - 300s - loss: 0.0088 - accuracy: 0.9965 - val_loss: 0.2919 - val_accuracy: 0.9251
Confusion matrix: 
 [[540  33]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.90
Validation accuracy: 92.51
Validation recall: 68.29
Validation precision: 45.90
Validation AUC: 0.6762154243199672
Validation class accuracies: [0.9424083769633508, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 2 epochs
Epoch 35/65
199/199 - 300s - loss: 0.0096 - accuracy: 0.9962 - val_loss: 0.2767 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6354457126532739
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 3 epochs
Epoch 36/65
199/199 - 300s - loss: 0.0137 - accuracy: 0.9959 - val_loss: 0.2851 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.84
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.6233586001129878
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 4 epochs
Epoch 37/65
199/199 - 300s - loss: 0.0107 - accuracy: 0.9956 - val_loss: 0.2483 - val_accuracy: 0.9463
Confusion matrix: 
 [[556  17]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97 0.03]
 [0.39 0.61]]
Validation f1: 60.24
Validation accuracy: 94.63
Validation recall: 60.98
Validation precision: 59.52
Validation AUC: 0.6493437382025392
Validation class accuracies: [0.9703315881326352, 0.6097560975609756]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 5 epochs
Epoch 38/65
199/199 - 300s - loss: 0.0066 - accuracy: 0.9984 - val_loss: 0.2608 - val_accuracy: 0.9365
Confusion matrix: 
 [[548  25]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.06
Validation accuracy: 93.65
Validation recall: 65.85
Validation precision: 51.92
Validation AUC: 0.6583202754464187
Validation class accuracies: [0.956369982547993, 0.6585365853658537]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 39/65
199/199 - 300s - loss: 0.0141 - accuracy: 0.9975 - val_loss: 0.2944 - val_accuracy: 0.9300
Confusion matrix: 
 [[543  30]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.317 0.683]]
Validation f1: 56.57
Validation accuracy: 93.00
Validation recall: 68.29
Validation precision: 48.28
Validation AUC: 0.6513442380536486
Validation class accuracies: [0.9476439790575916, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 7 epochs
Epoch 40/65
199/199 - 300s - loss: 0.0045 - accuracy: 0.9994 - val_loss: 0.3060 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6557882225841846
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 8 epochs
Epoch 41/65
199/199 - 300s - loss: 0.0044 - accuracy: 0.9984 - val_loss: 0.2690 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.6660636211491918
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 9 epochs
Epoch 42/65
199/199 - 300s - loss: 0.0050 - accuracy: 0.9987 - val_loss: 0.3085 - val_accuracy: 0.9283
Confusion matrix: 
 [[542  31]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.317 0.683]]
Validation f1: 56.00
Validation accuracy: 92.83
Validation recall: 68.29
Validation precision: 47.46
Validation AUC: 0.658154840668335
Validation class accuracies: [0.9458987783595113, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 10 epochs
Epoch 43/65
199/199 - 300s - loss: 0.0039 - accuracy: 0.9994 - val_loss: 0.3016 - val_accuracy: 0.9300
Confusion matrix: 
 [[543  30]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.57
Validation accuracy: 93.00
Validation recall: 68.29
Validation precision: 48.28
Validation AUC: 0.649189561153892
Validation class accuracies: [0.9476439790575916, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 11 epochs
Epoch 44/65
199/199 - 300s - loss: 0.0051 - accuracy: 0.9994 - val_loss: 0.2822 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6429497073639666
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 45/65
199/199 - 300s - loss: 0.0046 - accuracy: 0.9984 - val_loss: 0.3121 - val_accuracy: 0.9283
Confusion matrix: 
 [[541  32]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.293 0.707]]
Validation f1: 56.86
Validation accuracy: 92.83
Validation recall: 70.73
Validation precision: 47.54
Validation AUC: 0.6518240771104129
Validation class accuracies: [0.944153577661431, 0.7073170731707317]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 13 epochs
Epoch 46/65
199/199 - 300s - loss: 0.0040 - accuracy: 0.9994 - val_loss: 0.2909 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.659615831894955
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 14 epochs
Epoch 47/65
199/199 - 300s - loss: 0.0041 - accuracy: 0.9994 - val_loss: 0.3010 - val_accuracy: 0.9283
Confusion matrix: 
 [[542  31]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.00
Validation accuracy: 92.83
Validation recall: 68.29
Validation precision: 47.46
Validation AUC: 0.6585815017748818
Validation class accuracies: [0.9458987783595113, 0.6829268292682927]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 15 epochs
Epoch 48/65
199/199 - 300s - loss: 0.0049 - accuracy: 0.9984 - val_loss: 0.2840 - val_accuracy: 0.9300
Confusion matrix: 
 [[542  31]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.293 0.707]]
Validation f1: 57.43
Validation accuracy: 93.00
Validation recall: 70.73
Validation precision: 48.33
Validation AUC: 0.6573353283782798
Validation class accuracies: [0.9458987783595113, 0.7073170731707317]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 16 epochs
Epoch 49/65
199/199 - 300s - loss: 0.0036 - accuracy: 0.9997 - val_loss: 0.2831 - val_accuracy: 0.9316
Confusion matrix: 
 [[546  27]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.366 0.634]]
Validation f1: 55.32
Validation accuracy: 93.16
Validation recall: 63.41
Validation precision: 49.06
Validation AUC: 0.6429822482948732
Validation class accuracies: [0.9528795811518325, 0.6341463414634146]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 17 epochs
Epoch 50/65
199/199 - 301s - loss: 0.0048 - accuracy: 0.9997 - val_loss: 0.3001 - val_accuracy: 0.9251
Confusion matrix: 
 [[541  32]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.00
Validation accuracy: 92.51
Validation recall: 65.85
Validation precision: 45.76
Validation AUC: 0.6530515726230963
Validation class accuracies: [0.944153577661431, 0.6585365853658537]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 51/65
199/199 - 300s - loss: 0.0028 - accuracy: 0.9997 - val_loss: 0.3026 - val_accuracy: 0.9251
Confusion matrix: 
 [[541  32]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.341 0.659]]
Validation f1: 54.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.51
Validation recall: 65.85
Validation precision: 45.76
Validation AUC: 0.6539810324507436
Validation class accuracies: [0.944153577661431, 0.6585365853658537]
The validation tracker metric at 0.6593406593406594 hasn't increased by 0 in 19 epochs
Epoch 52/65
199/199 - 300s - loss: 0.0048 - accuracy: 0.9997 - val_loss: 0.3289 - val_accuracy: 0.9283
Confusion matrix: 
 [[541  32]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.86
Validation accuracy: 92.83
Validation recall: 70.73
Validation precision: 47.54
Validation AUC: 0.6470156659431149
Validation class accuracies: [0.944153577661431, 0.7073170731707317]

The metrics for job 0 with the best target metric are: 
Best cm: [[553  20]
 [ 11  30]]
Best normalized cm: [[0.965 0.035]
 [0.268 0.732]]
Best f1: 0.66
Best accuracy: 0.95
Best recall: 0.73
Best precision: 0.60
Best AUC: 0.70
Best class accuracies: [0.9650959860383944, 0.7317073170731707]
Best epoch: 32
The number of epochs since last 1% equals the patience
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.026]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.167]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.051]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[2.447e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[7.639e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[3.819e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[8.154e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[8.295e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.873]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[5.007e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.66e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[2.15e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_1.png, [[0.873]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[6.807e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[7.631e-07]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[1.962e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.499e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[7.999e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.314]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_1.png, [[0.583]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.174]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 20531
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_021855-3cya8by5/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_021855-3cya8by5/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99968
wandb:         val_accuracy 0.92834
wandb:             _runtime 16367
wandb:           _timestamp 1624863103
wandb:                _step 381
wandb:           train_loss 0.00481
wandb:             val_loss 0.32886
wandb:           val_recall 0.70732
wandb:        val_precision 0.47541
wandb:               val_f1 0.56863
wandb:              val_auc 0.64702
wandb:                   lr 3e-05
wandb:          best_val_f1 0.65934
wandb:    best_val_accuracy 0.94951
wandb:   best_val_precision 0.6
wandb:      best_val_recall 0.73171
wandb:             best_auc 0.69532
wandb:           best_epoch 32
wandb: Run history:
wandb:   train_accuracy ▁▃▃▄▅▅▆▆▅▆▇▇▇▇▇▇████████████████████████
wandb:     val_accuracy ▁█▅▇▅▇▄█▃▄▇▆█▆█▆█▇██████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▄▃▃▃▂▄▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▅▂▂▂▄▂█▁▄▅▂▂▁▄▁▄▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall █▁▇▇█▆█▅██▇▇▆█▆▇▅▇▆▅▆▆▆▆▆▆▆▆▅▆▆▆▆▅▆▆▆▅▆▆
wandb:    val_precision ▂▁▃▃▂▃▂█▂▂▄▃▇▃▆▃▆▄▆█▆▆▆▆▇▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_f1 ▂▁▄▅▄▄▃▇▃▃▅▄▇▄▇▄▆▆▇▇▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▄▆▅▄▆▁▇▅█▆▆█▇▇▃▇▇▇▇▇▇▇▇██▇▇▇█▇██▇▇██▇▇▇
wandb:               lr █████████████████▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▂▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_021855-3cya8by5

-----------------------
New wav quantity for label 0: 500
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3774
-----------------------
Number of train recordings: 3774 with pneumonia: 474 and non-pneumonia: 3300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 64, 625, 48)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 64, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 32, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 16, 156, 128)    91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 8, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 4, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
236/236 - 356s - loss: 0.9285 - accuracy: 0.5808 - val_loss: 0.2564 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.10641653216869165
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
236/236 - 354s - loss: 0.5521 - accuracy: 0.6934 - val_loss: 0.3623 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.13159316383736497
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
236/236 - 353s - loss: 0.5162 - accuracy: 0.7318 - val_loss: 0.2857 - val_accuracy: 0.9169
Confusion matrix: 
 [[550  23]
 [ 28  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.683 0.317]]
Validation f1: 33.77
Validation accuracy: 91.69
Validation recall: 31.71
Validation precision: 36.11
Validation AUC: 0.3343563014794482
Validation class accuracies: [0.9598603839441536, 0.3170731707317073]
Saving model...
Epoch 4/65
236/236 - 354s - loss: 0.4794 - accuracy: 0.7483 - val_loss: 1.4512 - val_accuracy: 0.4023
Confusion matrix: 
 [[208 365]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.363 0.637]
 [0.049 0.951]]
Validation f1: 17.53
Validation accuracy: 40.23
Validation recall: 95.12
Validation precision: 9.65
Validation AUC: 0.47577156731044246
Validation class accuracies: [0.36300174520069806, 0.9512195121951219]
The validation tracker metric at 0.33766233766233766 hasn't increased by 0 in 1 epochs
Epoch 5/65
236/236 - 353s - loss: 0.4120 - accuracy: 0.7933 - val_loss: 1.4232 - val_accuracy: 0.5847
Confusion matrix: 
 [[320 253]
 [  2  39]]
Normalized Confusion matrix: 
 [[0.558 0.442]
 [0.049 0.951]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.42
Validation accuracy: 58.47
Validation recall: 95.12
Validation precision: 13.36
Validation AUC: 0.3460074909387547
Validation class accuracies: [0.5584642233856894, 0.9512195121951219]
The validation tracker metric at 0.33766233766233766 hasn't increased by 0 in 2 epochs
Epoch 6/65
236/236 - 353s - loss: 0.3904 - accuracy: 0.8108 - val_loss: 2.8565 - val_accuracy: 0.3485
Confusion matrix: 
 [[173 400]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.302 0.698]
 [0.    1.   ]]
Validation f1: 17.01
Validation accuracy: 34.85
Validation recall: 100.00
Validation precision: 9.30
Validation AUC: 0.09827506781672801
Validation class accuracies: [0.3019197207678883, 1.0]
The validation tracker metric at 0.33766233766233766 hasn't increased by 0 in 3 epochs
Epoch 7/65
236/236 - 354s - loss: 0.3375 - accuracy: 0.8270 - val_loss: 0.2867 - val_accuracy: 0.8730
Confusion matrix: 
 [[506  67]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.268 0.732]]
Validation f1: 43.48
Validation accuracy: 87.30
Validation recall: 73.17
Validation precision: 30.93
Validation AUC: 0.5319720544286366
Validation class accuracies: [0.8830715532286213, 0.7317073170731707]
Saving model...
Epoch 8/65
236/236 - 354s - loss: 0.2759 - accuracy: 0.8733 - val_loss: 1.8001 - val_accuracy: 0.5505
Confusion matrix: 
 [[297 276]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.518 0.482]
 [0.    1.   ]]
Validation f1: 22.91
Validation accuracy: 55.05
Validation recall: 100.00
Validation precision: 12.93
Validation AUC: 0.5374777891902147
Validation class accuracies: [0.518324607329843, 1.0]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 1 epochs
Epoch 9/65
236/236 - 354s - loss: 0.3334 - accuracy: 0.8482 - val_loss: 1.2739 - val_accuracy: 0.5912
Confusion matrix: 
 [[329 244]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.574 0.426]
 [0.171 0.829]]
Validation f1: 21.32
Validation accuracy: 59.12
Validation recall: 82.93
Validation precision: 12.23
Validation AUC: 0.49447313204670107
Validation class accuracies: [0.5741710296684118, 0.8292682926829268]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 2 epochs
Epoch 10/65
236/236 - 353s - loss: 0.2199 - accuracy: 0.8831 - val_loss: 0.2658 - val_accuracy: 0.8876
Confusion matrix: 
 [[527  46]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.561 0.439]]
Validation f1: 34.29
Validation accuracy: 88.76
Validation recall: 43.90
Validation precision: 28.12
Validation AUC: 0.365731399460362
Validation class accuracies: [0.9197207678883071, 0.43902439024390244]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 3 epochs
Epoch 11/65
236/236 - 353s - loss: 0.2572 - accuracy: 0.8882 - val_loss: 1.8377 - val_accuracy: 0.5782
Confusion matrix: 
 [[315 258]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.55  0.45 ]
 [0.024 0.976]]
Validation f1: 23.60
Validation accuracy: 57.82
Validation recall: 97.56
Validation precision: 13.42
Validation AUC: 0.22529706665464314
Validation class accuracies: [0.5497382198952879, 0.975609756097561]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 4 epochs
Epoch 12/65
236/236 - 353s - loss: 0.1910 - accuracy: 0.9102 - val_loss: 0.5475 - val_accuracy: 0.8550
Confusion matrix: 
 [[493  80]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86 0.14]
 [0.22 0.78]]
Validation f1: 41.83
Validation accuracy: 85.50
Validation recall: 78.05
Validation precision: 28.57
Validation AUC: 0.6647488864170028
Validation class accuracies: [0.8603839441535777, 0.7804878048780488]
The validation tracker metric at 0.43478260869565216 hasn't increased by 0 in 5 epochs
Epoch 13/65
236/236 - 353s - loss: 0.1673 - accuracy: 0.9208 - val_loss: 0.2114 - val_accuracy: 0.9446
Confusion matrix: 
 [[557  16]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.439 0.561]]
Validation f1: 57.50
Validation accuracy: 94.46
Validation recall: 56.10
Validation precision: 58.97
Validation AUC: 0.661561011173258
Validation class accuracies: [0.9720767888307156, 0.5609756097560976]
Saving model...
Epoch 14/65
236/236 - 353s - loss: 0.1665 - accuracy: 0.9303 - val_loss: 0.3408 - val_accuracy: 0.8844
Confusion matrix: 
 [[516  57]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.341 0.659]]
Validation f1: 43.20
Validation accuracy: 88.44
Validation recall: 65.85
Validation precision: 32.14
Validation AUC: 0.35647306716443944
Validation class accuracies: [0.900523560209424, 0.6585365853658537]
The validation tracker metric at 0.575 hasn't increased by 0 in 1 epochs
Epoch 15/65
236/236 - 353s - loss: 0.1449 - accuracy: 0.9367 - val_loss: 1.7497 - val_accuracy: 0.7280
Confusion matrix: 
 [[411 162]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.717 0.283]
 [0.122 0.878]]
Validation f1: 30.13
Validation accuracy: 72.80
Validation recall: 87.80
Validation precision: 18.18
Validation AUC: 0.589682201831178
Validation class accuracies: [0.7172774869109948, 0.8780487804878049]
The validation tracker metric at 0.575 hasn't increased by 0 in 2 epochs
Epoch 16/65
236/236 - 353s - loss: 0.0984 - accuracy: 0.9536 - val_loss: 0.8794 - val_accuracy: 0.7866
Confusion matrix: 
 [[446 127]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.778 0.222]
 [0.098 0.902]]
Validation f1: 36.10
Validation accuracy: 78.66
Validation recall: 90.24
Validation precision: 22.56
Validation AUC: 0.5569755547898902
Validation class accuracies: [0.7783595113438045, 0.9024390243902439]
The validation tracker metric at 0.575 hasn't increased by 0 in 3 epochs
Epoch 17/65
236/236 - 353s - loss: 0.1026 - accuracy: 0.9512 - val_loss: 1.3741 - val_accuracy: 0.5814
Confusion matrix: 
 [[322 251]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.562 0.438]
 [0.146 0.854]]
Validation f1: 21.41
Validation accuracy: 58.14
Validation recall: 85.37
Validation precision: 12.24
Validation AUC: 0.5561088793962335
Validation class accuracies: [0.5619546247818499, 0.8536585365853658]
The validation tracker metric at 0.575 hasn't increased by 0 in 4 epochs
Epoch 18/65
236/236 - 353s - loss: 0.1518 - accuracy: 0.9369 - val_loss: 0.2848 - val_accuracy: 0.9756
Confusion matrix: 
 [[572   1]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.341 0.659]]
Validation f1: 78.26
Validation accuracy: 97.56
Validation recall: 65.85
Validation precision: 96.43
Validation AUC: 0.7226635711282539
Validation class accuracies: [0.9982547993019197, 0.6585365853658537]
Saving model...
Epoch 19/65
236/236 - 354s - loss: 0.0725 - accuracy: 0.9685 - val_loss: 0.3585 - val_accuracy: 0.8941
Confusion matrix: 
 [[519  54]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.268 0.732]]
Validation f1: 48.00
Validation accuracy: 89.41
Validation recall: 73.17
Validation precision: 35.71
Validation AUC: 0.5794931497591896
Validation class accuracies: [0.9057591623036649, 0.7317073170731707]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 1 epochs
Epoch 20/65
236/236 - 354s - loss: 0.0690 - accuracy: 0.9685 - val_loss: 0.7070 - val_accuracy: 0.8127
Confusion matrix: 
 [[464 109]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.146 0.854]]
Validation f1: 37.84
Validation accuracy: 81.27
Validation recall: 85.37
Validation precision: 24.31
Validation AUC: 0.6309654602388088
Validation class accuracies: [0.8097731239092496, 0.8536585365853658]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 2 epochs
Epoch 21/65
236/236 - 354s - loss: 0.0559 - accuracy: 0.9727 - val_loss: 0.4446 - val_accuracy: 0.8664
Confusion matrix: 
 [[500  73]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.22  0.78 ]]
Validation f1: 43.84
Validation accuracy: 86.64
Validation recall: 78.05
Validation precision: 30.48
Validation AUC: 0.5800971025218832
Validation class accuracies: [0.8726003490401396, 0.7804878048780488]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 3 epochs
Epoch 22/65
236/236 - 353s - loss: 0.0537 - accuracy: 0.9740 - val_loss: 0.3612 - val_accuracy: 0.9023
Confusion matrix: 
 [[522  51]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.22  0.78 ]]
Validation f1: 51.61
Validation accuracy: 90.23
Validation recall: 78.05
Validation precision: 38.55
Validation AUC: 0.6896264216690342
Validation class accuracies: [0.9109947643979057, 0.7804878048780488]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 4 epochs
Epoch 23/65
236/236 - 353s - loss: 0.0424 - accuracy: 0.9817 - val_loss: 5.9648 - val_accuracy: 0.3094
Confusion matrix: 
 [[151 422]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.264 0.736]
 [0.049 0.951]]
Validation f1: 15.54
Validation accuracy: 30.94
Validation recall: 95.12
Validation precision: 8.46
Validation AUC: 0.4999745096273413
Validation class accuracies: [0.26352530541012215, 0.9512195121951219]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 5 epochs
Epoch 24/65
236/236 - 354s - loss: 0.0231 - accuracy: 0.9907 - val_loss: 0.2570 - val_accuracy: 0.9495
Confusion matrix: 
 [[555  18]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.317 0.683]]
Validation f1: 64.37
Validation accuracy: 94.95
Validation recall: 68.29
Validation precision: 60.87
Validation AUC: 0.678435244470816
Validation class accuracies: [0.9685863874345549, 0.6829268292682927]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 25/65
236/236 - 353s - loss: 0.0170 - accuracy: 0.9955 - val_loss: 1.9157 - val_accuracy: 0.5945
Confusion matrix: 
 [[329 244]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.574 0.426]
 [0.122 0.878]]
Validation f1: 22.43
Validation accuracy: 59.45
Validation recall: 87.80
Validation precision: 12.86
Validation AUC: 0.5660193916681283
Validation class accuracies: [0.5741710296684118, 0.8780487804878049]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 7 epochs
Epoch 26/65
236/236 - 354s - loss: 0.0227 - accuracy: 0.9883 - val_loss: 0.3617 - val_accuracy: 0.9169
Confusion matrix: 
 [[540  33]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.439 0.561]]
Validation f1: 47.42
Validation accuracy: 91.69
Validation recall: 56.10
Validation precision: 41.07
Validation AUC: 0.595022612664994
Validation class accuracies: [0.9424083769633508, 0.5609756097560976]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 8 epochs
Epoch 27/65
236/236 - 353s - loss: 0.0166 - accuracy: 0.9947 - val_loss: 0.6164 - val_accuracy: 0.8567
Confusion matrix: 
 [[494  79]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.22  0.78 ]]
Validation f1: 42.11
Validation accuracy: 85.67
Validation recall: 78.05
Validation precision: 28.83
Validation AUC: 0.6423495251742382
Validation class accuracies: [0.8621291448516579, 0.7804878048780488]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 9 epochs
Epoch 28/65
236/236 - 353s - loss: 0.0162 - accuracy: 0.9931 - val_loss: 0.4266 - val_accuracy: 0.9153
Confusion matrix: 
 [[533  40]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.73
Validation accuracy: 91.53
Validation recall: 70.73
Validation precision: 42.03
Validation AUC: 0.6244265662132245
Validation class accuracies: [0.9301919720767888, 0.7073170731707317]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 10 epochs
Epoch 29/65
236/236 - 354s - loss: 0.0275 - accuracy: 0.9902 - val_loss: 0.7097 - val_accuracy: 0.7948
Confusion matrix: 
 [[454 119]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.171 0.829]]
Validation f1: 35.05
Validation accuracy: 79.48
Validation recall: 82.93
Validation precision: 22.22
Validation AUC: 0.6137485754704232
Validation class accuracies: [0.7923211169284468, 0.8292682926829268]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 11 epochs
Epoch 30/65
236/236 - 353s - loss: 0.0505 - accuracy: 0.9799 - val_loss: 2.4620 - val_accuracy: 0.6319
Confusion matrix: 
 [[352 221]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.614 0.386]
 [0.122 0.878]]
Validation f1: 24.16
Validation accuracy: 63.19
Validation recall: 87.80
Validation precision: 14.01
Validation AUC: 0.5877608310202651
Validation class accuracies: [0.6143106457242583, 0.8780487804878049]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 31/65
236/236 - 353s - loss: 0.0227 - accuracy: 0.9902 - val_loss: 0.4206 - val_accuracy: 0.9186
Confusion matrix: 
 [[534  39]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.268 0.732]]
Validation f1: 54.55
Validation accuracy: 91.86
Validation recall: 73.17
Validation precision: 43.48
Validation AUC: 0.5667709112395741
Validation class accuracies: [0.9319371727748691, 0.7317073170731707]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 13 epochs
Epoch 32/65
236/236 - 354s - loss: 0.0137 - accuracy: 0.9952 - val_loss: 0.4105 - val_accuracy: 0.9039
Confusion matrix: 
 [[525  48]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.268 0.732]]
Validation f1: 50.42
Validation accuracy: 90.39
Validation recall: 73.17
Validation precision: 38.46
Validation AUC: 0.6088680061821798
Validation class accuracies: [0.9162303664921466, 0.7317073170731707]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 14 epochs
Epoch 33/65
236/236 - 354s - loss: 0.0082 - accuracy: 0.9971 - val_loss: 0.3786 - val_accuracy: 0.9283
Confusion matrix: 
 [[541  32]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.86
Validation accuracy: 92.83
Validation recall: 70.73
Validation precision: 47.54
Validation AUC: 0.6080113125779774
Validation class accuracies: [0.944153577661431, 0.7073170731707317]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 15 epochs
Epoch 34/65
236/236 - 354s - loss: 0.0105 - accuracy: 0.9981 - val_loss: 0.6106 - val_accuracy: 0.8632
Confusion matrix: 
 [[500  73]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.268 0.732]]
Validation f1: 41.67
Validation accuracy: 86.32
Validation recall: 73.17
Validation precision: 29.13
Validation AUC: 0.5584606707551373
Validation class accuracies: [0.8726003490401396, 0.7317073170731707]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 16 epochs
Epoch 35/65
236/236 - 353s - loss: 0.0069 - accuracy: 0.9979 - val_loss: 0.3837 - val_accuracy: 0.9169
Confusion matrix: 
 [[536  37]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.341 0.659]]
Validation f1: 51.43
Validation accuracy: 91.69
Validation recall: 65.85
Validation precision: 42.19
Validation AUC: 0.6042978113303441
Validation class accuracies: [0.9354275741710296, 0.6585365853658537]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 17 epochs
Epoch 36/65
236/236 - 354s - loss: 0.0064 - accuracy: 0.9971 - val_loss: 0.3744 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.61578276136145
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 37/65
236/236 - 354s - loss: 0.0059 - accuracy: 0.9989 - val_loss: 0.3892 - val_accuracy: 0.9153
Confusion matrix: 
 [[534  39]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.317 0.683]]
Validation f1: 51.85
Validation accuracy: 91.53
Validation recall: 68.29
Validation precision: 41.79
Validation AUC: 0.617490481214082
Validation class accuracies: [0.9319371727748691, 0.6829268292682927]
The validation tracker metric at 0.782608695652174 hasn't increased by 0 in 19 epochs
Epoch 38/65
236/236 - 354s - loss: 0.0041 - accuracy: 0.9989 - val_loss: 0.3573 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6016010466016589
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]

The metrics for job 1 with the best target metric are: 
Best cm: [[572   1]
 [ 14  27]]
Best normalized cm: [[0.998 0.002]
 [0.341 0.659]]
Best f1: 0.78
Best accuracy: 0.98
Best recall: 0.66
Best precision: 0.96
Best AUC: 0.72
Best class accuracies: [0.9982547993019197, 0.6585365853658537]
Best epoch: 18
The number of epochs since last 1% equals the patience
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_203_2p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_218_1b1_Ar_sc_Meditron_13_label_0_pred_0.png, [[0.128]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.321e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_222_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[3.246e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_223_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_203_2p3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_213_1p2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_207_3b2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.13]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_221_2b1_Ar_mc_LittC2SE_2_label_0_pred_1.png, [[0.987]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_205_3b4_Al_mc_AKGC417L_0_label_0_pred_0.png, [[5.119e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_204_7p5_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[1.536e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_211_2p2_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_218_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_211_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_218_1p1_Ar_sc_Litt3200_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_207_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_213_1p2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_223_1b1_Pr_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_205_2b3_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_218_1b1_Al_sc_Meditron_9_label_0_pred_1.png, [[0.935]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[7.566e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_218_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_213_1p2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[4.433e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_205_4b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.864e-06]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_213_1p2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.178]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_218_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_222_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[6.237e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_220_1b2_Al_mc_LittC2SE_0_label_0_pred_0.png, [[2.086e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_213_1p2_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[7.13e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[4.017e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_218_1b1_Ar_sc_Meditron_7_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_205_1b3_Ll_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_211_2p2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_205_1b3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_211_1p2_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[5.14e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_207_2b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_217_1b1_Tc_sc_Meditron_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_213_1p5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_221_2b3_Ar_mc_LittC2SE_3_label_0_pred_1.png, [[0.984]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_220_1b1_Tc_mc_LittC2SE_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_205_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_207_2b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[7.531e-05]]
../../new_cache/conv__2262__06_0215__v39__augmented_mod9/1/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[9.897e-05]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 23849
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_065220-2l6mrtqp/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_065220-2l6mrtqp/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99894
wandb:         val_accuracy 0.92345
wandb:             _runtime 13987
wandb:           _timestamp 1624877127
wandb:                _step 277
wandb:           train_loss 0.0041
wandb:             val_loss 0.3573
wandb:           val_recall 0.68293
wandb:        val_precision 0.45161
wandb:               val_f1 0.54369
wandb:              val_auc 0.6016
wandb:                   lr 0.00013
wandb:          best_val_f1 0.78261
wandb:    best_val_accuracy 0.97557
wandb:   best_val_precision 0.96429
wandb:      best_val_recall 0.65854
wandb:             best_auc 0.72266
wandb:           best_epoch 18
wandb: Run history:
wandb:   train_accuracy ▁▃▄▄▅▅▅▆▅▆▆▇▇▇▇▇▇▇▇▇██████████████████
wandb:     val_accuracy ██▇▂▄▁▇▄▄▇▄▇█▇▅▆▄█▇▆▇▇▁█▄▇▇▇▆▄▇▇█▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▅▄▄▄▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▃▂▄▁▃▂▁▃▁▁▁▃▂▂▁▁▂▁▁█▁▃▁▁▁▂▄▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▁▃███▆█▇▄█▆▅▆▇▇▇▆▆▇▆▆█▆▇▅▆▆▇▇▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▁▄▂▂▂▃▂▂▃▂▃▅▃▂▃▂█▄▃▃▄▂▅▂▄▃▄▃▂▄▄▄▃▄▄▄▄
wandb:           val_f1 ▁▁▄▃▃▃▅▃▃▄▃▅▆▅▄▄▃█▅▄▅▆▂▇▃▅▅▆▄▃▆▆▆▅▆▆▆▆
wandb:          val_auc ▁▁▄▅▄▁▆▆▅▄▂▇▇▄▇▆▆█▆▇▆█▆█▆▇▇▇▇▆▆▇▇▆▇▇▇▇
wandb:               lr ████████████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_065220-2l6mrtqp

-----------------------
New augm params: {'ADD': 1, 'QUANTITY': 300, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_12
Length of training samples after spec augmentation: 3074
-----------------------
Number of train recordings: 3074 with pneumonia: 774 and non-pneumonia: 2300
Length of training samples after audio augmentation: 4074
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_13
Length of training samples after spec augmentation: 4574
-----------------------
Number of train recordings: 4574 with pneumonia: 774 and non-pneumonia: 3800
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 128, 1250, 1)    4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_2 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 64, 625, 48)     0            concatenate_2[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 64, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 32, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 16, 156, 128)    91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 8, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 4, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               513          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
286/286 - 426s - loss: 1.0884 - accuracy: 0.5805 - val_loss: 0.5575 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07781206169245762
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
286/286 - 426s - loss: 0.6420 - accuracy: 0.6377 - val_loss: 0.2489 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.4882648643758001
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
286/286 - 427s - loss: 0.5176 - accuracy: 0.7042 - val_loss: 0.7927 - val_accuracy: 0.8094
Confusion matrix: 
 [[466 107]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.813 0.187]
 [0.244 0.756]]
Validation f1: 34.64
Validation accuracy: 80.94
Validation recall: 75.61
Validation precision: 22.46
Validation AUC: 0.506019104060059
Validation class accuracies: [0.8132635253054101, 0.7560975609756098]
Saving model...
Epoch 4/65
286/286 - 426s - loss: 0.4749 - accuracy: 0.7427 - val_loss: 3.2763 - val_accuracy: 0.1971
Confusion matrix: 
 [[ 80 493]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.14 0.86]
 [0.   1.  ]]
Validation f1: 14.26
Validation accuracy: 19.71
Validation recall: 100.00
Validation precision: 7.68
Validation AUC: 0.4188626203192612
Validation class accuracies: [0.13961605584642234, 1.0]
The validation tracker metric at 0.3463687150837989 hasn't increased by 0 in 1 epochs
Epoch 5/65
286/286 - 426s - loss: 0.3837 - accuracy: 0.8019 - val_loss: 0.3225 - val_accuracy: 0.8893
Confusion matrix: 
 [[515  58]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.244 0.756]]
Validation f1: 47.69
Validation accuracy: 88.93
Validation recall: 75.61
Validation precision: 34.83
Validation AUC: 0.6826464881175981
Validation class accuracies: [0.8987783595113438, 0.7560975609756098]
Saving model...
Epoch 6/65
286/286 - 426s - loss: 0.3578 - accuracy: 0.8096 - val_loss: 0.7461 - val_accuracy: 0.6971
Confusion matrix: 
 [[392 181]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.684 0.316]
 [0.122 0.878]]
Validation f1: 27.91
Validation accuracy: 69.71
Validation recall: 87.80
Validation precision: 16.59
Validation AUC: 0.49787889424587217
Validation class accuracies: [0.6841186736474695, 0.8780487804878049]
The validation tracker metric at 0.4769230769230769 hasn't increased by 0 in 1 epochs
Epoch 7/65
286/286 - 426s - loss: 0.2688 - accuracy: 0.8669 - val_loss: 0.7292 - val_accuracy: 0.8046
Confusion matrix: 
 [[470 103]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82  0.18 ]
 [0.415 0.585]]
Validation f1: 28.57
Validation accuracy: 80.46
Validation recall: 58.54
Validation precision: 18.90
Validation AUC: 0.35552426802845444
Validation class accuracies: [0.8202443280977313, 0.5853658536585366]
The validation tracker metric at 0.4769230769230769 hasn't increased by 0 in 2 epochs
Epoch 8/65
286/286 - 426s - loss: 0.2948 - accuracy: 0.8581 - val_loss: 1.6757 - val_accuracy: 0.6401
Confusion matrix: 
 [[354 219]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.618 0.382]
 [0.049 0.951]]
Validation f1: 26.09
Validation accuracy: 64.01
Validation recall: 95.12
Validation precision: 15.12
Validation AUC: 0.5595922984212314
Validation class accuracies: [0.6178010471204188, 0.9512195121951219]
The validation tracker metric at 0.4769230769230769 hasn't increased by 0 in 3 epochs
Epoch 9/65
286/286 - 426s - loss: 0.2287 - accuracy: 0.8983 - val_loss: 0.7728 - val_accuracy: 0.7508
Confusion matrix: 
 [[424 149]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.74  0.26 ]
 [0.098 0.902]]
Validation f1: 32.60
Validation accuracy: 75.08
Validation recall: 90.24
Validation precision: 19.89
Validation AUC: 0.5288245556286297
Validation class accuracies: [0.7399650959860384, 0.9024390243902439]
The validation tracker metric at 0.4769230769230769 hasn't increased by 0 in 4 epochs
Epoch 10/65
286/286 - 426s - loss: 0.1739 - accuracy: 0.9143 - val_loss: 1.7822 - val_accuracy: 0.5456
Confusion matrix: 
 [[298 275]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.52  0.48 ]
 [0.098 0.902]]
Validation f1: 20.96
Validation accuracy: 54.56
Validation recall: 90.24
Validation precision: 11.86
Validation AUC: 0.4970120528488398
Validation class accuracies: [0.5200698080279232, 0.9024390243902439]
The validation tracker metric at 0.4769230769230769 hasn't increased by 0 in 5 epochs
Epoch 11/65
286/286 - 426s - loss: 0.1536 - accuracy: 0.9239 - val_loss: 0.3155 - val_accuracy: 0.9202
Confusion matrix: 
 [[533  40]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93 0.07]
 [0.22 0.78]]
Validation f1: 56.64
Validation accuracy: 92.02
Validation recall: 78.05
Validation precision: 44.44
Validation AUC: 0.6158544669940366
Validation class accuracies: [0.9301919720767888, 0.7804878048780488]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 18 leaked semaphores to clean up at shutdown
  len(cache))
