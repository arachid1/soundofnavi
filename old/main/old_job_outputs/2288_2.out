Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2288
Description:  augmix
2021-07-06 12:03:24.997810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-07-06 12:03:27.210474: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-06 12:03:27.211360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-06 12:03:27.257599: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:27.258321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-06 12:03:27.258352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:03:27.261878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:03:27.261976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-06 12:03:27.263067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-06 12:03:27.263367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-06 12:03:27.264397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-06 12:03:27.265286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-06 12:03:27.265444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:03:27.265559: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:27.266254: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:27.266881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2288.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2288__07_1202__v39__augmix
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-06 12:03:31.995876: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-06 12:03:31.996137: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:31.996891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-06 12:03:31.996933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:03:31.996991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:03:31.997013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-06 12:03:31.997032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-06 12:03:31.997054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-06 12:03:31.997073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-06 12:03:31.997092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-06 12:03:31.997110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:03:31.997201: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:31.997888: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:31.998547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-06 12:03:31.998589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 12:03:32.704913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-06 12:03:32.704960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-06 12:03:32.704969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-06 12:03:32.705263: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:32.706053: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:32.706773: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 12:03:32.707439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-07-06 12:03:33.778478: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-07-06 12:03:33.780126: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-06 12:03:34.116575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 12:03:36.231920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 12:03:36.686596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after augmix augmentation: 2458
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 66s - loss: 0.4806 - accuracy: 0.7010 - val_loss: 0.4844 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09823601748045072
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 61s - loss: 0.3376 - accuracy: 0.8495 - val_loss: 0.3465 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09426599473934315
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 62s - loss: 0.2409 - accuracy: 0.8922 - val_loss: 0.2458 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09626812110293528
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 67s - loss: 0.1851 - accuracy: 0.9296 - val_loss: 0.1865 - val_accuracy: 0.9577
Confusion matrix: 
 [[567   6]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.488 0.512]]
Validation f1: 61.76
Validation accuracy: 95.77
Validation recall: 51.22
Validation precision: 77.78
Validation AUC: 0.590719045353477
Validation class accuracies: [0.9895287958115183, 0.5121951219512195]
Saving model...
Epoch 5/65
154/154 - 68s - loss: 0.1592 - accuracy: 0.9365 - val_loss: 2.0221 - val_accuracy: 0.3453
Confusion matrix: 
 [[171 402]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.298 0.702]
 [0.    1.   ]]
Validation f1: 16.94
Validation accuracy: 34.53
Validation recall: 100.00
Validation precision: 9.26
Validation AUC: 0.5917340023025359
Validation class accuracies: [0.29842931937172773, 1.0]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 69s - loss: 0.0996 - accuracy: 0.9609 - val_loss: 0.2056 - val_accuracy: 0.9495
Confusion matrix: 
 [[562  11]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.488 0.512]]
Validation f1: 57.53
Validation accuracy: 94.95
Validation recall: 51.22
Validation precision: 65.62
Validation AUC: 0.5547790205077936
Validation class accuracies: [0.9808027923211169, 0.5121951219512195]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 2 epochs
Epoch 7/65
154/154 - 68s - loss: 0.0722 - accuracy: 0.9727 - val_loss: 0.3818 - val_accuracy: 0.8974
Confusion matrix: 
 [[521  52]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.268 0.732]]
Validation f1: 48.78
Validation accuracy: 89.74
Validation recall: 73.17
Validation precision: 36.59
Validation AUC: 0.5969803841692861
Validation class accuracies: [0.9092495636998255, 0.7317073170731707]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 3 epochs
Epoch 8/65
154/154 - 69s - loss: 0.0576 - accuracy: 0.9837 - val_loss: 0.6949 - val_accuracy: 0.8436
Confusion matrix: 
 [[481  92]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.098 0.902]]
Validation f1: 43.53
Validation accuracy: 84.36
Validation recall: 90.24
Validation precision: 28.68
Validation AUC: 0.6095125897802665
Validation class accuracies: [0.8394415357766143, 0.9024390243902439]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 4 epochs
Epoch 9/65
154/154 - 68s - loss: 0.0922 - accuracy: 0.9638 - val_loss: 0.4180 - val_accuracy: 0.8697
Confusion matrix: 
 [[507  66]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.341 0.659]]
Validation f1: 40.30
Validation accuracy: 86.97
Validation recall: 65.85
Validation precision: 29.03
Validation AUC: 0.48887735689940715
Validation class accuracies: [0.8848167539267016, 0.6585365853658537]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 10/65
154/154 - 69s - loss: 0.0459 - accuracy: 0.9837 - val_loss: 0.3528 - val_accuracy: 0.8990
Confusion matrix: 
 [[523  50]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.293 0.707]]
Validation f1: 48.33
Validation accuracy: 89.90
Validation recall: 70.73
Validation precision: 36.71
Validation AUC: 0.5591979595992288
Validation class accuracies: [0.912739965095986, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 6 epochs
Epoch 11/65
154/154 - 69s - loss: 0.0353 - accuracy: 0.9906 - val_loss: 0.3701 - val_accuracy: 0.8958
Confusion matrix: 
 [[520  53]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.268 0.732]]
Validation f1: 48.39
Validation accuracy: 89.58
Validation recall: 73.17
Validation precision: 36.14
Validation AUC: 0.5677374074789315
Validation class accuracies: [0.9075043630017452, 0.7317073170731707]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 7 epochs
Epoch 12/65
154/154 - 68s - loss: 0.0312 - accuracy: 0.9906 - val_loss: 0.3213 - val_accuracy: 0.9218
Confusion matrix: 
 [[537  36]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.293 0.707]]
Validation f1: 54.72
Validation accuracy: 92.18
Validation recall: 70.73
Validation precision: 44.62
Validation AUC: 0.5642082656229989
Validation class accuracies: [0.93717277486911, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 8 epochs
Epoch 13/65
154/154 - 69s - loss: 0.0417 - accuracy: 0.9923 - val_loss: 0.3779 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.5414057460753325
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 9 epochs
Epoch 14/65
154/154 - 69s - loss: 0.0250 - accuracy: 0.9947 - val_loss: 0.3505 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.5543545318800658
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 15/65
154/154 - 69s - loss: 0.0246 - accuracy: 0.9963 - val_loss: 0.3952 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.5523056239390621
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 11 epochs
Epoch 16/65
154/154 - 69s - loss: 0.0242 - accuracy: 0.9947 - val_loss: 0.4008 - val_accuracy: 0.9088
Confusion matrix: 
 [[529  44]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.293 0.707]]
Validation f1: 50.88
Validation accuracy: 90.88
Validation recall: 70.73
Validation precision: 39.73
Validation AUC: 0.5551738000544679
Validation class accuracies: [0.9232111692844677, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 12 epochs
Epoch 17/65
154/154 - 69s - loss: 0.0202 - accuracy: 0.9972 - val_loss: 0.3881 - val_accuracy: 0.9121
Confusion matrix: 
 [[531  42]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.293 0.707]]
Validation f1: 51.79
Validation accuracy: 91.21
Validation recall: 70.73
Validation precision: 40.85
Validation AUC: 0.5548504857946351
Validation class accuracies: [0.9267015706806283, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 13 epochs
Epoch 18/65
154/154 - 69s - loss: 0.0211 - accuracy: 0.9963 - val_loss: 0.3874 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.550269366614657
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 14 epochs
Epoch 19/65
154/154 - 68s - loss: 0.0182 - accuracy: 0.9980 - val_loss: 0.3881 - val_accuracy: 0.9121
Confusion matrix: 
 [[531  42]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.79
Validation accuracy: 91.21
Validation recall: 70.73
Validation precision: 40.85
Validation AUC: 0.5543911027140319
Validation class accuracies: [0.9267015706806283, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 20/65
154/154 - 68s - loss: 0.0220 - accuracy: 0.9967 - val_loss: 0.3931 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.5550781559590464
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 16 epochs
Epoch 21/65
154/154 - 69s - loss: 0.0200 - accuracy: 0.9988 - val_loss: 0.4048 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.5543705264738973
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 17 epochs
Epoch 22/65
154/154 - 69s - loss: 0.0206 - accuracy: 0.9967 - val_loss: 0.3969 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.5562325980215477
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 18 epochs
Epoch 23/65
154/154 - 68s - loss: 0.0185 - accuracy: 0.9984 - val_loss: 0.3972 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.5574877414561689
Validation class accuracies: [0.924956369982548, 0.7073170731707317]
The validation tracker metric at 0.6176470588235294 hasn't increased by 0 in 19 epochs
Epoch 24/65
154/154 - 69s - loss: 0.0170 - accuracy: 0.9963 - val_loss: 0.3947 - val_accuracy: 0.9104
Confusion matrix: 
 [[530  43]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.33
Validation accuracy: 91.04
Validation recall: 70.73
Validation precision: 40.28
Validation AUC: 0.5579498120625774
Validation class accuracies: [0.924956369982548, 0.7073170731707317]

The metrics for job 0 with the best target metric are: 
Best cm: [[567   6]
 [ 20  21]]
Best normalized cm: [[0.99  0.01 ]
 [0.488 0.512]]
Best f1: 0.62
Best accuracy: 0.96
Best recall: 0.51
Best precision: 0.78
Best AUC: 0.59
Best class accuracies: [0.9895287958115183, 0.5121951219512195]
Best epoch: 4
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.058]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.02]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.258]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.069]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.252]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_1.png, [[0.518]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.083]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.041]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.109]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.047]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.034]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.08]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.037]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.061]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.042]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.049]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.028]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_1.png, [[0.673]]
../../new_cache/conv__2288__07_1202__v39__augmix/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.914]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 29283
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_120327-26bpxe89/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_120327-26bpxe89/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99634
wandb:         val_accuracy 0.91042
wandb:             _runtime 1914
wandb:           _timestamp 1625574922
wandb:                _step 170
wandb:           train_loss 0.01698
wandb:             val_loss 0.39466
wandb:           val_recall 0.70732
wandb:        val_precision 0.40278
wandb:               val_f1 0.51327
wandb:              val_auc 0.55795
wandb:                   lr 2e-05
wandb:          best_val_f1 0.61765
wandb:    best_val_accuracy 0.95765
wandb:   best_val_precision 0.77778
wandb:      best_val_recall 0.5122
wandb:             best_auc 0.59072
wandb:           best_epoch 4
wandb: Run history:
wandb:   train_accuracy ▁▄▅▆▇▇▇█▇███████████████
wandb:     val_accuracy ████▁█▇▇▇▇▇█▇█▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▄▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▁▁█▁▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ▁▁▁▅█▅▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▁▁█▂▇▄▄▄▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_f1 ▁▁▁█▃█▇▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▁▁██▇██▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr █████████▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_120327-26bpxe89

-----------------------
158/800
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after augmix augmentation: 2458
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_5 (MixDepthGroupCo (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_6 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_7 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_8 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_9 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
154/154 - 69s - loss: 0.4725 - accuracy: 0.7172 - val_loss: 0.4575 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.229360817059984
Validation class accuracies: [1.0, 0.0]
local_gc_exec.sh: line 6: 29255 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2288__07_1202__v39__augmix/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 12 leaked semaphores to clean up at shutdown
  len(cache))
