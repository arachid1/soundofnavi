Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2136
Description:  mod9_oversampled_f1
2021-05-13 16:03:12.440854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 16:03:15.188417: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-13 16:03:15.189705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-13 16:03:15.255493: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:15.256592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-13 16:03:15.256637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 16:03:15.261402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 16:03:15.261496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 16:03:15.263068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-13 16:03:15.263474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-13 16:03:15.264958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-13 16:03:15.266192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-13 16:03:15.266382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-13 16:03:15.266549: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:15.267591: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:15.268562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2136.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2136__05_1602__v29__mod9_oversampled_f1/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 22, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2136
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1xm5r5ox
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_160315-1xm5r5ox
wandb: Run `wandb offline` to turn off syncing.
2021-05-13 16:03:21.039666: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-13 16:03:21.039923: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:21.040773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-13 16:03:21.040822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 16:03:21.040886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 16:03:21.040909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 16:03:21.040931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-13 16:03:21.040953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-13 16:03:21.040973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-13 16:03:21.040994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-13 16:03:21.041014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-13 16:03:21.041102: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:21.041885: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:21.042578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-13 16:03:21.042630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 16:03:21.856253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-13 16:03:21.856314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-13 16:03:21.856327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-13 16:03:21.856615: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:21.857438: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:21.858208: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 16:03:21.858924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-13 16:04:04.087697: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-13 16:04:04.089472: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-13 16:04:07.511471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 16:04:08.310822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 16:04:08.326752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
1150
3046
6092
With concat = False and six = False, size of training set: 6092...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
binary
Epoch 1/80
381/381 - 709s - loss: 0.7468 - accuracy: 0.5098 - val_loss: 0.5440 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17649490025975023
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
381/381 - 709s - loss: 0.6951 - accuracy: 0.5389 - val_loss: 0.7044 - val_accuracy: 0.5653
Confusion matrix: 
 [[475 395]
 [ 78 140]]
Validation f1: 37.18
Validation accuracy: 56.53
Validation recall: 64.22
Validation precision: 26.17
Validation AUC: 0.27067858487667507
Validation class accuracies: [0.5459770114942529, 0.6422018348623854]
TARGET: 1
target metric(test f1): 0.37184594953519257
column_sums: [553 535]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 3/80
381/381 - 711s - loss: 0.6849 - accuracy: 0.5506 - val_loss: 0.5948 - val_accuracy: 0.7500
Confusion matrix: 
 [[807  63]
 [209   9]]
Validation f1: 6.21
Validation accuracy: 75.00
Validation recall: 4.13
Validation precision: 12.50
Validation AUC: 0.20889967818021996
Validation class accuracies: [0.9275862068965517, 0.04128440366972477]
TARGET: 1
target metric(test f1): 0.06206896551724138
column_sums: [1016   72]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
381/381 - 708s - loss: 0.6773 - accuracy: 0.5704 - val_loss: 0.7401 - val_accuracy: 0.4531
Confusion matrix: 
 [[351 519]
 [ 76 142]]
Validation f1: 32.31
Validation accuracy: 45.31
Validation recall: 65.14
Validation precision: 21.48
Validation AUC: 0.2529256818444122
Validation class accuracies: [0.40344827586206894, 0.6513761467889908]
TARGET: 1
target metric(test f1): 0.323094425483504
column_sums: [427 661]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 1 epochs
Epoch 5/80
381/381 - 710s - loss: 0.6652 - accuracy: 0.5865 - val_loss: 0.6342 - val_accuracy: 0.7491
Confusion matrix: 
 [[794  76]
 [197  21]]
Validation f1: 13.33
Validation accuracy: 74.91
Validation recall: 9.63
Validation precision: 21.65
Validation AUC: 0.23136277736025057
Validation class accuracies: [0.9126436781609195, 0.0963302752293578]
TARGET: 1
target metric(test f1): 0.13333333333333336
column_sums: [991  97]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
381/381 - 709s - loss: 0.6574 - accuracy: 0.5982 - val_loss: 0.6432 - val_accuracy: 0.6811
Confusion matrix: 
 [[692 178]
 [169  49]]
Validation f1: 22.02
Validation accuracy: 68.11
Validation recall: 22.48
Validation precision: 21.59
Validation AUC: 0.21650223647531697
Validation class accuracies: [0.7954022988505747, 0.22477064220183487]
TARGET: 1
target metric(test f1): 0.22022471910112362
column_sums: [861 227]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 2 epochs
Epoch 7/80
381/381 - 710s - loss: 0.6513 - accuracy: 0.6018 - val_loss: 0.6127 - val_accuracy: 0.7656
Confusion matrix: 
 [[813  57]
 [198  20]]
Validation f1: 13.56
Validation accuracy: 76.56
Validation recall: 9.17
Validation precision: 25.97
Validation AUC: 0.20812751721609613
Validation class accuracies: [0.9344827586206896, 0.09174311926605505]
TARGET: 1
target metric(test f1): 0.13559322033898305
column_sums: [1011   77]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
381/381 - 711s - loss: 0.6430 - accuracy: 0.6192 - val_loss: 0.9182 - val_accuracy: 0.5432
Confusion matrix: 
 [[467 403]
 [ 94 124]]
Validation f1: 33.29
Validation accuracy: 54.32
Validation recall: 56.88
Validation precision: 23.53
Validation AUC: 0.22693590463240493
Validation class accuracies: [0.5367816091954023, 0.5688073394495413]
TARGET: 1
target metric(test f1): 0.33288590604026846
column_sums: [561 527]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 3 epochs
Epoch 9/80
381/381 - 709s - loss: 0.6308 - accuracy: 0.6320 - val_loss: 0.6556 - val_accuracy: 0.5818
Confusion matrix: 
 [[561 309]
 [146  72]]
Validation f1: 24.04
Validation accuracy: 58.18
Validation recall: 33.03
Validation precision: 18.90
Validation AUC: 0.22042746007262431
Validation class accuracies: [0.6448275862068965, 0.3302752293577982]
TARGET: 1
target metric(test f1): 0.24040066777963273
column_sums: [707 381]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 4 epochs
Epoch 10/80
381/381 - 711s - loss: 0.5943 - accuracy: 0.6689 - val_loss: 0.7778 - val_accuracy: 0.4697
Confusion matrix: 
 [[386 484]
 [ 93 125]]
Validation f1: 30.23
Validation accuracy: 46.97
Validation recall: 57.34
Validation precision: 20.53
Validation AUC: 0.20770283792297495
Validation class accuracies: [0.4436781609195402, 0.573394495412844]
TARGET: 1
target metric(test f1): 0.3022974607013301
column_sums: [479 609]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 5 epochs
Epoch 11/80
381/381 - 710s - loss: 0.5728 - accuracy: 0.6970 - val_loss: 0.7166 - val_accuracy: 0.5763
Confusion matrix: 
 [[561 309]
 [152  66]]
Validation f1: 22.26
Validation accuracy: 57.63
Validation recall: 30.28
Validation precision: 17.60
Validation AUC: 0.19477101065943447
Validation class accuracies: [0.6448275862068965, 0.30275229357798167]
TARGET: 1
target metric(test f1): 0.22259696458684652
column_sums: [713 375]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 6 epochs
Epoch 12/80
381/381 - 711s - loss: 0.5487 - accuracy: 0.7126 - val_loss: 0.8403 - val_accuracy: 0.4890
Confusion matrix: 
 [[421 449]
 [107 111]]
Validation f1: 28.53
Validation accuracy: 48.90
Validation recall: 50.92
Validation precision: 19.82
Validation AUC: 0.2106016707529554
Validation class accuracies: [0.4839080459770115, 0.5091743119266054]
TARGET: 1
target metric(test f1): 0.2853470437017995
column_sums: [528 560]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 7 epochs
Epoch 13/80
381/381 - 713s - loss: 0.5244 - accuracy: 0.7277 - val_loss: 0.8003 - val_accuracy: 0.5671
Confusion matrix: 
 [[530 340]
 [131  87]]
Validation f1: 26.98
Validation accuracy: 56.71
Validation recall: 39.91
Validation precision: 20.37
Validation AUC: 0.21945541139938668
Validation class accuracies: [0.6091954022988506, 0.39908256880733944]
TARGET: 1
target metric(test f1): 0.26976744186046514
column_sums: [661 427]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 8 epochs
Epoch 14/80
381/381 - 711s - loss: 0.4959 - accuracy: 0.7559 - val_loss: 0.8022 - val_accuracy: 0.5634
Confusion matrix: 
 [[524 346]
 [129  89]]
Validation f1: 27.26
Validation accuracy: 56.34
Validation recall: 40.83
Validation precision: 20.46
Validation AUC: 0.21266151635228953
Validation class accuracies: [0.6022988505747127, 0.40825688073394495]
TARGET: 1
target metric(test f1): 0.2725880551301684
column_sums: [653 435]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 9 epochs
Epoch 15/80
381/381 - 709s - loss: 0.4674 - accuracy: 0.7720 - val_loss: 0.8736 - val_accuracy: 0.5294
Confusion matrix: 
 [[479 391]
 [121  97]]
Validation f1: 27.48
Validation accuracy: 52.94
Validation recall: 44.50
Validation precision: 19.88
Validation AUC: 0.2144056712407805
Validation class accuracies: [0.5505747126436782, 0.44495412844036697]
TARGET: 1
target metric(test f1): 0.2747875354107649
column_sums: [600 488]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 10 epochs
Epoch 16/80
381/381 - 711s - loss: 0.4522 - accuracy: 0.7795 - val_loss: 0.8550 - val_accuracy: 0.5570
Confusion matrix: 
 [[518 352]
 [130  88]]
Validation f1: 26.75
Validation accuracy: 55.70
Validation recall: 40.37
Validation precision: 20.00
Validation AUC: 0.21365579259600542
Validation class accuracies: [0.5954022988505747, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.26747720364741645
column_sums: [648 440]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 11 epochs
Epoch 17/80
381/381 - 712s - loss: 0.4499 - accuracy: 0.7807 - val_loss: 0.9088 - val_accuracy: 0.5414
Confusion matrix: 
 [[499 371]
 [128  90]]
Validation f1: 26.51
Validation accuracy: 54.14
Validation recall: 41.28
Validation precision: 19.52
Validation AUC: 0.21035707571495224
Validation class accuracies: [0.5735632183908046, 0.41284403669724773]
TARGET: 1
target metric(test f1): 0.2650957290132548
column_sums: [627 461]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 12 epochs
Epoch 18/80
381/381 - 710s - loss: 0.4428 - accuracy: 0.7889 - val_loss: 0.9342 - val_accuracy: 0.5368
Confusion matrix: 
 [[489 381]
 [123  95]]
Validation f1: 27.38
Validation accuracy: 53.68
Validation recall: 43.58
Validation precision: 19.96
Validation AUC: 0.21135884608334116
Validation class accuracies: [0.5620689655172414, 0.43577981651376146]
TARGET: 1
target metric(test f1): 0.27377521613832856
column_sums: [612 476]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 13 epochs
Epoch 19/80
381/381 - 712s - loss: 0.4324 - accuracy: 0.7963 - val_loss: 0.9370 - val_accuracy: 0.5515
Confusion matrix: 
 [[503 367]
 [121  97]]
Validation f1: 28.45
Validation accuracy: 55.15
Validation recall: 44.50
Validation precision: 20.91
Validation AUC: 0.21496196820753674
Validation class accuracies: [0.5781609195402299, 0.44495412844036697]
TARGET: 1
target metric(test f1): 0.28445747800586507
column_sums: [624 464]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 14 epochs
Epoch 20/80
381/381 - 712s - loss: 0.4321 - accuracy: 0.7935 - val_loss: 0.9361 - val_accuracy: 0.5395
Confusion matrix: 
 [[490 380]
 [121  97]]
Validation f1: 27.91
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 53.95
Validation recall: 44.50
Validation precision: 20.34
Validation AUC: 0.21268094009850047
Validation class accuracies: [0.5632183908045977, 0.44495412844036697]
TARGET: 1
target metric(test f1): 0.279136690647482
column_sums: [611 477]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 15 epochs
Epoch 21/80
381/381 - 711s - loss: 0.4277 - accuracy: 0.7946 - val_loss: 0.9724 - val_accuracy: 0.5404
Confusion matrix: 
 [[487 383]
 [117 101]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 28.77
Validation accuracy: 54.04
Validation recall: 46.33
Validation precision: 20.87
Validation AUC: 0.20975459421070575
Validation class accuracies: [0.5597701149425287, 0.463302752293578]
TARGET: 1
target metric(test f1): 0.2877492877492877
column_sums: [604 484]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 16 epochs
Epoch 22/80
381/381 - 710s - loss: 0.4354 - accuracy: 0.7866 - val_loss: 0.9395 - val_accuracy: 0.5524
Confusion matrix: 
 [[511 359]
 [128  90]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.99
Validation accuracy: 55.24
Validation recall: 41.28
Validation precision: 20.04
Validation AUC: 0.21068179021442335
Validation class accuracies: [0.5873563218390805, 0.41284403669724773]
TARGET: 1
target metric(test f1): 0.2698650674662669
column_sums: [639 449]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 17 epochs
Epoch 23/80
381/381 - 710s - loss: 0.4221 - accuracy: 0.8012 - val_loss: 0.9362 - val_accuracy: 0.5561
Confusion matrix: 
 [[513 357]
 [126  92]]
Validation f1: 27.59
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 55.61
Validation recall: 42.20
Validation precision: 20.49
Validation AUC: 0.21149063557244713
Validation class accuracies: [0.5896551724137931, 0.42201834862385323]
TARGET: 1
target metric(test f1): 0.27586206896551724
column_sums: [639 449]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 18 epochs
Epoch 24/80
381/381 - 710s - loss: 0.4274 - accuracy: 0.7973 - val_loss: 0.9588 - val_accuracy: 0.5533
Confusion matrix: 
 [[504 366]
 [120  98]]
Validation f1: 28.74
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 55.33
Validation recall: 44.95
Validation precision: 21.12
Validation AUC: 0.21355314832235084
Validation class accuracies: [0.5793103448275863, 0.44954128440366975]
TARGET: 1
target metric(test f1): 0.2873900293255132
column_sums: [624 464]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 19 epochs
Epoch 25/80
381/381 - 710s - loss: 0.4185 - accuracy: 0.8009 - val_loss: 0.9573 - val_accuracy: 0.5579
Confusion matrix: 
 [[507 363]
 [118 100]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 29.37
Validation accuracy: 55.79
Validation recall: 45.87
Validation precision: 21.60
Validation AUC: 0.21429104688051484
Validation class accuracies: [0.5827586206896552, 0.45871559633027525]
TARGET: 1
target metric(test f1): 0.29368575624082227
column_sums: [625 463]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 20 epochs
Epoch 26/80
381/381 - 711s - loss: 0.4284 - accuracy: 0.7940 - val_loss: 0.9467 - val_accuracy: 0.5469
Confusion matrix: 
 [[502 368]
 [125  93]]
Validation f1: 27.39
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 54.69
Validation recall: 42.66
Validation precision: 20.17
Validation AUC: 0.21101426168637755
Validation class accuracies: [0.5770114942528736, 0.42660550458715596]
TARGET: 1
target metric(test f1): 0.27393225331369664
column_sums: [627 461]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.37184594953519257 hasn't increased by 0 in 21 epochs
Epoch 27/80
381/381 - 710s - loss: 0.4273 - accuracy: 0.7887 - val_loss: 0.9401 - val_accuracy: 0.5524
Confusion matrix: 
 [[510 360]
 [127  91]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.20
Validation accuracy: 55.24
Validation recall: 41.74
Validation precision: 20.18
Validation AUC: 0.21084663764955464
Validation class accuracies: [0.5862068965517241, 0.41743119266055045]

The metrics for the epoch with the best target metric are: 
Best cm: [[475 395]
 [ 78 140]]
Best f1: 0.37184594953519257
Best accuracy: 0.5652573529411765
Best recall: 0.6422018348623854
Best precision: 0.2616822429906542
Best AUC: 0.27067858487667507
Best epoch: 2
TARGET: 1
target metric(test f1): 0.2720478325859492
column_sums: [637 451]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 2
Starting...
CM: [[ 7 53]
 [ 0 15]]
F1: 0.36144578313253006
AUC: 0.6102941176470589
Accuracy: 0.29333333333333333
Precision: 0.22058823529411764
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2136__05_1602__v29__mod9_oversampled_f1/validation_sheet_2.xls...
Done.
Epoch: 80
Starting...
CM: [[ 4 56]
 [ 1 14]]
F1: 0.3294117647058824
AUC: 0.5733333333333333
Accuracy: 0.24
Precision: 0.2
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2136__05_1602__v29__mod9_oversampled_f1/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 7140
wandb: Program ended successfully.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: / 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_160315-1xm5r5ox/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_160315-1xm5r5ox/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.78874
wandb:         val_accuracy 0.55239
wandb:             _runtime 19930
wandb:           _timestamp 1620941725
wandb:                _step 192
wandb:           train_loss 0.42732
wandb:             val_loss 0.9401
wandb:           val_recall 0.41743
wandb:        val_precision 0.20177
wandb:               val_f1 0.27205
wandb:              val_auc 0.21085
wandb:                   lr 0.0
wandb:          best_val_f1 0.37185
wandb:    best_val_accuracy 0.56526
wandb:   best_val_precision 0.26168
wandb:      best_val_recall 0.6422
wandb:             best_auc 0.27068
wandb:           best_epoch 2
wandb:           best_bd_f1 0.36145
wandb:          best_bd_auc 0.61029
wandb:     best_bd_accuracy 0.29333
wandb:    best_bd_precision 0.22059
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 2
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▃▃▃▄▄▅▅▆▆▇▇▇███████████
wandb:     val_accuracy █▃▇▁▇▆▇▃▄▁▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▇▆▆▆▆▆▅▄▄▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▄▂▄▂▃▂▇▃▅▄▆▅▅▆▆▇▇▇▇█▇▇███▇
wandb:       val_recall ▁█▁█▂▃▂▇▅▇▄▆▅▅▆▅▅▆▆▆▆▅▆▆▆▆▅
wandb:    val_precision ▁█▄▇▇▇█▇▆▆▆▆▆▆▆▆▆▆▇▆▇▆▆▇▇▆▆
wandb:           val_f1 ▁█▂▇▄▅▄▇▆▇▅▆▆▆▆▆▆▆▆▆▆▆▆▆▇▆▆
wandb:          val_auc ▁█▃▇▅▄▃▅▄▃▂▄▄▄▄▄▄▄▄▄▃▄▄▄▄▄▄
wandb:               lr █████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 4 media file(s), 3 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2136: https://wandb.ai/arachid1/tensorboard-integration/runs/1xm5r5ox


 See logs at ../../new_cache/conv__2136__05_1602__v29__mod9_oversampled_f1/logs/