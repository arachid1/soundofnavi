Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2052
Description:  mixednet
2021-04-13 11:26:56.911908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 11:26:59.146276: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-13 11:26:59.147291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-13 11:26:59.208435: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:26:59.209207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-13 11:26:59.209249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 11:26:59.212960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 11:26:59.213076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 11:26:59.214301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-13 11:26:59.214595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-13 11:26:59.215623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-13 11:26:59.216539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-13 11:26:59.216759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 11:26:59.216910: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:26:59.217685: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:26:59.218369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-13 11:26:59.220501: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-13 11:26:59.220700: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:26:59.221414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-13 11:26:59.221440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 11:26:59.221473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 11:26:59.221489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 11:26:59.221503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-13 11:26:59.221517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-13 11:26:59.221543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-13 11:26:59.221558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-13 11:26:59.221572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 11:26:59.221649: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:26:59.222412: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:26:59.223091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-13 11:26:59.223128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 11:27:00.002460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-13 11:27:00.002513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-13 11:27:00.002523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-13 11:27:00.002823: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:27:00.003745: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:27:00.004527: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:27:00.005222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-04-13 11:27:00.383370: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-13 11:27:00.383435: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-13 11:27:00.383478: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-13 11:27:00.383840: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-13 11:27:00.384945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-13 11:27:00.606441: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-13 11:27:00.609076: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-13 11:27:01.390741: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-13 11:27:01.392215: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-13 11:27:03.072839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 11:27:03.638704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 11:27:03.649505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 11:27:07.019287: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-13 11:27:07.019367: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-13 11:27:08.068550: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-13 11:27:08.071319: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-13 11:27:08.106407: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 486 callback api events and 482 activity events. 
2021-04-13 11:27:08.122008: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
WARNING:tensorflow:Callback method `on_train_batch_begin` is slow compared to the batch time (batch time: 0.0287s vs `on_train_batch_begin` time: 0.0986s). Check your callbacks.
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0287s vs `on_train_batch_end` time: 0.3974s). Check your callbacks.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2052.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_1116___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___mixednet___2052/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 6, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 22, 1.0%
-----------------------
Size of training set: 4316
Size of validation set: 1078
Initializing weights...
weights = {0: 0.6776381909547738, 1: 1.9073550212164074}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,967
Trainable params: 105,471
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
270/270 - 155s - loss: 0.6884 - accuracy: 0.5783 - val_loss: 0.6611 - val_accuracy: 0.7254
Epoch 2/40
270/270 - 147s - loss: 0.6741 - accuracy: 0.6179 - val_loss: 0.6820 - val_accuracy: 0.5547
Epoch 3/40
270/270 - 147s - loss: 0.6653 - accuracy: 0.6163 - val_loss: 0.6937 - val_accuracy: 0.5492
Epoch 4/40
270/270 - 148s - loss: 0.6538 - accuracy: 0.6395 - val_loss: 0.7694 - val_accuracy: 0.4638
Epoch 5/40
270/270 - 148s - loss: 0.6384 - accuracy: 0.6587 - val_loss: 0.6042 - val_accuracy: 0.7032
Epoch 6/40
270/270 - 147s - loss: 0.6131 - accuracy: 0.6867 - val_loss: 0.6221 - val_accuracy: 0.6790
Epoch 7/40
270/270 - 147s - loss: 0.5866 - accuracy: 0.7041 - val_loss: 0.8025 - val_accuracy: 0.5102

Epoch 00007: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 8/40
270/270 - 147s - loss: 0.5232 - accuracy: 0.7495 - val_loss: 0.7940 - val_accuracy: 0.7236
Epoch 9/40
270/270 - 147s - loss: 0.4747 - accuracy: 0.7861 - val_loss: 0.8459 - val_accuracy: 0.5584
Epoch 10/40
270/270 - 143s - loss: 0.4152 - accuracy: 0.8195 - val_loss: 1.6022 - val_accuracy: 0.3729
Epoch 11/40
270/270 - 141s - loss: 0.3574 - accuracy: 0.8531 - val_loss: 0.6327 - val_accuracy: 0.7032
Epoch 12/40
270/270 - 142s - loss: 0.2941 - accuracy: 0.8851 - val_loss: 2.1420 - val_accuracy: 0.4035
Epoch 13/40
270/270 - 145s - loss: 0.2552 - accuracy: 0.9052 - val_loss: 0.8000 - val_accuracy: 0.6484

Epoch 00013: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 14/40
270/270 - 150s - loss: 0.1932 - accuracy: 0.9328 - val_loss: 0.7310 - val_accuracy: 0.7069
Epoch 15/40
270/270 - 150s - loss: 0.1489 - accuracy: 0.9541 - val_loss: 0.7135 - val_accuracy: 0.7254
Epoch 16/40
270/270 - 150s - loss: 0.1301 - accuracy: 0.9601 - val_loss: 0.7977 - val_accuracy: 0.6911
Epoch 17/40
270/270 - 156s - loss: 0.1242 - accuracy: 0.9613 - val_loss: 1.6778 - val_accuracy: 0.5445
Epoch 18/40
270/270 - 153s - loss: 0.1012 - accuracy: 0.9685 - val_loss: 1.0557 - val_accuracy: 0.6373
Epoch 19/40
270/270 - 158s - loss: 0.0913 - accuracy: 0.9773 - val_loss: 1.2500 - val_accuracy: 0.6317

Epoch 00019: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 20/40
270/270 - 150s - loss: 0.0864 - accuracy: 0.9745 - val_loss: 0.8772 - val_accuracy: 0.7347
Epoch 21/40
270/270 - 157s - loss: 0.0714 - accuracy: 0.9833 - val_loss: 0.8178 - val_accuracy: 0.7412
Epoch 22/40
270/270 - 152s - loss: 0.0592 - accuracy: 0.9866 - val_loss: 0.8675 - val_accuracy: 0.7226
Epoch 23/40
270/270 - 151s - loss: 0.0604 - accuracy: 0.9831 - val_loss: 0.9412 - val_accuracy: 0.7004
Epoch 24/40
270/270 - 157s - loss: 0.0473 - accuracy: 0.9886 - val_loss: 0.9350 - val_accuracy: 0.7375
Epoch 25/40
270/270 - 150s - loss: 0.0416 - accuracy: 0.9914 - val_loss: 1.0893 - val_accuracy: 0.6920
Epoch 26/40
270/270 - 157s - loss: 0.0451 - accuracy: 0.9898 - val_loss: 0.9691 - val_accuracy: 0.7143
Epoch 27/40
270/270 - 154s - loss: 0.0443 - accuracy: 0.9896 - val_loss: 1.0512 - val_accuracy: 0.7217

Epoch 00027: ReduceLROnPlateau reducing learning rate to 0.00031640623637940735.
Epoch 28/40
270/270 - 151s - loss: 0.0464 - accuracy: 0.9873 - val_loss: 0.9849 - val_accuracy: 0.7384
Epoch 29/40
270/270 - 150s - loss: 0.0393 - accuracy: 0.9907 - val_loss: 0.9512 - val_accuracy: 0.7412
Epoch 30/40
270/270 - 150s - loss: 0.0367 - accuracy: 0.9882 - val_loss: 1.3403 - val_accuracy: 0.6688
Epoch 31/40
270/270 - 158s - loss: 0.0306 - accuracy: 0.9914 - val_loss: 0.9794 - val_accuracy: 0.7551
Epoch 32/40
270/270 - 154s - loss: 0.0266 - accuracy: 0.9954 - val_loss: 0.9442 - val_accuracy: 0.7430
Epoch 33/40
270/270 - 150s - loss: 0.0365 - accuracy: 0.9910 - val_loss: 1.0118 - val_accuracy: 0.7430
Epoch 34/40
270/270 - 158s - loss: 0.0274 - accuracy: 0.9933 - val_loss: 1.0030 - val_accuracy: 0.7319
Epoch 35/40
270/270 - 155s - loss: 0.0266 - accuracy: 0.9942 - val_loss: 1.0616 - val_accuracy: 0.7347
Epoch 36/40
270/270 - 150s - loss: 0.0258 - accuracy: 0.9937 - val_loss: 0.9860 - val_accuracy: 0.7412
Epoch 37/40
270/270 - 150s - loss: 0.0245 - accuracy: 0.9947 - val_loss: 1.0536 - val_accuracy: 0.7440

Epoch 00037: ReduceLROnPlateau reducing learning rate to 0.00023730468819849193.
Epoch 38/40
270/270 - 150s - loss: 0.0261 - accuracy: 0.9944 - val_loss: 1.0805 - val_accuracy: 0.7412
Epoch 39/40
270/270 - 150s - loss: 0.0190 - accuracy: 0.9963 - val_loss: 1.0525 - val_accuracy: 0.7514
Epoch 40/40
270/270 - 150s - loss: 0.0218 - accuracy: 0.9961 - val_loss: 1.1468 - val_accuracy: 0.7189

 See logs at ../../cache/conv___04_1116___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___mixednet___2052/logs/