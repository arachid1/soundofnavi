Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2306
Description:  augmix
2021-07-12 13:32:02.434334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-12 13:32:05.191778: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-12 13:32:05.192880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-12 13:32:05.205811: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:32:05.206515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-12 13:32:05.206547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-12 13:32:05.210894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-12 13:32:05.211000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-12 13:32:05.214309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-12 13:32:05.214773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-12 13:32:05.216649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-12 13:32:05.218488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-12 13:32:05.218698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-12 13:32:05.218886: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:32:05.220031: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:32:05.220962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2306.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2306__07_1330__v39__augmix
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-12 13:49:05.870881: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-12 13:49:05.871285: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:49:05.873114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-12 13:49:05.873186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-12 13:49:05.873281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-12 13:49:05.873318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-12 13:49:05.873359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-12 13:49:05.873387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-12 13:49:05.873415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-12 13:49:05.873448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-12 13:49:05.873475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-12 13:49:05.873610: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:49:05.874654: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:49:05.875569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-12 13:49:05.875670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-12 13:49:06.639677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-12 13:49:06.639726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-12 13:49:06.639736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-12 13:49:06.640056: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:49:06.640887: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:49:06.641574: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-12 13:49:06.642216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-07-12 13:49:07.702072: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-12 13:49:07.703584: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-12 13:49:09.430288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-12 13:49:10.145701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-12 13:49:10.152452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_14
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_15
Length of training samples after augmix augmentation: 3416
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
214/214 - 125s - loss: 0.5109 - accuracy: 0.6923 - val_loss: 0.4802 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.089540377412072
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
214/214 - 118s - loss: 0.3333 - accuracy: 0.8267 - val_loss: 0.2849 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.511481876482399
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
214/214 - 115s - loss: 0.2523 - accuracy: 0.8835 - val_loss: 0.1634 - val_accuracy: 0.9414
Confusion matrix: 
 [[551  22]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.341 0.659]]
Validation f1: 60.00
Validation accuracy: 94.14
Validation recall: 65.85
Validation precision: 55.10
Validation AUC: 0.7014376810436764
Validation class accuracies: [0.9616055846422339, 0.6585365853658537]
Saving model...
Epoch 4/65
214/214 - 118s - loss: 0.1736 - accuracy: 0.9166 - val_loss: 0.3664 - val_accuracy: 0.8730
Confusion matrix: 
 [[506  67]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.268 0.732]]
Validation f1: 43.48
Validation accuracy: 87.30
Validation recall: 73.17
Validation precision: 30.93
Validation AUC: 0.576833563676118
Validation class accuracies: [0.8830715532286213, 0.7317073170731707]
The validation tracker metric at 0.6 hasn't increased by 0 in 1 epochs
Epoch 5/65
214/214 - 118s - loss: 0.1284 - accuracy: 0.9458 - val_loss: 0.8890 - val_accuracy: 0.7524
Confusion matrix: 
 [[425 148]
 [  4  37]]
Normalized Confusion matrix: 
 [[0.742 0.258]
 [0.098 0.902]]
Validation f1: 32.74
Validation accuracy: 75.24
Validation recall: 90.24
Validation precision: 20.00
Validation AUC: 0.6683703929430156
Validation class accuracies: [0.7417102966841187, 0.9024390243902439]
The validation tracker metric at 0.6 hasn't increased by 0 in 2 epochs
Epoch 6/65
214/214 - 116s - loss: 0.1123 - accuracy: 0.9540 - val_loss: 0.7576 - val_accuracy: 0.6987
Confusion matrix: 
 [[392 181]
 [  4  37]]
Normalized Confusion matrix: 
 [[0.684 0.316]
 [0.098 0.902]]
Validation f1: 28.57
Validation accuracy: 69.87
Validation recall: 90.24
Validation precision: 16.97
Validation AUC: 0.6065856305731413
Validation class accuracies: [0.6841186736474695, 0.9024390243902439]
The validation tracker metric at 0.6 hasn't increased by 0 in 3 epochs
Epoch 7/65
214/214 - 118s - loss: 0.0795 - accuracy: 0.9707 - val_loss: 1.9395 - val_accuracy: 0.6759
Confusion matrix: 
 [[376 197]
 [  2  39]]
Normalized Confusion matrix: 
 [[0.656 0.344]
 [0.049 0.951]]
Validation f1: 28.16
Validation accuracy: 67.59
Validation recall: 95.12
Validation precision: 16.53
Validation AUC: 0.6517088782730954
Validation class accuracies: [0.6561954624781849, 0.9512195121951219]
The validation tracker metric at 0.6 hasn't increased by 0 in 4 epochs
Epoch 8/65
214/214 - 118s - loss: 0.0862 - accuracy: 0.9637 - val_loss: 0.3266 - val_accuracy: 0.9104
Confusion matrix: 
 [[531  42]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.317 0.683]]
Validation f1: 50.45
Validation accuracy: 91.04
Validation recall: 68.29
Validation precision: 40.00
Validation AUC: 0.5830555447052634
Validation class accuracies: [0.9267015706806283, 0.6829268292682927]
The validation tracker metric at 0.6 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 9/65
214/214 - 116s - loss: 0.0441 - accuracy: 0.9854 - val_loss: 0.3404 - val_accuracy: 0.9121
Confusion matrix: 
 [[531  42]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.293 0.707]]
Validation f1: 51.79
Validation accuracy: 91.21
Validation recall: 70.73
Validation precision: 40.85
Validation AUC: 0.5977542838803187
Validation class accuracies: [0.9267015706806283, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 6 epochs
Epoch 10/65
214/214 - 115s - loss: 0.0415 - accuracy: 0.9848 - val_loss: 0.3423 - val_accuracy: 0.9137
Confusion matrix: 
 [[532  41]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.293 0.707]]
Validation f1: 52.25
Validation accuracy: 91.37
Validation recall: 70.73
Validation precision: 41.43
Validation AUC: 0.6260697208527802
Validation class accuracies: [0.9284467713787086, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 7 epochs
Epoch 11/65
214/214 - 115s - loss: 0.0373 - accuracy: 0.9883 - val_loss: 0.3572 - val_accuracy: 0.9072
Confusion matrix: 
 [[528  45]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.293 0.707]]
Validation f1: 50.43
Validation accuracy: 90.72
Validation recall: 70.73
Validation precision: 39.19
Validation AUC: 0.6034711547823106
Validation class accuracies: [0.9214659685863874, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 8 epochs
Epoch 12/65
214/214 - 115s - loss: 0.0344 - accuracy: 0.9874 - val_loss: 0.3116 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.6476407126076323
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 9 epochs
Epoch 13/65
214/214 - 114s - loss: 0.0311 - accuracy: 0.9898 - val_loss: 0.3507 - val_accuracy: 0.9186
Confusion matrix: 
 [[535  38]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.293 0.707]]
Validation f1: 53.70
Validation accuracy: 91.86
Validation recall: 70.73
Validation precision: 43.28
Validation AUC: 0.6214137928470348
Validation class accuracies: [0.9336823734729494, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 14/65
214/214 - 115s - loss: 0.0298 - accuracy: 0.9903 - val_loss: 0.3455 - val_accuracy: 0.9169
Confusion matrix: 
 [[534  39]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.293 0.707]]
Validation f1: 53.21
Validation accuracy: 91.69
Validation recall: 70.73
Validation precision: 42.65
Validation AUC: 0.6299048673777212
Validation class accuracies: [0.9319371727748691, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 11 epochs
Epoch 15/65
214/214 - 115s - loss: 0.0286 - accuracy: 0.9906 - val_loss: 0.3613 - val_accuracy: 0.9137
Confusion matrix: 
 [[532  41]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.293 0.707]]
Validation f1: 52.25
Validation accuracy: 91.37
Validation recall: 70.73
Validation precision: 41.43
Validation AUC: 0.6346768972488371
Validation class accuracies: [0.9284467713787086, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 12 epochs
Epoch 16/65
214/214 - 116s - loss: 0.0244 - accuracy: 0.9927 - val_loss: 0.3421 - val_accuracy: 0.9169
Confusion matrix: 
 [[534  39]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.293 0.707]]
Validation f1: 53.21
Validation accuracy: 91.69
Validation recall: 70.73
Validation precision: 42.65
Validation AUC: 0.648282723600879
Validation class accuracies: [0.9319371727748691, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 13 epochs
Epoch 17/65
214/214 - 115s - loss: 0.0282 - accuracy: 0.9924 - val_loss: 0.3629 - val_accuracy: 0.9137
Confusion matrix: 
 [[532  41]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.293 0.707]]
Validation f1: 52.25
Validation accuracy: 91.37
Validation recall: 70.73
Validation precision: 41.43
Validation AUC: 0.6551514924545098
Validation class accuracies: [0.9284467713787086, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 14 epochs
Epoch 18/65
214/214 - 116s - loss: 0.0256 - accuracy: 0.9936 - val_loss: 0.3704 - val_accuracy: 0.9121
Confusion matrix: 
 [[531  42]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.293 0.707]]
Validation f1: 51.79
Validation accuracy: 91.21
Validation recall: 70.73
Validation precision: 40.85
Validation AUC: 0.649485148810319
Validation class accuracies: [0.9267015706806283, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 19/65
214/214 - 118s - loss: 0.0278 - accuracy: 0.9933 - val_loss: 0.3577 - val_accuracy: 0.9121
Confusion matrix: 
 [[531  42]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.293 0.707]]
Validation f1: 51.79
Validation accuracy: 91.21
Validation recall: 70.73
Validation precision: 40.85
Validation AUC: 0.6523925521821177
Validation class accuracies: [0.9267015706806283, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 16 epochs
Epoch 20/65
214/214 - 115s - loss: 0.0256 - accuracy: 0.9953 - val_loss: 0.3465 - val_accuracy: 0.9153
Confusion matrix: 
 [[533  40]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.293 0.707]]
Validation f1: 52.73
Validation accuracy: 91.53
Validation recall: 70.73
Validation precision: 42.03
Validation AUC: 0.6542304559148181
Validation class accuracies: [0.9301919720767888, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 17 epochs
Epoch 21/65
214/214 - 118s - loss: 0.0207 - accuracy: 0.9939 - val_loss: 0.3425 - val_accuracy: 0.9169
Confusion matrix: 
 [[534  39]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.293 0.707]]
Validation f1: 53.21
Validation accuracy: 91.69
Validation recall: 70.73
Validation precision: 42.65
Validation AUC: 0.6545957335220054
Validation class accuracies: [0.9319371727748691, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 18 epochs
Epoch 22/65
214/214 - 118s - loss: 0.0250 - accuracy: 0.9933 - val_loss: 0.3523 - val_accuracy: 0.9121
Confusion matrix: 
 [[531  42]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.293 0.707]]
Validation f1: 51.79
Validation accuracy: 91.21
Validation recall: 70.73
Validation precision: 40.85
Validation AUC: 0.6559221736998165
Validation class accuracies: [0.9267015706806283, 0.7073170731707317]
The validation tracker metric at 0.6 hasn't increased by 0 in 19 epochs
Epoch 23/65
214/214 - 115s - loss: 0.0269 - accuracy: 0.9947 - val_loss: 0.3533 - val_accuracy: 0.9121
Confusion matrix: 
 [[531  42]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.293 0.707]]
Validation f1: 51.79
Validation accuracy: 91.21
Validation recall: 70.73
Validation precision: 40.85
Validation AUC: 0.6541032402024115
Validation class accuracies: [0.9267015706806283, 0.7073170731707317]

The metrics for job 0 with the best target metric are: 
Best cm: [[551  22]
 [ 14  27]]
Best normalized cm: [[0.962 0.038]
 [0.341 0.659]]
Best f1: 0.60
Best accuracy: 0.94
Best recall: 0.66
Best precision: 0.55
Best AUC: 0.70
Best class accuracies: [0.9616055846422339, 0.6585365853658537]
Best epoch: 3
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.087]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.151]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.088]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_1.png, [[0.823]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.026]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.337]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.156]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[6.462e-05]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.072]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.03]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.999]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.39]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.035]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.14]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.045]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.021]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[7.064e-05]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.015]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.162]]
../../new_cache/conv__2306__07_1330__v39__augmix/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.642]]
wandb: Waiting for W&B process to finish, PID 700
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210712_133205-1uw9whwr/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210712_133205-1uw9whwr/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99473
wandb:         val_accuracy 0.91205
wandb:             _runtime 3967
wandb:           _timestamp 1626100692
wandb:                _step 163
wandb:           train_loss 0.02691
wandb:             val_loss 0.35334
wandb:           val_recall 0.70732
wandb:        val_precision 0.40845
wandb:               val_f1 0.51786
wandb:              val_auc 0.6541
wandb:                   lr 2e-05
wandb:          best_val_f1 0.6
wandb:    best_val_accuracy 0.94137
wandb:   best_val_precision 0.55102
wandb:      best_val_recall 0.65854
wandb:             best_auc 0.70144
wandb:           best_epoch 3
wandb: Run history:
wandb:   train_accuracy ▁▄▅▆▇▇▇▇███████████████
wandb:     val_accuracy ███▆▃▂▁▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▁▂▄▃█▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ▁▁▆▆███▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▁█▅▄▃▃▆▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_f1 ▁▁█▆▅▄▄▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▆█▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr ████████▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210712_133205-1uw9whwr


 See logs at ../../new_cache/conv__2306__07_1330__v39__augmix/logs/