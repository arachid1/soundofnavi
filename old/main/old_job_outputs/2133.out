Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2133
Description:  mixednet_undersampled
2021-05-12 22:10:24.126246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-12 22:10:26.297433: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-12 22:10:26.298349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-12 22:10:26.345408: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:26.346105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-12 22:10:26.346138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-12 22:10:26.349632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-12 22:10:26.349713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-12 22:10:26.350809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-12 22:10:26.351107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-12 22:10:26.352088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-12 22:10:26.352984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-12 22:10:26.353135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-12 22:10:26.353251: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:26.354011: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:26.354636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2133.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2133__05_2209__v29__mixednet_undersampled/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 22, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2133
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/3bwrfy8g
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210512_221026-3bwrfy8g
wandb: Run `wandb offline` to turn off syncing.
2021-05-12 22:10:31.856349: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-12 22:10:31.856674: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:31.857661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-12 22:10:31.857741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-12 22:10:31.857883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-12 22:10:31.857926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-12 22:10:31.857960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-12 22:10:31.858009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-12 22:10:31.858042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-12 22:10:31.858076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-12 22:10:31.858109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-12 22:10:31.858251: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:31.859290: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:31.860197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-12 22:10:31.860255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-12 22:10:32.762798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-12 22:10:32.762844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-12 22:10:32.762857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-12 22:10:32.763164: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:32.764134: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:32.765442: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-12 22:10:32.766406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-12 22:11:18.649997: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-12 22:11:18.651774: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-12 22:11:20.232898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-12 22:11:20.944117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-12 22:11:20.990764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
1150
1150
With concat = False and six = False, size of training set: 2300...
...and size of validation set: 1088
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,967
Trainable params: 105,471
Non-trainable params: 496
_________________________________________________________________
Epoch 1/80
144/144 - 100s - loss: 0.6887 - accuracy: 0.5413 - val_loss: 0.7275 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.26225750679087123
Validation class accuracies: [0.0, 1.0]
TARGET: 0
target metric(test auc): 0.26225750679087123
column_sums: [   0 1088]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
144/144 - 90s - loss: 0.6760 - accuracy: 0.5835 - val_loss: 0.6964 - val_accuracy: 0.2040
Confusion matrix: 
 [[  7 863]
 [  3 215]]
Validation f1: 33.18
Validation accuracy: 20.40
Validation recall: 98.62
Validation precision: 19.94
Validation AUC: 0.2584113762998088
Validation class accuracies: [0.008045977011494253, 0.9862385321100917]
TARGET: 0
target metric(test auc): 0.2584113762998088
column_sums: [  10 1078]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
144/144 - 92s - loss: 0.6690 - accuracy: 0.5943 - val_loss: 0.6144 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2455293674487235
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.2455293674487235
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
144/144 - 90s - loss: 0.6557 - accuracy: 0.6109 - val_loss: 0.6000 - val_accuracy: 0.7858
Confusion matrix: 
 [[843  27]
 [206  12]]
Validation f1: 9.34
Validation accuracy: 78.58
Validation recall: 5.50
Validation precision: 30.77
Validation AUC: 0.22506496703176088
Validation class accuracies: [0.9689655172413794, 0.05504587155963303]
TARGET: 0
target metric(test auc): 0.22506496703176088
column_sums: [1049   39]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
144/144 - 90s - loss: 0.6329 - accuracy: 0.6270 - val_loss: 0.6007 - val_accuracy: 0.7381
Confusion matrix: 
 [[777  93]
 [192  26]]
Validation f1: 15.43
Validation accuracy: 73.81
Validation recall: 11.93
Validation precision: 21.85
Validation AUC: 0.22783750964736246
Validation class accuracies: [0.8931034482758621, 0.11926605504587157]
TARGET: 0
target metric(test auc): 0.22783750964736246
column_sums: [969 119]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 6/80
144/144 - 91s - loss: 0.6102 - accuracy: 0.6735 - val_loss: 0.6925 - val_accuracy: 0.5726
Confusion matrix: 
 [[530 340]
 [125  93]]
Validation f1: 28.57
Validation accuracy: 57.26
Validation recall: 42.66
Validation precision: 21.48
Validation AUC: 0.23169504190297532
Validation class accuracies: [0.6091954022988506, 0.42660550458715596]
TARGET: 0
target metric(test auc): 0.23169504190297532
column_sums: [655 433]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 7/80
144/144 - 92s - loss: 0.5622 - accuracy: 0.7083 - val_loss: 1.0502 - val_accuracy: 0.4467
Confusion matrix: 
 [[335 535]
 [ 67 151]]
Validation f1: 33.41
Validation accuracy: 44.67
Validation recall: 69.27
Validation precision: 22.01
Validation AUC: 0.23840646031968787
Validation class accuracies: [0.3850574712643678, 0.6926605504587156]
TARGET: 0
target metric(test auc): 0.23840646031968787
column_sums: [402 686]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 8/80
144/144 - 92s - loss: 0.5165 - accuracy: 0.7578 - val_loss: 1.6870 - val_accuracy: 0.3051
Confusion matrix: 
 [[134 736]
 [ 20 198]]
Validation f1: 34.38
Validation accuracy: 30.51
Validation recall: 90.83
Validation precision: 21.20
Validation AUC: 0.25509534614002927
Validation class accuracies: [0.15402298850574714, 0.908256880733945]
TARGET: 0
target metric(test auc): 0.25509534614002927
column_sums: [154 934]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 9/80
144/144 - 91s - loss: 0.4550 - accuracy: 0.7957 - val_loss: 0.6613 - val_accuracy: 0.6415
Confusion matrix: 
 [[620 250]
 [140  78]]
Validation f1: 28.57
Validation accuracy: 64.15
Validation recall: 35.78
Validation precision: 23.78
Validation AUC: 0.2668383605814427
Validation class accuracies: [0.7126436781609196, 0.3577981651376147]
TARGET: 0
target metric(test auc): 0.2668383605814427
column_sums: [760 328]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 10/80
144/144 - 91s - loss: 0.3949 - accuracy: 0.8348 - val_loss: 0.8917 - val_accuracy: 0.5478
Confusion matrix: 
 [[499 371]
 [121  97]]
Validation f1: 28.28
Validation accuracy: 54.78
Validation recall: 44.50
Validation precision: 20.73
Validation AUC: 0.23217669158357687
Validation class accuracies: [0.5735632183908046, 0.44495412844036697]
TARGET: 0
target metric(test auc): 0.23217669158357687
column_sums: [620 468]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 1 epochs
Epoch 11/80
144/144 - 91s - loss: 0.3272 - accuracy: 0.8665 - val_loss: 0.9599 - val_accuracy: 0.5119
Confusion matrix: 
 [[467 403]
 [128  90]]
Validation f1: 25.32
Validation accuracy: 51.19
Validation recall: 41.28
Validation precision: 18.26
Validation AUC: 0.2192392875444027
Validation class accuracies: [0.5367816091954023, 0.41284403669724773]
TARGET: 0
target metric(test auc): 0.2192392875444027
column_sums: [595 493]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 2 epochs
Epoch 12/80
144/144 - 91s - loss: 0.2737 - accuracy: 0.8917 - val_loss: 2.1878 - val_accuracy: 0.2849
Confusion matrix: 
 [[118 752]
 [ 26 192]]
Validation f1: 33.05
Validation accuracy: 28.49
Validation recall: 88.07
Validation precision: 20.34
Validation AUC: 0.24287224556958575
Validation class accuracies: [0.135632183908046, 0.8807339449541285]
TARGET: 0
target metric(test auc): 0.24287224556958575
column_sums: [144 944]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 3 epochs
Epoch 13/80
144/144 - 91s - loss: 0.2192 - accuracy: 0.9257 - val_loss: 0.8733 - val_accuracy: 0.6884
Confusion matrix: 
 [[717 153]
 [186  32]]
Validation f1: 15.88
Validation accuracy: 68.84
Validation recall: 14.68
Validation precision: 17.30
Validation AUC: 0.21228886065781766
Validation class accuracies: [0.8241379310344827, 0.14678899082568808]
TARGET: 0
target metric(test auc): 0.21228886065781766
column_sums: [903 185]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 4 epochs
Epoch 14/80
144/144 - 96s - loss: 0.1628 - accuracy: 0.9552 - val_loss: 1.1886 - val_accuracy: 0.4926
Confusion matrix: 
 [[418 452]
 [100 118]]
Validation f1: 29.95
Validation accuracy: 49.26
Validation recall: 54.13
Validation precision: 20.70
Validation AUC: 0.23217186993482053
Validation class accuracies: [0.4804597701149425, 0.5412844036697247]
TARGET: 0
target metric(test auc): 0.23217186993482053
column_sums: [518 570]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 5 epochs
Epoch 15/80
144/144 - 91s - loss: 0.1303 - accuracy: 0.9639 - val_loss: 1.6248 - val_accuracy: 0.3787
Confusion matrix: 
 [[261 609]
 [ 67 151]]
Validation f1: 30.88
Validation accuracy: 37.87
Validation recall: 69.27
Validation precision: 19.87
Validation AUC: 0.23441293189305462
Validation class accuracies: [0.3, 0.6926605504587156]
TARGET: 0
target metric(test auc): 0.23441293189305462
column_sums: [328 760]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 6 epochs
Epoch 16/80
144/144 - 91s - loss: 0.1225 - accuracy: 0.9717 - val_loss: 1.3209 - val_accuracy: 0.4945
Confusion matrix: 
 [[408 462]
 [ 88 130]]
Validation f1: 32.10
Validation accuracy: 49.45
Validation recall: 59.63
Validation precision: 21.96
Validation AUC: 0.24768367183414713
Validation class accuracies: [0.4689655172413793, 0.5963302752293578]
TARGET: 0
target metric(test auc): 0.24768367183414713
column_sums: [496 592]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 7 epochs
Epoch 17/80
144/144 - 90s - loss: 0.1157 - accuracy: 0.9687 - val_loss: 1.3714 - val_accuracy: 0.4853
Confusion matrix: 
 [[396 474]
 [ 86 132]]
Validation f1: 32.04
Validation accuracy: 48.53
Validation recall: 60.55
Validation precision: 21.78
Validation AUC: 0.239110035059325
Validation class accuracies: [0.45517241379310347, 0.6055045871559633]
TARGET: 0
target metric(test auc): 0.239110035059325
column_sums: [482 606]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 8 epochs
Epoch 18/80
144/144 - 91s - loss: 0.1049 - accuracy: 0.9770 - val_loss: 1.1590 - val_accuracy: 0.5312
Confusion matrix: 
 [[478 392]
 [118 100]]
Validation f1: 28.17
Validation accuracy: 53.12
Validation recall: 45.87
Validation precision: 20.33
Validation AUC: 0.23497162493770132
Validation class accuracies: [0.5494252873563218, 0.45871559633027525]
TARGET: 0
target metric(test auc): 0.23497162493770132
column_sums: [596 492]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 9 epochs
Epoch 19/80
144/144 - 95s - loss: 0.1013 - accuracy: 0.9765 - val_loss: 1.0567 - val_accuracy: 0.5634
Confusion matrix: 
 [[529 341]
 [134  84]]
Validation f1: 26.13
Validation accuracy: 56.34
Validation recall: 38.53
Validation precision: 19.76
Validation AUC: 0.2282614909889411
Validation class accuracies: [0.6080459770114942, 0.3853211009174312]
TARGET: 0
target metric(test auc): 0.2282614909889411
column_sums: [663 425]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 10 epochs
Epoch 20/80
144/144 - 91s - loss: 0.0818 - accuracy: 0.9904 - val_loss: 1.0734 - val_accuracy: 0.5662
Confusion matrix: 
 [[533 337]
 [135  83]]
Validation f1: 26.02
Validation accuracy: 56.62
Validation recall: 38.07
Validation precision: 19.76
Validation AUC: 0.2311676865163361
Validation class accuracies: [0.6126436781609196, 0.38073394495412843]
TARGET: 0
target metric(test auc): 0.2311676865163361
column_sums: [668 420]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 11 epochs
Epoch 21/80
144/144 - 91s - loss: 0.1041 - accuracy: 0.9757 - val_loss: 1.1307 - val_accuracy: 0.5496
Confusion matrix: 
 [[505 365]
 [125  93]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.51
Validation accuracy: 54.96
Validation recall: 42.66
Validation precision: 20.31
Validation AUC: 0.23545574538482006
Validation class accuracies: [0.5804597701149425, 0.42660550458715596]
TARGET: 0
target metric(test auc): 0.23545574538482006
column_sums: [630 458]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 12 epochs
Epoch 22/80
144/144 - 90s - loss: 0.0900 - accuracy: 0.9822 - val_loss: 1.1179 - val_accuracy: 0.5570
Confusion matrix: 
 [[519 351]
 [131  87]]
Validation f1: 26.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 55.70
Validation recall: 39.91
Validation precision: 19.86
Validation AUC: 0.23444663080539418
Validation class accuracies: [0.596551724137931, 0.39908256880733944]
TARGET: 0
target metric(test auc): 0.23444663080539418
column_sums: [650 438]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 13 epochs
Epoch 23/80
144/144 - 91s - loss: 0.0946 - accuracy: 0.9813 - val_loss: 1.1472 - val_accuracy: 0.5496
Confusion matrix: 
 [[503 367]
 [123  95]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.94
Validation accuracy: 54.96
Validation recall: 43.58
Validation precision: 20.56
Validation AUC: 0.23538587811295733
Validation class accuracies: [0.5781609195402299, 0.43577981651376146]
TARGET: 0
target metric(test auc): 0.23538587811295733
column_sums: [626 462]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 14 epochs
Epoch 24/80
144/144 - 90s - loss: 0.0881 - accuracy: 0.9826 - val_loss: 1.1357 - val_accuracy: 0.5496
Confusion matrix: 
 [[508 362]
 [128  90]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.87
Validation accuracy: 54.96
Validation recall: 41.28
Validation precision: 19.91
Validation AUC: 0.23510012340211092
Validation class accuracies: [0.5839080459770115, 0.41284403669724773]
TARGET: 0
target metric(test auc): 0.23510012340211092
column_sums: [636 452]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 15 epochs
Epoch 25/80
144/144 - 91s - loss: 0.0912 - accuracy: 0.9787 - val_loss: 1.1455 - val_accuracy: 0.5478
Confusion matrix: 
 [[505 365]
 [127  91]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.00
Validation accuracy: 54.78
Validation recall: 41.74
Validation precision: 19.96
Validation AUC: 0.2348793070925172
Validation class accuracies: [0.5804597701149425, 0.41743119266055045]
TARGET: 0
target metric(test auc): 0.2348793070925172
column_sums: [632 456]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 16 epochs
Epoch 26/80
144/144 - 90s - loss: 0.0919 - accuracy: 0.9813 - val_loss: 1.1373 - val_accuracy: 0.5487
Confusion matrix: 
 [[507 363]
 [128  90]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.83
Validation accuracy: 54.87
Validation recall: 41.28
Validation precision: 19.87
Validation AUC: 0.23477401672088183
Validation class accuracies: [0.5827586206896552, 0.41284403669724773]
TARGET: 0
target metric(test auc): 0.23477401672088183
column_sums: [635 453]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 17 epochs
Epoch 27/80
144/144 - 91s - loss: 0.0901 - accuracy: 0.9843 - val_loss: 1.1449 - val_accuracy: 0.5496
Confusion matrix: 
 [[507 363]
 [127  91]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.08
Validation accuracy: 54.96
Validation recall: 41.74
Validation precision: 20.04
Validation AUC: 0.23425396186809222
Validation class accuracies: [0.5827586206896552, 0.41743119266055045]
TARGET: 0
target metric(test auc): 0.23425396186809222
column_sums: [634 454]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 18 epochs
Epoch 28/80
144/144 - 90s - loss: 0.0883 - accuracy: 0.9835 - val_loss: 1.1651 - val_accuracy: 0.5460
Confusion matrix: 
 [[499 371]
 [123  95]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.78
Validation accuracy: 54.60
Validation recall: 43.58
Validation precision: 20.39
Validation AUC: 0.2351191672603457
Validation class accuracies: [0.5735632183908046, 0.43577981651376146]
TARGET: 0
target metric(test auc): 0.2351191672603457
column_sums: [622 466]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 19 epochs
Epoch 29/80
144/144 - 90s - loss: 0.0946 - accuracy: 0.9800 - val_loss: 1.1547 - val_accuracy: 0.5478
Confusion matrix: 
 [[504 366]
 [126  92]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 27.22
Validation accuracy: 54.78
Validation recall: 42.20
Validation precision: 20.09
Validation AUC: 0.23425082235298722
Validation class accuracies: [0.5793103448275863, 0.42201834862385323]
TARGET: 0
target metric(test auc): 0.23425082235298722
column_sums: [630 458]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 20 epochs
Epoch 30/80
144/144 - 90s - loss: 0.0908 - accuracy: 0.9813 - val_loss: 1.1447 - val_accuracy: 0.5496
Confusion matrix: 
 [[507 363]
 [127  91]]
Validation f1: 27.08
Validation accuracy: 54.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 41.74
Validation precision: 20.04
Validation AUC: 0.23379695866985037
Validation class accuracies: [0.5827586206896552, 0.41743119266055045]
TARGET: 0
target metric(test auc): 0.23379695866985037
column_sums: [634 454]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.2668383605814427 hasn't increased by 0 in 21 epochs
Epoch 31/80
144/144 - 91s - loss: 0.0843 - accuracy: 0.9848 - val_loss: 1.1389 - val_accuracy: 0.5496
Confusion matrix: 
 [[509 361]
 [129  89]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.65
Validation accuracy: 54.96
Validation recall: 40.83
Validation precision: 19.78
Validation AUC: 0.23385185227884336
Validation class accuracies: [0.5850574712643678, 0.40825688073394495]

The metrics for the epoch with the best target metric are: 
Best cm: [[620 250]
 [140  78]]
Best f1: 0.2857142857142857
Best accuracy: 0.6415441176470589
Best recall: 0.3577981651376147
Best precision: 0.23780487804878048
Best AUC: 0.2668383605814427
Best epoch: 9
TARGET: 0
target metric(test auc): 0.23385185227884336
column_sums: [638 450]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 5
Starting...
CM: [[42 18]
 [ 7  8]]
F1: 0.3902439024390244
AUC: 0.46717948717948715
Accuracy: 0.6666666666666666
Precision: 0.3076923076923077
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2133__05_2209__v29__mixednet_undersampled/validation_sheet_5.xls...
Done.
Epoch: 6
Starting...
CM: [[10 50]
 [ 0 15]]
F1: 0.375
AUC: 0.6153846153846154
Accuracy: 0.3333333333333333
Precision: 0.23076923076923078
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2133__05_2209__v29__mixednet_undersampled/validation_sheet_6.xls...
Done.
Epoch: 7
Starting...
CM: [[ 4 56]
 [ 0 15]]
F1: 0.3488372093023256
AUC: 0.6056338028169014
Accuracy: 0.25333333333333335
Precision: 0.2112676056338028
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2133__05_2209__v29__mixednet_undersampled/validation_sheet_7.xls...
Done.
Epoch: 8
Starting...
CM: [[ 1 59]
 [ 0 15]]
F1: 0.3370786516853933
AUC: 0.6013513513513513
Accuracy: 0.21333333333333335
Precision: 0.20270270270270271
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2133__05_2209__v29__mixednet_undersampled/validation_sheet_8.xls...
Done.
Epoch: 80
Starting...
CM: [[ 7 53]
 [ 1 14]]
F1: 0.34146341463414637
AUC: 0.5778109452736317
Accuracy: 0.28
Precision: 0.208955223880597
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2133__05_2209__v29__mixednet_undersampled/validation_sheet_80.xls...
Done.
Epoch: 9
Starting...
CM: [[12 48]
 [ 3 12]]
F1: 0.32000000000000006
AUC: 0.52
Accuracy: 0.32
Precision: 0.2
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2133__05_2209__v29__mixednet_undersampled/validation_sheet_9.xls...
Done.
wandb: Waiting for W&B process to finish, PID 23383
wandb: Program ended successfully.
wandb: - 0.11MB of 0.11MB uploaded (0.00MB deduped)wandb: \ 0.11MB of 0.13MB uploaded (0.00MB deduped)wandb: | 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb: / 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb: - 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb: \ 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb: | 0.13MB of 0.13MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210512_221026-3bwrfy8g/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210512_221026-3bwrfy8g/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98478
wandb:         val_accuracy 0.54963
wandb:             _runtime 3656
wandb:           _timestamp 1620861082
wandb:                _step 233
wandb:           train_loss 0.08427
wandb:             val_loss 1.13887
wandb:           val_recall 0.40826
wandb:        val_precision 0.19778
wandb:               val_f1 0.26647
wandb:              val_auc 0.23385
wandb:                   lr 0.0
wandb:          best_val_f1 0.28571
wandb:    best_val_accuracy 0.64154
wandb:   best_val_precision 0.2378
wandb:      best_val_recall 0.3578
wandb:             best_auc 0.26684
wandb:           best_epoch 9
wandb:           best_bd_f1 0.375
wandb:          best_bd_auc 0.61538
wandb:     best_bd_accuracy 0.33333
wandb:    best_bd_precision 0.23077
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 6
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▃▄▄▅▆▆▆▇▇█████████████████
wandb:     val_accuracy ▁▁██▇▅▄▂▆▅▅▂▇▄▃▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇██
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇██
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ████▇▇▇▆▅▅▄▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▁▁▁▁▃▆▁▂▃█▂▄▆▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:       val_recall ██▁▁▂▄▆▇▄▄▄▇▂▅▆▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:    val_precision ▆▆▁█▆▆▆▆▆▆▅▆▅▆▆▆▆▆▅▅▆▆▆▆▆▆▆▆▆▆▅
wandb:           val_f1 ██▁▃▄▇██▇▇▆█▄▇▇██▇▆▆▇▆▇▆▆▆▇▇▇▇▆
wandb:          val_auc ▇▇▅▃▃▃▄▆█▄▂▅▁▄▄▆▄▄▃▃▄▄▄▄▄▄▄▄▄▄▄
wandb:               lr █████████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 17 media file(s), 12 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2133: https://wandb.ai/arachid1/tensorboard-integration/runs/3bwrfy8g


 See logs at ../../new_cache/conv__2133__05_2209__v29__mixednet_undersampled/logs/