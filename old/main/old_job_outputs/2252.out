Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2252
Description:  new_augm
2021-06-25 17:00:37.392273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-25 17:00:40.414318: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-25 17:00:40.415405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-25 17:00:40.472753: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:00:40.473451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-25 17:00:40.473483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 17:00:40.478566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 17:00:40.478736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-25 17:00:40.480189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-25 17:00:40.480589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-25 17:00:40.481940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-25 17:00:40.483190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-25 17:00:40.483417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 17:00:40.483590: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:00:40.484753: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:00:40.485689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2252.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2252__06_1648__v39__new_augm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-25 17:04:48.609268: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-25 17:04:48.609673: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:04:48.610444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-25 17:04:48.610495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 17:04:48.610568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 17:04:48.610591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-25 17:04:48.610611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-25 17:04:48.610631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-25 17:04:48.610650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-25 17:04:48.610669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-25 17:04:48.610688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 17:04:48.610781: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:04:48.611534: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:04:48.612197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-25 17:04:48.612270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-25 17:04:49.326601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 17:04:49.326647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-25 17:04:49.326656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-25 17:04:49.326965: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:04:49.327796: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:04:49.328529: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-25 17:04:49.329212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented
Length of training samples after spec augmentation: 2932
-----------------------
Number of train recordings: 2932 with pneumonia: 632 and non-pneumonia: 2300
Length of training samples after audio augmentation: 4132
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_1
Length of training samples after spec augmentation: 4732
-----------------------
Number of train recordings: 4732 with pneumonia: 632 and non-pneumonia: 4100
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-25 17:04:50.652999: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-25 17:04:50.654593: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-25 17:04:51.005303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-25 17:04:52.862984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-25 17:04:53.327249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
296/296 - 414s - loss: 0.9735 - accuracy: 0.5619 - val_loss: 0.8323 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.26900395834071733
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
296/296 - 411s - loss: 0.6333 - accuracy: 0.6384 - val_loss: 0.2168 - val_accuracy: 0.9381
Confusion matrix: 
 [[573   0]
 [ 38   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.927 0.073]]
Validation f1: 13.64
Validation accuracy: 93.81
Validation recall: 7.32
Validation precision: 100.00
Validation AUC: 0.579567359077553
Validation class accuracies: [1.0, 0.07317073170731707]
Saving model...
Epoch 3/65
296/296 - 410s - loss: 0.5276 - accuracy: 0.6959 - val_loss: 0.3753 - val_accuracy: 0.8436
Confusion matrix: 
 [[485  88]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.195 0.805]]
Validation f1: 40.74
Validation accuracy: 84.36
Validation recall: 80.49
Validation precision: 27.27
Validation AUC: 0.506403999599818
Validation class accuracies: [0.8464223385689355, 0.8048780487804879]
Saving model...
Epoch 4/65
296/296 - 410s - loss: 0.4351 - accuracy: 0.7580 - val_loss: 7.1789 - val_accuracy: 0.1792
Confusion matrix: 
 [[ 69 504]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.12 0.88]
 [0.   1.  ]]
Validation f1: 13.99
Validation accuracy: 17.92
Validation recall: 100.00
Validation precision: 7.52
Validation AUC: 0.41654003005429474
Validation class accuracies: [0.12041884816753927, 1.0]
The validation tracker metric at 0.4074074074074074 hasn't increased by 0 in 1 epochs
Epoch 5/65
296/296 - 410s - loss: 0.3578 - accuracy: 0.8153 - val_loss: 2.0257 - val_accuracy: 0.4837
Confusion matrix: 
 [[256 317]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.447 0.553]
 [0.    1.   ]]
Validation f1: 20.55
Validation accuracy: 48.37
Validation recall: 100.00
Validation precision: 11.45
Validation AUC: 0.5370899721002226
Validation class accuracies: [0.4467713787085515, 1.0]
The validation tracker metric at 0.4074074074074074 hasn't increased by 0 in 2 epochs
Epoch 6/65
296/296 - 410s - loss: 0.3673 - accuracy: 0.8170 - val_loss: 0.8881 - val_accuracy: 0.6026
Confusion matrix: 
 [[330 243]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.576 0.424]
 [0.024 0.976]]
Validation f1: 24.69
Validation accuracy: 60.26
Validation recall: 97.56
Validation precision: 14.13
Validation AUC: 0.5059918571369042
Validation class accuracies: [0.5759162303664922, 0.975609756097561]
The validation tracker metric at 0.4074074074074074 hasn't increased by 0 in 3 epochs
Epoch 7/65
296/296 - 410s - loss: 0.2269 - accuracy: 0.8781 - val_loss: 7.1728 - val_accuracy: 0.1156
Confusion matrix: 
 [[ 30 543]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.052 0.948]
 [0.    1.   ]]
Validation f1: 13.12
Validation accuracy: 11.56
Validation recall: 100.00
Validation precision: 7.02
Validation AUC: 0.4017142003035235
Validation class accuracies: [0.05235602094240838, 1.0]
The validation tracker metric at 0.4074074074074074 hasn't increased by 0 in 4 epochs
Epoch 8/65
296/296 - 412s - loss: 0.2634 - accuracy: 0.8745 - val_loss: 1.0445 - val_accuracy: 0.7101
Confusion matrix: 
 [[405 168]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.707 0.293]
 [0.244 0.756]]
Validation f1: 25.83
Validation accuracy: 71.01
Validation recall: 75.61
Validation precision: 15.58
Validation AUC: 0.5083123865779997
Validation class accuracies: [0.7068062827225131, 0.7560975609756098]
The validation tracker metric at 0.4074074074074074 hasn't increased by 0 in 5 epochs
Epoch 9/65
296/296 - 413s - loss: 0.1667 - accuracy: 0.9127 - val_loss: 0.3452 - val_accuracy: 0.9446
Confusion matrix: 
 [[564   9]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.61  0.39 ]]
Validation f1: 48.48
Validation accuracy: 94.46
Validation recall: 39.02
Validation precision: 64.00
Validation AUC: 0.4174411765470973
Validation class accuracies: [0.9842931937172775, 0.3902439024390244]
Saving model...
Epoch 10/65
296/296 - 413s - loss: 0.1439 - accuracy: 0.9279 - val_loss: 0.6484 - val_accuracy: 0.8225
Confusion matrix: 
 [[477  96]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.317 0.683]]
Validation f1: 33.94
Validation accuracy: 82.25
Validation recall: 68.29
Validation precision: 22.58
Validation AUC: 0.5254696905755459
Validation class accuracies: [0.8324607329842932, 0.6829268292682927]
The validation tracker metric at 0.48484848484848486 hasn't increased by 0 in 1 epochs
Epoch 11/65
296/296 - 413s - loss: 0.1029 - accuracy: 0.9531 - val_loss: 0.1731 - val_accuracy: 0.9495
Confusion matrix: 
 [[555  18]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.317 0.683]]
Validation f1: 64.37
Validation accuracy: 94.95
Validation recall: 68.29
Validation precision: 60.87
Validation AUC: 0.6982805370454257
Validation class accuracies: [0.9685863874345549, 0.6829268292682927]
Saving model...
Epoch 12/65
296/296 - 413s - loss: 0.2258 - accuracy: 0.9026 - val_loss: 0.4070 - val_accuracy: 0.8681
Confusion matrix: 
 [[499  74]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.171 0.829]]
Validation f1: 45.64
Validation accuracy: 86.81
Validation recall: 82.93
Validation precision: 31.48
Validation AUC: 0.5666225345058717
Validation class accuracies: [0.8708551483420593, 0.8292682926829268]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 1 epochs
Epoch 13/65
296/296 - 411s - loss: 0.0916 - accuracy: 0.9552 - val_loss: 0.2747 - val_accuracy: 0.9251
Confusion matrix: 
 [[540  33]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.317 0.683]]
Validation f1: 54.90
Validation accuracy: 92.51
Validation recall: 68.29
Validation precision: 45.90
Validation AUC: 0.7054074171784103
Validation class accuracies: [0.9424083769633508, 0.6829268292682927]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 2 epochs
Epoch 14/65
296/296 - 410s - loss: 0.0998 - accuracy: 0.9546 - val_loss: 0.3495 - val_accuracy: 0.8958
Confusion matrix: 
 [[518  55]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.22  0.78 ]]
Validation f1: 50.00
Validation accuracy: 89.58
Validation recall: 78.05
Validation precision: 36.78
Validation AUC: 0.6210977403745679
Validation class accuracies: [0.9040139616055847, 0.7804878048780488]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 3 epochs
Epoch 15/65
296/296 - 410s - loss: 0.0445 - accuracy: 0.9814 - val_loss: 0.2249 - val_accuracy: 0.9495
Confusion matrix: 
 [[555  18]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.37
Validation accuracy: 94.95
Validation recall: 68.29
Validation precision: 60.87
Validation AUC: 0.6995782932044694
Validation class accuracies: [0.9685863874345549, 0.6829268292682927]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 4 epochs
Epoch 16/65
296/296 - 410s - loss: 0.0232 - accuracy: 0.9901 - val_loss: 0.3563 - val_accuracy: 0.9332
Confusion matrix: 
 [[549  24]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.415 0.585]]
Validation f1: 53.93
Validation accuracy: 93.32
Validation recall: 58.54
Validation precision: 50.00
Validation AUC: 0.5872529056963599
Validation class accuracies: [0.9581151832460733, 0.5853658536585366]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 5 epochs
Epoch 17/65
296/296 - 410s - loss: 0.0353 - accuracy: 0.9827 - val_loss: 0.3372 - val_accuracy: 0.8990
Confusion matrix: 
 [[521  52]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.244 0.756]]
Validation f1: 50.00
Validation accuracy: 89.90
Validation recall: 75.61
Validation precision: 37.35
Validation AUC: 0.7006016386984903
Validation class accuracies: [0.9092495636998255, 0.7560975609756098]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 18/65
296/296 - 412s - loss: 0.0514 - accuracy: 0.9829 - val_loss: 0.4081 - val_accuracy: 0.8941
Confusion matrix: 
 [[520  53]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.293 0.707]]
Validation f1: 47.15
Validation accuracy: 89.41
Validation recall: 70.73
Validation precision: 35.37
Validation AUC: 0.6724809345216309
Validation class accuracies: [0.9075043630017452, 0.7073170731707317]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 7 epochs
Epoch 19/65
296/296 - 414s - loss: 0.0163 - accuracy: 0.9934 - val_loss: 0.7249 - val_accuracy: 0.8322
Confusion matrix: 
 [[481  92]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.81
Validation accuracy: 83.22
Validation recall: 73.17
Validation precision: 24.59
Validation AUC: 0.6418981085918923
Validation class accuracies: [0.8394415357766143, 0.7317073170731707]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 8 epochs
Epoch 20/65
296/296 - 414s - loss: 0.0306 - accuracy: 0.9880 - val_loss: 2.3225 - val_accuracy: 0.5700
Confusion matrix: 
 [[314 259]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.548 0.452]
 [0.122 0.878]]
Validation f1: 21.43
Validation accuracy: 57.00
Validation recall: 87.80
Validation precision: 12.20
Validation AUC: 0.482494749078229
Validation class accuracies: [0.5479930191972077, 0.8780487804878049]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 9 epochs
Epoch 21/65
296/296 - 413s - loss: 0.0235 - accuracy: 0.9905 - val_loss: 0.3243 - val_accuracy: 0.9251
Confusion matrix: 
 [[545  28]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.439 0.561]]
Validation f1: 50.00
Validation accuracy: 92.51
Validation recall: 56.10
Validation precision: 45.10
Validation AUC: 0.6167167827627981
Validation class accuracies: [0.9511343804537522, 0.5609756097560976]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 10 epochs
Epoch 22/65
296/296 - 413s - loss: 0.0116 - accuracy: 0.9951 - val_loss: 0.4263 - val_accuracy: 0.9251
Confusion matrix: 
 [[543  30]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.39  0.61 ]]
Validation f1: 52.08
Validation accuracy: 92.51
Validation recall: 60.98
Validation precision: 45.45
Validation AUC: 0.616670469551226
Validation class accuracies: [0.9476439790575916, 0.6097560975609756]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 11 epochs
Epoch 23/65
296/296 - 410s - loss: 0.0082 - accuracy: 0.9968 - val_loss: 0.4116 - val_accuracy: 0.9137
Confusion matrix: 
 [[532  41]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.293 0.707]]
Validation f1: 52.25
Validation accuracy: 91.37
Validation recall: 70.73
Validation precision: 41.43
Validation AUC: 0.6479031077741184
Validation class accuracies: [0.9284467713787086, 0.7073170731707317]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 24/65
296/296 - 410s - loss: 0.0053 - accuracy: 0.9983 - val_loss: 0.3471 - val_accuracy: 0.9283
Confusion matrix: 
 [[544  29]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.366 0.634]]
Validation f1: 54.17
Validation accuracy: 92.83
Validation recall: 63.41
Validation precision: 47.27
Validation AUC: 0.6620284707250734
Validation class accuracies: [0.9493891797556719, 0.6341463414634146]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 13 epochs
Epoch 25/65
296/296 - 410s - loss: 0.0037 - accuracy: 0.9996 - val_loss: 0.3913 - val_accuracy: 0.9235
Confusion matrix: 
 [[541  32]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.366 0.634]]
Validation f1: 52.53
Validation accuracy: 92.35
Validation recall: 63.41
Validation precision: 44.83
Validation AUC: 0.6530127370885694
Validation class accuracies: [0.944153577661431, 0.6341463414634146]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 14 epochs
Epoch 26/65
296/296 - 410s - loss: 0.0059 - accuracy: 0.9977 - val_loss: 0.4463 - val_accuracy: 0.9121
Confusion matrix: 
 [[530  43]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.268 0.732]]
Validation f1: 52.63
Validation accuracy: 91.21
Validation recall: 73.17
Validation precision: 41.10
Validation AUC: 0.6678697019065178
Validation class accuracies: [0.924956369982548, 0.7317073170731707]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 15 epochs
Epoch 27/65
296/296 - 410s - loss: 0.0034 - accuracy: 0.9992 - val_loss: 0.4128 - val_accuracy: 0.9349
Confusion matrix: 
 [[547  26]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.341 0.659]]
Validation f1: 57.45
Validation accuracy: 93.49
Validation recall: 65.85
Validation precision: 50.94
Validation AUC: 0.6640364991789752
Validation class accuracies: [0.9546247818499127, 0.6585365853658537]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 16 epochs
Epoch 28/65
296/296 - 410s - loss: 0.0067 - accuracy: 0.9970 - val_loss: 0.4843 - val_accuracy: 0.9072
Confusion matrix: 
 [[528  45]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.293 0.707]]
Validation f1: 50.43
Validation accuracy: 90.72
Validation recall: 70.73
Validation precision: 39.19
Validation AUC: 0.6481404553330041
Validation class accuracies: [0.9214659685863874, 0.7073170731707317]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 17 epochs
Epoch 29/65
296/296 - 410s - loss: 0.0047 - accuracy: 0.9987 - val_loss: 0.3706 - val_accuracy: 0.9332
Confusion matrix: 
 [[544  29]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.293 0.707]]
Validation f1: 58.59
Validation accuracy: 93.32
Validation recall: 70.73
Validation precision: 50.00
Validation AUC: 0.6684634842471686
Validation class accuracies: [0.9493891797556719, 0.7073170731707317]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 30/65
296/296 - 410s - loss: 0.0024 - accuracy: 0.9996 - val_loss: 0.3611 - val_accuracy: 0.9365
Confusion matrix: 
 [[546  27]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.293 0.707]]
Validation f1: 59.79
Validation accuracy: 93.65
Validation recall: 70.73
Validation precision: 51.79
Validation AUC: 0.6740975755288334
Validation class accuracies: [0.9528795811518325, 0.7073170731707317]
The validation tracker metric at 0.6436781609195402 hasn't increased by 0 in 19 epochs
Epoch 31/65
296/296 - 410s - loss: 0.0024 - accuracy: 0.9996 - val_loss: 0.4155 - val_accuracy: 0.9218
Confusion matrix: 
 [[537  36]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.293 0.707]]
Validation f1: 54.72
Validation accuracy: 92.18
Validation recall: 70.73
Validation precision: 44.62
Validation AUC: 0.6630053048932958
Validation class accuracies: [0.93717277486911, 0.7073170731707317]

The metrics for job 0 with the best target metric are: 
Best cm: [[555  18]
 [ 13  28]]
Best normalized cm: [[0.969 0.031]
 [0.317 0.683]]
Best f1: 0.64
Best accuracy: 0.95
Best recall: 0.68
Best precision: 0.61
Best AUC: 0.70
Best class accuracies: [0.9685863874345549, 0.6829268292682927]
Best epoch: 11
The number of epochs since last 1% equals the patience
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[2.697e-07]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.028]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[4.772e-05]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_1.png, [[0.653]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[1.589e-05]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[3.491e-05]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[7.546e-06]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.439]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[5.699e-06]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.313e-08]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[2.488e-05]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[8.677e-05]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[3.174e-05]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.942]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[6.673e-06]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[4.902e-07]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[5.978e-06]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.047]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[7.997e-07]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[1.079e-07]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[2.803e-08]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_1.png, [[0.923]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.633e-06]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[3.67e-07]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.844e-05]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[7.743e-06]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[1.848e-08]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2252__06_1648__v39__new_augm/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.094]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 32513
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_170040-1hruda48/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_170040-1hruda48/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99958
wandb:         val_accuracy 0.92182
wandb:             _runtime 13429
wandb:           _timestamp 1624653870
wandb:                _step 231
wandb:           train_loss 0.0024
wandb:             val_loss 0.41549
wandb:           val_recall 0.70732
wandb:        val_precision 0.44615
wandb:               val_f1 0.54717
wandb:              val_auc 0.66301
wandb:                   lr 0.00013
wandb:          best_val_f1 0.64368
wandb:    best_val_accuracy 0.94951
wandb:   best_val_precision 0.6087
wandb:      best_val_recall 0.68293
wandb:             best_auc 0.69828
wandb:           best_epoch 11
wandb: Run history:
wandb:   train_accuracy ▁▂▃▄▅▅▆▆▇▇▇▆▇▇█████████████████
wandb:     val_accuracy ▁█▇▂▄▅▁▆█▇█▇██████▇▅███████████
wandb:         _runtime ▁▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▅▄▄▄▃▃▂▂▂▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▁▁█▃▂█▂▁▁▁▁▁▁▁▁▁▁▂▃▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall █▁▇████▆▃▆▆▇▆▆▆▅▆▆▆▇▅▅▆▅▅▆▅▆▆▆▆
wandb:    val_precision ▁█▃▁▁▂▁▂▅▂▅▃▄▃▅▄▃▃▂▁▄▄▄▄▄▄▄▃▄▄▄
wandb:           val_f1 ▁▁▅▁▂▃▁▃▆▄█▅▇▆█▇▆▆▄▂▆▆▆▇▆▆▇▆▇▇▇
wandb:          val_auc ▁▆▅▃▅▅▃▅▃▅█▆█▇█▆█▇▇▄▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr █████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210625_170040-1hruda48


 See logs at ../../new_cache/conv__2252__06_1648__v39__new_augm/logs/