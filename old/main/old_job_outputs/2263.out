Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2263
Description:  augmented_mod9
2021-06-28 02:30:21.824293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-28 02:30:24.090729: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-28 02:30:24.091683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-28 02:30:24.137182: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:24.137864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-28 02:30:24.137901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 02:30:24.141277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 02:30:24.141363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-28 02:30:24.142425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-28 02:30:24.142712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-28 02:30:24.143702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-28 02:30:24.144558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-28 02:30:24.144711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 02:30:24.144818: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:24.145536: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:24.146169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2263.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2263__06_0230__v39__augmented_mod9
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-28 02:30:29.402720: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-28 02:30:29.402994: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:29.403740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-28 02:30:29.403788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 02:30:29.403845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 02:30:29.403866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-28 02:30:29.403886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-28 02:30:29.403906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-28 02:30:29.403925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-28 02:30:29.403945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-28 02:30:29.403963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 02:30:29.404057: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:29.404786: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:29.405445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-28 02:30:29.405489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-28 02:30:30.117816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-28 02:30:30.117868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-28 02:30:30.117887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-28 02:30:30.118231: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:30.119372: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:30.120415: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-28 02:30:30.121390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 4774
-----------------------
Number of train recordings: 4774 with pneumonia: 474 and non-pneumonia: 4300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-28 02:30:31.432235: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-28 02:30:31.433769: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-28 02:30:31.926523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-28 02:30:33.773715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-28 02:30:34.270103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
299/299 - 420s - loss: 0.7963 - accuracy: 0.6131 - val_loss: 0.2834 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.10463189904450167
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
299/299 - 415s - loss: 0.5911 - accuracy: 0.6623 - val_loss: 0.2000 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3569369186079411
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
299/299 - 415s - loss: 0.5070 - accuracy: 0.7296 - val_loss: 4.0289 - val_accuracy: 0.0831
Confusion matrix: 
 [[ 10 563]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.017 0.983]
 [0.    1.   ]]
Validation f1: 12.71
Validation accuracy: 8.31
Validation recall: 100.00
Validation precision: 6.79
Validation AUC: 0.4110341385760308
Validation class accuracies: [0.017452006980802792, 1.0]
Saving model...
Epoch 4/65
299/299 - 414s - loss: 0.4591 - accuracy: 0.7354 - val_loss: 0.5733 - val_accuracy: 0.7410
Confusion matrix: 
 [[425 148]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.742 0.258]
 [0.268 0.732]]
Validation f1: 27.40
Validation accuracy: 74.10
Validation recall: 73.17
Validation precision: 16.85
Validation AUC: 0.5559523811980455
Validation class accuracies: [0.7417102966841187, 0.7317073170731707]
Saving model...
Epoch 5/65
299/299 - 415s - loss: 0.3809 - accuracy: 0.7970 - val_loss: 0.7062 - val_accuracy: 0.6873
Confusion matrix: 
 [[385 188]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.672 0.328]
 [0.098 0.902]]
Validation f1: 27.82
Validation accuracy: 68.73
Validation recall: 90.24
Validation precision: 16.44
Validation AUC: 0.6837693665245432
Validation class accuracies: [0.6719022687609075, 0.9024390243902439]
Saving model...
Epoch 6/65
299/299 - 414s - loss: 0.3334 - accuracy: 0.8272 - val_loss: 1.9223 - val_accuracy: 0.4691
Confusion matrix: 
 [[247 326]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.431 0.569]
 [0.    1.   ]]
Validation f1: 20.10
Validation accuracy: 46.91
Validation recall: 100.00
Validation precision: 11.17
Validation AUC: 0.20445868757466074
Validation class accuracies: [0.43106457242582896, 1.0]
The validation tracker metric at 0.2781954887218045 hasn't increased by 0 in 1 epochs
Epoch 7/65
299/299 - 414s - loss: 0.2692 - accuracy: 0.8653 - val_loss: 0.7386 - val_accuracy: 0.7980
Confusion matrix: 
 [[457 116]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.798 0.202]
 [0.195 0.805]]
Validation f1: 34.74
Validation accuracy: 79.80
Validation recall: 80.49
Validation precision: 22.15
Validation AUC: 0.4934973828020548
Validation class accuracies: [0.7975567190226877, 0.8048780487804879]
Saving model...
Epoch 8/65
299/299 - 415s - loss: 0.2533 - accuracy: 0.8689 - val_loss: 0.5345 - val_accuracy: 0.7704
Confusion matrix: 
 [[441 132]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77 0.23]
 [0.22 0.78]]
Validation f1: 31.22
Validation accuracy: 77.04
Validation recall: 78.05
Validation precision: 19.51
Validation AUC: 0.6264111624365502
Validation class accuracies: [0.7696335078534031, 0.7804878048780488]
The validation tracker metric at 0.3473684210526316 hasn't increased by 0 in 1 epochs
Epoch 9/65
299/299 - 414s - loss: 0.1878 - accuracy: 0.9131 - val_loss: 2.6652 - val_accuracy: 0.4495
Confusion matrix: 
 [[236 337]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.412 0.588]
 [0.024 0.976]]
Validation f1: 19.14
Validation accuracy: 44.95
Validation recall: 97.56
Validation precision: 10.61
Validation AUC: 0.6260780069898972
Validation class accuracies: [0.4118673647469459, 0.975609756097561]
The validation tracker metric at 0.3473684210526316 hasn't increased by 0 in 2 epochs
Epoch 10/65
299/299 - 414s - loss: 0.1907 - accuracy: 0.9143 - val_loss: 0.5855 - val_accuracy: 0.7883
Confusion matrix: 
 [[449 124]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.784 0.216]
 [0.146 0.854]]
Validation f1: 35.00
Validation accuracy: 78.83
Validation recall: 85.37
Validation precision: 22.01
Validation AUC: 0.5928153832196645
Validation class accuracies: [0.7835951134380453, 0.8536585365853658]
Saving model...
Epoch 11/65
299/299 - 415s - loss: 0.0999 - accuracy: 0.9516 - val_loss: 1.5654 - val_accuracy: 0.6678
Confusion matrix: 
 [[378 195]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.66 0.34]
 [0.22 0.78]]
Validation f1: 23.88
Validation accuracy: 66.78
Validation recall: 78.05
Validation precision: 14.10
Validation AUC: 0.5027148170794247
Validation class accuracies: [0.6596858638743456, 0.7804878048780488]
The validation tracker metric at 0.35000000000000003 hasn't increased by 0 in 1 epochs
Epoch 12/65
299/299 - 415s - loss: 0.1045 - accuracy: 0.9535 - val_loss: 0.3575 - val_accuracy: 0.9104
Confusion matrix: 
 [[533  40]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.366 0.634]]
Validation f1: 48.60
Validation accuracy: 91.04
Validation recall: 63.41
Validation precision: 39.39
Validation AUC: 0.5885831636508936
Validation class accuracies: [0.9301919720767888, 0.6341463414634146]
Saving model...
Epoch 13/65
299/299 - 414s - loss: 0.0804 - accuracy: 0.9617 - val_loss: 0.3028 - val_accuracy: 0.9381
Confusion matrix: 
 [[554  19]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.463 0.537]]
Validation f1: 53.66
Validation accuracy: 93.81
Validation recall: 53.66
Validation precision: 53.66
Validation AUC: 0.5680866068130309
Validation class accuracies: [0.9668411867364747, 0.5365853658536586]
Saving model...
Epoch 14/65
299/299 - 414s - loss: 0.0349 - accuracy: 0.9851 - val_loss: 0.4465 - val_accuracy: 0.8827
Confusion matrix: 
 [[518  55]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.415 0.585]]
Validation f1: 40.00
Validation accuracy: 88.27
Validation recall: 58.54
Validation precision: 30.38
Validation AUC: 0.5178093061200443
Validation class accuracies: [0.9040139616055847, 0.5853658536585366]
The validation tracker metric at 0.5365853658536586 hasn't increased by 0 in 1 epochs
Epoch 15/65
299/299 - 414s - loss: 0.1685 - accuracy: 0.9363 - val_loss: 7.3882 - val_accuracy: 0.3436
Confusion matrix: 
 [[171 402]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.298 0.702]
 [0.024 0.976]]
Validation f1: 16.56
Validation accuracy: 34.36
Validation recall: 97.56
Validation precision: 9.05
Validation AUC: 0.47435767016097374
Validation class accuracies: [0.29842931937172773, 0.975609756097561]
The validation tracker metric at 0.5365853658536586 hasn't increased by 0 in 2 epochs
Epoch 16/65
299/299 - 414s - loss: 0.0948 - accuracy: 0.9623 - val_loss: 0.2778 - val_accuracy: 0.9316
Confusion matrix: 
 [[543  30]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.293 0.707]]
Validation f1: 58.00
Validation accuracy: 93.16
Validation recall: 70.73
Validation precision: 49.15
Validation AUC: 0.6021707064263618
Validation class accuracies: [0.9476439790575916, 0.7073170731707317]
Saving model...
Epoch 17/65
299/299 - 414s - loss: 0.0588 - accuracy: 0.9707 - val_loss: 0.2071 - val_accuracy: 0.9495
Confusion matrix: 
 [[567   6]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99 0.01]
 [0.61 0.39]]
Validation f1: 50.79
Validation accuracy: 94.95
Validation recall: 39.02
Validation precision: 72.73
Validation AUC: 0.646110648766868
Validation class accuracies: [0.9895287958115183, 0.3902439024390244]
The validation tracker metric at 0.58 hasn't increased by 0 in 1 epochs
Epoch 18/65
299/299 - 414s - loss: 0.0851 - accuracy: 0.9696 - val_loss: 2.3161 - val_accuracy: 0.5619
Confusion matrix: 
 [[323 250]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.564 0.436]
 [0.463 0.537]]
Validation f1: 14.06
Validation accuracy: 56.19
Validation recall: 53.66
Validation precision: 8.09
Validation AUC: 0.28421320554110435
Validation class accuracies: [0.5636998254799301, 0.5365853658536586]
The validation tracker metric at 0.58 hasn't increased by 0 in 2 epochs
Epoch 19/65
299/299 - 414s - loss: 0.0931 - accuracy: 0.9598 - val_loss: 0.2755 - val_accuracy: 0.8990
Confusion matrix: 
 [[529  44]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.439 0.561]]
Validation f1: 42.59
Validation accuracy: 89.90
Validation recall: 56.10
Validation precision: 34.33
Validation AUC: 0.5198458978828177
Validation class accuracies: [0.9232111692844677, 0.5609756097560976]
The validation tracker metric at 0.58 hasn't increased by 0 in 3 epochs
Epoch 20/65
299/299 - 414s - loss: 0.0314 - accuracy: 0.9874 - val_loss: 0.3214 - val_accuracy: 0.9283
Confusion matrix: 
 [[547  26]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.439 0.561]]
Validation f1: 51.11
Validation accuracy: 92.83
Validation recall: 56.10
Validation precision: 46.94
Validation AUC: 0.5053816428569231
Validation class accuracies: [0.9546247818499127, 0.5609756097560976]
The validation tracker metric at 0.58 hasn't increased by 0 in 4 epochs
Epoch 21/65
299/299 - 414s - loss: 0.0402 - accuracy: 0.9843 - val_loss: 0.2821 - val_accuracy: 0.9316
Confusion matrix: 
 [[550  23]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.463 0.537]]
Validation f1: 51.16
Validation accuracy: 93.16
Validation recall: 53.66
Validation precision: 48.89
Validation AUC: 0.574095578876103
Validation class accuracies: [0.9598603839441536, 0.5365853658536586]
The validation tracker metric at 0.58 hasn't increased by 0 in 5 epochs
Epoch 22/65
299/299 - 414s - loss: 0.0137 - accuracy: 0.9962 - val_loss: 0.2794 - val_accuracy: 0.9251
Confusion matrix: 
 [[545  28]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.439 0.561]]
Validation f1: 50.00
Validation accuracy: 92.51
Validation recall: 56.10
Validation precision: 45.10
Validation AUC: 0.6065409260171082
Validation class accuracies: [0.9511343804537522, 0.5609756097560976]
The validation tracker metric at 0.58 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 23/65
299/299 - 414s - loss: 0.0139 - accuracy: 0.9960 - val_loss: 0.2515 - val_accuracy: 0.9267
Confusion matrix: 
 [[546  27]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.439 0.561]]
Validation f1: 50.55
Validation accuracy: 92.67
Validation recall: 56.10
Validation precision: 46.00
Validation AUC: 0.6003547791154824
Validation class accuracies: [0.9528795811518325, 0.5609756097560976]
The validation tracker metric at 0.58 hasn't increased by 0 in 7 epochs
Epoch 24/65
299/299 - 414s - loss: 0.0078 - accuracy: 0.9979 - val_loss: 0.2931 - val_accuracy: 0.9218
Confusion matrix: 
 [[544  29]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.463 0.537]]
Validation f1: 47.83
Validation accuracy: 92.18
Validation recall: 53.66
Validation precision: 43.14
Validation AUC: 0.5622428569113401
Validation class accuracies: [0.9493891797556719, 0.5365853658536586]
The validation tracker metric at 0.58 hasn't increased by 0 in 8 epochs
Epoch 25/65
299/299 - 414s - loss: 0.0072 - accuracy: 0.9983 - val_loss: 0.3099 - val_accuracy: 0.9235
Confusion matrix: 
 [[545  28]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.463 0.537]]
Validation f1: 48.35
Validation accuracy: 92.35
Validation recall: 53.66
Validation precision: 44.00
Validation AUC: 0.5786806168978513
Validation class accuracies: [0.9511343804537522, 0.5365853658536586]
The validation tracker metric at 0.58 hasn't increased by 0 in 9 epochs
Epoch 26/65
299/299 - 414s - loss: 0.0066 - accuracy: 0.9981 - val_loss: 0.3063 - val_accuracy: 0.9267
Confusion matrix: 
 [[548  25]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.488 0.512]]
Validation f1: 48.28
Validation accuracy: 92.67
Validation recall: 51.22
Validation precision: 45.65
Validation AUC: 0.5651898878612137
Validation class accuracies: [0.956369982547993, 0.5121951219512195]
The validation tracker metric at 0.58 hasn't increased by 0 in 10 epochs
Epoch 27/65
299/299 - 414s - loss: 0.0055 - accuracy: 0.9992 - val_loss: 0.2694 - val_accuracy: 0.9332
Confusion matrix: 
 [[552  21]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.488 0.512]]
Validation f1: 50.60
Validation accuracy: 93.32
Validation recall: 51.22
Validation precision: 50.00
Validation AUC: 0.603406663377502
Validation class accuracies: [0.9633507853403142, 0.5121951219512195]
The validation tracker metric at 0.58 hasn't increased by 0 in 11 epochs
Epoch 28/65
299/299 - 414s - loss: 0.0059 - accuracy: 0.9981 - val_loss: 0.3232 - val_accuracy: 0.9202
Confusion matrix: 
 [[542  31]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.439 0.561]]
Validation f1: 48.42
Validation accuracy: 92.02
Validation recall: 56.10
Validation precision: 42.59
Validation AUC: 0.5496624657292463
Validation class accuracies: [0.9458987783595113, 0.5609756097560976]
The validation tracker metric at 0.58 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 29/65
299/299 - 415s - loss: 0.0040 - accuracy: 0.9990 - val_loss: 0.3018 - val_accuracy: 0.9283
Confusion matrix: 
 [[549  24]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.488 0.512]]
Validation f1: 48.84
Validation accuracy: 92.83
Validation recall: 51.22
Validation precision: 46.67
Validation AUC: 0.5733440548212427
Validation class accuracies: [0.9581151832460733, 0.5121951219512195]
The validation tracker metric at 0.58 hasn't increased by 0 in 13 epochs
Epoch 30/65
299/299 - 415s - loss: 0.0077 - accuracy: 0.9979 - val_loss: 0.3859 - val_accuracy: 0.9251
Confusion matrix: 
 [[547  26]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.488 0.512]]
Validation f1: 47.73
Validation accuracy: 92.51
Validation recall: 51.22
Validation precision: 44.68
Validation AUC: 0.5546409661072588
Validation class accuracies: [0.9546247818499127, 0.5121951219512195]
The validation tracker metric at 0.58 hasn't increased by 0 in 14 epochs
Epoch 31/65
299/299 - 414s - loss: 0.0053 - accuracy: 0.9987 - val_loss: 0.3565 - val_accuracy: 0.9251
Confusion matrix: 
 [[547  26]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.73
Validation accuracy: 92.51
Validation recall: 51.22
Validation precision: 44.68
Validation AUC: 0.560969410407379
Validation class accuracies: [0.9546247818499127, 0.5121951219512195]
The validation tracker metric at 0.58 hasn't increased by 0 in 15 epochs
Epoch 32/65
299/299 - 414s - loss: 0.0033 - accuracy: 0.9990 - val_loss: 0.3580 - val_accuracy: 0.9251
Confusion matrix: 
 [[547  26]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.73
Validation accuracy: 92.51
Validation recall: 51.22
Validation precision: 44.68
Validation AUC: 0.5713612671291177
Validation class accuracies: [0.9546247818499127, 0.5121951219512195]
The validation tracker metric at 0.58 hasn't increased by 0 in 16 epochs
Epoch 33/65
299/299 - 414s - loss: 0.0029 - accuracy: 0.9996 - val_loss: 0.3265 - val_accuracy: 0.9316
Confusion matrix: 
 [[552  21]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.512 0.488]]
Validation f1: 48.78
Validation accuracy: 93.16
Validation recall: 48.78
Validation precision: 48.78
Validation AUC: 0.5874908595211554
Validation class accuracies: [0.9633507853403142, 0.4878048780487805]
The validation tracker metric at 0.58 hasn't increased by 0 in 17 epochs
Epoch 34/65
299/299 - 414s - loss: 0.0025 - accuracy: 0.9994 - val_loss: 0.3266 - val_accuracy: 0.9349
Confusion matrix: 
 [[552  21]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.463 0.537]]
Validation f1: 52.38
Validation accuracy: 93.49
Validation recall: 53.66
Validation precision: 51.16
Validation AUC: 0.5836656429671719
Validation class accuracies: [0.9633507853403142, 0.5365853658536586]
The validation tracker metric at 0.58 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 35/65
299/299 - 414s - loss: 0.0073 - accuracy: 0.9983 - val_loss: 0.3616 - val_accuracy: 0.9202
Confusion matrix: 
 [[542  31]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.42
Validation accuracy: 92.02
Validation recall: 56.10
Validation precision: 42.59
Validation AUC: 0.5825299427672883
Validation class accuracies: [0.9458987783595113, 0.5609756097560976]
The validation tracker metric at 0.58 hasn't increased by 0 in 19 epochs
Epoch 36/65
299/299 - 415s - loss: 0.0079 - accuracy: 0.9983 - val_loss: 0.3712 - val_accuracy: 0.9202
Confusion matrix: 
 [[538  35]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.341 0.659]]
Validation f1: 52.43
Validation accuracy: 92.02
Validation recall: 65.85
Validation precision: 43.55
Validation AUC: 0.5828655018104422
Validation class accuracies: [0.9389179755671903, 0.6585365853658537]

The metrics for job 0 with the best target metric are: 
Best cm: [[543  30]
 [ 12  29]]
Best normalized cm: [[0.948 0.052]
 [0.293 0.707]]
Best f1: 0.58
Best accuracy: 0.93
Best recall: 0.71
Best precision: 0.49
Best AUC: 0.60
Best class accuracies: [0.9476439790575916, 0.7073170731707317]
Best epoch: 16
The number of epochs since last 1% equals the patience
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[2.524e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[9.079e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.035]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[6.148e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.032]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[9.129e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[2.887e-07]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[5.478e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[5.068e-09]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[9.752e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.982]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[2.783e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[8.809e-07]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[2.656e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.044]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[1.169e-07]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[3.309e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[1.229e-09]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[3.907e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.354]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[3.047e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[2.181e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[1.921e-07]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.262e-07]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[4.859e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[2.832e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[1.389e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[2.091e-07]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[1.013e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[6.472e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.003]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 24101
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_023024-1s3enw4h/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_023024-1s3enw4h/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99832
wandb:         val_accuracy 0.9202
wandb:             _runtime 15427
wandb:           _timestamp 1624862852
wandb:                _step 275
wandb:           train_loss 0.00786
wandb:             val_loss 0.37121
wandb:           val_recall 0.65854
wandb:        val_precision 0.43548
wandb:               val_f1 0.52427
wandb:              val_auc 0.58287
wandb:                   lr 0.00013
wandb:          best_val_f1 0.58
wandb:    best_val_accuracy 0.9316
wandb:   best_val_precision 0.49153
wandb:      best_val_recall 0.70732
wandb:             best_auc 0.60217
wandb:           best_epoch 16
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_023024-1s3enw4h

-----------------------
New augm params: {'ADD': 1, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
New quantities for label 0: 500
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_10
Length of training samples after spec augmentation: 2932
-----------------------
Number of train recordings: 2932 with pneumonia: 632 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3932
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_11
Length of training samples after spec augmentation: 4432
-----------------------
Number of train recordings: 4432 with pneumonia: 632 and non-pneumonia: 3800
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 64, 625, 48)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 64, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 32, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 16, 156, 128)    91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 8, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 4, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
277/277 - 383s - loss: 1.0713 - accuracy: 0.5654 - val_loss: 0.4023 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07885612859191735
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
277/277 - 387s - loss: 0.6438 - accuracy: 0.6266 - val_loss: 0.2068 - val_accuracy: 0.9365
Confusion matrix: 
 [[573   0]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.951 0.049]]
Validation f1: 9.30
Validation accuracy: 93.65
Validation recall: 4.88
Validation precision: 100.00
Validation AUC: 0.5007897778020091
Validation class accuracies: [1.0, 0.04878048780487805]
Saving model...
Epoch 3/65
277/277 - 386s - loss: 0.5241 - accuracy: 0.7056 - val_loss: 1.0788 - val_accuracy: 0.6466
Confusion matrix: 
 [[358 215]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.625 0.375]
 [0.049 0.951]]
Validation f1: 26.44
Validation accuracy: 64.66
Validation recall: 95.12
Validation precision: 15.35
Validation AUC: 0.5638419872970742
Validation class accuracies: [0.62478184991274, 0.9512195121951219]
Saving model...
Epoch 4/65
277/277 - 386s - loss: 0.4468 - accuracy: 0.7468 - val_loss: 1.9191 - val_accuracy: 0.2052
Confusion matrix: 
 [[ 85 488]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.148 0.852]
 [0.    1.   ]]
Validation f1: 14.39
Validation accuracy: 20.52
Validation recall: 100.00
Validation precision: 7.75
Validation AUC: 0.41559123206572113
Validation class accuracies: [0.14834205933682373, 1.0]
The validation tracker metric at 0.26440677966101694 hasn't increased by 0 in 1 epochs
Epoch 5/65
277/277 - 386s - loss: 0.4375 - accuracy: 0.7798 - val_loss: 6.9460 - val_accuracy: 0.1629
Confusion matrix: 
 [[ 59 514]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.103 0.897]
 [0.    1.   ]]
Validation f1: 13.76
Validation accuracy: 16.29
Validation recall: 100.00
Validation precision: 7.39
Validation AUC: 0.34219005354809867
Validation class accuracies: [0.10296684118673648, 1.0]
The validation tracker metric at 0.26440677966101694 hasn't increased by 0 in 2 epochs
Epoch 6/65
277/277 - 386s - loss: 0.3920 - accuracy: 0.7994 - val_loss: 0.6107 - val_accuracy: 0.7280
Confusion matrix: 
 [[413 160]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.721 0.279]
 [0.171 0.829]]
Validation f1: 28.94
Validation accuracy: 72.80
Validation recall: 82.93
Validation precision: 17.53
Validation AUC: 0.4411094019948958
Validation class accuracies: [0.7207678883071553, 0.8292682926829268]
Saving model...
Epoch 7/65
277/277 - 386s - loss: 0.2857 - accuracy: 0.8491 - val_loss: 0.3213 - val_accuracy: 0.8893
Confusion matrix: 
 [[519  54]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.341 0.659]]
Validation f1: 44.26
Validation accuracy: 88.93
Validation recall: 65.85
Validation precision: 33.33
Validation AUC: 0.5804257175492139
Validation class accuracies: [0.9057591623036649, 0.6585365853658537]
Saving model...
Epoch 8/65
277/277 - 386s - loss: 0.2663 - accuracy: 0.8700 - val_loss: 0.2720 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6516924283650568
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
Saving model...
Epoch 9/65
277/277 - 386s - loss: 0.2229 - accuracy: 0.9016 - val_loss: 0.5387 - val_accuracy: 0.7866
Confusion matrix: 
 [[443 130]
 [  1  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.024 0.976]]
Validation f1: 37.91
Validation accuracy: 78.66
Validation recall: 97.56
Validation precision: 23.53
Validation AUC: 0.3808964509442646
Validation class accuracies: [0.7731239092495636, 0.975609756097561]
The validation tracker metric at 0.5544554455445545 hasn't increased by 0 in 1 epochs
Epoch 10/65
277/277 - 387s - loss: 0.2077 - accuracy: 0.9014 - val_loss: 0.1952 - val_accuracy: 0.9414
Confusion matrix: 
 [[550  23]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.317 0.683]]
Validation f1: 60.87
Validation accuracy: 94.14
Validation recall: 68.29
Validation precision: 54.90
Validation AUC: 0.6720558150382167
Validation class accuracies: [0.9598603839441536, 0.6829268292682927]
Saving model...
Epoch 11/65
277/277 - 386s - loss: 0.1902 - accuracy: 0.9197 - val_loss: 2.0829 - val_accuracy: 0.4837
Confusion matrix: 
 [[256 317]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.447 0.553]
 [0.    1.   ]]
Validation f1: 20.55
Validation accuracy: 48.37
Validation recall: 100.00
Validation precision: 11.45
Validation AUC: 0.5563834568560977
Validation class accuracies: [0.4467713787085515, 1.0]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 1 epochs
Epoch 12/65
277/277 - 386s - loss: 0.1692 - accuracy: 0.9215 - val_loss: 0.2503 - val_accuracy: 0.9316
Confusion matrix: 
 [[548  25]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.415 0.585]]
Validation f1: 53.33
Validation accuracy: 93.16
Validation recall: 58.54
Validation precision: 48.98
Validation AUC: 0.5424203108790228
Validation class accuracies: [0.956369982547993, 0.5853658536585366]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 2 epochs
Epoch 13/65
277/277 - 387s - loss: 0.1043 - accuracy: 0.9537 - val_loss: 0.5784 - val_accuracy: 0.8111
Confusion matrix: 
 [[469 104]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.818 0.182]
 [0.293 0.707]]
Validation f1: 33.33
Validation accuracy: 81.11
Validation recall: 70.73
Validation precision: 21.80
Validation AUC: 0.6542689450469358
Validation class accuracies: [0.8184991273996509, 0.7073170731707317]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 3 epochs
Epoch 14/65
277/277 - 386s - loss: 0.1251 - accuracy: 0.9413 - val_loss: 4.5713 - val_accuracy: 0.3860
Confusion matrix: 
 [[196 377]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.342 0.658]
 [0.    1.   ]]
Validation f1: 17.86
Validation accuracy: 38.60
Validation recall: 100.00
Validation precision: 9.81
Validation AUC: 0.4427169140539268
Validation class accuracies: [0.34205933682373474, 1.0]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 4 epochs
Epoch 15/65
277/277 - 386s - loss: 0.0539 - accuracy: 0.9725 - val_loss: 0.4214 - val_accuracy: 0.8827
Confusion matrix: 
 [[510  63]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89 0.11]
 [0.22 0.78]]
Validation f1: 47.06
Validation accuracy: 88.27
Validation recall: 78.05
Validation precision: 33.68
Validation AUC: 0.6670659511972615
Validation class accuracies: [0.8900523560209425, 0.7804878048780488]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 5 epochs
Epoch 16/65
277/277 - 386s - loss: 0.0361 - accuracy: 0.9833 - val_loss: 2.2219 - val_accuracy: 0.5212
Confusion matrix: 
 [[281 292]
 [  2  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.49  0.51 ]
 [0.049 0.951]]
Validation f1: 20.97
Validation accuracy: 52.12
Validation recall: 95.12
Validation precision: 11.78
Validation AUC: 0.3635248409318532
Validation class accuracies: [0.49040139616055844, 0.9512195121951219]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
277/277 - 386s - loss: 0.0346 - accuracy: 0.9869 - val_loss: 0.3802 - val_accuracy: 0.8990
Confusion matrix: 
 [[529  44]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.59
Validation accuracy: 89.90
Validation recall: 56.10
Validation precision: 34.33
Validation AUC: 0.6102341174153869
Validation class accuracies: [0.9232111692844677, 0.5609756097560976]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 7 epochs
Epoch 18/65
277/277 - 386s - loss: 0.0251 - accuracy: 0.9887 - val_loss: 0.2579 - val_accuracy: 0.9446
Confusion matrix: 
 [[558  15]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.463 0.537]]
Validation f1: 56.41
Validation accuracy: 94.46
Validation recall: 53.66
Validation precision: 59.46
Validation AUC: 0.5884571665140077
Validation class accuracies: [0.9738219895287958, 0.5365853658536586]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 8 epochs
Epoch 19/65
277/277 - 386s - loss: 0.0146 - accuracy: 0.9944 - val_loss: 0.3788 - val_accuracy: 0.8925
Confusion matrix: 
 [[518  55]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.268 0.732]]
Validation f1: 47.62
Validation accuracy: 89.25
Validation recall: 73.17
Validation precision: 35.29
Validation AUC: 0.6846925871488452
Validation class accuracies: [0.9040139616055847, 0.7317073170731707]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 9 epochs
Epoch 20/65
277/277 - 386s - loss: 0.0184 - accuracy: 0.9919 - val_loss: 0.5530 - val_accuracy: 0.8681
Confusion matrix: 
 [[503  70]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.878 0.122]
 [0.268 0.732]]
Validation f1: 42.55
Validation accuracy: 86.81
Validation recall: 73.17
Validation precision: 30.00
Validation AUC: 0.6473464027225169
Validation class accuracies: [0.8778359511343804, 0.7317073170731707]
The validation tracker metric at 0.6086956521739131 hasn't increased by 0 in 10 epochs
Epoch 21/65
277/277 - 386s - loss: 0.0215 - accuracy: 0.9930 - val_loss: 0.2729 - val_accuracy: 0.9446
Confusion matrix: 
 [[551  22]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.293 0.707]]
Validation f1: 63.04
Validation accuracy: 94.46
Validation recall: 70.73
Validation precision: 56.86
Validation AUC: 0.6853966641538533
Validation class accuracies: [0.9616055846422339, 0.7073170731707317]
Saving model...
Epoch 22/65
277/277 - 386s - loss: 0.0098 - accuracy: 0.9959 - val_loss: 0.6121 - val_accuracy: 0.8355
Confusion matrix: 
 [[481  92]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.22  0.78 ]]
Validation f1: 38.79
Validation accuracy: 83.55
Validation recall: 78.05
Validation precision: 25.81
Validation AUC: 0.6509874637912408
Validation class accuracies: [0.8394415357766143, 0.7804878048780488]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 1 epochs
Epoch 23/65
277/277 - 386s - loss: 0.0081 - accuracy: 0.9975 - val_loss: 0.2858 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6383726970966069
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 2 epochs
Epoch 24/65
277/277 - 386s - loss: 0.0103 - accuracy: 0.9975 - val_loss: 0.5970 - val_accuracy: 0.8860
Confusion matrix: 
 [[510  63]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.171 0.829]]
Validation f1: 49.28
Validation accuracy: 88.60
Validation recall: 82.93
Validation precision: 35.05
Validation AUC: 0.6540348944725743
Validation class accuracies: [0.8900523560209425, 0.8292682926829268]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 3 epochs
Epoch 25/65
277/277 - 386s - loss: 0.0395 - accuracy: 0.9833 - val_loss: 0.2402 - val_accuracy: 0.9251
Confusion matrix: 
 [[543  30]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.39  0.61 ]]
Validation f1: 52.08
Validation accuracy: 92.51
Validation recall: 60.98
Validation precision: 45.45
Validation AUC: 0.6344969749977336
Validation class accuracies: [0.9476439790575916, 0.6097560975609756]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 4 epochs
Epoch 26/65
277/277 - 386s - loss: 0.0107 - accuracy: 0.9964 - val_loss: 0.4063 - val_accuracy: 0.8958
Confusion matrix: 
 [[520  53]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.268 0.732]]
Validation f1: 48.39
Validation accuracy: 89.58
Validation recall: 73.17
Validation precision: 36.14
Validation AUC: 0.6475155920977378
Validation class accuracies: [0.9075043630017452, 0.7317073170731707]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 5 epochs
Epoch 27/65
277/277 - 386s - loss: 0.0166 - accuracy: 0.9935 - val_loss: 0.3009 - val_accuracy: 0.9153
Confusion matrix: 
 [[540  33]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.463 0.537]]
Validation f1: 45.83
Validation accuracy: 91.53
Validation recall: 53.66
Validation precision: 40.00
Validation AUC: 0.5376235907863157
Validation class accuracies: [0.9424083769633508, 0.5365853658536586]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 28/65
277/277 - 386s - loss: 0.0097 - accuracy: 0.9971 - val_loss: 0.3954 - val_accuracy: 0.8925
Confusion matrix: 
 [[518  55]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.62
Validation accuracy: 89.25
Validation recall: 73.17
Validation precision: 35.29
Validation AUC: 0.6720810921332537
Validation class accuracies: [0.9040139616055847, 0.7317073170731707]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 7 epochs
Epoch 29/65
277/277 - 386s - loss: 0.0063 - accuracy: 0.9982 - val_loss: 0.2915 - val_accuracy: 0.9072
Confusion matrix: 
 [[532  41]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.39  0.61 ]]
Validation f1: 46.73
Validation accuracy: 90.72
Validation recall: 60.98
Validation precision: 37.88
Validation AUC: 0.6559766186108198
Validation class accuracies: [0.9284467713787086, 0.6097560975609756]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 8 epochs
Epoch 30/65
277/277 - 386s - loss: 0.0071 - accuracy: 0.9982 - val_loss: 0.2598 - val_accuracy: 0.9283
Confusion matrix: 
 [[547  26]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.11
Validation accuracy: 92.83
Validation recall: 56.10
Validation precision: 46.94
Validation AUC: 0.6416700328329117
Validation class accuracies: [0.9546247818499127, 0.5609756097560976]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 9 epochs
Epoch 31/65
277/277 - 386s - loss: 0.0043 - accuracy: 0.9989 - val_loss: 0.3084 - val_accuracy: 0.9121
Confusion matrix: 
 [[536  37]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.415 0.585]]
Validation f1: 47.06
Validation accuracy: 91.21
Validation recall: 58.54
Validation precision: 39.34
Validation AUC: 0.6265330157926912
Validation class accuracies: [0.9354275741710296, 0.5853658536585366]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 10 epochs
Epoch 32/65
277/277 - 386s - loss: 0.0039 - accuracy: 0.9991 - val_loss: 0.3352 - val_accuracy: 0.9088
Confusion matrix: 
 [[534  39]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.415 0.585]]
Validation f1: 46.15
Validation accuracy: 90.88
Validation recall: 58.54
Validation precision: 38.10
Validation AUC: 0.6422000477732269
Validation class accuracies: [0.9319371727748691, 0.5853658536585366]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 11 epochs
Epoch 33/65
277/277 - 386s - loss: 0.0028 - accuracy: 0.9993 - val_loss: 0.3518 - val_accuracy: 0.8974
Confusion matrix: 
 [[527  46]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.415 0.585]]
Validation f1: 43.24
Validation accuracy: 89.74
Validation recall: 58.54
Validation precision: 34.29
Validation AUC: 0.6450689063373188
Validation class accuracies: [0.9197207678883071, 0.5853658536585366]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 34/65
277/277 - 386s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.3264 - val_accuracy: 0.9121
Confusion matrix: 
 [[537  36]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.439 0.561]]
Validation f1: 46.00
Validation accuracy: 91.21
Validation recall: 56.10
Validation precision: 38.98
Validation AUC: 0.6340058822076035
Validation class accuracies: [0.93717277486911, 0.5609756097560976]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 13 epochs
Epoch 35/65
277/277 - 386s - loss: 0.0024 - accuracy: 0.9995 - val_loss: 0.3159 - val_accuracy: 0.9186
Confusion matrix: 
 [[540  33]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.415 0.585]]
Validation f1: 48.98
Validation accuracy: 91.86
Validation recall: 58.54
Validation precision: 42.11
Validation AUC: 0.6501841054205865
Validation class accuracies: [0.9424083769633508, 0.5853658536585366]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 14 epochs
Epoch 36/65
277/277 - 386s - loss: 0.0029 - accuracy: 0.9991 - val_loss: 0.3173 - val_accuracy: 0.9137
Confusion matrix: 
 [[538  35]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.439 0.561]]
Validation f1: 46.46
Validation accuracy: 91.37
Validation recall: 56.10
Validation precision: 39.66
Validation AUC: 0.6530824846947769
Validation class accuracies: [0.9389179755671903, 0.5609756097560976]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 15 epochs
Epoch 37/65
277/277 - 386s - loss: 0.0017 - accuracy: 0.9998 - val_loss: 0.2925 - val_accuracy: 0.9267
Confusion matrix: 
 [[546  27]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.439 0.561]]
Validation f1: 50.55
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.67
Validation recall: 56.10
Validation precision: 46.00
Validation AUC: 0.6375649866252909
Validation class accuracies: [0.9528795811518325, 0.5609756097560976]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 16 epochs
Epoch 38/65
277/277 - 387s - loss: 0.0017 - accuracy: 0.9995 - val_loss: 0.3126 - val_accuracy: 0.9202
Confusion matrix: 
 [[542  31]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.42
Validation accuracy: 92.02
Validation recall: 56.10
Validation precision: 42.59
Validation AUC: 0.6454770223042617
Validation class accuracies: [0.9458987783595113, 0.5609756097560976]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 17 epochs
Epoch 39/65
277/277 - 387s - loss: 0.0062 - accuracy: 0.9991 - val_loss: 0.3542 - val_accuracy: 0.9218
Confusion matrix: 
 [[542  31]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.415 0.585]]
Validation f1: 50.00
Validation accuracy: 92.18
Validation recall: 58.54
Validation precision: 43.64
Validation AUC: 0.6021279390711418
Validation class accuracies: [0.9458987783595113, 0.5853658536585366]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 40/65
277/277 - 387s - loss: 0.0019 - accuracy: 0.9998 - val_loss: 0.3649 - val_accuracy: 0.9088
Confusion matrix: 
 [[534  39]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 46.15
Validation accuracy: 90.88
Validation recall: 58.54
Validation precision: 38.10
Validation AUC: 0.6185704810619547
Validation class accuracies: [0.9319371727748691, 0.5853658536585366]
The validation tracker metric at 0.6304347826086957 hasn't increased by 0 in 19 epochs
Epoch 41/65
277/277 - 386s - loss: 0.0021 - accuracy: 0.9995 - val_loss: 0.3578 - val_accuracy: 0.9088
Confusion matrix: 
 [[534  39]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 46.15
Validation accuracy: 90.88
Validation recall: 58.54
Validation precision: 38.10
Validation AUC: 0.6232391225635644
Validation class accuracies: [0.9319371727748691, 0.5853658536585366]

The metrics for job 1 with the best target metric are: 
Best cm: [[551  22]
 [ 12  29]]
Best normalized cm: [[0.962 0.038]
 [0.293 0.707]]
Best f1: 0.63
Best accuracy: 0.94
Best recall: 0.71
Best precision: 0.57
Best AUC: 0.69
Best class accuracies: [0.9616055846422339, 0.7073170731707317]
Best epoch: 21
The number of epochs since last 1% equals the patience
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_203_2p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_218_1b1_Ar_sc_Meditron_13_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_222_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[3.732e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_223_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_203_2p3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.161e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_213_1p2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_207_3b2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[1.379e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_221_2b1_Ar_mc_LittC2SE_2_label_0_pred_0.png, [[0.489]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_205_3b4_Al_mc_AKGC417L_0_label_0_pred_0.png, [[2.615e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_204_7p5_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[6.294e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_211_2p2_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_218_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_211_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.033]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_218_1p1_Ar_sc_Litt3200_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_207_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[8.251e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_213_1p2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[3.398e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_223_1b1_Pr_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_205_2b3_Al_mc_AKGC417L_2_label_0_pred_0.png, [[7.921e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_218_1b1_Al_sc_Meditron_9_label_0_pred_0.png, [[0.039]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[2.11e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_218_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_213_1p2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[3.759e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_205_4b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_213_1p2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_218_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[5.75e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_222_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_220_1b2_Al_mc_LittC2SE_0_label_0_pred_0.png, [[5.878e-06]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_213_1p2_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[7.325e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_218_1b1_Ar_sc_Meditron_7_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_205_1b3_Ll_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_211_2p2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_205_1b3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_211_1p2_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[2.816e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_207_2b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_217_1b1_Tc_sc_Meditron_1_label_0_pred_0.png, [[0.284]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_213_1p5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_221_2b3_Ar_mc_LittC2SE_3_label_0_pred_1.png, [[0.945]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_220_1b1_Tc_mc_LittC2SE_1_label_0_pred_0.png, [[8.155e-05]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_205_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_207_2b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2263__06_0230__v39__augmented_mod9/1/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 20902
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_064808-2pag7ika/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_064808-2pag7ika/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99955
wandb:         val_accuracy 0.90879
wandb:             _runtime 16622
wandb:           _timestamp 1624879511
wandb:                _step 307
wandb:           train_loss 0.00213
wandb:             val_loss 0.3578
wandb:           val_recall 0.58537
wandb:        val_precision 0.38095
wandb:               val_f1 0.46154
wandb:              val_auc 0.62324
wandb:                   lr 6e-05
wandb:          best_val_f1 0.63043
wandb:    best_val_accuracy 0.94463
wandb:   best_val_precision 0.56863
wandb:      best_val_recall 0.70732
wandb:             best_auc 0.6854
wandb:           best_epoch 21
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210628_064808-2pag7ika

-----------------------
New augm params: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
New augm params: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v43'}
New quantities for label 0: 1000
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3616
-----------------------
Number of train recordings: 3616 with pneumonia: 316 and non-pneumonia: 3300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 128, 1250, 1)    4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_2 (Concatenate)         (None, 128, 1250, 48)   0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 64, 625, 48)     0            concatenate_2[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 64, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 32, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 16, 156, 128)    91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 8, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 4, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               513          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
226/226 - 317s - loss: 0.8638 - accuracy: 0.6504 - val_loss: 0.2637 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07009040315982713
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
226/226 - 317s - loss: 0.4825 - accuracy: 0.7500 - val_loss: 0.2498 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32984595877628253
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
226/226 - 317s - loss: 0.4265 - accuracy: 0.7735 - val_loss: 0.3459 - val_accuracy: 0.8616
Confusion matrix: 
 [[502  71]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.341 0.659]]
Validation f1: 38.85
Validation accuracy: 86.16
Validation recall: 65.85
Validation precision: 27.55
Validation AUC: 0.5763919058365768
Validation class accuracies: [0.8760907504363001, 0.6585365853658537]
Saving model...
Epoch 4/65
226/226 - 316s - loss: 0.3877 - accuracy: 0.8222 - val_loss: 1.5015 - val_accuracy: 0.3225
Confusion matrix: 
 [[162 411]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.283 0.717]
 [0.122 0.878]]
Validation f1: 14.75
Validation accuracy: 32.25
Validation recall: 87.80
Validation precision: 8.05
Validation AUC: 0.34940861383065497
Validation class accuracies: [0.28272251308900526, 0.8780487804878049]
The validation tracker metric at 0.3884892086330935 hasn't increased by 0 in 1 epochs
Epoch 5/65
226/226 - 317s - loss: 0.3438 - accuracy: 0.8316 - val_loss: 0.7481 - val_accuracy: 0.7134
Confusion matrix: 
 [[409 164]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.714 0.286]
 [0.293 0.707]]
Validation f1: 24.79
Validation accuracy: 71.34
Validation recall: 70.73
Validation precision: 15.03
Validation AUC: 0.22740008915241924
Validation class accuracies: [0.7137870855148342, 0.7073170731707317]
The validation tracker metric at 0.3884892086330935 hasn't increased by 0 in 2 epochs
Epoch 6/65
226/226 - 316s - loss: 0.3037 - accuracy: 0.8545 - val_loss: 0.5309 - val_accuracy: 0.7427
Confusion matrix: 
 [[420 153]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.733 0.267]
 [0.122 0.878]]
Validation f1: 31.30
Validation accuracy: 74.27
Validation recall: 87.80
Validation precision: 19.05
Validation AUC: 0.6113961518524893
Validation class accuracies: [0.7329842931937173, 0.8780487804878049]
The validation tracker metric at 0.3884892086330935 hasn't increased by 0 in 3 epochs
Epoch 7/65
226/226 - 317s - loss: 0.2260 - accuracy: 0.8905 - val_loss: 0.1578 - val_accuracy: 0.9593
Confusion matrix: 
 [[563  10]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.366 0.634]]
Validation f1: 67.53
Validation accuracy: 95.93
Validation recall: 63.41
Validation precision: 72.22
Validation AUC: 0.7052435885280218
Validation class accuracies: [0.9825479930191972, 0.6341463414634146]
Saving model...
Epoch 8/65
226/226 - 317s - loss: 0.2515 - accuracy: 0.8855 - val_loss: 0.8748 - val_accuracy: 0.7443
Confusion matrix: 
 [[435 138]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.759 0.241]
 [0.463 0.537]]
Validation f1: 21.89
Validation accuracy: 74.43
Validation recall: 53.66
Validation precision: 13.75
Validation AUC: 0.35423362954942134
Validation class accuracies: [0.7591623036649214, 0.5365853658536586]
The validation tracker metric at 0.6753246753246753 hasn't increased by 0 in 1 epochs
Epoch 9/65
226/226 - 317s - loss: 0.2164 - accuracy: 0.9021 - val_loss: 1.0619 - val_accuracy: 0.6612
Confusion matrix: 
 [[368 205]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.642 0.358]
 [0.073 0.927]]
Validation f1: 26.76
Validation accuracy: 66.12
Validation recall: 92.68
Validation precision: 15.64
Validation AUC: 0.6081204122253685
Validation class accuracies: [0.6422338568935427, 0.926829268292683]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 18 leaked semaphores to clean up at shutdown
  len(cache))
