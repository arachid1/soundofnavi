Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2117
Description:  mixednet_manualclassweights
2021-05-10 04:02:25.436907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 04:02:27.588602: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 04:02:27.589522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-10 04:02:27.637367: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:02:27.638080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 04:02:27.638126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 04:02:27.641662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 04:02:27.641741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 04:02:27.642832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 04:02:27.643110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 04:02:27.644164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 04:02:27.645086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 04:02:27.645247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 04:02:27.645349: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:02:27.646076: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:02:27.646736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-10 04:03:01.433693: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-10 04:03:01.434047: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:03:01.434832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-10 04:03:01.434880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 04:03:01.434954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 04:03:01.434974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 04:03:01.434994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-10 04:03:01.435014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-10 04:03:01.435045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-10 04:03:01.435064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-10 04:03:01.435083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-10 04:03:01.435189: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:03:01.435966: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:03:01.436676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-10 04:03:01.436737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-10 04:03:02.094476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-10 04:03:02.094522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-10 04:03:02.094531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-10 04:03:02.094813: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:03:02.095547: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:03:02.096278: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-10 04:03:02.096955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-10 04:03:03.088537: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-10 04:03:03.090159: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-10 04:03:04.652435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-10 04:03:05.332477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-10 04:03:05.339754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2117.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2117__05_0400__v29__mixednet_manualclassweights/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 32, 'LR': 0.0001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 3, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.2, 1: 1}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 152s - loss: 0.2835 - accuracy: 0.4938 - val_loss: 0.7265 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.1601029650791599
Validation class accuracies: [0.0, 1.0]
Epoch 2/40
132/132 - 144s - loss: 0.2725 - accuracy: 0.4228 - val_loss: 0.7627 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.20786614648893847
Validation class accuracies: [0.0, 1.0]
Epoch 3/40
132/132 - 145s - loss: 0.2659 - accuracy: 0.3942 - val_loss: 0.7830 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.19512090931638
Validation class accuracies: [0.0, 1.0]
Epoch 4/40
132/132 - 144s - loss: 0.2619 - accuracy: 0.3737 - val_loss: 0.7815 - val_accuracy: 0.2123
Confusion matrix: 
 [[ 18 852]
 [  5 213]]
Validation f1: 33.20
Validation accuracy: 21.23
Validation recall: 97.71
Validation precision: 20.00
Validation AUC: 0.19428445070789294
Validation class accuracies: [0.020689655172413793, 0.9770642201834863]
Epoch 5/40
132/132 - 144s - loss: 0.2586 - accuracy: 0.3768 - val_loss: 0.8188 - val_accuracy: 0.2059
Confusion matrix: 
 [[  9 861]
 [  3 215]]
Validation f1: 33.23
Validation accuracy: 20.59
Validation recall: 98.62
Validation precision: 19.98
Validation AUC: 0.21614379010244725
Validation class accuracies: [0.010344827586206896, 0.9862385321100917]
Epoch 6/40
132/132 - 145s - loss: 0.2574 - accuracy: 0.3708 - val_loss: 0.8882 - val_accuracy: 0.2215
Confusion matrix: 
 [[ 29 841]
 [  6 212]]
Validation f1: 33.36
Validation accuracy: 22.15
Validation recall: 97.25
Validation precision: 20.13
Validation AUC: 0.21860235590200455
Validation class accuracies: [0.03333333333333333, 0.9724770642201835]
Saving model...
Epoch 7/40
132/132 - 145s - loss: 0.2551 - accuracy: 0.3522 - val_loss: 0.8478 - val_accuracy: 0.3805
Confusion matrix: 
 [[225 645]
 [ 29 189]]
Validation f1: 35.93
Validation accuracy: 38.05
Validation recall: 86.70
Validation precision: 22.66
Validation AUC: 0.23804041896344358
Validation class accuracies: [0.25862068965517243, 0.8669724770642202]
Saving model...
Epoch 8/40
132/132 - 145s - loss: 0.2529 - accuracy: 0.3658 - val_loss: 1.0453 - val_accuracy: 0.2169
Confusion matrix: 
 [[ 35 835]
 [ 17 201]]
Validation f1: 32.06
Validation accuracy: 21.69
Validation recall: 92.20
Validation precision: 19.40
Validation AUC: 0.20039551798137056
Validation class accuracies: [0.040229885057471264, 0.9220183486238532]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 1 epochs
Epoch 9/40
132/132 - 144s - loss: 0.2510 - accuracy: 0.3592 - val_loss: 1.0019 - val_accuracy: 0.2344
Confusion matrix: 
 [[ 44 826]
 [  7 211]]
Validation f1: 33.63
Validation accuracy: 23.44
Validation recall: 96.79
Validation precision: 20.35
Validation AUC: 0.2256445506870206
Validation class accuracies: [0.05057471264367816, 0.9678899082568807]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 2 epochs
Epoch 10/40
132/132 - 144s - loss: 0.2498 - accuracy: 0.3630 - val_loss: 1.0500 - val_accuracy: 0.2114
Confusion matrix: 
 [[ 20 850]
 [  8 210]]
Validation f1: 32.86
Validation accuracy: 21.14
Validation recall: 96.33
Validation precision: 19.81
Validation AUC: 0.21477356593555658
Validation class accuracies: [0.022988505747126436, 0.963302752293578]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 3 epochs
Epoch 11/40
132/132 - 144s - loss: 0.2477 - accuracy: 0.3580 - val_loss: 0.9217 - val_accuracy: 0.2969
Confusion matrix: 
 [[124 746]
 [ 19 199]]
Validation f1: 34.22
Validation accuracy: 29.69
Validation recall: 91.28
Validation precision: 21.06
Validation AUC: 0.2289196447220532
Validation class accuracies: [0.1425287356321839, 0.9128440366972477]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 4 epochs
Epoch 12/40
132/132 - 144s - loss: 0.2469 - accuracy: 0.3701 - val_loss: 0.9378 - val_accuracy: 0.2390
Confusion matrix: 
 [[ 57 813]
 [ 15 203]]
Validation f1: 32.90
Validation accuracy: 23.90
Validation recall: 93.12
Validation precision: 19.98
Validation AUC: 0.22164891107452345
Validation class accuracies: [0.06551724137931035, 0.9311926605504587]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 5 epochs
Epoch 13/40
132/132 - 144s - loss: 0.2460 - accuracy: 0.3768 - val_loss: 0.9272 - val_accuracy: 0.2426
Confusion matrix: 
 [[ 64 806]
 [ 18 200]]
Validation f1: 32.68
Validation accuracy: 24.26
Validation recall: 91.74
Validation precision: 19.88
Validation AUC: 0.2189432988577243
Validation class accuracies: [0.0735632183908046, 0.9174311926605505]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 6 epochs
Epoch 14/40
132/132 - 144s - loss: 0.2462 - accuracy: 0.3711 - val_loss: 0.9157 - val_accuracy: 0.2665
Confusion matrix: 
 [[ 91 779]
 [ 19 199]]
Validation f1: 33.28
Validation accuracy: 26.65
Validation recall: 91.28
Validation precision: 20.35
Validation AUC: 0.2230735196292748
Validation class accuracies: [0.10459770114942529, 0.9128440366972477]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 7 epochs
Epoch 15/40
132/132 - 144s - loss: 0.2454 - accuracy: 0.3701 - val_loss: 0.9262 - val_accuracy: 0.2491
Confusion matrix: 
 [[ 71 799]
 [ 18 200]]
Validation f1: 32.87
Validation accuracy: 24.91
Validation recall: 91.74
Validation precision: 20.02
Validation AUC: 0.22135381230683515
Validation class accuracies: [0.08160919540229886, 0.9174311926605505]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 8 epochs
Epoch 16/40
132/132 - 144s - loss: 0.2454 - accuracy: 0.3670 - val_loss: 0.8953 - val_accuracy: 0.2996
Confusion matrix: 
 [[130 740]
 [ 22 196]]
Validation f1: 33.97
Validation accuracy: 29.96
Validation recall: 89.91
Validation precision: 20.94
Validation AUC: 0.22524986319639304
Validation class accuracies: [0.14942528735632185, 0.8990825688073395]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 9 epochs
Epoch 17/40
132/132 - 145s - loss: 0.2453 - accuracy: 0.3696 - val_loss: 0.9004 - val_accuracy: 0.2776
Confusion matrix: 
 [[105 765]
 [ 21 197]]
Validation f1: 33.39
Validation accuracy: 27.76
Validation recall: 90.37
Validation precision: 20.48
Validation AUC: 0.2230508208357618
Validation class accuracies: [0.1206896551724138, 0.9036697247706422]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 10 epochs
Epoch 18/40
132/132 - 144s - loss: 0.2445 - accuracy: 0.3737 - val_loss: 0.9058 - val_accuracy: 0.2739
Confusion matrix: 
 [[100 770]
 [ 20 198]]
Validation f1: 33.39
Validation accuracy: 27.39
Validation recall: 90.83
Validation precision: 20.45
Validation AUC: 0.22220632760863512
Validation class accuracies: [0.11494252873563218, 0.908256880733945]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 11 epochs
Epoch 19/40
132/132 - 144s - loss: 0.2443 - accuracy: 0.3737 - val_loss: 0.9082 - val_accuracy: 0.2739
Confusion matrix: 
 [[100 770]
 [ 20 198]]
Validation f1: 33.39
Validation accuracy: 27.39
Validation recall: 90.83
Validation precision: 20.45
Validation AUC: 0.2229108778054194
Validation class accuracies: [0.11494252873563218, 0.908256880733945]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 12 epochs
Epoch 20/40
132/132 - 144s - loss: 0.2441 - accuracy: 0.3737 - val_loss: 0.8992 - val_accuracy: 0.2822
Confusion matrix: 
 [[113 757]
 [ 24 194]]
Validation f1: 33.19
Validation accuracy: 28.22
Validation recall: 88.99
Validation precision: 20.40
Validation AUC: 0.2236094576159073
Validation class accuracies: [0.12988505747126436, 0.8899082568807339]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 13 epochs
Epoch 21/40
132/132 - 145s - loss: 0.2438 - accuracy: 0.3713 - val_loss: 0.9046 - val_accuracy: 0.2776
Confusion matrix: 
 [[105 765]
 [ 21 197]]
Validation f1: 33.39
Validation accuracy: 27.76
Validation recall: 90.37
Validation precision: 20.48
Validation AUC: 0.22269451430703513
Validation class accuracies: [0.1206896551724138, 0.9036697247706422]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 14 epochs
Epoch 22/40
132/132 - 144s - loss: 0.2442 - accuracy: 0.3684 - val_loss: 0.9037 - val_accuracy: 0.2812
Confusion matrix: 
 [[109 761]
 [ 21 197]]
Validation f1: 33.50
Validation accuracy: 28.12
Validation recall: 90.37
Validation precision: 20.56
Validation AUC: 0.22320535478243222
Validation class accuracies: [0.12528735632183907, 0.9036697247706422]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 15 epochs
Epoch 23/40
132/132 - 145s - loss: 0.2438 - accuracy: 0.3713 - val_loss: 0.9045 - val_accuracy: 0.2748
Confusion matrix: 
 [[102 768]
 [ 21 197]]
Validation f1: 33.31
Validation accuracy: 27.48
Validation recall: 90.37
Validation precision: 20.41
Validation AUC: 0.22244224979541075
Validation class accuracies: [0.11724137931034483, 0.9036697247706422]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 16 epochs
Epoch 24/40
132/132 - 145s - loss: 0.2439 - accuracy: 0.3715 - val_loss: 0.9004 - val_accuracy: 0.2776
Confusion matrix: 
 [[106 764]
 [ 22 196]]
Validation f1: 33.28
Validation accuracy: 27.76
Validation recall: 89.91
Validation precision: 20.42
Validation AUC: 0.22267608616604806
Validation class accuracies: [0.12183908045977011, 0.8990825688073395]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 17 epochs
Epoch 25/40
132/132 - 145s - loss: 0.2438 - accuracy: 0.3742 - val_loss: 0.9052 - val_accuracy: 0.2730
Confusion matrix: 
 [[102 768]
 [ 23 195]]
Validation f1: 33.02
Validation accuracy: 27.30
Validation recall: 89.45
Validation precision: 20.25
Validation AUC: 0.22222597854503823
Validation class accuracies: [0.11724137931034483, 0.8944954128440367]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 18 epochs
Epoch 26/40
132/132 - 144s - loss: 0.2430 - accuracy: 0.3732 - val_loss: 0.9015 - val_accuracy: 0.2803
Confusion matrix: 
 [[109 761]
 [ 22 196]]
Validation f1: 33.36
Validation accuracy: 28.03
Validation recall: 89.91
Validation precision: 20.48
Validation AUC: 0.22285868768454514
Validation class accuracies: [0.12528735632183907, 0.8990825688073395]
The validation tracker metric at 0.3593155893536122 hasn't increased by 0.01 in 19 epochs
Epoch 27/40
132/132 - 144s - loss: 0.2442 - accuracy: 0.3780 - val_loss: 0.9029 - val_accuracy: 0.2776
Confusion matrix: 
 [[106 764]
 [ 22 196]]
Validation f1: 33.28
Validation accuracy: 27.76
Validation recall: 89.91
Validation precision: 20.42
Validation AUC: 0.22252134120733502
Validation class accuracies: [0.12183908045977011, 0.8990825688073395]

The metrics for the epoch with the best target metric are: 
Best cm: [[225 645]
 [ 29 189]]
Best f1: 0.3593155893536122
Best accuracy: 0.3805147058823529
Best recall: 0.8669724770642202
Best precision: 0.22661870503597123
Best AUC: 0.23804041896344358
Best epoch: 7
The number of epochs since last 1% equals the patience
weights = {0: 0.4, 1: 2}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_7 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_7 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_8 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_8 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_9 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_9 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d_1 ( (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 147s - loss: 0.5624 - accuracy: 0.5098 - val_loss: 0.7737 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.17784737161836617
Validation class accuracies: [0.0, 1.0]
Epoch 2/40
132/132 - 145s - loss: 0.5413 - accuracy: 0.4500 - val_loss: 0.8516 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.17118979957310287
Validation class accuracies: [0.0, 1.0]
Epoch 3/40
132/132 - 146s - loss: 0.5280 - accuracy: 0.4214 - val_loss: 0.9169 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.1776241216525516
Validation class accuracies: [0.0, 1.0]
Epoch 4/40
132/132 - 146s - loss: 0.5189 - accuracy: 0.3911 - val_loss: 0.8007 - val_accuracy: 0.2114
Confusion matrix: 
 [[ 18 852]
 [  6 212]]
Validation f1: 33.07
Validation accuracy: 21.14
Validation recall: 97.25
Validation precision: 19.92
Validation AUC: 0.18628192766845875
Validation class accuracies: [0.020689655172413793, 0.9724770642201835]
Epoch 5/40
132/132 - 146s - loss: 0.5125 - accuracy: 0.3863 - val_loss: 0.7953 - val_accuracy: 0.2353
Confusion matrix: 
 [[ 50 820]
 [ 12 206]]
Validation f1: 33.12
Validation accuracy: 23.53
Validation recall: 94.50
Validation precision: 20.08
Validation AUC: 0.21816867681657834
Validation class accuracies: [0.05747126436781609, 0.944954128440367]
Epoch 6/40
132/132 - 146s - loss: 0.5083 - accuracy: 0.3858 - val_loss: 0.8353 - val_accuracy: 0.2721
Confusion matrix: 
 [[101 769]
 [ 23 195]]
Validation f1: 32.99
Validation accuracy: 27.21
Validation recall: 89.45
Validation precision: 20.23
Validation AUC: 0.2269993389373007
Validation class accuracies: [0.11609195402298851, 0.8944954128440367]
Saving model...
Epoch 7/40
132/132 - 145s - loss: 0.5019 - accuracy: 0.3878 - val_loss: 0.8641 - val_accuracy: 0.2877
Confusion matrix: 
 [[126 744]
 [ 31 187]]
Validation f1: 32.55
Validation accuracy: 28.77
Validation recall: 85.78
Validation precision: 20.09
Validation AUC: 0.22077847129060985
Validation class accuracies: [0.14482758620689656, 0.8577981651376146]
The validation tracker metric at 0.3299492385786802 hasn't increased by 0.01 in 1 epochs
Epoch 8/40
132/132 - 146s - loss: 0.4998 - accuracy: 0.3844 - val_loss: 0.8476 - val_accuracy: 0.3631
Confusion matrix: 
 [[215 655]
 [ 38 180]]
Validation f1: 34.19
Validation accuracy: 36.31
Validation recall: 82.57
Validation precision: 21.56
Validation AUC: 0.23504519353438008
Validation class accuracies: [0.2471264367816092, 0.8256880733944955]
Saving model...
Epoch 9/40
132/132 - 145s - loss: 0.4944 - accuracy: 0.3923 - val_loss: 0.8002 - val_accuracy: 0.3897
Confusion matrix: 
 [[267 603]
 [ 61 157]]
Validation f1: 32.11
Validation accuracy: 38.97
Validation recall: 72.02
Validation precision: 20.66
Validation AUC: 0.21648665439565618
Validation class accuracies: [0.30689655172413793, 0.7201834862385321]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 1 epochs
Epoch 10/40
132/132 - 145s - loss: 0.4913 - accuracy: 0.3918 - val_loss: 0.9016 - val_accuracy: 0.3189
Confusion matrix: 
 [[162 708]
 [ 33 185]]
Validation f1: 33.30
Validation accuracy: 31.89
Validation recall: 84.86
Validation precision: 20.72
Validation AUC: 0.2326447919832284
Validation class accuracies: [0.18620689655172415, 0.8486238532110092]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 2 epochs
Epoch 11/40
132/132 - 146s - loss: 0.4866 - accuracy: 0.4087 - val_loss: 1.0811 - val_accuracy: 0.2178
Confusion matrix: 
 [[ 32 838]
 [ 13 205]]
Validation f1: 32.51
Validation accuracy: 21.78
Validation recall: 94.04
Validation precision: 19.65
Validation AUC: 0.23245832730197655
Validation class accuracies: [0.0367816091954023, 0.9403669724770642]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 3 epochs
Epoch 12/40
132/132 - 145s - loss: 0.4810 - accuracy: 0.4032 - val_loss: 0.8127 - val_accuracy: 0.3649
Confusion matrix: 
 [[244 626]
 [ 65 153]]
Validation f1: 30.69
Validation accuracy: 36.49
Validation recall: 70.18
Validation precision: 19.64
Validation AUC: 0.22087542394978193
Validation class accuracies: [0.28045977011494255, 0.7018348623853211]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 4 epochs
Epoch 13/40
132/132 - 145s - loss: 0.4823 - accuracy: 0.4013 - val_loss: 0.8617 - val_accuracy: 0.2987
Confusion matrix: 
 [[161 709]
 [ 54 164]]
Validation f1: 30.06
Validation accuracy: 29.87
Validation recall: 75.23
Validation precision: 18.79
Validation AUC: 0.22168645303653706
Validation class accuracies: [0.1850574712643678, 0.7522935779816514]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 5 epochs
Epoch 14/40
132/132 - 145s - loss: 0.4799 - accuracy: 0.4104 - val_loss: 0.8340 - val_accuracy: 0.3704
Confusion matrix: 
 [[238 632]
 [ 53 165]]
Validation f1: 32.51
Validation accuracy: 37.04
Validation recall: 75.69
Validation precision: 20.70
Validation AUC: 0.22736655990195523
Validation class accuracies: [0.2735632183908046, 0.7568807339449541]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 6 epochs
Epoch 15/40
132/132 - 145s - loss: 0.4789 - accuracy: 0.4068 - val_loss: 0.8925 - val_accuracy: 0.3355
Confusion matrix: 
 [[189 681]
 [ 42 176]]
Validation f1: 32.74
Validation accuracy: 33.55
Validation recall: 80.73
Validation precision: 20.54
Validation AUC: 0.2292792652934189
Validation class accuracies: [0.21724137931034482, 0.8073394495412844]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 7 epochs
Epoch 16/40
132/132 - 145s - loss: 0.4778 - accuracy: 0.4137 - val_loss: 0.9308 - val_accuracy: 0.2794
Confusion matrix: 
 [[118 752]
 [ 32 186]]
Validation f1: 32.18
Validation accuracy: 27.94
Validation recall: 85.32
Validation precision: 19.83
Validation AUC: 0.22776260864013118
Validation class accuracies: [0.135632183908046, 0.8532110091743119]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 8 epochs
Epoch 17/40
132/132 - 145s - loss: 0.4768 - accuracy: 0.4109 - val_loss: 0.9250 - val_accuracy: 0.2776
Confusion matrix: 
 [[116 754]
 [ 32 186]]
Validation f1: 32.12
Validation accuracy: 27.76
Validation recall: 85.32
Validation precision: 19.79
Validation AUC: 0.2277249336392943
Validation class accuracies: [0.13333333333333333, 0.8532110091743119]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 9 epochs
Epoch 18/40
132/132 - 145s - loss: 0.4756 - accuracy: 0.4085 - val_loss: 0.8886 - val_accuracy: 0.3189
Confusion matrix: 
 [[172 698]
 [ 43 175]]
Validation f1: 32.08
Validation accuracy: 31.89
Validation recall: 80.28
Validation precision: 20.05
Validation AUC: 0.22946781586986714
Validation class accuracies: [0.19770114942528735, 0.8027522935779816]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 10 epochs
Epoch 19/40
132/132 - 145s - loss: 0.4757 - accuracy: 0.4111 - val_loss: 0.8637 - val_accuracy: 0.3575
Confusion matrix: 
 [[218 652]
 [ 47 171]]
Validation f1: 32.85
Validation accuracy: 35.75
Validation recall: 78.44
Validation precision: 20.78
Validation AUC: 0.2310636997812053
Validation class accuracies: [0.25057471264367814, 0.7844036697247706]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 11 epochs
Epoch 20/40
132/132 - 145s - loss: 0.4738 - accuracy: 0.4161 - val_loss: 0.8586 - val_accuracy: 0.3603
Confusion matrix: 
 [[224 646]
 [ 50 168]]
Validation f1: 32.56
Validation accuracy: 36.03
Validation recall: 77.06
Validation precision: 20.64
Validation AUC: 0.23104519813142066
Validation class accuracies: [0.2574712643678161, 0.7706422018348624]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 12 epochs
Epoch 21/40
132/132 - 145s - loss: 0.4753 - accuracy: 0.4137 - val_loss: 0.8906 - val_accuracy: 0.3116
Confusion matrix: 
 [[166 704]
 [ 45 173]]
Validation f1: 31.60
Validation accuracy: 31.16
Validation recall: 79.36
Validation precision: 19.73
Validation AUC: 0.229669004900582
Validation class accuracies: [0.19080459770114944, 0.7935779816513762]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 13 epochs
Epoch 22/40
132/132 - 145s - loss: 0.4746 - accuracy: 0.4147 - val_loss: 0.8997 - val_accuracy: 0.3042
Confusion matrix: 
 [[156 714]
 [ 43 175]]
Validation f1: 31.62
Validation accuracy: 30.42
Validation recall: 80.28
Validation precision: 19.69
Validation AUC: 0.22943677541249136
Validation class accuracies: [0.1793103448275862, 0.8027522935779816]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 14 epochs
Epoch 23/40
132/132 - 145s - loss: 0.4721 - accuracy: 0.4130 - val_loss: 0.8881 - val_accuracy: 0.3171
Confusion matrix: 
 [[172 698]
 [ 45 173]]
Validation f1: 31.77
Validation accuracy: 31.71
Validation recall: 79.36
Validation precision: 19.86
Validation AUC: 0.23017596260389495
Validation class accuracies: [0.19770114942528735, 0.7935779816513762]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 15 epochs
Epoch 24/40
132/132 - 145s - loss: 0.4744 - accuracy: 0.4156 - val_loss: 0.8949 - val_accuracy: 0.3088
Confusion matrix: 
 [[161 709]
 [ 43 175]]
Validation f1: 31.76
Validation accuracy: 30.88
Validation recall: 80.28
Validation precision: 19.80
Validation AUC: 0.2301150630988762
Validation class accuracies: [0.1850574712643678, 0.8027522935779816]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 16 epochs
Epoch 25/40
132/132 - 146s - loss: 0.4719 - accuracy: 0.4163 - val_loss: 0.8949 - val_accuracy: 0.3088
Confusion matrix: 
 [[160 710]
 [ 42 176]]
Validation f1: 31.88
Validation accuracy: 30.88
Validation recall: 80.73
Validation precision: 19.86
Validation AUC: 0.23025230823215787
Validation class accuracies: [0.1839080459770115, 0.8073394495412844]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 17 epochs
Epoch 26/40
132/132 - 145s - loss: 0.4733 - accuracy: 0.4173 - val_loss: 0.9038 - val_accuracy: 0.3024
Confusion matrix: 
 [[150 720]
 [ 39 179]]
Validation f1: 32.05
Validation accuracy: 30.24
Validation recall: 82.11
Validation precision: 19.91
Validation AUC: 0.2303295208661554
Validation class accuracies: [0.1724137931034483, 0.8211009174311926]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 18 epochs
Epoch 27/40
132/132 - 145s - loss: 0.4735 - accuracy: 0.4118 - val_loss: 0.8965 - val_accuracy: 0.3042
Confusion matrix: 
 [[156 714]
 [ 43 175]]
Validation f1: 31.62
Validation accuracy: 30.42
Validation recall: 80.28
Validation precision: 19.69
Validation AUC: 0.22980250359178261
Validation class accuracies: [0.1793103448275862, 0.8027522935779816]
The validation tracker metric at 0.3418803418803419 hasn't increased by 0.01 in 19 epochs
Epoch 28/40
132/132 - 145s - loss: 0.4725 - accuracy: 0.4130 - val_loss: 0.8955 - val_accuracy: 0.3061
Confusion matrix: 
 [[158 712]
 [ 43 175]]
Validation f1: 31.67
Validation accuracy: 30.61
Validation recall: 80.28
Validation precision: 19.73
Validation AUC: 0.23013812081920285
Validation class accuracies: [0.18160919540229886, 0.8027522935779816]

The metrics for the epoch with the best target metric are: 
Best cm: [[215 655]
 [ 38 180]]
Best f1: 0.3418803418803419
Best accuracy: 0.3630514705882353
Best recall: 0.8256880733944955
Best precision: 0.2155688622754491
Best AUC: 0.23504519353438008
Best epoch: 8
The number of epochs since last 1% equals the patience
weights = {0: 0.5, 1: 1}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization_10 (Batc (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_11 (Averag (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_11 (Batc (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_12 (Averag (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_12 (Batc (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_13 (Averag (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_13 (Batc (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_14 (Averag (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_14 (Batc (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d_2 ( (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 146s - loss: 0.4371 - accuracy: 0.5927 - val_loss: 0.6729 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16218407697465814
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
132/132 - 144s - loss: 0.4265 - accuracy: 0.6785 - val_loss: 0.6748 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1645557290447846
Validation class accuracies: [1.0, 0.0]
Epoch 3/40
132/132 - 144s - loss: 0.4218 - accuracy: 0.6959 - val_loss: 0.6756 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1541783635582909
Validation class accuracies: [1.0, 0.0]
Epoch 4/40
132/132 - 144s - loss: 0.4172 - accuracy: 0.7102 - val_loss: 0.6669 - val_accuracy: 0.7960
Confusion matrix: 
 [[866   4]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.60
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16377149941879826
Validation class accuracies: [0.9954022988505747, 0.0]
Epoch 5/40
132/132 - 144s - loss: 0.4126 - accuracy: 0.7181 - val_loss: 0.6128 - val_accuracy: 0.7923
Confusion matrix: 
 [[861   9]
 [217   1]]
Validation f1: 0.88
Validation accuracy: 79.23
Validation recall: 0.46
Validation precision: 10.00
Validation AUC: 0.19166422144486112
Validation class accuracies: [0.9896551724137931, 0.0045871559633027525]
Epoch 6/40
132/132 - 144s - loss: 0.4102 - accuracy: 0.7238 - val_loss: 0.5901 - val_accuracy: 0.7500
Confusion matrix: 
 [[802  68]
 [204  14]]
Validation f1: 9.33
Validation accuracy: 75.00
Validation recall: 6.42
Validation precision: 17.07
Validation AUC: 0.22620181508109333
Validation class accuracies: [0.9218390804597701, 0.06422018348623854]
Saving model...
Epoch 7/40
132/132 - 144s - loss: 0.4059 - accuracy: 0.7207 - val_loss: 0.6559 - val_accuracy: 0.6765
Confusion matrix: 
 [[680 190]
 [162  56]]
Validation f1: 24.14
Validation accuracy: 67.65
Validation recall: 25.69
Validation precision: 22.76
Validation AUC: 0.21978059345101902
Validation class accuracies: [0.7816091954022989, 0.25688073394495414]
Saving model...
Epoch 8/40
132/132 - 144s - loss: 0.4041 - accuracy: 0.7281 - val_loss: 0.6230 - val_accuracy: 0.7105
Confusion matrix: 
 [[743 127]
 [188  30]]
Validation f1: 16.00
Validation accuracy: 71.05
Validation recall: 13.76
Validation precision: 19.11
Validation AUC: 0.22189911548054675
Validation class accuracies: [0.8540229885057471, 0.13761467889908258]
The validation tracker metric at 0.24137931034482757 hasn't increased by 0.01 in 1 epochs
Epoch 9/40
132/132 - 145s - loss: 0.4002 - accuracy: 0.7331 - val_loss: 0.7039 - val_accuracy: 0.5597
Confusion matrix: 
 [[499 371]
 [108 110]]
Validation f1: 31.47
Validation accuracy: 55.97
Validation recall: 50.46
Validation precision: 22.87
Validation AUC: 0.22334318281049198
Validation class accuracies: [0.5735632183908046, 0.5045871559633027]
Saving model...
Epoch 10/40
132/132 - 145s - loss: 0.3978 - accuracy: 0.7283 - val_loss: 0.7938 - val_accuracy: 0.3134
Confusion matrix: 
 [[176 694]
 [ 53 165]]
Validation f1: 30.64
Validation accuracy: 31.34
Validation recall: 75.69
Validation precision: 19.21
Validation AUC: 0.20475015597199325
Validation class accuracies: [0.20229885057471264, 0.7568807339449541]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 1 epochs
Epoch 11/40
132/132 - 144s - loss: 0.3949 - accuracy: 0.7350 - val_loss: 0.7235 - val_accuracy: 0.5092
Confusion matrix: 
 [[464 406]
 [128  90]]
Validation f1: 25.21
Validation accuracy: 50.92
Validation recall: 41.28
Validation precision: 18.15
Validation AUC: 0.18843844667101112
Validation class accuracies: [0.5333333333333333, 0.41284403669724773]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 2 epochs
Epoch 12/40
132/132 - 144s - loss: 0.3919 - accuracy: 0.7448 - val_loss: 0.7048 - val_accuracy: 0.5561
Confusion matrix: 
 [[512 358]
 [125  93]]
Validation f1: 27.80
Validation accuracy: 55.61
Validation recall: 42.66
Validation precision: 20.62
Validation AUC: 0.20740289290043906
Validation class accuracies: [0.5885057471264368, 0.42660550458715596]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 3 epochs
Epoch 13/40
132/132 - 143s - loss: 0.3870 - accuracy: 0.7493 - val_loss: 0.6190 - val_accuracy: 0.7086
Confusion matrix: 
 [[737 133]
 [184  34]]
Validation f1: 17.66
Validation accuracy: 70.86
Validation recall: 15.60
Validation precision: 20.36
Validation AUC: 0.22235904453374636
Validation class accuracies: [0.8471264367816091, 0.1559633027522936]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 4 epochs
Epoch 14/40
132/132 - 143s - loss: 0.3872 - accuracy: 0.7502 - val_loss: 0.6128 - val_accuracy: 0.7270
Confusion matrix: 
 [[760 110]
 [187  31]]
Validation f1: 17.27
Validation accuracy: 72.70
Validation recall: 14.22
Validation precision: 21.99
Validation AUC: 0.21391887303445123
Validation class accuracies: [0.8735632183908046, 0.14220183486238533]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 5 epochs
Epoch 15/40
132/132 - 144s - loss: 0.3843 - accuracy: 0.7543 - val_loss: 0.6540 - val_accuracy: 0.6774
Confusion matrix: 
 [[679 191]
 [160  58]]
Validation f1: 24.84
Validation accuracy: 67.74
Validation recall: 26.61
Validation precision: 23.29
Validation AUC: 0.22568497478724914
Validation class accuracies: [0.7804597701149425, 0.26605504587155965]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 6 epochs
Epoch 16/40
132/132 - 144s - loss: 0.3838 - accuracy: 0.7495 - val_loss: 0.6607 - val_accuracy: 0.6581
Confusion matrix: 
 [[649 221]
 [151  67]]
Validation f1: 26.48
Validation accuracy: 65.81
Validation recall: 30.73
Validation precision: 23.26
Validation AUC: 0.21591070730010736
Validation class accuracies: [0.7459770114942529, 0.3073394495412844]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 7 epochs
Epoch 17/40
132/132 - 144s - loss: 0.3829 - accuracy: 0.7529 - val_loss: 0.6634 - val_accuracy: 0.6581
Confusion matrix: 
 [[647 223]
 [149  69]]
Validation f1: 27.06
Validation accuracy: 65.81
Validation recall: 31.65
Validation precision: 23.63
Validation AUC: 0.21573666026857558
Validation class accuracies: [0.7436781609195402, 0.3165137614678899]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 8 epochs
Epoch 18/40
132/132 - 144s - loss: 0.3799 - accuracy: 0.7576 - val_loss: 0.6687 - val_accuracy: 0.6471
Confusion matrix: 
 [[632 238]
 [146  72]]
Validation f1: 27.27
Validation accuracy: 64.71
Validation recall: 33.03
Validation precision: 23.23
Validation AUC: 0.21225388982683036
Validation class accuracies: [0.7264367816091954, 0.3302752293577982]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 9 epochs
Epoch 19/40
132/132 - 144s - loss: 0.3799 - accuracy: 0.7614 - val_loss: 0.6366 - val_accuracy: 0.6994
Confusion matrix: 
 [[710 160]
 [167  51]]
Validation f1: 23.78
Validation accuracy: 69.94
Validation recall: 23.39
Validation precision: 24.17
Validation AUC: 0.21617074832597766
Validation class accuracies: [0.8160919540229885, 0.23394495412844038]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 10 epochs
Epoch 20/40
132/132 - 144s - loss: 0.3797 - accuracy: 0.7612 - val_loss: 0.6448 - val_accuracy: 0.6912
Confusion matrix: 
 [[700 170]
 [166  52]]
Validation f1: 23.64
Validation accuracy: 69.12
Validation recall: 23.85
Validation precision: 23.42
Validation AUC: 0.21533937726058883
Validation class accuracies: [0.8045977011494253, 0.23853211009174313]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 11 epochs
Epoch 21/40
132/132 - 144s - loss: 0.3784 - accuracy: 0.7614 - val_loss: 0.6548 - val_accuracy: 0.6728
Confusion matrix: 
 [[669 201]
 [155  63]]
Validation f1: 26.14
Validation accuracy: 67.28
Validation recall: 28.90
Validation precision: 23.86
Validation AUC: 0.21441099988969986
Validation class accuracies: [0.7689655172413793, 0.2889908256880734]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 12 epochs
Epoch 22/40
132/132 - 144s - loss: 0.3802 - accuracy: 0.7617 - val_loss: 0.6495 - val_accuracy: 0.6820
Confusion matrix: 
 [[684 186]
 [160  58]]
Validation f1: 25.11
Validation accuracy: 68.20
Validation recall: 26.61
Validation precision: 23.77
Validation AUC: 0.21541160148766467
Validation class accuracies: [0.7862068965517242, 0.26605504587155965]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 13 epochs
Epoch 23/40
132/132 - 143s - loss: 0.3790 - accuracy: 0.7633 - val_loss: 0.6459 - val_accuracy: 0.6875
Confusion matrix: 
 [[692 178]
 [162  56]]
Validation f1: 24.78
Validation accuracy: 68.75
Validation recall: 25.69
Validation precision: 23.93
Validation AUC: 0.21561549017693843
Validation class accuracies: [0.7954022988505747, 0.25688073394495414]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 14 epochs
Epoch 24/40
132/132 - 143s - loss: 0.3782 - accuracy: 0.7669 - val_loss: 0.6489 - val_accuracy: 0.6847
Confusion matrix: 
 [[688 182]
 [161  57]]
Validation f1: 24.95
Validation accuracy: 68.47
Validation recall: 26.15
Validation precision: 23.85
Validation AUC: 0.2150021195562026
Validation class accuracies: [0.7908045977011494, 0.26146788990825687]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 15 epochs
Epoch 25/40
132/132 - 143s - loss: 0.3789 - accuracy: 0.7622 - val_loss: 0.6467 - val_accuracy: 0.6847
Confusion matrix: 
 [[689 181]
 [162  56]]
Validation f1: 24.62
Validation accuracy: 68.47
Validation recall: 25.69
Validation precision: 23.63
Validation AUC: 0.21569020804161973
Validation class accuracies: [0.7919540229885057, 0.25688073394495414]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 16 epochs
Epoch 26/40
132/132 - 143s - loss: 0.3784 - accuracy: 0.7610 - val_loss: 0.6432 - val_accuracy: 0.6903
Confusion matrix: 
 [[698 172]
 [165  53]]
Validation f1: 23.93
Validation accuracy: 69.03
Validation recall: 24.31
Validation precision: 23.56
Validation AUC: 0.2165773112470789
Validation class accuracies: [0.8022988505747126, 0.24311926605504589]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 17 epochs
Epoch 27/40
132/132 - 144s - loss: 0.3785 - accuracy: 0.7629 - val_loss: 0.6453 - val_accuracy: 0.6866
Confusion matrix: 
 [[692 178]
 [163  55]]
Validation f1: 24.39
Validation accuracy: 68.66
Validation recall: 25.23
Validation precision: 23.61
Validation AUC: 0.21594417776351277
Validation class accuracies: [0.7954022988505747, 0.25229357798165136]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 18 epochs
Epoch 28/40
132/132 - 144s - loss: 0.3761 - accuracy: 0.7653 - val_loss: 0.6444 - val_accuracy: 0.6875
Confusion matrix: 
 [[693 177]
 [163  55]]
Validation f1: 24.44
Validation accuracy: 68.75
Validation recall: 25.23
Validation precision: 23.71
Validation AUC: 0.21613223878174065
Validation class accuracies: [0.7965517241379311, 0.25229357798165136]
The validation tracker metric at 0.3147353361945637 hasn't increased by 0.01 in 19 epochs
Epoch 29/40
132/132 - 144s - loss: 0.3782 - accuracy: 0.7619 - val_loss: 0.6455 - val_accuracy: 0.6847
Confusion matrix: 
 [[690 180]
 [163  55]]
Validation f1: 24.28
Validation accuracy: 68.47
Validation recall: 25.23
Validation precision: 23.40
Validation AUC: 0.21606244706421252
Validation class accuracies: [0.7931034482758621, 0.25229357798165136]

The metrics for the epoch with the best target metric are: 
Best cm: [[499 371]
 [108 110]]
Best f1: 0.3147353361945637
Best accuracy: 0.5597426470588235
Best recall: 0.5045871559633027
Best precision: 0.2286902286902287
Best AUC: 0.22334318281049198
Best epoch: 9
The number of epochs since last 1% equals the patience
weights = {0: 1, 1: 4.5}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d_15 (Averag (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization_15 (Batc (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_16 (Conv2D)           (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_16 (Averag (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_16 (Batc (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_17 (Conv2D)           (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_17 (Averag (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_17 (Batc (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_18 (Conv2D)           (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_18 (Averag (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_18 (Batc (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_19 (Conv2D)           (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_19 (Averag (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_19 (Batc (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d_3 ( (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 147s - loss: 1.3205 - accuracy: 0.5155 - val_loss: 0.7611 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2484548604321538
Validation class accuracies: [0.0, 1.0]
Epoch 2/40
132/132 - 144s - loss: 1.2730 - accuracy: 0.4495 - val_loss: 0.8053 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2595937177998988
Validation class accuracies: [0.0, 1.0]
Epoch 3/40
132/132 - 145s - loss: 1.2530 - accuracy: 0.4221 - val_loss: 0.8495 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.22670983489173557
Validation class accuracies: [0.0, 1.0]
Epoch 4/40
132/132 - 144s - loss: 1.2374 - accuracy: 0.4032 - val_loss: 0.7517 - val_accuracy: 0.2022
Confusion matrix: 
 [[  2 868]
 [  0 218]]
Validation f1: 33.44
Validation accuracy: 20.22
Validation recall: 100.00
Validation precision: 20.07
Validation AUC: 0.23442543161010154
Validation class accuracies: [0.0022988505747126436, 1.0]
Epoch 5/40
132/132 - 144s - loss: 1.2242 - accuracy: 0.3966 - val_loss: 0.7857 - val_accuracy: 0.2215
Confusion matrix: 
 [[ 42 828]
 [ 19 199]]
Validation f1: 31.97
Validation accuracy: 22.15
Validation recall: 91.28
Validation precision: 19.38
Validation AUC: 0.21186160942954196
Validation class accuracies: [0.04827586206896552, 0.9128440366972477]
Epoch 6/40
132/132 - 144s - loss: 1.2125 - accuracy: 0.3992 - val_loss: 0.8093 - val_accuracy: 0.2592
Confusion matrix: 
 [[109 761]
 [ 45 173]]
Validation f1: 30.03
Validation accuracy: 25.92
Validation recall: 79.36
Validation precision: 18.52
Validation AUC: 0.2141389016059894
Validation class accuracies: [0.12528735632183907, 0.7935779816513762]
Saving model...
Epoch 7/40
132/132 - 144s - loss: 1.2059 - accuracy: 0.3882 - val_loss: 0.8631 - val_accuracy: 0.3805
Confusion matrix: 
 [[220 650]
 [ 24 194]]
Validation f1: 36.53
Validation accuracy: 38.05
Validation recall: 88.99
Validation precision: 22.99
Validation AUC: 0.24191905691657264
Validation class accuracies: [0.25287356321839083, 0.8899082568807339]
Saving model...
Epoch 8/40
132/132 - 144s - loss: 1.1953 - accuracy: 0.3970 - val_loss: 0.8735 - val_accuracy: 0.2711
Confusion matrix: 
 [[101 769]
 [ 24 194]]
Validation f1: 32.85
Validation accuracy: 27.11
Validation recall: 88.99
Validation precision: 20.15
Validation AUC: 0.22221068074277328
Validation class accuracies: [0.11609195402298851, 0.8899082568807339]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 1 epochs
Epoch 9/40
132/132 - 146s - loss: 1.1894 - accuracy: 0.3975 - val_loss: 0.8962 - val_accuracy: 0.2868
Confusion matrix: 
 [[110 760]
 [ 16 202]]
Validation f1: 34.24
Validation accuracy: 28.68
Validation recall: 92.66
Validation precision: 21.00
Validation AUC: 0.22939157143754052
Validation class accuracies: [0.12643678160919541, 0.926605504587156]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 2 epochs
Epoch 10/40
132/132 - 145s - loss: 1.1847 - accuracy: 0.3987 - val_loss: 0.8619 - val_accuracy: 0.2932
Confusion matrix: 
 [[128 742]
 [ 27 191]]
Validation f1: 33.19
Validation accuracy: 29.32
Validation recall: 87.61
Validation precision: 20.47
Validation AUC: 0.22930332032823486
Validation class accuracies: [0.1471264367816092, 0.8761467889908257]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 3 epochs
Epoch 11/40
132/132 - 143s - loss: 1.1714 - accuracy: 0.3966 - val_loss: 0.8911 - val_accuracy: 0.2629
Confusion matrix: 
 [[ 91 779]
 [ 23 195]]
Validation f1: 32.72
Validation accuracy: 26.29
Validation recall: 89.45
Validation precision: 20.02
Validation AUC: 0.22706911309009195
Validation class accuracies: [0.10459770114942529, 0.8944954128440367]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 4 epochs
Epoch 12/40
132/132 - 143s - loss: 1.1635 - accuracy: 0.4059 - val_loss: 0.8856 - val_accuracy: 0.3217
Confusion matrix: 
 [[153 717]
 [ 21 197]]
Validation f1: 34.81
Validation accuracy: 32.17
Validation recall: 90.37
Validation precision: 21.55
Validation AUC: 0.2318732452992701
Validation class accuracies: [0.17586206896551723, 0.9036697247706422]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 5 epochs
Epoch 13/40
132/132 - 143s - loss: 1.1631 - accuracy: 0.4082 - val_loss: 0.8785 - val_accuracy: 0.2619
Confusion matrix: 
 [[101 769]
 [ 34 184]]
Validation f1: 31.43
Validation accuracy: 26.19
Validation recall: 84.40
Validation precision: 19.31
Validation AUC: 0.22453868384265524
Validation class accuracies: [0.11609195402298851, 0.8440366972477065]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 6 epochs
Epoch 14/40
132/132 - 143s - loss: 1.1522 - accuracy: 0.4104 - val_loss: 0.8783 - val_accuracy: 0.3134
Confusion matrix: 
 [[148 722]
 [ 25 193]]
Validation f1: 34.07
Validation accuracy: 31.34
Validation recall: 88.53
Validation precision: 21.09
Validation AUC: 0.22983979775960134
Validation class accuracies: [0.17011494252873563, 0.8853211009174312]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 7 epochs
Epoch 15/40
132/132 - 143s - loss: 1.1545 - accuracy: 0.4130 - val_loss: 0.8692 - val_accuracy: 0.2803
Confusion matrix: 
 [[122 748]
 [ 35 183]]
Validation f1: 31.85
Validation accuracy: 28.03
Validation recall: 83.94
Validation precision: 19.66
Validation AUC: 0.22539237754394628
Validation class accuracies: [0.14022988505747128, 0.8394495412844036]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 8 epochs
Epoch 16/40
132/132 - 143s - loss: 1.1514 - accuracy: 0.4144 - val_loss: 0.8693 - val_accuracy: 0.2877
Confusion matrix: 
 [[131 739]
 [ 36 182]]
Validation f1: 31.96
Validation accuracy: 28.77
Validation recall: 83.49
Validation precision: 19.76
Validation AUC: 0.224938003703315
Validation class accuracies: [0.15057471264367817, 0.8348623853211009]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 9 epochs
Epoch 17/40
132/132 - 145s - loss: 1.1468 - accuracy: 0.4135 - val_loss: 0.8726 - val_accuracy: 0.2978
Confusion matrix: 
 [[141 729]
 [ 35 183]]
Validation f1: 32.39
Validation accuracy: 29.78
Validation recall: 83.94
Validation precision: 20.07
Validation AUC: 0.22680105023802147
Validation class accuracies: [0.16206896551724137, 0.8394495412844036]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 10 epochs
Epoch 18/40
132/132 - 143s - loss: 1.1517 - accuracy: 0.4125 - val_loss: 0.8723 - val_accuracy: 0.3006
Confusion matrix: 
 [[144 726]
 [ 35 183]]
Validation f1: 32.48
Validation accuracy: 30.06
Validation recall: 83.94
Validation precision: 20.13
Validation AUC: 0.2277331346125696
Validation class accuracies: [0.16551724137931034, 0.8394495412844036]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 11 epochs
Epoch 19/40
132/132 - 143s - loss: 1.1432 - accuracy: 0.4142 - val_loss: 0.8749 - val_accuracy: 0.3006
Confusion matrix: 
 [[143 727]
 [ 34 184]]
Validation f1: 32.60
Validation accuracy: 30.06
Validation recall: 84.40
Validation precision: 20.20
Validation AUC: 0.22668993998687562
Validation class accuracies: [0.16436781609195403, 0.8440366972477065]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 12 epochs
Epoch 20/40
132/132 - 143s - loss: 1.1507 - accuracy: 0.4128 - val_loss: 0.8707 - val_accuracy: 0.2923
Confusion matrix: 
 [[136 734]
 [ 36 182]]
Validation f1: 32.10
Validation accuracy: 29.23
Validation recall: 83.49
Validation precision: 19.87
Validation AUC: 0.2261689156944824
Validation class accuracies: [0.15632183908045977, 0.8348623853211009]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 13 epochs
Epoch 21/40
132/132 - 143s - loss: 1.1466 - accuracy: 0.4168 - val_loss: 0.8693 - val_accuracy: 0.3015
Confusion matrix: 
 [[147 723]
 [ 37 181]]
Validation f1: 32.26
Validation accuracy: 30.15
Validation recall: 83.03
Validation precision: 20.02
Validation AUC: 0.2265904842176037
Validation class accuracies: [0.16896551724137931, 0.8302752293577982]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 14 epochs
Epoch 22/40
132/132 - 145s - loss: 1.1453 - accuracy: 0.4168 - val_loss: 0.8693 - val_accuracy: 0.2987
Confusion matrix: 
 [[144 726]
 [ 37 181]]
Validation f1: 32.18
Validation accuracy: 29.87
Validation recall: 83.03
Validation precision: 19.96
Validation AUC: 0.22665637524636612
Validation class accuracies: [0.16551724137931034, 0.8302752293577982]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 15 epochs
Epoch 23/40
132/132 - 143s - loss: 1.1429 - accuracy: 0.4163 - val_loss: 0.8680 - val_accuracy: 0.3015
Confusion matrix: 
 [[147 723]
 [ 37 181]]
Validation f1: 32.26
Validation accuracy: 30.15
Validation recall: 83.03
Validation precision: 20.02
Validation AUC: 0.22680488272165422
Validation class accuracies: [0.16896551724137931, 0.8302752293577982]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 16 epochs
Epoch 24/40
132/132 - 143s - loss: 1.1465 - accuracy: 0.4192 - val_loss: 0.8715 - val_accuracy: 0.3024
Confusion matrix: 
 [[146 724]
 [ 35 183]]
Validation f1: 32.53
Validation accuracy: 30.24
Validation recall: 83.94
Validation precision: 20.18
Validation AUC: 0.22718456582197225
Validation class accuracies: [0.167816091954023, 0.8394495412844036]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 17 epochs
Epoch 25/40
132/132 - 143s - loss: 1.1467 - accuracy: 0.4149 - val_loss: 0.8710 - val_accuracy: 0.2996
Confusion matrix: 
 [[145 725]
 [ 37 181]]
Validation f1: 32.21
Validation accuracy: 29.96
Validation recall: 83.03
Validation precision: 19.98
Validation AUC: 0.22682282054044728
Validation class accuracies: [0.16666666666666666, 0.8302752293577982]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 18 epochs
Epoch 26/40
132/132 - 144s - loss: 1.1445 - accuracy: 0.4154 - val_loss: 0.8730 - val_accuracy: 0.2978
Confusion matrix: 
 [[143 727]
 [ 37 181]]
Validation f1: 32.15
Validation accuracy: 29.78
Validation recall: 83.03
Validation precision: 19.93
Validation AUC: 0.22708513497223112
Validation class accuracies: [0.16436781609195403, 0.8302752293577982]
The validation tracker metric at 0.3653483992467043 hasn't increased by 0.01 in 19 epochs
Epoch 27/40
132/132 - 143s - loss: 1.1465 - accuracy: 0.4154 - val_loss: 0.8697 - val_accuracy: 0.2996
Confusion matrix: 
 [[145 725]
 [ 37 181]]
Validation f1: 32.21
Validation accuracy: 29.96
Validation recall: 83.03
Validation precision: 19.98
Validation AUC: 0.22665874779820233
Validation class accuracies: [0.16666666666666666, 0.8302752293577982]

The metrics for the epoch with the best target metric are: 
Best cm: [[220 650]
 [ 24 194]]
Best f1: 0.3653483992467043
Best accuracy: 0.3805147058823529
Best recall: 0.8899082568807339
Best precision: 0.22985781990521326
Best AUC: 0.24191905691657264
Best epoch: 7
The number of epochs since last 1% equals the patience
weights = {0: 2, 1: 9}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d_20 (Conv2D)           (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d_20 (Averag (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization_20 (Batc (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_21 (Conv2D)           (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_21 (Averag (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_21 (Batc (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_22 (Conv2D)           (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_22 (Averag (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_22 (Batc (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_23 (Conv2D)           (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_23 (Averag (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_23 (Batc (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_24 (Conv2D)           (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_24 (Averag (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_24 (Batc (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d_4 ( (None, 128)               0         
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 146s - loss: 2.6663 - accuracy: 0.4971 - val_loss: 0.7686 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.24155888023940592
Validation class accuracies: [0.0, 1.0]
Epoch 2/40
132/132 - 145s - loss: 2.5670 - accuracy: 0.4106 - val_loss: 0.8379 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.24420624507089367
Validation class accuracies: [0.0, 1.0]
Epoch 3/40
132/132 - 144s - loss: 2.5070 - accuracy: 0.3982 - val_loss: 0.9113 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.18487640625733331
Validation class accuracies: [0.0, 1.0]
Epoch 4/40
132/132 - 144s - loss: 2.4841 - accuracy: 0.3904 - val_loss: 0.9343 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.21982912875412608
Validation class accuracies: [0.0, 1.0]
Epoch 5/40
132/132 - 144s - loss: 2.4581 - accuracy: 0.3842 - val_loss: 0.8580 - val_accuracy: 0.2022
Confusion matrix: 
 [[  3 867]
 [  1 217]]
Validation f1: 33.33
Validation accuracy: 20.22
Validation recall: 99.54
Validation precision: 20.02
Validation AUC: 0.2207298752990584
Validation class accuracies: [0.0034482758620689655, 0.9954128440366973]
Epoch 6/40
132/132 - 145s - loss: 2.4358 - accuracy: 0.3866 - val_loss: 0.8598 - val_accuracy: 0.2739
Confusion matrix: 
 [[102 768]
 [ 22 196]]
Validation f1: 33.16
Validation accuracy: 27.39
Validation recall: 89.91
Validation precision: 20.33
Validation AUC: 0.22997411559009306
Validation class accuracies: [0.11724137931034483, 0.8990825688073395]
Saving model...
Epoch 7/40
132/132 - 146s - loss: 2.4157 - accuracy: 0.3882 - val_loss: 0.8076 - val_accuracy: 0.3548
Confusion matrix: 
 [[209 661]
 [ 41 177]]
Validation f1: 33.52
Validation accuracy: 35.48
Validation recall: 81.19
Validation precision: 21.12
Validation AUC: 0.2319964638518724
Validation class accuracies: [0.24022988505747125, 0.8119266055045872]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 1 epochs
Saving model...
Epoch 8/40
132/132 - 146s - loss: 2.3955 - accuracy: 0.3949 - val_loss: 0.8771 - val_accuracy: 0.2574
Confusion matrix: 
 [[ 90 780]
 [ 28 190]]
Validation f1: 31.99
Validation accuracy: 25.74
Validation recall: 87.16
Validation precision: 19.59
Validation AUC: 0.22004281684177343
Validation class accuracies: [0.10344827586206896, 0.8715596330275229]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 2 epochs
Epoch 9/40
132/132 - 147s - loss: 2.3835 - accuracy: 0.3999 - val_loss: 0.8962 - val_accuracy: 0.3097
Confusion matrix: 
 [[147 723]
 [ 28 190]]
Validation f1: 33.60
Validation accuracy: 30.97
Validation recall: 87.16
Validation precision: 20.81
Validation AUC: 0.2302078652505654
Validation class accuracies: [0.16896551724137931, 0.8715596330275229]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 3 epochs
Saving model...
Epoch 10/40
132/132 - 146s - loss: 2.3641 - accuracy: 0.3985 - val_loss: 0.9000 - val_accuracy: 0.2316
Confusion matrix: 
 [[ 66 804]
 [ 32 186]]
Validation f1: 30.79
Validation accuracy: 23.16
Validation recall: 85.32
Validation precision: 18.79
Validation AUC: 0.21732712445135857
Validation class accuracies: [0.07586206896551724, 0.8532110091743119]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 4 epochs
Epoch 11/40
132/132 - 146s - loss: 2.3572 - accuracy: 0.3982 - val_loss: 0.8930 - val_accuracy: 0.3171
Confusion matrix: 
 [[159 711]
 [ 32 186]]
Validation f1: 33.36
Validation accuracy: 31.71
Validation recall: 85.32
Validation precision: 20.74
Validation AUC: 0.23427874052794265
Validation class accuracies: [0.18275862068965518, 0.8532110091743119]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 5 epochs
Epoch 12/40
132/132 - 146s - loss: 2.3503 - accuracy: 0.3987 - val_loss: 0.8697 - val_accuracy: 0.3244
Confusion matrix: 
 [[172 698]
 [ 37 181]]
Validation f1: 33.00
Validation accuracy: 32.44
Validation recall: 83.03
Validation precision: 20.59
Validation AUC: 0.23056871446155192
Validation class accuracies: [0.19770114942528735, 0.8302752293577982]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 6 epochs
Epoch 13/40
132/132 - 146s - loss: 2.3357 - accuracy: 0.4109 - val_loss: 0.8763 - val_accuracy: 0.2684
Confusion matrix: 
 [[111 759]
 [ 37 181]]
Validation f1: 31.26
Validation accuracy: 26.84
Validation recall: 83.03
Validation precision: 19.26
Validation AUC: 0.22386239113780076
Validation class accuracies: [0.12758620689655173, 0.8302752293577982]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 7 epochs
Epoch 14/40
132/132 - 146s - loss: 2.3409 - accuracy: 0.4030 - val_loss: 0.8687 - val_accuracy: 0.2978
Confusion matrix: 
 [[143 727]
 [ 37 181]]
Validation f1: 32.15
Validation accuracy: 29.78
Validation recall: 83.03
Validation precision: 19.93
Validation AUC: 0.22953524288950813
Validation class accuracies: [0.16436781609195403, 0.8302752293577982]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 8 epochs
Epoch 15/40
132/132 - 146s - loss: 2.3302 - accuracy: 0.4099 - val_loss: 0.8478 - val_accuracy: 0.3254
Confusion matrix: 
 [[178 692]
 [ 42 176]]
Validation f1: 32.41
Validation accuracy: 32.54
Validation recall: 80.73
Validation precision: 20.28
Validation AUC: 0.228478692406505
Validation class accuracies: [0.2045977011494253, 0.8073394495412844]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 9 epochs
Epoch 16/40
132/132 - 146s - loss: 2.3267 - accuracy: 0.4011 - val_loss: 0.8493 - val_accuracy: 0.3189
Confusion matrix: 
 [[172 698]
 [ 43 175]]
Validation f1: 32.08
Validation accuracy: 31.89
Validation recall: 80.28
Validation precision: 20.05
Validation AUC: 0.22795394993602944
Validation class accuracies: [0.19770114942528735, 0.8027522935779816]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 10 epochs
Epoch 17/40
132/132 - 146s - loss: 2.3249 - accuracy: 0.4113 - val_loss: 0.8540 - val_accuracy: 0.3097
Confusion matrix: 
 [[160 710]
 [ 41 177]]
Validation f1: 32.04
Validation accuracy: 30.97
Validation recall: 81.19
Validation precision: 19.95
Validation AUC: 0.22803743076137978
Validation class accuracies: [0.1839080459770115, 0.8119266055045872]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 11 epochs
Epoch 18/40
132/132 - 146s - loss: 2.3249 - accuracy: 0.4025 - val_loss: 0.8524 - val_accuracy: 0.3116
Confusion matrix: 
 [[164 706]
 [ 43 175]]
Validation f1: 31.85
Validation accuracy: 31.16
Validation recall: 80.28
Validation precision: 19.86
Validation AUC: 0.22777976464719393
Validation class accuracies: [0.18850574712643678, 0.8027522935779816]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 12 epochs
Epoch 19/40
132/132 - 145s - loss: 2.3278 - accuracy: 0.4035 - val_loss: 0.8513 - val_accuracy: 0.3134
Confusion matrix: 
 [[166 704]
 [ 43 175]]
Validation f1: 31.91
Validation accuracy: 31.34
Validation recall: 80.28
Validation precision: 19.91
Validation AUC: 0.22755531386896596
Validation class accuracies: [0.19080459770114944, 0.8027522935779816]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 13 epochs
Epoch 20/40
132/132 - 146s - loss: 2.3207 - accuracy: 0.4068 - val_loss: 0.8524 - val_accuracy: 0.3143
Confusion matrix: 
 [[167 703]
 [ 43 175]]
Validation f1: 31.93
Validation accuracy: 31.43
Validation recall: 80.28
Validation precision: 19.93
Validation AUC: 0.22753978131218167
Validation class accuracies: [0.19195402298850575, 0.8027522935779816]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 14 epochs
Epoch 21/40
132/132 - 146s - loss: 2.3199 - accuracy: 0.4123 - val_loss: 0.8535 - val_accuracy: 0.3134
Confusion matrix: 
 [[166 704]
 [ 43 175]]
Validation f1: 31.91
Validation accuracy: 31.34
Validation recall: 80.28
Validation precision: 19.91
Validation AUC: 0.2280246810726373
Validation class accuracies: [0.19080459770114944, 0.8027522935779816]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 15 epochs
Epoch 22/40
132/132 - 146s - loss: 2.3147 - accuracy: 0.4085 - val_loss: 0.8536 - val_accuracy: 0.3125
Confusion matrix: 
 [[164 706]
 [ 42 176]]
Validation f1: 32.00
Validation accuracy: 31.25
Validation recall: 80.73
Validation precision: 19.95
Validation AUC: 0.22826900554892574
Validation class accuracies: [0.18850574712643678, 0.8073394495412844]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 16 epochs
Epoch 23/40
132/132 - 145s - loss: 2.3215 - accuracy: 0.4075 - val_loss: 0.8509 - val_accuracy: 0.3162
Confusion matrix: 
 [[169 701]
 [ 43 175]]
Validation f1: 31.99
Validation accuracy: 31.62
Validation recall: 80.28
Validation precision: 19.98
Validation AUC: 0.22777170986596246
Validation class accuracies: [0.19425287356321838, 0.8027522935779816]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 17 epochs
Epoch 24/40
132/132 - 147s - loss: 2.3229 - accuracy: 0.4082 - val_loss: 0.8529 - val_accuracy: 0.3134
Confusion matrix: 
 [[166 704]
 [ 43 175]]
Validation f1: 31.91
Validation accuracy: 31.34
Validation recall: 80.28
Validation precision: 19.91
Validation AUC: 0.22802173187472752
Validation class accuracies: [0.19080459770114944, 0.8027522935779816]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 18 epochs
Epoch 25/40
132/132 - 146s - loss: 2.3193 - accuracy: 0.4102 - val_loss: 0.8546 - val_accuracy: 0.3134
Confusion matrix: 
 [[166 704]
 [ 43 175]]
Validation f1: 31.91
Validation accuracy: 31.34
Validation recall: 80.28
Validation precision: 19.91
Validation AUC: 0.22779744977309482
Validation class accuracies: [0.19080459770114944, 0.8027522935779816]
The validation tracker metric at 0.3316412859560068 hasn't increased by 0.01 in 19 epochs
Epoch 26/40
132/132 - 146s - loss: 2.3180 - accuracy: 0.4080 - val_loss: 0.8544 - val_accuracy: 0.3116
Confusion matrix: 
 [[163 707]
 [ 42 176]]
Validation f1: 31.97
Validation accuracy: 31.16
Validation recall: 80.73
Validation precision: 19.93
Validation AUC: 0.2279462990307627
Validation class accuracies: [0.18735632183908046, 0.8073394495412844]

The metrics for the epoch with the best target metric are: 
Best cm: [[147 723]
 [ 28 190]]
Best f1: 0.3359858532272325
Best accuracy: 0.30974264705882354
Best recall: 0.8715596330275229
Best precision: 0.20810514786418402
Best AUC: 0.2302078652505654
Best epoch: 9
The number of epochs since last 1% equals the patience
weights = {0: 1, 1: 10}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_6 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d_25 (Conv2D)           (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d_25 (Averag (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization_25 (Batc (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_26 (Conv2D)           (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_26 (Averag (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_26 (Batc (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_27 (Conv2D)           (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_27 (Averag (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_27 (Batc (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_28 (Conv2D)           (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_28 (Averag (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_28 (Batc (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_29 (Conv2D)           (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_29 (Averag (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_29 (Batc (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d_5 ( (None, 128)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 148s - loss: 2.2887 - accuracy: 0.5017 - val_loss: 0.7831 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2427577228619442
Validation class accuracies: [0.0, 1.0]
Epoch 2/40
132/132 - 145s - loss: 2.1089 - accuracy: 0.3949 - val_loss: 0.8793 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.25076240187239973
Validation class accuracies: [0.0, 1.0]
Epoch 3/40
132/132 - 145s - loss: 1.9941 - accuracy: 0.3496 - val_loss: 0.9299 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.23369362031319466
Validation class accuracies: [0.0, 1.0]
Epoch 4/40
132/132 - 145s - loss: 1.9061 - accuracy: 0.3227 - val_loss: 0.8946 - val_accuracy: 0.2004
Confusion matrix: 
 [[  0 870]
 [  0 218]]
Validation f1: 33.38
Validation accuracy: 20.04
Validation recall: 100.00
Validation precision: 20.04
Validation AUC: 0.2170998464680055
Validation class accuracies: [0.0, 1.0]
Epoch 5/40
132/132 - 145s - loss: 1.8384 - accuracy: 0.3203 - val_loss: 0.8455 - val_accuracy: 0.2132
Confusion matrix: 
 [[ 15 855]
 [  1 217]]
Validation f1: 33.64
Validation accuracy: 21.32
Validation recall: 99.54
Validation precision: 20.24
Validation AUC: 0.23639101591246742
Validation class accuracies: [0.017241379310344827, 0.9954128440366973]
Epoch 6/40
132/132 - 145s - loss: 1.7916 - accuracy: 0.3122 - val_loss: 1.0034 - val_accuracy: 0.2068
Confusion matrix: 
 [[  9 861]
 [  2 216]]
Validation f1: 33.36
Validation accuracy: 20.68
Validation recall: 99.08
Validation precision: 20.06
Validation AUC: 0.22722549513903534
Validation class accuracies: [0.010344827586206896, 0.9908256880733946]
Saving model...
Epoch 7/40
132/132 - 145s - loss: 1.7487 - accuracy: 0.3062 - val_loss: 0.9898 - val_accuracy: 0.2509
Confusion matrix: 
 [[ 64 806]
 [  9 209]]
Validation f1: 33.90
Validation accuracy: 25.09
Validation recall: 95.87
Validation precision: 20.59
Validation AUC: 0.237036373066486
Validation class accuracies: [0.0735632183908046, 0.9587155963302753]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 1 epochs
Saving model...
Epoch 8/40
132/132 - 145s - loss: 1.7223 - accuracy: 0.2984 - val_loss: 1.2418 - val_accuracy: 0.2013
Confusion matrix: 
 [[  1 869]
 [  0 218]]
Validation f1: 33.41
Validation accuracy: 20.13
Validation recall: 100.00
Validation precision: 20.06
Validation AUC: 0.23267638919122774
Validation class accuracies: [0.0011494252873563218, 1.0]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 2 epochs
Epoch 9/40
132/132 - 145s - loss: 1.6971 - accuracy: 0.2965 - val_loss: 1.0883 - val_accuracy: 0.2068
Confusion matrix: 
 [[  9 861]
 [  2 216]]
Validation f1: 33.36
Validation accuracy: 20.68
Validation recall: 99.08
Validation precision: 20.06
Validation AUC: 0.22995515555625942
Validation class accuracies: [0.010344827586206896, 0.9908256880733946]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 3 epochs
Epoch 10/40
132/132 - 145s - loss: 1.6767 - accuracy: 0.2924 - val_loss: 1.1405 - val_accuracy: 0.2040
Confusion matrix: 
 [[  6 864]
 [  2 216]]
Validation f1: 33.28
Validation accuracy: 20.40
Validation recall: 99.08
Validation precision: 20.00
Validation AUC: 0.23077155829727058
Validation class accuracies: [0.006896551724137931, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 4 epochs
Epoch 11/40
132/132 - 145s - loss: 1.6693 - accuracy: 0.2946 - val_loss: 1.1011 - val_accuracy: 0.2114
Confusion matrix: 
 [[ 15 855]
 [  3 215]]
Validation f1: 33.39
Validation accuracy: 21.14
Validation recall: 98.62
Validation precision: 20.09
Validation AUC: 0.2181065015792878
Validation class accuracies: [0.017241379310344827, 0.9862385321100917]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 5 epochs
Epoch 12/40
132/132 - 144s - loss: 1.6649 - accuracy: 0.2929 - val_loss: 1.0982 - val_accuracy: 0.2123
Confusion matrix: 
 [[ 15 855]
 [  2 216]]
Validation f1: 33.51
Validation accuracy: 21.23
Validation recall: 99.08
Validation precision: 20.17
Validation AUC: 0.23467282513942592
Validation class accuracies: [0.017241379310344827, 0.9908256880733946]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 6 epochs
Epoch 13/40
132/132 - 146s - loss: 1.6485 - accuracy: 0.2936 - val_loss: 1.1264 - val_accuracy: 0.2086
Confusion matrix: 
 [[ 11 859]
 [  2 216]]
Validation f1: 33.41
Validation accuracy: 20.86
Validation recall: 99.08
Validation precision: 20.09
Validation AUC: 0.22060136289908133
Validation class accuracies: [0.01264367816091954, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 7 epochs
Epoch 14/40
132/132 - 145s - loss: 1.6498 - accuracy: 0.2950 - val_loss: 1.1315 - val_accuracy: 0.2077
Confusion matrix: 
 [[  8 862]
 [  0 218]]
Validation f1: 33.59
Validation accuracy: 20.77
Validation recall: 100.00
Validation precision: 20.19
Validation AUC: 0.2333321295300652
Validation class accuracies: [0.009195402298850575, 1.0]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 8 epochs
Epoch 15/40
132/132 - 145s - loss: 1.6480 - accuracy: 0.2924 - val_loss: 1.1574 - val_accuracy: 0.2031
Confusion matrix: 
 [[  5 865]
 [  2 216]]
Validation f1: 33.26
Validation accuracy: 20.31
Validation recall: 99.08
Validation precision: 19.98
Validation AUC: 0.22690702511081234
Validation class accuracies: [0.005747126436781609, 0.9908256880733946]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 9 epochs
Epoch 16/40
132/132 - 144s - loss: 1.6422 - accuracy: 0.2943 - val_loss: 1.1503 - val_accuracy: 0.2059
Confusion matrix: 
 [[  8 862]
 [  2 216]]
Validation f1: 33.33
Validation accuracy: 20.59
Validation recall: 99.08
Validation precision: 20.04
Validation AUC: 0.2255338477517156
Validation class accuracies: [0.009195402298850575, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 10 epochs
Epoch 17/40
132/132 - 145s - loss: 1.6489 - accuracy: 0.2950 - val_loss: 1.1445 - val_accuracy: 0.2068
Confusion matrix: 
 [[  9 861]
 [  2 216]]
Validation f1: 33.36
Validation accuracy: 20.68
Validation recall: 99.08
Validation precision: 20.06
Validation AUC: 0.22677483810236987
Validation class accuracies: [0.010344827586206896, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 11 epochs
Epoch 18/40
132/132 - 145s - loss: 1.6372 - accuracy: 0.2917 - val_loss: 1.1371 - val_accuracy: 0.2068
Confusion matrix: 
 [[  9 861]
 [  2 216]]
Validation f1: 33.36
Validation accuracy: 20.68
Validation recall: 99.08
Validation precision: 20.06
Validation AUC: 0.22516663022326627
Validation class accuracies: [0.010344827586206896, 0.9908256880733946]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 12 epochs
Epoch 19/40
132/132 - 145s - loss: 1.6389 - accuracy: 0.2908 - val_loss: 1.1281 - val_accuracy: 0.2077
Confusion matrix: 
 [[ 10 860]
 [  2 216]]
Validation f1: 33.38
Validation accuracy: 20.77
Validation recall: 99.08
Validation precision: 20.07
Validation AUC: 0.2253363563450159
Validation class accuracies: [0.011494252873563218, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 13 epochs
Epoch 20/40
132/132 - 145s - loss: 1.6375 - accuracy: 0.2946 - val_loss: 1.1357 - val_accuracy: 0.2077
Confusion matrix: 
 [[ 10 860]
 [  2 216]]
Validation f1: 33.38
Validation accuracy: 20.77
Validation recall: 99.08
Validation precision: 20.07
Validation AUC: 0.22419983220281647
Validation class accuracies: [0.011494252873563218, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 14 epochs
Epoch 21/40
132/132 - 145s - loss: 1.6382 - accuracy: 0.2934 - val_loss: 1.1394 - val_accuracy: 0.2068
Confusion matrix: 
 [[  9 861]
 [  2 216]]
Validation f1: 33.36
Validation accuracy: 20.68
Validation recall: 99.08
Validation precision: 20.06
Validation AUC: 0.2247484566994415
Validation class accuracies: [0.010344827586206896, 0.9908256880733946]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 15 epochs
Epoch 22/40
132/132 - 144s - loss: 1.6327 - accuracy: 0.2946 - val_loss: 1.1357 - val_accuracy: 0.2086
Confusion matrix: 
 [[ 11 859]
 [  2 216]]
Validation f1: 33.41
Validation accuracy: 20.86
Validation recall: 99.08
Validation precision: 20.09
Validation AUC: 0.22428657915901876
Validation class accuracies: [0.01264367816091954, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 16 epochs
Epoch 23/40
132/132 - 144s - loss: 1.6384 - accuracy: 0.2943 - val_loss: 1.1345 - val_accuracy: 0.2077
Confusion matrix: 
 [[ 10 860]
 [  2 216]]
Validation f1: 33.38
Validation accuracy: 20.77
Validation recall: 99.08
Validation precision: 20.07
Validation AUC: 0.22389170612153922
Validation class accuracies: [0.011494252873563218, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 17 epochs
Epoch 24/40
132/132 - 145s - loss: 1.6331 - accuracy: 0.2939 - val_loss: 1.1300 - val_accuracy: 0.2096
Confusion matrix: 
 [[ 12 858]
 [  2 216]]
Validation f1: 33.44
Validation accuracy: 20.96
Validation recall: 99.08
Validation precision: 20.11
Validation AUC: 0.22331049588088078
Validation class accuracies: [0.013793103448275862, 0.9908256880733946]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 18 epochs
Epoch 25/40
132/132 - 144s - loss: 1.6338 - accuracy: 0.2924 - val_loss: 1.1308 - val_accuracy: 0.2096
Confusion matrix: 
 [[ 12 858]
 [  2 216]]
Validation f1: 33.44
Validation accuracy: 20.96
Validation recall: 99.08
Validation precision: 20.11
Validation AUC: 0.22344657441209378
Validation class accuracies: [0.013793103448275862, 0.9908256880733946]
The validation tracker metric at 0.33359073359073355 hasn't increased by 0.01 in 19 epochs
Epoch 26/40
132/132 - 145s - loss: 1.6311 - accuracy: 0.2948 - val_loss: 1.1403 - val_accuracy: 0.2086
Confusion matrix: 
 [[ 11 859]
 [  2 216]]
Validation f1: 33.41
Validation accuracy: 20.86
Validation recall: 99.08
Validation precision: 20.09
Validation AUC: 0.22435166639208529
Validation class accuracies: [0.01264367816091954, 0.9908256880733946]

The metrics for the epoch with the best target metric are: 
Best cm: [[ 64 806]
 [  9 209]]
Best f1: 0.3390105433901054
Best accuracy: 0.2509191176470588
Best recall: 0.9587155963302753
Best precision: 0.20591133004926107
Best AUC: 0.237036373066486
Best epoch: 7
The number of epochs since last 1% equals the patience
weights = {0: 1, 1: 0.5}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_7 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d_30 (Conv2D)           (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d_30 (Averag (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization_30 (Batc (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_31 (Conv2D)           (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_31 (Averag (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_31 (Batc (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_32 (Conv2D)           (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_32 (Averag (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_32 (Batc (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_33 (Conv2D)           (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_33 (Averag (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_33 (Batc (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_34 (Conv2D)           (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_34 (Averag (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_34 (Batc (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d_6 ( (None, 128)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 146s - loss: 0.5688 - accuracy: 0.6532 - val_loss: 0.6552 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16549436673796508
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
132/132 - 144s - loss: 0.5189 - accuracy: 0.7235 - val_loss: 0.6178 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16873485531365862
Validation class accuracies: [1.0, 0.0]
Epoch 3/40
132/132 - 143s - loss: 0.4802 - accuracy: 0.7357 - val_loss: 0.5715 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21908398519309843
Validation class accuracies: [1.0, 0.0]
Epoch 4/40
132/132 - 144s - loss: 0.4504 - accuracy: 0.7319 - val_loss: 0.5489 - val_accuracy: 0.8006
Confusion matrix: 
 [[870   0]
 [217   1]]
Validation f1: 0.91
Validation accuracy: 80.06
Validation recall: 0.46
Validation precision: 100.00
Validation AUC: 0.22336689610144522
Validation class accuracies: [1.0, 0.0045871559633027525]
Epoch 5/40
132/132 - 144s - loss: 0.4233 - accuracy: 0.7374 - val_loss: 0.5429 - val_accuracy: 0.7996
Confusion matrix: 
 [[868   2]
 [216   2]]
Validation f1: 1.80
Validation accuracy: 79.96
Validation recall: 0.92
Validation precision: 50.00
Validation AUC: 0.19624543349100745
Validation class accuracies: [0.9977011494252873, 0.009174311926605505]
Epoch 6/40
132/132 - 144s - loss: 0.4049 - accuracy: 0.7378 - val_loss: 0.5188 - val_accuracy: 0.7868
Confusion matrix: 
 [[852  18]
 [214   4]]
Validation f1: 3.33
Validation accuracy: 78.68
Validation recall: 1.83
Validation precision: 18.18
Validation AUC: 0.2270993205809588
Validation class accuracies: [0.9793103448275862, 0.01834862385321101]
Saving model...
Epoch 7/40
132/132 - 144s - loss: 0.3886 - accuracy: 0.7390 - val_loss: 0.5273 - val_accuracy: 0.7858
Confusion matrix: 
 [[852  18]
 [215   3]]
Validation f1: 2.51
Validation accuracy: 78.58
Validation recall: 1.38
Validation precision: 14.29
Validation AUC: 0.2113907707948654
Validation class accuracies: [0.9793103448275862, 0.013761467889908258]
The validation tracker metric at 0.03333333333333333 hasn't increased by 0.01 in 1 epochs
Epoch 8/40
132/132 - 146s - loss: 0.3765 - accuracy: 0.7378 - val_loss: 0.5171 - val_accuracy: 0.7932
Confusion matrix: 
 [[861   9]
 [216   2]]
Validation f1: 1.75
Validation accuracy: 79.32
Validation recall: 0.92
Validation precision: 18.18
Validation AUC: 0.20838390697934625
Validation class accuracies: [0.9896551724137931, 0.009174311926605505]
The validation tracker metric at 0.03333333333333333 hasn't increased by 0.01 in 2 epochs
Epoch 9/40
132/132 - 146s - loss: 0.3685 - accuracy: 0.7393 - val_loss: 0.5199 - val_accuracy: 0.7785
Confusion matrix: 
 [[841  29]
 [212   6]]
Validation f1: 4.74
Validation accuracy: 77.85
Validation recall: 2.75
Validation precision: 17.14
Validation AUC: 0.232054446560883
Validation class accuracies: [0.9666666666666667, 0.027522935779816515]
Saving model...
Epoch 10/40
132/132 - 146s - loss: 0.3609 - accuracy: 0.7383 - val_loss: 0.5181 - val_accuracy: 0.7904
Confusion matrix: 
 [[858  12]
 [216   2]]
Validation f1: 1.72
Validation accuracy: 79.04
Validation recall: 0.92
Validation precision: 14.29
Validation AUC: 0.20801974959384004
Validation class accuracies: [0.9862068965517241, 0.009174311926605505]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 1 epochs
Epoch 11/40
132/132 - 146s - loss: 0.3532 - accuracy: 0.7400 - val_loss: 0.5098 - val_accuracy: 0.8006
Confusion matrix: 
 [[868   2]
 [215   3]]
Validation f1: 2.69
Validation accuracy: 80.06
Validation recall: 1.38
Validation precision: 60.00
Validation AUC: 0.22142221399652312
Validation class accuracies: [0.9977011494252873, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 2 epochs
Epoch 12/40
132/132 - 146s - loss: 0.3495 - accuracy: 0.7405 - val_loss: 0.5188 - val_accuracy: 0.7840
Confusion matrix: 
 [[848  22]
 [213   5]]
Validation f1: 4.08
Validation accuracy: 78.40
Validation recall: 2.29
Validation precision: 18.52
Validation AUC: 0.22211958376309607
Validation class accuracies: [0.9747126436781609, 0.022935779816513763]
Lr has been adjusted to 4.999999873689376e-05
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 3 epochs
Epoch 13/40
132/132 - 146s - loss: 0.3437 - accuracy: 0.7412 - val_loss: 0.5229 - val_accuracy: 0.7886
Confusion matrix: 
 [[855  15]
 [215   3]]
Validation f1: 2.54
Validation accuracy: 78.86
Validation recall: 1.38
Validation precision: 16.67
Validation AUC: 0.2112886951320122
Validation class accuracies: [0.9827586206896551, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 4 epochs
Epoch 14/40
132/132 - 146s - loss: 0.3416 - accuracy: 0.7414 - val_loss: 0.5195 - val_accuracy: 0.7886
Confusion matrix: 
 [[855  15]
 [215   3]]
Validation f1: 2.54
Validation accuracy: 78.86
Validation recall: 1.38
Validation precision: 16.67
Validation AUC: 0.21810790873048244
Validation class accuracies: [0.9827586206896551, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 5 epochs
Epoch 15/40
132/132 - 146s - loss: 0.3388 - accuracy: 0.7431 - val_loss: 0.5196 - val_accuracy: 0.7932
Confusion matrix: 
 [[860  10]
 [215   3]]
Validation f1: 2.60
Validation accuracy: 79.32
Validation recall: 1.38
Validation precision: 23.08
Validation AUC: 0.2103159556214959
Validation class accuracies: [0.9885057471264368, 0.013761467889908258]
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 6 epochs
Epoch 16/40
132/132 - 146s - loss: 0.3372 - accuracy: 0.7412 - val_loss: 0.5189 - val_accuracy: 0.7932
Confusion matrix: 
 [[860  10]
 [215   3]]
Validation f1: 2.60
Validation accuracy: 79.32
Validation recall: 1.38
Validation precision: 23.08
Validation AUC: 0.21640986019341657
Validation class accuracies: [0.9885057471264368, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 7 epochs
Epoch 17/40
132/132 - 147s - loss: 0.3371 - accuracy: 0.7417 - val_loss: 0.5194 - val_accuracy: 0.7914
Confusion matrix: 
 [[858  12]
 [215   3]]
Validation f1: 2.58
Validation accuracy: 79.14
Validation recall: 1.38
Validation precision: 20.00
Validation AUC: 0.2161481626480501
Validation class accuracies: [0.9862068965517241, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 8 epochs
Epoch 18/40
132/132 - 147s - loss: 0.3367 - accuracy: 0.7417 - val_loss: 0.5187 - val_accuracy: 0.7932
Confusion matrix: 
 [[860  10]
 [215   3]]
Validation f1: 2.60
Validation accuracy: 79.32
Validation recall: 1.38
Validation precision: 23.08
Validation AUC: 0.2136301839597029
Validation class accuracies: [0.9885057471264368, 0.013761467889908258]
Lr has been adjusted to 1.249999968422344e-05
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 9 epochs
Epoch 19/40
132/132 - 146s - loss: 0.3351 - accuracy: 0.7419 - val_loss: 0.5209 - val_accuracy: 0.7904
Confusion matrix: 
 [[857  13]
 [215   3]]
Validation f1: 2.56
Validation accuracy: 79.04
Validation recall: 1.38
Validation precision: 18.75
Validation AUC: 0.2172075681665779
Validation class accuracies: [0.9850574712643678, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 10 epochs
Epoch 20/40
132/132 - 146s - loss: 0.3359 - accuracy: 0.7421 - val_loss: 0.5212 - val_accuracy: 0.7914
Confusion matrix: 
 [[858  12]
 [215   3]]
Validation f1: 2.58
Validation accuracy: 79.14
Validation recall: 1.38
Validation precision: 20.00
Validation AUC: 0.2160537721761922
Validation class accuracies: [0.9862068965517241, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 11 epochs
Epoch 21/40
132/132 - 146s - loss: 0.3342 - accuracy: 0.7436 - val_loss: 0.5221 - val_accuracy: 0.7932
Confusion matrix: 
 [[860  10]
 [215   3]]
Validation f1: 2.60
Validation accuracy: 79.32
Validation recall: 1.38
Validation precision: 23.08
Validation AUC: 0.21068527714785776
Validation class accuracies: [0.9885057471264368, 0.013761467889908258]
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 12 epochs
Epoch 22/40
132/132 - 146s - loss: 0.3334 - accuracy: 0.7407 - val_loss: 0.5216 - val_accuracy: 0.7914
Confusion matrix: 
 [[858  12]
 [215   3]]
Validation f1: 2.58
Validation accuracy: 79.14
Validation recall: 1.38
Validation precision: 20.00
Validation AUC: 0.215314222143074
Validation class accuracies: [0.9862068965517241, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 13 epochs
Epoch 23/40
132/132 - 147s - loss: 0.3327 - accuracy: 0.7452 - val_loss: 0.5222 - val_accuracy: 0.7904
Confusion matrix: 
 [[857  13]
 [215   3]]
Validation f1: 2.56
Validation accuracy: 79.04
Validation recall: 1.38
Validation precision: 18.75
Validation AUC: 0.2166095380724098
Validation class accuracies: [0.9850574712643678, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 14 epochs
Epoch 24/40
132/132 - 146s - loss: 0.3340 - accuracy: 0.7426 - val_loss: 0.5219 - val_accuracy: 0.7904
Confusion matrix: 
 [[857  13]
 [215   3]]
Validation f1: 2.56
Validation accuracy: 79.04
Validation recall: 1.38
Validation precision: 18.75
Validation AUC: 0.21532786150110472
Validation class accuracies: [0.9850574712643678, 0.013761467889908258]
Lr has been adjusted to 3.12499992105586e-06
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 15 epochs
Epoch 25/40
132/132 - 147s - loss: 0.3343 - accuracy: 0.7445 - val_loss: 0.5218 - val_accuracy: 0.7904
Confusion matrix: 
 [[857  13]
 [215   3]]
Validation f1: 2.56
Validation accuracy: 79.04
Validation recall: 1.38
Validation precision: 18.75
Validation AUC: 0.21510174227055925
Validation class accuracies: [0.9850574712643678, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 16 epochs
Epoch 26/40
132/132 - 146s - loss: 0.3334 - accuracy: 0.7417 - val_loss: 0.5222 - val_accuracy: 0.7904
Confusion matrix: 
 [[857  13]
 [215   3]]
Validation f1: 2.56
Validation accuracy: 79.04
Validation recall: 1.38
Validation precision: 18.75
Validation AUC: 0.2154856173941865
Validation class accuracies: [0.9850574712643678, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 17 epochs
Epoch 27/40
132/132 - 146s - loss: 0.3334 - accuracy: 0.7433 - val_loss: 0.5226 - val_accuracy: 0.7904
Confusion matrix: 
 [[857  13]
 [215   3]]
Validation f1: 2.56
Validation accuracy: 79.04
Validation recall: 1.38
Validation precision: 18.75
Validation AUC: 0.21593664076469524
Validation class accuracies: [0.9850574712643678, 0.013761467889908258]
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 18 epochs
Epoch 28/40
132/132 - 146s - loss: 0.3340 - accuracy: 0.7421 - val_loss: 0.5223 - val_accuracy: 0.7904
Confusion matrix: 
 [[857  13]
 [215   3]]
Validation f1: 2.56
Validation accuracy: 79.04
Validation recall: 1.38
Validation precision: 18.75
Validation AUC: 0.21544187217862498
Validation class accuracies: [0.9850574712643678, 0.013761467889908258]
The validation tracker metric at 0.047430830039525695 hasn't increased by 0.01 in 19 epochs
Epoch 29/40
132/132 - 146s - loss: 0.3329 - accuracy: 0.7421 - val_loss: 0.5224 - val_accuracy: 0.7904
Confusion matrix: 
 [[857  13]
 [215   3]]
Validation f1: 2.56
Validation accuracy: 79.04
Validation recall: 1.38
Validation precision: 18.75
Validation AUC: 0.2151518558569413
Validation class accuracies: [0.9850574712643678, 0.013761467889908258]

The metrics for the epoch with the best target metric are: 
Best cm: [[841  29]
 [212   6]]
Best f1: 0.047430830039525695
Best accuracy: 0.7784926470588235
Best recall: 0.027522935779816515
Best precision: 0.17142857142857143
Best AUC: 0.232054446560883
Best epoch: 9
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
The number of epochs since last 1% equals the patience

 See logs at ../../new_cache/conv__2117__05_0400__v29__mixednet_manualclassweights/logs/