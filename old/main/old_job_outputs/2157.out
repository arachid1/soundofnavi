Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2157
Description:  attempt_augm
2021-05-25 11:44:59.659634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:18: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-05-25 11:45:01.838628: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-25 11:45:01.839695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-25 11:45:01.869656: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:45:01.870317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-25 11:45:01.870347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-25 11:45:01.873691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-25 11:45:01.873776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-25 11:45:01.874816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-25 11:45:01.875130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-25 11:45:01.876095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-25 11:45:01.876979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-25 11:45:01.877134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-25 11:45:01.877244: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:45:01.877899: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:45:01.878436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
yoo: True
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2157.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2157__05_1139__v29__attempt_augm/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2157
wandb: â­ï¸ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: ðŸš€ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2kxcjv0x
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210525_114502-2kxcjv0x
wandb: Run `wandb offline` to turn off syncing.
2021-05-25 11:47:50.673624: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-25 11:47:50.673990: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:47:50.674669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-25 11:47:50.674726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-25 11:47:50.674810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-25 11:47:50.674836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-25 11:47:50.674861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-25 11:47:50.674885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-25 11:47:50.674919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-25 11:47:50.674948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-25 11:47:50.674972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-25 11:47:50.675081: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:47:50.675708: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:47:50.676268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-25 11:47:50.677499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-25 11:47:52.106275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-25 11:47:52.106322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-25 11:47:52.106331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-25 11:47:52.108686: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:47:52.109436: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:47:52.110013: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-25 11:47:52.110559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-25 11:47:53.309019: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-05-25 11:47:53.314887: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-25 11:47:53.873495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-25 11:47:57.814601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-25 11:47:58.960407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11

Original number of folders: 453
The parameters for augmentation N: 0 were: [0.1, 1, 0, 0, 0.75, (0, 1)]
Length of augmented samples is: 419 
With concat = False and six = False, size of training set: 4615...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/80
289/289 - 416s - loss: 0.6671 - accuracy: 0.6548 - val_loss: 0.5019 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1761054938301937
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
289/289 - 409s - loss: 0.5908 - accuracy: 0.7155 - val_loss: 0.5051 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21947459969678534
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
289/289 - 409s - loss: 0.5703 - accuracy: 0.7252 - val_loss: 0.5550 - val_accuracy: 0.7767
Confusion matrix: 
 [[828  42]
 [201  17]]
Validation f1: 12.27
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 77.67
Validation recall: 7.80
Validation precision: 28.81
Validation AUC: 0.23607592482684153
Validation class accuracies: [0.9517241379310345, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.12274368231046932
column_sums: [1029   59]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
289/289 - 409s - loss: 0.5663 - accuracy: 0.7248 - val_loss: 0.5793 - val_accuracy: 0.7353
Confusion matrix: 
 [[781  89]
 [199  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 11.66
Validation accuracy: 73.53
Validation recall: 8.72
Validation precision: 17.59
Validation AUC: 0.201144658263821
Validation class accuracies: [0.8977011494252873, 0.0871559633027523]
TARGET: 1
target metric(test f1): 0.1165644171779141
column_sums: [980 108]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
289/289 - 409s - loss: 0.5583 - accuracy: 0.7259 - val_loss: 0.8508 - val_accuracy: 0.6627
Confusion matrix: 
 [[648 222]
 [145  73]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.46
Validation accuracy: 66.27
Validation recall: 33.49
Validation precision: 24.75
Validation AUC: 0.23367515199339184
Validation class accuracies: [0.7448275862068966, 0.3348623853211009]
TARGET: 1
target metric(test f1): 0.2846003898635478
column_sums: [793 295]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 6/80
289/289 - 409s - loss: 0.5435 - accuracy: 0.7393 - val_loss: 0.5514 - val_accuracy: 0.7298
Confusion matrix: 
 [[782  88]
 [206  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 7.55
Validation accuracy: 72.98
Validation recall: 5.50
Validation precision: 12.00
Validation AUC: 0.21426696053350225
Validation class accuracies: [0.8988505747126436, 0.05504587155963303]
TARGET: 1
target metric(test f1): 0.07547169811320754
column_sums: [988 100]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
289/289 - 409s - loss: 0.5279 - accuracy: 0.7447 - val_loss: 0.5370 - val_accuracy: 0.7858
Confusion matrix: 
 [[847  23]
 [210   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 6.43
Validation accuracy: 78.58
Validation recall: 3.67
Validation precision: 25.81
Validation AUC: 0.21573427732912953
Validation class accuracies: [0.9735632183908046, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.06425702811244981
column_sums: [1057   31]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
289/289 - 409s - loss: 0.5113 - accuracy: 0.7549 - val_loss: 1.6189 - val_accuracy: 0.4540
Confusion matrix: 
 [[337 533]
 [ 61 157]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.58
Validation accuracy: 45.40
Validation recall: 72.02
Validation precision: 22.75
Validation AUC: 0.23288218613887995
Validation class accuracies: [0.3873563218390805, 0.7201834862385321]
TARGET: 1
target metric(test f1): 0.3458149779735683
column_sums: [398 690]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 9/80
289/289 - 409s - loss: 0.4972 - accuracy: 0.7623 - val_loss: 0.6901 - val_accuracy: 0.6452
Confusion matrix: 
 [[642 228]
 [158  60]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 23.72
Validation accuracy: 64.52
Validation recall: 27.52
Validation precision: 20.83
Validation AUC: 0.2153938379546193
Validation class accuracies: [0.7379310344827587, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.23715415019762845
column_sums: [800 288]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 1 epochs
Epoch 10/80
289/289 - 409s - loss: 0.4589 - accuracy: 0.7920 - val_loss: 0.9654 - val_accuracy: 0.6443
Confusion matrix: 
 [[632 238]
 [149  69]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.29
Validation accuracy: 64.43
Validation recall: 31.65
Validation precision: 22.48
Validation AUC: 0.21989451886454803
Validation class accuracies: [0.7264367816091954, 0.3165137614678899]
TARGET: 1
target metric(test f1): 0.26285714285714284
column_sums: [781 307]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 2 epochs
Epoch 11/80
289/289 - 409s - loss: 0.4334 - accuracy: 0.8004 - val_loss: 0.8330 - val_accuracy: 0.6765
Confusion matrix: 
 [[673 197]
 [155  63]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.36
Validation accuracy: 67.65
Validation recall: 28.90
Validation precision: 24.23
Validation AUC: 0.22052301888173317
Validation class accuracies: [0.7735632183908046, 0.2889908256880734]
TARGET: 1
target metric(test f1): 0.26359832635983266
column_sums: [828 260]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 3 epochs
Epoch 12/80
289/289 - 409s - loss: 0.4139 - accuracy: 0.8117 - val_loss: 0.6982 - val_accuracy: 0.7132
Confusion matrix: 
 [[725 145]
 [167  51]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.64
Validation accuracy: 71.32
Validation recall: 23.39
Validation precision: 26.02
Validation AUC: 0.23642683590915806
Validation class accuracies: [0.8333333333333334, 0.23394495412844038]
TARGET: 1
target metric(test f1): 0.24637681159420288
column_sums: [892 196]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 4 epochs
Epoch 13/80
289/289 - 409s - loss: 0.3301 - accuracy: 0.8626 - val_loss: 0.7777 - val_accuracy: 0.6820
Confusion matrix: 
 [[692 178]
 [168  50]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.42
Validation accuracy: 68.20
Validation recall: 22.94
Validation precision: 21.93
Validation AUC: 0.2139131280831026
Validation class accuracies: [0.7954022988505747, 0.22935779816513763]
TARGET: 1
target metric(test f1): 0.2242152466367713
column_sums: [860 228]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 5 epochs
Epoch 14/80
289/289 - 409s - loss: 0.3024 - accuracy: 0.8745 - val_loss: 1.1276 - val_accuracy: 0.5588
Confusion matrix: 
 [[518 352]
 [128  90]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.27
Validation accuracy: 55.88
Validation recall: 41.28
Validation precision: 20.36
Validation AUC: 0.20293420120485958
Validation class accuracies: [0.5954022988505747, 0.41284403669724773]
TARGET: 1
target metric(test f1): 0.27272727272727276
column_sums: [646 442]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 6 epochs
Epoch 15/80
289/289 - 409s - loss: 0.2784 - accuracy: 0.8854 - val_loss: 1.0484 - val_accuracy: 0.6121
Confusion matrix: 
 [[582 288]
 [134  84]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.47
Validation accuracy: 61.21
Validation recall: 38.53
Validation precision: 22.58
Validation AUC: 0.2122783293317716
Validation class accuracies: [0.6689655172413793, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.2847457627118644
column_sums: [716 372]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 7 epochs
Epoch 16/80
289/289 - 409s - loss: 0.2796 - accuracy: 0.8852 - val_loss: 1.1024 - val_accuracy: 0.5892
Confusion matrix: 
 [[560 310]
 [137  81]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.60
Validation accuracy: 58.92
Validation recall: 37.16
Validation precision: 20.72
Validation AUC: 0.20215659137603664
Validation class accuracies: [0.6436781609195402, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.2660098522167488
column_sums: [697 391]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.24999984211172e-06
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 8 epochs
Epoch 17/80
289/289 - 409s - loss: 0.2515 - accuracy: 0.9008 - val_loss: 0.9864 - val_accuracy: 0.6057
Confusion matrix: 
 [[589 281]
 [148  70]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 24.60
Validation accuracy: 60.57
Validation recall: 32.11
Validation precision: 19.94
Validation AUC: 0.1992044424389141
Validation class accuracies: [0.6770114942528735, 0.3211009174311927]
TARGET: 1
target metric(test f1): 0.2460456942003515
column_sums: [737 351]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 9 epochs
Epoch 18/80
289/289 - 409s - loss: 0.2420 - accuracy: 0.9053 - val_loss: 1.0000 - val_accuracy: 0.6020
Confusion matrix: 
 [[587 283]
 [150  68]]
Validation f1: 23.90
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 60.20
Validation recall: 31.19
Validation precision: 19.37
Validation AUC: 0.19551223863573436
Validation class accuracies: [0.674712643678161, 0.3119266055045872]
TARGET: 1
target metric(test f1): 0.23901581722319856
column_sums: [737 351]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 10 epochs
Epoch 19/80
289/289 - 409s - loss: 0.2393 - accuracy: 0.9036 - val_loss: 1.0946 - val_accuracy: 0.5689
Confusion matrix: 
 [[535 335]
 [134  84]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.37
Validation accuracy: 56.89
Validation recall: 38.53
Validation precision: 20.05
Validation AUC: 0.20369808367260406
Validation class accuracies: [0.6149425287356322, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.2637362637362637
column_sums: [669 419]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 11 epochs
Epoch 20/80
289/289 - 409s - loss: 0.2430 - accuracy: 0.9051 - val_loss: 1.1088 - val_accuracy: 0.5588
Confusion matrix: 
 [[528 342]
 [138  80]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.00
Validation accuracy: 55.88
Validation recall: 36.70
Validation precision: 18.96
Validation AUC: 0.1938550227266072
Validation class accuracies: [0.6068965517241379, 0.3669724770642202]
TARGET: 1
target metric(test f1): 0.25
column_sums: [666 422]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.56249996052793e-06
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 12 epochs
Epoch 21/80
289/289 - 409s - loss: 0.2332 - accuracy: 0.9042 - val_loss: 1.1464 - val_accuracy: 0.5506
Confusion matrix: 
 [[512 358]
 [131  87]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.24
Validation accuracy: 55.06
Validation recall: 39.91
Validation precision: 19.55
Validation AUC: 0.19582013810901971
Validation class accuracies: [0.5885057471264368, 0.39908256880733944]
TARGET: 1
target metric(test f1): 0.26244343891402716
column_sums: [643 445]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 13 epochs
Epoch 22/80
289/289 - 409s - loss: 0.2289 - accuracy: 0.9148 - val_loss: 1.1404 - val_accuracy: 0.5561
Confusion matrix: 
 [[518 352]
 [131  87]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.48
Validation accuracy: 55.61
Validation recall: 39.91
Validation precision: 19.82
Validation AUC: 0.198137239780021
Validation class accuracies: [0.5954022988505747, 0.39908256880733944]
TARGET: 1
target metric(test f1): 0.2648401826484018
column_sums: [649 439]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 14 epochs
Epoch 23/80
289/289 - 409s - loss: 0.2443 - accuracy: 0.9038 - val_loss: 1.1417 - val_accuracy: 0.5542
Confusion matrix: 
 [[517 353]
 [132  86]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.18
Validation accuracy: 55.42
Validation recall: 39.45
Validation precision: 19.59
Validation AUC: 0.19711383078292266
Validation class accuracies: [0.5942528735632184, 0.3944954128440367]
TARGET: 1
target metric(test f1): 0.26179604261796047
column_sums: [649 439]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 15 epochs
Epoch 24/80
289/289 - 409s - loss: 0.2267 - accuracy: 0.9155 - val_loss: 1.1642 - val_accuracy: 0.5487
Confusion matrix: 
 [[511 359]
 [132  86]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.94
Validation accuracy: 54.87
Validation recall: 39.45
Validation precision: 19.33
Validation AUC: 0.20132069757957533
Validation class accuracies: [0.5873563218390805, 0.3944954128440367]
TARGET: 1
target metric(test f1): 0.2594268476621418
column_sums: [643 445]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906249901319825e-07
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 16 epochs
Epoch 25/80
289/289 - 409s - loss: 0.2268 - accuracy: 0.9159 - val_loss: 1.1397 - val_accuracy: 0.5561
Confusion matrix: 
 [[521 349]
 [134  84]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.81
Validation accuracy: 55.61
Validation recall: 38.53
Validation precision: 19.40
Validation AUC: 0.1976034857924624
Validation class accuracies: [0.5988505747126437, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.25806451612903225
column_sums: [655 433]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 17 epochs
Epoch 26/80
289/289 - 409s - loss: 0.2351 - accuracy: 0.9036 - val_loss: 1.1815 - val_accuracy: 0.5368
Confusion matrix: 
 [[495 375]
 [129  89]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.10
Validation accuracy: 53.68
Validation recall: 40.83
Validation precision: 19.18
Validation AUC: 0.20010983944220082
Validation class accuracies: [0.5689655172413793, 0.40825688073394495]
TARGET: 1
target metric(test f1): 0.2609970674486804
column_sums: [624 464]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 18 epochs
Epoch 27/80
289/289 - 409s - loss: 0.2315 - accuracy: 0.9079 - val_loss: 1.1530 - val_accuracy: 0.5515
Confusion matrix: 
 [[514 356]
 [132  86]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.06
Validation accuracy: 55.15
Validation recall: 39.45
Validation precision: 19.46
Validation AUC: 0.20074454391792845
Validation class accuracies: [0.5908045977011495, 0.3944954128440367]
TARGET: 1
target metric(test f1): 0.2606060606060606
column_sums: [646 442]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 19 epochs
Epoch 28/80
289/289 - 409s - loss: 0.2353 - accuracy: 0.9060 - val_loss: 1.1476 - val_accuracy: 0.5506
Confusion matrix: 
 [[514 356]
 [133  85]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.80
Validation accuracy: 55.06
Validation recall: 38.99
Validation precision: 19.27
Validation AUC: 0.20027157839702814
Validation class accuracies: [0.5908045977011495, 0.38990825688073394]
TARGET: 1
target metric(test f1): 0.25796661608497723
column_sums: [647 441]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765624753299562e-08
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 20 epochs
Epoch 29/80
289/289 - 409s - loss: 0.2255 - accuracy: 0.9118 - val_loss: 1.1717 - val_accuracy: 0.5441
Confusion matrix: 
 [[504 366]
 [130  88]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.19
Validation accuracy: 54.41
Validation recall: 40.37
Validation precision: 19.38
Validation AUC: 0.19768547375276366
Validation class accuracies: [0.5793103448275863, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.2619047619047619
column_sums: [634 454]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 21 epochs
Epoch 30/80
289/289 - 409s - loss: 0.2329 - accuracy: 0.9094 - val_loss: 1.1400 - val_accuracy: 0.5588
Confusion matrix: 
 [[524 346]
 [134  84]]
Validation f1: 25.93
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 55.88
Validation recall: 38.53
Validation precision: 19.53
Validation AUC: 0.1978282438930497
Validation class accuracies: [0.6022988505747127, 0.3853211009174312]
TARGET: 1
target metric(test f1): 0.25925925925925924
column_sums: [658 430]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 22 epochs
Epoch 31/80
289/289 - 409s - loss: 0.2274 - accuracy: 0.9109 - val_loss: 1.1562 - val_accuracy: 0.5506
Confusion matrix: 
 [[514 356]
 [133  85]]
Validation f1: 25.80
Validation accuracy: 55.06
Validation recall: 38.99
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation precision: 19.27
Validation AUC: 0.20003792579962465
Validation class accuracies: [0.5908045977011495, 0.38990825688073394]
TARGET: 1
target metric(test f1): 0.25796661608497723
column_sums: [647 441]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 23 epochs
Epoch 32/80
289/289 - 409s - loss: 0.2327 - accuracy: 0.9086 - val_loss: 1.1325 - val_accuracy: 0.5607
Confusion matrix: 
 [[527 343]
 [135  83]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.78
Validation accuracy: 56.07
Validation recall: 38.07
Validation precision: 19.48
Validation AUC: 0.19763728314631143
Validation class accuracies: [0.6057471264367816, 0.38073394495412843]
TARGET: 1
target metric(test f1): 0.25776397515527955
column_sums: [662 426]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414061883248905e-08
The validation tracker metric at 0.3458149779735683 hasn't increased by 0 in 24 epochs
Epoch 33/80
289/289 - 409s - loss: 0.2321 - accuracy: 0.9168 - val_loss: 1.1424 - val_accuracy: 0.5533
Confusion matrix: 
 [[518 352]
 [134  84]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.69
Validation accuracy: 55.33
Validation recall: 38.53
Validation precision: 19.27
Validation AUC: 0.1999740868190001
Validation class accuracies: [0.5954022988505747, 0.3853211009174312]

The metrics for the epoch with the best target metric are: 
Best cm: [[337 533]
 [ 61 157]]
Best f1: 0.3458149779735683
Best accuracy: 0.4540441176470588
Best recall: 0.7201834862385321
Best precision: 0.22753623188405797
Best AUC: 0.23288218613887995
Best epoch: 8
TARGET: 1
target metric(test f1): 0.25688073394495414
column_sums: [652 436]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: epoch5 & threshold: 1
Starting...
CM: [[14 46]
 [ 1 14]]
F1: 0.37333333333333335
AUC: 0.5900000000000001
Accuracy: 0.37333333333333335
Precision: 0.23333333333333334
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch5.xls...
Done.
Epoch: epoch5 & threshold: 2
Starting...
CM: [[35 25]
 [ 6  9]]
F1: 0.36734693877551017
AUC: 0.4723529411764706
Accuracy: 0.5866666666666667
Precision: 0.2647058823529412
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch5.xls...
Done.
Epoch: epoch5 & threshold: 3
Starting...
CM: [[44 16]
 [10  5]]
F1: 0.2777777777777778
AUC: 0.35238095238095235
Accuracy: 0.6533333333333333
Precision: 0.23809523809523808
Recall: 0.3333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch5.xls...
Done.
Epoch: epoch8 & threshold: 1
Starting...
CM: [[ 2 58]
 [ 0 15]]
F1: 0.3409090909090909
AUC: 0.6027397260273972
Accuracy: 0.22666666666666666
Precision: 0.2054794520547945
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch8.xls...
Done.
Epoch: epoch8 & threshold: 2
Starting...
CM: [[ 7 53]
 [ 0 15]]
F1: 0.36144578313253006
AUC: 0.6102941176470589
Accuracy: 0.29333333333333333
Precision: 0.22058823529411764
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch8.xls...
Done.
Epoch: epoch8 & threshold: 3
Starting...
CM: [[14 46]
 [ 1 14]]
F1: 0.37333333333333335
AUC: 0.5900000000000001
Accuracy: 0.37333333333333335
Precision: 0.23333333333333334
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch8.xls...
Done.
Epoch: epoch80 & threshold: 1
Starting...
CM: [[ 3 57]
 [ 0 15]]
F1: 0.3448275862068966
AUC: 0.6041666666666666
Accuracy: 0.24
Precision: 0.20833333333333334
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch80.xls...
Done.
Epoch: epoch80 & threshold: 2
Starting...
CM: [[17 43]
 [ 3 12]]
F1: 0.34285714285714286
AUC: 0.5290909090909091
Accuracy: 0.38666666666666666
Precision: 0.21818181818181817
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch80.xls...
Done.
Epoch: epoch80 & threshold: 3
Starting...
CM: [[32 28]
 [ 7  8]]
F1: 0.3137254901960784
AUC: 0.42444444444444446
Accuracy: 0.5333333333333333
Precision: 0.2222222222222222
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2157__05_1139__v29__attempt_augm/0/validation_sheet_epochepoch80.xls...
Done.
The parameters for augmentation N: 1 were: [0.1, 0, 1, 0, 0.75, (0, 1)]
Length of augmented samples is: 423 
With concat = False and six = False, size of training set: 4653...
...and size of validation set: 1054
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_11 (InputLayer)           [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization_60 (BatchNo (None, 128, 1250, 3) 12          input_11[0][0]                   
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 128, 1250, 16 64          batch_normalization_60[0][0]     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 128, 1250, 16 64          batch_normalization_60[0][0]     
__________________________________________________________________________________________________
max_pooling2d_10 (MaxPooling2D) (None, 128, 1250, 3) 0           batch_normalization_60[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 128, 1250, 16 2320        conv2d_50[0][0]                  
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 128, 1250, 16 6416        conv2d_52[0][0]                  
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 128, 1250, 16 64          max_pooling2d_10[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 128, 1250, 48 0           conv2d_51[0][0]                  
                                                                 conv2d_53[0][0]                  
                                                                 conv2d_54[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_50 (AveragePo (None, 64, 625, 48)  0           concatenate_10[0][0]             
__________________________________________________________________________________________________
batch_normalization_61 (BatchNo (None, 64, 625, 48)  192         average_pooling2d_50[0][0]       
__________________________________________________________________________________________________
dropout_50 (Dropout)            (None, 64, 625, 48)  0           batch_normalization_61[0][0]     
__________________________________________________________________________________________________
inverted_residual_100 (Inverted (None, 64, 625, 32)  35840       dropout_50[0][0]                 
__________________________________________________________________________________________________
inverted_residual_101 (Inverted (None, 64, 625, 32)  20864       inverted_residual_100[0][0]      
__________________________________________________________________________________________________
average_pooling2d_51 (AveragePo (None, 32, 312, 32)  0           inverted_residual_101[0][0]      
__________________________________________________________________________________________________
batch_normalization_62 (BatchNo (None, 32, 312, 32)  128         average_pooling2d_51[0][0]       
__________________________________________________________________________________________________
dropout_51 (Dropout)            (None, 32, 312, 32)  0           batch_normalization_62[0][0]     
__________________________________________________________________________________________________
inverted_residual_102 (Inverted (None, 32, 312, 64)  27136       dropout_51[0][0]                 
__________________________________________________________________________________________________
inverted_residual_103 (Inverted (None, 32, 312, 64)  66304       inverted_residual_102[0][0]      
__________________________________________________________________________________________________
average_pooling2d_52 (AveragePo (None, 16, 156, 64)  0           inverted_residual_103[0][0]      
__________________________________________________________________________________________________
batch_normalization_63 (BatchNo (None, 16, 156, 64)  256         average_pooling2d_52[0][0]       
__________________________________________________________________________________________________
dropout_52 (Dropout)            (None, 16, 156, 64)  0           batch_normalization_63[0][0]     
__________________________________________________________________________________________________
inverted_residual_104 (Inverted (None, 16, 156, 128) 91136       dropout_52[0][0]                 
__________________________________________________________________________________________________
inverted_residual_105 (Inverted (None, 16, 156, 128) 230912      inverted_residual_104[0][0]      
__________________________________________________________________________________________________
average_pooling2d_53 (AveragePo (None, 8, 78, 128)   0           inverted_residual_105[0][0]      
__________________________________________________________________________________________________
batch_normalization_64 (BatchNo (None, 8, 78, 128)   512         average_pooling2d_53[0][0]       
__________________________________________________________________________________________________
dropout_53 (Dropout)            (None, 8, 78, 128)   0           batch_normalization_64[0][0]     
__________________________________________________________________________________________________
inverted_residual_106 (Inverted (None, 8, 78, 256)   329728      dropout_53[0][0]                 
__________________________________________________________________________________________________
inverted_residual_107 (Inverted (None, 8, 78, 256)   855040      inverted_residual_106[0][0]      
__________________________________________________________________________________________________
average_pooling2d_54 (AveragePo (None, 4, 39, 256)   0           inverted_residual_107[0][0]      
__________________________________________________________________________________________________
batch_normalization_65 (BatchNo (None, 4, 39, 256)   1024        average_pooling2d_54[0][0]       
__________________________________________________________________________________________________
dropout_54 (Dropout)            (None, 4, 39, 256)   0           batch_normalization_65[0][0]     
__________________________________________________________________________________________________
inverted_residual_108 (Inverted (None, 4, 39, 512)   1249280     dropout_54[0][0]                 
__________________________________________________________________________________________________
inverted_residual_109 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_108[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_10 (Gl (None, 512)          0           inverted_residual_109[0][0]      
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 1)            513         global_average_pooling2d_10[0][0]
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/80
291/291 - 416s - loss: 0.6400 - accuracy: 0.6879 - val_loss: 0.6252 - val_accuracy: 0.6850
Confusion matrix: 
 [[722   0]
 [332   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 68.50
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31161512580662987
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1054    0]
cm_sum: 1054
The training is defaulting to either class.
Epoch 2/80
291/291 - 414s - loss: 0.5551 - accuracy: 0.7462 - val_loss: 0.6793 - val_accuracy: 0.6850
Confusion matrix: 
 [[722   0]
 [332   0]]
Validation f1: 0.00
Validation accuracy: 68.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.34627988337139803
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1054    0]
cm_sum: 1054
The training is defaulting to either class.
Epoch 3/80
291/291 - 412s - loss: 0.5374 - accuracy: 0.7541 - val_loss: 0.6801 - val_accuracy: 0.6528
Confusion matrix: 
 [[644  78]
 [288  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 19.38
Validation accuracy: 65.28
Validation recall: 13.25
Validation precision: 36.07
Validation AUC: 0.362314356237553
Validation class accuracies: [0.8919667590027701, 0.13253012048192772]
TARGET: 1
target metric(test f1): 0.1938325991189427
column_sums: [932 122]
cm_sum: 1054
inside not defaulting
Saving model...
Epoch 4/80
291/291 - 413s - loss: 0.5325 - accuracy: 0.7533 - val_loss: 0.6417 - val_accuracy: 0.6660
Confusion matrix: 
 [[633  89]
 [263  69]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.16
Validation accuracy: 66.60
Validation recall: 20.78
Validation precision: 43.67
Validation AUC: 0.3940438263128531
Validation class accuracies: [0.8767313019390581, 0.20783132530120482]
TARGET: 1
target metric(test f1): 0.2816326530612245
column_sums: [896 158]
cm_sum: 1054
inside not defaulting
Saving model...
Epoch 5/80
291/291 - 413s - loss: 0.5199 - accuracy: 0.7539 - val_loss: 0.6844 - val_accuracy: 0.6338
Confusion matrix: 
 [[559 163]
 [223 109]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.09
Validation accuracy: 63.38
Validation recall: 32.83
Validation precision: 40.07
Validation AUC: 0.37219359631147486
Validation class accuracies: [0.7742382271468145, 0.32831325301204817]
TARGET: 1
target metric(test f1): 0.36092715231788075
column_sums: [782 272]
cm_sum: 1054
inside not defaulting
Saving model...
Epoch 6/80
291/291 - 413s - loss: 0.5035 - accuracy: 0.7655 - val_loss: 0.8755 - val_accuracy: 0.5911
Confusion matrix: 
 [[434 288]
 [143 189]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 46.72
Validation accuracy: 59.11
Validation recall: 56.93
Validation precision: 39.62
Validation AUC: 0.37850530573474594
Validation class accuracies: [0.6011080332409973, 0.5692771084337349]
TARGET: 1
target metric(test f1): 0.4672435105067985
column_sums: [577 477]
cm_sum: 1054
inside not defaulting
Saving model...
Epoch 7/80
291/291 - 413s - loss: 0.4896 - accuracy: 0.7724 - val_loss: 0.9304 - val_accuracy: 0.5873
Confusion matrix: 
 [[441 281]
 [154 178]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.01
Validation accuracy: 58.73
Validation recall: 53.61
Validation precision: 38.78
Validation AUC: 0.365473079800208
Validation class accuracies: [0.610803324099723, 0.536144578313253]
TARGET: 1
target metric(test f1): 0.450063211125158
column_sums: [595 459]
cm_sum: 1054
inside not defaulting
The validation tracker metric at 0.4672435105067985 hasn't increased by 0 in 1 epochs
Epoch 8/80
291/291 - 413s - loss: 0.4649 - accuracy: 0.7883 - val_loss: 0.8743 - val_accuracy: 0.6480
Confusion matrix: 
 [[646  76]
 [295  37]]
Validation f1: 16.63
Validation accuracy: 64.80
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 11.14
Validation precision: 32.74
Validation AUC: 0.3442132532623339
Validation class accuracies: [0.8947368421052632, 0.11144578313253012]
TARGET: 1
target metric(test f1): 0.1662921348314607
column_sums: [941 113]
cm_sum: 1054
inside not defaulting
The validation tracker metric at 0.4672435105067985 hasn't increased by 0 in 2 epochs
Epoch 9/80
291/291 - 413s - loss: 0.4386 - accuracy: 0.8003 - val_loss: 1.1532 - val_accuracy: 0.4801
Confusion matrix: 
 [[320 402]
 [146 186]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.43
Validation accuracy: 48.01
Validation recall: 56.02
Validation precision: 31.63
Validation AUC: 0.3280551071940475
Validation class accuracies: [0.44321329639889195, 0.5602409638554217]
TARGET: 1
target metric(test f1): 0.4043478260869565
column_sums: [466 588]
cm_sum: 1054
inside not defaulting
The validation tracker metric at 0.4672435105067985 hasn't increased by 0 in 3 epochs
Epoch 10/80
291/291 - 413s - loss: 0.4147 - accuracy: 0.8154 - val_loss: 0.9664 - val_accuracy: 0.6224
Confusion matrix: 
 [[548 174]
 [224 108]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.18
Validation accuracy: 62.24
Validation recall: 32.53
Validation precision: 38.30
Validation AUC: 0.33961242171530526
Validation class accuracies: [0.7590027700831025, 0.3253012048192771]
TARGET: 1
target metric(test f1): 0.35179153094462545
column_sums: [772 282]
cm_sum: 1054
inside not defaulting
Lr has been adjusted to 2.499999936844688e-05
The validation tracker metric at 0.4672435105067985 hasn't increased by 0 in 4 epochs
Epoch 11/80
291/291 - 412s - loss: 0.3419 - accuracy: 0.8554 - val_loss: 1.0625 - val_accuracy: 0.6224
Confusion matrix: 
 [[533 189]
 [209 123]]
Validation f1: 38.20
Validation accuracy: 62.24
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation recall: 37.05
Validation precision: 39.42
Validation AUC: 0.34365400497389986
Validation class accuracies: [0.7382271468144044, 0.3704819277108434]
TARGET: 1
target metric(test f1): 0.3819875776397515
column_sums: [742 312]
cm_sum: 1054
inside not defaulting
The validation tracker metric at 0.4672435105067985 hasn't increased by 0 in 5 epochs
Epoch 12/80
291/291 - 413s - loss: 0.3261 - accuracy: 0.8616 - val_loss: 1.1243 - val_accuracy: 0.5816
Confusion matrix: 
 [[475 247]
 [194 138]]
Validation f1: 38.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 58.16
Validation recall: 41.57
Validation precision: 35.84
Validation AUC: 0.34702015372006306
Validation class accuracies: [0.6578947368421053, 0.41566265060240964]
local_gc_exec.sh: line 6:  7924 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --augm-params "$AUGM_PARAMS"

 See logs at ../../new_cache/conv__2157__05_1139__v29__attempt_augm/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
