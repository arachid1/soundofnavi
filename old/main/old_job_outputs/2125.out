Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2125
Description:  model9_newparams
2021-05-11 04:03:13.868621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 04:03:16.538288: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 04:03:16.539349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-11 04:03:16.590134: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:16.590903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 04:03:16.590935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 04:03:16.594684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 04:03:16.594785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 04:03:16.595951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 04:03:16.596277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 04:03:16.597366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 04:03:16.598345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 04:03:16.598512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 04:03:16.598655: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:16.599448: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:16.600157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2125.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2125__05_0402__v29__model9_newparams/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 3.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2125
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/213wpf5l
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_040316-213wpf5l
wandb: Run `wandb offline` to turn off syncing.
2021-05-11 04:03:22.606282: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 04:03:22.606554: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:22.607395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 04:03:22.607452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 04:03:22.607523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 04:03:22.607560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 04:03:22.607594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 04:03:22.607647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 04:03:22.607689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 04:03:22.607721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 04:03:22.607751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 04:03:22.607875: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:22.608719: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:22.609463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-11 04:03:22.609523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 04:03:23.400326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-11 04:03:23.400390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-11 04:03:23.400400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-11 04:03:23.400690: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:23.401505: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:23.402320: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:03:23.403069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-11 04:04:06.265389: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-11 04:04:06.267417: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-11 04:04:10.176634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 04:04:11.009853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 04:04:11.021465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
263/263 - 524s - loss: 0.7232 - accuracy: 0.5465 - val_loss: 0.6372 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24801040980980602
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.24801040980980602
Epoch 2/40
263/263 - 515s - loss: 0.6864 - accuracy: 0.5822 - val_loss: 0.6325 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21414829734654556
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.21414829734654556
Epoch 3/40
263/263 - 515s - loss: 0.6814 - accuracy: 0.6053 - val_loss: 0.6534 - val_accuracy: 0.7831
Confusion matrix: 
 [[843  27]
 [209   9]]
Validation f1: 7.09
Validation accuracy: 78.31
Validation recall: 4.13
Validation precision: 25.00
Validation AUC: 0.2074828841477462
Validation class accuracies: [0.9689655172413794, 0.04128440366972477]
TARGET: 0
target metric(test auc): 0.2074828841477462
Epoch 4/40
263/263 - 515s - loss: 0.6764 - accuracy: 0.6115 - val_loss: 0.6649 - val_accuracy: 0.7344
Confusion matrix: 
 [[776  94]
 [195  23]]
Validation f1: 13.73
Validation accuracy: 73.44
Validation recall: 10.55
Validation precision: 19.66
Validation AUC: 0.21404547271428892
Validation class accuracies: [0.8919540229885058, 0.10550458715596331]
TARGET: 0
target metric(test auc): 0.21404547271428892
Epoch 5/40
263/263 - 514s - loss: 0.6702 - accuracy: 0.6311 - val_loss: 0.7100 - val_accuracy: 0.6654
Confusion matrix: 
 [[663 207]
 [157  61]]
Validation f1: 25.10
Validation accuracy: 66.54
Validation recall: 27.98
Validation precision: 22.76
Validation AUC: 0.23234868966372346
Validation class accuracies: [0.7620689655172413, 0.2798165137614679]
TARGET: 0
target metric(test auc): 0.23234868966372346
Saving model...
Epoch 6/40
263/263 - 515s - loss: 0.6685 - accuracy: 0.6416 - val_loss: 0.6956 - val_accuracy: 0.5303
Confusion matrix: 
 [[489 381]
 [130  88]]
Validation f1: 25.62
Validation accuracy: 53.03
Validation recall: 40.37
Validation precision: 18.76
Validation AUC: 0.1911536419377578
Validation class accuracies: [0.5620689655172414, 0.4036697247706422]
TARGET: 0
target metric(test auc): 0.1911536419377578
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 1 epochs
Epoch 7/40
263/263 - 514s - loss: 0.6644 - accuracy: 0.6530 - val_loss: 0.6453 - val_accuracy: 0.7619
Confusion matrix: 
 [[821  49]
 [210   8]]
Validation f1: 5.82
Validation accuracy: 76.19
Validation recall: 3.67
Validation precision: 14.04
Validation AUC: 0.20714724776362534
Validation class accuracies: [0.9436781609195403, 0.03669724770642202]
TARGET: 0
target metric(test auc): 0.20714724776362534
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 2 epochs
Epoch 8/40
263/263 - 513s - loss: 0.6598 - accuracy: 0.6628 - val_loss: 0.7062 - val_accuracy: 0.5322
Confusion matrix: 
 [[501 369]
 [140  78]]
Validation f1: 23.46
Validation accuracy: 53.22
Validation recall: 35.78
Validation precision: 17.45
Validation AUC: 0.1847192159704396
Validation class accuracies: [0.5758620689655173, 0.3577981651376147]
TARGET: 0
target metric(test auc): 0.1847192159704396
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 3 epochs
Epoch 9/40
263/263 - 512s - loss: 0.6520 - accuracy: 0.6914 - val_loss: 0.7018 - val_accuracy: 0.6057
Confusion matrix: 
 [[583 287]
 [142  76]]
Validation f1: 26.16
Validation accuracy: 60.57
Validation recall: 34.86
Validation precision: 20.94
Validation AUC: 0.22108255596830412
Validation class accuracies: [0.6701149425287356, 0.3486238532110092]
TARGET: 0
target metric(test auc): 0.22108255596830412
Lr has been adjusted to 7.499999628635123e-05
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 4 epochs
Epoch 10/40
263/263 - 514s - loss: 0.6407 - accuracy: 0.7073 - val_loss: 0.6844 - val_accuracy: 0.6369
Confusion matrix: 
 [[635 235]
 [160  58]]
Validation f1: 22.70
Validation accuracy: 63.69
Validation recall: 26.61
Validation precision: 19.80
Validation AUC: 0.21979457230607347
Validation class accuracies: [0.7298850574712644, 0.26605504587155965]
TARGET: 0
target metric(test auc): 0.21979457230607347
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 5 epochs
Epoch 11/40
263/263 - 514s - loss: 0.6302 - accuracy: 0.7355 - val_loss: 0.8325 - val_accuracy: 0.3833
Confusion matrix: 
 [[253 617]
 [ 54 164]]
Validation f1: 32.83
Validation accuracy: 38.33
Validation recall: 75.23
Validation precision: 21.00
Validation AUC: 0.21103501667440835
Validation class accuracies: [0.2908045977011494, 0.7522935779816514]
TARGET: 0
target metric(test auc): 0.21103501667440835
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 6 epochs
Epoch 12/40
263/263 - 512s - loss: 0.6225 - accuracy: 0.7588 - val_loss: 0.6694 - val_accuracy: 0.7224
Confusion matrix: 
 [[758 112]
 [190  28]]
Validation f1: 15.64
Validation accuracy: 72.24
Validation recall: 12.84
Validation precision: 20.00
Validation AUC: 0.21073070336323702
Validation class accuracies: [0.871264367816092, 0.12844036697247707]
TARGET: 0
target metric(test auc): 0.21073070336323702
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 7 epochs
Epoch 13/40
263/263 - 513s - loss: 0.6146 - accuracy: 0.7774 - val_loss: 0.6843 - val_accuracy: 0.6866
Confusion matrix: 
 [[702 168]
 [173  45]]
Validation f1: 20.88
Validation accuracy: 68.66
Validation recall: 20.64
Validation precision: 21.13
Validation AUC: 0.20696471973050687
Validation class accuracies: [0.8068965517241379, 0.20642201834862386]
TARGET: 0
target metric(test auc): 0.20696471973050687
Lr has been adjusted to 5.624999903375283e-05
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 8 epochs
Epoch 14/40
263/263 - 515s - loss: 0.6023 - accuracy: 0.7989 - val_loss: 0.7096 - val_accuracy: 0.6222
Confusion matrix: 
 [[622 248]
 [163  55]]
Validation f1: 21.11
Validation accuracy: 62.22
Validation recall: 25.23
Validation precision: 18.15
Validation AUC: 0.18835589880819448
Validation class accuracies: [0.7149425287356321, 0.25229357798165136]
TARGET: 0
target metric(test auc): 0.18835589880819448
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 9 epochs
Epoch 15/40
263/263 - 513s - loss: 0.5909 - accuracy: 0.8258 - val_loss: 0.7345 - val_accuracy: 0.7776
Confusion matrix: 
 [[842  28]
 [214   4]]
Validation f1: 3.20
Validation accuracy: 77.76
Validation recall: 1.83
Validation precision: 12.50
Validation AUC: 0.19662403643988252
Validation class accuracies: [0.967816091954023, 0.01834862385321101]
TARGET: 0
target metric(test auc): 0.19662403643988252
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 10 epochs
Epoch 16/40
263/263 - 514s - loss: 0.5864 - accuracy: 0.8463 - val_loss: 0.6974 - val_accuracy: 0.7629
Confusion matrix: 
 [[821  49]
 [209   9]]
Validation f1: 6.52
Validation accuracy: 76.29
Validation recall: 4.13
Validation precision: 15.52
Validation AUC: 0.20328589674803293
Validation class accuracies: [0.9436781609195403, 0.04128440366972477]
TARGET: 0
target metric(test auc): 0.20328589674803293
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 11 epochs
Epoch 17/40
263/263 - 514s - loss: 0.5790 - accuracy: 0.8580 - val_loss: 0.6978 - val_accuracy: 0.7123
Confusion matrix: 
 [[720 150]
 [163  55]]
Validation f1: 26.00
Validation accuracy: 71.23
Validation recall: 25.23
Validation precision: 26.83
Validation AUC: 0.24222495936082877
Validation class accuracies: [0.8275862068965517, 0.25229357798165136]
TARGET: 0
target metric(test auc): 0.24222495936082877
Lr has been adjusted to 4.2187501094304025e-05
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 12 epochs
Saving model...
Epoch 18/40
263/263 - 513s - loss: 0.5701 - accuracy: 0.8770 - val_loss: 0.6992 - val_accuracy: 0.6489
Confusion matrix: 
 [[638 232]
 [150  68]]
Validation f1: 26.25
Validation accuracy: 64.89
Validation recall: 31.19
Validation precision: 22.67
Validation AUC: 0.22407595751914522
Validation class accuracies: [0.7333333333333333, 0.3119266055045872]
TARGET: 0
target metric(test auc): 0.22407595751914522
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 13 epochs
Epoch 19/40
263/263 - 514s - loss: 0.5653 - accuracy: 0.8889 - val_loss: 0.6913 - val_accuracy: 0.6903
Confusion matrix: 
 [[706 164]
 [173  45]]
Validation f1: 21.08
Validation accuracy: 69.03
Validation recall: 20.64
Validation precision: 21.53
Validation AUC: 0.2180458359487322
Validation class accuracies: [0.8114942528735632, 0.20642201834862386]
TARGET: 0
target metric(test auc): 0.2180458359487322
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 14 epochs
Epoch 20/40
263/263 - 513s - loss: 0.5622 - accuracy: 0.8966 - val_loss: 0.7248 - val_accuracy: 0.6360
Confusion matrix: 
 [[613 257]
 [139  79]]
Validation f1: 28.52
Validation accuracy: 63.60
Validation recall: 36.24
Validation precision: 23.51
Validation AUC: 0.23057679996879799
Validation class accuracies: [0.7045977011494253, 0.3623853211009174]
TARGET: 0
target metric(test auc): 0.23057679996879799
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 15 epochs
Epoch 21/40
263/263 - 514s - loss: 0.5588 - accuracy: 0.9102 - val_loss: 0.7057 - val_accuracy: 0.6921
Confusion matrix: 
 [[715 155]
 [180  38]]
Validation f1: 18.49
Validation accuracy: 69.21
Validation recall: 17.43
Validation precision: 19.69
Validation AUC: 0.21156291204855876
Validation class accuracies: [0.8218390804597702, 0.1743119266055046]
TARGET: 0
target metric(test auc): 0.21156291204855876
Lr has been adjusted to 3.164062582072802e-05
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 16 epochs
Epoch 22/40
263/263 - 514s - loss: 0.5548 - accuracy: 0.9178 - val_loss: 0.6938 - val_accuracy: 0.7050
Confusion matrix: 
 [[730 140]
 [181  37]]
Validation f1: 18.73
Validation accuracy: 70.50
Validation recall: 16.97
Validation precision: 20.90
Validation AUC: 0.22209573614315445
Validation class accuracies: [0.8390804597701149, 0.16972477064220184]
TARGET: 0
target metric(test auc): 0.22209573614315445
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 17 epochs
Epoch 23/40
263/263 - 513s - loss: 0.5506 - accuracy: 0.9256 - val_loss: 0.7021 - val_accuracy: 0.6976
Confusion matrix: 
 [[714 156]
 [173  45]]
Validation f1: 21.48
Validation accuracy: 69.76
Validation recall: 20.64
Validation precision: 22.39
Validation AUC: 0.20876969098307976
Validation class accuracies: [0.8206896551724138, 0.20642201834862386]
TARGET: 0
target metric(test auc): 0.20876969098307976
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 18 epochs
Epoch 24/40
263/263 - 513s - loss: 0.5522 - accuracy: 0.9237 - val_loss: 0.7199 - val_accuracy: 0.7518
Confusion matrix: 
 [[794  76]
 [194  24]]
Validation f1: 15.09
Validation accuracy: 75.18
Validation recall: 11.01
Validation precision: 24.00
Validation AUC: 0.22072610827793998
Validation class accuracies: [0.9126436781609195, 0.11009174311926606]
TARGET: 0
target metric(test auc): 0.22072610827793998
The validation tracker metric at 0.23234868966372346 hasn't increased by 0.03 in 19 epochs
Epoch 25/40
263/263 - 513s - loss: 0.5518 - accuracy: 0.9235 - val_loss: 0.7111 - val_accuracy: 0.6553
Confusion matrix: 
 [[642 228]
 [147  71]]
Validation f1: 27.47
Validation accuracy: 65.53
Validation recall: 32.57
Validation precision: 23.75
Validation AUC: 0.2318504141240093
Validation class accuracies: [0.7379310344827587, 0.3256880733944954]

The metrics for the epoch with the best target metric are: 
Best cm: [[720 150]
 [163  55]]
Best f1: 0.2600472813238771
Best accuracy: 0.7123161764705882
Best recall: 0.25229357798165136
Best precision: 0.2682926829268293
Best AUC: 0.24222495936082877
Best epoch: 17
TARGET: 0
target metric(test auc): 0.2318504141240093
Lr has been adjusted to 2.3730470275040716e-05
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 17
Starting...
CM: [[25 35]
 [ 5 10]]
F1: 0.3333333333333333
AUC: 0.4777777777777778
Accuracy: 0.4666666666666667
Precision: 0.2222222222222222
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2125__05_0402__v29__model9_newparams/validation_sheet_17.xls...
Done.
Epoch: 40
Starting...
CM: [[11 49]
 [ 2 13]]
F1: 0.33766233766233766
AUC: 0.551505376344086
Accuracy: 0.32
Precision: 0.20967741935483872
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2125__05_0402__v29__model9_newparams/validation_sheet_40.xls...
Done.
Epoch: 5
Starting...
CM: [[18 42]
 [ 2 13]]
F1: 0.37142857142857144
AUC: 0.5648484848484848
Accuracy: 0.41333333333333333
Precision: 0.23636363636363636
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2125__05_0402__v29__model9_newparams/validation_sheet_5.xls...
Done.
wandb: Waiting for W&B process to finish, PID 4330
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_040316-213wpf5l/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_040316-213wpf5l/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.9235
wandb:         val_accuracy 0.65533
wandb:             _runtime 13474
wandb:           _timestamp 1620719270
wandb:                _step 176
wandb:           train_loss 0.55179
wandb:             val_loss 0.71107
wandb:           val_recall 0.32569
wandb:        val_precision 0.23746
wandb:               val_f1 0.27466
wandb:              val_auc 0.23185
wandb:                   lr 3e-05
wandb:          best_val_f1 0.26005
wandb:    best_val_accuracy 0.71232
wandb:   best_val_precision 0.26829
wandb:      best_val_recall 0.25229
wandb:             best_auc 0.24222
wandb:           best_epoch 17
wandb:           best_bd_f1 0.37143
wandb:          best_bd_auc 0.56485
wandb:     best_bd_accuracy 0.41333
wandb:    best_bd_precision 0.23636
wandb:       best_bd_recall 0.86667
wandb:        best_bd_epoch 5
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▃▃▃▃▄▄▄▅▅▆▆▇▇▇▇▇█████
wandb:     val_accuracy ███▇▆▃▇▄▅▅▁▇▆▅█▇▇▅▆▅▆▆▆▇▆
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▆▆▆▆▆▅▅▅▄▄▄▃▃▂▂▂▂▁▁▁▁▁▁
wandb:         val_loss ▁▁▂▂▄▃▁▄▃▃█▂▃▄▅▃▃▃▃▄▄▃▃▄▄
wandb:       val_recall ▁▁▁▂▄▅▁▄▄▃█▂▃▃▁▁▃▄▃▄▃▃▃▂▄
wandb:    val_precision ▁▁█▆▇▆▅▆▆▆▆▆▇▆▄▅█▇▇▇▆▆▇▇▇
wandb:           val_f1 ▁▁▃▄▆▆▂▆▇▆█▄▅▆▂▂▇▇▅▇▅▅▆▄▇
wandb:          val_auc █▄▄▄▆▂▃▁▅▅▄▄▃▁▂▃▇▅▅▆▄▅▄▅▆
wandb:               lr █████████▅▅▅▅▄▄▄▄▂▂▂▂▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 2 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2125: https://wandb.ai/arachid1/tensorboard-integration/runs/213wpf5l


 See logs at ../../new_cache/conv__2125__05_0402__v29__model9_newparams/logs/