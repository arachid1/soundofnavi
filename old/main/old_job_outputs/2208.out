Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2208
Description:  new_lstm_onconcat
2021-06-10 20:22:00.757280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-10 20:22:03.067045: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-10 20:22:03.067949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-10 20:22:03.103160: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:03.103857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-10 20:22:03.103889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-10 20:22:03.107445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-10 20:22:03.107532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-10 20:22:03.108610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-10 20:22:03.108909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-10 20:22:03.109913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-10 20:22:03.110856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-10 20:22:03.111022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-10 20:22:03.111144: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:03.111795: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:03.112343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2208.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2208__06_2017__v29__new_lstm_onconcat
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 8, 'LR': 0.0005, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 50, 'FACTOR': 0.75, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'AUGMENTATION': 0, 'TARGET': 0, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-10 20:22:42.714521: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-10 20:22:42.714903: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:42.715574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-10 20:22:42.715628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-10 20:22:42.715697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-10 20:22:42.715717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-10 20:22:42.715744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-10 20:22:42.715767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-10 20:22:42.715787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-10 20:22:42.715807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-10 20:22:42.715826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-10 20:22:42.715923: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:42.716591: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:42.717220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-10 20:22:42.717286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-10 20:22:43.375585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-10 20:22:43.375632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-10 20:22:43.375644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-10 20:22:43.375960: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:43.376618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:43.377328: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-10 20:22:43.377999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-06-10 20:22:45.508972: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-10 20:22:45.510483: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-10 20:22:45.713781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-10 20:22:47.155719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-10 20:22:47.502610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.6724137931034483, 1: 1.95}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 5, 250, 128, 1) 0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 5, 250, 128, 1)  4            input_1[0][0]                        
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 5, 250, 128, 8)  16           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed (None, 5, 250, 128, 8)  16           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed (None, 5, 250, 128, 1)  0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed (None, 5, 250, 128, 8)  584          time_distributed[0][0]               
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed (None, 5, 250, 128, 8)  1608         time_distributed_2[0][0]             
______________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed (None, 5, 250, 128, 8)  16           time_distributed_4[0][0]             
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 5, 250, 128, 24) 0            time_distributed_1[0][0]             
                                                                         time_distributed_3[0][0]             
                                                                         time_distributed_5[0][0]             
______________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed (None, 5, 250, 64, 24)  0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 5, 250, 64, 24)  96           time_distributed_6[0][0]             
______________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed (None, 5, 250, 64, 32)  6944         batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_8 (TimeDistributed (None, 5, 250, 64, 32)  828          time_distributed_7[0][0]             
______________________________________________________________________________________________________________
time_distributed_9 (TimeDistributed (None, 5, 250, 32, 32)  0            time_distributed_8[0][0]             
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 5, 250, 32, 32)  128          time_distributed_9[0][0]             
______________________________________________________________________________________________________________
time_distributed_inverted_residual  (None, 5, 250, 32, 64)  11104        batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
time_distributed_inverted_residual_ (None, 5, 250, 32, 64)  28096        time_distributed_inverted_residual[0]
______________________________________________________________________________________________________________
time_distributed_10 (TimeDistribute (None, 5, 250, 16, 64)  0            time_distributed_inverted_residual_1[
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 5, 250, 16, 64)  256          time_distributed_10[0][0]            
______________________________________________________________________________________________________________
time_distributed_inverted_residual_ (None, 5, 250, 16, 128) 40640        batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
time_distributed_11 (TimeDistribute (None, 5, 250, 8, 128)  0            time_distributed_inverted_residual_2[
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 5, 250, 8, 128)  512          time_distributed_11[0][0]            
______________________________________________________________________________________________________________
time_distributed_inverted_residual_ (None, 5, 250, 8, 256)  155008       batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
time_distributed_12 (TimeDistribute (None, 5, 250, 1, 256)  0            time_distributed_inverted_residual_3[
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 5, 250, 1, 256)  1024         time_distributed_12[0][0]            
______________________________________________________________________________________________________________
time_distributed_13 (TimeDistribute (None, 5, 256)          0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 5, 128)          164352       time_distributed_13[0][0]            
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 5, 256)          263168       bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 5, 1)            257          bidirectional_1[0][0]                
______________________________________________________________________________________________________________
flatten (Flatten)                   (None, 5)               0            dense[0][0]                          
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               6            flatten[0][0]                        
==============================================================================================================
Total params: 674,663
Trainable params: 669,173
Non-trainable params: 5,490
______________________________________________________________________________________________________________
Epoch 1/50
527/527 - 207s - loss: 0.6950 - accuracy: 0.5133 - val_loss: 0.6540 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2684397720849627
Validation class accuracies: [1.0, 0.0]
Saving model...
Epoch 2/50
527/527 - 205s - loss: 0.6902 - accuracy: 0.5444 - val_loss: 0.8024 - val_accuracy: 0.2864
Confusion matrix: 
 [[ 36 748]
 [ 17 271]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.046 0.954]
 [0.059 0.941]]
Validation f1: 41.47
Validation accuracy: 28.64
Validation recall: 94.10
Validation precision: 26.59
Validation AUC: 0.2844194979039787
Validation class accuracies: [0.04591836734693878, 0.9409722222222222]
Saving model...
Epoch 3/50
527/527 - 205s - loss: 0.6854 - accuracy: 0.5351 - val_loss: 0.7467 - val_accuracy: 0.3200
Confusion matrix: 
 [[ 85 699]
 [ 30 258]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.108 0.892]
 [0.104 0.896]]
Validation f1: 41.45
Validation accuracy: 32.00
Validation recall: 89.58
Validation precision: 26.96
Validation AUC: 0.2692995393057144
Validation class accuracies: [0.10841836734693877, 0.8958333333333334]
The validation tracker metric at 0.2844194979039787 hasn't increased by 0 in 1 epochs
Epoch 4/50
527/527 - 205s - loss: 0.6826 - accuracy: 0.5261 - val_loss: 0.7082 - val_accuracy: 0.4394
Confusion matrix: 
 [[269 515]
 [ 86 202]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.343 0.657]
 [0.299 0.701]]
Validation f1: 40.20
Validation accuracy: 43.94
Validation recall: 70.14
Validation precision: 28.17
Validation AUC: 0.31208056623289415
Validation class accuracies: [0.34311224489795916, 0.7013888888888888]
Saving model...
Epoch 5/50
527/527 - 206s - loss: 0.6771 - accuracy: 0.5691 - val_loss: 0.6978 - val_accuracy: 0.5532
Confusion matrix: 
 [[422 362]
 [117 171]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.538 0.462]
 [0.406 0.594]]
Validation f1: 41.66
Validation accuracy: 55.32
Validation recall: 59.38
Validation precision: 32.08
Validation AUC: 0.3109703319204432
Validation class accuracies: [0.5382653061224489, 0.59375]
The validation tracker metric at 0.31208056623289415 hasn't increased by 0 in 1 epochs
Epoch 6/50
527/527 - 205s - loss: 0.6794 - accuracy: 0.5278 - val_loss: 0.6689 - val_accuracy: 0.6231
Confusion matrix: 
 [[569 215]
 [189  99]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.726 0.274]
 [0.656 0.344]]
Validation f1: 32.89
Validation accuracy: 62.31
Validation recall: 34.38
Validation precision: 31.53
Validation AUC: 0.3098001386688519
Validation class accuracies: [0.7257653061224489, 0.34375]
The validation tracker metric at 0.31208056623289415 hasn't increased by 0 in 2 epochs
Epoch 7/50
527/527 - 205s - loss: 0.6771 - accuracy: 0.5691 - val_loss: 0.6834 - val_accuracy: 0.5625
Confusion matrix: 
 [[446 338]
 [131 157]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.569 0.431]
 [0.455 0.545]]
Validation f1: 40.10
Validation accuracy: 56.25
Validation recall: 54.51
Validation precision: 31.72
Validation AUC: 0.3087323082509835
Validation class accuracies: [0.5688775510204082, 0.5451388888888888]
The validation tracker metric at 0.31208056623289415 hasn't increased by 0 in 3 epochs
Epoch 8/50
527/527 - 205s - loss: 0.6699 - accuracy: 0.5724 - val_loss: 0.7303 - val_accuracy: 0.4683
Confusion matrix: 
 [[312 472]
 [ 98 190]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.398 0.602]
 [0.34  0.66 ]]
Validation f1: 40.00
Validation accuracy: 46.83
Validation recall: 65.97
Validation precision: 28.70
Validation AUC: 0.3054482363073756
Validation class accuracies: [0.3979591836734694, 0.6597222222222222]
The validation tracker metric at 0.31208056623289415 hasn't increased by 0 in 4 epochs
Epoch 9/50
527/527 - 204s - loss: 0.6672 - accuracy: 0.5845 - val_loss: 0.6666 - val_accuracy: 0.6063
Confusion matrix: 
 [[535 249]
 [173 115]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.682 0.318]
 [0.601 0.399]]
Validation f1: 35.28
Validation accuracy: 60.63
Validation recall: 39.93
Validation precision: 31.59
Validation AUC: 0.3037731383927985
Validation class accuracies: [0.6823979591836735, 0.3993055555555556]
The validation tracker metric at 0.31208056623289415 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.000375000003259629
Epoch 10/50
527/527 - 205s - loss: 0.6621 - accuracy: 0.6000 - val_loss: 0.6651 - val_accuracy: 0.6119
Confusion matrix: 
 [[545 239]
 [177 111]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.695 0.305]
 [0.615 0.385]]
Validation f1: 34.80
Validation accuracy: 61.19
Validation recall: 38.54
Validation precision: 31.71
Validation AUC: 0.3123455659843253
Validation class accuracies: [0.6951530612244898, 0.3854166666666667]
Saving model...
Epoch 11/50
527/527 - 205s - loss: 0.6611 - accuracy: 0.5916 - val_loss: 0.7394 - val_accuracy: 0.4907
Confusion matrix: 
 [[347 437]
 [109 179]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.443 0.557]
 [0.378 0.622]]
Validation f1: 39.60
Validation accuracy: 49.07
Validation recall: 62.15
Validation precision: 29.06
Validation AUC: 0.28712792942437315
Validation class accuracies: [0.44260204081632654, 0.6215277777777778]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 1 epochs
Epoch 12/50
527/527 - 204s - loss: 0.6564 - accuracy: 0.6135 - val_loss: 0.6550 - val_accuracy: 0.6446
Confusion matrix: 
 [[621 163]
 [218  70]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.757 0.243]]
Validation f1: 26.87
Validation accuracy: 64.46
Validation recall: 24.31
Validation precision: 30.04
Validation AUC: 0.299054462658362
Validation class accuracies: [0.7920918367346939, 0.24305555555555555]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 2 epochs
Epoch 13/50
527/527 - 205s - loss: 0.6472 - accuracy: 0.6161 - val_loss: 0.6504 - val_accuracy: 0.6493
Confusion matrix: 
 [[635 149]
 [227  61]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81  0.19 ]
 [0.788 0.212]]
Validation f1: 24.50
Validation accuracy: 64.93
Validation recall: 21.18
Validation precision: 29.05
Validation AUC: 0.2947784572363326
Validation class accuracies: [0.8099489795918368, 0.21180555555555555]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 3 epochs
Epoch 14/50
527/527 - 205s - loss: 0.6408 - accuracy: 0.6484 - val_loss: 0.6347 - val_accuracy: 0.6828
Confusion matrix: 
 [[702  82]
 [258  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.896 0.104]]
Validation f1: 15.00
Validation accuracy: 68.28
Validation recall: 10.42
Validation precision: 26.79
Validation AUC: 0.28612730963353283
Validation class accuracies: [0.8954081632653061, 0.10416666666666667]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 4 epochs
Epoch 15/50
527/527 - 204s - loss: 0.6352 - accuracy: 0.6581 - val_loss: 0.7007 - val_accuracy: 0.5951
Confusion matrix: 
 [[534 250]
 [184 104]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.681 0.319]
 [0.639 0.361]]
Validation f1: 32.40
Validation accuracy: 59.51
Validation recall: 36.11
Validation precision: 29.38
Validation AUC: 0.27933259602159133
Validation class accuracies: [0.6811224489795918, 0.3611111111111111]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.00028124998789280653
Epoch 16/50
527/527 - 205s - loss: 0.6256 - accuracy: 0.6759 - val_loss: 0.8369 - val_accuracy: 0.4869
Confusion matrix: 
 [[331 453]
 [ 97 191]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.422 0.578]
 [0.337 0.663]]
Validation f1: 40.99
Validation accuracy: 48.69
Validation recall: 66.32
Validation precision: 29.66
Validation AUC: 0.27954643627600195
Validation class accuracies: [0.4221938775510204, 0.6631944444444444]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 6 epochs
Epoch 17/50
527/527 - 205s - loss: 0.6158 - accuracy: 0.6871 - val_loss: 0.7391 - val_accuracy: 0.5728
Confusion matrix: 
 [[491 293]
 [165 123]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.626 0.374]
 [0.573 0.427]]
Validation f1: 34.94
Validation accuracy: 57.28
Validation recall: 42.71
Validation precision: 29.57
Validation AUC: 0.2747044970977409
Validation class accuracies: [0.6262755102040817, 0.4270833333333333]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 7 epochs
Epoch 18/50
527/527 - 204s - loss: 0.6105 - accuracy: 0.6973 - val_loss: 0.6250 - val_accuracy: 0.6959
Confusion matrix: 
 [[731  53]
 [273  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.948 0.052]]
Validation f1: 8.43
Validation accuracy: 69.59
Validation recall: 5.21
Validation precision: 22.06
Validation AUC: 0.26911925445893625
Validation class accuracies: [0.9323979591836735, 0.052083333333333336]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 8 epochs
Epoch 19/50
527/527 - 205s - loss: 0.5930 - accuracy: 0.7232 - val_loss: 0.6314 - val_accuracy: 0.6912
Confusion matrix: 
 [[722  62]
 [269  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.934 0.066]]
Validation f1: 10.30
Validation accuracy: 69.12
Validation recall: 6.60
Validation precision: 23.46
Validation AUC: 0.2777158355502608
Validation class accuracies: [0.9209183673469388, 0.06597222222222222]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 9 epochs
Epoch 20/50
527/527 - 205s - loss: 0.5911 - accuracy: 0.7312 - val_loss: 0.7480 - val_accuracy: 0.5849
Confusion matrix: 
 [[525 259]
 [186 102]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.67  0.33 ]
 [0.646 0.354]]
Validation f1: 31.43
Validation accuracy: 58.49
Validation recall: 35.42
Validation precision: 28.25
Validation AUC: 0.27548732565919315
Validation class accuracies: [0.6696428571428571, 0.3541666666666667]
The validation tracker metric at 0.3123455659843253 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002109374909196049
Epoch 21/50
527/527 - 205s - loss: 0.5799 - accuracy: 0.7453 - val_loss: 0.7278 - val_accuracy: 0.6185
Confusion matrix: 
 [[581 203]
 [206  82]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.741 0.259]
 [0.715 0.285]]
Validation f1: 28.62
Validation accuracy: 61.85
Validation recall: 28.47
Validation precision: 28.77
Validation AUC: 0.27850932240649373
Validation class accuracies: [0.7410714285714286, 0.2847222222222222]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
