Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2150
Description:  mod9_nodrp
2021-05-18 11:04:39.785858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 11:04:42.499736: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-18 11:04:42.500804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-18 11:04:42.552303: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:42.553095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-18 11:04:42.553130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 11:04:42.556994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 11:04:42.557116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 11:04:42.558414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-18 11:04:42.558817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-18 11:04:42.559931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-18 11:04:42.560888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-18 11:04:42.561065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-18 11:04:42.561205: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:42.562026: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:42.562729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2150.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2150
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2wxubhah
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_110442-2wxubhah
wandb: Run `wandb offline` to turn off syncing.
2021-05-18 11:04:48.621963: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-18 11:04:48.622254: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:48.623087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-18 11:04:48.623140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 11:04:48.623214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 11:04:48.623241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 11:04:48.623268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-18 11:04:48.623294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-18 11:04:48.623325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-18 11:04:48.623360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-18 11:04:48.623384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-18 11:04:48.623490: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:48.624275: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:48.625000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-18 11:04:48.625055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 11:04:49.476260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-18 11:04:49.476316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-18 11:04:49.476326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-18 11:04:49.476662: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:49.477542: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:49.478387: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 11:04:49.479139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-18 11:05:36.749321: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-18 11:05:36.751734: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-18 11:05:40.323987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 11:05:41.171160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 11:05:41.182573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
binary
Epoch 1/80
263/263 - 507s - loss: 0.6699 - accuracy: 0.7014 - val_loss: 0.5014 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2699660046956668
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
263/263 - 509s - loss: 0.5870 - accuracy: 0.7233 - val_loss: 0.5074 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22523881205748006
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
263/263 - 507s - loss: 0.5867 - accuracy: 0.7216 - val_loss: 0.5732 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16017337920784425
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
263/263 - 508s - loss: 0.5856 - accuracy: 0.7226 - val_loss: 0.5257 - val_accuracy: 0.7950
Confusion matrix: 
 [[864   6]
 [217   1]]
Validation f1: 0.89
Validation accuracy: 79.50
Validation recall: 0.46
Validation precision: 14.29
Validation AUC: 0.22780216410378681
Validation class accuracies: [0.993103448275862, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.008888888888888889
column_sums: [1081    7]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
263/263 - 509s - loss: 0.5774 - accuracy: 0.7247 - val_loss: 0.5424 - val_accuracy: 0.7537
Confusion matrix: 
 [[804  66]
 [202  16]]
Validation f1: 10.67
Validation accuracy: 75.37
Validation recall: 7.34
Validation precision: 19.51
Validation AUC: 0.22635216009446002
Validation class accuracies: [0.9241379310344827, 0.07339449541284404]
TARGET: 1
target metric(test f1): 0.10666666666666667
column_sums: [1006   82]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
263/263 - 509s - loss: 0.5765 - accuracy: 0.7250 - val_loss: 0.5221 - val_accuracy: 0.8006
Confusion matrix: 
 [[870   0]
 [217   1]]
Validation f1: 0.91
Validation accuracy: 80.06
Validation recall: 0.46
Validation precision: 100.00
Validation AUC: 0.16926510860010474
Validation class accuracies: [1.0, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.0091324200913242
column_sums: [1087    1]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
263/263 - 508s - loss: 0.5777 - accuracy: 0.7226 - val_loss: 0.5353 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20904854835747777
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
263/263 - 508s - loss: 0.5732 - accuracy: 0.7197 - val_loss: 0.5310 - val_accuracy: 0.7877
Confusion matrix: 
 [[854  16]
 [215   3]]
Validation f1: 2.53
Validation accuracy: 78.77
Validation recall: 1.38
Validation precision: 15.79
Validation AUC: 0.19854382256620615
Validation class accuracies: [0.9816091954022989, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.02531645569620253
column_sums: [1069   19]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
263/263 - 509s - loss: 0.5677 - accuracy: 0.7255 - val_loss: 0.5811 - val_accuracy: 0.7436
Confusion matrix: 
 [[784  86]
 [193  25]]
Validation f1: 15.20
Validation accuracy: 74.36
Validation recall: 11.47
Validation precision: 22.52
Validation AUC: 0.22783820156575516
Validation class accuracies: [0.9011494252873563, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.1519756838905775
column_sums: [977 111]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 10/80
263/263 - 510s - loss: 0.5671 - accuracy: 0.7274 - val_loss: 0.5325 - val_accuracy: 0.7877
Confusion matrix: 
 [[848  22]
 [209   9]]
Validation f1: 7.23
Validation accuracy: 78.77
Validation recall: 4.13
Validation precision: 29.03
Validation AUC: 0.23543499880136665
Validation class accuracies: [0.9747126436781609, 0.04128440366972477]
TARGET: 1
target metric(test f1): 0.07228915662650602
column_sums: [1057   31]
cm_sum: 1088
The training is defaulting to either class.
Epoch 11/80
263/263 - 509s - loss: 0.5618 - accuracy: 0.7290 - val_loss: 0.5231 - val_accuracy: 0.7803
Confusion matrix: 
 [[843  27]
 [212   6]]
Validation f1: 4.78
Validation accuracy: 78.03
Validation recall: 2.75
Validation precision: 18.18
Validation AUC: 0.23002407646785733
Validation class accuracies: [0.9689655172413794, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.04780876494023905
column_sums: [1055   33]
cm_sum: 1088
The training is defaulting to either class.
Epoch 12/80
263/263 - 509s - loss: 0.5586 - accuracy: 0.7293 - val_loss: 0.5276 - val_accuracy: 0.7822
Confusion matrix: 
 [[845  25]
 [212   6]]
Validation f1: 4.82
Validation accuracy: 78.22
Validation recall: 2.75
Validation precision: 19.35
Validation AUC: 0.21942845820988557
Validation class accuracies: [0.9712643678160919, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.04819277108433735
column_sums: [1057   31]
cm_sum: 1088
The training is defaulting to either class.
Epoch 13/80
263/263 - 508s - loss: 0.5530 - accuracy: 0.7316 - val_loss: 0.5351 - val_accuracy: 0.7509
Confusion matrix: 
 [[811  59]
 [212   6]]
Validation f1: 4.24
Validation accuracy: 75.09
Validation recall: 2.75
Validation precision: 9.23
Validation AUC: 0.2128682588313243
Validation class accuracies: [0.9321839080459771, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.04240282685512368
column_sums: [1023   65]
cm_sum: 1088
The training is defaulting to either class.
Epoch 14/80
263/263 - 510s - loss: 0.5460 - accuracy: 0.7362 - val_loss: 0.6381 - val_accuracy: 0.6728
Confusion matrix: 
 [[695 175]
 [181  37]]
Validation f1: 17.21
Validation accuracy: 67.28
Validation recall: 16.97
Validation precision: 17.45
Validation AUC: 0.1862580584286984
Validation class accuracies: [0.7988505747126436, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.17209302325581396
column_sums: [876 212]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 15/80
263/263 - 508s - loss: 0.5422 - accuracy: 0.7429 - val_loss: 0.8140 - val_accuracy: 0.5257
Confusion matrix: 
 [[440 430]
 [ 86 132]]
Validation f1: 33.85
Validation accuracy: 52.57
Validation recall: 60.55
Validation precision: 23.49
Validation AUC: 0.22491003682532956
Validation class accuracies: [0.5057471264367817, 0.6055045871559633]
TARGET: 1
target metric(test f1): 0.3384615384615384
column_sums: [526 562]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 16/80
263/263 - 509s - loss: 0.5395 - accuracy: 0.7438 - val_loss: 0.5685 - val_accuracy: 0.7362
Confusion matrix: 
 [[781  89]
 [198  20]]
Validation f1: 12.23
Validation accuracy: 73.62
Validation recall: 9.17
Validation precision: 18.35
Validation AUC: 0.21162515010326155
Validation class accuracies: [0.8977011494252873, 0.09174311926605505]
TARGET: 1
target metric(test f1): 0.12232415902140674
column_sums: [979 109]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 1 epochs
Epoch 17/80
263/263 - 509s - loss: 0.5298 - accuracy: 0.7486 - val_loss: 0.5657 - val_accuracy: 0.7289
Confusion matrix: 
 [[771  99]
 [196  22]]
Validation f1: 12.98
Validation accuracy: 72.89
Validation recall: 10.09
Validation precision: 18.18
Validation AUC: 0.21664283848687182
Validation class accuracies: [0.8862068965517241, 0.10091743119266056]
TARGET: 1
target metric(test f1): 0.12979351032448377
column_sums: [967 121]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 2 epochs
Epoch 18/80
263/263 - 510s - loss: 0.5241 - accuracy: 0.7514 - val_loss: 0.5190 - val_accuracy: 0.7794
Confusion matrix: 
 [[842  28]
 [212   6]]
Validation f1: 4.76
Validation accuracy: 77.94
Validation recall: 2.75
Validation precision: 17.65
Validation AUC: 0.22891931395014614
Validation class accuracies: [0.967816091954023, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.04761904761904762
column_sums: [1054   34]
cm_sum: 1088
The training is defaulting to either class.
Epoch 19/80
263/263 - 507s - loss: 0.5112 - accuracy: 0.7519 - val_loss: 0.7261 - val_accuracy: 0.6700
Confusion matrix: 
 [[693 177]
 [182  36]]
Validation f1: 16.71
Validation accuracy: 67.00
Validation recall: 16.51
Validation precision: 16.90
Validation AUC: 0.19493120444398554
Validation class accuracies: [0.7965517241379311, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.16705336426914155
column_sums: [875 213]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 3 epochs
Epoch 20/80
263/263 - 509s - loss: 0.4951 - accuracy: 0.7679 - val_loss: 0.6796 - val_accuracy: 0.7050
Confusion matrix: 
 [[739 131]
 [190  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 14.85
Validation accuracy: 70.50
Validation recall: 12.84
Validation precision: 17.61
Validation AUC: 0.19874124171994384
Validation class accuracies: [0.8494252873563218, 0.12844036697247707]
TARGET: 1
target metric(test f1): 0.14854111405835543
column_sums: [929 159]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 4 epochs
Epoch 21/80
263/263 - 509s - loss: 0.4461 - accuracy: 0.7898 - val_loss: 0.6238 - val_accuracy: 0.7647
Confusion matrix: 
 [[824  46]
 [210   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 5.88
Validation accuracy: 76.47
Validation recall: 3.67
Validation precision: 14.81
Validation AUC: 0.1966585757818566
Validation class accuracies: [0.9471264367816092, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.05882352941176471
column_sums: [1034   54]
cm_sum: 1088
The training is defaulting to either class.
Epoch 22/80
263/263 - 507s - loss: 0.4238 - accuracy: 0.8091 - val_loss: 0.6880 - val_accuracy: 0.7178
Confusion matrix: 
 [[756 114]
 [193  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 14.01
Validation accuracy: 71.78
Validation recall: 11.47
Validation precision: 17.99
Validation AUC: 0.1901457582894958
Validation class accuracies: [0.8689655172413793, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.14005602240896362
column_sums: [949 139]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 5 epochs
Epoch 23/80
263/263 - 509s - loss: 0.3930 - accuracy: 0.8222 - val_loss: 0.8363 - val_accuracy: 0.6710
Confusion matrix: 
 [[692 178]
 [180  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.51
Validation accuracy: 67.10
Validation recall: 17.43
Validation precision: 17.59
Validation AUC: 0.1889656049197198
Validation class accuracies: [0.7954022988505747, 0.1743119266055046]
TARGET: 1
target metric(test f1): 0.17511520737327188
column_sums: [872 216]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 6 epochs
Epoch 24/80
263/263 - 510s - loss: 0.3723 - accuracy: 0.8325 - val_loss: 0.7727 - val_accuracy: 0.7233
Confusion matrix: 
 [[771  99]
 [202  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 9.61
Validation accuracy: 72.33
Validation recall: 7.34
Validation precision: 13.91
Validation AUC: 0.18639527345847162
Validation class accuracies: [0.8862068965517241, 0.07339449541284404]
TARGET: 1
target metric(test f1): 0.09609609609609611
column_sums: [973 115]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 7 epochs
Epoch 25/80
263/263 - 509s - loss: 0.3556 - accuracy: 0.8363 - val_loss: 0.7420 - val_accuracy: 0.6985
Confusion matrix: 
 [[722 148]
 [180  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.81
Validation accuracy: 69.85
Validation recall: 17.43
Validation precision: 20.43
Validation AUC: 0.2115472883877638
Validation class accuracies: [0.8298850574712644, 0.1743119266055046]
TARGET: 1
target metric(test f1): 0.18811881188118815
column_sums: [902 186]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 8 epochs
Epoch 26/80
263/263 - 509s - loss: 0.3119 - accuracy: 0.8663 - val_loss: 0.8679 - val_accuracy: 0.6903
Confusion matrix: 
 [[719 151]
 [186  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.96
Validation accuracy: 69.03
Validation recall: 14.68
Validation precision: 17.49
Validation AUC: 0.19448423766182985
Validation class accuracies: [0.8264367816091954, 0.14678899082568808]
TARGET: 1
target metric(test f1): 0.15960099750623444
column_sums: [905 183]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 9 epochs
Epoch 27/80
263/263 - 509s - loss: 0.2980 - accuracy: 0.8730 - val_loss: 0.9884 - val_accuracy: 0.6700
Confusion matrix: 
 [[687 183]
 [176  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.96
Validation accuracy: 67.00
Validation recall: 19.27
Validation precision: 18.67
Validation AUC: 0.193225128242934
Validation class accuracies: [0.7896551724137931, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.18961625282167044
column_sums: [863 225]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 10 epochs
Epoch 28/80
263/263 - 506s - loss: 0.2897 - accuracy: 0.8799 - val_loss: 0.9784 - val_accuracy: 0.6756
Confusion matrix: 
 [[708 162]
 [191  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 13.27
Validation accuracy: 67.56
Validation recall: 12.39
Validation precision: 14.29
Validation AUC: 0.19045586190370342
Validation class accuracies: [0.8137931034482758, 0.12385321100917432]
TARGET: 1
target metric(test f1): 0.1326781326781327
column_sums: [899 189]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 11 epochs
Epoch 29/80
263/263 - 506s - loss: 0.2883 - accuracy: 0.8744 - val_loss: 0.9522 - val_accuracy: 0.6774
Confusion matrix: 
 [[695 175]
 [176  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 19.31
Validation accuracy: 67.74
Validation recall: 19.27
Validation precision: 19.35
Validation AUC: 0.19305269930523233
Validation class accuracies: [0.7988505747126436, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.19310344827586207
column_sums: [871 217]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 12 epochs
Epoch 30/80
263/263 - 508s - loss: 0.2755 - accuracy: 0.8856 - val_loss: 0.9889 - val_accuracy: 0.6728
Confusion matrix: 
 [[690 180]
 [176  42]]
Validation f1: 19.09
Validation accuracy: 67.28
Validation recall: 19.27
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 18.92
Validation AUC: 0.19558221715546975
Validation class accuracies: [0.7931034482758621, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.19090909090909092
column_sums: [866 222]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 13 epochs
Epoch 31/80
263/263 - 509s - loss: 0.2757 - accuracy: 0.8820 - val_loss: 1.0096 - val_accuracy: 0.6645
Confusion matrix: 
 [[684 186]
 [179  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.61
Validation accuracy: 66.45
Validation recall: 17.89
Validation precision: 17.33
Validation AUC: 0.19297140420358141
Validation class accuracies: [0.7862068965517242, 0.17889908256880735]
TARGET: 1
target metric(test f1): 0.1760722347629797
column_sums: [863 225]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 14 epochs
Epoch 32/80
263/263 - 506s - loss: 0.2704 - accuracy: 0.8913 - val_loss: 0.9793 - val_accuracy: 0.6746
Confusion matrix: 
 [[694 176]
 [178  40]]
Validation f1: 18.43
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 67.46
Validation recall: 18.35
Validation precision: 18.52
Validation AUC: 0.19337586803353363
Validation class accuracies: [0.7977011494252874, 0.1834862385321101]
TARGET: 1
target metric(test f1): 0.18433179723502305
column_sums: [872 216]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 15 epochs
Epoch 33/80
263/263 - 507s - loss: 0.2673 - accuracy: 0.8901 - val_loss: 1.0063 - val_accuracy: 0.6783
Confusion matrix: 
 [[699 171]
 [179  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.22
Validation accuracy: 67.83
Validation recall: 17.89
Validation precision: 18.57
Validation AUC: 0.19621586009320968
Validation class accuracies: [0.803448275862069, 0.17889908256880735]
TARGET: 1
target metric(test f1): 0.18224299065420557
column_sums: [878 210]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 16 epochs
Epoch 34/80
263/263 - 506s - loss: 0.2684 - accuracy: 0.8844 - val_loss: 1.0308 - val_accuracy: 0.6562
Confusion matrix: 
 [[671 199]
 [175  43]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.70
Validation accuracy: 65.62
Validation recall: 19.72
Validation precision: 17.77
Validation AUC: 0.1957287399244519
Validation class accuracies: [0.771264367816092, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.18695652173913044
column_sums: [846 242]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 17 epochs
Epoch 35/80
263/263 - 506s - loss: 0.2710 - accuracy: 0.8816 - val_loss: 1.0164 - val_accuracy: 0.6608
Confusion matrix: 
 [[677 193]
 [176  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.54
Validation accuracy: 66.08
Validation recall: 19.27
Validation precision: 17.87
Validation AUC: 0.1950543984465371
Validation class accuracies: [0.7781609195402299, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.18543046357615894
column_sums: [853 235]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 18 epochs
Epoch 36/80
263/263 - 507s - loss: 0.2801 - accuracy: 0.8858 - val_loss: 1.0033 - val_accuracy: 0.6636
Confusion matrix: 
 [[681 189]
 [177  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.30
Validation accuracy: 66.36
Validation recall: 18.81
Validation precision: 17.83
Validation AUC: 0.19440671036260232
Validation class accuracies: [0.7827586206896552, 0.18807339449541285]
TARGET: 1
target metric(test f1): 0.18303571428571427
column_sums: [858 230]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 19 epochs
Epoch 37/80
263/263 - 506s - loss: 0.2711 - accuracy: 0.8858 - val_loss: 1.0105 - val_accuracy: 0.6645
Confusion matrix: 
 [[682 188]
 [177  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.34
Validation accuracy: 66.45
Validation recall: 18.81
Validation precision: 17.90
Validation AUC: 0.1936835944770383
Validation class accuracies: [0.7839080459770115, 0.18807339449541285]
TARGET: 1
target metric(test f1): 0.18344519015659955
column_sums: [859 229]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 20 epochs
Epoch 38/80
263/263 - 507s - loss: 0.2706 - accuracy: 0.8856 - val_loss: 1.0109 - val_accuracy: 0.6682
Confusion matrix: 
 [[685 185]
 [176  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.88
Validation accuracy: 66.82
Validation recall: 19.27
Validation precision: 18.50
Validation AUC: 0.19497006790206362
Validation class accuracies: [0.7873563218390804, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.18876404494382024
column_sums: [861 227]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 21 epochs
Epoch 39/80
263/263 - 505s - loss: 0.2672 - accuracy: 0.8882 - val_loss: 1.0136 - val_accuracy: 0.6645
Confusion matrix: 
 [[681 189]
 [176  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.71
Validation accuracy: 66.45
Validation recall: 19.27
Validation precision: 18.18
Validation AUC: 0.19401284179990128
Validation class accuracies: [0.7827586206896552, 0.1926605504587156]
TARGET: 1
target metric(test f1): 0.1870824053452116
column_sums: [857 231]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 22 epochs
Epoch 40/80
263/263 - 506s - loss: 0.2684 - accuracy: 0.8858 - val_loss: 1.0345 - val_accuracy: 0.6553
Confusion matrix: 
 [[670 200]
 [175  43]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.66
Validation accuracy: 65.53
Validation recall: 19.72
Validation precision: 17.70
Validation AUC: 0.1947234237174485
Validation class accuracies: [0.7701149425287356, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.18655097613882865
column_sums: [845 243]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 23 epochs
Epoch 41/80
263/263 - 513s - loss: 0.2689 - accuracy: 0.8866 - val_loss: 1.0512 - val_accuracy: 0.6535
Confusion matrix: 
 [[667 203]
 [174  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.92
Validation accuracy: 65.35
Validation recall: 20.18
Validation precision: 17.81
Validation AUC: 0.19441153271623313
Validation class accuracies: [0.7666666666666667, 0.2018348623853211]
TARGET: 1
target metric(test f1): 0.18924731182795698
column_sums: [841 247]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.3384615384615384 hasn't increased by 0 in 24 epochs
Epoch 42/80
263/263 - 506s - loss: 0.2680 - accuracy: 0.8906 - val_loss: 1.0095 - val_accuracy: 0.6673
Confusion matrix: 
 [[684 186]
 [176  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.83
Validation accuracy: 66.73
Validation recall: 19.27
Validation precision: 18.42
Validation AUC: 0.19475030463553863
Validation class accuracies: [0.7862068965517242, 0.1926605504587156]

The metrics for the epoch with the best target metric are: 
Best cm: [[440 430]
 [ 86 132]]
Best f1: 0.3384615384615384
Best accuracy: 0.5257352941176471
Best recall: 0.6055045871559633
Best precision: 0.23487544483985764
Best AUC: 0.22491003682532956
Best epoch: 15
TARGET: 1
target metric(test f1): 0.1883408071748879
column_sums: [860 228]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 14
Starting...
CM: [[17 43]
 [ 6  9]]
F1: 0.26865671641791045
AUC: 0.4265384615384616
Accuracy: 0.3466666666666667
Precision: 0.17307692307692307
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_14.xls...
Done.
Epoch: 14
Starting...
CM: [[38 22]
 [12  3]]
F1: 0.15
AUC: 0.24000000000000002
Accuracy: 0.5466666666666666
Precision: 0.12
Recall: 0.2
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_14.xls...
Done.
Epoch: 14
Starting...
CM: [[52  8]
 [14  1]]
F1: 0.08333333333333334
AUC: 0.18222222222222223
Accuracy: 0.7066666666666667
Precision: 0.1111111111111111
Recall: 0.06666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_14.xls...
Done.
Epoch: 15
Starting...
CM: [[11 49]
 [ 0 15]]
F1: 0.379746835443038
AUC: 0.6171875
Accuracy: 0.3466666666666667
Precision: 0.234375
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_15.xls...
Done.
Epoch: 15
Starting...
CM: [[17 43]
 [ 1 14]]
F1: 0.38888888888888884
AUC: 0.596140350877193
Accuracy: 0.41333333333333333
Precision: 0.24561403508771928
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_15.xls...
Done.
Epoch: 15
Starting...
CM: [[25 35]
 [ 1 14]]
F1: 0.43749999999999994
AUC: 0.6161904761904762
Accuracy: 0.52
Precision: 0.2857142857142857
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_15.xls...
Done.
Epoch: 80
Starting...
CM: [[16 44]
 [ 6  9]]
F1: 0.2647058823529412
AUC: 0.4249056603773585
Accuracy: 0.3333333333333333
Precision: 0.16981132075471697
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[39 21]
 [10  5]]
F1: 0.2439024390243902
AUC: 0.32948717948717954
Accuracy: 0.5866666666666667
Precision: 0.19230769230769232
Recall: 0.3333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[47 13]
 [14  1]]
F1: 0.0689655172413793
AUC: 0.1623809523809524
Accuracy: 0.64
Precision: 0.07142857142857142
Recall: 0.06666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_80.xls...
Done.
Epoch: 9
Starting...
CM: [[36 24]
 [ 7  8]]
F1: 0.3404255319148936
AUC: 0.43833333333333335
Accuracy: 0.5866666666666667
Precision: 0.25
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_9.xls...
Done.
Epoch: 9
Starting...
CM: [[49 11]
 [13  2]]
F1: 0.14285714285714288
AUC: 0.23025641025641025
Accuracy: 0.68
Precision: 0.15384615384615385
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_9.xls...
Done.
Epoch: 9
Starting...
CM: [[56  4]
 [15  0]]
F1: 0.0
AUC: 0.1
Accuracy: 0.7466666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/validation_sheet_9.xls...
Done.
wandb: Waiting for W&B process to finish, PID 13106
wandb: Program ended successfully.
wandb: - 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: \ 0.07MB of 0.08MB uploaded (0.00MB deduped)wandb: | 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: / 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: - 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: \ 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb: | 0.08MB of 0.08MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_110442-2wxubhah/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_110442-2wxubhah/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.89061
wandb:         val_accuracy 0.66728
wandb:             _runtime 22872
wandb:           _timestamp 1621358754
wandb:                _step 306
wandb:           train_loss 0.26805
wandb:             val_loss 1.00948
wandb:           val_recall 0.19266
wandb:        val_precision 0.18421
wandb:               val_f1 0.18834
wandb:              val_auc 0.19475
wandb:                   lr 0.0
wandb:          best_val_f1 0.33846
wandb:    best_val_accuracy 0.52574
wandb:   best_val_precision 0.23488
wandb:      best_val_recall 0.6055
wandb:             best_auc 0.22491
wandb:           best_epoch 15
wandb:           best_bd_f1 0.4375
wandb:          best_bd_auc 0.61619
wandb:     best_bd_accuracy 0.52
wandb:    best_bd_precision 0.28571
wandb:       best_bd_recall 0.93333
wandb:        best_bd_epoch 15
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▂▂▂▂▂▂▂▂▂▃▃▃▃▃▃▅▅▆▆▇▇█▇████████████
wandb:     val_accuracy ████▇███▇█▇█▇▅▁▆▆▇▅▆▆▅▆▅▅▅▅▅▅▅▅▅▄▄▅▅▅▅▄▅
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▇▆▆▆▆▆▆▆▆▆▆▆▆▆▅▅▅▄▃▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▂▁▂▁▁▁▂▁▁▁▁▃▅▂▂▁▄▃▃▅▅▄▆▇▇▇▇█▇█████████
wandb:       val_recall ▁▁▁▁▂▁▁▁▂▁▁▁▁▃█▂▂▁▃▂▂▃▂▃▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:    val_precision ▁▁▁▂▂█▁▂▃▃▂▂▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_f1 ▁▁▁▁▃▁▁▂▄▂▂▂▂▅█▄▄▂▄▄▄▅▃▅▄▅▄▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:          val_auc █▅▁▅▅▂▄▃▅▆▅▅▄▃▅▄▅▅▃▃▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:               lr ████████████████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 13 media file(s), 10 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2150: https://wandb.ai/arachid1/tensorboard-integration/runs/2wxubhah


 See logs at ../../new_cache/conv__2150__05_1103__v29__mod9_nodrp/logs/