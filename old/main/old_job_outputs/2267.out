Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2267
Description:  mixup
2021-06-29 01:02:26.043215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-29 01:02:28.517877: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 01:02:28.518861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-29 01:02:28.568727: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:28.569530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 01:02:28.569570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 01:02:28.573300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 01:02:28.573398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 01:02:28.574555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 01:02:28.574837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 01:02:28.575836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 01:02:28.576766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 01:02:28.576930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 01:02:28.577087: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:28.577940: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:28.578609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2267.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2267__06_0102__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-29 01:02:33.813951: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-29 01:02:33.814245: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:33.815062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-29 01:02:33.815115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 01:02:33.815188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 01:02:33.815213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-29 01:02:33.815248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-29 01:02:33.815289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-29 01:02:33.815316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-29 01:02:33.815340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-29 01:02:33.815363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 01:02:33.815472: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:33.816244: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:33.816960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-29 01:02:33.817008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-29 01:02:34.567883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-29 01:02:34.567940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-29 01:02:34.567952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-29 01:02:34.568241: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:34.569065: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:34.569907: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-29 01:02:34.570639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-06-29 01:02:35.546408: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-29 01:02:35.548085: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-29 01:03:41.069440: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3258
2021-06-29 01:03:51.152005: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3258
2021-06-29 01:04:01.130833: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3258
2021-06-29 01:04:11.186883: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 3258
2021-06-29 01:04:21.000785: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3091 of 3258
2021-06-29 01:04:23.972977: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-06-29 01:04:24.246138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-29 01:04:25.711973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-29 01:04:26.173506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3258
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
204/204 - 135s - loss: 0.2995 - accuracy: 0.8947 - val_loss: 0.2494 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1748384640468309
Validation class accuracies: [1.0, 0.0]
2021-06-29 01:06:05.565882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 3258
2021-06-29 01:06:15.743530: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 3258
2021-06-29 01:06:25.744920: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 3258
2021-06-29 01:06:35.633458: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 3258
2021-06-29 01:06:45.564840: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2678 of 3258
2021-06-29 01:06:55.607186: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3035 of 3258
2021-06-29 01:07:01.185133: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
204/204 - 145s - loss: 0.1229 - accuracy: 0.9374 - val_loss: 0.2549 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1708309653792125
Validation class accuracies: [1.0, 0.0]
2021-06-29 01:08:40.728575: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3258
2021-06-29 01:08:50.778891: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3258
2021-06-29 01:09:00.758217: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3258
2021-06-29 01:09:10.683297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 3258
2021-06-29 01:09:20.621648: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3067 of 3258
2021-06-29 01:09:23.972391: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
204/204 - 130s - loss: 0.0906 - accuracy: 0.9420 - val_loss: 0.2029 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6143777170966179
Validation class accuracies: [1.0, 0.0]
2021-06-29 01:11:00.264494: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3258
2021-06-29 01:11:10.179385: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1407 of 3258
2021-06-29 01:11:20.238106: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3258
2021-06-29 01:11:30.410888: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 3258
2021-06-29 01:11:39.834402: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
204/204 - 132s - loss: 0.0576 - accuracy: 0.9589 - val_loss: 0.2486 - val_accuracy: 0.9202
Confusion matrix: 
 [[534  39]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.244 0.756]]
Validation f1: 55.86
Validation accuracy: 92.02
Validation recall: 75.61
Validation precision: 44.29
Validation AUC: 0.6655009268197384
Validation class accuracies: [0.9319371727748691, 0.7560975609756098]
2021-06-29 01:13:22.868529: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3258
2021-06-29 01:13:33.020497: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3258
2021-06-29 01:13:42.816554: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3258
2021-06-29 01:13:52.868406: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 3258
2021-06-29 01:14:02.838149: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3067 of 3258
2021-06-29 01:14:06.360376: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
204/204 - 131s - loss: 0.0397 - accuracy: 0.9662 - val_loss: 0.1714 - val_accuracy: 0.9283
Confusion matrix: 
 [[539  34]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.244 0.756]]
Validation f1: 58.49
Validation accuracy: 92.83
Validation recall: 75.61
Validation precision: 47.69
Validation AUC: 0.6953754743344676
Validation class accuracies: [0.9406631762652705, 0.7560975609756098]
2021-06-29 01:15:43.015270: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3258
2021-06-29 01:15:53.102050: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3258
2021-06-29 01:16:03.118518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2081 of 3258
2021-06-29 01:16:13.067728: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 3258
2021-06-29 01:16:22.979221: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3227 of 3258
2021-06-29 01:16:23.322125: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
204/204 - 130s - loss: 0.0331 - accuracy: 0.9669 - val_loss: 0.1876 - val_accuracy: 0.9381
Confusion matrix: 
 [[545  28]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.244 0.756]]
Validation f1: 62.00
Validation accuracy: 93.81
Validation recall: 75.61
Validation precision: 52.54
Validation AUC: 0.7349638778868993
Validation class accuracies: [0.9511343804537522, 0.7560975609756098]
2021-06-29 01:18:05.283653: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 3258
2021-06-29 01:18:15.147558: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1025 of 3258
2021-06-29 01:18:25.460249: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1553 of 3258
2021-06-29 01:18:35.458792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1889 of 3258
2021-06-29 01:18:45.268544: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2491 of 3258
2021-06-29 01:18:55.408268: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3003 of 3258
2021-06-29 01:19:00.088468: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 7/65
204/204 - 142s - loss: 0.0217 - accuracy: 0.9733 - val_loss: 0.1717 - val_accuracy: 0.9642
Confusion matrix: 
 [[570   3]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.463 0.537]]
Validation f1: 66.67
Validation accuracy: 96.42
Validation recall: 53.66
Validation precision: 88.00
Validation AUC: 0.710581788143784
Validation class accuracies: [0.9947643979057592, 0.5365853658536586]
2021-06-29 01:20:36.881623: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3258
2021-06-29 01:20:46.878407: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3258
2021-06-29 01:20:56.936333: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3258
2021-06-29 01:21:07.014646: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 3258
2021-06-29 01:21:17.015105: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3243 of 3258
2021-06-29 01:21:17.062438: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 8/65
204/204 - 128s - loss: 0.0224 - accuracy: 0.9730 - val_loss: 0.1754 - val_accuracy: 0.9511
Confusion matrix: 
 [[557  16]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.341 0.659]]
Validation f1: 64.29
Validation accuracy: 95.11
Validation recall: 65.85
Validation precision: 62.79
Validation AUC: 0.6432247845245338
Validation class accuracies: [0.9720767888307156, 0.6585365853658537]
2021-06-29 01:22:54.600655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 3258
2021-06-29 01:23:04.598244: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1025 of 3258
2021-06-29 01:23:14.446282: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1537 of 3258
2021-06-29 01:23:24.636885: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 3258
2021-06-29 01:23:34.589357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 3258
2021-06-29 01:23:44.699443: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2939 of 3258
2021-06-29 01:23:52.729552: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 1 epochs
Epoch 9/65
204/204 - 147s - loss: 0.0227 - accuracy: 0.9684 - val_loss: 0.1502 - val_accuracy: 0.9446
Confusion matrix: 
 [[553  20]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.341 0.659]]
Validation f1: 61.36
Validation accuracy: 94.46
Validation recall: 65.85
Validation precision: 57.45
Validation AUC: 0.6839718621676804
Validation class accuracies: [0.9650959860383944, 0.6585365853658537]
2021-06-29 01:25:30.768426: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3258
2021-06-29 01:25:40.607537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1349 of 3258
2021-06-29 01:25:50.855856: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3258
2021-06-29 01:26:00.764647: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 3258
2021-06-29 01:26:10.730989: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3099 of 3258
2021-06-29 01:26:13.571633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 2 epochs
Epoch 10/65
204/204 - 131s - loss: 0.0232 - accuracy: 0.9696 - val_loss: 0.1413 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.7329499033411323
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
2021-06-29 01:27:51.054889: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3258
2021-06-29 01:28:00.977451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3258
2021-06-29 01:28:11.055112: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1985 of 3258
2021-06-29 01:28:21.025956: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2587 of 3258
2021-06-29 01:28:31.191345: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3035 of 3258
2021-06-29 01:28:36.633427: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 3 epochs
Epoch 11/65
204/204 - 135s - loss: 0.0185 - accuracy: 0.9748 - val_loss: 0.1729 - val_accuracy: 0.9577
Confusion matrix: 
 [[563  10]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.39  0.61 ]]
Validation f1: 65.79
Validation accuracy: 95.77
Validation recall: 60.98
Validation precision: 71.43
Validation AUC: 0.6865791900125339
Validation class accuracies: [0.9825479930191972, 0.6097560975609756]
2021-06-29 01:30:14.777794: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3258
2021-06-29 01:30:24.719881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 3258
2021-06-29 01:30:34.634863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3258
2021-06-29 01:30:44.651297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2571 of 3258
2021-06-29 01:30:54.546717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3083 of 3258
2021-06-29 01:30:57.707404: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 4 epochs
Epoch 12/65
204/204 - 131s - loss: 0.0228 - accuracy: 0.9693 - val_loss: 0.1611 - val_accuracy: 0.9528
Confusion matrix: 
 [[561  12]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.415 0.585]]
Validation f1: 62.34
Validation accuracy: 95.28
Validation recall: 58.54
Validation precision: 66.67
Validation AUC: 0.7005204065845047
Validation class accuracies: [0.9790575916230366, 0.5853658536585366]
2021-06-29 01:32:35.692219: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3258
2021-06-29 01:32:45.567316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3258
2021-06-29 01:32:55.742019: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3258
2021-06-29 01:33:05.504300: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2564 of 3258
2021-06-29 01:33:15.548104: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3099 of 3258
2021-06-29 01:33:18.232295: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 5 epochs
Epoch 13/65
204/204 - 132s - loss: 0.0157 - accuracy: 0.9739 - val_loss: 0.1702 - val_accuracy: 0.9463
Confusion matrix: 
 [[555  18]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.366 0.634]]
Validation f1: 61.18
Validation accuracy: 94.63
Validation recall: 63.41
Validation precision: 59.09
Validation AUC: 0.6685988205575306
Validation class accuracies: [0.9685863874345549, 0.6341463414634146]
2021-06-29 01:34:58.771417: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 3258
2021-06-29 01:35:08.881706: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 929 of 3258
2021-06-29 01:35:18.780381: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1617 of 3258
2021-06-29 01:35:28.794597: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2321 of 3258
2021-06-29 01:35:38.861276: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2891 of 3258
2021-06-29 01:35:45.160638: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 14/65
204/204 - 133s - loss: 0.0176 - accuracy: 0.9715 - val_loss: 0.1816 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.6987393911293064
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
2021-06-29 01:37:21.236794: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3258
2021-06-29 01:37:31.253826: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3258
2021-06-29 01:37:41.189900: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3258
2021-06-29 01:37:51.074618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2726 of 3258
2021-06-29 01:38:00.463783: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 7 epochs
Epoch 15/65
204/204 - 126s - loss: 0.0147 - accuracy: 0.9724 - val_loss: 0.1603 - val_accuracy: 0.9511
Confusion matrix: 
 [[564   9]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.512 0.488]]
Validation f1: 57.14
Validation accuracy: 95.11
Validation recall: 48.78
Validation precision: 68.97
Validation AUC: 0.6401574039183532
Validation class accuracies: [0.9842931937172775, 0.4878048780487805]
2021-06-29 01:39:38.513119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3258
2021-06-29 01:39:48.495945: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 3258
2021-06-29 01:39:58.565122: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1729 of 3258
2021-06-29 01:40:08.439587: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 3258
2021-06-29 01:40:18.450763: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 3258
2021-06-29 01:40:28.360260: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3108 of 3258
2021-06-29 01:40:31.953802: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 8 epochs
Epoch 16/65
204/204 - 142s - loss: 0.0162 - accuracy: 0.9702 - val_loss: 0.1727 - val_accuracy: 0.9544
Confusion matrix: 
 [[565   8]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.488 0.512]]
Validation f1: 60.00
Validation accuracy: 95.44
Validation recall: 51.22
Validation precision: 72.41
Validation AUC: 0.6745401612379196
Validation class accuracies: [0.9860383944153578, 0.5121951219512195]
2021-06-29 01:42:09.343371: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3258
2021-06-29 01:42:19.355435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3258
2021-06-29 01:42:29.376938: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2129 of 3258
2021-06-29 01:42:39.245784: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 3258
2021-06-29 01:42:48.438121: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 9 epochs
Epoch 17/65
204/204 - 126s - loss: 0.0166 - accuracy: 0.9687 - val_loss: 0.1508 - val_accuracy: 0.9544
Confusion matrix: 
 [[561  12]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.39  0.61 ]]
Validation f1: 64.10
Validation accuracy: 95.44
Validation recall: 60.98
Validation precision: 67.57
Validation AUC: 0.716990406550457
Validation class accuracies: [0.9790575916230366, 0.6097560975609756]
2021-06-29 01:44:24.389198: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3258
2021-06-29 01:44:34.418227: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3258
2021-06-29 01:44:44.292957: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3258
2021-06-29 01:44:54.295944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 3258
2021-06-29 01:45:04.274221: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3133 of 3258
2021-06-29 01:45:07.404633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 10 epochs
Epoch 18/65
204/204 - 131s - loss: 0.0181 - accuracy: 0.9675 - val_loss: 0.1760 - val_accuracy: 0.9430
Confusion matrix: 
 [[552  21]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.341 0.659]]
Validation f1: 60.67
Validation accuracy: 94.30
Validation recall: 65.85
Validation precision: 56.25
Validation AUC: 0.6992350535270789
Validation class accuracies: [0.9633507853403142, 0.6585365853658537]
2021-06-29 01:46:44.543043: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3258
2021-06-29 01:46:54.590195: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1393 of 3258
2021-06-29 01:47:04.752892: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3258
2021-06-29 01:47:14.802882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 3258
2021-06-29 01:47:24.219575: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 11 epochs
Epoch 19/65
204/204 - 126s - loss: 0.0157 - accuracy: 0.9718 - val_loss: 0.1813 - val_accuracy: 0.9414
Confusion matrix: 
 [[550  23]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.317 0.683]]
Validation f1: 60.87
Validation accuracy: 94.14
Validation recall: 68.29
Validation precision: 54.90
Validation AUC: 0.691213302764233
Validation class accuracies: [0.9598603839441536, 0.6829268292682927]
2021-06-29 01:49:00.176231: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 689 of 3258
2021-06-29 01:49:10.295353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 3258
2021-06-29 01:49:20.194190: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3258
2021-06-29 01:49:30.315861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 3258
2021-06-29 01:49:39.539323: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 20/65
204/204 - 128s - loss: 0.0169 - accuracy: 0.9745 - val_loss: 0.1633 - val_accuracy: 0.9511
Confusion matrix: 
 [[557  16]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 64.29
Validation accuracy: 95.11
Validation recall: 65.85
Validation precision: 62.79
Validation AUC: 0.6957138176651099
Validation class accuracies: [0.9720767888307156, 0.6585365853658537]
2021-06-29 01:51:20.257003: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 3258
2021-06-29 01:51:30.522896: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3258
2021-06-29 01:51:40.243102: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 3258
2021-06-29 01:51:50.256596: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3258
2021-06-29 01:52:00.348687: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2827 of 3258
2021-06-29 01:52:07.724448: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 13 epochs
Epoch 21/65
204/204 - 135s - loss: 0.0166 - accuracy: 0.9711 - val_loss: 0.1594 - val_accuracy: 0.9544
Confusion matrix: 
 [[559  14]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.341 0.659]]
Validation f1: 65.85
Validation accuracy: 95.44
Validation recall: 65.85
Validation precision: 65.85
Validation AUC: 0.7075389135253465
Validation class accuracies: [0.9755671902268761, 0.6585365853658537]
2021-06-29 01:53:44.139823: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3258
2021-06-29 01:53:54.188151: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3258
2021-06-29 01:54:04.007093: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2113 of 3258
2021-06-29 01:54:13.998031: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2741 of 3258
2021-06-29 01:54:23.067289: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 14 epochs
Epoch 22/65
204/204 - 126s - loss: 0.0145 - accuracy: 0.9721 - val_loss: 0.1556 - val_accuracy: 0.9560
Confusion matrix: 
 [[560  13]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.341 0.659]]
Validation f1: 66.67
Validation accuracy: 95.60
Validation recall: 65.85
Validation precision: 67.50
Validation AUC: 0.7043998077002865
Validation class accuracies: [0.9773123909249564, 0.6585365853658537]
2021-06-29 01:55:59.513877: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3258
2021-06-29 01:56:09.461884: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3258
2021-06-29 01:56:19.299674: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 3258
2021-06-29 01:56:29.299418: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3258
2021-06-29 01:56:39.393133: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2907 of 3258
2021-06-29 01:56:45.922669: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 15 epochs
Epoch 23/65
204/204 - 133s - loss: 0.0134 - accuracy: 0.9724 - val_loss: 0.1708 - val_accuracy: 0.9397
Confusion matrix: 
 [[550  23]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.341 0.659]]
Validation f1: 59.34
Validation accuracy: 93.97
Validation recall: 65.85
Validation precision: 54.00
Validation AUC: 0.7008313438706486
Validation class accuracies: [0.9598603839441536, 0.6585365853658537]
2021-06-29 01:58:20.803983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3258
2021-06-29 01:58:30.822143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3258
2021-06-29 01:58:40.636321: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 3258
2021-06-29 01:58:50.627125: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2811 of 3258
2021-06-29 01:58:58.074481: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 16 epochs
Epoch 24/65
204/204 - 125s - loss: 0.0182 - accuracy: 0.9742 - val_loss: 0.1674 - val_accuracy: 0.9479
Confusion matrix: 
 [[556  17]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.366 0.634]]
Validation f1: 61.90
Validation accuracy: 94.79
Validation recall: 63.41
Validation precision: 60.47
Validation AUC: 0.6980867776330444
Validation class accuracies: [0.9703315881326352, 0.6341463414634146]
2021-06-29 02:00:34.328556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 3258
2021-06-29 02:00:44.355324: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3258
2021-06-29 02:00:54.313572: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 3258
2021-06-29 02:01:04.326013: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 3258
2021-06-29 02:01:12.322039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 17 epochs
Epoch 25/65
204/204 - 125s - loss: 0.0152 - accuracy: 0.9702 - val_loss: 0.1555 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.715760407608189
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
2021-06-29 02:02:48.724344: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 3258
2021-06-29 02:02:58.641492: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3258
2021-06-29 02:03:08.638885: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 3258
2021-06-29 02:03:18.631696: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2795 of 3258
2021-06-29 02:03:26.489795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 26/65
204/204 - 126s - loss: 0.0130 - accuracy: 0.9754 - val_loss: 0.1523 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.7246203438355315
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
2021-06-29 02:05:03.030380: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 3258
2021-06-29 02:05:12.992341: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1457 of 3258
2021-06-29 02:05:22.980756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2209 of 3258
2021-06-29 02:05:33.036599: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2827 of 3258
2021-06-29 02:05:40.071215: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6666666666666667 hasn't increased by 0 in 19 epochs
Epoch 27/65
204/204 - 124s - loss: 0.0132 - accuracy: 0.9727 - val_loss: 0.1560 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.7213770429824634
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]

The metrics for job 0 with the best target metric are: 
Best cm: [[570   3]
 [ 19  22]]
Best normalized cm: [[0.995 0.005]
 [0.463 0.537]]
Best f1: 0.67
Best accuracy: 0.96
Best recall: 0.54
Best precision: 0.88
Best AUC: 0.71
Best class accuracies: [0.9947643979057592, 0.5365853658536586]
Best epoch: 7
The number of epochs since last 1% equals the patience
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[4.308e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.047]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[2.657e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[1.776e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.506]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.913e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[9.667e-06]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[3.488e-06]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[7.853e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[3.589e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[5.24e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[3.309e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[6.833e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.018]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.225]]
../../new_cache/conv__2267__06_0102__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.115]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 951
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_010228-e9oso0ih/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_010228-e9oso0ih/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.97268
wandb:         val_accuracy 0.94788
wandb:             _runtime 3877
wandb:           _timestamp 1624932425
wandb:                _step 200
wandb:           train_loss 0.01316
wandb:             val_loss 0.15604
wandb:           val_recall 0.65854
wandb:        val_precision 0.6
wandb:               val_f1 0.62791
wandb:              val_auc 0.72138
wandb:                   lr 0.00013
wandb:          best_val_f1 0.66667
wandb:    best_val_accuracy 0.96417
wandb:   best_val_precision 0.88
wandb:      best_val_recall 0.53659
wandb:             best_auc 0.71058
wandb:           best_epoch 7
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_010228-e9oso0ih

-----------------------
model 9 with 2000 mixup quantity
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 4458
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_2 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 128, 1250, 1)    4            input_2[0][0]                        
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d_5[0][0]                       
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_7[0][0]                       
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate_38295 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_6[0][0]                       
                                                                         conv2d_8[0][0]                       
                                                                         conv2d_9[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling (None, 64, 625, 48)     0            concatenate_38295[0][0]              
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d_5[0][0]            
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_6[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_6[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_7[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_7[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_8[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_8[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_9[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_9[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_10[0][0]         
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalA (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 1)               513          global_average_pooling2d_1[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-29 02:09:02.208978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4458
2021-06-29 02:09:12.081144: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 4458
2021-06-29 02:09:22.066485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 4458
2021-06-29 02:09:32.126169: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2875 of 4458
2021-06-29 02:09:42.111874: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3467 of 4458
2021-06-29 02:09:52.242500: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4075 of 4458
2021-06-29 02:09:58.472281: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Epoch 1/65
279/279 - 485s - loss: 0.3183 - accuracy: 0.8782 - val_loss: 0.2452 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23516789123513046
Validation class accuracies: [1.0, 0.0]
2021-06-29 02:17:21.433299: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4458
2021-06-29 02:17:31.301427: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1507 of 4458
2021-06-29 02:17:41.478474: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4458
2021-06-29 02:17:51.513030: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2891 of 4458
2021-06-29 02:18:01.320190: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3485 of 4458
2021-06-29 02:18:11.468941: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4091 of 4458
2021-06-29 02:18:17.425212: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
279/279 - 481s - loss: 0.1720 - accuracy: 0.9053 - val_loss: 0.2133 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.47959663174287115
Validation class accuracies: [1.0, 0.0]
2021-06-29 02:25:36.490411: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4458
2021-06-29 02:25:46.626788: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1537 of 4458
2021-06-29 02:25:56.524082: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 4458
2021-06-29 02:26:06.558739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2907 of 4458
2021-06-29 02:26:16.512898: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3499 of 4458
2021-06-29 02:26:26.474697: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4091 of 4458
2021-06-29 02:26:32.521366: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
279/279 - 480s - loss: 0.1492 - accuracy: 0.9121 - val_loss: 0.1816 - val_accuracy: 0.9430
Confusion matrix: 
 [[572   1]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.829 0.171]]
Validation f1: 28.57
Validation accuracy: 94.30
Validation recall: 17.07
Validation precision: 87.50
Validation AUC: 0.5302937273341596
Validation class accuracies: [0.9982547993019197, 0.17073170731707318]
2021-06-29 02:33:51.214525: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4458
2021-06-29 02:34:01.256047: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1521 of 4458
2021-06-29 02:34:11.220665: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4458
2021-06-29 02:34:21.202036: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2891 of 4458
2021-06-29 02:34:31.365927: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3499 of 4458
2021-06-29 02:34:41.241132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4091 of 4458
2021-06-29 02:34:47.103412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
279/279 - 480s - loss: 0.1275 - accuracy: 0.9181 - val_loss: 0.2564 - val_accuracy: 0.9463
Confusion matrix: 
 [[567   6]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.659 0.341]]
Validation f1: 45.90
Validation accuracy: 94.63
Validation recall: 34.15
Validation precision: 70.00
Validation AUC: 0.5502810320608128
Validation class accuracies: [0.9895287958115183, 0.34146341463414637]
2021-06-29 02:42:06.135037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4458
2021-06-29 02:42:16.055403: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4458
2021-06-29 02:42:26.050631: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4458
2021-06-29 02:42:36.025445: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2843 of 4458
2021-06-29 02:42:46.025431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3445 of 4458
2021-06-29 02:42:56.191290: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4043 of 4458
2021-06-29 02:43:02.912704: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 5/65
279/279 - 481s - loss: 0.1103 - accuracy: 0.9266 - val_loss: 0.2101 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
Validation f1: 56.84
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.5855649493126904
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
2021-06-29 02:50:21.607373: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4458
2021-06-29 02:50:31.686570: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 4458
2021-06-29 02:50:41.574629: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2241 of 4458
2021-06-29 02:50:51.728045: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2875 of 4458
2021-06-29 02:51:01.674409: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3467 of 4458
2021-06-29 02:51:11.584333: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4059 of 4458
2021-06-29 02:51:18.019944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 6/65
279/279 - 481s - loss: 0.1039 - accuracy: 0.9280 - val_loss: 0.2817 - val_accuracy: 0.8860
Confusion matrix: 
 [[521  52]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.439 0.561]]
Validation f1: 39.66
Validation accuracy: 88.60
Validation recall: 56.10
Validation precision: 30.67
Validation AUC: 0.5945021143687561
Validation class accuracies: [0.9092495636998255, 0.5609756097560976]
2021-06-29 02:58:37.153031: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 737 of 4458
2021-06-29 02:58:47.181770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1489 of 4458
2021-06-29 02:58:57.273553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 4458
2021-06-29 02:59:07.189741: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2875 of 4458
2021-06-29 02:59:17.359174: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3483 of 4458
2021-06-29 02:59:27.276920: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4075 of 4458
2021-06-29 02:59:33.392210: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 1 epochs
Epoch 7/65
279/279 - 481s - loss: 0.0824 - accuracy: 0.9298 - val_loss: 0.6395 - val_accuracy: 0.7720
Confusion matrix: 
 [[439 134]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.766 0.234]
 [0.146 0.854]]
Validation f1: 33.33
Validation accuracy: 77.20
Validation recall: 85.37
Validation precision: 20.71
Validation AUC: 0.5454712790722286
Validation class accuracies: [0.7661431064572426, 0.8536585365853658]
2021-06-29 03:06:52.131260: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4458
2021-06-29 03:07:02.111712: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 4458
2021-06-29 03:07:12.168537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4458
2021-06-29 03:07:22.175397: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2891 of 4458
2021-06-29 03:07:32.058650: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3483 of 4458
2021-06-29 03:07:42.205686: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4091 of 4458
2021-06-29 03:07:48.125327: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 2 epochs
Epoch 8/65
279/279 - 481s - loss: 0.0656 - accuracy: 0.9397 - val_loss: 0.3229 - val_accuracy: 0.8876
Confusion matrix: 
 [[519  54]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.366 0.634]]
Validation f1: 42.98
Validation accuracy: 88.76
Validation recall: 63.41
Validation precision: 32.50
Validation AUC: 0.4731842388571348
Validation class accuracies: [0.9057591623036649, 0.6341463414634146]
2021-06-29 03:15:07.255259: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 753 of 4458
2021-06-29 03:15:17.138637: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1505 of 4458
2021-06-29 03:15:27.124232: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 4458
2021-06-29 03:15:37.100843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2875 of 4458
2021-06-29 03:15:47.035361: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3480 of 4458
2021-06-29 03:15:57.090602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4075 of 4458
2021-06-29 03:16:03.251256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 3 epochs
Epoch 9/65
279/279 - 481s - loss: 0.0823 - accuracy: 0.9320 - val_loss: 0.4565 - val_accuracy: 0.8599
Confusion matrix: 
 [[496  77]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.866 0.134]
 [0.22  0.78 ]]
Validation f1: 42.67
Validation accuracy: 85.99
Validation recall: 78.05
Validation precision: 29.36
Validation AUC: 0.5684953311202249
Validation class accuracies: [0.8656195462478184, 0.7804878048780488]
2021-06-29 03:23:23.262610: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 4458
2021-06-29 03:23:33.129776: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 4458
2021-06-29 03:23:43.134519: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 4458
2021-06-29 03:23:53.209775: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 4458
2021-06-29 03:24:03.198389: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3163 of 4458
2021-06-29 03:24:13.171687: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3707 of 4458
2021-06-29 03:24:23.073628: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4091 of 4458
2021-06-29 03:24:32.373665: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 4 epochs
Epoch 10/65
279/279 - 495s - loss: 0.0636 - accuracy: 0.9372 - val_loss: 0.2796 - val_accuracy: 0.9283
Confusion matrix: 
 [[545  28]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.39  0.61 ]]
Validation f1: 53.19
Validation accuracy: 92.83
Validation recall: 60.98
Validation precision: 47.17
Validation AUC: 0.5097740302073729
Validation class accuracies: [0.9511343804537522, 0.6097560975609756]
2021-06-29 03:31:53.799916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4458
2021-06-29 03:32:03.782208: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4458
2021-06-29 03:32:13.747460: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4458
2021-06-29 03:32:23.893948: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 4458
2021-06-29 03:32:33.675246: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3323 of 4458
2021-06-29 03:32:43.813568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3899 of 4458
2021-06-29 03:32:53.369756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 5 epochs
Epoch 11/65
279/279 - 485s - loss: 0.0627 - accuracy: 0.9379 - val_loss: 0.6445 - val_accuracy: 0.8192
Confusion matrix: 
 [[474  99]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.827 0.173]
 [0.293 0.707]]
Validation f1: 34.32
Validation accuracy: 81.92
Validation recall: 70.73
Validation precision: 22.66
Validation AUC: 0.4068922632076966
Validation class accuracies: [0.8272251308900523, 0.7073170731707317]
2021-06-29 03:40:12.971681: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 4458
2021-06-29 03:40:22.788949: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1217 of 4458
2021-06-29 03:40:32.905423: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1793 of 4458
2021-06-29 03:40:42.921937: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2369 of 4458
2021-06-29 03:40:52.823158: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2779 of 4458
2021-06-29 03:41:02.719485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3183 of 4458
2021-06-29 03:41:12.923207: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3595 of 4458
2021-06-29 03:41:22.782784: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3995 of 4458
2021-06-29 03:41:33.052369: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4411 of 4458
2021-06-29 03:41:33.828287: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 12/65
279/279 - 506s - loss: 0.0360 - accuracy: 0.9455 - val_loss: 0.5235 - val_accuracy: 0.8681
Confusion matrix: 
 [[505  68]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.317 0.683]]
Validation f1: 40.88
Validation accuracy: 86.81
Validation recall: 68.29
Validation precision: 29.17
Validation AUC: 0.5460711433584832
Validation class accuracies: [0.881326352530541, 0.6829268292682927]
2021-06-29 03:48:54.421403: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4458
2021-06-29 03:49:04.261636: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4458
2021-06-29 03:49:14.388095: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1537 of 4458
2021-06-29 03:49:24.340455: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 4458
2021-06-29 03:49:34.241925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2843 of 4458
2021-06-29 03:49:44.281277: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3419 of 4458
2021-06-29 03:49:54.394757: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3995 of 4458
2021-06-29 03:50:02.428293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 7 epochs
Epoch 13/65
279/279 - 493s - loss: 0.0360 - accuracy: 0.9477 - val_loss: 0.2469 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.5954821417674899
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
2021-06-29 03:57:21.542331: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4458
2021-06-29 03:57:31.521213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4458
2021-06-29 03:57:41.366532: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4458
2021-06-29 03:57:51.421881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2731 of 4458
2021-06-29 03:58:01.399553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3147 of 4458
2021-06-29 03:58:11.578860: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3563 of 4458
2021-06-29 03:58:21.425664: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3947 of 4458
2021-06-29 03:58:31.692154: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4379 of 4458
2021-06-29 03:58:33.261168: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 8 epochs
Epoch 14/65
279/279 - 497s - loss: 0.0291 - accuracy: 0.9455 - val_loss: 0.2627 - val_accuracy: 0.9446
Confusion matrix: 
 [[558  15]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.463 0.537]]
Validation f1: 56.41
Validation accuracy: 94.46
Validation recall: 53.66
Validation precision: 59.46
Validation AUC: 0.5938355714566494
Validation class accuracies: [0.9738219895287958, 0.5365853658536586]
2021-06-29 04:05:54.117926: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4458
2021-06-29 04:06:04.255543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1169 of 4458
2021-06-29 04:06:14.160051: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4458
2021-06-29 04:06:24.233398: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4458
2021-06-29 04:06:34.310143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2763 of 4458
2021-06-29 04:06:44.305687: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3179 of 4458
2021-06-29 04:06:54.300841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3483 of 4458
2021-06-29 04:07:04.095147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3961 of 4458
2021-06-29 04:07:12.875557: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 9 epochs
Epoch 15/65
279/279 - 504s - loss: 0.0338 - accuracy: 0.9459 - val_loss: 0.2839 - val_accuracy: 0.9039
Confusion matrix: 
 [[525  48]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.268 0.732]]
Validation f1: 50.42
Validation accuracy: 90.39
Validation recall: 73.17
Validation precision: 38.46
Validation AUC: 0.5670345158283373
Validation class accuracies: [0.9162303664921466, 0.7317073170731707]
2021-06-29 04:14:34.852931: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4458
2021-06-29 04:14:44.661294: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4458
2021-06-29 04:14:54.690135: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4458
2021-06-29 04:15:04.700460: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2773 of 4458
2021-06-29 04:15:14.708913: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3339 of 4458
2021-06-29 04:15:24.809140: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3915 of 4458
2021-06-29 04:15:34.100910: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5684210526315789 hasn't increased by 0 in 10 epochs
Epoch 16/65
279/279 - 484s - loss: 0.0292 - accuracy: 0.9453 - val_loss: 0.2833 - val_accuracy: 0.9479
Confusion matrix: 
 [[559  14]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.439 0.561]]
Validation f1: 58.97
Validation accuracy: 94.79
Validation recall: 56.10
Validation precision: 62.16
Validation AUC: 0.5682417630469959
Validation class accuracies: [0.9755671902268761, 0.5609756097560976]
2021-06-29 04:22:53.577126: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 673 of 4458
2021-06-29 04:23:03.494899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 4458
2021-06-29 04:23:13.681622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1825 of 4458
2021-06-29 04:23:23.665230: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 4458
2021-06-29 04:23:33.785649: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2811 of 4458
2021-06-29 04:23:43.920801: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3227 of 4458
2021-06-29 04:23:53.825075: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3627 of 4458
2021-06-29 04:24:03.600625: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4027 of 4458
2021-06-29 04:24:13.701696: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4443 of 4458
2021-06-29 04:24:13.705474: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 17/65
279/279 - 505s - loss: 0.0318 - accuracy: 0.9453 - val_loss: 0.2979 - val_accuracy: 0.9169
Confusion matrix: 
 [[536  37]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.341 0.659]]
Validation f1: 51.43
Validation accuracy: 91.69
Validation recall: 65.85
Validation precision: 42.19
Validation AUC: 0.5458118882898069
Validation class accuracies: [0.9354275741710296, 0.6585365853658537]
2021-06-29 04:31:34.176413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4458
2021-06-29 04:31:44.275866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 4458
2021-06-29 04:31:54.361794: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1569 of 4458
2021-06-29 04:32:04.203194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4458
2021-06-29 04:32:14.145037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2869 of 4458
2021-06-29 04:32:24.198907: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3435 of 4458
2021-06-29 04:32:34.147354: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4005 of 4458
2021-06-29 04:32:42.001262: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 1 epochs
Epoch 18/65
279/279 - 493s - loss: 0.0315 - accuracy: 0.9491 - val_loss: 0.2984 - val_accuracy: 0.9007
Confusion matrix: 
 [[526  47]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.341 0.659]]
Validation f1: 46.96
Validation accuracy: 90.07
Validation recall: 65.85
Validation precision: 36.49
Validation AUC: 0.5979883296295434
Validation class accuracies: [0.9179755671902269, 0.6585365853658537]
2021-06-29 04:40:01.150986: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4458
2021-06-29 04:40:11.270371: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4458
2021-06-29 04:40:21.272552: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2161 of 4458
2021-06-29 04:40:31.286642: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 4458
2021-06-29 04:40:41.212766: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3099 of 4458
2021-06-29 04:40:51.117930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3499 of 4458
2021-06-29 04:41:01.153274: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3915 of 4458
2021-06-29 04:41:10.994715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 2 epochs
Epoch 19/65
279/279 - 495s - loss: 0.0306 - accuracy: 0.9473 - val_loss: 0.3239 - val_accuracy: 0.9007
Confusion matrix: 
 [[525  48]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.317 0.683]]
Validation f1: 47.86
Validation accuracy: 90.07
Validation recall: 68.29
Validation precision: 36.84
Validation AUC: 0.5738244002889894
Validation class accuracies: [0.9162303664921466, 0.6829268292682927]
2021-06-29 04:48:32.622816: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 4458
2021-06-29 04:48:42.553928: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 4458
2021-06-29 04:48:52.451569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2049 of 4458
2021-06-29 04:49:02.465046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 4458
2021-06-29 04:49:12.435514: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3259 of 4458
2021-06-29 04:49:22.551881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3835 of 4458
2021-06-29 04:49:32.486402: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4395 of 4458
2021-06-29 04:49:33.330674: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 3 epochs
Epoch 20/65
279/279 - 486s - loss: 0.0295 - accuracy: 0.9430 - val_loss: 0.3057 - val_accuracy: 0.9218
Confusion matrix: 
 [[538  35]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.317 0.683]]
Validation f1: 53.85
Validation accuracy: 92.18
Validation recall: 68.29
Validation precision: 44.44
Validation AUC: 0.5408682805866084
Validation class accuracies: [0.9389179755671903, 0.6829268292682927]
2021-06-29 04:56:52.267431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4458
2021-06-29 04:57:02.193352: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 4458
2021-06-29 04:57:12.398884: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 4458
2021-06-29 04:57:22.360292: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2507 of 4458
2021-06-29 04:57:32.390831: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2923 of 4458
2021-06-29 04:57:42.295837: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3323 of 4458
2021-06-29 04:57:52.498590: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3739 of 4458
2021-06-29 04:58:02.200570: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4139 of 4458
2021-06-29 04:58:09.597869: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 4 epochs
Epoch 21/65
279/279 - 503s - loss: 0.0298 - accuracy: 0.9482 - val_loss: 0.2961 - val_accuracy: 0.9283
Confusion matrix: 
 [[541  32]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.293 0.707]]
Validation f1: 56.86
Validation accuracy: 92.83
Validation recall: 70.73
Validation precision: 47.54
Validation AUC: 0.5318399966919793
Validation class accuracies: [0.944153577661431, 0.7073170731707317]
2021-06-29 05:05:30.042849: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4458
2021-06-29 05:05:39.892466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4458
2021-06-29 05:05:49.990417: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4458
2021-06-29 05:06:00.047341: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4458
2021-06-29 05:06:10.110342: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 4458
2021-06-29 05:06:20.003822: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3195 of 4458
2021-06-29 05:06:30.024135: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3771 of 4458
2021-06-29 05:06:39.861112: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4331 of 4458
2021-06-29 05:06:41.856717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 5 epochs
Epoch 22/65
279/279 - 498s - loss: 0.0315 - accuracy: 0.9450 - val_loss: 0.3170 - val_accuracy: 0.9121
Confusion matrix: 
 [[536  37]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.415 0.585]]
Validation f1: 47.06
Validation accuracy: 91.21
Validation recall: 58.54
Validation precision: 39.34
Validation AUC: 0.49493730839917993
Validation class accuracies: [0.9354275741710296, 0.5853658536585366]
2021-06-29 05:14:02.350147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 721 of 4458
2021-06-29 05:14:12.154778: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 4458
2021-06-29 05:14:22.209287: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2177 of 4458
2021-06-29 05:14:32.234137: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2795 of 4458
2021-06-29 05:14:42.177335: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3365 of 4458
2021-06-29 05:14:52.164264: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3805 of 4458
2021-06-29 05:15:02.379137: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4219 of 4458
2021-06-29 05:15:08.107493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
279/279 - 491s - loss: 0.0279 - accuracy: 0.9450 - val_loss: 0.3491 - val_accuracy: 0.8730
Confusion matrix: 
 [[506  67]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.268 0.732]]
Validation f1: 43.48
Validation accuracy: 87.30
Validation recall: 73.17
Validation precision: 30.93
Validation AUC: 0.4218234705699298
Validation class accuracies: [0.8830715532286213, 0.7317073170731707]
2021-06-29 05:22:27.958909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4458
2021-06-29 05:22:38.095246: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4458
2021-06-29 05:22:48.117433: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 4458
2021-06-29 05:22:58.104121: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4458
2021-06-29 05:23:08.151415: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2763 of 4458
2021-06-29 05:23:18.057735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3163 of 4458
2021-06-29 05:23:28.199108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3579 of 4458
2021-06-29 05:23:37.917046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3979 of 4458
2021-06-29 05:23:48.009412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4331 of 4458
2021-06-29 05:23:51.721678: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 7 epochs
Epoch 24/65
279/279 - 509s - loss: 0.0316 - accuracy: 0.9446 - val_loss: 0.3041 - val_accuracy: 0.9121
Confusion matrix: 
 [[535  38]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.39  0.61 ]]
Validation f1: 48.08
Validation accuracy: 91.21
Validation recall: 60.98
Validation precision: 39.68
Validation AUC: 0.4961722742272526
Validation class accuracies: [0.9336823734729494, 0.6097560975609756]
2021-06-29 05:31:12.181299: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 449 of 4458
2021-06-29 05:31:21.920537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1025 of 4458
2021-06-29 05:31:31.958986: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 4458
2021-06-29 05:31:42.183718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2475 of 4458
2021-06-29 05:31:51.994948: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3035 of 4458
2021-06-29 05:32:02.108078: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3611 of 4458
2021-06-29 05:32:12.092884: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4187 of 4458
2021-06-29 05:32:16.570431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 8 epochs
Epoch 25/65
279/279 - 490s - loss: 0.0246 - accuracy: 0.9486 - val_loss: 0.4484 - val_accuracy: 0.8746
Confusion matrix: 
 [[509  64]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.317 0.683]]
Validation f1: 42.11
Validation accuracy: 87.46
Validation recall: 68.29
Validation precision: 30.43
Validation AUC: 0.40089900568065934
Validation class accuracies: [0.8883071553228621, 0.6829268292682927]
2021-06-29 05:39:35.984789: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4458
2021-06-29 05:39:46.014273: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 4458
2021-06-29 05:39:56.167970: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2081 of 4458
2021-06-29 05:40:05.911327: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2555 of 4458
2021-06-29 05:40:16.159341: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2955 of 4458
2021-06-29 05:40:26.225359: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3371 of 4458
2021-06-29 05:40:35.958413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3771 of 4458
2021-06-29 05:40:46.111579: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4187 of 4458
2021-06-29 05:40:52.429682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 9 epochs
Epoch 26/65
279/279 - 502s - loss: 0.0290 - accuracy: 0.9448 - val_loss: 0.2828 - val_accuracy: 0.9072
Confusion matrix: 
 [[529  44]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.317 0.683]]
Validation f1: 49.56
Validation accuracy: 90.72
Validation recall: 68.29
Validation precision: 38.89
Validation AUC: 0.519150113156588
Validation class accuracies: [0.9232111692844677, 0.6829268292682927]
2021-06-29 05:48:13.146926: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 4458
2021-06-29 05:48:23.023735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1153 of 4458
2021-06-29 05:48:33.272013: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1761 of 4458
2021-06-29 05:48:43.049578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2337 of 4458
2021-06-29 05:48:53.013608: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2699 of 4458
2021-06-29 05:49:03.014216: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3051 of 4458
2021-06-29 05:49:13.207148: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3643 of 4458
2021-06-29 05:49:23.015367: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4203 of 4458
2021-06-29 05:49:27.287026: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 10 epochs
Epoch 27/65
279/279 - 499s - loss: 0.0263 - accuracy: 0.9484 - val_loss: 0.2617 - val_accuracy: 0.9235
Confusion matrix: 
 [[540  33]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.341 0.659]]
Validation f1: 53.47
Validation accuracy: 92.35
Validation recall: 65.85
Validation precision: 45.00
Validation AUC: 0.5626379574677586
Validation class accuracies: [0.9424083769633508, 0.6585365853658537]
2021-06-29 05:56:49.445282: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 4458
2021-06-29 05:56:59.463810: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1265 of 4458
2021-06-29 05:57:09.411755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 4458
2021-06-29 05:57:19.252266: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2541 of 4458
2021-06-29 05:57:29.256704: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3079 of 4458
2021-06-29 05:57:39.388380: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3579 of 4458
2021-06-29 05:57:49.368167: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4091 of 4458
2021-06-29 05:57:56.206662: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 11 epochs
Epoch 28/65
279/279 - 492s - loss: 0.0248 - accuracy: 0.9498 - val_loss: 0.5203 - val_accuracy: 0.8388
Confusion matrix: 
 [[481  92]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.171 0.829]]
Validation f1: 40.72
Validation accuracy: 83.88
Validation recall: 82.93
Validation precision: 26.98
Validation AUC: 0.41888397644605985
Validation class accuracies: [0.8394415357766143, 0.8292682926829268]
2021-06-29 06:05:15.791621: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 4458
2021-06-29 06:05:25.728291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 4458
2021-06-29 06:05:35.841240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2033 of 4458
2021-06-29 06:05:45.758211: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2539 of 4458
2021-06-29 06:05:56.022098: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2955 of 4458
2021-06-29 06:06:05.784970: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3323 of 4458
2021-06-29 06:06:15.760940: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3708 of 4458
2021-06-29 06:06:25.850892: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4107 of 4458
2021-06-29 06:06:34.529670: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 29/65
279/279 - 503s - loss: 0.0268 - accuracy: 0.9495 - val_loss: 0.3028 - val_accuracy: 0.9153
Confusion matrix: 
 [[533  40]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.293 0.707]]
Validation f1: 52.73
Validation accuracy: 91.53
Validation recall: 70.73
Validation precision: 42.03
Validation AUC: 0.5289926838001012
Validation class accuracies: [0.9301919720767888, 0.7073170731707317]
2021-06-29 06:13:54.507159: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 4458
2021-06-29 06:14:04.597631: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1089 of 4458
2021-06-29 06:14:14.589573: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1649 of 4458
2021-06-29 06:14:24.503295: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2193 of 4458
2021-06-29 06:14:34.393715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2635 of 4458
2021-06-29 06:14:44.671847: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3035 of 4458
2021-06-29 06:14:54.681271: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3419 of 4458
2021-06-29 06:15:04.788279: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3803 of 4458
2021-06-29 06:15:14.465699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4075 of 4458
2021-06-29 06:15:23.540383: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 13 epochs
Epoch 30/65
279/279 - 515s - loss: 0.0274 - accuracy: 0.9491 - val_loss: 0.3549 - val_accuracy: 0.8746
Confusion matrix: 
 [[509  64]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.317 0.683]]
Validation f1: 42.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 87.46
Validation recall: 68.29
Validation precision: 30.43
Validation AUC: 0.45319333453641114
Validation class accuracies: [0.8883071553228621, 0.6829268292682927]
2021-06-29 06:22:43.511120: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 4458
2021-06-29 06:22:53.620897: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1185 of 4458
2021-06-29 06:23:03.392675: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1713 of 4458
2021-06-29 06:23:13.547232: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 4458
2021-06-29 06:23:23.641674: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 4458
2021-06-29 06:23:33.564892: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3051 of 4458
2021-06-29 06:23:43.702390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3419 of 4458
2021-06-29 06:23:53.505864: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3787 of 4458
2021-06-29 06:24:03.668100: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4171 of 4458
2021-06-29 06:24:12.762781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 14 epochs
Epoch 31/65
279/279 - 515s - loss: 0.0255 - accuracy: 0.9482 - val_loss: 0.2989 - val_accuracy: 0.9039
Confusion matrix: 
 [[526  47]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.57
Validation accuracy: 90.39
Validation recall: 70.73
Validation precision: 38.16
Validation AUC: 0.5264774507733152
Validation class accuracies: [0.9179755671902269, 0.7073170731707317]
2021-06-29 06:31:32.713448: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4458
2021-06-29 06:31:42.567162: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1105 of 4458
2021-06-29 06:31:52.800655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 4458
2021-06-29 06:32:02.637670: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2257 of 4458
2021-06-29 06:32:12.855755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 4458
2021-06-29 06:32:22.772772: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3115 of 4458
2021-06-29 06:32:32.813442: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3515 of 4458
2021-06-29 06:32:42.877796: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3931 of 4458
2021-06-29 06:32:52.815487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4331 of 4458
2021-06-29 06:32:55.594806: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 15 epochs
Epoch 32/65
279/279 - 509s - loss: 0.0227 - accuracy: 0.9475 - val_loss: 0.3082 - val_accuracy: 0.9137
Confusion matrix: 
 [[533  40]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.317 0.683]]
Validation f1: 51.38
Validation accuracy: 91.37
Validation recall: 68.29
Validation precision: 41.18
Validation AUC: 0.5074266347996743
Validation class accuracies: [0.9301919720767888, 0.6829268292682927]
2021-06-29 06:40:16.314070: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4458
2021-06-29 06:40:26.261591: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1073 of 4458
2021-06-29 06:40:36.273484: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1553 of 4458
2021-06-29 06:40:46.320196: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2273 of 4458
2021-06-29 06:40:56.238495: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2860 of 4458
2021-06-29 06:41:06.440320: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3435 of 4458
2021-06-29 06:41:16.474085: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3995 of 4458
2021-06-29 06:41:24.573797: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 16 epochs
Epoch 33/65
279/279 - 493s - loss: 0.0247 - accuracy: 0.9493 - val_loss: 0.3222 - val_accuracy: 0.9072
Confusion matrix: 
 [[528  45]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.293 0.707]]
Validation f1: 50.43
Validation accuracy: 90.72
Validation recall: 70.73
Validation precision: 39.19
Validation AUC: 0.4967466408265996
Validation class accuracies: [0.9214659685863874, 0.7073170731707317]
2021-06-29 06:48:44.038923: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 705 of 4458
2021-06-29 06:48:53.977868: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1409 of 4458
2021-06-29 06:49:03.890108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2097 of 4458
2021-06-29 06:49:14.152534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2683 of 4458
2021-06-29 06:49:24.011322: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3083 of 4458
2021-06-29 06:49:34.164653: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3483 of 4458
2021-06-29 06:49:44.112504: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3867 of 4458
2021-06-29 06:49:54.166344: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4283 of 4458
2021-06-29 06:49:58.194748: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 17 epochs
Epoch 34/65
279/279 - 499s - loss: 0.0220 - accuracy: 0.9513 - val_loss: 0.3492 - val_accuracy: 0.8909
Confusion matrix: 
 [[519  54]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.317 0.683]]
Validation f1: 45.53
Validation accuracy: 89.09
Validation recall: 68.29
Validation precision: 34.15
Validation AUC: 0.4298578773448019
Validation class accuracies: [0.9057591623036649, 0.6829268292682927]
2021-06-29 06:57:18.550302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 561 of 4458
2021-06-29 06:57:28.550596: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 4458
2021-06-29 06:57:38.361597: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1697 of 4458
2021-06-29 06:57:48.590659: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2289 of 4458
2021-06-29 06:57:58.522967: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2715 of 4458
2021-06-29 06:58:08.601632: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3115 of 4458
2021-06-29 06:58:18.547465: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3499 of 4458
2021-06-29 06:58:28.697839: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3819 of 4458
2021-06-29 06:58:38.433027: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4235 of 4458
2021-06-29 06:58:42.050214: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 35/65
279/279 - 509s - loss: 0.0229 - accuracy: 0.9473 - val_loss: 0.3137 - val_accuracy: 0.9153
Confusion matrix: 
 [[533  40]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.293 0.707]]
Validation f1: 52.73
Validation accuracy: 91.53
Validation recall: 70.73
Validation precision: 42.03
Validation AUC: 0.508941565301732
Validation class accuracies: [0.9301919720767888, 0.7073170731707317]
2021-06-29 07:06:02.896686: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 401 of 4458
2021-06-29 07:06:12.889296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1121 of 4458
2021-06-29 07:06:22.957179: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 4458
2021-06-29 07:06:32.792462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2502 of 4458
2021-06-29 07:06:42.911499: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3067 of 4458
2021-06-29 07:06:52.930266: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3627 of 4458
2021-06-29 07:07:02.794993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4175 of 4458
2021-06-29 07:07:07.650781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.5897435897435899 hasn't increased by 0 in 19 epochs
Epoch 36/65
279/279 - 490s - loss: 0.0244 - accuracy: 0.9480 - val_loss: 0.3324 - val_accuracy: 0.9072
Confusion matrix: 
 [[528  45]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.293 0.707]]
Validation f1: 50.43
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 90.72
Validation recall: 70.73
Validation precision: 39.19
Validation AUC: 0.5097039708235214
Validation class accuracies: [0.9214659685863874, 0.7073170731707317]

The metrics for job 1 with the best target metric are: 
Best cm: [[559  14]
 [ 18  23]]
Best normalized cm: [[0.976 0.024]
 [0.439 0.561]]
Best f1: 0.59
Best accuracy: 0.95
Best recall: 0.56
Best precision: 0.62
Best AUC: 0.57
Best class accuracies: [0.9755671902268761, 0.5609756097560976]
Best epoch: 16
The number of epochs since last 1% equals the patience
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_219_2b3_Tc_mc_LittC2SE_1_label_1_pred_1.png, [[0.951]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_205_1b3_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_218_1b1_Al_sc_Meditron_4_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_219_2b2_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[0.994]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_207_2b4_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_218_1b1_Al_sc_Meditron_13_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_205_1b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_207_2b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[6.819e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_207_3b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[9.228e-06]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.946]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_205_1b3_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_1p2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.032]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_1p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_212_2b2_Tc_mc_LittC2SE_1_label_0_pred_1.png, [[0.673]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_2p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[8.236e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_1p2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_1p2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_221_2b2_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_215_1b3_Tc_sc_Meditron_3_label_0_pred_0.png, [[5.369e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_211_2p4_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_204_7p5_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[2.826e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_1p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[5.407e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_1p5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.598e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_205_3b4_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_218_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.297]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_223_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[8.468e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_223_1b1_Lr_sc_Meditron_5_label_0_pred_0.png, [[7.967e-06]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_222_1b1_Lr_sc_Meditron_6_label_0_pred_1.png, [[0.98]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_219_2b1_Tc_mc_LittC2SE_3_label_1_pred_1.png, [[0.967]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[7.649e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_207_2b2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[9.399e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_226_1b1_Ll_sc_Meditron_0_label_1_pred_0.png, [[9.027e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_205_2b4_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_225_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_226_1b1_Al_sc_Meditron_3_label_1_pred_0.png, [[0.007]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_213_1p3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_218_1b1_Pl_sc_Meditron_10_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[8.924e-05]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_203_2p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_223_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_218_1p1_Pl_sc_Litt3200_5_label_0_pred_0.png, [[0.032]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_205_3b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2267__06_0102__v39__mixup/1/icbhi_207_2b4_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 7043
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_020739-2kij9kcm/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_020739-2kij9kcm/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.94796
wandb:         val_accuracy 0.90717
wandb:             _runtime 18397
wandb:           _timestamp 1624950856
wandb:                _step 263
wandb:           train_loss 0.02443
wandb:             val_loss 0.33238
wandb:           val_recall 0.70732
wandb:        val_precision 0.39189
wandb:               val_f1 0.50435
wandb:              val_auc 0.5097
wandb:                   lr 6e-05
wandb:          best_val_f1 0.58974
wandb:    best_val_accuracy 0.94788
wandb:   best_val_precision 0.62162
wandb:      best_val_recall 0.56098
wandb:             best_auc 0.56824
wandb:           best_epoch 16
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210629_020739-2kij9kcm

-----------------------

 See logs at ../../new_cache/conv__2267__06_0102__v39__mixup/logs/