Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2144
Description:  concat_bsize8_lr1e5
2021-05-17 01:09:38.887955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 01:09:42.144396: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-17 01:09:42.145711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-17 01:09:42.219264: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:42.220467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-17 01:09:42.220531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 01:09:42.225210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 01:09:42.225325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 01:09:42.226559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-17 01:09:42.226946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-17 01:09:42.228094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-17 01:09:42.229071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-17 01:09:42.229234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-17 01:09:42.229390: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:42.230257: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:42.230994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2144.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2144__05_0109__v29__concat_bsize8_lr1e5/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 8, 'LR': 1e-05, 'SHAPE': (6, 128, 1250), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: True and Concat: True
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2144
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/7pzj1ix3
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_010942-7pzj1ix3
wandb: Run `wandb offline` to turn off syncing.
2021-05-17 01:09:48.550663: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-17 01:09:48.551032: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:48.552185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-17 01:09:48.552265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 01:09:48.552376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 01:09:48.552412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 01:09:48.552447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-17 01:09:48.552482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-17 01:09:48.552527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-17 01:09:48.552563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-17 01:09:48.552597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-17 01:09:48.552739: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:48.553952: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:48.555063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-17 01:09:48.555139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 01:09:49.511035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-17 01:09:49.511105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-17 01:09:49.511127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-17 01:09:49.511457: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:49.512358: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:49.513231: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 01:09:49.514034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-17 01:10:41.963728: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-17 01:10:41.964876: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-17 01:10:45.903500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 01:10:47.243659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 01:10:47.433996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 6, 128, 1250 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 6, 128, 1250) 5000        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 16, 128, 1250 112         batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 16, 128, 1250 112         batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 6, 128, 1250) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 16, 128, 1250 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 16, 128, 1250 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 16, 128, 1250 112         max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 48, 128, 1250 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 48, 64, 625)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 48, 64, 625)  2500        average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 48, 64, 625)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 32, 64, 625)  40908       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 32, 64, 625)  26700       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 32, 312)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 312)  1248        average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 32, 312)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 64, 32, 312)  29088       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 64, 32, 312)  66720       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 64, 16, 156)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 64, 16, 156)  624         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64, 16, 156)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 128, 16, 156) 89424       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 128, 16, 156) 226128      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 128, 8, 78)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 8, 78)   312         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128, 8, 78)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 256, 8, 78)   323496      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 256, 8, 78)   842664      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 256, 4, 39)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 256, 4, 39)   156         average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 256, 4, 39)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 512, 4, 39)   1235412     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 512, 4, 39)   3256788     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,156,753
Trainable params: 6,137,313
Non-trainable params: 19,440
__________________________________________________________________________________________________
binary
Epoch 1/80
38/38 - 57s - loss: 0.7323 - accuracy: 0.6118 - val_loss: 0.6927 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 2/80
38/38 - 47s - loss: 0.6290 - accuracy: 0.6842 - val_loss: 0.6900 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 3/80
38/38 - 49s - loss: 0.6881 - accuracy: 0.6645 - val_loss: 0.6847 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 4/80
38/38 - 48s - loss: 0.6147 - accuracy: 0.6809 - val_loss: 0.6790 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25703703703703706
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 5/80
38/38 - 48s - loss: 0.6363 - accuracy: 0.6809 - val_loss: 0.6758 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3269064223447785
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 6/80
38/38 - 49s - loss: 0.6487 - accuracy: 0.6678 - val_loss: 0.6702 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2445193588341949
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 7/80
38/38 - 48s - loss: 0.6444 - accuracy: 0.6711 - val_loss: 0.6654 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.16431840912474316
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 8/80
38/38 - 48s - loss: 0.6200 - accuracy: 0.6974 - val_loss: 0.6633 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.13600060712767462
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 9/80
38/38 - 50s - loss: 0.5983 - accuracy: 0.6941 - val_loss: 0.6615 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1393642635455652
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 10/80
38/38 - 49s - loss: 0.6187 - accuracy: 0.6776 - val_loss: 0.6603 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.13348948636140046
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 11/80
38/38 - 48s - loss: 0.6151 - accuracy: 0.6776 - val_loss: 0.6546 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22356802123162983
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 12/80
38/38 - 48s - loss: 0.6119 - accuracy: 0.6711 - val_loss: 0.6504 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2544348572150695
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 13/80
38/38 - 48s - loss: 0.6167 - accuracy: 0.6908 - val_loss: 0.6383 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2622782027010526
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 14/80
38/38 - 48s - loss: 0.6232 - accuracy: 0.6776 - val_loss: 0.6343 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.29677102424706653
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 15/80
38/38 - 48s - loss: 0.6067 - accuracy: 0.6875 - val_loss: 0.6164 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 80.00
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.29954866308269157
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 16/80
38/38 - 49s - loss: 0.5958 - accuracy: 0.6941 - val_loss: 0.6062 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.2872111425326375
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 17/80
38/38 - 48s - loss: 0.6032 - accuracy: 0.6974 - val_loss: 0.5848 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.2866134926898347
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 18/80
38/38 - 48s - loss: 0.5959 - accuracy: 0.7007 - val_loss: 0.5966 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.30237221311272267
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 19/80
38/38 - 50s - loss: 0.6051 - accuracy: 0.6908 - val_loss: 0.5384 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.29261256134125996
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 20/80
38/38 - 49s - loss: 0.5999 - accuracy: 0.6941 - val_loss: 0.5539 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.30123398619666075
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 21/80
38/38 - 48s - loss: 0.5866 - accuracy: 0.7007 - val_loss: 0.5074 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 100.00
Validation AUC: 0.2902947873356415
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 22/80
38/38 - 48s - loss: 0.5883 - accuracy: 0.6974 - val_loss: 0.4967 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
Validation f1: 12.50
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.292626629388022
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 23/80
38/38 - 48s - loss: 0.5732 - accuracy: 0.6941 - val_loss: 0.5571 - val_accuracy: 0.7467
Confusion matrix: 
 [[55  5]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 9.52
Validation accuracy: 74.67
Validation recall: 6.67
Validation precision: 16.67
Validation AUC: 0.2970124778835011
Validation class accuracies: [0.9166666666666666, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09523809523809522
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 24/80
38/38 - 47s - loss: 0.5748 - accuracy: 0.6974 - val_loss: 0.5016 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.2858269259151757
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 25/80
38/38 - 48s - loss: 0.5768 - accuracy: 0.6974 - val_loss: 0.5129 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2935012017439219
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 26/80
38/38 - 48s - loss: 0.5793 - accuracy: 0.7138 - val_loss: 0.5117 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.29279696665892785
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 27/80
38/38 - 48s - loss: 0.5656 - accuracy: 0.7171 - val_loss: 0.5017 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation AUC: 0.2788064656604471
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 28/80
38/38 - 49s - loss: 0.5818 - accuracy: 0.7007 - val_loss: 0.5000 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.28911936583372555
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 29/80
38/38 - 51s - loss: 0.5709 - accuracy: 0.7007 - val_loss: 0.5301 - val_accuracy: 0.7467
Confusion matrix: 
 [[55  5]
 [14  1]]
Validation f1: 9.52
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 74.67
Validation recall: 6.67
Validation precision: 16.67
Validation AUC: 0.29572067975934146
Validation class accuracies: [0.9166666666666666, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09523809523809522
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 30/80
38/38 - 50s - loss: 0.5904 - accuracy: 0.7171 - val_loss: 0.5233 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2889140875833979
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 31/80
38/38 - 48s - loss: 0.5737 - accuracy: 0.7072 - val_loss: 0.5035 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.28285527669440513
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 32/80
38/38 - 48s - loss: 0.5682 - accuracy: 0.7072 - val_loss: 0.5439 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 9.09
Validation accuracy: 73.33
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.2895774334454197
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 33/80
38/38 - 48s - loss: 0.5523 - accuracy: 0.7171 - val_loss: 0.5995 - val_accuracy: 0.6800
Confusion matrix: 
 [[47 13]
 [11  4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.00
Validation accuracy: 68.00
Validation recall: 26.67
Validation precision: 23.53
Validation AUC: 0.2995079938922857
Validation class accuracies: [0.7833333333333333, 0.26666666666666666]
TARGET: 1
target metric(test f1): 0.25
column_sums: [58 17]
cm_sum: 75
inside not defaulting
Saving model...
Epoch 34/80
38/38 - 48s - loss: 0.5778 - accuracy: 0.7072 - val_loss: 0.5040 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.28425684668784235
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 35/80
38/38 - 48s - loss: 0.5968 - accuracy: 0.6743 - val_loss: 0.5799 - val_accuracy: 0.7467
Confusion matrix: 
 [[53  7]
 [12  3]]
Validation f1: 24.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 74.67
Validation recall: 20.00
Validation precision: 30.00
Validation AUC: 0.29779067901652845
Validation class accuracies: [0.8833333333333333, 0.2]
TARGET: 1
target metric(test f1): 0.24
column_sums: [65 10]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.25 hasn't increased by 0 in 1 epochs
Epoch 36/80
38/38 - 48s - loss: 0.5672 - accuracy: 0.7270 - val_loss: 0.4996 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.29815913035615316
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 37/80
38/38 - 48s - loss: 0.5999 - accuracy: 0.6974 - val_loss: 0.5147 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.2843682882897919
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 38/80
38/38 - 48s - loss: 0.5716 - accuracy: 0.7007 - val_loss: 0.5085 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
Validation accuracy: 78.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.28945323485248875
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 39/80
38/38 - 50s - loss: 0.5468 - accuracy: 0.7336 - val_loss: 0.5523 - val_accuracy: 0.7467
Confusion matrix: 
 [[54  6]
 [13  2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.39
Validation accuracy: 74.67
Validation recall: 13.33
Validation precision: 25.00
Validation AUC: 0.30077401742645793
Validation class accuracies: [0.9, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.1739130434782609
column_sums: [67  8]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.25 hasn't increased by 0 in 2 epochs
Epoch 40/80
38/38 - 49s - loss: 0.5619 - accuracy: 0.7105 - val_loss: 0.5265 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.29168152765563693
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 41/80
38/38 - 48s - loss: 0.5432 - accuracy: 0.7434 - val_loss: 0.5153 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2907280597910511
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 42/80
38/38 - 48s - loss: 0.5371 - accuracy: 0.7401 - val_loss: 0.5153 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.28604053136224517
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 43/80
38/38 - 48s - loss: 0.5321 - accuracy: 0.7401 - val_loss: 0.5195 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.294712128922123
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 44/80
38/38 - 48s - loss: 0.5436 - accuracy: 0.7303 - val_loss: 0.5365 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.00
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.29150944262800954
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 45/80
38/38 - 49s - loss: 0.5275 - accuracy: 0.7237 - val_loss: 0.5245 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.2919091660921192
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 46/80
38/38 - 49s - loss: 0.5401 - accuracy: 0.7171 - val_loss: 0.5324 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2816551833945638
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 47/80
38/38 - 48s - loss: 0.5170 - accuracy: 0.7434 - val_loss: 0.5436 - val_accuracy: 0.7467
Confusion matrix: 
 [[55  5]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 9.52
Validation accuracy: 74.67
Validation recall: 6.67
Validation precision: 16.67
Validation AUC: 0.28563644504659436
Validation class accuracies: [0.9166666666666666, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09523809523809522
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 48/80
38/38 - 49s - loss: 0.5188 - accuracy: 0.7533 - val_loss: 0.5356 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.28261468736873974
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 49/80
38/38 - 51s - loss: 0.5498 - accuracy: 0.7171 - val_loss: 0.5524 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.28572774480317853
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 50/80
38/38 - 53s - loss: 0.5102 - accuracy: 0.7632 - val_loss: 0.5354 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.27729307510838697
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 51/80
38/38 - 52s - loss: 0.5257 - accuracy: 0.7401 - val_loss: 0.5459 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.2853808392839266
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 52/80
38/38 - 51s - loss: 0.5049 - accuracy: 0.7336 - val_loss: 0.5457 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.2776990300226516
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 53/80
38/38 - 51s - loss: 0.5151 - accuracy: 0.7401 - val_loss: 0.5688 - val_accuracy: 0.7600
Confusion matrix: 
 [[55  5]
 [13  2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.18
Validation accuracy: 76.00
Validation recall: 13.33
Validation precision: 28.57
Validation AUC: 0.28865756649307983
Validation class accuracies: [0.9166666666666666, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 54/80
38/38 - 52s - loss: 0.4849 - accuracy: 0.7697 - val_loss: 0.5509 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.28295104585865494
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 55/80
38/38 - 53s - loss: 0.4939 - accuracy: 0.7566 - val_loss: 0.5804 - val_accuracy: 0.7467
Confusion matrix: 
 [[54  6]
 [13  2]]
Validation f1: 17.39
Validation accuracy: 74.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 13.33
Validation precision: 25.00
Validation AUC: 0.2776997152420342
Validation class accuracies: [0.9, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.1739130434782609
column_sums: [67  8]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.25 hasn't increased by 0 in 3 epochs
Epoch 56/80
38/38 - 52s - loss: 0.4930 - accuracy: 0.7632 - val_loss: 0.5539 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.2849864666458074
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 57/80
38/38 - 52s - loss: 0.4997 - accuracy: 0.7467 - val_loss: 0.5595 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2749108875127311
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 58/80
38/38 - 54s - loss: 0.4899 - accuracy: 0.7730 - val_loss: 0.5584 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 11.11
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.27262692730076
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 59/80
38/38 - 56s - loss: 0.4866 - accuracy: 0.7664 - val_loss: 0.5927 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 11.11
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.2528623609016236
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 60/80
38/38 - 52s - loss: 0.5139 - accuracy: 0.7566 - val_loss: 0.5774 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2520559635555329
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 61/80
38/38 - 50s - loss: 0.4807 - accuracy: 0.7697 - val_loss: 0.5802 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2617213005630659
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 62/80
38/38 - 50s - loss: 0.4802 - accuracy: 0.7599 - val_loss: 0.5814 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2574915715305677
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 63/80
38/38 - 49s - loss: 0.4667 - accuracy: 0.7928 - val_loss: 0.6060 - val_accuracy: 0.7467
Confusion matrix: 
 [[54  6]
 [13  2]]
Validation f1: 17.39
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 74.67
Validation recall: 13.33
Validation precision: 25.00
Validation AUC: 0.27185372456844237
Validation class accuracies: [0.9, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.1739130434782609
column_sums: [67  8]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 2.499999936844688e-06
The validation tracker metric at 0.25 hasn't increased by 0 in 4 epochs
Epoch 64/80
38/38 - 50s - loss: 0.4705 - accuracy: 0.7862 - val_loss: 0.5898 - val_accuracy: 0.7600
Confusion matrix: 
 [[55  5]
 [13  2]]
Validation f1: 18.18
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 13.33
Validation precision: 28.57
Validation AUC: 0.2687491743074624
Validation class accuracies: [0.9166666666666666, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 65/80
38/38 - 49s - loss: 0.4628 - accuracy: 0.7993 - val_loss: 0.5873 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2630890510049318
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 66/80
38/38 - 50s - loss: 0.4468 - accuracy: 0.8092 - val_loss: 0.5831 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2632683589951365
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 67/80
38/38 - 49s - loss: 0.4700 - accuracy: 0.7566 - val_loss: 0.5880 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.25858796790406524
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 68/80
38/38 - 51s - loss: 0.4575 - accuracy: 0.7862 - val_loss: 0.5973 - val_accuracy: 0.7600
Confusion matrix: 
 [[55  5]
 [13  2]]
Validation f1: 18.18
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 13.33
Validation precision: 28.57
Validation AUC: 0.26686307835114037
Validation class accuracies: [0.9166666666666666, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 69/80
38/38 - 51s - loss: 0.4534 - accuracy: 0.7993 - val_loss: 0.5841 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2627939693229416
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 70/80
38/38 - 49s - loss: 0.4612 - accuracy: 0.7928 - val_loss: 0.5916 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.26636958289173884
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 71/80
38/38 - 49s - loss: 0.4534 - accuracy: 0.8092 - val_loss: 0.5926 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.26444987081195814
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 72/80
38/38 - 49s - loss: 0.4523 - accuracy: 0.8059 - val_loss: 0.5915 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2651874407375476
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 73/80
38/38 - 49s - loss: 0.4440 - accuracy: 0.8125 - val_loss: 0.5924 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.260488173601597
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 74/80
38/38 - 49s - loss: 0.4453 - accuracy: 0.8026 - val_loss: 0.5951 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2608556846159085
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 75/80
38/38 - 49s - loss: 0.4445 - accuracy: 0.8059 - val_loss: 0.6049 - val_accuracy: 0.7600
Confusion matrix: 
 [[55  5]
 [13  2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.18
Validation accuracy: 76.00
Validation recall: 13.33
Validation precision: 28.57
Validation AUC: 0.2671917835975633
Validation class accuracies: [0.9166666666666666, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 76/80
38/38 - 49s - loss: 0.4475 - accuracy: 0.8092 - val_loss: 0.5972 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.25822910530415016
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 77/80
38/38 - 47s - loss: 0.4409 - accuracy: 0.8092 - val_loss: 0.6003 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.2642982839618302
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 78/80
38/38 - 47s - loss: 0.4534 - accuracy: 0.7928 - val_loss: 0.6052 - val_accuracy: 0.7600
Confusion matrix: 
 [[55  5]
 [13  2]]
Validation f1: 18.18
Validation accuracy: 76.00
Validation recall: 13.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 28.57
Validation AUC: 0.26830308306458833
Validation class accuracies: [0.9166666666666666, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 79/80
38/38 - 47s - loss: 0.4412 - accuracy: 0.8026 - val_loss: 0.5953 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.2661436772533658
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 80/80
38/38 - 47s - loss: 0.4381 - accuracy: 0.8026 - val_loss: 0.5982 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.26533509199323696
Validation class accuracies: [0.95, 0.06666666666666667]

The metrics for the epoch with the best target metric are: 
Best cm: [[47 13]
 [11  4]]
Best f1: 0.25
Best accuracy: 0.68
Best recall: 0.26666666666666666
Best precision: 0.23529411764705882
Best AUC: 0.2995079938922857
Best epoch: 33
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.

Starting the Bangladesh analysis...
Epoch: 33
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2144.py", line 312, in <module>
    train_model(**arguments)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2144.py", line 261, in train_model
    bd_f1, bd_accuracy, bd_precision, bd_recall, bd_auc, bd_y_true, bd_y_pred = generate_bangladesh_sheet(model, grouped_val_samples, excel_dest, six, initial_channels)
TypeError: generate_bangladesh_sheet() missing 1 required positional argument: 'pneumonia_threshold'
wandb: Waiting for W&B process to finish, PID 551
wandb: Program failed with code 1.  Press ctrl-c to abort syncing.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: / 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: - 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: \ 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_010942-7pzj1ix3/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_010942-7pzj1ix3/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.80263
wandb:         val_accuracy 0.77333
wandb:             _runtime 4583
wandb:           _timestamp 1621218365
wandb:                _step 562
wandb:           train_loss 0.43812
wandb:             val_loss 0.5982
wandb:           val_recall 0.06667
wandb:        val_precision 0.25
wandb:               val_f1 0.10526
wandb:              val_auc 0.26534
wandb:                   lr 0.0
wandb:          best_val_f1 0.25
wandb:    best_val_accuracy 0.68
wandb:   best_val_precision 0.23529
wandb:      best_val_recall 0.26667
wandb:             best_auc 0.29951
wandb:           best_epoch 33
wandb: Run history:
wandb:   train_accuracy ▁▃▃▃▄▃▄▄▄▄▄▄▄▅▄▄▅▃▄▅▆▅▅▆▅▅▅▆▆▆▇▇█▆██████
wandb:     val_accuracy ▇▇▇▇▇▇▇▇███▅▆▇▅▇▁▅▆▅▆▇▇▅▅▅▅▅▆▇▆▅▆▆▆▅▆▅▅▆
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▇▆▆▅▅▅▅▅▅▅▄▄▄▄▄▄▅▅▄▃▃▃▃▄▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁
wandb:         val_loss ██▇▇▇▇▆▅▄▂▁▃▁▁▂▁▅▄▁▃▁▂▂▃▃▃▃▄▃▄▄▅▄▄▄▄▄▅▅▅
wandb:       val_recall ▁▁▁▁▁▁▁▁▃▃▃▃▃▃▃▃█▆▃▅▃▃▃▃▃▃▅▅▃▃▃▅▃▃▃▃▃▅▃▃
wandb:    val_precision ▁▁▁▁▁▁▁▁███▂▃▅▂▃▃▃▃▃▃▃▃▂▂▂▃▃▃▃▃▃▃▃▃▂▃▃▂▃
wandb:           val_f1 ▁▁▁▁▁▁▁▁▅▅▅▄▄▄▄▄██▄▆▄▄▄▄▄▄▆▆▄▄▄▆▄▄▄▄▄▆▄▄
wandb:          val_auc ██▄▁▁▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:               lr ████████████████████████████████▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 3 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2144: https://wandb.ai/arachid1/tensorboard-integration/runs/7pzj1ix3


 See logs at ../../new_cache/conv__2144__05_0109__v29__concat_bsize8_lr1e5/logs/