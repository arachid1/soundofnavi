Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2053
Description:  mixednet_wsoftmax
2021-04-13 11:58:25.604997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 11:58:27.998434: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-13 11:58:27.999361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-13 11:58:28.073632: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.074651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-13 11:58:28.074697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 11:58:28.079472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 11:58:28.079611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 11:58:28.081125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-13 11:58:28.081549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-13 11:58:28.083112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-13 11:58:28.084110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-13 11:58:28.084267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 11:58:28.084420: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.085232: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.085884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-13 11:58:28.088114: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-13 11:58:28.088295: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.089135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-13 11:58:28.089174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 11:58:28.089233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 11:58:28.089260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 11:58:28.089282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-13 11:58:28.089301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-13 11:58:28.089339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-13 11:58:28.089361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-13 11:58:28.089381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 11:58:28.089486: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.090701: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.091652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-13 11:58:28.091717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-13 11:58:28.915664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-13 11:58:28.915718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-13 11:58:28.915730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-13 11:58:28.916048: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.917275: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.918414: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-13 11:58:28.919472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:05.0, compute capability: 7.0)
2021-04-13 11:58:29.415463: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-13 11:58:29.415513: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-13 11:58:29.415557: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-13 11:58:29.415782: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-13 11:58:29.416657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-13 11:58:29.624009: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-13 11:58:29.626675: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-13 11:58:30.548043: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-13 11:58:30.550206: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-13 11:58:32.480346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-13 11:58:33.037957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-13 11:58:33.059846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-13 11:58:36.626227: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-13 11:58:36.626325: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-13 11:58:37.717248: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-13 11:58:37.719994: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-13 11:58:37.772093: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 490 callback api events and 486 activity events. 
2021-04-13 11:58:37.788706: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
WARNING:tensorflow:Callback method `on_train_batch_begin` is slow compared to the batch time (batch time: 0.0235s vs `on_train_batch_begin` time: 0.1022s). Check your callbacks.
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0235s vs `on_train_batch_end` time: 0.4096s). Check your callbacks.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2053.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_1158___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___mixednet_wsoftmax___2053/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 6, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 22, 1.0%
-----------------------
Size of training set: 4316
Size of validation set: 1078
Initializing weights...
weights = {0: 0.6776381909547738, 1: 1.9073550212164074}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 258       
=================================================================
Total params: 106,096
Trainable params: 105,600
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
270/270 - 157s - loss: 0.6860 - accuracy: 0.5876 - val_loss: 0.7434 - val_accuracy: 0.2746
Epoch 2/40
270/270 - 149s - loss: 0.6767 - accuracy: 0.6108 - val_loss: 0.7120 - val_accuracy: 0.3915
Epoch 3/40
270/270 - 150s - loss: 0.6700 - accuracy: 0.6138 - val_loss: 0.9360 - val_accuracy: 0.3506
Epoch 4/40
270/270 - 154s - loss: 0.6584 - accuracy: 0.6284 - val_loss: 0.6501 - val_accuracy: 0.6336
Epoch 5/40
270/270 - 153s - loss: 0.6461 - accuracy: 0.6425 - val_loss: 0.6229 - val_accuracy: 0.6939
Epoch 6/40
270/270 - 159s - loss: 0.6230 - accuracy: 0.6715 - val_loss: 0.7878 - val_accuracy: 0.4601
Epoch 7/40
270/270 - 150s - loss: 0.6043 - accuracy: 0.6749 - val_loss: 0.6387 - val_accuracy: 0.6512
Epoch 8/40
270/270 - 157s - loss: 0.5632 - accuracy: 0.7146 - val_loss: 0.6043 - val_accuracy: 0.7310
Epoch 9/40
270/270 - 151s - loss: 0.5209 - accuracy: 0.7417 - val_loss: 0.7727 - val_accuracy: 0.5575
Epoch 10/40
270/270 - 150s - loss: 0.4780 - accuracy: 0.7792 - val_loss: 0.9792 - val_accuracy: 0.5056
Epoch 11/40
270/270 - 160s - loss: 0.4255 - accuracy: 0.8160 - val_loss: 0.6175 - val_accuracy: 0.7356
Epoch 12/40
270/270 - 149s - loss: 0.3661 - accuracy: 0.8471 - val_loss: 0.8104 - val_accuracy: 0.6401
Epoch 13/40
270/270 - 153s - loss: 0.3255 - accuracy: 0.8645 - val_loss: 1.2328 - val_accuracy: 0.5019
Epoch 14/40
270/270 - 153s - loss: 0.2759 - accuracy: 0.8888 - val_loss: 0.7300 - val_accuracy: 0.6994
Epoch 15/40
270/270 - 150s - loss: 0.2168 - accuracy: 0.9189 - val_loss: 0.7328 - val_accuracy: 0.7143
Epoch 16/40
270/270 - 150s - loss: 0.1823 - accuracy: 0.9411 - val_loss: 1.9421 - val_accuracy: 0.4963
Epoch 17/40
270/270 - 150s - loss: 0.1831 - accuracy: 0.9356 - val_loss: 1.3520 - val_accuracy: 0.5659

Epoch 00017: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 18/40
270/270 - 154s - loss: 0.1276 - accuracy: 0.9622 - val_loss: 1.1058 - val_accuracy: 0.6224
Epoch 19/40
270/270 - 154s - loss: 0.1095 - accuracy: 0.9685 - val_loss: 0.8423 - val_accuracy: 0.7282
Epoch 20/40
270/270 - 150s - loss: 0.0835 - accuracy: 0.9736 - val_loss: 1.1091 - val_accuracy: 0.7588
Epoch 21/40
270/270 - 152s - loss: 0.0829 - accuracy: 0.9789 - val_loss: 1.0843 - val_accuracy: 0.6224
Epoch 22/40
270/270 - 154s - loss: 0.0769 - accuracy: 0.9750 - val_loss: 0.9863 - val_accuracy: 0.6735
Epoch 23/40
270/270 - 150s - loss: 0.0771 - accuracy: 0.9773 - val_loss: 0.9271 - val_accuracy: 0.7477
Epoch 24/40
270/270 - 150s - loss: 0.0670 - accuracy: 0.9808 - val_loss: 0.8725 - val_accuracy: 0.7226
Epoch 25/40
270/270 - 150s - loss: 0.0570 - accuracy: 0.9861 - val_loss: 1.2999 - val_accuracy: 0.6475
Epoch 26/40
270/270 - 151s - loss: 0.0463 - accuracy: 0.9893 - val_loss: 0.8914 - val_accuracy: 0.7449

Epoch 00026: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 27/40
270/270 - 150s - loss: 0.0503 - accuracy: 0.9866 - val_loss: 1.1836 - val_accuracy: 0.7625
Epoch 28/40
270/270 - 142s - loss: 0.0455 - accuracy: 0.9866 - val_loss: 0.9912 - val_accuracy: 0.6976
Epoch 29/40
270/270 - 149s - loss: 0.0433 - accuracy: 0.9868 - val_loss: 0.8951 - val_accuracy: 0.7486
Epoch 30/40
270/270 - 148s - loss: 0.0378 - accuracy: 0.9905 - val_loss: 0.9490 - val_accuracy: 0.7532
Epoch 31/40
270/270 - 149s - loss: 0.0272 - accuracy: 0.9933 - val_loss: 0.9627 - val_accuracy: 0.7050
Epoch 32/40
270/270 - 149s - loss: 0.0409 - accuracy: 0.9886 - val_loss: 0.9702 - val_accuracy: 0.7338
Epoch 33/40
270/270 - 148s - loss: 0.0432 - accuracy: 0.9868 - val_loss: 1.0022 - val_accuracy: 0.7301

Epoch 00033: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 34/40
270/270 - 149s - loss: 0.0290 - accuracy: 0.9917 - val_loss: 0.9727 - val_accuracy: 0.7365
Epoch 35/40
270/270 - 148s - loss: 0.0230 - accuracy: 0.9954 - val_loss: 0.9649 - val_accuracy: 0.7607
Epoch 36/40
270/270 - 149s - loss: 0.0185 - accuracy: 0.9965 - val_loss: 0.9542 - val_accuracy: 0.7505
Epoch 37/40
270/270 - 149s - loss: 0.0166 - accuracy: 0.9965 - val_loss: 0.9973 - val_accuracy: 0.7263
Epoch 38/40
270/270 - 149s - loss: 0.0184 - accuracy: 0.9961 - val_loss: 1.0536 - val_accuracy: 0.7356
Epoch 39/40
270/270 - 149s - loss: 0.0192 - accuracy: 0.9954 - val_loss: 0.9911 - val_accuracy: 0.7328

Epoch 00039: ReduceLROnPlateau reducing learning rate to 0.00031640623637940735.
Epoch 40/40
270/270 - 149s - loss: 0.0184 - accuracy: 0.9979 - val_loss: 1.0009 - val_accuracy: 0.7662

 See logs at ../../cache/conv___04_1158___all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000___mixednet_wsoftmax___2053/logs/