Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2147
Description:  mod9_concat
2021-05-17 17:20:23.484165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 17:20:25.683204: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-17 17:20:25.684075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-17 17:20:25.731070: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:25.731789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-17 17:20:25.731818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 17:20:25.735279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 17:20:25.735380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 17:20:25.736457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-17 17:20:25.736763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-17 17:20:25.737723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-17 17:20:25.738596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-17 17:20:25.738760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-17 17:20:25.738860: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:25.739566: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:25.740187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2147.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2147__05_1720__v29__mod9_concat/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 4, 'LR': 1e-05, 'SHAPE': (6, 128, 1250), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.8}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: True and Concat: True
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2147
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/36qbzb3v
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_172025-36qbzb3v
wandb: Run `wandb offline` to turn off syncing.
2021-05-17 17:20:30.957082: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-17 17:20:30.957312: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:30.958013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-17 17:20:30.958054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 17:20:30.958096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 17:20:30.958115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 17:20:30.958130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-17 17:20:30.958148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-17 17:20:30.958166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-17 17:20:30.958185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-17 17:20:30.958203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-17 17:20:30.958291: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:30.959048: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:30.959678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-17 17:20:30.959723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 17:20:31.678876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-17 17:20:31.678930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-17 17:20:31.678941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-17 17:20:31.679242: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:31.680342: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:31.681373: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:20:31.682330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-17 17:21:11.210829: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-17 17:21:11.211786: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-17 17:21:14.683145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 17:21:15.757772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 17:21:15.832813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 6, 128, 1250 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 6, 128, 1250) 5000        input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 16, 128, 1250 112         batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 16, 128, 1250 112         batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 6, 128, 1250) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 16, 128, 1250 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 16, 128, 1250 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 16, 128, 1250 112         max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 48, 128, 1250 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 48, 64, 625)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 48, 64, 625)  2500        average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 48, 64, 625)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 32, 64, 625)  40908       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 32, 64, 625)  26700       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 32, 312)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 312)  1248        average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 32, 312)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 64, 32, 312)  29088       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 64, 32, 312)  66720       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 64, 16, 156)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 64, 16, 156)  624         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64, 16, 156)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 128, 16, 156) 89424       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 128, 16, 156) 226128      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 128, 8, 78)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128, 8, 78)   312         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128, 8, 78)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 256, 8, 78)   323496      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 256, 8, 78)   842664      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 256, 4, 39)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 256, 4, 39)   156         average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 256, 4, 39)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 512, 4, 39)   1235412     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 512, 4, 39)   3256788     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,156,753
Trainable params: 6,137,313
Non-trainable params: 19,440
__________________________________________________________________________________________________
binary
Epoch 1/80
76/76 - 55s - loss: 0.7116 - accuracy: 0.5691 - val_loss: 0.6947 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.6
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 2/80
76/76 - 48s - loss: 0.6951 - accuracy: 0.6349 - val_loss: 0.6958 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.3062900188323917
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 3/80
76/76 - 51s - loss: 0.6957 - accuracy: 0.6184 - val_loss: 0.6961 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.2615824524698055
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 4/80
76/76 - 49s - loss: 0.6976 - accuracy: 0.5789 - val_loss: 0.6965 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.1386426690125025
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 5/80
76/76 - 50s - loss: 0.6938 - accuracy: 0.5855 - val_loss: 0.6956 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.13060708325341208
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 6/80
76/76 - 49s - loss: 0.6945 - accuracy: 0.6414 - val_loss: 0.6946 - val_accuracy: 0.2000
Confusion matrix: 
 [[ 0 60]
 [ 0 15]]
Validation f1: 33.33
Validation accuracy: 20.00
Validation recall: 100.00
Validation precision: 20.00
Validation AUC: 0.16522639710983278
Validation class accuracies: [0.0, 1.0]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [ 0 75]
cm_sum: 75
The training is defaulting to either class.
Epoch 7/80
76/76 - 49s - loss: 0.6954 - accuracy: 0.6151 - val_loss: 0.6930 - val_accuracy: 0.7067
Confusion matrix: 
 [[48 12]
 [10  5]]
Validation f1: 31.25
Validation accuracy: 70.67
Validation recall: 33.33
Validation precision: 29.41
Validation AUC: 0.30274214075515204
Validation class accuracies: [0.8, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.3125
column_sums: [58 17]
cm_sum: 75
inside not defaulting
Saving model...
Epoch 8/80
76/76 - 49s - loss: 0.6924 - accuracy: 0.6612 - val_loss: 0.6904 - val_accuracy: 0.8000
Confusion matrix: 
 [[60  0]
 [15  0]]
Validation f1: 0.00
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20480565138442658
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [75  0]
cm_sum: 75
The training is defaulting to either class.
Epoch 9/80
76/76 - 49s - loss: 0.6905 - accuracy: 0.6842 - val_loss: 0.6906 - val_accuracy: 0.7333
Confusion matrix: 
 [[54  6]
 [14  1]]
Validation f1: 9.09
Validation accuracy: 73.33
Validation recall: 6.67
Validation precision: 14.29
Validation AUC: 0.3181564774187985
Validation class accuracies: [0.9, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [68  7]
cm_sum: 75
The training is defaulting to either class.
Epoch 10/80
76/76 - 49s - loss: 0.6961 - accuracy: 0.6118 - val_loss: 0.6928 - val_accuracy: 0.6800
Confusion matrix: 
 [[43 17]
 [ 7  8]]
Validation f1: 40.00
Validation accuracy: 68.00
Validation recall: 53.33
Validation precision: 32.00
Validation AUC: 0.31868219016078003
Validation class accuracies: [0.7166666666666667, 0.5333333333333333]
TARGET: 1
target metric(test f1): 0.4
column_sums: [50 25]
cm_sum: 75
inside not defaulting
Saving model...
Epoch 11/80
76/76 - 49s - loss: 0.6914 - accuracy: 0.6743 - val_loss: 0.6873 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3155044640332365
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 12/80
76/76 - 49s - loss: 0.6908 - accuracy: 0.6776 - val_loss: 0.6868 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.30578128609998945
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 13/80
76/76 - 49s - loss: 0.6922 - accuracy: 0.6513 - val_loss: 0.6886 - val_accuracy: 0.7333
Confusion matrix: 
 [[52  8]
 [12  3]]
Validation f1: 23.08
Validation accuracy: 73.33
Validation recall: 20.00
Validation precision: 27.27
Validation AUC: 0.31835520277871
Validation class accuracies: [0.8666666666666667, 0.2]
TARGET: 1
target metric(test f1): 0.23076923076923075
column_sums: [64 11]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4 hasn't increased by 0 in 1 epochs
Epoch 14/80
76/76 - 49s - loss: 0.6918 - accuracy: 0.6612 - val_loss: 0.6862 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.29195087042289164
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 15/80
76/76 - 49s - loss: 0.6930 - accuracy: 0.6414 - val_loss: 0.6863 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.2937690827453007
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 16/80
76/76 - 49s - loss: 0.6910 - accuracy: 0.6645 - val_loss: 0.6928 - val_accuracy: 0.6533
Confusion matrix: 
 [[44 16]
 [10  5]]
Validation f1: 27.78
Validation accuracy: 65.33
Validation recall: 33.33
Validation precision: 23.81
Validation AUC: 0.3001944916772871
Validation class accuracies: [0.7333333333333333, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.2777777777777778
column_sums: [54 21]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4 hasn't increased by 0 in 2 epochs
Epoch 17/80
76/76 - 49s - loss: 0.6912 - accuracy: 0.6480 - val_loss: 0.6873 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.28886513316956536
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 18/80
76/76 - 49s - loss: 0.6916 - accuracy: 0.6678 - val_loss: 0.6862 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.3018591536166862
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 19/80
76/76 - 49s - loss: 0.6902 - accuracy: 0.6941 - val_loss: 0.7026 - val_accuracy: 0.5067
Confusion matrix: 
 [[26 34]
 [ 3 12]]
Validation f1: 39.34
Validation accuracy: 50.67
Validation recall: 80.00
Validation precision: 26.09
Validation AUC: 0.3157892767788115
Validation class accuracies: [0.43333333333333335, 0.8]
TARGET: 1
target metric(test f1): 0.39344262295081966
column_sums: [29 46]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4 hasn't increased by 0 in 3 epochs
Epoch 20/80
76/76 - 49s - loss: 0.6906 - accuracy: 0.6809 - val_loss: 0.6860 - val_accuracy: 0.8133
Confusion matrix: 
 [[60  0]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 12.50
Validation accuracy: 81.33
Validation recall: 6.67
Validation precision: 100.00
Validation AUC: 0.3066214124901374
Validation class accuracies: [1.0, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.125
column_sums: [74  1]
cm_sum: 75
The training is defaulting to either class.
Epoch 21/80
76/76 - 49s - loss: 0.6911 - accuracy: 0.6711 - val_loss: 0.6883 - val_accuracy: 0.7733
Confusion matrix: 
 [[55  5]
 [12  3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 26.09
Validation accuracy: 77.33
Validation recall: 20.00
Validation precision: 37.50
Validation AUC: 0.31762052214326736
Validation class accuracies: [0.9166666666666666, 0.2]
TARGET: 1
target metric(test f1): 0.26086956521739135
column_sums: [67  8]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 2.499999936844688e-06
The validation tracker metric at 0.4 hasn't increased by 0 in 4 epochs
Epoch 22/80
76/76 - 49s - loss: 0.6888 - accuracy: 0.7138 - val_loss: 0.6860 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 80.00
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.3039251562481205
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 23/80
76/76 - 49s - loss: 0.6885 - accuracy: 0.6908 - val_loss: 0.6878 - val_accuracy: 0.7733
Confusion matrix: 
 [[56  4]
 [13  2]]
Validation f1: 19.05
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 13.33
Validation precision: 33.33
Validation AUC: 0.31585582491890596
Validation class accuracies: [0.9333333333333333, 0.13333333333333333]
TARGET: 1
target metric(test f1): 0.19047619047619044
column_sums: [69  6]
cm_sum: 75
The training is defaulting to either class.
Epoch 24/80
76/76 - 49s - loss: 0.6883 - accuracy: 0.7171 - val_loss: 0.6862 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 11.11
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.30479300056893743
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 25/80
76/76 - 50s - loss: 0.6887 - accuracy: 0.7039 - val_loss: 0.6867 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.31520854450459446
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 26/80
76/76 - 49s - loss: 0.6891 - accuracy: 0.7039 - val_loss: 0.6865 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3099229648124983
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 27/80
76/76 - 49s - loss: 0.6885 - accuracy: 0.7237 - val_loss: 0.6864 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.2969772608965027
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 28/80
76/76 - 49s - loss: 0.6891 - accuracy: 0.7072 - val_loss: 0.6865 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3058271665211429
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 29/80
76/76 - 49s - loss: 0.6884 - accuracy: 0.7204 - val_loss: 0.6878 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.31172178046785676
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 30/80
76/76 - 49s - loss: 0.6892 - accuracy: 0.6875 - val_loss: 0.6875 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.30988815046200097
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 31/80
76/76 - 49s - loss: 0.6885 - accuracy: 0.7270 - val_loss: 0.6868 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.30374750176291504
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 32/80
76/76 - 49s - loss: 0.6883 - accuracy: 0.7171 - val_loss: 0.6877 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.31119167410400067
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 33/80
76/76 - 49s - loss: 0.6883 - accuracy: 0.7039 - val_loss: 0.6912 - val_accuracy: 0.7200
Confusion matrix: 
 [[49 11]
 [10  5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 32.26
Validation accuracy: 72.00
Validation recall: 33.33
Validation precision: 31.25
Validation AUC: 0.3077611679862574
Validation class accuracies: [0.8166666666666667, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.3225806451612903
column_sums: [59 16]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4 hasn't increased by 0 in 5 epochs
Epoch 34/80
76/76 - 49s - loss: 0.6888 - accuracy: 0.7039 - val_loss: 0.6866 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.29987825248520456
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 35/80
76/76 - 50s - loss: 0.6891 - accuracy: 0.6875 - val_loss: 0.6907 - val_accuracy: 0.7467
Confusion matrix: 
 [[51  9]
 [10  5]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 34.48
Validation accuracy: 74.67
Validation recall: 33.33
Validation precision: 35.71
Validation AUC: 0.31110759631802487
Validation class accuracies: [0.85, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.3448275862068965
column_sums: [61 14]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4 hasn't increased by 0 in 6 epochs
Epoch 36/80
76/76 - 50s - loss: 0.6881 - accuracy: 0.7204 - val_loss: 0.6866 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
Validation accuracy: 78.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.3009302059411833
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 37/80
76/76 - 49s - loss: 0.6889 - accuracy: 0.7007 - val_loss: 0.6867 - val_accuracy: 0.8000
Confusion matrix: 
 [[59  1]
 [14  1]]
Validation f1: 11.76
Validation accuracy: 80.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 50.00
Validation AUC: 0.29928955673783636
Validation class accuracies: [0.9833333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.11764705882352941
column_sums: [73  2]
cm_sum: 75
The training is defaulting to either class.
Epoch 38/80
76/76 - 49s - loss: 0.6887 - accuracy: 0.6908 - val_loss: 0.6881 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.31425716673866144
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 39/80
76/76 - 49s - loss: 0.6879 - accuracy: 0.7204 - val_loss: 0.6903 - val_accuracy: 0.7467
Confusion matrix: 
 [[51  9]
 [10  5]]
Validation f1: 34.48
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 74.67
Validation recall: 33.33
Validation precision: 35.71
Validation AUC: 0.3275469713070162
Validation class accuracies: [0.85, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.3448275862068965
column_sums: [61 14]
cm_sum: 75
inside not defaulting
The validation tracker metric at 0.4 hasn't increased by 0 in 7 epochs
Epoch 40/80
76/76 - 49s - loss: 0.6892 - accuracy: 0.6908 - val_loss: 0.6878 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3139917462853806
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 41/80
76/76 - 49s - loss: 0.6889 - accuracy: 0.7138 - val_loss: 0.6868 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.3005314495588275
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 42/80
76/76 - 49s - loss: 0.6881 - accuracy: 0.7270 - val_loss: 0.6868 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.30308873436407213
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 43/80
76/76 - 49s - loss: 0.6882 - accuracy: 0.7171 - val_loss: 0.6868 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
Validation accuracy: 78.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.29954355018238704
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 44/80
76/76 - 49s - loss: 0.6885 - accuracy: 0.7105 - val_loss: 0.6882 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.31254777080377305
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 45/80
76/76 - 49s - loss: 0.6879 - accuracy: 0.7270 - val_loss: 0.6869 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.30179877064001887
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 46/80
76/76 - 50s - loss: 0.6884 - accuracy: 0.6941 - val_loss: 0.6873 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3044577316641118
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 47/80
76/76 - 49s - loss: 0.6884 - accuracy: 0.7138 - val_loss: 0.6881 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.31023681477788523
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 48/80
76/76 - 49s - loss: 0.6882 - accuracy: 0.7138 - val_loss: 0.6868 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.30670125342577353
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 49/80
76/76 - 49s - loss: 0.6884 - accuracy: 0.7072 - val_loss: 0.6882 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 20.00
Validation AUC: 0.3086088297336861
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 50/80
76/76 - 49s - loss: 0.6880 - accuracy: 0.7237 - val_loss: 0.6871 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
Validation accuracy: 78.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.31011455019145573
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 51/80
76/76 - 49s - loss: 0.6886 - accuracy: 0.7270 - val_loss: 0.6875 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.3121240627973776
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 52/80
76/76 - 50s - loss: 0.6880 - accuracy: 0.7237 - val_loss: 0.6870 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.30224671201295616
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 53/80
76/76 - 49s - loss: 0.6882 - accuracy: 0.7072 - val_loss: 0.6891 - val_accuracy: 0.7867
Confusion matrix: 
 [[55  5]
 [11  4]]
Validation f1: 33.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 26.67
Validation precision: 44.44
Validation AUC: 0.3208732200251839
Validation class accuracies: [0.9166666666666666, 0.26666666666666666]
TARGET: 1
target metric(test f1): 0.33333333333333337
column_sums: [66  9]
cm_sum: 75
inside not defaulting
Lr has been adjusted to 6.24999984211172e-07
The validation tracker metric at 0.4 hasn't increased by 0 in 8 epochs
Epoch 54/80
76/76 - 49s - loss: 0.6876 - accuracy: 0.7467 - val_loss: 0.6872 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.3108948708422136
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 55/80
76/76 - 49s - loss: 0.6877 - accuracy: 0.7237 - val_loss: 0.6877 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3137616035312987
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 56/80
76/76 - 49s - loss: 0.6880 - accuracy: 0.7270 - val_loss: 0.6879 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.31212692233856415
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 57/80
76/76 - 49s - loss: 0.6875 - accuracy: 0.7336 - val_loss: 0.6877 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3124952636620177
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 58/80
76/76 - 49s - loss: 0.6878 - accuracy: 0.7105 - val_loss: 0.6878 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3113589148807439
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 59/80
76/76 - 49s - loss: 0.6883 - accuracy: 0.7007 - val_loss: 0.6884 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.3167130935795829
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 60/80
76/76 - 49s - loss: 0.6881 - accuracy: 0.7237 - val_loss: 0.6876 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.31038948885188195
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 61/80
76/76 - 49s - loss: 0.6876 - accuracy: 0.7270 - val_loss: 0.6882 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.3134762380844493
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 62/80
76/76 - 49s - loss: 0.6878 - accuracy: 0.7270 - val_loss: 0.6876 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3101451279496263
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 63/80
76/76 - 49s - loss: 0.6870 - accuracy: 0.7500 - val_loss: 0.6880 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.311031341516852
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 64/80
76/76 - 49s - loss: 0.6880 - accuracy: 0.7204 - val_loss: 0.6882 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.31381332361469205
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 65/80
76/76 - 49s - loss: 0.6876 - accuracy: 0.7171 - val_loss: 0.6878 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.31025076641385774
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 66/80
76/76 - 49s - loss: 0.6876 - accuracy: 0.7401 - val_loss: 0.6872 - val_accuracy: 0.7867
Confusion matrix: 
 [[58  2]
 [14  1]]
Validation f1: 11.11
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.67
Validation recall: 6.67
Validation precision: 33.33
Validation AUC: 0.304595769536143
Validation class accuracies: [0.9666666666666667, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1111111111111111
column_sums: [72  3]
cm_sum: 75
The training is defaulting to either class.
Epoch 67/80
76/76 - 51s - loss: 0.6883 - accuracy: 0.7039 - val_loss: 0.6876 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.30996244838145903
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 68/80
76/76 - 50s - loss: 0.6881 - accuracy: 0.7171 - val_loss: 0.6880 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.310526688485361
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 69/80
76/76 - 49s - loss: 0.6873 - accuracy: 0.7303 - val_loss: 0.6877 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.31203124020550865
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 70/80
76/76 - 49s - loss: 0.6877 - accuracy: 0.7171 - val_loss: 0.6878 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.31106305052443173
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 71/80
76/76 - 49s - loss: 0.6878 - accuracy: 0.7237 - val_loss: 0.6877 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.31033047578211614
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 72/80
76/76 - 49s - loss: 0.6880 - accuracy: 0.7138 - val_loss: 0.6880 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.31262391839196935
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 73/80
76/76 - 49s - loss: 0.6879 - accuracy: 0.7171 - val_loss: 0.6878 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3118099909544529
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 74/80
76/76 - 49s - loss: 0.6879 - accuracy: 0.7138 - val_loss: 0.6877 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.312935975666244
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 75/80
76/76 - 49s - loss: 0.6882 - accuracy: 0.7204 - val_loss: 0.6882 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 20.00
Validation AUC: 0.31395590895418307
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 76/80
76/76 - 49s - loss: 0.6879 - accuracy: 0.7171 - val_loss: 0.6878 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 25.00
Validation AUC: 0.3127326193506497
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 77/80
76/76 - 49s - loss: 0.6880 - accuracy: 0.7072 - val_loss: 0.6883 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.00
Validation recall: 6.67
Validation precision: 20.00
Validation AUC: 0.3121129496470702
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 78/80
76/76 - 51s - loss: 0.6874 - accuracy: 0.7401 - val_loss: 0.6882 - val_accuracy: 0.7600
Confusion matrix: 
 [[56  4]
 [14  1]]
Validation f1: 10.00
Validation accuracy: 76.00
Validation recall: 6.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 20.00
Validation AUC: 0.31181832923480274
Validation class accuracies: [0.9333333333333333, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.1
column_sums: [70  5]
cm_sum: 75
The training is defaulting to either class.
Epoch 79/80
76/76 - 49s - loss: 0.6879 - accuracy: 0.7237 - val_loss: 0.6879 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 10.53
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.3142385731632512
Validation class accuracies: [0.95, 0.06666666666666667]
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.
Epoch 80/80
76/76 - 49s - loss: 0.6876 - accuracy: 0.7303 - val_loss: 0.6880 - val_accuracy: 0.7733
Confusion matrix: 
 [[57  3]
 [14  1]]
Validation f1: 10.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.33
Validation recall: 6.67
Validation precision: 25.00
Validation AUC: 0.311763431765696
Validation class accuracies: [0.95, 0.06666666666666667]

The metrics for the epoch with the best target metric are: 
Best cm: [[43 17]
 [ 7  8]]
Best f1: 0.4
Best accuracy: 0.68
Best recall: 0.5333333333333333
Best precision: 0.32
Best AUC: 0.31868219016078003
Best epoch: 10
TARGET: 1
target metric(test f1): 0.10526315789473685
column_sums: [71  4]
cm_sum: 75
The training is defaulting to either class.

Starting the Bangladesh analysis...
Epoch: 80
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2147.py", line 308, in <module>
    train_model(**arguments)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2147.py", line 257, in train_model
    bd_f1, bd_accuracy, bd_precision, bd_recall, bd_auc, bd_y_true, bd_y_pred = generate_bangladesh_sheet(model, grouped_val_samples, excel_dest, six, initial_channels)
TypeError: generate_bangladesh_sheet() missing 1 required positional argument: 'pneumonia_threshold'
wandb: Waiting for W&B process to finish, PID 32570
wandb: Program failed with code 1.  Press ctrl-c to abort syncing.
wandb: - 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: \ 0.03MB of 0.05MB uploaded (0.00MB deduped)wandb: | 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb: / 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb: - 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb: \ 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb: | 0.05MB of 0.05MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_172025-36qbzb3v/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210517_172025-36qbzb3v/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.73026
wandb:         val_accuracy 0.77333
wandb:             _runtime 4516
wandb:           _timestamp 1621276542
wandb:                _step 565
wandb:           train_loss 0.68759
wandb:             val_loss 0.68797
wandb:           val_recall 0.06667
wandb:        val_precision 0.25
wandb:               val_f1 0.10526
wandb:              val_auc 0.31176
wandb:                   lr 0.0
wandb:          best_val_f1 0.4
wandb:    best_val_accuracy 0.68
wandb:   best_val_precision 0.32
wandb:      best_val_recall 0.53333
wandb:             best_auc 0.31868
wandb:           best_epoch 10
wandb: Run history:
wandb:   train_accuracy ▁▃▂▃▅▅▄▄▄▆▅▆▆▇▇▇▆▆▆▇▇▇▇▇▆▇▆▇▇▆▇█▇▆▇▇▇▇▆▇
wandb:     val_accuracy ▁▁▁▇▇█▇██▅██████▇▇█▇████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▃▃▃▂▂▂▃▂▂▂▁▁▁▁▁▁▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▅▅▅▄▃▁▂▁▁█▂▂▁▁▂▁▃▃▁▃▁▁▁▂▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ███▃▁▁▂▁▁▇▂▂▁▁▁▁▃▃▁▃▁▁▁▁▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val_precision ▂▂▂▄▁▃▄█▂▃▆▅▃█▂▃▄▅█▅▅▅▅▂▂▃▇▃▃▂▂▂▃▃▃▃▃▂▂▃
wandb:           val_f1 ▇▇▇▆▁▁▄▂▁█▅▃▁▂▁▁▆▇▂▇▁▁▁▁▁▁▇▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_auc █▃▁▄▄▄▄▃▃▄▄▄▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:               lr ███████████▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 6 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2147: https://wandb.ai/arachid1/tensorboard-integration/runs/36qbzb3v


 See logs at ../../new_cache/conv__2147__05_1720__v29__mod9_concat/logs/