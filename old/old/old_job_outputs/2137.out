Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2137
Description:  mod9_oversampled_weightedf1
2021-05-13 15:42:28.919939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 15:42:31.357687: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-13 15:42:31.358725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-13 15:42:31.410328: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:31.411149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-13 15:42:31.411181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 15:42:31.414941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 15:42:31.415032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 15:42:31.416228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-13 15:42:31.416571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-13 15:42:31.417665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-13 15:42:31.418567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-13 15:42:31.418710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-13 15:42:31.418843: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:31.419621: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:31.420364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2137.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2137__05_1527__v29__mod9_oversampled_weightedf1/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 22, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2137
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/3qxzj4ib
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_154232-3qxzj4ib
wandb: Run `wandb offline` to turn off syncing.
2021-05-13 15:42:37.452769: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-13 15:42:37.453036: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:37.453829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-13 15:42:37.453873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 15:42:37.453934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 15:42:37.453956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 15:42:37.453979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-13 15:42:37.454000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-13 15:42:37.454022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-13 15:42:37.454044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-13 15:42:37.454064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-13 15:42:37.454146: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:37.454914: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:37.455608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-13 15:42:37.455655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-13 15:42:38.212308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-13 15:42:38.212357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-13 15:42:38.212367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-13 15:42:38.212669: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:38.213497: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:38.214262: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-13 15:42:38.214979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-13 15:43:16.571022: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-13 15:43:16.572931: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-13 15:43:19.961972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-13 15:43:20.734486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-13 15:43:20.743821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
1150
3046
6092
With concat = False and six = False, size of training set: 6092...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
weighted
Epoch 1/80
381/381 - 719s - loss: 0.7460 - accuracy: 0.5171 - val_loss: 0.5733 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 71.06
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 79.96
Validation precision: 63.94
Validation AUC: 0.24911946795629242
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.710602805984498
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
381/381 - 709s - loss: 0.6927 - accuracy: 0.5453 - val_loss: 0.6124 - val_accuracy: 0.6801
Confusion matrix: 
 [[697 173]
 [175  43]]
Validation f1: 67.96
Validation accuracy: 68.01
Validation recall: 68.01
Validation precision: 67.90
Validation AUC: 0.2090170207641307
Validation class accuracies: [0.8011494252873563, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.6795936829603884
column_sums: [872 216]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 3/80
381/381 - 709s - loss: 0.6845 - accuracy: 0.5530 - val_loss: 0.5110 - val_accuracy: 0.8006
Confusion matrix: 
 [[868   2]
 [215   3]]
Validation f1: 71.62
Validation accuracy: 80.06
Validation recall: 80.06
Validation precision: 76.11
Validation AUC: 0.19570189039886934
Validation class accuracies: [0.9977011494252873, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.7161753714938889
column_sums: [1083    5]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
381/381 - 707s - loss: 0.6773 - accuracy: 0.5716 - val_loss: 0.8134 - val_accuracy: 0.4338
Confusion matrix: 
 [[313 557]
 [ 59 159]]
Validation f1: 47.13
Validation accuracy: 43.38
Validation recall: 43.38
Validation precision: 71.73
Validation AUC: 0.23695908605804425
Validation class accuracies: [0.35977011494252875, 0.7293577981651376]
TARGET: 1
target metric(test f1): 0.47125469993726327
column_sums: [372 716]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6795936829603884 hasn't increased by 0 in 1 epochs
Epoch 5/80
381/381 - 708s - loss: 0.6679 - accuracy: 0.5794 - val_loss: 0.7104 - val_accuracy: 0.5551
Confusion matrix: 
 [[513 357]
 [127  91]]
Validation f1: 59.81
Validation accuracy: 55.51
Validation recall: 55.51
Validation precision: 68.17
Validation AUC: 0.22898980927615498
Validation class accuracies: [0.5896551724137931, 0.41743119266055045]
TARGET: 1
target metric(test f1): 0.5980814764901247
column_sums: [640 448]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6795936829603884 hasn't increased by 0 in 2 epochs
Epoch 6/80
381/381 - 706s - loss: 0.6631 - accuracy: 0.5898 - val_loss: 0.7899 - val_accuracy: 0.6131
Confusion matrix: 
 [[551 319]
 [102 116]]
Validation f1: 64.98
Validation accuracy: 61.31
Validation recall: 61.31
Validation precision: 72.82
Validation AUC: 0.2830704738601449
Validation class accuracies: [0.6333333333333333, 0.5321100917431193]
TARGET: 1
target metric(test f1): 0.6497787794016652
column_sums: [653 435]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6795936829603884 hasn't increased by 0 in 3 epochs
Epoch 7/80
381/381 - 706s - loss: 0.6572 - accuracy: 0.6000 - val_loss: 0.7843 - val_accuracy: 0.4375
Confusion matrix: 
 [[388 482]
 [130  88]]
Validation f1: 49.18
Validation accuracy: 43.75
Validation recall: 43.75
Validation precision: 62.99
Validation AUC: 0.1754503877373846
Validation class accuracies: [0.4459770114942529, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.4918088693515119
column_sums: [518 570]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.6795936829603884 hasn't increased by 0 in 4 epochs
Epoch 8/80
381/381 - 707s - loss: 0.6363 - accuracy: 0.6295 - val_loss: 0.6088 - val_accuracy: 0.6517
Confusion matrix: 
 [[635 235]
 [144  74]]
Validation f1: 67.21
Validation accuracy: 65.17
Validation recall: 65.17
Validation precision: 69.98
Validation AUC: 0.22947627132361365
Validation class accuracies: [0.7298850574712644, 0.3394495412844037]
TARGET: 1
target metric(test f1): 0.6721180710982333
column_sums: [779 309]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6795936829603884 hasn't increased by 0 in 5 epochs
Epoch 9/80
381/381 - 705s - loss: 0.6139 - accuracy: 0.6451 - val_loss: 0.6764 - val_accuracy: 0.5699
Confusion matrix: 
 [[529 341]
 [127  91]]
Validation f1: 61.05
Validation accuracy: 56.99
Validation recall: 56.99
Validation precision: 68.70
Validation AUC: 0.20114354330919731
Validation class accuracies: [0.6080459770114942, 0.41743119266055045]
TARGET: 1
target metric(test f1): 0.6105007324030529
column_sums: [656 432]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6795936829603884 hasn't increased by 0 in 6 epochs
Epoch 10/80
381/381 - 706s - loss: 0.6003 - accuracy: 0.6640 - val_loss: 0.7256 - val_accuracy: 0.6783
Confusion matrix: 
 [[683 187]
 [163  55]]
Validation f1: 68.45
Validation accuracy: 67.83
Validation recall: 67.83
Validation precision: 69.11
Validation AUC: 0.1972601568065767
Validation class accuracies: [0.7850574712643679, 0.25229357798165136]
TARGET: 1
target metric(test f1): 0.6844511786167797
column_sums: [846 242]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 11/80
381/381 - 705s - loss: 0.5846 - accuracy: 0.6804 - val_loss: 0.7314 - val_accuracy: 0.6103
Confusion matrix: 
 [[628 242]
 [182  36]]
Validation f1: 62.69
Validation accuracy: 61.03
Validation recall: 61.03
Validation precision: 64.59
Validation AUC: 0.16380787336260919
Validation class accuracies: [0.7218390804597701, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.6269060043372187
column_sums: [810 278]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 1 epochs
Epoch 12/80
381/381 - 705s - loss: 0.5631 - accuracy: 0.7003 - val_loss: 0.7373 - val_accuracy: 0.5790
Confusion matrix: 
 [[549 321]
 [137  81]]
Validation f1: 61.66
Validation accuracy: 57.90
Validation recall: 57.90
Validation precision: 68.03
Validation AUC: 0.19339626224011783
Validation class accuracies: [0.6310344827586207, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.6166191165495141
column_sums: [686 402]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 2 epochs
Epoch 13/80
381/381 - 706s - loss: 0.5373 - accuracy: 0.7219 - val_loss: 0.8196 - val_accuracy: 0.5983
Confusion matrix: 
 [[587 283]
 [154  64]]
Validation f1: 62.81
Validation accuracy: 59.83
Validation recall: 59.83
Validation precision: 67.04
Validation AUC: 0.18170827057391725
Validation class accuracies: [0.674712643678161, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.6281170358586902
column_sums: [741 347]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 3 epochs
Epoch 14/80
381/381 - 706s - loss: 0.5159 - accuracy: 0.7408 - val_loss: 0.8687 - val_accuracy: 0.5818
Confusion matrix: 
 [[573 297]
 [158  60]]
Validation f1: 61.42
Validation accuracy: 58.18
Validation recall: 58.18
Validation precision: 66.05
Validation AUC: 0.18138280639703136
Validation class accuracies: [0.6586206896551724, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.6141947927366368
column_sums: [731 357]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 4 epochs
Epoch 15/80
381/381 - 704s - loss: 0.4632 - accuracy: 0.7756 - val_loss: 0.9291 - val_accuracy: 0.6204
Confusion matrix: 
 [[607 263]
 [150  68]]
Validation f1: 64.63
Validation accuracy: 62.04
Validation recall: 62.04
Validation precision: 68.23
Validation AUC: 0.19575094195388282
Validation class accuracies: [0.6977011494252874, 0.3119266055045872]
TARGET: 1
target metric(test f1): 0.6462882375200291
column_sums: [757 331]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 5 epochs
Epoch 16/80
381/381 - 708s - loss: 0.4384 - accuracy: 0.7920 - val_loss: 0.9981 - val_accuracy: 0.6011
Confusion matrix: 
 [[580 290]
 [144  74]]
Validation f1: 63.29
Validation accuracy: 60.11
Validation recall: 60.11
Validation precision: 68.13
Validation AUC: 0.19520029532073474
Validation class accuracies: [0.6666666666666666, 0.3394495412844037]
TARGET: 1
target metric(test f1): 0.6328682370644515
column_sums: [724 364]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 6 epochs
Epoch 17/80
381/381 - 706s - loss: 0.4316 - accuracy: 0.7943 - val_loss: 1.2330 - val_accuracy: 0.5689
Confusion matrix: 
 [[534 336]
 [133  85]]
Validation f1: 60.89
Validation accuracy: 56.89
Validation recall: 56.89
Validation precision: 68.06
Validation AUC: 0.19174118309342084
Validation class accuracies: [0.6137931034482759, 0.38990825688073394]
TARGET: 1
target metric(test f1): 0.6089385772025172
column_sums: [667 421]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 7 epochs
Epoch 18/80
381/381 - 706s - loss: 0.4269 - accuracy: 0.8014 - val_loss: 1.2287 - val_accuracy: 0.5717
Confusion matrix: 
 [[534 336]
 [130  88]]
Validation f1: 61.16
Validation accuracy: 57.17
Validation recall: 57.17
Validation precision: 68.47
Validation AUC: 0.19866769758890895
Validation class accuracies: [0.6137931034482759, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.6116487136959599
column_sums: [664 424]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 8 epochs
Epoch 19/80
381/381 - 705s - loss: 0.4033 - accuracy: 0.8111 - val_loss: 1.1538 - val_accuracy: 0.5919
Confusion matrix: 
 [[567 303]
 [141  77]]
Validation f1: 62.62
Validation accuracy: 59.19
Validation recall: 59.19
Validation precision: 68.10
Validation AUC: 0.19682721400873235
Validation class accuracies: [0.6517241379310345, 0.3532110091743119]
TARGET: 1
target metric(test f1): 0.62624043538852
column_sums: [708 380]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 9 epochs
Epoch 20/80
381/381 - 707s - loss: 0.3984 - accuracy: 0.8157 - val_loss: 1.1550 - val_accuracy: 0.5910
Confusion matrix: 
 [[566 304]
 [141  77]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.55
Validation accuracy: 59.10
Validation recall: 59.10
Validation precision: 68.07
Validation AUC: 0.19285624260264045
Validation class accuracies: [0.6505747126436782, 0.3532110091743119]
TARGET: 1
target metric(test f1): 0.6255045624799835
column_sums: [707 381]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 10 epochs
Epoch 21/80
381/381 - 708s - loss: 0.3969 - accuracy: 0.8178 - val_loss: 1.1223 - val_accuracy: 0.5919
Confusion matrix: 
 [[571 299]
 [145  73]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.54
Validation accuracy: 59.19
Validation recall: 59.19
Validation precision: 67.70
Validation AUC: 0.19302246395235578
Validation class accuracies: [0.6563218390804598, 0.3348623853211009]
TARGET: 1
target metric(test f1): 0.6253581311550845
column_sums: [716 372]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 11 epochs
Epoch 22/80
381/381 - 705s - loss: 0.4130 - accuracy: 0.8066 - val_loss: 1.1317 - val_accuracy: 0.5947
Confusion matrix: 
 [[576 294]
 [147  71]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.71
Validation accuracy: 59.47
Validation recall: 59.47
Validation precision: 67.60
Validation AUC: 0.1930723879631931
Validation class accuracies: [0.6620689655172414, 0.3256880733944954]
TARGET: 1
target metric(test f1): 0.6270683019551979
column_sums: [723 365]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 12 epochs
Epoch 23/80
381/381 - 708s - loss: 0.3923 - accuracy: 0.8152 - val_loss: 1.1696 - val_accuracy: 0.5910
Confusion matrix: 
 [[567 303]
 [142  76]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.53
Validation accuracy: 59.10
Validation recall: 59.10
Validation precision: 67.97
Validation AUC: 0.19479623280865963
Validation class accuracies: [0.6517241379310345, 0.3486238532110092]
TARGET: 1
target metric(test f1): 0.6252916916350431
column_sums: [709 379]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 13 epochs
Epoch 24/80
381/381 - 706s - loss: 0.3926 - accuracy: 0.8194 - val_loss: 1.2533 - val_accuracy: 0.5689
Confusion matrix: 
 [[538 332]
 [137  81]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 60.83
Validation accuracy: 56.89
Validation recall: 56.89
Validation precision: 67.66
Validation AUC: 0.19614737724790354
Validation class accuracies: [0.6183908045977011, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.608337515533347
column_sums: [675 413]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 14 epochs
Epoch 25/80
381/381 - 707s - loss: 0.3952 - accuracy: 0.8162 - val_loss: 1.3513 - val_accuracy: 0.5579
Confusion matrix: 
 [[519 351]
 [130  88]]
Validation f1: 60.01
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 55.79
Validation recall: 55.79
Validation precision: 67.96
Validation AUC: 0.19713699459829762
Validation class accuracies: [0.596551724137931, 0.4036697247706422]
TARGET: 1
target metric(test f1): 0.6000995662663358
column_sums: [649 439]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 15 epochs
Epoch 26/80
381/381 - 706s - loss: 0.4006 - accuracy: 0.8124 - val_loss: 1.1777 - val_accuracy: 0.5928
Confusion matrix: 
 [[571 299]
 [144  74]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.63
Validation accuracy: 59.28
Validation recall: 59.28
Validation precision: 67.83
Validation AUC: 0.19417272907834876
Validation class accuracies: [0.6563218390804598, 0.3394495412844037]
TARGET: 1
target metric(test f1): 0.6263155636960543
column_sums: [715 373]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 16 epochs
Epoch 27/80
381/381 - 706s - loss: 0.3957 - accuracy: 0.8196 - val_loss: 1.1418 - val_accuracy: 0.5965
Confusion matrix: 
 [[577 293]
 [146  72]]
Validation f1: 62.88
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 59.65
Validation recall: 59.65
Validation precision: 67.77
Validation AUC: 0.19480639499848013
Validation class accuracies: [0.6632183908045977, 0.3302752293577982]
TARGET: 1
target metric(test f1): 0.628759602173088
column_sums: [723 365]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 17 epochs
Epoch 28/80
381/381 - 704s - loss: 0.3995 - accuracy: 0.8163 - val_loss: 1.1906 - val_accuracy: 0.5818
Confusion matrix: 
 [[559 311]
 [144  74]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 61.75
Validation accuracy: 58.18
Validation recall: 58.18
Validation precision: 67.44
Validation AUC: 0.19405947468635734
Validation class accuracies: [0.6425287356321839, 0.3394495412844037]
TARGET: 1
target metric(test f1): 0.6175118674170872
column_sums: [703 385]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 18 epochs
Epoch 29/80
381/381 - 707s - loss: 0.3964 - accuracy: 0.8186 - val_loss: 1.1559 - val_accuracy: 0.5892
Confusion matrix: 
 [[569 301]
 [146  72]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.29
Validation accuracy: 58.92
Validation recall: 58.92
Validation precision: 67.50
Validation AUC: 0.19421615604535325
Validation class accuracies: [0.6540229885057471, 0.3302752293577982]
TARGET: 1
target metric(test f1): 0.6229414378603528
column_sums: [715 373]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 19 epochs
Epoch 30/80
381/381 - 706s - loss: 0.3926 - accuracy: 0.8181 - val_loss: 1.2278 - val_accuracy: 0.5699
Confusion matrix: 
 [[542 328]
 [140  78]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 60.86
Validation accuracy: 56.99
Validation recall: 56.99
Validation precision: 67.40
Validation AUC: 0.1951007632531964
Validation class accuracies: [0.6229885057471264, 0.3577981651376147]
TARGET: 1
target metric(test f1): 0.6085980139478471
column_sums: [682 406]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 20 epochs
Epoch 31/80
381/381 - 704s - loss: 0.3993 - accuracy: 0.8127 - val_loss: 1.1848 - val_accuracy: 0.5928
Confusion matrix: 
 [[571 299]
 [144  74]]
Validation f1: 62.63
Validation accuracy: 59.28
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 59.28
Validation precision: 67.83
Validation AUC: 0.1945985447650081
Validation class accuracies: [0.6563218390804598, 0.3394495412844037]
TARGET: 1
target metric(test f1): 0.6263155636960543
column_sums: [715 373]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.6844511786167797 hasn't increased by 0 in 21 epochs
Epoch 32/80
381/381 - 704s - loss: 0.3963 - accuracy: 0.8162 - val_loss: 1.1640 - val_accuracy: 0.5910
Confusion matrix: 
 [[572 298]
 [147  71]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 62.42
Validation accuracy: 59.10
Validation recall: 59.10
Validation precision: 67.47
Validation AUC: 0.1944975434002314
Validation class accuracies: [0.6574712643678161, 0.3256880733944954]

The metrics for the epoch with the best target metric are: 
Best cm: [[683 187]
 [163  55]]
Best f1: 0.6844511786167797
Best accuracy: 0.6783088235294118
Best recall: 0.6783088235294118
Best precision: 0.6911041737778283
Best AUC: 0.1972601568065767
Best epoch: 10
TARGET: 1
target metric(test f1): 0.6241655738536137
column_sums: [719 369]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 10
Starting...
CM: [[21 39]
 [ 3 12]]
F1: 0.3636363636363636
AUC: 0.5376470588235294
Accuracy: 0.44
Precision: 0.23529411764705882
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2137__05_1527__v29__mod9_oversampled_weightedf1/validation_sheet_10.xls...
Done.
Epoch: 2
Starting...
CM: [[27 33]
 [ 6  9]]
F1: 0.3157894736842105
AUC: 0.4471428571428571
Accuracy: 0.48
Precision: 0.21428571428571427
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2137__05_1527__v29__mod9_oversampled_weightedf1/validation_sheet_2.xls...
Done.
Epoch: 80
Starting...
CM: [[ 5 55]
 [ 0 15]]
F1: 0.35294117647058826
AUC: 0.6071428571428571
Accuracy: 0.26666666666666666
Precision: 0.21428571428571427
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2137__05_1527__v29__mod9_oversampled_weightedf1/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 6753
wandb: Program ended successfully.
wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_154232-3qxzj4ib/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210513_154232-3qxzj4ib/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.81615
wandb:         val_accuracy 0.59099
wandb:             _runtime 23454
wandb:           _timestamp 1620944006
wandb:                _step 230
wandb:           train_loss 0.39631
wandb:             val_loss 1.16397
wandb:           val_recall 0.59099
wandb:        val_precision 0.6747
wandb:               val_f1 0.62417
wandb:              val_auc 0.1945
wandb:                   lr 0.0
wandb:          best_val_f1 0.68445
wandb:    best_val_accuracy 0.67831
wandb:   best_val_precision 0.6911
wandb:      best_val_recall 0.67831
wandb:             best_auc 0.19726
wandb:           best_epoch 10
wandb:           best_bd_f1 0.36364
wandb:          best_bd_auc 0.53765
wandb:     best_bd_accuracy 0.44
wandb:    best_bd_precision 0.23529
wandb:       best_bd_recall 0.8
wandb:        best_bd_epoch 10
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▃▃▄▄▄▅▅▆▆▇▇▇███████████████
wandb:     val_accuracy █▆█▁▃▄▁▅▄▆▄▄▄▄▅▄▄▄▄▄▄▄▄▄▃▄▄▄▄▄▄▄
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▇▇▆▆▆▆▅▅▅▄▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▁▄▃▃▃▂▂▃▃▃▄▄▄▅▇▇▆▆▆▆▆▇█▇▆▇▆▇▇▆
wandb:       val_recall █▆█▁▃▄▁▅▄▆▄▄▄▄▅▄▄▄▄▄▄▄▄▄▃▄▄▄▄▄▄▄
wandb:    val_precision ▂▄█▆▄▆▁▅▄▄▂▄▃▃▄▄▄▄▄▄▄▃▄▃▄▄▄▃▃▃▄▃
wandb:           val_f1 █▇█▁▅▆▂▇▅▇▅▅▅▅▆▆▅▅▅▅▅▅▅▅▅▅▆▅▅▅▅▅
wandb:          val_auc ▆▄▃▅▅█▂▅▃▃▁▃▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:               lr ███████▃▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 7 media file(s), 5 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2137: https://wandb.ai/arachid1/tensorboard-integration/runs/3qxzj4ib


 See logs at ../../new_cache/conv__2137__05_1527__v29__mod9_oversampled_weightedf1/logs/