Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2021
Description:  redo
2021-03-29 16:34:07.541776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-29 16:34:13.166312: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-29 16:34:13.179312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-03-29 16:34:13.253422: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:13.254238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-03-29 16:34:13.254285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-29 16:34:13.286858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-29 16:34:13.286959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-29 16:34:13.303032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-29 16:34:13.310710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-29 16:34:13.319351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-29 16:34:13.329442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-29 16:34:13.332318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-29 16:34:13.332501: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:13.333301: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:13.333995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-29 16:34:13.337899: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-29 16:34:13.338091: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:13.338772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-03-29 16:34:13.338795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-29 16:34:13.338823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-29 16:34:13.338837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-29 16:34:13.338851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-29 16:34:13.338864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-29 16:34:13.338885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-29 16:34:13.338899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-29 16:34:13.338912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-29 16:34:13.338981: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:13.339696: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:13.340411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-29 16:34:13.341074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-29 16:34:14.792560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-29 16:34:14.792605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-03-29 16:34:14.792614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-03-29 16:34:14.792943: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:14.793780: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:14.794461: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-29 16:34:14.795130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-03-29 16:34:15.302336: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-29 16:34:15.302384: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-29 16:34:15.304258: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-03-29 16:34:15.304592: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-03-29 16:34:15.323207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-03-29 16:34:15.539806: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-03-29 16:34:15.542805: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2021.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___03_1632___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___redo___2021/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 8, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        2021-03-29 16:34:16.740130: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-03-29 16:34:16.742834: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-03-29 16:34:22.154815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-29 16:34:23.771634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-29 16:34:23.808955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-29 16:34:34.496542: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-29 16:34:34.496588: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-29 16:34:36.875615: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-03-29 16:34:36.879663: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-03-29 16:34:36.929946: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 2390 callback api events and 2386 activity events. 
2021-03-29 16:34:36.995939: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.

__________________________________________________________________________________________________
dense_mo_e (DenseMoE)           (None, 1024)         1051650     global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            2050        dense_mo_e[0][0]                 
==================================================================================================
Total params: 7,253,936
Trainable params: 7,212,426
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
872/872 - 1664s - loss: 0.3583 - calc_accuracy: 0.6131 - val_loss: 0.6732 - val_calc_accuracy: 0.4994
Epoch 2/40
872/872 - 1654s - loss: 0.2618 - calc_accuracy: 0.7266 - val_loss: 0.5467 - val_calc_accuracy: 0.5958
Epoch 3/40
872/872 - 1654s - loss: 0.2414 - calc_accuracy: 0.7485 - val_loss: 0.3794 - val_calc_accuracy: 0.7390
Epoch 4/40
872/872 - 1679s - loss: 0.2251 - calc_accuracy: 0.7588 - val_loss: 0.2483 - val_calc_accuracy: 0.8093
Epoch 5/40
872/872 - 1692s - loss: 0.2080 - calc_accuracy: 0.7831 - val_loss: 0.2764 - val_calc_accuracy: 0.7980
Epoch 6/40
872/872 - 1703s - loss: 0.1844 - calc_accuracy: 0.8082 - val_loss: 0.3009 - val_calc_accuracy: 0.7987
Epoch 7/40
872/872 - 1693s - loss: 0.1707 - calc_accuracy: 0.8252 - val_loss: 0.2850 - val_calc_accuracy: 0.7852

Epoch 00007: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
Epoch 8/40
872/872 - 1688s - loss: 0.1482 - calc_accuracy: 0.8461 - val_loss: 0.2978 - val_calc_accuracy: 0.8158
Epoch 9/40
872/872 - 1682s - loss: 0.1417 - calc_accuracy: 0.8572 - val_loss: 0.1995 - val_calc_accuracy: 0.8657
Epoch 10/40
872/872 - 1690s - loss: 0.1345 - calc_accuracy: 0.8626 - val_loss: 0.2111 - val_calc_accuracy: 0.8620
Epoch 11/40
872/872 - 1704s - loss: 0.1308 - calc_accuracy: 0.8677 - val_loss: 0.1911 - val_calc_accuracy: 0.8543
Epoch 12/40
872/872 - 1710s - loss: 0.1255 - calc_accuracy: 0.8731 - val_loss: 0.1569 - val_calc_accuracy: 0.8838
Epoch 13/40
872/872 - 1693s - loss: 0.1211 - calc_accuracy: 0.8773 - val_loss: 0.3237 - val_calc_accuracy: 0.8096
Epoch 14/40
872/872 - 1678s - loss: 0.1159 - calc_accuracy: 0.8862 - val_loss: 0.2148 - val_calc_accuracy: 0.8686
Epoch 15/40
872/872 - 1667s - loss: 0.1106 - calc_accuracy: 0.8873 - val_loss: 0.1667 - val_calc_accuracy: 0.8842
Epoch 16/40
872/872 - 1666s - loss: 0.1069 - calc_accuracy: 0.8894 - val_loss: 0.1755 - val_calc_accuracy: 0.8795
Epoch 17/40
872/872 - 1661s - loss: 0.1036 - calc_accuracy: 0.8950 - val_loss: 0.1692 - val_calc_accuracy: 0.8827
Epoch 18/40
872/872 - 1665s - loss: 0.0974 - calc_accuracy: 0.8985 - val_loss: 0.1699 - val_calc_accuracy: 0.8793

Epoch 00018: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
Epoch 19/40
872/872 - 1665s - loss: 0.0857 - calc_accuracy: 0.9128 - val_loss: 0.1938 - val_calc_accuracy: 0.8886
Epoch 20/40
872/872 - 1670s - loss: 0.0817 - calc_accuracy: 0.9181 - val_loss: 0.1418 - val_calc_accuracy: 0.9056
Epoch 21/40
872/872 - 1662s - loss: 0.0780 - calc_accuracy: 0.9191 - val_loss: 0.1443 - val_calc_accuracy: 0.9031
Epoch 22/40
872/872 - 1665s - loss: 0.0777 - calc_accuracy: 0.9209 - val_loss: 0.1650 - val_calc_accuracy: 0.8985
Epoch 23/40
872/872 - 1662s - loss: 0.0744 - calc_accuracy: 0.9238 - val_loss: 0.1793 - val_calc_accuracy: 0.8942

Epoch 00023: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
Epoch 24/40
872/872 - 1664s - loss: 0.0656 - calc_accuracy: 0.9330 - val_loss: 0.1488 - val_calc_accuracy: 0.9053
Epoch 25/40
872/872 - 1664s - loss: 0.0649 - calc_accuracy: 0.9341 - val_loss: 0.1472 - val_calc_accuracy: 0.9042
Epoch 26/40
872/872 - 1662s - loss: 0.0615 - calc_accuracy: 0.9352 - val_loss: 0.1436 - val_calc_accuracy: 0.9139
Epoch 27/40
872/872 - 1665s - loss: 0.0596 - calc_accuracy: 0.9384 - val_loss: 0.1548 - val_calc_accuracy: 0.9048
Epoch 28/40
872/872 - 1663s - loss: 0.0587 - calc_accuracy: 0.9392 - val_loss: 0.1428 - val_calc_accuracy: 0.9147
Using TensorFlow backend.
Epoch 00028: early stopping
local_gc_exec.sh: line 9: unexpected EOF while looking for matching `"'
local_gc_exec.sh: line 10: syntax error: unexpected end of file
