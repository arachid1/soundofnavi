Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2231
Description:  pitch_shifting
2021-06-21 15:35:36.731620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-21 15:35:38.941452: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-21 15:35:38.942353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-21 15:35:38.991181: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:38.991897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-21 15:35:38.991925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 15:35:38.995481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 15:35:38.995570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-21 15:35:38.996747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-21 15:35:38.997061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-21 15:35:38.998075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-21 15:35:38.998988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-21 15:35:38.999160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 15:35:38.999269: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:39.000065: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:39.000761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2231.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2231__06_1535__v39__pitch_shifting
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 148, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 148, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-21 15:35:43.690484: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-21 15:35:43.690720: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:43.691486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-21 15:35:43.691524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 15:35:43.691570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 15:35:43.691588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-21 15:35:43.691607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-21 15:35:43.691624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-21 15:35:43.691642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-21 15:35:43.691659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-21 15:35:43.691675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 15:35:43.691759: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:43.692468: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:43.693169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-21 15:35:43.693216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 15:35:44.384601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-21 15:35:44.384648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-21 15:35:44.384657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-21 15:35:44.384987: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:44.385785: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:44.386531: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:35:44.387238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2682
-----------------------
Number of train recordings: 2682 with pneumonia: 232 and non-pneumonia: 2450
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
The initial learning rate for this job is: 0.000900820283370619
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-21 15:35:45.659216: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-21 15:35:45.661739: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-21 15:35:46.021991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 15:35:47.749511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 15:35:48.188878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
168/168 - 261s - loss: 1.1391 - accuracy: 0.5988 - val_loss: 1.0555 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.05006837589920231
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
168/168 - 255s - loss: 0.6903 - accuracy: 0.6219 - val_loss: 0.4700 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.15692073591113587
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
168/168 - 256s - loss: 0.6044 - accuracy: 0.6435 - val_loss: 0.2092 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.12458678919299312
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/65
168/168 - 255s - loss: 0.5170 - accuracy: 0.6987 - val_loss: 0.3179 - val_accuracy: 0.8661
Confusion matrix: 
 [[506  67]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.438 0.562]]
Validation f1: 30.77
Validation accuracy: 86.61
Validation recall: 56.25
Validation precision: 21.18
Validation AUC: 0.45191580305104295
Validation class accuracies: [0.8830715532286213, 0.5625]
Saving model...
Epoch 5/65
168/168 - 255s - loss: 0.4630 - accuracy: 0.7528 - val_loss: 0.4503 - val_accuracy: 0.7884
Confusion matrix: 
 [[459 114]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.801 0.199]
 [0.438 0.562]]
Validation f1: 21.95
Validation accuracy: 78.84
Validation recall: 56.25
Validation precision: 13.64
Validation AUC: 0.18299315933673865
Validation class accuracies: [0.8010471204188482, 0.5625]
The validation tracker metric at 0.30769230769230765 hasn't increased by 0 in 1 epochs
Epoch 6/65
168/168 - 255s - loss: 0.4284 - accuracy: 0.7718 - val_loss: 1.3095 - val_accuracy: 0.6992
Confusion matrix: 
 [[394 179]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.688 0.312]
 [0.094 0.906]]
Validation f1: 24.17
Validation accuracy: 69.92
Validation recall: 90.62
Validation precision: 13.94
Validation AUC: 0.5292736892412535
Validation class accuracies: [0.68760907504363, 0.90625]
The validation tracker metric at 0.30769230769230765 hasn't increased by 0 in 2 epochs
Epoch 7/65
168/168 - 255s - loss: 0.3391 - accuracy: 0.8214 - val_loss: 2.4178 - val_accuracy: 0.2314
Confusion matrix: 
 [[113 460]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.197 0.803]
 [0.156 0.844]]
Validation f1: 10.40
Validation accuracy: 23.14
Validation recall: 84.38
Validation precision: 5.54
Validation AUC: 0.38695859073284383
Validation class accuracies: [0.19720767888307156, 0.84375]
The validation tracker metric at 0.30769230769230765 hasn't increased by 0 in 3 epochs
Epoch 8/65
168/168 - 255s - loss: 0.2950 - accuracy: 0.8527 - val_loss: 1.1597 - val_accuracy: 0.6496
Confusion matrix: 
 [[372 201]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.649 0.351]
 [0.344 0.656]]
Validation f1: 16.54
Validation accuracy: 64.96
Validation recall: 65.62
Validation precision: 9.46
Validation AUC: 0.3145500185814856
Validation class accuracies: [0.6492146596858639, 0.65625]
The validation tracker metric at 0.30769230769230765 hasn't increased by 0 in 4 epochs
Epoch 9/65
168/168 - 255s - loss: 0.2434 - accuracy: 0.8758 - val_loss: 0.3422 - val_accuracy: 0.9273
Confusion matrix: 
 [[551  22]
 [ 22  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.688 0.312]]
Validation f1: 31.25
Validation accuracy: 92.73
Validation recall: 31.25
Validation precision: 31.25
Validation AUC: 0.13961118973397607
Validation class accuracies: [0.9616055846422339, 0.3125]
Saving model...
Epoch 10/65
168/168 - 256s - loss: 0.3249 - accuracy: 0.8848 - val_loss: 2.3000 - val_accuracy: 0.4628
Confusion matrix: 
 [[272 301]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.475 0.525]
 [0.75  0.25 ]]
Validation f1: 4.69
Validation accuracy: 46.28
Validation recall: 25.00
Validation precision: 2.59
Validation AUC: 0.03380468976875458
Validation class accuracies: [0.47469458987783597, 0.25]
The validation tracker metric at 0.3125 hasn't increased by 0 in 1 epochs
Epoch 11/65
168/168 - 255s - loss: 0.2345 - accuracy: 0.8680 - val_loss: 1.1101 - val_accuracy: 0.6050
Confusion matrix: 
 [[339 234]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.592 0.408]
 [0.156 0.844]]
Validation f1: 18.43
Validation accuracy: 60.50
Validation recall: 84.38
Validation precision: 10.34
Validation AUC: 0.442419616210371
Validation class accuracies: [0.5916230366492147, 0.84375]
The validation tracker metric at 0.3125 hasn't increased by 0 in 2 epochs
Epoch 12/65
168/168 - 255s - loss: 0.1759 - accuracy: 0.8997 - val_loss: 0.2292 - val_accuracy: 0.9455
Confusion matrix: 
 [[568   5]
 [ 28   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.875 0.125]]
Validation f1: 19.51
Validation accuracy: 94.55
Validation recall: 12.50
Validation precision: 44.44
Validation AUC: 0.23042296652868438
Validation class accuracies: [0.9912739965095986, 0.125]
The validation tracker metric at 0.3125 hasn't increased by 0 in 3 epochs
Epoch 13/65
168/168 - 255s - loss: 0.1918 - accuracy: 0.9101 - val_loss: 0.9997 - val_accuracy: 0.5355
Confusion matrix: 
 [[297 276]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.518 0.482]
 [0.156 0.844]]
Validation f1: 16.12
Validation accuracy: 53.55
Validation recall: 84.38
Validation precision: 8.91
Validation AUC: 0.42502575763314326
Validation class accuracies: [0.518324607329843, 0.84375]
The validation tracker metric at 0.3125 hasn't increased by 0 in 4 epochs
Epoch 14/65
168/168 - 256s - loss: 0.1577 - accuracy: 0.9210 - val_loss: 1.4257 - val_accuracy: 0.6066
Confusion matrix: 
 [[341 232]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.595 0.405]
 [0.188 0.812]]
Validation f1: 17.93
Validation accuracy: 60.66
Validation recall: 81.25
Validation precision: 10.08
Validation AUC: 0.16962224657595262
Validation class accuracies: [0.5951134380453752, 0.8125]
The validation tracker metric at 0.3125 hasn't increased by 0 in 5 epochs
Epoch 15/65
168/168 - 256s - loss: 0.1373 - accuracy: 0.9452 - val_loss: 3.1694 - val_accuracy: 0.4711
Confusion matrix: 
 [[269 304]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.469 0.531]
 [0.5   0.5  ]]
Validation f1: 9.09
Validation accuracy: 47.11
Validation recall: 50.00
Validation precision: 5.00
Validation AUC: 0.04386256968739827
Validation class accuracies: [0.4694589877835951, 0.5]
The validation tracker metric at 0.3125 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
168/168 - 255s - loss: 0.1493 - accuracy: 0.9292 - val_loss: 0.5948 - val_accuracy: 0.7769
Confusion matrix: 
 [[447 126]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78  0.22 ]
 [0.281 0.719]]
Validation f1: 25.41
Validation accuracy: 77.69
Validation recall: 71.88
Validation precision: 15.44
Validation AUC: 0.5313113987823341
Validation class accuracies: [0.7801047120418848, 0.71875]
The validation tracker metric at 0.3125 hasn't increased by 0 in 7 epochs
Epoch 17/65
168/168 - 255s - loss: 0.0615 - accuracy: 0.9698 - val_loss: 0.3677 - val_accuracy: 0.8711
Confusion matrix: 
 [[505  68]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.312 0.688]]
Validation f1: 36.07
Validation accuracy: 87.11
Validation recall: 68.75
Validation precision: 24.44
Validation AUC: 0.5490035000618028
Validation class accuracies: [0.881326352530541, 0.6875]
Saving model...
Epoch 18/65
168/168 - 256s - loss: 0.0538 - accuracy: 0.9787 - val_loss: 0.3796 - val_accuracy: 0.8777
Confusion matrix: 
 [[505  68]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.188 0.812]]
Validation f1: 41.27
Validation accuracy: 87.77
Validation recall: 81.25
Validation precision: 27.66
Validation AUC: 0.6031893786751907
Validation class accuracies: [0.881326352530541, 0.8125]
Saving model...
Epoch 19/65
168/168 - 256s - loss: 0.0383 - accuracy: 0.9832 - val_loss: 0.4414 - val_accuracy: 0.8215
Confusion matrix: 
 [[479  94]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.836 0.164]
 [0.438 0.562]]
Validation f1: 25.00
Validation accuracy: 82.15
Validation recall: 56.25
Validation precision: 16.07
Validation AUC: 0.461972693793416
Validation class accuracies: [0.8359511343804538, 0.5625]
The validation tracker metric at 0.4126984126984127 hasn't increased by 0 in 1 epochs
Epoch 20/65
168/168 - 255s - loss: 0.0354 - accuracy: 0.9840 - val_loss: 0.1840 - val_accuracy: 0.9405
Confusion matrix: 
 [[553  20]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.5   0.5  ]]
Validation f1: 47.06
Validation accuracy: 94.05
Validation recall: 50.00
Validation precision: 44.44
Validation AUC: 0.5309316502322423
Validation class accuracies: [0.9650959860383944, 0.5]
Saving model...
Epoch 21/65
168/168 - 256s - loss: 0.0265 - accuracy: 0.9899 - val_loss: 0.1763 - val_accuracy: 0.9521
Confusion matrix: 
 [[562  11]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.562 0.438]]
Validation f1: 49.12
Validation accuracy: 95.21
Validation recall: 43.75
Validation precision: 56.00
Validation AUC: 0.5190534085898001
Validation class accuracies: [0.9808027923211169, 0.4375]
Saving model...
Epoch 22/65
168/168 - 256s - loss: 0.0297 - accuracy: 0.9870 - val_loss: 0.2051 - val_accuracy: 0.9388
Confusion matrix: 
 [[553  20]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.531 0.469]]
Validation f1: 44.78
Validation accuracy: 93.88
Validation recall: 46.88
Validation precision: 42.86
Validation AUC: 0.5030014154503337
Validation class accuracies: [0.9650959860383944, 0.46875]
The validation tracker metric at 0.4912280701754386 hasn't increased by 0 in 1 epochs
Epoch 23/65
168/168 - 256s - loss: 0.0905 - accuracy: 0.9668 - val_loss: 2.7684 - val_accuracy: 0.4975
Confusion matrix: 
 [[272 301]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.475 0.525]
 [0.094 0.906]]
Validation f1: 16.02
Validation accuracy: 49.75
Validation recall: 90.62
Validation precision: 8.79
Validation AUC: 0.45158397202779954
Validation class accuracies: [0.47469458987783597, 0.90625]
The validation tracker metric at 0.4912280701754386 hasn't increased by 0 in 2 epochs
Epoch 24/65
168/168 - 256s - loss: 0.0818 - accuracy: 0.9683 - val_loss: 1.8450 - val_accuracy: 0.6017
Confusion matrix: 
 [[335 238]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.585 0.415]
 [0.094 0.906]]
Validation f1: 19.40
Validation accuracy: 60.17
Validation recall: 90.62
Validation precision: 10.86
Validation AUC: 0.6169891837720825
Validation class accuracies: [0.5846422338568935, 0.90625]
The validation tracker metric at 0.4912280701754386 hasn't increased by 0 in 3 epochs
Epoch 25/65
168/168 - 255s - loss: 0.0531 - accuracy: 0.9787 - val_loss: 0.3530 - val_accuracy: 0.9041
Confusion matrix: 
 [[521  52]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.188 0.812]]
Validation f1: 47.27
Validation accuracy: 90.41
Validation recall: 81.25
Validation precision: 33.33
Validation AUC: 0.6261401666509578
Validation class accuracies: [0.9092495636998255, 0.8125]
The validation tracker metric at 0.4912280701754386 hasn't increased by 0 in 4 epochs
Epoch 26/65
168/168 - 256s - loss: 0.0433 - accuracy: 0.9847 - val_loss: 0.3482 - val_accuracy: 0.8826
Confusion matrix: 
 [[512  61]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.312 0.688]]
Validation f1: 38.26
Validation accuracy: 88.26
Validation recall: 68.75
Validation precision: 26.51
Validation AUC: 0.6372660350611234
Validation class accuracies: [0.893542757417103, 0.6875]
The validation tracker metric at 0.4912280701754386 hasn't increased by 0 in 5 epochs
Epoch 27/65
168/168 - 255s - loss: 0.0277 - accuracy: 0.9877 - val_loss: 0.1650 - val_accuracy: 0.9537
Confusion matrix: 
 [[560  13]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.469 0.531]]
Validation f1: 54.84
Validation accuracy: 95.37
Validation recall: 53.12
Validation precision: 56.67
Validation AUC: 0.6058857959720148
Validation class accuracies: [0.9773123909249564, 0.53125]
Saving model...
Epoch 28/65
168/168 - 256s - loss: 0.0162 - accuracy: 0.9944 - val_loss: 0.2068 - val_accuracy: 0.9355
Confusion matrix: 
 [[551  22]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.531 0.469]]
Validation f1: 43.48
Validation accuracy: 93.55
Validation recall: 46.88
Validation precision: 40.54
Validation AUC: 0.5276435986411321
Validation class accuracies: [0.9616055846422339, 0.46875]
The validation tracker metric at 0.5483870967741935 hasn't increased by 0 in 1 epochs
Epoch 29/65
168/168 - 255s - loss: 0.0123 - accuracy: 0.9952 - val_loss: 0.1932 - val_accuracy: 0.9421
Confusion matrix: 
 [[548  25]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.312 0.688]]
Validation f1: 55.70
Validation accuracy: 94.21
Validation recall: 68.75
Validation precision: 46.81
Validation AUC: 0.6215655211106982
Validation class accuracies: [0.956369982547993, 0.6875]
Saving model...
Epoch 30/65
168/168 - 256s - loss: 0.0204 - accuracy: 0.9944 - val_loss: 0.9681 - val_accuracy: 0.7736
Confusion matrix: 
 [[442 131]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.771 0.229]
 [0.188 0.812]]
Validation f1: 27.51
Validation accuracy: 77.36
Validation recall: 81.25
Validation precision: 16.56
Validation AUC: 0.5233556619759925
Validation class accuracies: [0.7713787085514834, 0.8125]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 1 epochs
Epoch 31/65
168/168 - 255s - loss: 0.0224 - accuracy: 0.9911 - val_loss: 0.2657 - val_accuracy: 0.9107
Confusion matrix: 
 [[535  38]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.5   0.5  ]]
Validation f1: 37.21
Validation accuracy: 91.07
Validation recall: 50.00
Validation precision: 29.63
Validation AUC: 0.5103019198658456
Validation class accuracies: [0.9336823734729494, 0.5]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 2 epochs
Epoch 32/65
168/168 - 255s - loss: 0.0111 - accuracy: 0.9955 - val_loss: 0.2335 - val_accuracy: 0.9455
Confusion matrix: 
 [[559  14]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.594 0.406]]
Validation f1: 44.07
Validation accuracy: 94.55
Validation recall: 40.62
Validation precision: 48.15
Validation AUC: 0.47103174374692774
Validation class accuracies: [0.9755671902268761, 0.40625]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 3 epochs
Epoch 33/65
168/168 - 255s - loss: 0.0130 - accuracy: 0.9963 - val_loss: 0.3908 - val_accuracy: 0.8694
Confusion matrix: 
 [[507  66]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.406 0.594]]
Validation f1: 32.48
Validation accuracy: 86.94
Validation recall: 59.38
Validation precision: 22.35
Validation AUC: 0.4701802456706416
Validation class accuracies: [0.8848167539267016, 0.59375]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 4 epochs
Epoch 34/65
168/168 - 255s - loss: 0.0132 - accuracy: 0.9963 - val_loss: 0.2719 - val_accuracy: 0.9405
Confusion matrix: 
 [[556  17]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.594 0.406]]
Validation f1: 41.94
Validation accuracy: 94.05
Validation recall: 40.62
Validation precision: 43.33
Validation AUC: 0.4182966392868391
Validation class accuracies: [0.9703315881326352, 0.40625]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 5 epochs
Epoch 35/65
168/168 - 255s - loss: 0.0104 - accuracy: 0.9974 - val_loss: 0.2849 - val_accuracy: 0.9207
Confusion matrix: 
 [[545  28]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.625 0.375]]
Validation f1: 33.33
Validation accuracy: 92.07
Validation recall: 37.50
Validation precision: 30.00
Validation AUC: 0.420184828348349
Validation class accuracies: [0.9511343804537522, 0.375]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 36/65
168/168 - 255s - loss: 0.0071 - accuracy: 0.9981 - val_loss: 0.2830 - val_accuracy: 0.9174
Confusion matrix: 
 [[538  35]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.469 0.531]]
Validation f1: 40.48
Validation accuracy: 91.74
Validation recall: 53.12
Validation precision: 32.69
Validation AUC: 0.5311482351465149
Validation class accuracies: [0.9389179755671903, 0.53125]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 7 epochs
Epoch 37/65
168/168 - 255s - loss: 0.0058 - accuracy: 0.9981 - val_loss: 0.2126 - val_accuracy: 0.9438
Confusion matrix: 
 [[555  18]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.5   0.5  ]]
Validation f1: 48.48
Validation accuracy: 94.38
Validation recall: 50.00
Validation precision: 47.06
Validation AUC: 0.5130168864797034
Validation class accuracies: [0.9685863874345549, 0.5]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 8 epochs
Epoch 38/65
168/168 - 256s - loss: 0.0052 - accuracy: 0.9996 - val_loss: 0.2483 - val_accuracy: 0.9322
Confusion matrix: 
 [[547  26]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.469 0.531]]
Validation f1: 45.33
Validation accuracy: 93.22
Validation recall: 53.12
Validation precision: 39.53
Validation AUC: 0.5398435292188154
Validation class accuracies: [0.9546247818499127, 0.53125]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 9 epochs
Epoch 39/65
168/168 - 255s - loss: 0.0039 - accuracy: 0.9993 - val_loss: 0.2458 - val_accuracy: 0.9488
Confusion matrix: 
 [[561  12]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.594 0.406]]
Validation f1: 45.61
Validation accuracy: 94.88
Validation recall: 40.62
Validation precision: 52.00
Validation AUC: 0.4553136004688801
Validation class accuracies: [0.9790575916230366, 0.40625]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 10 epochs
Epoch 40/65
168/168 - 256s - loss: 0.0039 - accuracy: 0.9996 - val_loss: 0.2426 - val_accuracy: 0.9355
Confusion matrix: 
 [[552  21]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.562 0.438]]
Validation f1: 41.79
Validation accuracy: 93.55
Validation recall: 43.75
Validation precision: 40.00
Validation AUC: 0.4961103755805767
Validation class accuracies: [0.9633507853403142, 0.4375]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 11 epochs
Epoch 41/65
168/168 - 255s - loss: 0.0086 - accuracy: 0.9981 - val_loss: 0.3294 - val_accuracy: 0.9140
Confusion matrix: 
 [[540  33]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.594 0.406]]
Validation f1: 33.33
Validation accuracy: 91.40
Validation recall: 40.62
Validation precision: 28.26
Validation AUC: 0.39866728160032927
Validation class accuracies: [0.9424083769633508, 0.40625]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 42/65
168/168 - 255s - loss: 0.0092 - accuracy: 0.9981 - val_loss: 0.2541 - val_accuracy: 0.9372
Confusion matrix: 
 [[554  19]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.594 0.406]]
Validation f1: 40.62
Validation accuracy: 93.72
Validation recall: 40.62
Validation precision: 40.62
Validation AUC: 0.4418444425011049
Validation class accuracies: [0.9668411867364747, 0.40625]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 13 epochs
Epoch 43/65
168/168 - 256s - loss: 0.0062 - accuracy: 1.0000 - val_loss: 0.2692 - val_accuracy: 0.9322
Confusion matrix: 
 [[549  24]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.531 0.469]]
Validation f1: 42.25
Validation accuracy: 93.22
Validation recall: 46.88
Validation precision: 38.46
Validation AUC: 0.4854166449189767
Validation class accuracies: [0.9581151832460733, 0.46875]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 14 epochs
Epoch 44/65
168/168 - 255s - loss: 0.0050 - accuracy: 0.9996 - val_loss: 0.2422 - val_accuracy: 0.9388
Confusion matrix: 
 [[556  17]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.625 0.375]]
Validation f1: 39.34
Validation accuracy: 93.88
Validation recall: 37.50
Validation precision: 41.38
Validation AUC: 0.4634574906609308
Validation class accuracies: [0.9703315881326352, 0.375]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 15 epochs
Epoch 45/65
168/168 - 256s - loss: 0.0042 - accuracy: 0.9996 - val_loss: 0.2489 - val_accuracy: 0.9339
Confusion matrix: 
 [[551  22]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.562 0.438]]
Validation f1: 41.18
Validation accuracy: 93.39
Validation recall: 43.75
Validation precision: 38.89
Validation AUC: 0.48038638320464006
Validation class accuracies: [0.9616055846422339, 0.4375]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 16 epochs
Epoch 46/65
168/168 - 255s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2450 - val_accuracy: 0.9405
Confusion matrix: 
 [[555  18]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.562 0.438]]
Validation f1: 43.75
Validation accuracy: 94.05
Validation recall: 43.75
Validation precision: 43.75
Validation AUC: 0.4919248654524852
Validation class accuracies: [0.9685863874345549, 0.4375]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 17 epochs
Epoch 47/65
168/168 - 256s - loss: 0.0038 - accuracy: 1.0000 - val_loss: 0.2199 - val_accuracy: 0.9438
Confusion matrix: 
 [[557  16]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.562 0.438]]
Validation f1: 45.16
Validation accuracy: 94.38
Validation recall: 43.75
Validation precision: 46.67
Validation AUC: 0.5296472838570646
Validation class accuracies: [0.9720767888307156, 0.4375]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 48/65
168/168 - 255s - loss: 0.0054 - accuracy: 0.9989 - val_loss: 0.2480 - val_accuracy: 0.9388
Confusion matrix: 
 [[549  24]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.406 0.594]]
Validation f1: 50.67
Validation accuracy: 93.88
Validation recall: 59.38
Validation precision: 44.19
Validation AUC: 0.5742166083023048
Validation class accuracies: [0.9581151832460733, 0.59375]
The validation tracker metric at 0.5569620253164557 hasn't increased by 0 in 19 epochs
Epoch 49/65
168/168 - 256s - loss: 0.0040 - accuracy: 0.9985 - val_loss: 0.2411 - val_accuracy: 0.9405
Confusion matrix: 
 [[553  20]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.5   0.5  ]]
Validation f1: 47.06
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.05
Validation recall: 50.00
Validation precision: 44.44
Validation AUC: 0.5231284596976934
Validation class accuracies: [0.9650959860383944, 0.5]

The metrics for job 0 with the best target metric are: 
Best cm: [[548  25]
 [ 10  22]]
Best normalized cm: [[0.956 0.044]
 [0.312 0.688]]
Best f1: 0.56
Best accuracy: 0.94
Best recall: 0.69
Best precision: 0.47
Best AUC: 0.62
Best class accuracies: [0.956369982547993, 0.6875]
Best epoch: 29
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 3421
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210621_153539-3vluzg5k/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210621_153539-3vluzg5k/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99851
wandb:         val_accuracy 0.9405
wandb:             _runtime 13220
wandb:           _timestamp 1624302959
wandb:                _step 369
wandb:           train_loss 0.004
wandb:             val_loss 0.24106
wandb:           val_recall 0.5
wandb:        val_precision 0.44444
wandb:               val_f1 0.47059
wandb:              val_auc 0.52313
wandb:                   lr 6e-05
wandb:          best_val_f1 0.55696
wandb:    best_val_accuracy 0.94215
wandb:   best_val_precision 0.46809
wandb:      best_val_recall 0.6875
wandb:             best_auc 0.62157
wandb:           best_epoch 29
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210621_153539-3vluzg5k


 See logs at ../../new_cache/conv__2231__06_1535__v39__pitch_shifting/logs/