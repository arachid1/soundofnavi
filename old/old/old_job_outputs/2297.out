Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2297
Description:  mixup
2021-07-10 15:08:57.251821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-07-10 15:09:00.337766: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-10 15:09:00.338888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-10 15:09:00.388672: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:09:00.389459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-10 15:09:00.389494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-10 15:09:00.414784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-10 15:09:00.414874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-10 15:09:00.418287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-10 15:09:00.421668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-10 15:09:00.423822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-10 15:09:00.426666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-10 15:09:00.427403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-10 15:09:00.427570: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:09:00.428332: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:09:00.428988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2297.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2297__07_1507__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-10 15:17:01.250100: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-10 15:17:01.250500: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:17:01.251281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-10 15:17:01.251340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-10 15:17:01.251410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-10 15:17:01.251433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-10 15:17:01.251454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-10 15:17:01.251490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-10 15:17:01.251512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-10 15:17:01.251533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-10 15:17:01.251553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-10 15:17:01.251651: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:17:01.252394: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:17:01.253068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-10 15:17:01.253142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-10 15:17:01.951962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-10 15:17:01.952011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-10 15:17:01.952021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-10 15:17:01.952337: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:17:01.953131: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:17:01.953819: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-10 15:17:01.954529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-07-10 15:17:02.819541: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-07-10 15:17:02.821135: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-10 15:19:40.622483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3648
2021-07-10 15:19:50.612289: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 3648
2021-07-10 15:20:00.433580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 3648
2021-07-10 15:20:10.644133: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2593 of 3648
2021-07-10 15:20:20.435627: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3034 of 3648
2021-07-10 15:20:30.523483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3105 of 3648
2021-07-10 15:20:40.592211: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3173 of 3648
2021-07-10 15:20:50.549407: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3229 of 3648
2021-07-10 15:21:00.510256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3295 of 3648
2021-07-10 15:21:10.442256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3362 of 3648
2021-07-10 15:21:20.499653: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3426 of 3648
2021-07-10 15:21:30.502029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3487 of 3648
2021-07-10 15:21:40.578470: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3540 of 3648
2021-07-10 15:21:50.492306: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3608 of 3648
2021-07-10 15:21:56.497956: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-07-10 15:21:56.816101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-10 15:21:58.552466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-10 15:21:58.973507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_46
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_47
Length of training samples after augmix augmentation: 3016
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
New dataset length after mix-up augmentation: 3648
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
228/228 - 237s - loss: 0.5450 - accuracy: 0.5825 - val_loss: 0.6370 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.5375479730417203
Validation class accuracies: [1.0, 0.0]
2021-07-10 15:23:46.970049: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3648
2021-07-10 15:23:56.961293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1282 of 3648
2021-07-10 15:24:07.018399: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3648
2021-07-10 15:24:17.012505: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2577 of 3648
2021-07-10 15:24:27.143867: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3034 of 3648
2021-07-10 15:24:37.164182: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3105 of 3648
2021-07-10 15:24:46.981928: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3167 of 3648
2021-07-10 15:24:57.156891: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3223 of 3648
2021-07-10 15:25:07.026523: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3299 of 3648
2021-07-10 15:25:17.086291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3349 of 3648
2021-07-10 15:25:26.994221: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3423 of 3648
2021-07-10 15:25:37.109353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3485 of 3648
2021-07-10 15:25:47.034973: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3542 of 3648
2021-07-10 15:25:57.133498: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3605 of 3648
2021-07-10 15:26:03.744041: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
228/228 - 233s - loss: 0.4135 - accuracy: 0.6713 - val_loss: 0.7059 - val_accuracy: 0.4039
Confusion matrix: 
 [[211 362]
 [  4  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.368 0.632]
 [0.098 0.902]]
Validation f1: 16.82
Validation accuracy: 40.39
Validation recall: 90.24
Validation precision: 9.27
Validation AUC: 0.18038164032041748
Validation class accuracies: [0.3682373472949389, 0.9024390243902439]
2021-07-10 15:27:50.425513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3648
2021-07-10 15:28:00.498789: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3648
2021-07-10 15:28:10.426512: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3648
2021-07-10 15:28:20.301916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2577 of 3648
2021-07-10 15:28:30.434207: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3039 of 3648
2021-07-10 15:28:40.430886: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3110 of 3648
2021-07-10 15:28:50.515569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3174 of 3648
2021-07-10 15:29:00.284108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3234 of 3648
2021-07-10 15:29:10.340368: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3299 of 3648
2021-07-10 15:29:20.292412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3363 of 3648
2021-07-10 15:29:30.323787: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3432 of 3648
2021-07-10 15:29:40.476763: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3485 of 3648
2021-07-10 15:29:50.284748: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3542 of 3648
2021-07-10 15:30:00.380266: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3605 of 3648
2021-07-10 15:30:06.753694: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 3/65
228/228 - 233s - loss: 0.3362 - accuracy: 0.7089 - val_loss: 0.1522 - val_accuracy: 0.9463
Confusion matrix: 
 [[572   1]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.78  0.22 ]]
Validation f1: 35.29
Validation accuracy: 94.63
Validation recall: 21.95
Validation precision: 90.00
Validation AUC: 0.6447183493311225
Validation class accuracies: [0.9982547993019197, 0.21951219512195122]
2021-07-10 15:31:53.856839: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3648
2021-07-10 15:32:03.658518: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3648
2021-07-10 15:32:13.772794: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3648
2021-07-10 15:32:23.733568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2593 of 3648
2021-07-10 15:32:34.179568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3031 of 3648
2021-07-10 15:32:43.751870: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3091 of 3648
2021-07-10 15:32:54.042821: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3159 of 3648
2021-07-10 15:33:03.957560: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3220 of 3648
2021-07-10 15:33:14.246829: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3288 of 3648
2021-07-10 15:33:23.861243: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3347 of 3648
2021-07-10 15:33:33.659205: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3417 of 3648
2021-07-10 15:33:44.052351: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3490 of 3648
2021-07-10 15:33:54.298164: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3550 of 3648
2021-07-10 15:34:03.704948: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3633 of 3648
2021-07-10 15:34:05.478322: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 4/65
228/228 - 228s - loss: 0.2539 - accuracy: 0.7522 - val_loss: 0.9687 - val_accuracy: 0.6498
Confusion matrix: 
 [[358 215]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.625 0.375]
 [0.    1.   ]]
Validation f1: 27.61
Validation accuracy: 64.98
Validation recall: 100.00
Validation precision: 16.02
Validation AUC: 0.5554906804095888
Validation class accuracies: [0.62478184991274, 1.0]
2021-07-10 15:35:51.803515: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3648
2021-07-10 15:36:01.706332: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3648
2021-07-10 15:36:11.715301: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3648
2021-07-10 15:36:21.708109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2609 of 3648
2021-07-10 15:36:31.836067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3041 of 3648
2021-07-10 15:36:41.735046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3108 of 3648
2021-07-10 15:36:51.763737: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3166 of 3648
2021-07-10 15:37:01.699109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3222 of 3648
2021-07-10 15:37:11.849745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3293 of 3648
2021-07-10 15:37:21.838553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3368 of 3648
2021-07-10 15:37:31.716779: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3428 of 3648
2021-07-10 15:37:41.916323: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3492 of 3648
2021-07-10 15:37:51.873164: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3565 of 3648
2021-07-10 15:38:01.726469: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3625 of 3648
2021-07-10 15:38:04.905075: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.3529411764705882 hasn't increased by 0 in 1 epochs
Epoch 5/65
228/228 - 230s - loss: 0.2066 - accuracy: 0.7840 - val_loss: 6.3091 - val_accuracy: 0.1547
Confusion matrix: 
 [[ 54 519]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.094 0.906]
 [0.    1.   ]]
Validation f1: 13.64
Validation accuracy: 15.47
Validation recall: 100.00
Validation precision: 7.32
Validation AUC: 0.44431990505139835
Validation class accuracies: [0.09424083769633508, 1.0]
2021-07-10 15:39:51.524093: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3648
2021-07-10 15:40:01.492446: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3648
2021-07-10 15:40:11.318461: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3648
2021-07-10 15:40:21.366946: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2609 of 3648
2021-07-10 15:40:31.582129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3043 of 3648
2021-07-10 15:40:41.517472: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3100 of 3648
2021-07-10 15:40:51.425194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3172 of 3648
2021-07-10 15:41:01.430485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3233 of 3648
2021-07-10 15:41:11.485412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3294 of 3648
2021-07-10 15:41:21.427162: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3351 of 3648
2021-07-10 15:41:31.501940: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3421 of 3648
2021-07-10 15:41:41.484530: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3489 of 3648
2021-07-10 15:41:51.588890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3556 of 3648
2021-07-10 15:42:01.848357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3610 of 3648
2021-07-10 15:42:06.799562: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.3529411764705882 hasn't increased by 0 in 2 epochs
Epoch 6/65
228/228 - 232s - loss: 0.1885 - accuracy: 0.7887 - val_loss: 0.1894 - val_accuracy: 0.9463
Confusion matrix: 
 [[571   2]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.756 0.244]]
Validation f1: 37.74
Validation accuracy: 94.63
Validation recall: 24.39
Validation precision: 83.33
Validation AUC: 0.5790452363581287
Validation class accuracies: [0.9965095986038395, 0.24390243902439024]
2021-07-10 15:43:53.387255: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3648
2021-07-10 15:44:03.262370: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 3648
2021-07-10 15:44:13.296615: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3648
2021-07-10 15:44:23.199046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2593 of 3648
2021-07-10 15:44:33.256550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3036 of 3648
2021-07-10 15:44:43.221010: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3101 of 3648
2021-07-10 15:44:53.216027: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3163 of 3648
2021-07-10 15:45:03.350918: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3227 of 3648
2021-07-10 15:45:13.468491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3293 of 3648
2021-07-10 15:45:23.384893: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3342 of 3648
2021-07-10 15:45:33.227949: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3413 of 3648
2021-07-10 15:45:43.652744: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3491 of 3648
2021-07-10 15:45:53.304372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3554 of 3648
2021-07-10 15:46:03.375816: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3613 of 3648
2021-07-10 15:46:08.495074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 7/65
228/228 - 231s - loss: 0.1524 - accuracy: 0.8043 - val_loss: 0.2785 - val_accuracy: 0.9235
Confusion matrix: 
 [[535  38]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.22  0.78 ]]
Validation f1: 57.66
Validation accuracy: 92.35
Validation recall: 78.05
Validation precision: 45.71
Validation AUC: 0.5394479340250958
Validation class accuracies: [0.9336823734729494, 0.7804878048780488]
2021-07-10 15:47:54.551174: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 641 of 3648
2021-07-10 15:48:04.423919: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1297 of 3648
2021-07-10 15:48:14.526439: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3648
2021-07-10 15:48:24.379697: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2625 of 3648
2021-07-10 15:48:34.366481: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3037 of 3648
2021-07-10 15:48:44.608987: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3102 of 3648
2021-07-10 15:48:54.382089: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3172 of 3648
2021-07-10 15:49:04.430270: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3236 of 3648
2021-07-10 15:49:14.509770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3305 of 3648
2021-07-10 15:49:24.479354: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3369 of 3648
2021-07-10 15:49:34.434299: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3438 of 3648
2021-07-10 15:49:44.792606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3491 of 3648
2021-07-10 15:49:54.475843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3551 of 3648
2021-07-10 15:50:04.487419: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3618 of 3648
2021-07-10 15:50:08.474278: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 8/65
228/228 - 231s - loss: 0.1366 - accuracy: 0.8128 - val_loss: 0.1402 - val_accuracy: 0.9479
Confusion matrix: 
 [[551  22]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.244 0.756]]
Validation f1: 65.96
Validation accuracy: 94.79
Validation recall: 75.61
Validation precision: 58.49
Validation AUC: 0.7268579313961547
Validation class accuracies: [0.9616055846422339, 0.7560975609756098]
2021-07-10 15:51:55.152550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3648
2021-07-10 15:52:05.169169: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3648
2021-07-10 15:52:15.135965: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3648
2021-07-10 15:52:25.051601: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2625 of 3648
2021-07-10 15:52:34.945942: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3035 of 3648
2021-07-10 15:52:45.091903: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3115 of 3648
2021-07-10 15:52:55.200583: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3175 of 3648
2021-07-10 15:53:04.976924: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3241 of 3648
2021-07-10 15:53:15.084168: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3306 of 3648
2021-07-10 15:53:24.939987: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3361 of 3648
2021-07-10 15:53:34.942762: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3418 of 3648
2021-07-10 15:53:45.320004: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3491 of 3648
2021-07-10 15:53:55.120864: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3557 of 3648
2021-07-10 15:54:05.147856: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3634 of 3648
2021-07-10 15:54:07.484331: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
Saving model...
Epoch 9/65
228/228 - 229s - loss: 0.1577 - accuracy: 0.8092 - val_loss: 0.2528 - val_accuracy: 0.9202
Confusion matrix: 
 [[532  41]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.195 0.805]]
Validation f1: 57.39
Validation accuracy: 92.02
Validation recall: 80.49
Validation precision: 44.59
Validation AUC: 0.5685617220159659
Validation class accuracies: [0.9284467713787086, 0.8048780487804879]
2021-07-10 15:55:54.119454: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3648
2021-07-10 15:56:04.064538: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 3648
2021-07-10 15:56:13.998770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1841 of 3648
2021-07-10 15:56:24.081040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 3648
2021-07-10 15:56:33.913924: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3021 of 3648
2021-07-10 15:56:44.147680: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3094 of 3648
2021-07-10 15:56:53.915671: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3152 of 3648
2021-07-10 15:57:04.053673: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3205 of 3648
2021-07-10 15:57:14.082336: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3251 of 3648
2021-07-10 15:57:24.209788: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3300 of 3648
2021-07-10 15:57:33.930117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3341 of 3648
2021-07-10 15:57:43.915820: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3388 of 3648
2021-07-10 15:57:54.053235: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3427 of 3648
2021-07-10 15:58:04.072978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3480 of 3648
2021-07-10 15:58:13.978585: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3518 of 3648
2021-07-10 15:58:24.146134: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3560 of 3648
2021-07-10 15:58:34.220816: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3608 of 3648
2021-07-10 15:58:41.985338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 1 epochs
Epoch 10/65
228/228 - 269s - loss: 0.1311 - accuracy: 0.8172 - val_loss: 0.4239 - val_accuracy: 0.9023
Confusion matrix: 
 [[516  57]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.073 0.927]]
Validation f1: 55.88
Validation accuracy: 90.23
Validation recall: 92.68
Validation precision: 40.00
Validation AUC: 0.5693537933066672
Validation class accuracies: [0.900523560209424, 0.926829268292683]
2021-07-10 16:00:36.783275: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3648
2021-07-10 16:00:46.721393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 945 of 3648
2021-07-10 16:00:56.945676: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3648
2021-07-10 16:01:06.888814: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 3648
2021-07-10 16:01:16.782721: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2513 of 3648
2021-07-10 16:01:26.827534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3031 of 3648
2021-07-10 16:01:36.806626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3100 of 3648
2021-07-10 16:01:46.688771: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3169 of 3648
2021-07-10 16:01:56.816795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3239 of 3648
2021-07-10 16:02:06.655267: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3312 of 3648
2021-07-10 16:02:16.656056: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3384 of 3648
2021-07-10 16:02:26.708626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3450 of 3648
2021-07-10 16:02:36.649958: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3511 of 3648
2021-07-10 16:02:46.950129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3574 of 3648
2021-07-10 16:02:56.827092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3632 of 3648
2021-07-10 16:02:58.603996: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 2 epochs
Epoch 11/65
228/228 - 238s - loss: 0.1313 - accuracy: 0.8133 - val_loss: 0.3571 - val_accuracy: 0.8958
Confusion matrix: 
 [[514  59]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.122 0.878]]
Validation f1: 52.94
Validation accuracy: 89.58
Validation recall: 87.80
Validation precision: 37.89
Validation AUC: 0.6040991719687974
Validation class accuracies: [0.8970331588132635, 0.8780487804878049]
2021-07-10 16:04:45.015793: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3648
2021-07-10 16:04:54.930172: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1281 of 3648
2021-07-10 16:05:04.983106: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1937 of 3648
2021-07-10 16:05:15.128639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2609 of 3648
2021-07-10 16:05:25.206067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3043 of 3648
2021-07-10 16:05:35.343066: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3093 of 3648
2021-07-10 16:05:44.949575: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3156 of 3648
2021-07-10 16:05:55.113477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3234 of 3648
2021-07-10 16:06:04.926922: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3305 of 3648
2021-07-10 16:06:15.337500: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3379 of 3648
2021-07-10 16:06:25.136586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3450 of 3648
2021-07-10 16:06:34.909117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3504 of 3648
2021-07-10 16:06:45.182994: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3568 of 3648
2021-07-10 16:06:55.028717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3638 of 3648
2021-07-10 16:06:56.587714: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 3 epochs
Epoch 12/65
228/228 - 228s - loss: 0.1056 - accuracy: 0.8226 - val_loss: 0.2124 - val_accuracy: 0.9381
Confusion matrix: 
 [[543  30]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.195 0.805]]
Validation f1: 63.46
Validation accuracy: 93.81
Validation recall: 80.49
Validation precision: 52.38
Validation AUC: 0.5812655103736174
Validation class accuracies: [0.9476439790575916, 0.8048780487804879]
2021-07-10 16:08:42.810699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3648
2021-07-10 16:08:52.784759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1329 of 3648
2021-07-10 16:09:02.757573: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2001 of 3648
2021-07-10 16:09:12.755398: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2673 of 3648
2021-07-10 16:09:22.712966: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3038 of 3648
2021-07-10 16:09:33.003863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3093 of 3648
2021-07-10 16:09:42.784420: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3162 of 3648
2021-07-10 16:09:52.761207: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3229 of 3648
2021-07-10 16:10:03.226834: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3297 of 3648
2021-07-10 16:10:12.768155: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3356 of 3648
2021-07-10 16:10:22.701690: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3425 of 3648
2021-07-10 16:10:32.607402: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3488 of 3648
2021-07-10 16:10:42.821672: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3554 of 3648
2021-07-10 16:10:52.883642: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3626 of 3648
2021-07-10 16:11:00.058888: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 4 epochs
Epoch 13/65
228/228 - 239s - loss: 0.1039 - accuracy: 0.8235 - val_loss: 0.2639 - val_accuracy: 0.9186
Confusion matrix: 
 [[532  41]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.22  0.78 ]]
Validation f1: 56.14
Validation accuracy: 91.86
Validation recall: 78.05
Validation precision: 43.84
Validation AUC: 0.517219501867538
Validation class accuracies: [0.9284467713787086, 0.7804878048780488]
2021-07-10 16:12:55.466677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 3648
2021-07-10 16:13:05.359556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 961 of 3648
2021-07-10 16:13:15.369313: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3648
2021-07-10 16:13:25.308031: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 3648
2021-07-10 16:13:35.236837: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3648
2021-07-10 16:13:45.174092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3648
2021-07-10 16:13:55.283418: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3053 of 3648
2021-07-10 16:14:05.347280: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3095 of 3648
2021-07-10 16:14:15.294581: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3154 of 3648
2021-07-10 16:14:25.348634: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3222 of 3648
2021-07-10 16:14:35.237556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3277 of 3648
2021-07-10 16:14:45.338253: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3349 of 3648
2021-07-10 16:14:55.413645: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3409 of 3648
2021-07-10 16:15:05.343427: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3470 of 3648
2021-07-10 16:15:15.214615: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3532 of 3648
2021-07-10 16:15:25.225007: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3591 of 3648
2021-07-10 16:15:34.616866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 14/65
228/228 - 256s - loss: 0.1013 - accuracy: 0.8251 - val_loss: 0.2110 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.5987348619362065
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]
2021-07-10 16:17:20.615925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3648
2021-07-10 16:17:30.538790: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3648
2021-07-10 16:17:40.606909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3648
2021-07-10 16:17:50.440216: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2625 of 3648
2021-07-10 16:18:00.540863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3046 of 3648
2021-07-10 16:18:10.460247: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3107 of 3648
2021-07-10 16:18:20.525606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3175 of 3648
2021-07-10 16:18:30.603033: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3238 of 3648
2021-07-10 16:18:40.440656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3296 of 3648
2021-07-10 16:18:50.923452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3359 of 3648
2021-07-10 16:19:00.453173: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3416 of 3648
2021-07-10 16:19:10.536070: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3485 of 3648
2021-07-10 16:19:20.615774: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3535 of 3648
2021-07-10 16:19:30.793343: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3609 of 3648
2021-07-10 16:19:37.072257: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 6 epochs
Epoch 15/65
228/228 - 233s - loss: 0.0980 - accuracy: 0.8254 - val_loss: 0.2456 - val_accuracy: 0.9349
Confusion matrix: 
 [[542  31]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.22  0.78 ]]
Validation f1: 61.54
Validation accuracy: 93.49
Validation recall: 78.05
Validation precision: 50.79
Validation AUC: 0.5509014105278472
Validation class accuracies: [0.9458987783595113, 0.7804878048780488]
2021-07-10 16:21:23.098396: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3648
2021-07-10 16:21:32.958553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3648
2021-07-10 16:21:43.102367: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1745 of 3648
2021-07-10 16:21:53.046394: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2225 of 3648
2021-07-10 16:22:03.008572: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2705 of 3648
2021-07-10 16:22:13.199060: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3031 of 3648
2021-07-10 16:22:23.145157: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3087 of 3648
2021-07-10 16:22:32.988202: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3128 of 3648
2021-07-10 16:22:43.135755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3179 of 3648
2021-07-10 16:22:52.934451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3224 of 3648
2021-07-10 16:23:03.024861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3273 of 3648
2021-07-10 16:23:13.092717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3318 of 3648
2021-07-10 16:23:23.181858: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3359 of 3648
2021-07-10 16:23:32.907612: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3416 of 3648
2021-07-10 16:23:43.237578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3455 of 3648
2021-07-10 16:23:53.410942: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3499 of 3648
2021-07-10 16:24:02.959998: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3554 of 3648
2021-07-10 16:24:13.108722: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3589 of 3648
2021-07-10 16:24:23.201226: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3645 of 3648
2021-07-10 16:24:23.435787: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 7 epochs
Epoch 16/65
228/228 - 277s - loss: 0.0980 - accuracy: 0.8246 - val_loss: 0.2270 - val_accuracy: 0.9332
Confusion matrix: 
 [[541  32]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.22  0.78 ]]
Validation f1: 60.95
Validation accuracy: 93.32
Validation recall: 78.05
Validation precision: 50.00
Validation AUC: 0.6037229954498351
Validation class accuracies: [0.944153577661431, 0.7804878048780488]
2021-07-10 16:26:09.516550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 657 of 3648
2021-07-10 16:26:19.434519: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1313 of 3648
2021-07-10 16:26:29.529032: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1969 of 3648
2021-07-10 16:26:39.436892: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2625 of 3648
2021-07-10 16:26:49.444622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3039 of 3648
2021-07-10 16:26:59.403919: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3110 of 3648
2021-07-10 16:27:09.355434: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3177 of 3648
2021-07-10 16:27:19.703268: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3251 of 3648
2021-07-10 16:27:29.828550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3322 of 3648
2021-07-10 16:27:39.376990: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3380 of 3648
2021-07-10 16:27:49.722972: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3438 of 3648
2021-07-10 16:27:59.333146: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3509 of 3648
2021-07-10 16:28:09.610481: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3577 of 3648
2021-07-10 16:28:19.503421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3643 of 3648
2021-07-10 16:28:20.482323: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 8 epochs
Epoch 17/65
228/228 - 228s - loss: 0.0955 - accuracy: 0.8259 - val_loss: 0.2330 - val_accuracy: 0.9397
Confusion matrix: 
 [[545  28]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.22  0.78 ]]
Validation f1: 63.37
Validation accuracy: 93.97
Validation recall: 78.05
Validation precision: 53.33
Validation AUC: 0.581663846940994
Validation class accuracies: [0.9511343804537522, 0.7804878048780488]
2021-07-10 16:30:07.044953: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 577 of 3648
2021-07-10 16:30:16.778447: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1137 of 3648
2021-07-10 16:30:26.856391: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1793 of 3648
2021-07-10 16:30:36.851067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2465 of 3648
2021-07-10 16:30:46.734820: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3024 of 3648
2021-07-10 16:30:56.950095: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3099 of 3648
2021-07-10 16:31:06.840677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3158 of 3648
2021-07-10 16:31:17.001620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3226 of 3648
2021-07-10 16:31:26.931019: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3281 of 3648
2021-07-10 16:31:36.895414: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3342 of 3648
2021-07-10 16:31:46.940039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3408 of 3648
2021-07-10 16:31:56.885330: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3465 of 3648
2021-07-10 16:32:06.835614: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3539 of 3648
2021-07-10 16:32:16.790200: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3596 of 3648
2021-07-10 16:32:22.594527: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 9 epochs
Epoch 18/65
228/228 - 232s - loss: 0.0979 - accuracy: 0.8257 - val_loss: 0.2212 - val_accuracy: 0.9349
Confusion matrix: 
 [[542  31]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.54
Validation accuracy: 93.49
Validation recall: 78.05
Validation precision: 50.79
Validation AUC: 0.6182261565986271
Validation class accuracies: [0.9458987783595113, 0.7804878048780488]
2021-07-10 16:34:09.653200: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3648
2021-07-10 16:34:19.664049: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 945 of 3648
2021-07-10 16:34:29.931743: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3648
2021-07-10 16:34:39.719551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 3648
2021-07-10 16:34:49.735071: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 3648
2021-07-10 16:34:59.905295: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3648
2021-07-10 16:35:09.743925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3053 of 3648
2021-07-10 16:35:19.915698: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3105 of 3648
2021-07-10 16:35:30.576027: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3155 of 3648
2021-07-10 16:35:39.695542: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3197 of 3648
2021-07-10 16:35:49.930433: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3234 of 3648
2021-07-10 16:35:59.832466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3296 of 3648
2021-07-10 16:36:09.834358: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3339 of 3648
2021-07-10 16:36:19.678715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3394 of 3648
2021-07-10 16:36:29.891065: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3437 of 3648
2021-07-10 16:36:41.104584: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3488 of 3648
2021-07-10 16:36:49.798581: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3523 of 3648
2021-07-10 16:36:59.697226: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3574 of 3648
2021-07-10 16:37:09.703849: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3619 of 3648
2021-07-10 16:37:14.596460: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 19/65
228/228 - 286s - loss: 0.0946 - accuracy: 0.8262 - val_loss: 0.2088 - val_accuracy: 0.9381
Confusion matrix: 
 [[544  29]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.22  0.78 ]]
Validation f1: 62.75
Validation accuracy: 93.81
Validation recall: 78.05
Validation precision: 52.46
Validation AUC: 0.5944406832957623
Validation class accuracies: [0.9493891797556719, 0.7804878048780488]
2021-07-10 16:39:09.047931: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 3648
2021-07-10 16:39:19.010456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 961 of 3648
2021-07-10 16:39:28.913328: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3648
2021-07-10 16:39:39.048160: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 3648
2021-07-10 16:39:48.808864: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2385 of 3648
2021-07-10 16:39:58.797765: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2865 of 3648
2021-07-10 16:40:09.083226: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3050 of 3648
2021-07-10 16:40:18.772844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3097 of 3648
2021-07-10 16:40:28.968220: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3154 of 3648
2021-07-10 16:40:38.774364: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3202 of 3648
2021-07-10 16:40:49.260526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3257 of 3648
2021-07-10 16:40:59.151218: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3303 of 3648
2021-07-10 16:41:08.804111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3337 of 3648
2021-07-10 16:41:19.006943: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3386 of 3648
2021-07-10 16:41:29.022535: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3433 of 3648
2021-07-10 16:41:38.917263: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3481 of 3648
2021-07-10 16:41:49.070504: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3527 of 3648
2021-07-10 16:41:58.907534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3568 of 3648
2021-07-10 16:42:08.766086: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3631 of 3648
2021-07-10 16:42:12.821853: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 11 epochs
Epoch 20/65
228/228 - 281s - loss: 0.0969 - accuracy: 0.8262 - val_loss: 0.2197 - val_accuracy: 0.9381
Confusion matrix: 
 [[544  29]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.75
Validation accuracy: 93.81
Validation recall: 78.05
Validation precision: 52.46
Validation AUC: 0.5927194073086759
Validation class accuracies: [0.9493891797556719, 0.7804878048780488]
2021-07-10 16:44:00.769984: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 513 of 3648
2021-07-10 16:44:10.757892: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 993 of 3648
2021-07-10 16:44:20.827754: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3648
2021-07-10 16:44:30.839874: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3648
2021-07-10 16:44:40.623569: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 3648
2021-07-10 16:44:50.752925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3648
2021-07-10 16:45:00.555175: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3056 of 3648
2021-07-10 16:45:10.840634: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3107 of 3648
2021-07-10 16:45:20.669635: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3164 of 3648
2021-07-10 16:45:30.549346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3209 of 3648
2021-07-10 16:45:40.676549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3249 of 3648
2021-07-10 16:45:50.720286: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3296 of 3648
2021-07-10 16:46:00.853733: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3335 of 3648
2021-07-10 16:46:10.783823: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3389 of 3648
2021-07-10 16:46:20.836792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3432 of 3648
2021-07-10 16:46:30.616563: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3482 of 3648
2021-07-10 16:46:40.694294: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3516 of 3648
2021-07-10 16:46:50.838119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3572 of 3648
2021-07-10 16:47:00.837651: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3631 of 3648
2021-07-10 16:47:03.654643: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 12 epochs
Epoch 21/65
228/228 - 284s - loss: 0.0983 - accuracy: 0.8259 - val_loss: 0.2307 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.5897666283743048
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]
2021-07-10 16:48:55.073390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 625 of 3648
2021-07-10 16:49:05.085261: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1249 of 3648
2021-07-10 16:49:14.861771: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3648
2021-07-10 16:49:24.872215: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2481 of 3648
2021-07-10 16:49:35.132542: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3023 of 3648
2021-07-10 16:49:45.125688: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3079 of 3648
2021-07-10 16:49:54.900535: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3120 of 3648
2021-07-10 16:50:05.205792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3160 of 3648
2021-07-10 16:50:15.103707: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3207 of 3648
2021-07-10 16:50:24.979338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3248 of 3648
2021-07-10 16:50:35.166140: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3307 of 3648
2021-07-10 16:50:44.999402: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3350 of 3648
2021-07-10 16:50:54.894297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3393 of 3648
2021-07-10 16:51:05.320847: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3445 of 3648
2021-07-10 16:51:15.191556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3494 of 3648
2021-07-10 16:51:25.100580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3548 of 3648
2021-07-10 16:51:34.923055: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3597 of 3648
2021-07-10 16:51:44.928138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3638 of 3648
2021-07-10 16:51:47.252894: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 13 epochs
Epoch 22/65
228/228 - 273s - loss: 0.0952 - accuracy: 0.8262 - val_loss: 0.2415 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.589916294022114
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]
2021-07-10 16:53:41.625720: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 3648
2021-07-10 16:53:51.574190: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 961 of 3648
2021-07-10 16:54:01.639974: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3648
2021-07-10 16:54:11.605551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1905 of 3648
2021-07-10 16:54:21.381357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 3648
2021-07-10 16:54:31.522308: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3017 of 3648
2021-07-10 16:54:41.465272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3087 of 3648
2021-07-10 16:54:51.556252: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3156 of 3648
2021-07-10 16:55:01.537581: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3210 of 3648
2021-07-10 16:55:11.534143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3270 of 3648
2021-07-10 16:55:21.523565: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3327 of 3648
2021-07-10 16:55:31.361682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3383 of 3648
2021-07-10 16:55:41.515526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3437 of 3648
2021-07-10 16:55:51.462806: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3482 of 3648
2021-07-10 16:56:01.668843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3542 of 3648
2021-07-10 16:56:12.157273: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3592 of 3648
2021-07-10 16:56:21.416235: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3628 of 3648
2021-07-10 16:56:24.981372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 14 epochs
Epoch 23/65
228/228 - 264s - loss: 0.0933 - accuracy: 0.8268 - val_loss: 0.2151 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.6011053367082051
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]
2021-07-10 16:58:19.126809: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3648
2021-07-10 16:58:29.348792: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 961 of 3648
2021-07-10 16:58:39.203437: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3648
2021-07-10 16:58:49.230533: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 3648
2021-07-10 16:58:59.308532: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3648
2021-07-10 16:59:09.159852: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3648
2021-07-10 16:59:19.411243: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3047 of 3648
2021-07-10 16:59:29.265690: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3094 of 3648
2021-07-10 16:59:39.204449: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3149 of 3648
2021-07-10 16:59:49.137723: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3197 of 3648
2021-07-10 16:59:59.220011: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3246 of 3648
2021-07-10 17:00:09.444835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3301 of 3648
2021-07-10 17:00:19.276175: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3356 of 3648
2021-07-10 17:00:29.228531: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3420 of 3648
2021-07-10 17:00:39.191533: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3484 of 3648
2021-07-10 17:00:49.546119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3536 of 3648
2021-07-10 17:00:59.454543: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3589 of 3648
2021-07-10 17:01:08.996218: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 24/65
228/228 - 270s - loss: 0.0946 - accuracy: 0.8265 - val_loss: 0.2178 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.5929670095120592
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]
2021-07-10 17:03:03.016165: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 481 of 3648
2021-07-10 17:03:12.933841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 961 of 3648
2021-07-10 17:03:22.983701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1441 of 3648
2021-07-10 17:03:32.875961: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 3648
2021-07-10 17:03:43.034783: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2417 of 3648
2021-07-10 17:03:53.034957: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2897 of 3648
2021-07-10 17:04:03.271676: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3052 of 3648
2021-07-10 17:04:13.643040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3097 of 3648
2021-07-10 17:04:22.897915: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3147 of 3648
2021-07-10 17:04:32.829208: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3187 of 3648
2021-07-10 17:04:43.046832: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3239 of 3648
2021-07-10 17:04:52.868929: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3280 of 3648
2021-07-10 17:05:03.118306: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3328 of 3648
2021-07-10 17:05:13.072481: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3358 of 3648
2021-07-10 17:05:22.974194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3409 of 3648
2021-07-10 17:05:32.997745: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3473 of 3648
2021-07-10 17:05:42.907614: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3513 of 3648
2021-07-10 17:05:53.139770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3576 of 3648
2021-07-10 17:06:02.983985: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3633 of 3648
2021-07-10 17:06:05.453032: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 16 epochs
Epoch 25/65
228/228 - 283s - loss: 0.0971 - accuracy: 0.8259 - val_loss: 0.2197 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.5928877651875643
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]
2021-07-10 17:07:59.183496: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 465 of 3648
2021-07-10 17:08:09.077281: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 956 of 3648
2021-07-10 17:08:19.147861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1425 of 3648
2021-07-10 17:08:29.341202: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1921 of 3648
2021-07-10 17:08:39.153405: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2401 of 3648
2021-07-10 17:08:49.233002: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2881 of 3648
2021-07-10 17:08:59.550566: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3044 of 3648
2021-07-10 17:09:09.606677: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3083 of 3648
2021-07-10 17:09:19.412189: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3130 of 3648
2021-07-10 17:09:29.232149: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3175 of 3648
2021-07-10 17:09:39.445607: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3229 of 3648
2021-07-10 17:09:49.202111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3268 of 3648
2021-07-10 17:09:59.589099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3331 of 3648
2021-07-10 17:10:09.121964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3370 of 3648
2021-07-10 17:10:19.867855: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3423 of 3648
2021-07-10 17:10:29.103118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3472 of 3648
2021-07-10 17:10:39.390413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3520 of 3648
2021-07-10 17:10:49.566765: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3572 of 3648
2021-07-10 17:10:59.298338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3628 of 3648
2021-07-10 17:11:04.088284: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 17 epochs
Epoch 26/65
228/228 - 282s - loss: 0.0960 - accuracy: 0.8262 - val_loss: 0.2278 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.5913203760634899
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]
2021-07-10 17:12:51.807819: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 529 of 3648
2021-07-10 17:13:01.855715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1009 of 3648
2021-07-10 17:13:11.885418: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1473 of 3648
2021-07-10 17:13:21.765204: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1953 of 3648
2021-07-10 17:13:31.869733: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2449 of 3648
2021-07-10 17:13:41.759656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2929 of 3648
2021-07-10 17:13:51.765943: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3045 of 3648
2021-07-10 17:14:02.253252: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3108 of 3648
2021-07-10 17:14:11.834396: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3164 of 3648
2021-07-10 17:14:21.846317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3208 of 3648
2021-07-10 17:14:33.143510: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3251 of 3648
2021-07-10 17:14:41.805373: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3302 of 3648
2021-07-10 17:14:51.789199: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3352 of 3648
2021-07-10 17:15:01.765356: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3401 of 3648
2021-07-10 17:15:12.049379: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3451 of 3648
2021-07-10 17:15:22.024535: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3505 of 3648
2021-07-10 17:15:31.882416: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3551 of 3648
2021-07-10 17:15:41.804146: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3603 of 3648
2021-07-10 17:15:50.979048: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 18 epochs
Epoch 27/65
228/228 - 280s - loss: 0.0977 - accuracy: 0.8265 - val_loss: 0.2280 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.5880126157621923
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]
2021-07-10 17:17:43.273492: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 609 of 3648
2021-07-10 17:17:53.307181: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1233 of 3648
2021-07-10 17:18:03.276960: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1857 of 3648
2021-07-10 17:18:13.237733: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2481 of 3648
2021-07-10 17:18:23.330901: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3026 of 3648
2021-07-10 17:18:33.460947: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3085 of 3648
2021-07-10 17:18:43.371971: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3134 of 3648
2021-07-10 17:18:54.470473: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3175 of 3648
2021-07-10 17:19:03.187530: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3208 of 3648
2021-07-10 17:19:13.397613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3269 of 3648
2021-07-10 17:19:23.146291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3314 of 3648
2021-07-10 17:19:33.233520: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3355 of 3648
2021-07-10 17:19:43.560682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3403 of 3648
2021-07-10 17:19:53.149296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3457 of 3648
2021-07-10 17:20:03.187030: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3501 of 3648
2021-07-10 17:20:13.221589: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3550 of 3648
2021-07-10 17:20:23.306755: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3604 of 3648
2021-07-10 17:20:32.991525: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
The validation tracker metric at 0.6595744680851064 hasn't increased by 0 in 19 epochs
Epoch 28/65
228/228 - 270s - loss: 0.0952 - accuracy: 0.8268 - val_loss: 0.2202 - val_accuracy: 0.9365
Confusion matrix: 
 [[543  30]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.22  0.78 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.14
Validation accuracy: 93.65
Validation recall: 78.05
Validation precision: 51.61
Validation AUC: 0.5919215511428094
Validation class accuracies: [0.9476439790575916, 0.7804878048780488]

The metrics for job 0 with the best target metric are: 
Best cm: [[551  22]
 [ 10  31]]
Best normalized cm: [[0.962 0.038]
 [0.244 0.756]]
Best f1: 0.66
Best accuracy: 0.95
Best recall: 0.76
Best precision: 0.58
Best AUC: 0.73
Best class accuracies: [0.9616055846422339, 0.7560975609756098]
Best epoch: 8
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.057]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.16]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.125]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.074]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.228]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.033]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[0.922]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.289]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.076]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[5.31e-05]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.013]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.067]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.226]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.032]]
../../new_cache/conv__2297__07_1507__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.016]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 23772
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210710_150900-51bmzfiz/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210710_150900-51bmzfiz/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.82675
wandb:         val_accuracy 0.93648
wandb:             _runtime 7995
wandb:           _timestamp 1625937736
wandb:                _step 210
wandb:           train_loss 0.09517
wandb:             val_loss 0.22015
wandb:           val_recall 0.78049
wandb:        val_precision 0.51613
wandb:               val_f1 0.62136
wandb:              val_auc 0.59192
wandb:                   lr 2e-05
wandb:          best_val_f1 0.65957
wandb:    best_val_accuracy 0.94788
wandb:   best_val_precision 0.58491
wandb:      best_val_recall 0.7561
wandb:             best_auc 0.72686
wandb:           best_epoch 8
wandb: Run history:
wandb:   train_accuracy ▁▄▅▆▇▇▇█▇███████████████████
wandb:     val_accuracy █▃█▅▁███████████████████████
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▅▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▁▂█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▇▃██▃▆▆▇▇▇▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▂█▂▂▇▅▆▄▄▄▅▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_f1 ▁▃▅▄▂▅▇█▇▇▇█▇██▇████████████
wandb:          val_auc ▆▁▇▆▄▆▆█▆▆▆▆▅▆▆▆▆▇▆▆▆▆▆▆▆▆▆▆
wandb:               lr █████████████▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210710_150900-51bmzfiz


 See logs at ../../new_cache/conv__2297__07_1507__v39__mixup/logs/