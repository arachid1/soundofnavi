Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2145
Description:  kfold_mod9
2021-05-17 17:13:35.264598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 17:13:37.475993: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-17 17:13:37.476962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-17 17:13:37.515468: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:13:37.516157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-17 17:13:37.516185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 17:13:37.519687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 17:13:37.519768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 17:13:37.520845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-17 17:13:37.521137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-17 17:13:37.522124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-17 17:13:37.523063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-17 17:13:37.523235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-17 17:13:37.523359: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:13:37.524118: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:13:37.524825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-17 17:14:11.329595: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-17 17:14:11.329864: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:14:11.330598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-17 17:14:11.330636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 17:14:11.330713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 17:14:11.330749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 17:14:11.330765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-17 17:14:11.330781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-17 17:14:11.330806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-17 17:14:11.330822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-17 17:14:11.330836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-17 17:14:11.330937: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:14:11.331674: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:14:11.332339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-17 17:14:11.332420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-17 17:14:12.005191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-17 17:14:12.005238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-17 17:14:12.005246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-17 17:14:12.005512: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:14:12.006285: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:14:12.007012: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-17 17:14:12.007652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2145.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
Original number of folders: 453
K-Fold split N: 0
With concat = False and six = False, size of training set: 4753...
...and size of validation set: 531
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        2021-05-17 17:14:13.223787: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-17 17:14:13.225478: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-17 17:14:16.133353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-17 17:14:16.814898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-17 17:14:16.821678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
298/298 - 587s - loss: 0.6226 - accuracy: 0.7195 - val_loss: 0.6534 - val_accuracy: 0.7439
Confusion matrix: 
 [[395   0]
 [136   0]]
Validation f1: 0.00
Validation accuracy: 74.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2684345223074986
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [531   0]
cm_sum: 531
The training is defaulting to either class.
Epoch 2/80
298/298 - 581s - loss: 0.5768 - accuracy: 0.7385 - val_loss: 0.5771 - val_accuracy: 0.7420
Confusion matrix: 
 [[394   1]
 [136   0]]
Validation f1: 0.00
Validation accuracy: 74.20
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.26326963095747546
Validation class accuracies: [0.9974683544303797, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [530   1]
cm_sum: 531
The training is defaulting to either class.
Epoch 3/80
298/298 - 583s - loss: 0.5687 - accuracy: 0.7374 - val_loss: 0.6677 - val_accuracy: 0.7439
Confusion matrix: 
 [[395   0]
 [136   0]]
Validation f1: 0.00
Validation accuracy: 74.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2805151401902307
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [531   0]
cm_sum: 531
The training is defaulting to either class.
Epoch 4/80
298/298 - 581s - loss: 0.5652 - accuracy: 0.7381 - val_loss: 0.6652 - val_accuracy: 0.7137
Confusion matrix: 
 [[368  27]
 [125  11]]
Validation f1: 12.64
Validation accuracy: 71.37
Validation recall: 8.09
Validation precision: 28.95
Validation AUC: 0.27738726390649954
Validation class accuracies: [0.9316455696202531, 0.08088235294117647]
TARGET: 1
target metric(test f1): 0.12643678160919541
column_sums: [493  38]
cm_sum: 531
The training is defaulting to either class.
Epoch 5/80
298/298 - 581s - loss: 0.5644 - accuracy: 0.7378 - val_loss: 0.5895 - val_accuracy: 0.7420
Confusion matrix: 
 [[388   7]
 [130   6]]
Validation f1: 8.05
Validation accuracy: 74.20
Validation recall: 4.41
Validation precision: 46.15
Validation AUC: 0.2640219081795383
Validation class accuracies: [0.9822784810126582, 0.04411764705882353]
TARGET: 1
target metric(test f1): 0.08053691275167787
column_sums: [518  13]
cm_sum: 531
The training is defaulting to either class.
Epoch 6/80
298/298 - 581s - loss: 0.5600 - accuracy: 0.7374 - val_loss: 0.5909 - val_accuracy: 0.7420
Confusion matrix: 
 [[394   1]
 [136   0]]
Validation f1: 0.00
Validation accuracy: 74.20
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25838886357274804
Validation class accuracies: [0.9974683544303797, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [530   1]
cm_sum: 531
The training is defaulting to either class.
Epoch 7/80
298/298 - 581s - loss: 0.5581 - accuracy: 0.7383 - val_loss: 0.5944 - val_accuracy: 0.7382
Confusion matrix: 
 [[392   3]
 [136   0]]
Validation f1: 0.00
Validation accuracy: 73.82
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2532571860648074
Validation class accuracies: [0.9924050632911392, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [528   3]
cm_sum: 531
The training is defaulting to either class.
Epoch 8/80
298/298 - 582s - loss: 0.5580 - accuracy: 0.7410 - val_loss: 0.5925 - val_accuracy: 0.7420
Confusion matrix: 
 [[394   1]
 [136   0]]
Validation f1: 0.00
Validation accuracy: 74.20
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.26850349615012836
Validation class accuracies: [0.9974683544303797, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [530   1]
cm_sum: 531
The training is defaulting to either class.
Epoch 9/80
298/298 - 577s - loss: 0.5552 - accuracy: 0.7402 - val_loss: 0.5886 - val_accuracy: 0.7363
Confusion matrix: 
 [[388   7]
 [133   3]]
Validation f1: 4.11
Validation accuracy: 73.63
Validation recall: 2.21
Validation precision: 30.00
Validation AUC: 0.2851954168591812
Validation class accuracies: [0.9822784810126582, 0.022058823529411766]
TARGET: 1
target metric(test f1): 0.04109589041095891
column_sums: [521  10]
cm_sum: 531
The training is defaulting to either class.
Epoch 10/80
298/298 - 577s - loss: 0.5503 - accuracy: 0.7397 - val_loss: 0.6721 - val_accuracy: 0.7269
Confusion matrix: 
 [[385  10]
 [135   1]]
Validation f1: 1.36
Validation accuracy: 72.69
Validation recall: 0.74
Validation precision: 9.09
Validation AUC: 0.2805188713587662
Validation class accuracies: [0.9746835443037974, 0.007352941176470588]
TARGET: 1
target metric(test f1): 0.013605442176870748
column_sums: [520  11]
cm_sum: 531
The training is defaulting to either class.
Epoch 11/80
298/298 - 578s - loss: 0.5426 - accuracy: 0.7446 - val_loss: 0.6953 - val_accuracy: 0.7439
Confusion matrix: 
 [[395   0]
 [136   0]]
Validation f1: 0.00
Validation accuracy: 74.39
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2728665701288976
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [531   0]
cm_sum: 531
The training is defaulting to either class.
Epoch 12/80
298/298 - 578s - loss: 0.5480 - accuracy: 0.7406 - val_loss: 0.6090 - val_accuracy: 0.7307
Confusion matrix: 
 [[386   9]
 [134   2]]
Validation f1: 2.72
Validation accuracy: 73.07
Validation recall: 1.47
Validation precision: 18.18
Validation AUC: 0.27807197397302014
Validation class accuracies: [0.9772151898734177, 0.014705882352941176]
TARGET: 1
target metric(test f1): 0.027210884353741496
column_sums: [520  11]
cm_sum: 531
The training is defaulting to either class.
Epoch 13/80
298/298 - 582s - loss: 0.5406 - accuracy: 0.7473 - val_loss: 0.6851 - val_accuracy: 0.7345
Confusion matrix: 
 [[385  10]
 [131   5]]
Validation f1: 6.62
Validation accuracy: 73.45
Validation recall: 3.68
Validation precision: 33.33
Validation AUC: 0.23624767395990215
Validation class accuracies: [0.9746835443037974, 0.03676470588235294]
TARGET: 1
target metric(test f1): 0.06622516556291391
column_sums: [516  15]
cm_sum: 531
The training is defaulting to either class.
Epoch 14/80
298/298 - 582s - loss: 0.5375 - accuracy: 0.7458 - val_loss: 0.6790 - val_accuracy: 0.7288
Confusion matrix: 
 [[384  11]
 [133   3]]
Validation f1: 4.00
Validation accuracy: 72.88
Validation recall: 2.21
Validation precision: 21.43
Validation AUC: 0.25762630891190685
Validation class accuracies: [0.9721518987341772, 0.022058823529411766]
TARGET: 1
target metric(test f1): 0.04
column_sums: [517  14]
cm_sum: 531
The training is defaulting to either class.
Epoch 15/80
298/298 - 584s - loss: 0.5323 - accuracy: 0.7490 - val_loss: 0.6067 - val_accuracy: 0.7458
Confusion matrix: 
 [[393   2]
 [133   3]]
Validation f1: 4.26
Validation accuracy: 74.58
Validation recall: 2.21
Validation precision: 60.00
Validation AUC: 0.2809019256360894
Validation class accuracies: [0.9949367088607595, 0.022058823529411766]
TARGET: 1
target metric(test f1): 0.0425531914893617
column_sums: [526   5]
cm_sum: 531
The training is defaulting to either class.
Epoch 16/80
298/298 - 580s - loss: 0.5264 - accuracy: 0.7532 - val_loss: 0.6528 - val_accuracy: 0.7382
Confusion matrix: 
 [[392   3]
 [136   0]]
Validation f1: 0.00
Validation accuracy: 73.82
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32020965442663085
Validation class accuracies: [0.9924050632911392, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [528   3]
cm_sum: 531
The training is defaulting to either class.
Epoch 17/80
298/298 - 580s - loss: 0.5170 - accuracy: 0.7543 - val_loss: 1.1605 - val_accuracy: 0.4237
Confusion matrix: 
 [[152 243]
 [ 63  73]]
Validation f1: 32.30
Validation accuracy: 42.37
Validation recall: 53.68
Validation precision: 23.10
Validation AUC: 0.23293383529492578
Validation class accuracies: [0.3848101265822785, 0.5367647058823529]
TARGET: 1
target metric(test f1): 0.3230088495575221
column_sums: [215 316]
cm_sum: 531
inside not defaulting
Saving model...
Epoch 18/80
298/298 - 583s - loss: 0.5131 - accuracy: 0.7589 - val_loss: 0.6118 - val_accuracy: 0.7439
Confusion matrix: 
 [[388   7]
 [129   7]]
Validation f1: 9.33
Validation accuracy: 74.39
Validation recall: 5.15
Validation precision: 50.00
Validation AUC: 0.3364690281352091
Validation class accuracies: [0.9822784810126582, 0.051470588235294115]
TARGET: 1
target metric(test f1): 0.09333333333333332
column_sums: [517  14]
cm_sum: 531
The training is defaulting to either class.
Epoch 19/80
298/298 - 578s - loss: 0.5009 - accuracy: 0.7675 - val_loss: 0.6577 - val_accuracy: 0.7250
Confusion matrix: 
 [[367  28]
 [118  18]]
Validation f1: 19.78
Validation accuracy: 72.50
Validation recall: 13.24
Validation precision: 39.13
Validation AUC: 0.27113657802312363
Validation class accuracies: [0.9291139240506329, 0.1323529411764706]
TARGET: 1
target metric(test f1): 0.1978021978021978
column_sums: [485  46]
cm_sum: 531
The training is defaulting to either class.
Epoch 20/80
298/298 - 578s - loss: 0.4905 - accuracy: 0.7688 - val_loss: 0.6486 - val_accuracy: 0.7137
Confusion matrix: 
 [[360  35]
 [117  19]]
Validation f1: 20.00
Validation accuracy: 71.37
Validation recall: 13.97
Validation precision: 35.19
Validation AUC: 0.32505843745389756
Validation class accuracies: [0.9113924050632911, 0.13970588235294118]
TARGET: 1
target metric(test f1): 0.2
column_sums: [477  54]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.3230088495575221 hasn't increased by 0 in 1 epochs
Epoch 21/80
298/298 - 577s - loss: 0.4779 - accuracy: 0.7751 - val_loss: 0.7654 - val_accuracy: 0.6836
Confusion matrix: 
 [[347  48]
 [120  16]]
Validation f1: 16.00
Validation accuracy: 68.36
Validation recall: 11.76
Validation precision: 25.00
Validation AUC: 0.2489564695786354
Validation class accuracies: [0.8784810126582279, 0.11764705882352941]
TARGET: 1
target metric(test f1): 0.15999999999999998
column_sums: [467  64]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.3230088495575221 hasn't increased by 0 in 2 epochs
Epoch 22/80
298/298 - 579s - loss: 0.4552 - accuracy: 0.7902 - val_loss: 1.0019 - val_accuracy: 0.6196
Confusion matrix: 
 [[294 101]
 [101  35]]
Validation f1: 25.74
Validation accuracy: 61.96
Validation recall: 25.74
Validation precision: 25.74
Validation AUC: 0.24464457755698676
Validation class accuracies: [0.7443037974683544, 0.25735294117647056]
TARGET: 1
target metric(test f1): 0.25735294117647056
column_sums: [395 136]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.3230088495575221 hasn't increased by 0 in 3 epochs
Epoch 23/80
298/298 - 578s - loss: 0.4399 - accuracy: 0.7963 - val_loss: 0.7553 - val_accuracy: 0.7382
Confusion matrix: 
 [[388   7]
 [132   4]]
Validation f1: 5.44
Validation accuracy: 73.82
Validation recall: 2.94
Validation precision: 36.36
Validation AUC: 0.27608014757493315
Validation class accuracies: [0.9822784810126582, 0.029411764705882353]
TARGET: 1
target metric(test f1): 0.05442176870748299
column_sums: [520  11]
cm_sum: 531
The training is defaulting to either class.
Epoch 24/80
298/298 - 578s - loss: 0.4202 - accuracy: 0.8088 - val_loss: 0.8602 - val_accuracy: 0.7137
Confusion matrix: 
 [[371  24]
 [128   8]]
Validation f1: 9.52
Validation accuracy: 71.37
Validation recall: 5.88
Validation precision: 25.00
Validation AUC: 0.24482389177769265
Validation class accuracies: [0.9392405063291139, 0.058823529411764705]
TARGET: 1
target metric(test f1): 0.09523809523809523
column_sums: [499  32]
cm_sum: 531
The training is defaulting to either class.
Epoch 25/80
298/298 - 577s - loss: 0.3982 - accuracy: 0.8193 - val_loss: 0.8494 - val_accuracy: 0.7401
Confusion matrix: 
 [[376  19]
 [119  17]]
Validation f1: 19.77
Validation accuracy: 74.01
Validation recall: 12.50
Validation precision: 47.22
Validation AUC: 0.28566130734072614
Validation class accuracies: [0.9518987341772152, 0.125]
TARGET: 1
target metric(test f1): 0.19767441860465115
column_sums: [495  36]
cm_sum: 531
The training is defaulting to either class.
Epoch 26/80
298/298 - 577s - loss: 0.3624 - accuracy: 0.8357 - val_loss: 1.5369 - val_accuracy: 0.4802
Confusion matrix: 
 [[183 212]
 [ 64  72]]
Validation f1: 34.29
Validation accuracy: 48.02
Validation recall: 52.94
Validation precision: 25.35
Validation AUC: 0.27045420701389067
Validation class accuracies: [0.46329113924050636, 0.5294117647058824]
TARGET: 1
target metric(test f1): 0.34285714285714286
column_sums: [247 284]
cm_sum: 531
inside not defaulting
Saving model...
Epoch 27/80
298/298 - 579s - loss: 0.3414 - accuracy: 0.8546 - val_loss: 1.2806 - val_accuracy: 0.5857
Confusion matrix: 
 [[275 120]
 [100  36]]
Validation f1: 24.66
Validation accuracy: 58.57
Validation recall: 26.47
Validation precision: 23.08
Validation AUC: 0.22891697281842593
Validation class accuracies: [0.6962025316455697, 0.2647058823529412]
TARGET: 1
target metric(test f1): 0.24657534246575344
column_sums: [375 156]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 1 epochs
Epoch 28/80
298/298 - 579s - loss: 0.3082 - accuracy: 0.8693 - val_loss: 0.9201 - val_accuracy: 0.6478
Confusion matrix: 
 [[315  80]
 [107  29]]
Validation f1: 23.67
Validation accuracy: 64.78
Validation recall: 21.32
Validation precision: 26.61
Validation AUC: 0.2900921966939425
Validation class accuracies: [0.7974683544303798, 0.21323529411764705]
TARGET: 1
target metric(test f1): 0.23673469387755106
column_sums: [422 109]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 2 epochs
Epoch 29/80
298/298 - 578s - loss: 0.2945 - accuracy: 0.8773 - val_loss: 1.2614 - val_accuracy: 0.6234
Confusion matrix: 
 [[283 112]
 [ 88  48]]
Validation f1: 32.43
Validation accuracy: 62.34
Validation recall: 35.29
Validation precision: 30.00
Validation AUC: 0.2854507297998554
Validation class accuracies: [0.7164556962025317, 0.35294117647058826]
TARGET: 1
target metric(test f1): 0.3243243243243243
column_sums: [371 160]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 3 epochs
Epoch 30/80
298/298 - 578s - loss: 0.2641 - accuracy: 0.8881 - val_loss: 1.2370 - val_accuracy: 0.6403
Confusion matrix: 
 [[301  94]
 [ 97  39]]
Validation f1: 29.00
Validation accuracy: 64.03
Validation recall: 28.68
Validation precision: 29.32
Validation AUC: 0.2757584908151879
Validation class accuracies: [0.7620253164556962, 0.2867647058823529]
TARGET: 1
target metric(test f1): 0.28996282527881034
column_sums: [398 133]
cm_sum: 531
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 4 epochs
Epoch 31/80
298/298 - 579s - loss: 0.1859 - accuracy: 0.9240 - val_loss: 1.1668 - val_accuracy: 0.6949
Confusion matrix: 
 [[341  54]
 [108  28]]
Validation f1: 25.69
Validation accuracy: 69.49
Validation recall: 20.59
Validation precision: 34.15
Validation AUC: 0.2814341396593458
Validation class accuracies: [0.8632911392405064, 0.20588235294117646]
TARGET: 1
target metric(test f1): 0.2568807339449541
column_sums: [449  82]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 5 epochs
Epoch 32/80
298/298 - 578s - loss: 0.1562 - accuracy: 0.9432 - val_loss: 1.3387 - val_accuracy: 0.6158
Confusion matrix: 
 [[291 104]
 [100  36]]
Validation f1: 26.09
Validation accuracy: 61.58
Validation recall: 26.47
Validation precision: 25.71
Validation AUC: 0.2685553576327718
Validation class accuracies: [0.7367088607594937, 0.2647058823529412]
TARGET: 1
target metric(test f1): 0.2608695652173913
column_sums: [391 140]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 6 epochs
Epoch 33/80
298/298 - 579s - loss: 0.1383 - accuracy: 0.9463 - val_loss: 1.4096 - val_accuracy: 0.6761
Confusion matrix: 
 [[331  64]
 [108  28]]
Validation f1: 24.56
Validation accuracy: 67.61
Validation recall: 20.59
Validation precision: 30.43
Validation AUC: 0.2781430516820298
Validation class accuracies: [0.8379746835443038, 0.20588235294117646]
TARGET: 1
target metric(test f1): 0.2456140350877193
column_sums: [439  92]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 7 epochs
Epoch 34/80
298/298 - 578s - loss: 0.1443 - accuracy: 0.9447 - val_loss: 1.4998 - val_accuracy: 0.6460
Confusion matrix: 
 [[306  89]
 [ 99  37]]
Validation f1: 28.24
Validation accuracy: 64.60
Validation recall: 27.21
Validation precision: 29.37
Validation AUC: 0.2676556973156507
Validation class accuracies: [0.7746835443037975, 0.27205882352941174]
TARGET: 1
target metric(test f1): 0.282442748091603
column_sums: [405 126]
cm_sum: 531
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 8 epochs
Epoch 35/80
298/298 - 578s - loss: 0.1290 - accuracy: 0.9546 - val_loss: 1.4594 - val_accuracy: 0.6573
Confusion matrix: 
 [[312  83]
 [ 99  37]]
Validation f1: 28.91
Validation accuracy: 65.73
Validation recall: 27.21
Validation precision: 30.83
Validation AUC: 0.2770206057364911
Validation class accuracies: [0.789873417721519, 0.27205882352941174]
TARGET: 1
target metric(test f1): 0.2890625
column_sums: [411 120]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 9 epochs
Epoch 36/80
298/298 - 579s - loss: 0.1293 - accuracy: 0.9514 - val_loss: 1.4935 - val_accuracy: 0.6516
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[305  90]
 [ 95  41]]
Validation f1: 30.71
Validation accuracy: 65.16
Validation recall: 30.15
Validation precision: 31.30
Validation AUC: 0.2768425761233194
Validation class accuracies: [0.7721518987341772, 0.3014705882352941]
TARGET: 1
target metric(test f1): 0.30711610486891383
column_sums: [400 131]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 10 epochs
Epoch 37/80
298/298 - 578s - loss: 0.1139 - accuracy: 0.9590 - val_loss: 1.5030 - val_accuracy: 0.6554
Confusion matrix: 
 [[309  86]
 [ 97  39]]
Validation f1: 29.89
Validation accuracy: 65.54
Validation recall: 28.68
Validation precision: 31.20
Validation AUC: 0.2743604420284369
Validation class accuracies: [0.7822784810126582, 0.2867647058823529]
TARGET: 1
target metric(test f1): 0.2988505747126437
column_sums: [406 125]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 11 epochs
Epoch 38/80
298/298 - 578s - loss: 0.1085 - accuracy: 0.9604 - val_loss: 1.5565 - val_accuracy: 0.6497
Confusion matrix: 
 [[301  94]
 [ 92  44]]
Validation f1: 32.12
Validation accuracy: 64.97
Validation recall: 32.35
Validation precision: 31.88
Validation AUC: 0.27462035705150056
Validation class accuracies: [0.7620253164556962, 0.3235294117647059]
TARGET: 1
target metric(test f1): 0.3211678832116788
column_sums: [393 138]
cm_sum: 531
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 12 epochs
Epoch 39/80
298/298 - 578s - loss: 0.1132 - accuracy: 0.9562 - val_loss: 1.5552 - val_accuracy: 0.6573
Confusion matrix: 
 [[306  89]
 [ 93  43]]
Validation f1: 32.09
Validation accuracy: 65.73
Validation recall: 31.62
Validation precision: 32.58
Validation AUC: 0.2770467281434708
Validation class accuracies: [0.7746835443037975, 0.3161764705882353]
TARGET: 1
target metric(test f1): 0.3208955223880597
column_sums: [399 132]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 13 epochs
Epoch 40/80
298/298 - 577s - loss: 0.1163 - accuracy: 0.9573 - val_loss: 1.5513 - val_accuracy: 0.6573
Confusion matrix: 
 [[306  89]
 [ 93  43]]
Validation f1: 32.09
Validation accuracy: 65.73
Validation recall: 31.62
Validation precision: 32.58
Validation AUC: 0.2765957138659467
Validation class accuracies: [0.7746835443037975, 0.3161764705882353]
TARGET: 1
target metric(test f1): 0.3208955223880597
column_sums: [399 132]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 14 epochs
Epoch 41/80
298/298 - 578s - loss: 0.1106 - accuracy: 0.9592 - val_loss: 1.5656 - val_accuracy: 0.6610
Confusion matrix: 
 [[308  87]
 [ 93  43]]
Validation f1: 32.33
Validation accuracy: 66.10
Validation recall: 31.62
Validation precision: 33.08
Validation AUC: 0.2748666415987159
Validation class accuracies: [0.779746835443038, 0.3161764705882353]
TARGET: 1
target metric(test f1): 0.3233082706766917
column_sums: [401 130]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 15 epochs
Epoch 42/80
298/298 - 579s - loss: 0.1182 - accuracy: 0.9571 - val_loss: 1.5599 - val_accuracy: 0.6554
Confusion matrix: 
 [[307  88]
 [ 95  41]]
Validation f1: 30.94
Validation accuracy: 65.54
Validation recall: 30.15
Validation precision: 31.78
Validation AUC: 0.27391300556052833
Validation class accuracies: [0.7772151898734178, 0.3014705882352941]
TARGET: 1
target metric(test f1): 0.309433962264151
column_sums: [402 129]
cm_sum: 531
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 16 epochs
Epoch 43/80
298/298 - 578s - loss: 0.1143 - accuracy: 0.9541 - val_loss: 1.5616 - val_accuracy: 0.6648
Confusion matrix: 
 [[309  86]
 [ 92  44]]
Validation f1: 33.08
Validation accuracy: 66.48
Validation recall: 32.35
Validation precision: 33.85
Validation AUC: 0.274953399211708
Validation class accuracies: [0.7822784810126582, 0.3235294117647059]
TARGET: 1
target metric(test f1): 0.3308270676691729
column_sums: [401 130]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 17 epochs
Epoch 44/80
298/298 - 581s - loss: 0.1000 - accuracy: 0.9636 - val_loss: 1.5639 - val_accuracy: 0.6497
Confusion matrix: 
 [[307  88]
 [ 98  38]]
Validation f1: 29.01
Validation accuracy: 64.97
Validation recall: 27.94
Validation precision: 30.16
Validation AUC: 0.2744067990797144
Validation class accuracies: [0.7772151898734178, 0.27941176470588236]
TARGET: 1
target metric(test f1): 0.2900763358778626
column_sums: [405 126]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 18 epochs
Epoch 45/80
298/298 - 582s - loss: 0.1019 - accuracy: 0.9632 - val_loss: 1.5618 - val_accuracy: 0.6535
Confusion matrix: 
 [[306  89]
 [ 95  41]]
Validation f1: 30.83
Validation accuracy: 65.35
Validation recall: 30.15
Validation precision: 31.54
Validation AUC: 0.273233226802734
Validation class accuracies: [0.7746835443037975, 0.3014705882352941]
TARGET: 1
target metric(test f1): 0.3082706766917293
column_sums: [401 130]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 19 epochs
Epoch 46/80
298/298 - 581s - loss: 0.1096 - accuracy: 0.9596 - val_loss: 1.5785 - val_accuracy: 0.6535
Confusion matrix: 
 [[304  91]
 [ 93  43]]
Validation f1: 31.85
Validation accuracy: 65.35
Validation recall: 31.62
Validation precision: 32.09
Validation AUC: 0.27544107258046274
Validation class accuracies: [0.769620253164557, 0.3161764705882353]
TARGET: 1
target metric(test f1): 0.31851851851851853
column_sums: [397 134]
cm_sum: 531
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 20 epochs
Epoch 47/80
298/298 - 580s - loss: 0.0950 - accuracy: 0.9684 - val_loss: 1.5645 - val_accuracy: 0.6516
Confusion matrix: 
 [[305  90]
 [ 95  41]]
Validation f1: 30.71
Validation accuracy: 65.16
Validation recall: 30.15
Validation precision: 31.30
Validation AUC: 0.2735174103389065
Validation class accuracies: [0.7721518987341772, 0.3014705882352941]
TARGET: 1
target metric(test f1): 0.30711610486891383
column_sums: [400 131]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 21 epochs
Epoch 48/80
298/298 - 585s - loss: 0.1144 - accuracy: 0.9598 - val_loss: 1.5719 - val_accuracy: 0.6704
Confusion matrix: 
 [[314  81]
 [ 94  42]]
Validation f1: 32.43
Validation accuracy: 67.04
Validation recall: 30.88
Validation precision: 34.15
Validation AUC: 0.2738322158454142
Validation class accuracies: [0.7949367088607595, 0.3088235294117647]
TARGET: 1
target metric(test f1): 0.32432432432432434
column_sums: [408 123]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 22 epochs
Epoch 49/80
298/298 - 579s - loss: 0.1077 - accuracy: 0.9615 - val_loss: 1.5773 - val_accuracy: 0.6685
Confusion matrix: 
 [[313  82]
 [ 94  42]]
Validation f1: 32.31
Validation accuracy: 66.85
Validation recall: 30.88
Validation precision: 33.87
Validation AUC: 0.27399521210732536
Validation class accuracies: [0.7924050632911392, 0.3088235294117647]
TARGET: 1
target metric(test f1): 0.3230769230769231
column_sums: [407 124]
cm_sum: 531
inside not defaulting
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 23 epochs
Epoch 50/80
298/298 - 580s - loss: 0.1026 - accuracy: 0.9625 - val_loss: 1.5698 - val_accuracy: 0.6591
Confusion matrix: 
 [[307  88]
 [ 93  43]]
Validation f1: 32.21
Validation accuracy: 65.91
Validation recall: 31.62
Validation precision: 32.82
Validation AUC: 0.27392567206472734
Validation class accuracies: [0.7772151898734178, 0.3161764705882353]
TARGET: 1
target metric(test f1): 0.3220973782771535
column_sums: [400 131]
cm_sum: 531
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.34285714285714286 hasn't increased by 0 in 24 epochs
Epoch 51/80
298/298 - 579s - loss: 0.0998 - accuracy: 0.9647 - val_loss: 1.5670 - val_accuracy: 0.6610
Confusion matrix: 
 [[308  87]
 [ 93  43]]
Validation f1: 32.33
Validation accuracy: 66.10
Validation recall: 31.62
Validation precision: 33.08
Validation AUC: 0.27417030292997435
Validation class accuracies: [0.779746835443038, 0.3161764705882353]

The metrics for the epoch with the best target metric are: 
Best cm: [[183 212]
 [ 64  72]]
Best f1: 0.34285714285714286
Best accuracy: 0.480225988700565
Best recall: 0.5294117647058824
Best precision: 0.2535211267605634
Best AUC: 0.27045420701389067
Best epoch: 26
TARGET: 1
target metric(test f1): 0.3233082706766917
column_sums: [401 130]
cm_sum: 531
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 17
Starting...
CM: [[ 1 26]
 [ 1 10]]
F1: 0.4255319148936171
AUC: 0.6065922381711855
Accuracy: 0.2894736842105263
Precision: 0.2777777777777778
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_17.xls...
Done.
Epoch: 17
Starting...
CM: [[ 2 25]
 [ 1 10]]
F1: 0.43478260869565216
AUC: 0.6105604921394395
Accuracy: 0.3157894736842105
Precision: 0.2857142857142857
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_17.xls...
Done.
Epoch: 17
Starting...
CM: [[ 5 22]
 [ 3  8]]
F1: 0.3902439024390244
AUC: 0.5364433811802233
Accuracy: 0.34210526315789475
Precision: 0.26666666666666666
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_17.xls...
Done.
Epoch: 26
Starting...
CM: [[ 1 26]
 [ 2  9]]
F1: 0.39130434782608686
AUC: 0.5639781271360219
Accuracy: 0.2631578947368421
Precision: 0.2571428571428571
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_26.xls...
Done.
Epoch: 26
Starting...
CM: [[ 2 25]
 [ 2  9]]
F1: 0.39999999999999997
AUC: 0.5677596397410638
Accuracy: 0.2894736842105263
Precision: 0.2647058823529412
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_26.xls...
Done.
Epoch: 26
Starting...
CM: [[ 6 21]
 [ 4  7]]
F1: 0.358974358974359
AUC: 0.4958133971291866
Accuracy: 0.34210526315789475
Precision: 0.25
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_26.xls...
Done.
Epoch: 80
Starting...
CM: [[ 7 20]
 [ 1 10]]
F1: 0.4878048780487804
AUC: 0.6343700159489633
Accuracy: 0.4473684210526316
Precision: 0.3333333333333333
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_80.xls...
Done.
Epoch: 80
Starting...
CM: [[15 12]
 [ 3  8]]
F1: 0.5161290322580645
AUC: 0.6031100478468899
Accuracy: 0.6052631578947368
Precision: 0.4
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_80.xls...
Done.
Epoch: 80
Starting...
CM: [[20  7]
 [ 6  5]]
F1: 0.43478260869565216
AUC: 0.5145534290271132
Accuracy: 0.6578947368421053
Precision: 0.4166666666666667
Recall: 0.45454545454545453
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_0_80.xls...
Done.
K-Fold split N: 1
With concat = False and six = False, size of training set: 4782...
...and size of validation set: 502
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_11 (InputLayer)           [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_60 (BatchNo (None, 128, 1250, 1) 4           input_11[0][0]                   
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 128, 1250, 16 32          batch_normalization_60[0][0]     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 128, 1250, 16 32          batch_normalization_60[0][0]     
__________________________________________________________________________________________________
max_pooling2d_10 (MaxPooling2D) (None, 128, 1250, 1) 0           batch_normalization_60[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 128, 1250, 16 2320        conv2d_50[0][0]                  
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 128, 1250, 16 6416        conv2d_52[0][0]                  
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 128, 1250, 16 32          max_pooling2d_10[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 128, 1250, 48 0           conv2d_51[0][0]                  
                                                                 conv2d_53[0][0]                  
                                                                 conv2d_54[0][0]                  
__________________________________________________________________________________________________
average_pooling2d_50 (AveragePo (None, 64, 625, 48)  0           concatenate_10[0][0]             
__________________________________________________________________________________________________
batch_normalization_61 (BatchNo (None, 64, 625, 48)  192         average_pooling2d_50[0][0]       
__________________________________________________________________________________________________
dropout_50 (Dropout)            (None, 64, 625, 48)  0           batch_normalization_61[0][0]     
__________________________________________________________________________________________________
inverted_residual_100 (Inverted (None, 64, 625, 32)  35840       dropout_50[0][0]                 
__________________________________________________________________________________________________
inverted_residual_101 (Inverted (None, 64, 625, 32)  20864       inverted_residual_100[0][0]      
__________________________________________________________________________________________________
average_pooling2d_51 (AveragePo (None, 32, 312, 32)  0           inverted_residual_101[0][0]      
__________________________________________________________________________________________________
batch_normalization_62 (BatchNo (None, 32, 312, 32)  128         average_pooling2d_51[0][0]       
__________________________________________________________________________________________________
dropout_51 (Dropout)            (None, 32, 312, 32)  0           batch_normalization_62[0][0]     
__________________________________________________________________________________________________
inverted_residual_102 (Inverted (None, 32, 312, 64)  27136       dropout_51[0][0]                 
__________________________________________________________________________________________________
inverted_residual_103 (Inverted (None, 32, 312, 64)  66304       inverted_residual_102[0][0]      
__________________________________________________________________________________________________
average_pooling2d_52 (AveragePo (None, 16, 156, 64)  0           inverted_residual_103[0][0]      
__________________________________________________________________________________________________
batch_normalization_63 (BatchNo (None, 16, 156, 64)  256         average_pooling2d_52[0][0]       
__________________________________________________________________________________________________
dropout_52 (Dropout)            (None, 16, 156, 64)  0           batch_normalization_63[0][0]     
__________________________________________________________________________________________________
inverted_residual_104 (Inverted (None, 16, 156, 128) 91136       dropout_52[0][0]                 
__________________________________________________________________________________________________
inverted_residual_105 (Inverted (None, 16, 156, 128) 230912      inverted_residual_104[0][0]      
__________________________________________________________________________________________________
average_pooling2d_53 (AveragePo (None, 8, 78, 128)   0           inverted_residual_105[0][0]      
__________________________________________________________________________________________________
batch_normalization_64 (BatchNo (None, 8, 78, 128)   512         average_pooling2d_53[0][0]       
__________________________________________________________________________________________________
dropout_53 (Dropout)            (None, 8, 78, 128)   0           batch_normalization_64[0][0]     
__________________________________________________________________________________________________
inverted_residual_106 (Inverted (None, 8, 78, 256)   329728      dropout_53[0][0]                 
__________________________________________________________________________________________________
inverted_residual_107 (Inverted (None, 8, 78, 256)   855040      inverted_residual_106[0][0]      
__________________________________________________________________________________________________
average_pooling2d_54 (AveragePo (None, 4, 39, 256)   0           inverted_residual_107[0][0]      
__________________________________________________________________________________________________
batch_normalization_65 (BatchNo (None, 4, 39, 256)   1024        average_pooling2d_54[0][0]       
__________________________________________________________________________________________________
dropout_54 (Dropout)            (None, 4, 39, 256)   0           batch_normalization_65[0][0]     
__________________________________________________________________________________________________
inverted_residual_108 (Inverted (None, 4, 39, 512)   1249280     dropout_54[0][0]                 
__________________________________________________________________________________________________
inverted_residual_109 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_108[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_10 (Gl (None, 512)          0           inverted_residual_109[0][0]      
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 1)            513         global_average_pooling2d_10[0][0]
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
299/299 - 592s - loss: 0.6166 - accuracy: 0.7330 - val_loss: 0.6351 - val_accuracy: 0.6952
Confusion matrix: 
 [[349   0]
 [153   0]]
Validation f1: 0.00
Validation accuracy: 69.52
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27762587772696223
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [502   0]
cm_sum: 502
The training is defaulting to either class.
Epoch 2/80
299/299 - 586s - loss: 0.5717 - accuracy: 0.7390 - val_loss: 0.6336 - val_accuracy: 0.6952
Confusion matrix: 
 [[349   0]
 [153   0]]
Validation f1: 0.00
Validation accuracy: 69.52
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.4078758291993454
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [502   0]
cm_sum: 502
The training is defaulting to either class.
Epoch 3/80
299/299 - 585s - loss: 0.5642 - accuracy: 0.7419 - val_loss: 0.6527 - val_accuracy: 0.6952
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[349   0]
 [153   0]]
Validation f1: 0.00
Validation accuracy: 69.52
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.27299734113552476
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [502   0]
cm_sum: 502
The training is defaulting to either class.
Epoch 4/80
299/299 - 584s - loss: 0.5645 - accuracy: 0.7403 - val_loss: 0.6490 - val_accuracy: 0.6693
Confusion matrix: 
 [[334  15]
 [151   2]]
Validation f1: 2.35
Validation accuracy: 66.93
Validation recall: 1.31
Validation precision: 11.76
Validation AUC: 0.2652204779096914
Validation class accuracies: [0.9570200573065902, 0.013071895424836602]
TARGET: 1
target metric(test f1): 0.023529411764705882
column_sums: [485  17]
cm_sum: 502
The training is defaulting to either class.
Epoch 5/80
299/299 - 583s - loss: 0.5574 - accuracy: 0.7451 - val_loss: 0.7933 - val_accuracy: 0.6434
Confusion matrix: 
 [[308  41]
 [138  15]]
Validation f1: 14.35
Validation accuracy: 64.34
Validation recall: 9.80
Validation precision: 26.79
Validation AUC: 0.2716512982623165
Validation class accuracies: [0.8825214899713467, 0.09803921568627451]
TARGET: 1
target metric(test f1): 0.14354066985645933
column_sums: [446  56]
cm_sum: 502
inside not defaulting
Saving model...
Epoch 6/80
299/299 - 583s - loss: 0.5528 - accuracy: 0.7432 - val_loss: 0.7428 - val_accuracy: 0.6594
Confusion matrix: 
 [[327  22]
 [149   4]]
Validation f1: 4.47
Validation accuracy: 65.94
Validation recall: 2.61
Validation precision: 15.38
Validation AUC: 0.3046566522231046
Validation class accuracies: [0.9369627507163324, 0.026143790849673203]
TARGET: 1
target metric(test f1): 0.044692737430167606
column_sums: [476  26]
cm_sum: 502
The training is defaulting to either class.
Epoch 7/80
299/299 - 584s - loss: 0.5520 - accuracy: 0.7449 - val_loss: 0.6382 - val_accuracy: 0.6952
Confusion matrix: 
 [[349   0]
 [153   0]]
Validation f1: 0.00
Validation accuracy: 69.52
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32686548775463775
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [502   0]
cm_sum: 502
The training is defaulting to either class.
Epoch 8/80
299/299 - 582s - loss: 0.5474 - accuracy: 0.7445 - val_loss: 0.6997 - val_accuracy: 0.6912
Confusion matrix: 
 [[347   2]
 [153   0]]
Validation f1: 0.00
Validation accuracy: 69.12
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.28679637812425535
Validation class accuracies: [0.994269340974212, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [500   2]
cm_sum: 502
The training is defaulting to either class.
Epoch 9/80
299/299 - 584s - loss: 0.5443 - accuracy: 0.7455 - val_loss: 0.6841 - val_accuracy: 0.6932
Confusion matrix: 
 [[348   1]
 [153   0]]
Validation f1: 0.00
Validation accuracy: 69.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32388194994935415
Validation class accuracies: [0.997134670487106, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [501   1]
cm_sum: 502
The training is defaulting to either class.
Epoch 10/80
299/299 - 582s - loss: 0.5434 - accuracy: 0.7442 - val_loss: 0.6591 - val_accuracy: 0.6614
Confusion matrix: 
 [[317  32]
 [138  15]]
Validation f1: 15.00
Validation accuracy: 66.14
Validation recall: 9.80
Validation precision: 31.91
Validation AUC: 0.3019550564838072
Validation class accuracies: [0.9083094555873925, 0.09803921568627451]
TARGET: 1
target metric(test f1): 0.15
column_sums: [455  47]
cm_sum: 502
The training is defaulting to either class.
Epoch 11/80
299/299 - 581s - loss: 0.5422 - accuracy: 0.7457 - val_loss: 0.7838 - val_accuracy: 0.6474
Confusion matrix: 
 [[316  33]
 [144   9]]
Validation f1: 9.23
Validation accuracy: 64.74
Validation recall: 5.88
Validation precision: 21.43
Validation AUC: 0.3085939216251022
Validation class accuracies: [0.9054441260744985, 0.058823529411764705]
TARGET: 1
target metric(test f1): 0.09230769230769231
column_sums: [460  42]
cm_sum: 502
The training is defaulting to either class.
Epoch 12/80
299/299 - 583s - loss: 0.5335 - accuracy: 0.7520 - val_loss: 0.6432 - val_accuracy: 0.6813
Confusion matrix: 
 [[337  12]
 [148   5]]
Validation f1: 5.88
Validation accuracy: 68.13
Validation recall: 3.27
Validation precision: 29.41
Validation AUC: 0.3203095613136492
Validation class accuracies: [0.9656160458452722, 0.032679738562091505]
TARGET: 1
target metric(test f1): 0.05882352941176471
column_sums: [485  17]
cm_sum: 502
The training is defaulting to either class.
Epoch 13/80
299/299 - 582s - loss: 0.5323 - accuracy: 0.7530 - val_loss: 0.6815 - val_accuracy: 0.6653
Confusion matrix: 
 [[320  29]
 [139  14]]
Validation f1: 14.29
Validation accuracy: 66.53
Validation recall: 9.15
Validation precision: 32.56
Validation AUC: 0.36021167481571265
Validation class accuracies: [0.9169054441260746, 0.0915032679738562]
TARGET: 1
target metric(test f1): 0.14285714285714285
column_sums: [459  43]
cm_sum: 502
The training is defaulting to either class.
Epoch 14/80
299/299 - 582s - loss: 0.5268 - accuracy: 0.7537 - val_loss: 0.7894 - val_accuracy: 0.6414
Confusion matrix: 
 [[304  45]
 [135  18]]
Validation f1: 16.67
Validation accuracy: 64.14
Validation recall: 11.76
Validation precision: 28.57
Validation AUC: 0.2999306294788685
Validation class accuracies: [0.8710601719197708, 0.11764705882352941]
TARGET: 1
target metric(test f1): 0.16666666666666666
column_sums: [439  63]
cm_sum: 502
inside not defaulting
Saving model...
Epoch 15/80
299/299 - 584s - loss: 0.5205 - accuracy: 0.7572 - val_loss: 0.6956 - val_accuracy: 0.6873
Confusion matrix: 
 [[345   4]
 [153   0]]
Validation f1: 0.00
Validation accuracy: 68.73
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32743049555968007
Validation class accuracies: [0.9885386819484241, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [498   4]
cm_sum: 502
The training is defaulting to either class.
Epoch 16/80
299/299 - 582s - loss: 0.5139 - accuracy: 0.7631 - val_loss: 0.7755 - val_accuracy: 0.6753
Confusion matrix: 
 [[338  11]
 [152   1]]
Validation f1: 1.21
Validation accuracy: 67.53
Validation recall: 0.65
Validation precision: 8.33
Validation AUC: 0.3086280924345181
Validation class accuracies: [0.9684813753581661, 0.006535947712418301]
TARGET: 1
target metric(test f1): 0.01212121212121212
column_sums: [490  12]
cm_sum: 502
The training is defaulting to either class.
Epoch 17/80
299/299 - 583s - loss: 0.5067 - accuracy: 0.7639 - val_loss: 0.7125 - val_accuracy: 0.6614
Confusion matrix: 
 [[325  24]
 [146   7]]
Validation f1: 7.61
Validation accuracy: 66.14
Validation recall: 4.58
Validation precision: 22.58
Validation AUC: 0.3107769426986249
Validation class accuracies: [0.9312320916905444, 0.0457516339869281]
TARGET: 1
target metric(test f1): 0.07608695652173914
column_sums: [471  31]
cm_sum: 502
The training is defaulting to either class.
Epoch 18/80
299/299 - 582s - loss: 0.4944 - accuracy: 0.7710 - val_loss: 0.7658 - val_accuracy: 0.6793
Confusion matrix: 
 [[341   8]
 [153   0]]
Validation f1: 0.00
Validation accuracy: 67.93
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3041245680667142
Validation class accuracies: [0.9770773638968482, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [494   8]
cm_sum: 502
The training is defaulting to either class.
Epoch 19/80
299/299 - 583s - loss: 0.4792 - accuracy: 0.7819 - val_loss: 0.9120 - val_accuracy: 0.6494
Confusion matrix: 
 [[321  28]
 [148   5]]
Validation f1: 5.38
Validation accuracy: 64.94
Validation recall: 3.27
Validation precision: 15.15
Validation AUC: 0.2716718816959634
Validation class accuracies: [0.9197707736389685, 0.032679738562091505]
TARGET: 1
target metric(test f1): 0.05376344086021506
column_sums: [469  33]
cm_sum: 502
The training is defaulting to either class.
Epoch 20/80
299/299 - 583s - loss: 0.4671 - accuracy: 0.7804 - val_loss: 0.8607 - val_accuracy: 0.6753
Confusion matrix: 
 [[337  12]
 [151   2]]
Validation f1: 2.40
Validation accuracy: 67.53
Validation recall: 1.31
Validation precision: 14.29
Validation AUC: 0.3165608675260758
Validation class accuracies: [0.9656160458452722, 0.013071895424836602]
TARGET: 1
target metric(test f1): 0.02395209580838323
column_sums: [488  14]
cm_sum: 502
The training is defaulting to either class.
Epoch 21/80
299/299 - 584s - loss: 0.4419 - accuracy: 0.7980 - val_loss: 1.0203 - val_accuracy: 0.6653
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[324  25]
 [143  10]]
Validation f1: 10.64
Validation accuracy: 66.53
Validation recall: 6.54
Validation precision: 28.57
Validation AUC: 0.3179804616754053
Validation class accuracies: [0.9283667621776505, 0.06535947712418301]
TARGET: 1
target metric(test f1): 0.10638297872340426
column_sums: [467  35]
cm_sum: 502
The training is defaulting to either class.
Epoch 22/80
299/299 - 587s - loss: 0.4221 - accuracy: 0.8118 - val_loss: 1.1259 - val_accuracy: 0.6633
Confusion matrix: 
 [[330  19]
 [150   3]]
Validation f1: 3.43
Validation accuracy: 66.33
Validation recall: 1.96
Validation precision: 13.64
Validation AUC: 0.26748293710750526
Validation class accuracies: [0.9455587392550143, 0.0196078431372549]
TARGET: 1
target metric(test f1): 0.03428571428571429
column_sums: [480  22]
cm_sum: 502
The training is defaulting to either class.
Epoch 23/80
299/299 - 584s - loss: 0.4030 - accuracy: 0.8250 - val_loss: 1.0358 - val_accuracy: 0.6554
Confusion matrix: 
 [[321  28]
 [145   8]]
Validation f1: 8.47
Validation accuracy: 65.54
Validation recall: 5.23
Validation precision: 22.22
Validation AUC: 0.3055559241358033
Validation class accuracies: [0.9197707736389685, 0.05228758169934641]
TARGET: 1
target metric(test f1): 0.08465608465608467
column_sums: [466  36]
cm_sum: 502
The training is defaulting to either class.
Epoch 24/80
299/299 - 583s - loss: 0.3726 - accuracy: 0.8402 - val_loss: 1.1305 - val_accuracy: 0.5717
Confusion matrix: 
 [[236 113]
 [102  51]]
Validation f1: 32.18
Validation accuracy: 57.17
Validation recall: 33.33
Validation precision: 31.10
Validation AUC: 0.2881417579852026
Validation class accuracies: [0.6762177650429799, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.3217665615141956
column_sums: [338 164]
cm_sum: 502
inside not defaulting
Saving model...
Epoch 25/80
299/299 - 584s - loss: 0.3513 - accuracy: 0.8478 - val_loss: 1.0400 - val_accuracy: 0.6693
Confusion matrix: 
 [[321  28]
 [138  15]]
Validation f1: 15.31
Validation accuracy: 66.93
Validation recall: 9.80
Validation precision: 34.88
Validation AUC: 0.32305176168133354
Validation class accuracies: [0.9197707736389685, 0.09803921568627451]
TARGET: 1
target metric(test f1): 0.15306122448979592
column_sums: [459  43]
cm_sum: 502
The training is defaulting to either class.
Epoch 26/80
299/299 - 582s - loss: 0.3165 - accuracy: 0.8639 - val_loss: 1.1000 - val_accuracy: 0.6215
Confusion matrix: 
 [[282  67]
 [123  30]]
Validation f1: 24.00
Validation accuracy: 62.15
Validation recall: 19.61
Validation precision: 30.93
Validation AUC: 0.2941538632629213
Validation class accuracies: [0.8080229226361032, 0.19607843137254902]
TARGET: 1
target metric(test f1): 0.24000000000000002
column_sums: [405  97]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 1 epochs
Epoch 27/80
299/299 - 584s - loss: 0.3105 - accuracy: 0.8664 - val_loss: 1.0411 - val_accuracy: 0.5896
Confusion matrix: 
 [[262  87]
 [119  34]]
Validation f1: 24.82
Validation accuracy: 58.96
Validation recall: 22.22
Validation precision: 28.10
Validation AUC: 0.301202220961695
Validation class accuracies: [0.7507163323782235, 0.2222222222222222]
TARGET: 1
target metric(test f1): 0.2481751824817518
column_sums: [381 121]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 2 epochs
Epoch 28/80
299/299 - 583s - loss: 0.2704 - accuracy: 0.8873 - val_loss: 1.3915 - val_accuracy: 0.6853
Confusion matrix: 
 [[336  13]
 [145   8]]
Validation f1: 9.20
Validation accuracy: 68.53
Validation recall: 5.23
Validation precision: 38.10
Validation AUC: 0.31631825961686266
Validation class accuracies: [0.9627507163323782, 0.05228758169934641]
TARGET: 1
target metric(test f1): 0.09195402298850576
column_sums: [481  21]
cm_sum: 502
The training is defaulting to either class.
Epoch 29/80
299/299 - 584s - loss: 0.2485 - accuracy: 0.9026 - val_loss: 1.5361 - val_accuracy: 0.6494
Confusion matrix: 
 [[307  42]
 [134  19]]
Validation f1: 17.76
Validation accuracy: 64.94
Validation recall: 12.42
Validation precision: 31.15
Validation AUC: 0.29412354143316444
Validation class accuracies: [0.8796561604584527, 0.12418300653594772]
TARGET: 1
target metric(test f1): 0.17757009345794392
column_sums: [441  61]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 3 epochs
Epoch 30/80
299/299 - 582s - loss: 0.2256 - accuracy: 0.9080 - val_loss: 1.3875 - val_accuracy: 0.6295
Confusion matrix: 
 [[277  72]
 [114  39]]
Validation f1: 29.55
Validation accuracy: 62.95
Validation recall: 25.49
Validation precision: 35.14
Validation AUC: 0.31599189822257173
Validation class accuracies: [0.7936962750716332, 0.2549019607843137]
TARGET: 1
target metric(test f1): 0.29545454545454547
column_sums: [391 111]
cm_sum: 502
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 4 epochs
Epoch 31/80
299/299 - 583s - loss: 0.1685 - accuracy: 0.9325 - val_loss: 1.4446 - val_accuracy: 0.6594
Confusion matrix: 
 [[312  37]
 [134  19]]
Validation f1: 18.18
Validation accuracy: 65.94
Validation recall: 12.42
Validation precision: 33.93
Validation AUC: 0.2972738939530275
Validation class accuracies: [0.8939828080229226, 0.12418300653594772]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [446  56]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 5 epochs
Epoch 32/80
299/299 - 582s - loss: 0.1388 - accuracy: 0.9479 - val_loss: 1.5761 - val_accuracy: 0.6454
Confusion matrix: 
 [[297  52]
 [126  27]]
Validation f1: 23.28
Validation accuracy: 64.54
Validation recall: 17.65
Validation precision: 34.18
Validation AUC: 0.3191326839868249
Validation class accuracies: [0.8510028653295129, 0.17647058823529413]
TARGET: 1
target metric(test f1): 0.2327586206896552
column_sums: [423  79]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 6 epochs
Epoch 33/80
299/299 - 583s - loss: 0.1318 - accuracy: 0.9513 - val_loss: 1.5788 - val_accuracy: 0.6574
Confusion matrix: 
 [[311  38]
 [134  19]]
Validation f1: 18.10
Validation accuracy: 65.74
Validation recall: 12.42
Validation precision: 33.33
Validation AUC: 0.31643265759526906
Validation class accuracies: [0.8911174785100286, 0.12418300653594772]
TARGET: 1
target metric(test f1): 0.18095238095238098
column_sums: [445  57]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 7 epochs
Epoch 34/80
299/299 - 585s - loss: 0.1169 - accuracy: 0.9567 - val_loss: 1.5985 - val_accuracy: 0.6534
Confusion matrix: 
 [[302  47]
 [127  26]]
Validation f1: 23.01
Validation accuracy: 65.34
Validation recall: 16.99
Validation precision: 35.62
Validation AUC: 0.3202697781502274
Validation class accuracies: [0.8653295128939829, 0.16993464052287582]
TARGET: 1
target metric(test f1): 0.23008849557522126
column_sums: [429  73]
cm_sum: 502
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 8 epochs
Epoch 35/80
299/299 - 582s - loss: 0.1040 - accuracy: 0.9611 - val_loss: 1.6486 - val_accuracy: 0.6275
Confusion matrix: 
 [[285  64]
 [123  30]]
Validation f1: 24.29
Validation accuracy: 62.75
Validation recall: 19.61
Validation precision: 31.91
Validation AUC: 0.31085432929029766
Validation class accuracies: [0.8166189111747851, 0.19607843137254902]
TARGET: 1
target metric(test f1): 0.24291497975708504
column_sums: [408  94]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 9 epochs
Epoch 36/80
299/299 - 582s - loss: 0.0920 - accuracy: 0.9693 - val_loss: 1.6705 - val_accuracy: 0.6195
Confusion matrix: 
 [[282  67]
 [124  29]]
Validation f1: 23.29
Validation accuracy: 61.95
Validation recall: 18.95
Validation precision: 30.21
Validation AUC: 0.30369065475490953
Validation class accuracies: [0.8080229226361032, 0.1895424836601307]
TARGET: 1
target metric(test f1): 0.2329317269076305
column_sums: [406  96]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 10 epochs
Epoch 37/80
299/299 - 582s - loss: 0.0990 - accuracy: 0.9645 - val_loss: 1.6574 - val_accuracy: 0.6315
Confusion matrix: 
 [[292  57]
 [128  25]]
Validation f1: 21.28
Validation accuracy: 63.15
Validation recall: 16.34
Validation precision: 30.49
Validation AUC: 0.3094436993584578
Validation class accuracies: [0.836676217765043, 0.16339869281045752]
TARGET: 1
target metric(test f1): 0.21276595744680848
column_sums: [420  82]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 11 epochs
Epoch 38/80
299/299 - 582s - loss: 0.0993 - accuracy: 0.9628 - val_loss: 1.5564 - val_accuracy: 0.6215
Confusion matrix: 
 [[285  64]
 [126  27]]
Validation f1: 22.13
Validation accuracy: 62.15
Validation recall: 17.65
Validation precision: 29.67
Validation AUC: 0.31131363319855665
Validation class accuracies: [0.8166189111747851, 0.17647058823529413]
TARGET: 1
target metric(test f1): 0.2213114754098361
column_sums: [411  91]
cm_sum: 502
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 12 epochs
Epoch 39/80
299/299 - 582s - loss: 0.0870 - accuracy: 0.9707 - val_loss: 1.5784 - val_accuracy: 0.6135
Confusion matrix: 
 [[279  70]
 [124  29]]
Validation f1: 23.02
Validation accuracy: 61.35
Validation recall: 18.95
Validation precision: 29.29
Validation AUC: 0.3086682142360404
Validation class accuracies: [0.7994269340974212, 0.1895424836601307]
TARGET: 1
target metric(test f1): 0.23015873015873015
column_sums: [403  99]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 13 epochs
Epoch 40/80
299/299 - 583s - loss: 0.0860 - accuracy: 0.9711 - val_loss: 1.6282 - val_accuracy: 0.6056
Confusion matrix: 
 [[275  74]
 [124  29]]
Validation f1: 22.66
Validation accuracy: 60.56
Validation recall: 18.95
Validation precision: 28.16
Validation AUC: 0.30675177393888753
Validation class accuracies: [0.7879656160458453, 0.1895424836601307]
TARGET: 1
target metric(test f1): 0.2265625
column_sums: [399 103]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 14 epochs
Epoch 41/80
299/299 - 582s - loss: 0.0950 - accuracy: 0.9659 - val_loss: 1.6359 - val_accuracy: 0.6036
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[273  76]
 [123  30]]
Validation f1: 23.17
Validation accuracy: 60.36
Validation recall: 19.61
Validation precision: 28.30
Validation AUC: 0.30351174205356135
Validation class accuracies: [0.7822349570200573, 0.19607843137254902]
TARGET: 1
target metric(test f1): 0.23166023166023164
column_sums: [396 106]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 15 epochs
Epoch 42/80
299/299 - 584s - loss: 0.0908 - accuracy: 0.9707 - val_loss: 1.6440 - val_accuracy: 0.6135
Confusion matrix: 
 [[280  69]
 [125  28]]
Validation f1: 22.40
Validation accuracy: 61.35
Validation recall: 18.30
Validation precision: 28.87
Validation AUC: 0.3035086913536321
Validation class accuracies: [0.8022922636103151, 0.1830065359477124]
TARGET: 1
target metric(test f1): 0.22399999999999998
column_sums: [405  97]
cm_sum: 502
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 16 epochs
Epoch 43/80
299/299 - 583s - loss: 0.0873 - accuracy: 0.9701 - val_loss: 1.6647 - val_accuracy: 0.6096
Confusion matrix: 
 [[277  72]
 [124  29]]
Validation f1: 22.83
Validation accuracy: 60.96
Validation recall: 18.95
Validation precision: 28.71
Validation AUC: 0.30167777481614344
Validation class accuracies: [0.7936962750716332, 0.1895424836601307]
TARGET: 1
target metric(test f1): 0.2283464566929134
column_sums: [401 101]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 17 epochs
Epoch 44/80
299/299 - 583s - loss: 0.0919 - accuracy: 0.9676 - val_loss: 1.6355 - val_accuracy: 0.6255
Confusion matrix: 
 [[287  62]
 [126  27]]
Validation f1: 22.31
Validation accuracy: 62.55
Validation recall: 17.65
Validation precision: 30.34
Validation AUC: 0.30694591394323667
Validation class accuracies: [0.8223495702005731, 0.17647058823529413]
TARGET: 1
target metric(test f1): 0.2231404958677686
column_sums: [413  89]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 18 epochs
Epoch 45/80
299/299 - 582s - loss: 0.0842 - accuracy: 0.9701 - val_loss: 1.6559 - val_accuracy: 0.6056
Confusion matrix: 
 [[275  74]
 [124  29]]
Validation f1: 22.66
Validation accuracy: 60.56
Validation recall: 18.95
Validation precision: 28.16
Validation AUC: 0.30222330214715165
Validation class accuracies: [0.7879656160458453, 0.1895424836601307]
TARGET: 1
target metric(test f1): 0.2265625
column_sums: [399 103]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 19 epochs
Epoch 46/80
299/299 - 586s - loss: 0.0905 - accuracy: 0.9686 - val_loss: 1.6692 - val_accuracy: 0.6036
Confusion matrix: 
 [[274  75]
 [124  29]]
Validation f1: 22.57
Validation accuracy: 60.36
Validation recall: 18.95
Validation precision: 27.88
Validation AUC: 0.3015715559690009
Validation class accuracies: [0.7851002865329513, 0.1895424836601307]
TARGET: 1
target metric(test f1): 0.22568093385214008
column_sums: [398 104]
cm_sum: 502
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 20 epochs
Epoch 47/80
299/299 - 584s - loss: 0.0995 - accuracy: 0.9630 - val_loss: 1.6774 - val_accuracy: 0.6215
Confusion matrix: 
 [[284  65]
 [125  28]]
Validation f1: 22.76
Validation accuracy: 62.15
Validation recall: 18.30
Validation precision: 30.11
Validation AUC: 0.30328477609802096
Validation class accuracies: [0.8137535816618912, 0.1830065359477124]
TARGET: 1
target metric(test f1): 0.22764227642276422
column_sums: [409  93]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 21 epochs
Epoch 48/80
299/299 - 584s - loss: 0.0933 - accuracy: 0.9674 - val_loss: 1.6587 - val_accuracy: 0.6195
Confusion matrix: 
 [[284  65]
 [126  27]]
Validation f1: 22.04
Validation accuracy: 61.95
Validation recall: 17.65
Validation precision: 29.35
Validation AUC: 0.30466532551358416
Validation class accuracies: [0.8137535816618912, 0.17647058823529413]
TARGET: 1
target metric(test f1): 0.22040816326530616
column_sums: [410  92]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 22 epochs
Epoch 49/80
299/299 - 583s - loss: 0.0858 - accuracy: 0.9701 - val_loss: 1.6679 - val_accuracy: 0.6215
Confusion matrix: 
 [[285  64]
 [126  27]]
Validation f1: 22.13
Validation accuracy: 62.15
Validation recall: 17.65
Validation precision: 29.67
Validation AUC: 0.3038353753337195
Validation class accuracies: [0.8166189111747851, 0.17647058823529413]
TARGET: 1
target metric(test f1): 0.2213114754098361
column_sums: [411  91]
cm_sum: 502
inside not defaulting
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 23 epochs
Epoch 50/80
299/299 - 584s - loss: 0.0850 - accuracy: 0.9693 - val_loss: 1.6620 - val_accuracy: 0.6096
Confusion matrix: 
 [[278  71]
 [125  28]]
Validation f1: 22.22
Validation accuracy: 60.96
Validation recall: 18.30
Validation precision: 28.28
Validation AUC: 0.3026165704875464
Validation class accuracies: [0.7965616045845272, 0.1830065359477124]
TARGET: 1
target metric(test f1): 0.2222222222222222
column_sums: [403  99]
cm_sum: 502
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.3217665615141956 hasn't increased by 0 in 24 epochs
Epoch 51/80
299/299 - 584s - loss: 0.0927 - accuracy: 0.9680 - val_loss: 1.6693 - val_accuracy: 0.6155
Confusion matrix: 
 [[281  68]
 [125  28]]
Validation f1: 22.49
Validation accuracy: 61.55
Validation recall: 18.30
Validation precision: 29.17
Validation AUC: 0.3026140281283487
Validation class accuracies: [0.8051575931232091, 0.1830065359477124]

The metrics for the epoch with the best target metric are: 
Best cm: [[236 113]
 [102  51]]
Best f1: 0.3217665615141956
Best accuracy: 0.5717131474103586
Best recall: 0.3333333333333333
Best precision: 0.31097560975609756
Best AUC: 0.2881417579852026
Best epoch: 24
TARGET: 1
target metric(test f1): 0.22489959839357432
column_sums: [406  96]
cm_sum: 502
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 14
Starting...
CM: [[14 13]
 [ 3  8]]
F1: 0.5
AUC: 0.5935862383230804
Accuracy: 0.5789473684210527
Precision: 0.38095238095238093
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_14.xls...
Done.
Epoch: 14
Starting...
CM: [[20  7]
 [10  1]]
F1: 0.10526315789473685
AUC: 0.23953349282296652
Accuracy: 0.5526315789473685
Precision: 0.125
Recall: 0.09090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_14.xls...
Done.
Epoch: 14
Starting...
CM: [[26  1]
 [11  0]]
F1: 0.0
AUC: 0.14473684210526316
Accuracy: 0.6842105263157895
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_14.xls...
Done.
Epoch: 24
Starting...
CM: [[ 5 22]
 [ 1 10]]
F1: 0.4651162790697674
AUC: 0.6239533492822966
Accuracy: 0.39473684210526316
Precision: 0.3125
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_24.xls...
Done.
Epoch: 24
Starting...
CM: [[ 9 18]
 [ 4  7]]
F1: 0.3888888888888889
AUC: 0.5108133971291866
Accuracy: 0.42105263157894735
Precision: 0.28
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_24.xls...
Done.
Epoch: 24
Starting...
CM: [[21  6]
 [ 8  3]]
F1: 0.3
AUC: 0.4082934609250398
Accuracy: 0.631578947368421
Precision: 0.3333333333333333
Recall: 0.2727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_24.xls...
Done.
Epoch: 5
Starting...
CM: [[15 12]
 [ 6  5]]
F1: 0.35714285714285715
AUC: 0.4532789192231917
Accuracy: 0.5263157894736842
Precision: 0.29411764705882354
Recall: 0.45454545454545453
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_5.xls...
Done.
Epoch: 5
Starting...
CM: [[19  8]
 [10  1]]
F1: 0.09999999999999999
AUC: 0.23258904837852207
Accuracy: 0.5263157894736842
Precision: 0.1111111111111111
Recall: 0.09090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_5.xls...
Done.
Epoch: 5
Starting...
CM: [[25  2]
 [11  0]]
F1: 0.0
AUC: 0.14473684210526316
Accuracy: 0.6578947368421053
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_5.xls...
Done.
Epoch: 80
Starting...
CM: [[10 17]
 [ 3  8]]
F1: 0.4444444444444444
AUC: 0.56311004784689
Accuracy: 0.47368421052631576
Precision: 0.32
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_80.xls...
Done.
Epoch: 80
Starting...
CM: [[18  9]
 [ 8  3]]
F1: 0.2608695652173913
AUC: 0.3666267942583732
Accuracy: 0.5526315789473685
Precision: 0.25
Recall: 0.2727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_80.xls...
Done.
Epoch: 80
Starting...
CM: [[26  1]
 [11  0]]
F1: 0.0
AUC: 0.14473684210526316
Accuracy: 0.6842105263157895
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_1_80.xls...
Done.
K-Fold split N: 2
With concat = False and six = False, size of training set: 4666...
...and size of validation set: 618
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_24 (InputLayer)           [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_138 (BatchN (None, 128, 1250, 1) 4           input_24[0][0]                   
__________________________________________________________________________________________________
conv2d_115 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_138[0][0]    
__________________________________________________________________________________________________
conv2d_117 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_138[0][0]    
__________________________________________________________________________________________________
max_pooling2d_23 (MaxPooling2D) (None, 128, 1250, 1) 0           batch_normalization_138[0][0]    
__________________________________________________________________________________________________
conv2d_116 (Conv2D)             (None, 128, 1250, 16 2320        conv2d_115[0][0]                 
__________________________________________________________________________________________________
conv2d_118 (Conv2D)             (None, 128, 1250, 16 6416        conv2d_117[0][0]                 
__________________________________________________________________________________________________
conv2d_119 (Conv2D)             (None, 128, 1250, 16 32          max_pooling2d_23[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 128, 1250, 48 0           conv2d_116[0][0]                 
                                                                 conv2d_118[0][0]                 
                                                                 conv2d_119[0][0]                 
__________________________________________________________________________________________________
average_pooling2d_115 (AverageP (None, 64, 625, 48)  0           concatenate_23[0][0]             
__________________________________________________________________________________________________
batch_normalization_139 (BatchN (None, 64, 625, 48)  192         average_pooling2d_115[0][0]      
__________________________________________________________________________________________________
dropout_115 (Dropout)           (None, 64, 625, 48)  0           batch_normalization_139[0][0]    
__________________________________________________________________________________________________
inverted_residual_230 (Inverted (None, 64, 625, 32)  35840       dropout_115[0][0]                
__________________________________________________________________________________________________
inverted_residual_231 (Inverted (None, 64, 625, 32)  20864       inverted_residual_230[0][0]      
__________________________________________________________________________________________________
average_pooling2d_116 (AverageP (None, 32, 312, 32)  0           inverted_residual_231[0][0]      
__________________________________________________________________________________________________
batch_normalization_140 (BatchN (None, 32, 312, 32)  128         average_pooling2d_116[0][0]      
__________________________________________________________________________________________________
dropout_116 (Dropout)           (None, 32, 312, 32)  0           batch_normalization_140[0][0]    
__________________________________________________________________________________________________
inverted_residual_232 (Inverted (None, 32, 312, 64)  27136       dropout_116[0][0]                
__________________________________________________________________________________________________
inverted_residual_233 (Inverted (None, 32, 312, 64)  66304       inverted_residual_232[0][0]      
__________________________________________________________________________________________________
average_pooling2d_117 (AverageP (None, 16, 156, 64)  0           inverted_residual_233[0][0]      
__________________________________________________________________________________________________
batch_normalization_141 (BatchN (None, 16, 156, 64)  256         average_pooling2d_117[0][0]      
__________________________________________________________________________________________________
dropout_117 (Dropout)           (None, 16, 156, 64)  0           batch_normalization_141[0][0]    
__________________________________________________________________________________________________
inverted_residual_234 (Inverted (None, 16, 156, 128) 91136       dropout_117[0][0]                
__________________________________________________________________________________________________
inverted_residual_235 (Inverted (None, 16, 156, 128) 230912      inverted_residual_234[0][0]      
__________________________________________________________________________________________________
average_pooling2d_118 (AverageP (None, 8, 78, 128)   0           inverted_residual_235[0][0]      
__________________________________________________________________________________________________
batch_normalization_142 (BatchN (None, 8, 78, 128)   512         average_pooling2d_118[0][0]      
__________________________________________________________________________________________________
dropout_118 (Dropout)           (None, 8, 78, 128)   0           batch_normalization_142[0][0]    
__________________________________________________________________________________________________
inverted_residual_236 (Inverted (None, 8, 78, 256)   329728      dropout_118[0][0]                
__________________________________________________________________________________________________
inverted_residual_237 (Inverted (None, 8, 78, 256)   855040      inverted_residual_236[0][0]      
__________________________________________________________________________________________________
average_pooling2d_119 (AverageP (None, 4, 39, 256)   0           inverted_residual_237[0][0]      
__________________________________________________________________________________________________
batch_normalization_143 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_119[0][0]      
__________________________________________________________________________________________________
dropout_119 (Dropout)           (None, 4, 39, 256)   0           batch_normalization_143[0][0]    
__________________________________________________________________________________________________
inverted_residual_238 (Inverted (None, 4, 39, 512)   1249280     dropout_119[0][0]                
__________________________________________________________________________________________________
inverted_residual_239 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_238[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_23 (Gl (None, 512)          0           inverted_residual_239[0][0]      
__________________________________________________________________________________________________
dense_23 (Dense)                (None, 1)            513         global_average_pooling2d_23[0][0]
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
292/292 - 573s - loss: 0.6671 - accuracy: 0.7188 - val_loss: 0.6114 - val_accuracy: 0.7638
Confusion matrix: 
 [[472   0]
 [146   0]]
Validation f1: 0.00
Validation accuracy: 76.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.30759001900308336
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [618   0]
cm_sum: 618
The training is defaulting to either class.
Epoch 2/80
292/292 - 572s - loss: 0.5772 - accuracy: 0.7327 - val_loss: 0.6560 - val_accuracy: 0.7638
Confusion matrix: 
 [[472   0]
 [146   0]]
Validation f1: 0.00
Validation accuracy: 76.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17461878808551645
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [618   0]
cm_sum: 618
The training is defaulting to either class.
Epoch 3/80
292/292 - 571s - loss: 0.5764 - accuracy: 0.7330 - val_loss: 0.7760 - val_accuracy: 0.7621
Confusion matrix: 
 [[463   9]
 [138   8]]
Validation f1: 9.82
Validation accuracy: 76.21
Validation recall: 5.48
Validation precision: 47.06
Validation AUC: 0.2970552622570092
Validation class accuracies: [0.9809322033898306, 0.0547945205479452]
TARGET: 1
target metric(test f1): 0.09815950920245399
column_sums: [601  17]
cm_sum: 618
The training is defaulting to either class.
Epoch 4/80
292/292 - 571s - loss: 0.5738 - accuracy: 0.7377 - val_loss: 0.6028 - val_accuracy: 0.7184
Confusion matrix: 
 [[427  45]
 [129  17]]
Validation f1: 16.35
Validation accuracy: 71.84
Validation recall: 11.64
Validation precision: 27.42
Validation AUC: 0.2774308039189219
Validation class accuracies: [0.9046610169491526, 0.11643835616438356]
TARGET: 1
target metric(test f1): 0.16346153846153844
column_sums: [556  62]
cm_sum: 618
inside not defaulting
Saving model...
Epoch 5/80
292/292 - 573s - loss: 0.5737 - accuracy: 0.7338 - val_loss: 0.5775 - val_accuracy: 0.7249
Confusion matrix: 
 [[443  29]
 [141   5]]
Validation f1: 5.56
Validation accuracy: 72.49
Validation recall: 3.42
Validation precision: 14.71
Validation AUC: 0.2631931169688118
Validation class accuracies: [0.9385593220338984, 0.03424657534246575]
TARGET: 1
target metric(test f1): 0.05555555555555556
column_sums: [584  34]
cm_sum: 618
The training is defaulting to either class.
Epoch 6/80
292/292 - 572s - loss: 0.5679 - accuracy: 0.7353 - val_loss: 0.5921 - val_accuracy: 0.6990
Confusion matrix: 
 [[407  65]
 [121  25]]
Validation f1: 21.19
Validation accuracy: 69.90
Validation recall: 17.12
Validation precision: 27.78
Validation AUC: 0.2698499538242731
Validation class accuracies: [0.8622881355932204, 0.17123287671232876]
TARGET: 1
target metric(test f1): 0.21186440677966098
column_sums: [528  90]
cm_sum: 618
inside not defaulting
Saving model...
Epoch 7/80
292/292 - 573s - loss: 0.5663 - accuracy: 0.7347 - val_loss: 0.5795 - val_accuracy: 0.7508
Confusion matrix: 
 [[444  28]
 [126  20]]
Validation f1: 20.62
Validation accuracy: 75.08
Validation recall: 13.70
Validation precision: 41.67
Validation AUC: 0.3242288319776712
Validation class accuracies: [0.940677966101695, 0.136986301369863]
TARGET: 1
target metric(test f1): 0.2061855670103093
column_sums: [570  48]
cm_sum: 618
The training is defaulting to either class.
Epoch 8/80
292/292 - 572s - loss: 0.5631 - accuracy: 0.7334 - val_loss: 0.5622 - val_accuracy: 0.7589
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[467   5]
 [144   2]]
Validation f1: 2.61
Validation accuracy: 75.89
Validation recall: 1.37
Validation precision: 28.57
Validation AUC: 0.2618865097945199
Validation class accuracies: [0.989406779661017, 0.0136986301369863]
TARGET: 1
target metric(test f1): 0.026143790849673203
column_sums: [611   7]
cm_sum: 618
The training is defaulting to either class.
Epoch 9/80
292/292 - 573s - loss: 0.5631 - accuracy: 0.7334 - val_loss: 0.5333 - val_accuracy: 0.7783
Confusion matrix: 
 [[469   3]
 [134  12]]
Validation f1: 14.91
Validation accuracy: 77.83
Validation recall: 8.22
Validation precision: 80.00
Validation AUC: 0.356247850343244
Validation class accuracies: [0.9936440677966102, 0.0821917808219178]
TARGET: 1
target metric(test f1): 0.14906832298136644
column_sums: [603  15]
cm_sum: 618
The training is defaulting to either class.
Epoch 10/80
292/292 - 574s - loss: 0.5603 - accuracy: 0.7349 - val_loss: 0.5471 - val_accuracy: 0.7735
Confusion matrix: 
 [[471   1]
 [139   7]]
Validation f1: 9.09
Validation accuracy: 77.35
Validation recall: 4.79
Validation precision: 87.50
Validation AUC: 0.32450699515260245
Validation class accuracies: [0.9978813559322034, 0.04794520547945205]
TARGET: 1
target metric(test f1): 0.09090909090909091
column_sums: [610   8]
cm_sum: 618
The training is defaulting to either class.
Epoch 11/80
292/292 - 574s - loss: 0.5574 - accuracy: 0.7353 - val_loss: 0.5702 - val_accuracy: 0.7492
Confusion matrix: 
 [[447  25]
 [130  16]]
Validation f1: 17.11
Validation accuracy: 74.92
Validation recall: 10.96
Validation precision: 39.02
Validation AUC: 0.33923307256281715
Validation class accuracies: [0.9470338983050848, 0.1095890410958904]
TARGET: 1
target metric(test f1): 0.1711229946524064
column_sums: [577  41]
cm_sum: 618
The training is defaulting to either class.
Epoch 12/80
292/292 - 574s - loss: 0.5535 - accuracy: 0.7357 - val_loss: 1.4104 - val_accuracy: 0.4369
Confusion matrix: 
 [[142 330]
 [ 18 128]]
Validation f1: 42.38
Validation accuracy: 43.69
Validation recall: 87.67
Validation precision: 27.95
Validation AUC: 0.3550715629627098
Validation class accuracies: [0.3008474576271186, 0.8767123287671232]
TARGET: 1
target metric(test f1): 0.423841059602649
column_sums: [160 458]
cm_sum: 618
inside not defaulting
Saving model...
Epoch 13/80
292/292 - 574s - loss: 0.5507 - accuracy: 0.7407 - val_loss: 0.6212 - val_accuracy: 0.7071
Confusion matrix: 
 [[430  42]
 [139   7]]
Validation f1: 7.18
Validation accuracy: 70.71
Validation recall: 4.79
Validation precision: 14.29
Validation AUC: 0.24012680911283518
Validation class accuracies: [0.9110169491525424, 0.04794520547945205]
TARGET: 1
target metric(test f1): 0.07179487179487179
column_sums: [569  49]
cm_sum: 618
The training is defaulting to either class.
Epoch 14/80
292/292 - 578s - loss: 0.5506 - accuracy: 0.7398 - val_loss: 0.5560 - val_accuracy: 0.7524
Confusion matrix: 
 [[451  21]
 [132  14]]
Validation f1: 15.47
Validation accuracy: 75.24
Validation recall: 9.59
Validation precision: 40.00
Validation AUC: 0.3186742939146015
Validation class accuracies: [0.9555084745762712, 0.0958904109589041]
TARGET: 1
target metric(test f1): 0.15469613259668508
column_sums: [583  35]
cm_sum: 618
The training is defaulting to either class.
Epoch 15/80
292/292 - 575s - loss: 0.5418 - accuracy: 0.7452 - val_loss: 0.6000 - val_accuracy: 0.6942
Confusion matrix: 
 [[407  65]
 [124  22]]
Validation f1: 18.88
Validation accuracy: 69.42
Validation recall: 15.07
Validation precision: 25.29
Validation AUC: 0.27620926951037394
Validation class accuracies: [0.8622881355932204, 0.1506849315068493]
TARGET: 1
target metric(test f1): 0.18884120171673818
column_sums: [531  87]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 1 epochs
Epoch 16/80
292/292 - 574s - loss: 0.5394 - accuracy: 0.7465 - val_loss: 0.8662 - val_accuracy: 0.5777
Confusion matrix: 
 [[293 179]
 [ 82  64]]
Validation f1: 32.90
Validation accuracy: 57.77
Validation recall: 43.84
Validation precision: 26.34
Validation AUC: 0.28927137446632334
Validation class accuracies: [0.6207627118644068, 0.4383561643835616]
TARGET: 1
target metric(test f1): 0.32904884318766064
column_sums: [375 243]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 2 epochs
Epoch 17/80
292/292 - 575s - loss: 0.5340 - accuracy: 0.7492 - val_loss: 0.5648 - val_accuracy: 0.7638
Confusion matrix: 
 [[472   0]
 [146   0]]
Validation f1: 0.00
Validation accuracy: 76.38
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2967949618379662
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [618   0]
cm_sum: 618
The training is defaulting to either class.
Epoch 18/80
292/292 - 574s - loss: 0.5277 - accuracy: 0.7538 - val_loss: 0.5769 - val_accuracy: 0.7460
Confusion matrix: 
 [[453  19]
 [138   8]]
Validation f1: 9.25
Validation accuracy: 74.60
Validation recall: 5.48
Validation precision: 29.63
Validation AUC: 0.2544700933688576
Validation class accuracies: [0.9597457627118644, 0.0547945205479452]
TARGET: 1
target metric(test f1): 0.09248554913294797
column_sums: [591  27]
cm_sum: 618
The training is defaulting to either class.
Epoch 19/80
292/292 - 574s - loss: 0.5238 - accuracy: 0.7565 - val_loss: 0.7697 - val_accuracy: 0.6262
Confusion matrix: 
 [[333 139]
 [ 92  54]]
Validation f1: 31.86
Validation accuracy: 62.62
Validation recall: 36.99
Validation precision: 27.98
Validation AUC: 0.2986987352290679
Validation class accuracies: [0.7055084745762712, 0.3698630136986301]
TARGET: 1
target metric(test f1): 0.3185840707964601
column_sums: [425 193]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 3 epochs
Epoch 20/80
292/292 - 574s - loss: 0.5145 - accuracy: 0.7570 - val_loss: 0.6977 - val_accuracy: 0.6456
Confusion matrix: 
 [[341 131]
 [ 88  58]]
Validation f1: 34.63
Validation accuracy: 64.56
Validation recall: 39.73
Validation precision: 30.69
Validation AUC: 0.2951065604683776
Validation class accuracies: [0.722457627118644, 0.3972602739726027]
TARGET: 1
target metric(test f1): 0.34626865671641793
column_sums: [429 189]
cm_sum: 618
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 4 epochs
Epoch 21/80
292/292 - 573s - loss: 0.4866 - accuracy: 0.7722 - val_loss: 0.5994 - val_accuracy: 0.7411
Confusion matrix: 
 [[445  27]
 [133  13]]
Validation f1: 13.98
Validation accuracy: 74.11
Validation recall: 8.90
Validation precision: 32.50
Validation AUC: 0.2640262066753374
Validation class accuracies: [0.9427966101694916, 0.08904109589041095]
TARGET: 1
target metric(test f1): 0.13978494623655915
column_sums: [578  40]
cm_sum: 618
The training is defaulting to either class.
Epoch 22/80
292/292 - 574s - loss: 0.4734 - accuracy: 0.7805 - val_loss: 0.6190 - val_accuracy: 0.7460
Confusion matrix: 
 [[455  17]
 [140   6]]
Validation f1: 7.10
Validation accuracy: 74.60
Validation recall: 4.11
Validation precision: 26.09
Validation AUC: 0.24749828485078068
Validation class accuracies: [0.9639830508474576, 0.0410958904109589]
TARGET: 1
target metric(test f1): 0.07100591715976332
column_sums: [595  23]
cm_sum: 618
The training is defaulting to either class.
Epoch 23/80
292/292 - 574s - loss: 0.4549 - accuracy: 0.7930 - val_loss: 0.6426 - val_accuracy: 0.7136
Confusion matrix: 
 [[427  45]
 [132  14]]
Validation f1: 13.66
Validation accuracy: 71.36
Validation recall: 9.59
Validation precision: 23.73
Validation AUC: 0.24778954692162208
Validation class accuracies: [0.9046610169491526, 0.0958904109589041]
TARGET: 1
target metric(test f1): 0.13658536585365855
column_sums: [559  59]
cm_sum: 618
The training is defaulting to either class.
Epoch 24/80
292/292 - 578s - loss: 0.4413 - accuracy: 0.7998 - val_loss: 0.7422 - val_accuracy: 0.5728
Confusion matrix: 
 [[306 166]
 [ 98  48]]
Validation f1: 26.67
Validation accuracy: 57.28
Validation recall: 32.88
Validation precision: 22.43
Validation AUC: 0.2626715294025197
Validation class accuracies: [0.6483050847457628, 0.3287671232876712]
TARGET: 1
target metric(test f1): 0.26666666666666666
column_sums: [404 214]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 5 epochs
Epoch 25/80
292/292 - 575s - loss: 0.4282 - accuracy: 0.8026 - val_loss: 0.6580 - val_accuracy: 0.7006
Confusion matrix: 
 [[407  65]
 [120  26]]
Validation f1: 21.94
Validation accuracy: 70.06
Validation recall: 17.81
Validation precision: 28.57
Validation AUC: 0.2649156621083468
Validation class accuracies: [0.8622881355932204, 0.1780821917808219]
TARGET: 1
target metric(test f1): 0.21940928270042195
column_sums: [527  91]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 6 epochs
Epoch 26/80
292/292 - 576s - loss: 0.4188 - accuracy: 0.8080 - val_loss: 0.6474 - val_accuracy: 0.7055
Confusion matrix: 
 [[416  56]
 [126  20]]
Validation f1: 18.02
Validation accuracy: 70.55
Validation recall: 13.70
Validation precision: 26.32
Validation AUC: 0.27050355912779117
Validation class accuracies: [0.8813559322033898, 0.136986301369863]
TARGET: 1
target metric(test f1): 0.18018018018018017
column_sums: [542  76]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 7 epochs
Epoch 27/80
292/292 - 575s - loss: 0.4180 - accuracy: 0.8118 - val_loss: 0.6700 - val_accuracy: 0.6634
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[374  98]
 [110  36]]
Validation f1: 25.71
Validation accuracy: 66.34
Validation recall: 24.66
Validation precision: 26.87
Validation AUC: 0.2689336397041393
Validation class accuracies: [0.7923728813559322, 0.2465753424657534]
TARGET: 1
target metric(test f1): 0.2571428571428571
column_sums: [484 134]
cm_sum: 618
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 8 epochs
Epoch 28/80
292/292 - 576s - loss: 0.3845 - accuracy: 0.8279 - val_loss: 0.7189 - val_accuracy: 0.6246
Confusion matrix: 
 [[352 120]
 [112  34]]
Validation f1: 22.67
Validation accuracy: 62.46
Validation recall: 23.29
Validation precision: 22.08
Validation AUC: 0.24684842065002804
Validation class accuracies: [0.7457627118644068, 0.2328767123287671]
TARGET: 1
target metric(test f1): 0.22666666666666663
column_sums: [464 154]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 9 epochs
Epoch 29/80
292/292 - 574s - loss: 0.3817 - accuracy: 0.8311 - val_loss: 0.7480 - val_accuracy: 0.6117
Confusion matrix: 
 [[342 130]
 [110  36]]
Validation f1: 23.08
Validation accuracy: 61.17
Validation recall: 24.66
Validation precision: 21.69
Validation AUC: 0.23908517913341004
Validation class accuracies: [0.7245762711864406, 0.2465753424657534]
TARGET: 1
target metric(test f1): 0.23076923076923075
column_sums: [452 166]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 10 epochs
Epoch 30/80
292/292 - 574s - loss: 0.3715 - accuracy: 0.8365 - val_loss: 0.7330 - val_accuracy: 0.6602
Confusion matrix: 
 [[378  94]
 [116  30]]
Validation f1: 22.22
Validation accuracy: 66.02
Validation recall: 20.55
Validation precision: 24.19
Validation AUC: 0.2529836349622313
Validation class accuracies: [0.8008474576271186, 0.2054794520547945]
TARGET: 1
target metric(test f1): 0.2222222222222222
column_sums: [494 124]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 11 epochs
Epoch 31/80
292/292 - 573s - loss: 0.3745 - accuracy: 0.8328 - val_loss: 0.8077 - val_accuracy: 0.5761
Confusion matrix: 
 [[314 158]
 [104  42]]
Validation f1: 24.28
Validation accuracy: 57.61
Validation recall: 28.77
Validation precision: 21.00
Validation AUC: 0.23288665485181698
Validation class accuracies: [0.6652542372881356, 0.2876712328767123]
TARGET: 1
target metric(test f1): 0.24277456647398843
column_sums: [418 200]
cm_sum: 618
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 12 epochs
Epoch 32/80
292/292 - 573s - loss: 0.3640 - accuracy: 0.8380 - val_loss: 0.7401 - val_accuracy: 0.6408
Confusion matrix: 
 [[368 104]
 [118  28]]
Validation f1: 20.14
Validation accuracy: 64.08
Validation recall: 19.18
Validation precision: 21.21
Validation AUC: 0.23857879275616106
Validation class accuracies: [0.7796610169491526, 0.1917808219178082]
TARGET: 1
target metric(test f1): 0.20143884892086328
column_sums: [486 132]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 13 epochs
Epoch 33/80
292/292 - 577s - loss: 0.3658 - accuracy: 0.8427 - val_loss: 0.7396 - val_accuracy: 0.6408
Confusion matrix: 
 [[367 105]
 [117  29]]
Validation f1: 20.71
Validation accuracy: 64.08
Validation recall: 19.86
Validation precision: 21.64
Validation AUC: 0.23740730760307754
Validation class accuracies: [0.777542372881356, 0.19863013698630136]
TARGET: 1
target metric(test f1): 0.20714285714285716
column_sums: [484 134]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 14 epochs
Epoch 34/80
292/292 - 574s - loss: 0.3635 - accuracy: 0.8367 - val_loss: 0.7604 - val_accuracy: 0.6230
Confusion matrix: 
 [[353 119]
 [114  32]]
Validation f1: 21.55
Validation accuracy: 62.30
Validation recall: 21.92
Validation precision: 21.19
Validation AUC: 0.2377913867121127
Validation class accuracies: [0.7478813559322034, 0.2191780821917808]
TARGET: 1
target metric(test f1): 0.2154882154882155
column_sums: [467 151]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 15 epochs
Epoch 35/80
292/292 - 574s - loss: 0.3585 - accuracy: 0.8476 - val_loss: 0.8289 - val_accuracy: 0.5647
Confusion matrix: 
 [[298 174]
 [ 95  51]]
Validation f1: 27.49
Validation accuracy: 56.47
Validation recall: 34.93
Validation precision: 22.67
Validation AUC: 0.24136996440582456
Validation class accuracies: [0.6313559322033898, 0.3493150684931507]
TARGET: 1
target metric(test f1): 0.2749326145552561
column_sums: [393 225]
cm_sum: 618
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 16 epochs
Epoch 36/80
292/292 - 573s - loss: 0.3652 - accuracy: 0.8380 - val_loss: 0.7575 - val_accuracy: 0.6311
Confusion matrix: 
 [[358 114]
 [114  32]]
Validation f1: 21.92
Validation accuracy: 63.11
Validation recall: 21.92
Validation precision: 21.92
Validation AUC: 0.23768491132093714
Validation class accuracies: [0.7584745762711864, 0.2191780821917808]
TARGET: 1
target metric(test f1): 0.2191780821917808
column_sums: [472 146]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 17 epochs
Epoch 37/80
292/292 - 574s - loss: 0.3626 - accuracy: 0.8412 - val_loss: 0.7558 - val_accuracy: 0.6262
Confusion matrix: 
 [[357 115]
 [116  30]]
Validation f1: 20.62
Validation accuracy: 62.62
Validation recall: 20.55
Validation precision: 20.69
Validation AUC: 0.23921386877497688
Validation class accuracies: [0.7563559322033898, 0.2054794520547945]
TARGET: 1
target metric(test f1): 0.20618556701030927
column_sums: [473 145]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 18 epochs
Epoch 38/80
292/292 - 573s - loss: 0.3581 - accuracy: 0.8435 - val_loss: 0.7422 - val_accuracy: 0.6472
Confusion matrix: 
 [[371 101]
 [117  29]]
Validation f1: 21.01
Validation accuracy: 64.72
Validation recall: 19.86
Validation precision: 22.31
Validation AUC: 0.2402585184249912
Validation class accuracies: [0.7860169491525424, 0.19863013698630136]
TARGET: 1
target metric(test f1): 0.21014492753623187
column_sums: [488 130]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 19 epochs
Epoch 39/80
292/292 - 572s - loss: 0.3581 - accuracy: 0.8455 - val_loss: 0.7956 - val_accuracy: 0.5906
Confusion matrix: 
 [[325 147]
 [106  40]]
Validation f1: 24.02
Validation accuracy: 59.06
Validation recall: 27.40
Validation precision: 21.39
Validation AUC: 0.2386282320009008
Validation class accuracies: [0.6885593220338984, 0.273972602739726]
TARGET: 1
target metric(test f1): 0.24024024024024027
column_sums: [431 187]
cm_sum: 618
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 20 epochs
Epoch 40/80
292/292 - 574s - loss: 0.3636 - accuracy: 0.8416 - val_loss: 0.7300 - val_accuracy: 0.6731
Confusion matrix: 
 [[389  83]
 [119  27]]
Validation f1: 21.09
Validation accuracy: 67.31
Validation recall: 18.49
Validation precision: 24.55
Validation AUC: 0.24663089234705113
Validation class accuracies: [0.8241525423728814, 0.18493150684931506]
TARGET: 1
target metric(test f1): 0.2109375
column_sums: [508 110]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 21 epochs
Epoch 41/80
292/292 - 573s - loss: 0.3571 - accuracy: 0.8444 - val_loss: 0.7585 - val_accuracy: 0.6311
Confusion matrix: 
 [[359 113]
 [115  31]]
Validation f1: 21.38
Validation accuracy: 63.11
Validation recall: 21.23
Validation precision: 21.53
Validation AUC: 0.2378309677721739
Validation class accuracies: [0.760593220338983, 0.21232876712328766]
TARGET: 1
target metric(test f1): 0.21379310344827587
column_sums: [474 144]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 22 epochs
Epoch 42/80
292/292 - 575s - loss: 0.3617 - accuracy: 0.8450 - val_loss: 0.7443 - val_accuracy: 0.6586
Confusion matrix: 
 [[378  94]
 [117  29]]
Validation f1: 21.56
Validation accuracy: 65.86
Validation recall: 19.86
Validation precision: 23.58
Validation AUC: 0.23982718427093008
Validation class accuracies: [0.8008474576271186, 0.19863013698630136]
TARGET: 1
target metric(test f1): 0.21561338289962828
column_sums: [495 123]
cm_sum: 618
inside not defaulting
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 23 epochs
Epoch 43/80
292/292 - 574s - loss: 0.3561 - accuracy: 0.8433 - val_loss: 0.7599 - val_accuracy: 0.6359
Confusion matrix: 
 [[362 110]
 [115  31]]
Validation f1: 21.60
Validation accuracy: 63.59
Validation recall: 21.23
Validation precision: 21.99
Validation AUC: 0.23746917256796868
Validation class accuracies: [0.7669491525423728, 0.21232876712328766]
TARGET: 1
target metric(test f1): 0.21602787456445993
column_sums: [477 141]
cm_sum: 618
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.423841059602649 hasn't increased by 0 in 24 epochs
Epoch 44/80
292/292 - 572s - loss: 0.3624 - accuracy: 0.8444 - val_loss: 0.7929 - val_accuracy: 0.5971
Confusion matrix: 
 [[331 141]
 [108  38]]
Validation f1: 23.38
Validation accuracy: 59.71
Validation recall: 26.03
Validation precision: 21.23
Validation AUC: 0.2376444901512228
Validation class accuracies: [0.701271186440678, 0.2602739726027397]

The metrics for the epoch with the best target metric are: 
Best cm: [[142 330]
 [ 18 128]]
Best f1: 0.423841059602649
Best accuracy: 0.4368932038834951
Best recall: 0.8767123287671232
Best precision: 0.2794759825327511
Best AUC: 0.3550715629627098
Best epoch: 12
TARGET: 1
target metric(test f1): 0.23384615384615384
column_sums: [439 179]
cm_sum: 618
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 12
Starting...
CM: [[ 1 26]
 [ 0 11]]
F1: 0.4583333333333333
AUC: 0.6486486486486487
Accuracy: 0.3157894736842105
Precision: 0.2972972972972973
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_12.xls...
Done.
Epoch: 12
Starting...
CM: [[ 2 25]
 [ 0 11]]
F1: 0.46808510638297873
AUC: 0.6527777777777778
Accuracy: 0.34210526315789475
Precision: 0.3055555555555556
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_12.xls...
Done.
Epoch: 12
Starting...
CM: [[ 5 22]
 [ 0 11]]
F1: 0.5
AUC: 0.6666666666666666
Accuracy: 0.42105263157894735
Precision: 0.3333333333333333
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_12.xls...
Done.
Epoch: 4
Starting...
CM: [[17 10]
 [ 6  5]]
F1: 0.3846153846153846
AUC: 0.47288676236044647
Accuracy: 0.5789473684210527
Precision: 0.3333333333333333
Recall: 0.45454545454545453
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_4.xls...
Done.
Epoch: 4
Starting...
CM: [[23  4]
 [ 7  4]]
F1: 0.4210526315789474
AUC: 0.5239234449760766
Accuracy: 0.7105263157894737
Precision: 0.5
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_4.xls...
Done.
Epoch: 4
Starting...
CM: [[27  0]
 [ 9  2]]
F1: 0.3076923076923077
AUC: 0.7093301435406698
Accuracy: 0.7631578947368421
Precision: 1.0
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_4.xls...
Done.
Epoch: 6
Starting...
CM: [[15 12]
 [ 5  6]]
F1: 0.41379310344827586
AUC: 0.5051834130781498
Accuracy: 0.5526315789473685
Precision: 0.3333333333333333
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_6.xls...
Done.
Epoch: 6
Starting...
CM: [[21  6]
 [ 7  4]]
F1: 0.380952380952381
AUC: 0.4739234449760765
Accuracy: 0.6578947368421053
Precision: 0.4
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_6.xls...
Done.
Epoch: 6
Starting...
CM: [[25  2]
 [ 8  3]]
F1: 0.37499999999999994
AUC: 0.5416267942583732
Accuracy: 0.7368421052631579
Precision: 0.6
Recall: 0.2727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_6.xls...
Done.
Epoch: 80
Starting...
CM: [[ 4 23]
 [ 2  9]]
F1: 0.41860465116279066
AUC: 0.5760316985645934
Accuracy: 0.34210526315789475
Precision: 0.28125
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_80.xls...
Done.
Epoch: 80
Starting...
CM: [[10 17]
 [ 5  6]]
F1: 0.3529411764705882
AUC: 0.46895152902017895
Accuracy: 0.42105263157894735
Precision: 0.2608695652173913
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_80.xls...
Done.
Epoch: 80
Starting...
CM: [[20  7]
 [ 7  4]]
F1: 0.36363636363636365
AUC: 0.45574162679425845
Accuracy: 0.631578947368421
Precision: 0.36363636363636365
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_2_80.xls...
Done.
K-Fold split N: 3
With concat = False and six = False, size of training set: 4789...
...and size of validation set: 495
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_37 (InputLayer)           [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_216 (BatchN (None, 128, 1250, 1) 4           input_37[0][0]                   
__________________________________________________________________________________________________
conv2d_180 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_216[0][0]    
__________________________________________________________________________________________________
conv2d_182 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_216[0][0]    
__________________________________________________________________________________________________
max_pooling2d_36 (MaxPooling2D) (None, 128, 1250, 1) 0           batch_normalization_216[0][0]    
__________________________________________________________________________________________________
conv2d_181 (Conv2D)             (None, 128, 1250, 16 2320        conv2d_180[0][0]                 
__________________________________________________________________________________________________
conv2d_183 (Conv2D)             (None, 128, 1250, 16 6416        conv2d_182[0][0]                 
__________________________________________________________________________________________________
conv2d_184 (Conv2D)             (None, 128, 1250, 16 32          max_pooling2d_36[0][0]           
__________________________________________________________________________________________________
concatenate_36 (Concatenate)    (None, 128, 1250, 48 0           conv2d_181[0][0]                 
                                                                 conv2d_183[0][0]                 
                                                                 conv2d_184[0][0]                 
__________________________________________________________________________________________________
average_pooling2d_180 (AverageP (None, 64, 625, 48)  0           concatenate_36[0][0]             
__________________________________________________________________________________________________
batch_normalization_217 (BatchN (None, 64, 625, 48)  192         average_pooling2d_180[0][0]      
__________________________________________________________________________________________________
dropout_180 (Dropout)           (None, 64, 625, 48)  0           batch_normalization_217[0][0]    
__________________________________________________________________________________________________
inverted_residual_360 (Inverted (None, 64, 625, 32)  35840       dropout_180[0][0]                
__________________________________________________________________________________________________
inverted_residual_361 (Inverted (None, 64, 625, 32)  20864       inverted_residual_360[0][0]      
__________________________________________________________________________________________________
average_pooling2d_181 (AverageP (None, 32, 312, 32)  0           inverted_residual_361[0][0]      
__________________________________________________________________________________________________
batch_normalization_218 (BatchN (None, 32, 312, 32)  128         average_pooling2d_181[0][0]      
__________________________________________________________________________________________________
dropout_181 (Dropout)           (None, 32, 312, 32)  0           batch_normalization_218[0][0]    
__________________________________________________________________________________________________
inverted_residual_362 (Inverted (None, 32, 312, 64)  27136       dropout_181[0][0]                
__________________________________________________________________________________________________
inverted_residual_363 (Inverted (None, 32, 312, 64)  66304       inverted_residual_362[0][0]      
__________________________________________________________________________________________________
average_pooling2d_182 (AverageP (None, 16, 156, 64)  0           inverted_residual_363[0][0]      
__________________________________________________________________________________________________
batch_normalization_219 (BatchN (None, 16, 156, 64)  256         average_pooling2d_182[0][0]      
__________________________________________________________________________________________________
dropout_182 (Dropout)           (None, 16, 156, 64)  0           batch_normalization_219[0][0]    
__________________________________________________________________________________________________
inverted_residual_364 (Inverted (None, 16, 156, 128) 91136       dropout_182[0][0]                
__________________________________________________________________________________________________
inverted_residual_365 (Inverted (None, 16, 156, 128) 230912      inverted_residual_364[0][0]      
__________________________________________________________________________________________________
average_pooling2d_183 (AverageP (None, 8, 78, 128)   0           inverted_residual_365[0][0]      
__________________________________________________________________________________________________
batch_normalization_220 (BatchN (None, 8, 78, 128)   512         average_pooling2d_183[0][0]      
__________________________________________________________________________________________________
dropout_183 (Dropout)           (None, 8, 78, 128)   0           batch_normalization_220[0][0]    
__________________________________________________________________________________________________
inverted_residual_366 (Inverted (None, 8, 78, 256)   329728      dropout_183[0][0]                
__________________________________________________________________________________________________
inverted_residual_367 (Inverted (None, 8, 78, 256)   855040      inverted_residual_366[0][0]      
__________________________________________________________________________________________________
average_pooling2d_184 (AverageP (None, 4, 39, 256)   0           inverted_residual_367[0][0]      
__________________________________________________________________________________________________
batch_normalization_221 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_184[0][0]      
__________________________________________________________________________________________________
dropout_184 (Dropout)           (None, 4, 39, 256)   0           batch_normalization_221[0][0]    
__________________________________________________________________________________________________
inverted_residual_368 (Inverted (None, 4, 39, 512)   1249280     dropout_184[0][0]                
__________________________________________________________________________________________________
inverted_residual_369 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_368[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_36 (Gl (None, 512)          0           inverted_residual_369[0][0]      
__________________________________________________________________________________________________
dense_36 (Dense)                (None, 1)            513         global_average_pooling2d_36[0][0]
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
300/300 - 593s - loss: 0.6592 - accuracy: 0.7202 - val_loss: 0.6048 - val_accuracy: 0.7515
Confusion matrix: 
 [[372   0]
 [123   0]]
Validation f1: 0.00
Validation accuracy: 75.15
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22054780725398898
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [495   0]
cm_sum: 495
The training is defaulting to either class.
Epoch 2/80
300/300 - 586s - loss: 0.5704 - accuracy: 0.7386 - val_loss: 0.5663 - val_accuracy: 0.7515
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[372   0]
 [123   0]]
Validation f1: 0.00
Validation accuracy: 75.15
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23662689116502778
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [495   0]
cm_sum: 495
The training is defaulting to either class.
Epoch 3/80
300/300 - 585s - loss: 0.5678 - accuracy: 0.7386 - val_loss: 0.5836 - val_accuracy: 0.7495
Confusion matrix: 
 [[371   1]
 [123   0]]
Validation f1: 0.00
Validation accuracy: 74.95
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23162751719525726
Validation class accuracies: [0.9973118279569892, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [494   1]
cm_sum: 495
The training is defaulting to either class.
Epoch 4/80
300/300 - 586s - loss: 0.5692 - accuracy: 0.7359 - val_loss: 0.5986 - val_accuracy: 0.7515
Confusion matrix: 
 [[372   0]
 [123   0]]
Validation f1: 0.00
Validation accuracy: 75.15
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24334815003580296
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [495   0]
cm_sum: 495
The training is defaulting to either class.
Epoch 5/80
300/300 - 584s - loss: 0.5758 - accuracy: 0.7365 - val_loss: 0.5855 - val_accuracy: 0.7475
Confusion matrix: 
 [[367   5]
 [120   3]]
Validation f1: 4.58
Validation accuracy: 74.75
Validation recall: 2.44
Validation precision: 37.50
Validation AUC: 0.23214827511412733
Validation class accuracies: [0.9865591397849462, 0.024390243902439025]
TARGET: 1
target metric(test f1): 0.04580152671755726
column_sums: [487   8]
cm_sum: 495
The training is defaulting to either class.
Epoch 6/80
300/300 - 585s - loss: 0.5680 - accuracy: 0.7384 - val_loss: 0.5999 - val_accuracy: 0.7515
Confusion matrix: 
 [[372   0]
 [123   0]]
Validation f1: 0.00
Validation accuracy: 75.15
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.222217442928977
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [495   0]
cm_sum: 495
The training is defaulting to either class.
Epoch 7/80
300/300 - 585s - loss: 0.5640 - accuracy: 0.7390 - val_loss: 0.6832 - val_accuracy: 0.6364
Confusion matrix: 
 [[279  93]
 [ 87  36]]
Validation f1: 28.57
Validation accuracy: 63.64
Validation recall: 29.27
Validation precision: 27.91
Validation AUC: 0.2462693429574878
Validation class accuracies: [0.75, 0.2926829268292683]
TARGET: 1
target metric(test f1): 0.2857142857142857
column_sums: [366 129]
cm_sum: 495
inside not defaulting
Saving model...
Epoch 8/80
300/300 - 585s - loss: 0.5685 - accuracy: 0.7392 - val_loss: 0.5758 - val_accuracy: 0.7495
Confusion matrix: 
 [[371   1]
 [123   0]]
Validation f1: 0.00
Validation accuracy: 74.95
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.236734777775549
Validation class accuracies: [0.9973118279569892, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [494   1]
cm_sum: 495
The training is defaulting to either class.
Epoch 9/80
300/300 - 585s - loss: 0.5603 - accuracy: 0.7379 - val_loss: 0.6559 - val_accuracy: 0.6101
Confusion matrix: 
 [[278  94]
 [ 99  24]]
Validation f1: 19.92
Validation accuracy: 61.01
Validation recall: 19.51
Validation precision: 20.34
Validation AUC: 0.2346347897101817
Validation class accuracies: [0.7473118279569892, 0.1951219512195122]
TARGET: 1
target metric(test f1): 0.19917012448132781
column_sums: [377 118]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2857142857142857 hasn't increased by 0 in 1 epochs
Epoch 10/80
300/300 - 585s - loss: 0.5568 - accuracy: 0.7394 - val_loss: 0.6932 - val_accuracy: 0.7152
Confusion matrix: 
 [[350  22]
 [119   4]]
Validation f1: 5.37
Validation accuracy: 71.52
Validation recall: 3.25
Validation precision: 15.38
Validation AUC: 0.20683488021795543
Validation class accuracies: [0.9408602150537635, 0.032520325203252036]
TARGET: 1
target metric(test f1): 0.05369127516778524
column_sums: [469  26]
cm_sum: 495
The training is defaulting to either class.
Epoch 11/80
300/300 - 586s - loss: 0.5535 - accuracy: 0.7415 - val_loss: 0.6021 - val_accuracy: 0.7293
Confusion matrix: 
 [[355  17]
 [117   6]]
Validation f1: 8.22
Validation accuracy: 72.93
Validation recall: 4.88
Validation precision: 26.09
Validation AUC: 0.2662393536018206
Validation class accuracies: [0.9543010752688172, 0.04878048780487805]
TARGET: 1
target metric(test f1): 0.08219178082191782
column_sums: [472  23]
cm_sum: 495
The training is defaulting to either class.
Epoch 12/80
300/300 - 588s - loss: 0.5511 - accuracy: 0.7388 - val_loss: 0.5890 - val_accuracy: 0.7455
Confusion matrix: 
 [[369   3]
 [123   0]]
Validation f1: 0.00
Validation accuracy: 74.55
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24281716476449075
Validation class accuracies: [0.9919354838709677, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [492   3]
cm_sum: 495
The training is defaulting to either class.
Epoch 13/80
300/300 - 586s - loss: 0.5510 - accuracy: 0.7394 - val_loss: 0.7075 - val_accuracy: 0.5515
Confusion matrix: 
 [[227 145]
 [ 77  46]]
Validation f1: 29.30
Validation accuracy: 55.15
Validation recall: 37.40
Validation precision: 24.08
Validation AUC: 0.23375696831010645
Validation class accuracies: [0.6102150537634409, 0.37398373983739835]
TARGET: 1
target metric(test f1): 0.2929936305732484
column_sums: [304 191]
cm_sum: 495
inside not defaulting
Saving model...
Epoch 14/80
300/300 - 581s - loss: 0.5419 - accuracy: 0.7440 - val_loss: 0.6147 - val_accuracy: 0.7232
Confusion matrix: 
 [[356  16]
 [121   2]]
Validation f1: 2.84
Validation accuracy: 72.32
Validation recall: 1.63
Validation precision: 11.11
Validation AUC: 0.22879784231620565
Validation class accuracies: [0.956989247311828, 0.016260162601626018]
TARGET: 1
target metric(test f1): 0.028368794326241138
column_sums: [477  18]
cm_sum: 495
The training is defaulting to either class.
Epoch 15/80
300/300 - 580s - loss: 0.5418 - accuracy: 0.7455 - val_loss: 0.5839 - val_accuracy: 0.7333
Confusion matrix: 
 [[360  12]
 [120   3]]
Validation f1: 4.35
Validation accuracy: 73.33
Validation recall: 2.44
Validation precision: 20.00
Validation AUC: 0.2588933816490551
Validation class accuracies: [0.967741935483871, 0.024390243902439025]
TARGET: 1
target metric(test f1): 0.04347826086956522
column_sums: [480  15]
cm_sum: 495
The training is defaulting to either class.
Epoch 16/80
300/300 - 581s - loss: 0.5350 - accuracy: 0.7467 - val_loss: 0.6224 - val_accuracy: 0.6929
Confusion matrix: 
 [[334  38]
 [114   9]]
Validation f1: 10.59
Validation accuracy: 69.29
Validation recall: 7.32
Validation precision: 19.15
Validation AUC: 0.2389235181337403
Validation class accuracies: [0.8978494623655914, 0.07317073170731707]
TARGET: 1
target metric(test f1): 0.10588235294117646
column_sums: [448  47]
cm_sum: 495
The training is defaulting to either class.
Epoch 17/80
300/300 - 582s - loss: 0.5281 - accuracy: 0.7505 - val_loss: 0.6493 - val_accuracy: 0.7071
Confusion matrix: 
 [[346  26]
 [119   4]]
Validation f1: 5.23
Validation accuracy: 70.71
Validation recall: 3.25
Validation precision: 13.33
Validation AUC: 0.22230736685623023
Validation class accuracies: [0.9301075268817204, 0.032520325203252036]
TARGET: 1
target metric(test f1): 0.0522875816993464
column_sums: [465  30]
cm_sum: 495
The training is defaulting to either class.
Epoch 18/80
300/300 - 579s - loss: 0.5227 - accuracy: 0.7530 - val_loss: 0.6448 - val_accuracy: 0.7434
Confusion matrix: 
 [[368   4]
 [123   0]]
Validation f1: 0.00
Validation accuracy: 74.34
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23031390277415378
Validation class accuracies: [0.989247311827957, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [491   4]
cm_sum: 495
The training is defaulting to either class.
Epoch 19/80
300/300 - 581s - loss: 0.5179 - accuracy: 0.7580 - val_loss: 0.6518 - val_accuracy: 0.7232
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[356  16]
 [121   2]]
Validation f1: 2.84
Validation accuracy: 72.32
Validation recall: 1.63
Validation precision: 11.11
Validation AUC: 0.24049927142040414
Validation class accuracies: [0.956989247311828, 0.016260162601626018]
TARGET: 1
target metric(test f1): 0.028368794326241138
column_sums: [477  18]
cm_sum: 495
The training is defaulting to either class.
Epoch 20/80
300/300 - 581s - loss: 0.5071 - accuracy: 0.7601 - val_loss: 0.6997 - val_accuracy: 0.6929
Confusion matrix: 
 [[337  35]
 [117   6]]
Validation f1: 7.32
Validation accuracy: 69.29
Validation recall: 4.88
Validation precision: 14.63
Validation AUC: 0.22677652500706347
Validation class accuracies: [0.9059139784946236, 0.04878048780487805]
TARGET: 1
target metric(test f1): 0.07317073170731707
column_sums: [454  41]
cm_sum: 495
The training is defaulting to either class.
Epoch 21/80
300/300 - 581s - loss: 0.4952 - accuracy: 0.7691 - val_loss: 0.6384 - val_accuracy: 0.7172
Confusion matrix: 
 [[349  23]
 [117   6]]
Validation f1: 7.89
Validation accuracy: 71.72
Validation recall: 4.88
Validation precision: 20.69
Validation AUC: 0.22365907220765777
Validation class accuracies: [0.9381720430107527, 0.04878048780487805]
TARGET: 1
target metric(test f1): 0.07894736842105263
column_sums: [466  29]
cm_sum: 495
The training is defaulting to either class.
Epoch 22/80
300/300 - 581s - loss: 0.4870 - accuracy: 0.7732 - val_loss: 0.6676 - val_accuracy: 0.7010
Confusion matrix: 
 [[330  42]
 [106  17]]
Validation f1: 18.68
Validation accuracy: 70.10
Validation recall: 13.82
Validation precision: 28.81
Validation AUC: 0.24676955229465178
Validation class accuracies: [0.8870967741935484, 0.13821138211382114]
TARGET: 1
target metric(test f1): 0.18681318681318684
column_sums: [436  59]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 1 epochs
Epoch 23/80
300/300 - 582s - loss: 0.4688 - accuracy: 0.7837 - val_loss: 0.6426 - val_accuracy: 0.7192
Confusion matrix: 
 [[343  29]
 [110  13]]
Validation f1: 15.76
Validation accuracy: 71.92
Validation recall: 10.57
Validation precision: 30.95
Validation AUC: 0.2854854742469461
Validation class accuracies: [0.9220430107526881, 0.10569105691056911]
TARGET: 1
target metric(test f1): 0.15757575757575756
column_sums: [453  42]
cm_sum: 495
The training is defaulting to either class.
Epoch 24/80
300/300 - 581s - loss: 0.4552 - accuracy: 0.7926 - val_loss: 0.7396 - val_accuracy: 0.6444
Confusion matrix: 
 [[295  77]
 [ 99  24]]
Validation f1: 21.43
Validation accuracy: 64.44
Validation recall: 19.51
Validation precision: 23.76
Validation AUC: 0.23075706282445813
Validation class accuracies: [0.793010752688172, 0.1951219512195122]
TARGET: 1
target metric(test f1): 0.21428571428571427
column_sums: [394 101]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 2 epochs
Epoch 25/80
300/300 - 582s - loss: 0.4333 - accuracy: 0.8043 - val_loss: 0.8487 - val_accuracy: 0.6747
Confusion matrix: 
 [[310  62]
 [ 99  24]]
Validation f1: 22.97
Validation accuracy: 67.47
Validation recall: 19.51
Validation precision: 27.91
Validation AUC: 0.2429006664877399
Validation class accuracies: [0.8333333333333334, 0.1951219512195122]
TARGET: 1
target metric(test f1): 0.22966507177033493
column_sums: [409  86]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 3 epochs
Epoch 26/80
300/300 - 581s - loss: 0.4206 - accuracy: 0.8075 - val_loss: 0.8064 - val_accuracy: 0.6747
Confusion matrix: 
 [[320  52]
 [109  14]]
Validation f1: 14.81
Validation accuracy: 67.47
Validation recall: 11.38
Validation precision: 21.21
Validation AUC: 0.22222906216389876
Validation class accuracies: [0.8602150537634409, 0.11382113821138211]
TARGET: 1
target metric(test f1): 0.14814814814814814
column_sums: [429  66]
cm_sum: 495
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 4 epochs
Epoch 27/80
300/300 - 581s - loss: 0.3659 - accuracy: 0.8421 - val_loss: 0.8802 - val_accuracy: 0.6141
Confusion matrix: 
 [[270 102]
 [ 89  34]]
Validation f1: 26.25
Validation accuracy: 61.41
Validation recall: 27.64
Validation precision: 25.00
Validation AUC: 0.24101233912136144
Validation class accuracies: [0.7258064516129032, 0.2764227642276423]
TARGET: 1
target metric(test f1): 0.2625482625482626
column_sums: [359 136]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 5 epochs
Epoch 28/80
300/300 - 581s - loss: 0.3291 - accuracy: 0.8609 - val_loss: 0.8365 - val_accuracy: 0.6727
Confusion matrix: 
 [[317  55]
 [107  16]]
Validation f1: 16.49
Validation accuracy: 67.27
Validation recall: 13.01
Validation precision: 22.54
Validation AUC: 0.23704647331563017
Validation class accuracies: [0.8521505376344086, 0.13008130081300814]
TARGET: 1
target metric(test f1): 0.16494845360824742
column_sums: [424  71]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 6 epochs
Epoch 29/80
300/300 - 580s - loss: 0.3125 - accuracy: 0.8664 - val_loss: 1.0196 - val_accuracy: 0.6040
Confusion matrix: 
 [[269 103]
 [ 93  30]]
Validation f1: 23.44
Validation accuracy: 60.40
Validation recall: 24.39
Validation precision: 22.56
Validation AUC: 0.2332856011563133
Validation class accuracies: [0.7231182795698925, 0.24390243902439024]
TARGET: 1
target metric(test f1): 0.23437499999999997
column_sums: [362 133]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 7 epochs
Epoch 30/80
300/300 - 583s - loss: 0.2925 - accuracy: 0.8783 - val_loss: 1.0583 - val_accuracy: 0.6263
Confusion matrix: 
 [[287  85]
 [100  23]]
Validation f1: 19.91
Validation accuracy: 62.63
Validation recall: 18.70
Validation precision: 21.30
Validation AUC: 0.22481581221276847
Validation class accuracies: [0.771505376344086, 0.18699186991869918]
TARGET: 1
target metric(test f1): 0.19913419913419916
column_sums: [387 108]
cm_sum: 495
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 8 epochs
Epoch 31/80
300/300 - 580s - loss: 0.2807 - accuracy: 0.8822 - val_loss: 1.0228 - val_accuracy: 0.6283
Confusion matrix: 
 [[285  87]
 [ 97  26]]
Validation f1: 22.03
Validation accuracy: 62.83
Validation recall: 21.14
Validation precision: 23.01
Validation AUC: 0.22546068192296742
Validation class accuracies: [0.7661290322580645, 0.21138211382113822]
TARGET: 1
target metric(test f1): 0.22033898305084745
column_sums: [382 113]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 9 epochs
Epoch 32/80
300/300 - 581s - loss: 0.2688 - accuracy: 0.8858 - val_loss: 1.0758 - val_accuracy: 0.5798
Confusion matrix: 
 [[253 119]
 [ 89  34]]
Validation f1: 24.64
Validation accuracy: 57.98
Validation recall: 27.64
Validation precision: 22.22
Validation AUC: 0.22737167806996744
Validation class accuracies: [0.6801075268817204, 0.2764227642276423]
TARGET: 1
target metric(test f1): 0.2463768115942029
column_sums: [342 153]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 10 epochs
Epoch 33/80
300/300 - 581s - loss: 0.2658 - accuracy: 0.8927 - val_loss: 1.0937 - val_accuracy: 0.5778
Confusion matrix: 
 [[262 110]
 [ 99  24]]
Validation f1: 18.68
Validation accuracy: 57.78
Validation recall: 19.51
Validation precision: 17.91
Validation AUC: 0.22236328968573238
Validation class accuracies: [0.7043010752688172, 0.1951219512195122]
TARGET: 1
target metric(test f1): 0.1867704280155642
column_sums: [361 134]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 11 epochs
Epoch 34/80
300/300 - 580s - loss: 0.2604 - accuracy: 0.8914 - val_loss: 1.1123 - val_accuracy: 0.5616
Confusion matrix: 
 [[248 124]
 [ 93  30]]
Validation f1: 21.66
Validation accuracy: 56.16
Validation recall: 24.39
Validation precision: 19.48
Validation AUC: 0.22727374991025887
Validation class accuracies: [0.6666666666666666, 0.24390243902439024]
TARGET: 1
target metric(test f1): 0.21660649819494585
column_sums: [341 154]
cm_sum: 495
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 12 epochs
Epoch 35/80
300/300 - 584s - loss: 0.2614 - accuracy: 0.8971 - val_loss: 1.1490 - val_accuracy: 0.5616
Confusion matrix: 
 [[243 129]
 [ 88  35]]
Validation f1: 24.39
Validation accuracy: 56.16
Validation recall: 28.46
Validation precision: 21.34
Validation AUC: 0.22914350408474046
Validation class accuracies: [0.6532258064516129, 0.2845528455284553]
TARGET: 1
target metric(test f1): 0.24390243902439027
column_sums: [331 164]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 13 epochs
Epoch 36/80
300/300 - 581s - loss: 0.2549 - accuracy: 0.8920 - val_loss: 1.1160 - val_accuracy: 0.5737
Confusion matrix: 
 [[253 119]
 [ 92  31]]
Validation f1: 22.71
Validation accuracy: 57.37
Validation recall: 25.20
Validation precision: 20.67
Validation AUC: 0.22719486050551024
Validation class accuracies: [0.6801075268817204, 0.25203252032520324]
TARGET: 1
target metric(test f1): 0.2271062271062271
column_sums: [345 150]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 14 epochs
Epoch 37/80
300/300 - 582s - loss: 0.2496 - accuracy: 0.8987 - val_loss: 1.1182 - val_accuracy: 0.5798
Confusion matrix: 
 [[257 115]
 [ 93  30]]
Validation f1: 22.39
Validation accuracy: 57.98
Validation recall: 24.39
Validation precision: 20.69
Validation AUC: 0.2275741820321689
Validation class accuracies: [0.6908602150537635, 0.24390243902439024]
TARGET: 1
target metric(test f1): 0.22388059701492538
column_sums: [350 145]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 15 epochs
Epoch 38/80
300/300 - 582s - loss: 0.2617 - accuracy: 0.8856 - val_loss: 1.1309 - val_accuracy: 0.5697
Confusion matrix: 
 [[247 125]
 [ 88  35]]
Validation f1: 24.73
Validation accuracy: 56.97
Validation recall: 28.46
Validation precision: 21.88
Validation AUC: 0.22612611860385678
Validation class accuracies: [0.6639784946236559, 0.2845528455284553]
TARGET: 1
target metric(test f1): 0.24734982332155475
column_sums: [335 160]
cm_sum: 495
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 16 epochs
Epoch 39/80
300/300 - 582s - loss: 0.2506 - accuracy: 0.8956 - val_loss: 1.1259 - val_accuracy: 0.5778
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[252 120]
 [ 89  34]]
Validation f1: 24.55
Validation accuracy: 57.78
Validation recall: 27.64
Validation precision: 22.08
Validation AUC: 0.22668797191339102
Validation class accuracies: [0.6774193548387096, 0.2764227642276423]
TARGET: 1
target metric(test f1): 0.24548736462093862
column_sums: [341 154]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 17 epochs
Epoch 40/80
300/300 - 581s - loss: 0.2510 - accuracy: 0.8941 - val_loss: 1.1293 - val_accuracy: 0.5778
Confusion matrix: 
 [[253 119]
 [ 90  33]]
Validation f1: 24.00
Validation accuracy: 57.78
Validation recall: 26.83
Validation precision: 21.71
Validation AUC: 0.22659195153515468
Validation class accuracies: [0.6801075268817204, 0.2682926829268293]
TARGET: 1
target metric(test f1): 0.24000000000000002
column_sums: [343 152]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 18 epochs
Epoch 41/80
300/300 - 582s - loss: 0.2587 - accuracy: 0.8908 - val_loss: 1.1387 - val_accuracy: 0.5717
Confusion matrix: 
 [[248 124]
 [ 88  35]]
Validation f1: 24.82
Validation accuracy: 57.17
Validation recall: 28.46
Validation precision: 22.01
Validation AUC: 0.22725169313850307
Validation class accuracies: [0.6666666666666666, 0.2845528455284553]
TARGET: 1
target metric(test f1): 0.24822695035460987
column_sums: [336 159]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 19 epochs
Epoch 42/80
300/300 - 582s - loss: 0.2518 - accuracy: 0.8950 - val_loss: 1.1441 - val_accuracy: 0.5636
Confusion matrix: 
 [[243 129]
 [ 87  36]]
Validation f1: 25.00
Validation accuracy: 56.36
Validation recall: 29.27
Validation precision: 21.82
Validation AUC: 0.22636225881897162
Validation class accuracies: [0.6532258064516129, 0.2926829268292683]
TARGET: 1
target metric(test f1): 0.25
column_sums: [330 165]
cm_sum: 495
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 20 epochs
Epoch 43/80
300/300 - 581s - loss: 0.2536 - accuracy: 0.8937 - val_loss: 1.1308 - val_accuracy: 0.5616
Confusion matrix: 
 [[245 127]
 [ 90  33]]
Validation f1: 23.32
Validation accuracy: 56.16
Validation recall: 26.83
Validation precision: 20.62
Validation AUC: 0.22764392252898583
Validation class accuracies: [0.6586021505376344, 0.2682926829268293]
TARGET: 1
target metric(test f1): 0.2332155477031802
column_sums: [335 160]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 21 epochs
Epoch 44/80
300/300 - 583s - loss: 0.2517 - accuracy: 0.8941 - val_loss: 1.1329 - val_accuracy: 0.5717
Confusion matrix: 
 [[251 121]
 [ 91  32]]
Validation f1: 23.19
Validation accuracy: 57.17
Validation recall: 26.02
Validation precision: 20.92
Validation AUC: 0.22560375501231822
Validation class accuracies: [0.6747311827956989, 0.2601626016260163]
TARGET: 1
target metric(test f1): 0.23188405797101452
column_sums: [342 153]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 22 epochs
Epoch 45/80
300/300 - 583s - loss: 0.2470 - accuracy: 0.9004 - val_loss: 1.1316 - val_accuracy: 0.5737
Confusion matrix: 
 [[251 121]
 [ 90  33]]
Validation f1: 23.83
Validation accuracy: 57.37
Validation recall: 26.83
Validation precision: 21.43
Validation AUC: 0.22542128990116125
Validation class accuracies: [0.6747311827956989, 0.2682926829268293]
TARGET: 1
target metric(test f1): 0.2382671480144404
column_sums: [341 154]
cm_sum: 495
inside not defaulting
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 23 epochs
Epoch 46/80
300/300 - 579s - loss: 0.2520 - accuracy: 0.8977 - val_loss: 1.1403 - val_accuracy: 0.5778
Confusion matrix: 
 [[250 122]
 [ 87  36]]
Validation f1: 25.62
Validation accuracy: 57.78
Validation recall: 29.27
Validation precision: 22.78
Validation AUC: 0.2261887006312529
Validation class accuracies: [0.6720430107526881, 0.2926829268292683]
TARGET: 1
target metric(test f1): 0.25622775800711745
column_sums: [337 158]
cm_sum: 495
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.2929936305732484 hasn't increased by 0 in 24 epochs
Epoch 47/80
300/300 - 581s - loss: 0.2534 - accuracy: 0.8973 - val_loss: 1.1413 - val_accuracy: 0.5616
Confusion matrix: 
 [[243 129]
 [ 88  35]]
Validation f1: 24.39
Validation accuracy: 56.16
Validation recall: 28.46
Validation precision: 21.34
Validation AUC: 0.2264892249361613
Validation class accuracies: [0.6532258064516129, 0.2845528455284553]

The metrics for the epoch with the best target metric are: 
Best cm: [[227 145]
 [ 77  46]]
Best f1: 0.2929936305732484
Best accuracy: 0.5515151515151515
Best recall: 0.37398373983739835
Best precision: 0.24083769633507854
Best AUC: 0.23375696831010645
Best epoch: 13
TARGET: 1
target metric(test f1): 0.24390243902439027
column_sums: [331 164]
cm_sum: 495
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 13
Starting...
CM: [[ 6 21]
 [ 1 10]]
F1: 0.4761904761904761
AUC: 0.6289936718629418
Accuracy: 0.42105263157894735
Precision: 0.3225806451612903
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_13.xls...
Done.
Epoch: 13
Starting...
CM: [[10 17]
 [ 4  7]]
F1: 0.4
AUC: 0.51664673046252
Accuracy: 0.4473684210526316
Precision: 0.2916666666666667
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_13.xls...
Done.
Epoch: 13
Starting...
CM: [[17 10]
 [ 6  5]]
F1: 0.3846153846153846
AUC: 0.47288676236044647
Accuracy: 0.5789473684210527
Precision: 0.3333333333333333
Recall: 0.45454545454545453
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_13.xls...
Done.
Epoch: 7
Starting...
CM: [[ 7 20]
 [ 0 11]]
F1: 0.5238095238095238
AUC: 0.6774193548387097
Accuracy: 0.47368421052631576
Precision: 0.3548387096774194
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_7.xls...
Done.
Epoch: 7
Starting...
CM: [[10 17]
 [ 4  7]]
F1: 0.4
AUC: 0.51664673046252
Accuracy: 0.4473684210526316
Precision: 0.2916666666666667
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_7.xls...
Done.
Epoch: 7
Starting...
CM: [[17 10]
 [ 6  5]]
F1: 0.3846153846153846
AUC: 0.47288676236044647
Accuracy: 0.5789473684210527
Precision: 0.3333333333333333
Recall: 0.45454545454545453
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_7.xls...
Done.
Epoch: 80
Starting...
CM: [[ 2 25]
 [ 1 10]]
F1: 0.43478260869565216
AUC: 0.6105604921394395
Accuracy: 0.3157894736842105
Precision: 0.2857142857142857
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_80.xls...
Done.
Epoch: 80
Starting...
CM: [[ 7 20]
 [ 3  8]]
F1: 0.4102564102564102
AUC: 0.5459671907040328
Accuracy: 0.39473684210526316
Precision: 0.2857142857142857
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_80.xls...
Done.
Epoch: 80
Starting...
CM: [[13 14]
 [ 7  4]]
F1: 0.27586206896551724
AUC: 0.3850345560871877
Accuracy: 0.4473684210526316
Precision: 0.2222222222222222
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_3_80.xls...
Done.
K-Fold split N: 4
With concat = False and six = False, size of training set: 4781...
...and size of validation set: 503
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_47 (InputLayer)           [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_276 (BatchN (None, 128, 1250, 1) 4           input_47[0][0]                   
__________________________________________________________________________________________________
conv2d_230 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_276[0][0]    
__________________________________________________________________________________________________
conv2d_232 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_276[0][0]    
__________________________________________________________________________________________________
max_pooling2d_46 (MaxPooling2D) (None, 128, 1250, 1) 0           batch_normalization_276[0][0]    
__________________________________________________________________________________________________
conv2d_231 (Conv2D)             (None, 128, 1250, 16 2320        conv2d_230[0][0]                 
__________________________________________________________________________________________________
conv2d_233 (Conv2D)             (None, 128, 1250, 16 6416        conv2d_232[0][0]                 
__________________________________________________________________________________________________
conv2d_234 (Conv2D)             (None, 128, 1250, 16 32          max_pooling2d_46[0][0]           
__________________________________________________________________________________________________
concatenate_46 (Concatenate)    (None, 128, 1250, 48 0           conv2d_231[0][0]                 
                                                                 conv2d_233[0][0]                 
                                                                 conv2d_234[0][0]                 
__________________________________________________________________________________________________
average_pooling2d_230 (AverageP (None, 64, 625, 48)  0           concatenate_46[0][0]             
__________________________________________________________________________________________________
batch_normalization_277 (BatchN (None, 64, 625, 48)  192         average_pooling2d_230[0][0]      
__________________________________________________________________________________________________
dropout_230 (Dropout)           (None, 64, 625, 48)  0           batch_normalization_277[0][0]    
__________________________________________________________________________________________________
inverted_residual_460 (Inverted (None, 64, 625, 32)  35840       dropout_230[0][0]                
__________________________________________________________________________________________________
inverted_residual_461 (Inverted (None, 64, 625, 32)  20864       inverted_residual_460[0][0]      
__________________________________________________________________________________________________
average_pooling2d_231 (AverageP (None, 32, 312, 32)  0           inverted_residual_461[0][0]      
__________________________________________________________________________________________________
batch_normalization_278 (BatchN (None, 32, 312, 32)  128         average_pooling2d_231[0][0]      
__________________________________________________________________________________________________
dropout_231 (Dropout)           (None, 32, 312, 32)  0           batch_normalization_278[0][0]    
__________________________________________________________________________________________________
inverted_residual_462 (Inverted (None, 32, 312, 64)  27136       dropout_231[0][0]                
__________________________________________________________________________________________________
inverted_residual_463 (Inverted (None, 32, 312, 64)  66304       inverted_residual_462[0][0]      
__________________________________________________________________________________________________
average_pooling2d_232 (AverageP (None, 16, 156, 64)  0           inverted_residual_463[0][0]      
__________________________________________________________________________________________________
batch_normalization_279 (BatchN (None, 16, 156, 64)  256         average_pooling2d_232[0][0]      
__________________________________________________________________________________________________
dropout_232 (Dropout)           (None, 16, 156, 64)  0           batch_normalization_279[0][0]    
__________________________________________________________________________________________________
inverted_residual_464 (Inverted (None, 16, 156, 128) 91136       dropout_232[0][0]                
__________________________________________________________________________________________________
inverted_residual_465 (Inverted (None, 16, 156, 128) 230912      inverted_residual_464[0][0]      
__________________________________________________________________________________________________
average_pooling2d_233 (AverageP (None, 8, 78, 128)   0           inverted_residual_465[0][0]      
__________________________________________________________________________________________________
batch_normalization_280 (BatchN (None, 8, 78, 128)   512         average_pooling2d_233[0][0]      
__________________________________________________________________________________________________
dropout_233 (Dropout)           (None, 8, 78, 128)   0           batch_normalization_280[0][0]    
__________________________________________________________________________________________________
inverted_residual_466 (Inverted (None, 8, 78, 256)   329728      dropout_233[0][0]                
__________________________________________________________________________________________________
inverted_residual_467 (Inverted (None, 8, 78, 256)   855040      inverted_residual_466[0][0]      
__________________________________________________________________________________________________
average_pooling2d_234 (AverageP (None, 4, 39, 256)   0           inverted_residual_467[0][0]      
__________________________________________________________________________________________________
batch_normalization_281 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_234[0][0]      
__________________________________________________________________________________________________
dropout_234 (Dropout)           (None, 4, 39, 256)   0           batch_normalization_281[0][0]    
__________________________________________________________________________________________________
inverted_residual_468 (Inverted (None, 4, 39, 512)   1249280     dropout_234[0][0]                
__________________________________________________________________________________________________
inverted_residual_469 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_468[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_46 (Gl (None, 512)          0           inverted_residual_469[0][0]      
__________________________________________________________________________________________________
dense_46 (Dense)                (None, 1)            513         global_average_pooling2d_46[0][0]
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
299/299 - 586s - loss: 0.6258 - accuracy: 0.7302 - val_loss: 0.5877 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.49833916840074854
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 2/80
299/299 - 580s - loss: 0.5761 - accuracy: 0.7398 - val_loss: 0.6076 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.39608712488890496
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 3/80
299/299 - 579s - loss: 0.5684 - accuracy: 0.7406 - val_loss: 0.5944 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.36672947769900044
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 4/80
299/299 - 579s - loss: 0.5685 - accuracy: 0.7398 - val_loss: 0.5795 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3643601221479938
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 5/80
299/299 - 579s - loss: 0.5653 - accuracy: 0.7421 - val_loss: 0.6550 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.35808670981724317
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 6/80
299/299 - 579s - loss: 0.5640 - accuracy: 0.7425 - val_loss: 0.6165 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32754503231141785
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 7/80
299/299 - 579s - loss: 0.5607 - accuracy: 0.7425 - val_loss: 0.5806 - val_accuracy: 0.7237
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[363   2]
 [137   1]]
Validation f1: 1.42
Validation accuracy: 72.37
Validation recall: 0.72
Validation precision: 33.33
Validation AUC: 0.35296570812372563
Validation class accuracies: [0.9945205479452055, 0.007246376811594203]
TARGET: 1
target metric(test f1): 0.014184397163120569
column_sums: [500   3]
cm_sum: 503
The training is defaulting to either class.
Epoch 8/80
299/299 - 578s - loss: 0.5595 - accuracy: 0.7434 - val_loss: 0.6272 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.28362620776253356
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 9/80
299/299 - 578s - loss: 0.5555 - accuracy: 0.7425 - val_loss: 0.6618 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2867309172940826
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 10/80
299/299 - 577s - loss: 0.5519 - accuracy: 0.7438 - val_loss: 0.5654 - val_accuracy: 0.7356
Confusion matrix: 
 [[357   8]
 [125  13]]
Validation f1: 16.35
Validation accuracy: 73.56
Validation recall: 9.42
Validation precision: 61.90
Validation AUC: 0.40956176854108056
Validation class accuracies: [0.9780821917808219, 0.09420289855072464]
TARGET: 1
target metric(test f1): 0.16352201257861637
column_sums: [482  21]
cm_sum: 503
The training is defaulting to either class.
Epoch 11/80
299/299 - 577s - loss: 0.5502 - accuracy: 0.7396 - val_loss: 0.5575 - val_accuracy: 0.7376
Confusion matrix: 
 [[358   7]
 [125  13]]
Validation f1: 16.46
Validation accuracy: 73.76
Validation recall: 9.42
Validation precision: 65.00
Validation AUC: 0.4415973578276814
Validation class accuracies: [0.9808219178082191, 0.09420289855072464]
TARGET: 1
target metric(test f1): 0.16455696202531647
column_sums: [483  20]
cm_sum: 503
The training is defaulting to either class.
Epoch 12/80
299/299 - 576s - loss: 0.5441 - accuracy: 0.7434 - val_loss: 0.6466 - val_accuracy: 0.7256
Confusion matrix: 
 [[365   0]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.56
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3296239257736182
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [503   0]
cm_sum: 503
The training is defaulting to either class.
Epoch 13/80
299/299 - 578s - loss: 0.5415 - accuracy: 0.7469 - val_loss: 0.5931 - val_accuracy: 0.7217
Confusion matrix: 
 [[363   2]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 72.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3715142779290929
Validation class accuracies: [0.9945205479452055, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [501   2]
cm_sum: 503
The training is defaulting to either class.
Epoch 14/80
299/299 - 577s - loss: 0.5389 - accuracy: 0.7486 - val_loss: 0.5876 - val_accuracy: 0.7177
Confusion matrix: 
 [[345  20]
 [122  16]]
Validation f1: 18.39
Validation accuracy: 71.77
Validation recall: 11.59
Validation precision: 44.44
Validation AUC: 0.36172400530110593
Validation class accuracies: [0.9452054794520548, 0.11594202898550725]
TARGET: 1
target metric(test f1): 0.18390804597701152
column_sums: [467  36]
cm_sum: 503
The training is defaulting to either class.
Epoch 15/80
299/299 - 578s - loss: 0.5333 - accuracy: 0.7494 - val_loss: 0.6926 - val_accuracy: 0.7197
Confusion matrix: 
 [[356   9]
 [132   6]]
Validation f1: 7.84
Validation accuracy: 71.97
Validation recall: 4.35
Validation precision: 40.00
Validation AUC: 0.318005550924653
Validation class accuracies: [0.9753424657534246, 0.043478260869565216]
TARGET: 1
target metric(test f1): 0.0784313725490196
column_sums: [488  15]
cm_sum: 503
The training is defaulting to either class.
Epoch 16/80
299/299 - 577s - loss: 0.5224 - accuracy: 0.7515 - val_loss: 0.6251 - val_accuracy: 0.7018
Confusion matrix: 
 [[340  25]
 [125  13]]
Validation f1: 14.77
Validation accuracy: 70.18
Validation recall: 9.42
Validation precision: 34.21
Validation AUC: 0.3432946892268133
Validation class accuracies: [0.9315068493150684, 0.09420289855072464]
TARGET: 1
target metric(test f1): 0.1477272727272727
column_sums: [465  38]
cm_sum: 503
The training is defaulting to either class.
Epoch 17/80
299/299 - 579s - loss: 0.5184 - accuracy: 0.7567 - val_loss: 0.6991 - val_accuracy: 0.7137
Confusion matrix: 
 [[359   6]
 [138   0]]
Validation f1: 0.00
Validation accuracy: 71.37
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3280991634568535
Validation class accuracies: [0.9835616438356164, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [497   6]
cm_sum: 503
The training is defaulting to either class.
Epoch 18/80
299/299 - 578s - loss: 0.5058 - accuracy: 0.7634 - val_loss: 0.8199 - val_accuracy: 0.7217
Confusion matrix: 
 [[359   6]
 [134   4]]
Validation f1: 5.41
Validation accuracy: 72.17
Validation recall: 2.90
Validation precision: 40.00
Validation AUC: 0.262734312468338
Validation class accuracies: [0.9835616438356164, 0.028985507246376812]
TARGET: 1
target metric(test f1): 0.05405405405405405
column_sums: [493  10]
cm_sum: 503
The training is defaulting to either class.
Epoch 19/80
299/299 - 578s - loss: 0.4936 - accuracy: 0.7714 - val_loss: 0.7603 - val_accuracy: 0.7296
Confusion matrix: 
 [[362   3]
 [133   5]]
Validation f1: 6.85
Validation accuracy: 72.96
Validation recall: 3.62
Validation precision: 62.50
Validation AUC: 0.2954130443949995
Validation class accuracies: [0.9917808219178083, 0.036231884057971016]
TARGET: 1
target metric(test f1): 0.0684931506849315
column_sums: [495   8]
cm_sum: 503
The training is defaulting to either class.
Epoch 20/80
299/299 - 577s - loss: 0.4789 - accuracy: 0.7806 - val_loss: 0.9942 - val_accuracy: 0.7256
Confusion matrix: 
 [[364   1]
 [137   1]]
Validation f1: 1.43
Validation accuracy: 72.56
Validation recall: 0.72
Validation precision: 50.00
Validation AUC: 0.3802539182815934
Validation class accuracies: [0.9972602739726028, 0.007246376811594203]
TARGET: 1
target metric(test f1): 0.014285714285714285
column_sums: [501   2]
cm_sum: 503
The training is defaulting to either class.
Epoch 21/80
299/299 - 577s - loss: 0.4726 - accuracy: 0.7749 - val_loss: 0.7922 - val_accuracy: 0.6859
Confusion matrix: 
 [[322  43]
 [115  23]]
Validation f1: 22.55
Validation accuracy: 68.59
Validation recall: 16.67
Validation precision: 34.85
Validation AUC: 0.34009201184043714
Validation class accuracies: [0.8821917808219178, 0.16666666666666666]
TARGET: 1
target metric(test f1): 0.22549019607843138
column_sums: [437  66]
cm_sum: 503
inside not defaulting
Saving model...
Epoch 22/80
299/299 - 579s - loss: 0.4540 - accuracy: 0.7900 - val_loss: 0.7901 - val_accuracy: 0.6521
Confusion matrix: 
 [[310  55]
 [120  18]]
Validation f1: 17.06
Validation accuracy: 65.21
Validation recall: 13.04
Validation precision: 24.66
Validation AUC: 0.27261963715067417
Validation class accuracies: [0.8493150684931506, 0.13043478260869565]
TARGET: 1
target metric(test f1): 0.17061611374407581
column_sums: [430  73]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.22549019607843138 hasn't increased by 0 in 1 epochs
Epoch 23/80
299/299 - 577s - loss: 0.4295 - accuracy: 0.8026 - val_loss: 0.7085 - val_accuracy: 0.6720
Confusion matrix: 
 [[315  50]
 [115  23]]
Validation f1: 21.80
Validation accuracy: 67.20
Validation recall: 16.67
Validation precision: 31.51
Validation AUC: 0.3166159832882267
Validation class accuracies: [0.863013698630137, 0.16666666666666666]
TARGET: 1
target metric(test f1): 0.21800947867298576
column_sums: [430  73]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.22549019607843138 hasn't increased by 0 in 2 epochs
Epoch 24/80
299/299 - 578s - loss: 0.4058 - accuracy: 0.8189 - val_loss: 1.1563 - val_accuracy: 0.7276
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[363   2]
 [135   3]]
Validation f1: 4.20
Validation accuracy: 72.76
Validation recall: 2.17
Validation precision: 60.00
Validation AUC: 0.24378399382022842
Validation class accuracies: [0.9945205479452055, 0.021739130434782608]
TARGET: 1
target metric(test f1): 0.04195804195804196
column_sums: [498   5]
cm_sum: 503
The training is defaulting to either class.
Epoch 25/80
299/299 - 578s - loss: 0.3914 - accuracy: 0.8178 - val_loss: 0.7685 - val_accuracy: 0.6064
Confusion matrix: 
 [[260 105]
 [ 93  45]]
Validation f1: 31.25
Validation accuracy: 60.64
Validation recall: 32.61
Validation precision: 30.00
Validation AUC: 0.3321617724725445
Validation class accuracies: [0.7123287671232876, 0.32608695652173914]
TARGET: 1
target metric(test f1): 0.31250000000000006
column_sums: [353 150]
cm_sum: 503
inside not defaulting
Saving model...
Epoch 26/80
299/299 - 578s - loss: 0.3566 - accuracy: 0.8433 - val_loss: 0.9619 - val_accuracy: 0.7217
Confusion matrix: 
 [[351  14]
 [126  12]]
Validation f1: 14.63
Validation accuracy: 72.17
Validation recall: 8.70
Validation precision: 46.15
Validation AUC: 0.3354954769098303
Validation class accuracies: [0.9616438356164384, 0.08695652173913043]
TARGET: 1
target metric(test f1): 0.14634146341463414
column_sums: [477  26]
cm_sum: 503
The training is defaulting to either class.
Epoch 27/80
299/299 - 578s - loss: 0.3339 - accuracy: 0.8538 - val_loss: 0.8572 - val_accuracy: 0.6740
Confusion matrix: 
 [[301  64]
 [100  38]]
Validation f1: 31.67
Validation accuracy: 67.40
Validation recall: 27.54
Validation precision: 37.25
Validation AUC: 0.33753727413451556
Validation class accuracies: [0.8246575342465754, 0.2753623188405797]
TARGET: 1
target metric(test f1): 0.3166666666666667
column_sums: [401 102]
cm_sum: 503
inside not defaulting
Saving model...
Epoch 28/80
299/299 - 579s - loss: 0.3114 - accuracy: 0.8632 - val_loss: 1.2231 - val_accuracy: 0.6024
Confusion matrix: 
 [[266  99]
 [101  37]]
Validation f1: 27.01
Validation accuracy: 60.24
Validation recall: 26.81
Validation precision: 27.21
Validation AUC: 0.3024546711134728
Validation class accuracies: [0.7287671232876712, 0.26811594202898553]
TARGET: 1
target metric(test f1): 0.27007299270072993
column_sums: [367 136]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.3166666666666667 hasn't increased by 0 in 1 epochs
Epoch 29/80
299/299 - 577s - loss: 0.2787 - accuracy: 0.8837 - val_loss: 1.1350 - val_accuracy: 0.6302
Confusion matrix: 
 [[264 101]
 [ 85  53]]
Validation f1: 36.30
Validation accuracy: 63.02
Validation recall: 38.41
Validation precision: 34.42
Validation AUC: 0.34118170211504856
Validation class accuracies: [0.7232876712328767, 0.38405797101449274]
TARGET: 1
target metric(test f1): 0.363013698630137
column_sums: [349 154]
cm_sum: 503
inside not defaulting
Saving model...
Epoch 30/80
299/299 - 580s - loss: 0.2527 - accuracy: 0.8946 - val_loss: 1.1102 - val_accuracy: 0.6183
Confusion matrix: 
 [[274  91]
 [101  37]]
Validation f1: 27.82
Validation accuracy: 61.83
Validation recall: 26.81
Validation precision: 28.91
Validation AUC: 0.31845814355803637
Validation class accuracies: [0.7506849315068493, 0.26811594202898553]
TARGET: 1
target metric(test f1): 0.2781954887218045
column_sums: [375 128]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 1 epochs
Epoch 31/80
299/299 - 577s - loss: 0.2241 - accuracy: 0.9027 - val_loss: 1.3576 - val_accuracy: 0.6600
Confusion matrix: 
 [[320  45]
 [126  12]]
Validation f1: 12.31
Validation accuracy: 66.00
Validation recall: 8.70
Validation precision: 21.05
Validation AUC: 0.2316019858521958
Validation class accuracies: [0.8767123287671232, 0.08695652173913043]
TARGET: 1
target metric(test f1): 0.12307692307692308
column_sums: [446  57]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 2 epochs
Epoch 32/80
299/299 - 578s - loss: 0.2224 - accuracy: 0.9092 - val_loss: 1.5526 - val_accuracy: 0.6918
Confusion matrix: 
 [[344  21]
 [134   4]]
Validation f1: 4.91
Validation accuracy: 69.18
Validation recall: 2.90
Validation precision: 16.00
Validation AUC: 0.22323156946918427
Validation class accuracies: [0.9424657534246575, 0.028985507246376812]
TARGET: 1
target metric(test f1): 0.049079754601226995
column_sums: [478  25]
cm_sum: 503
The training is defaulting to either class.
Epoch 33/80
299/299 - 577s - loss: 0.1964 - accuracy: 0.9220 - val_loss: 1.4776 - val_accuracy: 0.6918
Confusion matrix: 
 [[335  30]
 [125  13]]
Validation f1: 14.36
Validation accuracy: 69.18
Validation recall: 9.42
Validation precision: 30.23
Validation AUC: 0.28179249979893906
Validation class accuracies: [0.9178082191780822, 0.09420289855072464]
TARGET: 1
target metric(test f1): 0.143646408839779
column_sums: [460  43]
cm_sum: 503
The training is defaulting to either class.
Epoch 34/80
299/299 - 577s - loss: 0.1717 - accuracy: 0.9316 - val_loss: 1.5704 - val_accuracy: 0.6879
Confusion matrix: 
 [[332  33]
 [124  14]]
Validation f1: 15.14
Validation accuracy: 68.79
Validation recall: 10.14
Validation precision: 29.79
Validation AUC: 0.2868430283535389
Validation class accuracies: [0.9095890410958904, 0.10144927536231885]
TARGET: 1
target metric(test f1): 0.15135135135135136
column_sums: [456  47]
cm_sum: 503
The training is defaulting to either class.
Epoch 35/80
299/299 - 578s - loss: 0.1654 - accuracy: 0.9329 - val_loss: 1.4372 - val_accuracy: 0.6362
Confusion matrix: 
 [[296  69]
 [114  24]]
Validation f1: 20.78
Validation accuracy: 63.62
Validation recall: 17.39
Validation precision: 25.81
Validation AUC: 0.2935018298367865
Validation class accuracies: [0.810958904109589, 0.17391304347826086]
TARGET: 1
target metric(test f1): 0.2077922077922078
column_sums: [410  93]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 3 epochs
Epoch 36/80
299/299 - 579s - loss: 0.1540 - accuracy: 0.9385 - val_loss: 1.6216 - val_accuracy: 0.6660
Confusion matrix: 
 [[321  44]
 [124  14]]
Validation f1: 14.29
Validation accuracy: 66.60
Validation recall: 10.14
Validation precision: 24.14
Validation AUC: 0.28602659097070354
Validation class accuracies: [0.8794520547945206, 0.10144927536231885]
TARGET: 1
target metric(test f1): 0.14285714285714285
column_sums: [445  58]
cm_sum: 503
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 4 epochs
Epoch 37/80
299/299 - 578s - loss: 0.1054 - accuracy: 0.9615 - val_loss: 1.5527 - val_accuracy: 0.6521
Confusion matrix: 
 [[303  62]
 [113  25]]
Validation f1: 22.22
Validation accuracy: 65.21
Validation recall: 18.12
Validation precision: 28.74
Validation AUC: 0.3083890253017343
Validation class accuracies: [0.8301369863013699, 0.18115942028985507]
TARGET: 1
target metric(test f1): 0.22222222222222218
column_sums: [416  87]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 5 epochs
Epoch 38/80
299/299 - 578s - loss: 0.0903 - accuracy: 0.9697 - val_loss: 1.6702 - val_accuracy: 0.6720
Confusion matrix: 
 [[320  45]
 [120  18]]
Validation f1: 17.91
Validation accuracy: 67.20
Validation recall: 13.04
Validation precision: 28.57
Validation AUC: 0.2969343530766124
Validation class accuracies: [0.8767123287671232, 0.13043478260869565]
TARGET: 1
target metric(test f1): 0.17910447761194026
column_sums: [440  63]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 6 epochs
Epoch 39/80
299/299 - 577s - loss: 0.0773 - accuracy: 0.9722 - val_loss: 1.7471 - val_accuracy: 0.6839
Confusion matrix: 
 [[326  39]
 [120  18]]
Validation f1: 18.46
Validation accuracy: 68.39
Validation recall: 13.04
Validation precision: 31.58
Validation AUC: 0.302329856385049
Validation class accuracies: [0.8931506849315068, 0.13043478260869565]
TARGET: 1
target metric(test f1): 0.1846153846153846
column_sums: [446  57]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 7 epochs
Epoch 40/80
299/299 - 579s - loss: 0.0890 - accuracy: 0.9667 - val_loss: 1.7954 - val_accuracy: 0.6839
Confusion matrix: 
 [[317  48]
 [111  27]]
Validation f1: 25.35
Validation accuracy: 68.39
Validation recall: 19.57
Validation precision: 36.00
Validation AUC: 0.32863634793855023
Validation class accuracies: [0.8684931506849315, 0.1956521739130435]
TARGET: 1
target metric(test f1): 0.2535211267605634
column_sums: [428  75]
cm_sum: 503
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 8 epochs
Epoch 41/80
299/299 - 579s - loss: 0.0740 - accuracy: 0.9745 - val_loss: 1.7149 - val_accuracy: 0.6740
Confusion matrix: 
 [[312  53]
 [111  27]]
Validation f1: 24.77
Validation accuracy: 67.40
Validation recall: 19.57
Validation precision: 33.75
Validation AUC: 0.30979354573317114
Validation class accuracies: [0.8547945205479452, 0.1956521739130435]
TARGET: 1
target metric(test f1): 0.24770642201834864
column_sums: [423  80]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 9 epochs
Epoch 42/80
299/299 - 578s - loss: 0.0616 - accuracy: 0.9793 - val_loss: 1.7814 - val_accuracy: 0.6779
Confusion matrix: 
 [[316  49]
 [113  25]]
Validation f1: 23.58
Validation accuracy: 67.79
Validation recall: 18.12
Validation precision: 33.78
Validation AUC: 0.30602776887979966
Validation class accuracies: [0.8657534246575342, 0.18115942028985507]
TARGET: 1
target metric(test f1): 0.2358490566037736
column_sums: [429  74]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 10 epochs
Epoch 43/80
299/299 - 578s - loss: 0.0598 - accuracy: 0.9799 - val_loss: 1.7842 - val_accuracy: 0.6720
Confusion matrix: 
 [[313  52]
 [113  25]]
Validation f1: 23.26
Validation accuracy: 67.20
Validation recall: 18.12
Validation precision: 32.47
Validation AUC: 0.30232984180782074
Validation class accuracies: [0.8575342465753425, 0.18115942028985507]
TARGET: 1
target metric(test f1): 0.23255813953488372
column_sums: [426  77]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 11 epochs
Epoch 44/80
299/299 - 578s - loss: 0.0619 - accuracy: 0.9801 - val_loss: 1.8183 - val_accuracy: 0.6740
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[314  51]
 [113  25]]
Validation f1: 23.36
Validation accuracy: 67.40
Validation recall: 18.12
Validation precision: 32.89
Validation AUC: 0.29251692662965534
Validation class accuracies: [0.8602739726027397, 0.18115942028985507]
TARGET: 1
target metric(test f1): 0.2336448598130841
column_sums: [427  76]
cm_sum: 503
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 12 epochs
Epoch 45/80
299/299 - 578s - loss: 0.0713 - accuracy: 0.9770 - val_loss: 1.8181 - val_accuracy: 0.6660
Confusion matrix: 
 [[315  50]
 [118  20]]
Validation f1: 19.23
Validation accuracy: 66.60
Validation recall: 14.49
Validation precision: 28.57
Validation AUC: 0.29780357588929185
Validation class accuracies: [0.863013698630137, 0.14492753623188406]
TARGET: 1
target metric(test f1): 0.19230769230769232
column_sums: [433  70]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 13 epochs
Epoch 46/80
299/299 - 578s - loss: 0.0572 - accuracy: 0.9828 - val_loss: 1.7914 - val_accuracy: 0.6680
Confusion matrix: 
 [[310  55]
 [112  26]]
Validation f1: 23.74
Validation accuracy: 66.80
Validation recall: 18.84
Validation precision: 32.10
Validation AUC: 0.30352359544315066
Validation class accuracies: [0.8493150684931506, 0.18840579710144928]
TARGET: 1
target metric(test f1): 0.23744292237442918
column_sums: [422  81]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 14 epochs
Epoch 47/80
299/299 - 578s - loss: 0.0577 - accuracy: 0.9820 - val_loss: 1.8024 - val_accuracy: 0.6700
Confusion matrix: 
 [[315  50]
 [116  22]]
Validation f1: 20.95
Validation accuracy: 67.00
Validation recall: 15.94
Validation precision: 30.56
Validation AUC: 0.30573860861155544
Validation class accuracies: [0.863013698630137, 0.15942028985507245]
TARGET: 1
target metric(test f1): 0.20952380952380953
column_sums: [431  72]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 15 epochs
Epoch 48/80
299/299 - 579s - loss: 0.0648 - accuracy: 0.9776 - val_loss: 1.8372 - val_accuracy: 0.6740
Confusion matrix: 
 [[318  47]
 [117  21]]
Validation f1: 20.39
Validation accuracy: 67.40
Validation recall: 15.22
Validation precision: 30.88
Validation AUC: 0.2989343783708177
Validation class accuracies: [0.8712328767123287, 0.15217391304347827]
TARGET: 1
target metric(test f1): 0.20388349514563106
column_sums: [435  68]
cm_sum: 503
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 16 epochs
Epoch 49/80
299/299 - 578s - loss: 0.0586 - accuracy: 0.9808 - val_loss: 1.8280 - val_accuracy: 0.6720
Confusion matrix: 
 [[314  51]
 [114  24]]
Validation f1: 22.54
Validation accuracy: 67.20
Validation recall: 17.39
Validation precision: 32.00
Validation AUC: 0.300730035240364
Validation class accuracies: [0.8602739726027397, 0.17391304347826086]
TARGET: 1
target metric(test f1): 0.22535211267605634
column_sums: [428  75]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 17 epochs
Epoch 50/80
299/299 - 578s - loss: 0.0603 - accuracy: 0.9797 - val_loss: 1.8322 - val_accuracy: 0.6720
Confusion matrix: 
 [[316  49]
 [116  22]]
Validation f1: 21.05
Validation accuracy: 67.20
Validation recall: 15.94
Validation precision: 30.99
Validation AUC: 0.3035441543672558
Validation class accuracies: [0.8657534246575342, 0.15942028985507245]
TARGET: 1
target metric(test f1): 0.21052631578947364
column_sums: [432  71]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 18 epochs
Epoch 51/80
299/299 - 577s - loss: 0.0689 - accuracy: 0.9757 - val_loss: 1.8327 - val_accuracy: 0.6720
Confusion matrix: 
 [[318  47]
 [118  20]]
Validation f1: 19.51
Validation accuracy: 67.20
Validation recall: 14.49
Validation precision: 29.85
Validation AUC: 0.30012342375316725
Validation class accuracies: [0.8712328767123287, 0.14492753623188406]
TARGET: 1
target metric(test f1): 0.1951219512195122
column_sums: [436  67]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 19 epochs
Epoch 52/80
299/299 - 579s - loss: 0.0540 - accuracy: 0.9828 - val_loss: 1.8382 - val_accuracy: 0.6700
Confusion matrix: 
 [[317  48]
 [118  20]]
Validation f1: 19.42
Validation accuracy: 67.00
Validation recall: 14.49
Validation precision: 29.41
Validation AUC: 0.30033318687442045
Validation class accuracies: [0.8684931506849315, 0.14492753623188406]
TARGET: 1
target metric(test f1): 0.19417475728155337
column_sums: [435  68]
cm_sum: 503
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 20 epochs
Epoch 53/80
299/299 - 577s - loss: 0.0568 - accuracy: 0.9787 - val_loss: 1.8459 - val_accuracy: 0.6759
Confusion matrix: 
 [[318  47]
 [116  22]]
Validation f1: 21.26
Validation accuracy: 67.59
Validation recall: 15.94
Validation precision: 31.88
Validation AUC: 0.30078849188247936
Validation class accuracies: [0.8712328767123287, 0.15942028985507245]
TARGET: 1
target metric(test f1): 0.21256038647342995
column_sums: [434  69]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 21 epochs
Epoch 54/80
299/299 - 578s - loss: 0.0617 - accuracy: 0.9772 - val_loss: 1.8602 - val_accuracy: 0.6759
Confusion matrix: 
 [[320  45]
 [118  20]]
Validation f1: 19.70
Validation accuracy: 67.59
Validation recall: 14.49
Validation precision: 30.77
Validation AUC: 0.3006672202588999
Validation class accuracies: [0.8767123287671232, 0.14492753623188406]
TARGET: 1
target metric(test f1): 0.19704433497536947
column_sums: [438  65]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 22 epochs
Epoch 55/80
299/299 - 579s - loss: 0.0638 - accuracy: 0.9795 - val_loss: 1.8385 - val_accuracy: 0.6720
Confusion matrix: 
 [[317  48]
 [117  21]]
Validation f1: 20.29
Validation accuracy: 67.20
Validation recall: 15.22
Validation precision: 30.43
Validation AUC: 0.3020916040351874
Validation class accuracies: [0.8684931506849315, 0.15217391304347827]
TARGET: 1
target metric(test f1): 0.2028985507246377
column_sums: [434  69]
cm_sum: 503
inside not defaulting
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 23 epochs
Epoch 56/80
299/299 - 578s - loss: 0.0577 - accuracy: 0.9812 - val_loss: 1.8345 - val_accuracy: 0.6720
Confusion matrix: 
 [[316  49]
 [116  22]]
Validation f1: 21.05
Validation accuracy: 67.20
Validation recall: 15.94
Validation precision: 30.99
Validation AUC: 0.3003083238938542
Validation class accuracies: [0.8657534246575342, 0.15942028985507245]
TARGET: 1
target metric(test f1): 0.21052631578947364
column_sums: [432  71]
cm_sum: 503
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.363013698630137 hasn't increased by 0 in 24 epochs
Epoch 57/80
299/299 - 578s - loss: 0.0521 - accuracy: 0.9831 - val_loss: 1.8405 - val_accuracy: 0.6700
Confusion matrix: 
 [[316  49]
 [117  21]]
Validation f1: 20.19
Validation accuracy: 67.00
Validation recall: 15.22
Validation precision: 30.00
Validation AUC: 0.301056256906089
Validation class accuracies: [0.8657534246575342, 0.15217391304347827]

The metrics for the epoch with the best target metric are: 
Best cm: [[264 101]
 [ 85  53]]
Best f1: 0.363013698630137
Best accuracy: 0.6302186878727635
Best recall: 0.38405797101449274
Best precision: 0.34415584415584416
Best AUC: 0.34118170211504856
Best epoch: 29
TARGET: 1
target metric(test f1): 0.20192307692307693
column_sums: [433  70]
cm_sum: 503
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 21
Starting...
CM: [[13 14]
 [ 2  9]]
F1: 0.5294117647058824
AUC: 0.6310588724776368
Accuracy: 0.5789473684210527
Precision: 0.391304347826087
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_21.xls...
Done.
Epoch: 21
Starting...
CM: [[20  7]
 [ 8  3]]
F1: 0.28571428571428564
AUC: 0.3916267942583732
Accuracy: 0.6052631578947368
Precision: 0.3
Recall: 0.2727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_21.xls...
Done.
Epoch: 21
Starting...
CM: [[25  2]
 [10  1]]
F1: 0.14285714285714288
AUC: 0.3437001594896331
Accuracy: 0.6842105263157895
Precision: 0.3333333333333333
Recall: 0.09090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_21.xls...
Done.
Epoch: 25
Starting...
CM: [[ 6 21]
 [ 1 10]]
F1: 0.4761904761904761
AUC: 0.6289936718629418
Accuracy: 0.42105263157894735
Precision: 0.3225806451612903
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_25.xls...
Done.
Epoch: 25
Starting...
CM: [[14 13]
 [ 5  6]]
F1: 0.39999999999999997
AUC: 0.4964114832535885
Accuracy: 0.5263157894736842
Precision: 0.3157894736842105
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_25.xls...
Done.
Epoch: 25
Starting...
CM: [[19  8]
 [ 9  2]]
F1: 0.1904761904761905
AUC: 0.30933014354066984
Accuracy: 0.5526315789473685
Precision: 0.2
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_25.xls...
Done.
Epoch: 27
Starting...
CM: [[10 17]
 [ 2  9]]
F1: 0.4864864864864865
AUC: 0.6084836216415164
Accuracy: 0.5
Precision: 0.34615384615384615
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_27.xls...
Done.
Epoch: 27
Starting...
CM: [[16 11]
 [ 6  5]]
F1: 0.3703703703703703
AUC: 0.4624700956937799
Accuracy: 0.5526315789473685
Precision: 0.3125
Recall: 0.45454545454545453
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_27.xls...
Done.
Epoch: 27
Starting...
CM: [[23  4]
 [ 8  3]]
F1: 0.33333333333333326
AUC: 0.4559125085440875
Accuracy: 0.6842105263157895
Precision: 0.42857142857142855
Recall: 0.2727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_27.xls...
Done.
Epoch: 29
Starting...
CM: [[ 9 18]
 [ 0 11]]
F1: 0.5499999999999999
AUC: 0.6896551724137931
Accuracy: 0.5263157894736842
Precision: 0.3793103448275862
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_29.xls...
Done.
Epoch: 29
Starting...
CM: [[11 16]
 [ 4  7]]
F1: 0.411764705882353
AUC: 0.5229873101726649
Accuracy: 0.47368421052631576
Precision: 0.30434782608695654
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_29.xls...
Done.
Epoch: 29
Starting...
CM: [[19  8]
 [ 5  6]]
F1: 0.4799999999999999
AUC: 0.5528024606971975
Accuracy: 0.6578947368421053
Precision: 0.42857142857142855
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_29.xls...
Done.
Epoch: 80
Starting...
CM: [[13 14]
 [ 4  7]]
F1: 0.43749999999999994
AUC: 0.5374800637958532
Accuracy: 0.5263157894736842
Precision: 0.3333333333333333
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_80.xls...
Done.
Epoch: 80
Starting...
CM: [[22  5]
 [ 9  2]]
F1: 0.2222222222222222
AUC: 0.3521872863978127
Accuracy: 0.631578947368421
Precision: 0.2857142857142857
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_80.xls...
Done.
Epoch: 80
Starting...
CM: [[26  1]
 [11  0]]
F1: 0.0
AUC: 0.14473684210526316
Accuracy: 0.6842105263157895
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_4_80.xls...
Done.
K-Fold split N: 5
With concat = False and six = False, size of training set: 4749...
...and size of validation set: 535
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_63 (InputLayer)           [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_372 (BatchN (None, 128, 1250, 1) 4           input_63[0][0]                   
__________________________________________________________________________________________________
conv2d_310 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_372[0][0]    
__________________________________________________________________________________________________
conv2d_312 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_372[0][0]    
__________________________________________________________________________________________________
max_pooling2d_62 (MaxPooling2D) (None, 128, 1250, 1) 0           batch_normalization_372[0][0]    
__________________________________________________________________________________________________
conv2d_311 (Conv2D)             (None, 128, 1250, 16 2320        conv2d_310[0][0]                 
__________________________________________________________________________________________________
conv2d_313 (Conv2D)             (None, 128, 1250, 16 6416        conv2d_312[0][0]                 
__________________________________________________________________________________________________
conv2d_314 (Conv2D)             (None, 128, 1250, 16 32          max_pooling2d_62[0][0]           
__________________________________________________________________________________________________
concatenate_62 (Concatenate)    (None, 128, 1250, 48 0           conv2d_311[0][0]                 
                                                                 conv2d_313[0][0]                 
                                                                 conv2d_314[0][0]                 
__________________________________________________________________________________________________
average_pooling2d_310 (AverageP (None, 64, 625, 48)  0           concatenate_62[0][0]             
__________________________________________________________________________________________________
batch_normalization_373 (BatchN (None, 64, 625, 48)  192         average_pooling2d_310[0][0]      
__________________________________________________________________________________________________
dropout_310 (Dropout)           (None, 64, 625, 48)  0           batch_normalization_373[0][0]    
__________________________________________________________________________________________________
inverted_residual_620 (Inverted (None, 64, 625, 32)  35840       dropout_310[0][0]                
__________________________________________________________________________________________________
inverted_residual_621 (Inverted (None, 64, 625, 32)  20864       inverted_residual_620[0][0]      
__________________________________________________________________________________________________
average_pooling2d_311 (AverageP (None, 32, 312, 32)  0           inverted_residual_621[0][0]      
__________________________________________________________________________________________________
batch_normalization_374 (BatchN (None, 32, 312, 32)  128         average_pooling2d_311[0][0]      
__________________________________________________________________________________________________
dropout_311 (Dropout)           (None, 32, 312, 32)  0           batch_normalization_374[0][0]    
__________________________________________________________________________________________________
inverted_residual_622 (Inverted (None, 32, 312, 64)  27136       dropout_311[0][0]                
__________________________________________________________________________________________________
inverted_residual_623 (Inverted (None, 32, 312, 64)  66304       inverted_residual_622[0][0]      
__________________________________________________________________________________________________
average_pooling2d_312 (AverageP (None, 16, 156, 64)  0           inverted_residual_623[0][0]      
__________________________________________________________________________________________________
batch_normalization_375 (BatchN (None, 16, 156, 64)  256         average_pooling2d_312[0][0]      
__________________________________________________________________________________________________
dropout_312 (Dropout)           (None, 16, 156, 64)  0           batch_normalization_375[0][0]    
__________________________________________________________________________________________________
inverted_residual_624 (Inverted (None, 16, 156, 128) 91136       dropout_312[0][0]                
__________________________________________________________________________________________________
inverted_residual_625 (Inverted (None, 16, 156, 128) 230912      inverted_residual_624[0][0]      
__________________________________________________________________________________________________
average_pooling2d_313 (AverageP (None, 8, 78, 128)   0           inverted_residual_625[0][0]      
__________________________________________________________________________________________________
batch_normalization_376 (BatchN (None, 8, 78, 128)   512         average_pooling2d_313[0][0]      
__________________________________________________________________________________________________
dropout_313 (Dropout)           (None, 8, 78, 128)   0           batch_normalization_376[0][0]    
__________________________________________________________________________________________________
inverted_residual_626 (Inverted (None, 8, 78, 256)   329728      dropout_313[0][0]                
__________________________________________________________________________________________________
inverted_residual_627 (Inverted (None, 8, 78, 256)   855040      inverted_residual_626[0][0]      
__________________________________________________________________________________________________
average_pooling2d_314 (AverageP (None, 4, 39, 256)   0           inverted_residual_627[0][0]      
__________________________________________________________________________________________________
batch_normalization_377 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_314[0][0]      
__________________________________________________________________________________________________
dropout_314 (Dropout)           (None, 4, 39, 256)   0           batch_normalization_377[0][0]    
__________________________________________________________________________________________________
inverted_residual_628 (Inverted (None, 4, 39, 512)   1249280     dropout_314[0][0]                
__________________________________________________________________________________________________
inverted_residual_629 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_628[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_62 (Gl (None, 512)          0           inverted_residual_629[0][0]      
__________________________________________________________________________________________________
dense_62 (Dense)                (None, 1)            513         global_average_pooling2d_62[0][0]
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
297/297 - 588s - loss: 0.6735 - accuracy: 0.7147 - val_loss: 1.3949 - val_accuracy: 0.7346
Confusion matrix: 
 [[393   0]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.46
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2500540034871767
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [535   0]
cm_sum: 535
The training is defaulting to either class.
Epoch 2/80
297/297 - 588s - loss: 0.5751 - accuracy: 0.7383 - val_loss: 0.6769 - val_accuracy: 0.7346
Confusion matrix: 
 [[393   0]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.46
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2950445696273992
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [535   0]
cm_sum: 535
The training is defaulting to either class.
Epoch 3/80
297/297 - 589s - loss: 0.5648 - accuracy: 0.7389 - val_loss: 0.5879 - val_accuracy: 0.7346
Confusion matrix: 
 [[393   0]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.46
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2951730162238627
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [535   0]
cm_sum: 535
The training is defaulting to either class.
Epoch 4/80
297/297 - 588s - loss: 0.5649 - accuracy: 0.7389 - val_loss: 0.5924 - val_accuracy: 0.7327
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[392   1]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.27
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3196255116960238
Validation class accuracies: [0.9974554707379135, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [534   1]
cm_sum: 535
The training is defaulting to either class.
Epoch 5/80
297/297 - 588s - loss: 0.5599 - accuracy: 0.7404 - val_loss: 0.5776 - val_accuracy: 0.7346
Confusion matrix: 
 [[393   0]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.46
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2916056213859576
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [535   0]
cm_sum: 535
The training is defaulting to either class.
Epoch 6/80
297/297 - 589s - loss: 0.5570 - accuracy: 0.7410 - val_loss: 0.5805 - val_accuracy: 0.7346
Confusion matrix: 
 [[393   0]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.46
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2873964375102507
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [535   0]
cm_sum: 535
The training is defaulting to either class.
Epoch 7/80
297/297 - 589s - loss: 0.5525 - accuracy: 0.7397 - val_loss: 0.6471 - val_accuracy: 0.7271
Confusion matrix: 
 [[389   4]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 72.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2574377746869126
Validation class accuracies: [0.989821882951654, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [531   4]
cm_sum: 535
The training is defaulting to either class.
Epoch 8/80
297/297 - 589s - loss: 0.5556 - accuracy: 0.7395 - val_loss: 0.6887 - val_accuracy: 0.6972
Confusion matrix: 
 [[373  20]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 69.72
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25389202946586314
Validation class accuracies: [0.9491094147582697, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [515  20]
cm_sum: 535
The training is defaulting to either class.
Epoch 9/80
297/297 - 589s - loss: 0.5480 - accuracy: 0.7393 - val_loss: 0.6343 - val_accuracy: 0.7065
Confusion matrix: 
 [[378  15]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 70.65
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2486731324050098
Validation class accuracies: [0.9618320610687023, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [520  15]
cm_sum: 535
The training is defaulting to either class.
Epoch 10/80
297/297 - 588s - loss: 0.5501 - accuracy: 0.7421 - val_loss: 0.6345 - val_accuracy: 0.7065
Confusion matrix: 
 [[378  15]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 70.65
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.26344266699003427
Validation class accuracies: [0.9618320610687023, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [520  15]
cm_sum: 535
The training is defaulting to either class.
Epoch 11/80
297/297 - 589s - loss: 0.5420 - accuracy: 0.7446 - val_loss: 0.6724 - val_accuracy: 0.6935
Confusion matrix: 
 [[359  34]
 [130  12]]
Validation f1: 12.77
Validation accuracy: 69.35
Validation recall: 8.45
Validation precision: 26.09
Validation AUC: 0.29579360286389605
Validation class accuracies: [0.9134860050890585, 0.08450704225352113]
TARGET: 1
target metric(test f1): 0.1276595744680851
column_sums: [489  46]
cm_sum: 535
The training is defaulting to either class.
Epoch 12/80
297/297 - 590s - loss: 0.5431 - accuracy: 0.7484 - val_loss: 0.5836 - val_accuracy: 0.7308
Confusion matrix: 
 [[391   2]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.08
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.32078141219947837
Validation class accuracies: [0.9949109414758269, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [533   2]
cm_sum: 535
The training is defaulting to either class.
Epoch 13/80
297/297 - 589s - loss: 0.5397 - accuracy: 0.7488 - val_loss: 0.5925 - val_accuracy: 0.7308
Confusion matrix: 
 [[391   2]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.08
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.28747260218032095
Validation class accuracies: [0.9949109414758269, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [533   2]
cm_sum: 535
The training is defaulting to either class.
Epoch 14/80
297/297 - 588s - loss: 0.5320 - accuracy: 0.7526 - val_loss: 0.5959 - val_accuracy: 0.7234
Confusion matrix: 
 [[384   9]
 [139   3]]
Validation f1: 3.90
Validation accuracy: 72.34
Validation recall: 2.11
Validation precision: 25.00
Validation AUC: 0.25671150597653186
Validation class accuracies: [0.9770992366412213, 0.02112676056338028]
TARGET: 1
target metric(test f1): 0.03896103896103897
column_sums: [523  12]
cm_sum: 535
The training is defaulting to either class.
Epoch 15/80
297/297 - 590s - loss: 0.5284 - accuracy: 0.7566 - val_loss: 0.6223 - val_accuracy: 0.7327
Confusion matrix: 
 [[392   1]
 [142   0]]
Validation f1: 0.00
Validation accuracy: 73.27
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3117925743304971
Validation class accuracies: [0.9974554707379135, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [534   1]
cm_sum: 535
The training is defaulting to either class.
Epoch 16/80
297/297 - 588s - loss: 0.5265 - accuracy: 0.7593 - val_loss: 0.6451 - val_accuracy: 0.6860
Confusion matrix: 
 [[338  55]
 [113  29]]
Validation f1: 25.66
Validation accuracy: 68.60
Validation recall: 20.42
Validation precision: 34.52
Validation AUC: 0.31128152985792235
Validation class accuracies: [0.8600508905852418, 0.20422535211267606]
TARGET: 1
target metric(test f1): 0.2566371681415929
column_sums: [451  84]
cm_sum: 535
inside not defaulting
Saving model...
Epoch 17/80
297/297 - 581s - loss: 0.5132 - accuracy: 0.7692 - val_loss: 0.7392 - val_accuracy: 0.7103
Confusion matrix: 
 [[379  14]
 [141   1]]
Validation f1: 1.27
Validation accuracy: 71.03
Validation recall: 0.70
Validation precision: 6.67
Validation AUC: 0.2360344349081298
Validation class accuracies: [0.9643765903307888, 0.007042253521126761]
TARGET: 1
target metric(test f1): 0.012738853503184712
column_sums: [520  15]
cm_sum: 535
The training is defaulting to either class.
Epoch 18/80
297/297 - 580s - loss: 0.5051 - accuracy: 0.7690 - val_loss: 0.7457 - val_accuracy: 0.6579
Confusion matrix: 
 [[328  65]
 [118  24]]
Validation f1: 20.78
Validation accuracy: 65.79
Validation recall: 16.90
Validation precision: 26.97
Validation AUC: 0.28026584953764994
Validation class accuracies: [0.8346055979643766, 0.16901408450704225]
TARGET: 1
target metric(test f1): 0.20779220779220778
column_sums: [446  89]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.2566371681415929 hasn't increased by 0 in 1 epochs
Epoch 19/80
297/297 - 581s - loss: 0.4953 - accuracy: 0.7688 - val_loss: 0.7423 - val_accuracy: 0.6804
Confusion matrix: 
 [[347  46]
 [125  17]]
Validation f1: 16.59
Validation accuracy: 68.04
Validation recall: 11.97
Validation precision: 26.98
Validation AUC: 0.25123509419824497
Validation class accuracies: [0.8829516539440203, 0.11971830985915492]
TARGET: 1
target metric(test f1): 0.16585365853658535
column_sums: [472  63]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.2566371681415929 hasn't increased by 0 in 2 epochs
Epoch 20/80
297/297 - 582s - loss: 0.4857 - accuracy: 0.7787 - val_loss: 0.6411 - val_accuracy: 0.7196
Confusion matrix: 
 [[376  17]
 [133   9]]
Validation f1: 10.71
Validation accuracy: 71.96
Validation recall: 6.34
Validation precision: 34.62
Validation AUC: 0.30941015648856535
Validation class accuracies: [0.9567430025445293, 0.06338028169014084]
TARGET: 1
target metric(test f1): 0.10714285714285712
column_sums: [509  26]
cm_sum: 535
The training is defaulting to either class.
Epoch 21/80
297/297 - 580s - loss: 0.4704 - accuracy: 0.7846 - val_loss: 0.8848 - val_accuracy: 0.7215
Confusion matrix: 
 [[384   9]
 [140   2]]
Validation f1: 2.61
Validation accuracy: 72.15
Validation recall: 1.41
Validation precision: 18.18
Validation AUC: 0.27213395972158994
Validation class accuracies: [0.9770992366412213, 0.014084507042253521]
TARGET: 1
target metric(test f1): 0.026143790849673203
column_sums: [524  11]
cm_sum: 535
The training is defaulting to either class.
Epoch 22/80
297/297 - 582s - loss: 0.4555 - accuracy: 0.7955 - val_loss: 0.8450 - val_accuracy: 0.6449
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[318  75]
 [115  27]]
Validation f1: 22.13
Validation accuracy: 64.49
Validation recall: 19.01
Validation precision: 26.47
Validation AUC: 0.28287145298493116
Validation class accuracies: [0.8091603053435115, 0.19014084507042253]
TARGET: 1
target metric(test f1): 0.22131147540983606
column_sums: [433 102]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.2566371681415929 hasn't increased by 0 in 3 epochs
Epoch 23/80
297/297 - 581s - loss: 0.4285 - accuracy: 0.8073 - val_loss: 0.6749 - val_accuracy: 0.6916
Confusion matrix: 
 [[356  37]
 [128  14]]
Validation f1: 14.51
Validation accuracy: 69.16
Validation recall: 9.86
Validation precision: 27.45
Validation AUC: 0.32126500020569315
Validation class accuracies: [0.905852417302799, 0.09859154929577464]
TARGET: 1
target metric(test f1): 0.14507772020725387
column_sums: [484  51]
cm_sum: 535
The training is defaulting to either class.
Epoch 24/80
297/297 - 581s - loss: 0.4118 - accuracy: 0.8153 - val_loss: 0.8428 - val_accuracy: 0.6972
Confusion matrix: 
 [[363  30]
 [132  10]]
Validation f1: 10.99
Validation accuracy: 69.72
Validation recall: 7.04
Validation precision: 25.00
Validation AUC: 0.2697077388353726
Validation class accuracies: [0.9236641221374046, 0.07042253521126761]
TARGET: 1
target metric(test f1): 0.10989010989010989
column_sums: [495  40]
cm_sum: 535
The training is defaulting to either class.
Epoch 25/80
297/297 - 582s - loss: 0.3917 - accuracy: 0.8303 - val_loss: 1.0315 - val_accuracy: 0.5776
Confusion matrix: 
 [[244 149]
 [ 77  65]]
Validation f1: 36.52
Validation accuracy: 57.76
Validation recall: 45.77
Validation precision: 30.37
Validation AUC: 0.2891945248175014
Validation class accuracies: [0.6208651399491094, 0.45774647887323944]
TARGET: 1
target metric(test f1): 0.3651685393258427
column_sums: [321 214]
cm_sum: 535
inside not defaulting
Saving model...
Epoch 26/80
297/297 - 582s - loss: 0.3531 - accuracy: 0.8490 - val_loss: 1.3420 - val_accuracy: 0.6131
Confusion matrix: 
 [[275 118]
 [ 89  53]]
Validation f1: 33.87
Validation accuracy: 61.31
Validation recall: 37.32
Validation precision: 30.99
Validation AUC: 0.2782794075070293
Validation class accuracies: [0.6997455470737913, 0.3732394366197183]
TARGET: 1
target metric(test f1): 0.33865814696485624
column_sums: [364 171]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 1 epochs
Epoch 27/80
297/297 - 580s - loss: 0.3347 - accuracy: 0.8574 - val_loss: 1.2207 - val_accuracy: 0.6262
Confusion matrix: 
 [[301  92]
 [108  34]]
Validation f1: 25.37
Validation accuracy: 62.62
Validation recall: 23.94
Validation precision: 26.98
Validation AUC: 0.27102488680926395
Validation class accuracies: [0.7659033078880407, 0.23943661971830985]
TARGET: 1
target metric(test f1): 0.25373134328358204
column_sums: [409 126]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 2 epochs
Epoch 28/80
297/297 - 582s - loss: 0.3040 - accuracy: 0.8732 - val_loss: 0.8336 - val_accuracy: 0.7009
Confusion matrix: 
 [[371  22]
 [138   4]]
Validation f1: 4.76
Validation accuracy: 70.09
Validation recall: 2.82
Validation precision: 15.38
Validation AUC: 0.29709441855469776
Validation class accuracies: [0.9440203562340967, 0.028169014084507043]
TARGET: 1
target metric(test f1): 0.04761904761904762
column_sums: [509  26]
cm_sum: 535
The training is defaulting to either class.
Epoch 29/80
297/297 - 581s - loss: 0.2844 - accuracy: 0.8796 - val_loss: 1.1172 - val_accuracy: 0.6505
Confusion matrix: 
 [[322  71]
 [116  26]]
Validation f1: 21.76
Validation accuracy: 65.05
Validation recall: 18.31
Validation precision: 26.80
Validation AUC: 0.2746684343468996
Validation class accuracies: [0.8193384223918575, 0.18309859154929578]
TARGET: 1
target metric(test f1): 0.2175732217573222
column_sums: [438  97]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 3 epochs
Epoch 30/80
297/297 - 583s - loss: 0.2622 - accuracy: 0.8962 - val_loss: 0.9329 - val_accuracy: 0.6206
Confusion matrix: 
 [[283 110]
 [ 93  49]]
Validation f1: 32.56
Validation accuracy: 62.06
Validation recall: 34.51
Validation precision: 30.82
Validation AUC: 0.3020986464935037
Validation class accuracies: [0.7201017811704835, 0.34507042253521125]
TARGET: 1
target metric(test f1): 0.32558139534883723
column_sums: [376 159]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 4 epochs
Epoch 31/80
297/297 - 581s - loss: 0.1848 - accuracy: 0.9337 - val_loss: 1.1135 - val_accuracy: 0.6243
Confusion matrix: 
 [[307  86]
 [115  27]]
Validation f1: 21.18
Validation accuracy: 62.43
Validation recall: 19.01
Validation precision: 23.89
Validation AUC: 0.2730911153659747
Validation class accuracies: [0.7811704834605598, 0.19014084507042253]
TARGET: 1
target metric(test f1): 0.21176470588235297
column_sums: [422 113]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 5 epochs
Epoch 32/80
297/297 - 584s - loss: 0.1598 - accuracy: 0.9387 - val_loss: 1.1711 - val_accuracy: 0.6131
Confusion matrix: 
 [[299  94]
 [113  29]]
Validation f1: 21.89
Validation accuracy: 61.31
Validation recall: 20.42
Validation precision: 23.58
Validation AUC: 0.26884178296718086
Validation class accuracies: [0.7608142493638677, 0.20422535211267606]
TARGET: 1
target metric(test f1): 0.2188679245283019
column_sums: [412 123]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 6 epochs
Epoch 33/80
297/297 - 583s - loss: 0.1514 - accuracy: 0.9398 - val_loss: 1.2695 - val_accuracy: 0.6374
Confusion matrix: 
 [[312  81]
 [113  29]]
Validation f1: 23.02
Validation accuracy: 63.74
Validation recall: 20.42
Validation precision: 26.36
Validation AUC: 0.2644938520921318
Validation class accuracies: [0.7938931297709924, 0.20422535211267606]
TARGET: 1
target metric(test f1): 0.23015873015873017
column_sums: [425 110]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 7 epochs
Epoch 34/80
297/297 - 584s - loss: 0.1283 - accuracy: 0.9535 - val_loss: 1.2492 - val_accuracy: 0.6112
Confusion matrix: 
 [[285 108]
 [100  42]]
Validation f1: 28.77
Validation accuracy: 61.12
Validation recall: 29.58
Validation precision: 28.00
Validation AUC: 0.26307642969809686
Validation class accuracies: [0.7251908396946565, 0.29577464788732394]
TARGET: 1
target metric(test f1): 0.2876712328767123
column_sums: [385 150]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 8 epochs
Epoch 35/80
297/297 - 582s - loss: 0.1090 - accuracy: 0.9585 - val_loss: 1.3723 - val_accuracy: 0.6336
Confusion matrix: 
 [[305  88]
 [108  34]]
Validation f1: 25.76
Validation accuracy: 63.36
Validation recall: 23.94
Validation precision: 27.87
Validation AUC: 0.2733454683401036
Validation class accuracies: [0.7760814249363868, 0.23943661971830985]
TARGET: 1
target metric(test f1): 0.25757575757575757
column_sums: [413 122]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 9 epochs
Epoch 36/80
297/297 - 583s - loss: 0.1116 - accuracy: 0.9623 - val_loss: 1.3196 - val_accuracy: 0.6243
Confusion matrix: 
 [[305  88]
 [113  29]]
Validation f1: 22.39
Validation accuracy: 62.43
Validation recall: 20.42
Validation precision: 24.79
Validation AUC: 0.2698568560004904
Validation class accuracies: [0.7760814249363868, 0.20422535211267606]
TARGET: 1
target metric(test f1): 0.22393822393822396
column_sums: [418 117]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 10 epochs
Epoch 37/80
297/297 - 584s - loss: 0.1098 - accuracy: 0.9570 - val_loss: 1.3223 - val_accuracy: 0.6374
Confusion matrix: 
 [[314  79]
 [115  27]]
Validation f1: 21.77
Validation accuracy: 63.74
Validation recall: 19.01
Validation precision: 25.47
Validation AUC: 0.26917761460806194
Validation class accuracies: [0.7989821882951654, 0.19014084507042253]
TARGET: 1
target metric(test f1): 0.21774193548387097
column_sums: [429 106]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 11 epochs
Epoch 38/80
297/297 - 584s - loss: 0.1025 - accuracy: 0.9627 - val_loss: 1.4382 - val_accuracy: 0.6187
Confusion matrix: 
 [[290 103]
 [101  41]]
Validation f1: 28.67
Validation accuracy: 61.87
Validation recall: 28.87
Validation precision: 28.47
Validation AUC: 0.2724694257423155
Validation class accuracies: [0.7379134860050891, 0.2887323943661972]
TARGET: 1
target metric(test f1): 0.2867132867132867
column_sums: [391 144]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 12 epochs
Epoch 39/80
297/297 - 582s - loss: 0.0964 - accuracy: 0.9690 - val_loss: 1.4090 - val_accuracy: 0.6299
Confusion matrix: 
 [[298  95]
 [103  39]]
Validation f1: 28.26
Validation accuracy: 62.99
Validation recall: 27.46
Validation precision: 29.10
Validation AUC: 0.2753271295336321
Validation class accuracies: [0.7582697201017812, 0.2746478873239437]
TARGET: 1
target metric(test f1): 0.28260869565217395
column_sums: [401 134]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 13 epochs
Epoch 40/80
297/297 - 583s - loss: 0.1015 - accuracy: 0.9650 - val_loss: 1.4378 - val_accuracy: 0.6243
Confusion matrix: 
 [[296  97]
 [104  38]]
Validation f1: 27.44
Validation accuracy: 62.43
Validation recall: 26.76
Validation precision: 28.15
Validation AUC: 0.2723078290841878
Validation class accuracies: [0.7531806615776081, 0.2676056338028169]
TARGET: 1
target metric(test f1): 0.27436823104693137
column_sums: [400 135]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 14 epochs
Epoch 41/80
297/297 - 582s - loss: 0.0984 - accuracy: 0.9653 - val_loss: 1.4213 - val_accuracy: 0.6355
Confusion matrix: 
 [[305  88]
 [107  35]]
Validation f1: 26.42
Validation accuracy: 63.55
Validation recall: 24.65
Validation precision: 28.46
Validation AUC: 0.27026830215820863
Validation class accuracies: [0.7760814249363868, 0.24647887323943662]
TARGET: 1
target metric(test f1): 0.2641509433962264
column_sums: [412 123]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 15 epochs
Epoch 42/80
297/297 - 583s - loss: 0.0950 - accuracy: 0.9653 - val_loss: 1.4451 - val_accuracy: 0.6280
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[298  95]
 [104  38]]
Validation f1: 27.64
Validation accuracy: 62.80
Validation recall: 26.76
Validation precision: 28.57
Validation AUC: 0.26804660889258797
Validation class accuracies: [0.7582697201017812, 0.2676056338028169]
TARGET: 1
target metric(test f1): 0.2763636363636363
column_sums: [402 133]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 16 epochs
Epoch 43/80
297/297 - 583s - loss: 0.1028 - accuracy: 0.9634 - val_loss: 1.4393 - val_accuracy: 0.6224
Confusion matrix: 
 [[299  94]
 [108  34]]
Validation f1: 25.19
Validation accuracy: 62.24
Validation recall: 23.94
Validation precision: 26.56
Validation AUC: 0.2673363843357519
Validation class accuracies: [0.7608142493638677, 0.23943661971830985]
TARGET: 1
target metric(test f1): 0.2518518518518518
column_sums: [407 128]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 17 epochs
Epoch 44/80
297/297 - 582s - loss: 0.1026 - accuracy: 0.9627 - val_loss: 1.4316 - val_accuracy: 0.6243
Confusion matrix: 
 [[298  95]
 [106  36]]
Validation f1: 26.37
Validation accuracy: 62.43
Validation recall: 25.35
Validation precision: 27.48
Validation AUC: 0.26923068864661615
Validation class accuracies: [0.7582697201017812, 0.2535211267605634]
TARGET: 1
target metric(test f1): 0.26373626373626374
column_sums: [404 131]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 18 epochs
Epoch 45/80
297/297 - 582s - loss: 0.0970 - accuracy: 0.9665 - val_loss: 1.4346 - val_accuracy: 0.6243
Confusion matrix: 
 [[301  92]
 [109  33]]
Validation f1: 24.72
Validation accuracy: 62.43
Validation recall: 23.24
Validation precision: 26.40
Validation AUC: 0.26724703705978836
Validation class accuracies: [0.7659033078880407, 0.2323943661971831]
TARGET: 1
target metric(test f1): 0.24719101123595505
column_sums: [410 125]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 19 epochs
Epoch 46/80
297/297 - 583s - loss: 0.1018 - accuracy: 0.9634 - val_loss: 1.4196 - val_accuracy: 0.6224
Confusion matrix: 
 [[296  97]
 [105  37]]
Validation f1: 26.81
Validation accuracy: 62.24
Validation recall: 26.06
Validation precision: 27.61
Validation AUC: 0.2697641926079014
Validation class accuracies: [0.7531806615776081, 0.2605633802816901]
TARGET: 1
target metric(test f1): 0.26811594202898553
column_sums: [401 134]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 20 epochs
Epoch 47/80
297/297 - 581s - loss: 0.1003 - accuracy: 0.9638 - val_loss: 1.4368 - val_accuracy: 0.6224
Confusion matrix: 
 [[299  94]
 [108  34]]
Validation f1: 25.19
Validation accuracy: 62.24
Validation recall: 23.94
Validation precision: 26.56
Validation AUC: 0.2669443353507681
Validation class accuracies: [0.7608142493638677, 0.23943661971830985]
TARGET: 1
target metric(test f1): 0.2518518518518518
column_sums: [407 128]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 21 epochs
Epoch 48/80
297/297 - 581s - loss: 0.0899 - accuracy: 0.9703 - val_loss: 1.4321 - val_accuracy: 0.6243
Confusion matrix: 
 [[298  95]
 [106  36]]
Validation f1: 26.37
Validation accuracy: 62.43
Validation recall: 25.35
Validation precision: 27.48
Validation AUC: 0.2679797594681175
Validation class accuracies: [0.7582697201017812, 0.2535211267605634]
TARGET: 1
target metric(test f1): 0.26373626373626374
column_sums: [404 131]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 22 epochs
Epoch 49/80
297/297 - 582s - loss: 0.1008 - accuracy: 0.9653 - val_loss: 1.4438 - val_accuracy: 0.6075
Confusion matrix: 
 [[285 108]
 [102  40]]
Validation f1: 27.59
Validation accuracy: 60.75
Validation recall: 28.17
Validation precision: 27.03
Validation AUC: 0.2690252450731425
Validation class accuracies: [0.7251908396946565, 0.28169014084507044]
TARGET: 1
target metric(test f1): 0.27586206896551724
column_sums: [387 148]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 23 epochs
Epoch 50/80
297/297 - 582s - loss: 0.1042 - accuracy: 0.9589 - val_loss: 1.4539 - val_accuracy: 0.6187
Confusion matrix: 
 [[298  95]
 [109  33]]
Validation f1: 24.44
Validation accuracy: 61.87
Validation recall: 23.24
Validation precision: 25.78
Validation AUC: 0.2654155174669556
Validation class accuracies: [0.7582697201017812, 0.2323943661971831]
TARGET: 1
target metric(test f1): 0.24444444444444444
column_sums: [407 128]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.3651685393258427 hasn't increased by 0 in 24 epochs
Epoch 51/80
297/297 - 581s - loss: 0.1026 - accuracy: 0.9648 - val_loss: 1.4399 - val_accuracy: 0.6224
Confusion matrix: 
 [[297  96]
 [106  36]]
Validation f1: 26.28
Validation accuracy: 62.24
Validation recall: 25.35
Validation precision: 27.27
Validation AUC: 0.26761338231517484
Validation class accuracies: [0.7557251908396947, 0.2535211267605634]

The metrics for the epoch with the best target metric are: 
Best cm: [[244 149]
 [ 77  65]]
Best f1: 0.3651685393258427
Best accuracy: 0.577570093457944
Best recall: 0.45774647887323944
Best precision: 0.3037383177570093
Best AUC: 0.2891945248175014
Best epoch: 25
TARGET: 1
target metric(test f1): 0.2627737226277372
column_sums: [403 132]
cm_sum: 535
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 16
Starting...
CM: [[15 12]
 [ 4  7]]
F1: 0.4666666666666667
AUC: 0.5550239234449761
Accuracy: 0.5789473684210527
Precision: 0.3684210526315789
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_16.xls...
Done.
Epoch: 16
Starting...
CM: [[22  5]
 [ 6  5]]
F1: 0.47619047619047616
AUC: 0.5562200956937798
Accuracy: 0.7105263157894737
Precision: 0.5
Recall: 0.45454545454545453
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_16.xls...
Done.
Epoch: 16
Starting...
CM: [[24  3]
 [ 9  2]]
F1: 0.25000000000000006
AUC: 0.4093301435406698
Accuracy: 0.6842105263157895
Precision: 0.4
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_16.xls...
Done.
Epoch: 25
Starting...
CM: [[ 6 21]
 [ 0 11]]
F1: 0.5116279069767442
AUC: 0.671875
Accuracy: 0.4473684210526316
Precision: 0.34375
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_25.xls...
Done.
Epoch: 25
Starting...
CM: [[11 16]
 [ 4  7]]
F1: 0.411764705882353
AUC: 0.5229873101726649
Accuracy: 0.47368421052631576
Precision: 0.30434782608695654
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_25.xls...
Done.
Epoch: 25
Starting...
CM: [[17 10]
 [ 5  6]]
F1: 0.4444444444444444
AUC: 0.5260167464114833
Accuracy: 0.6052631578947368
Precision: 0.375
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_25.xls...
Done.
Epoch: 80
Starting...
CM: [[ 3 24]
 [ 3  8]]
F1: 0.37209302325581395
AUC: 0.52811004784689
Accuracy: 0.2894736842105263
Precision: 0.25
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_80.xls...
Done.
Epoch: 80
Starting...
CM: [[16 11]
 [ 4  7]]
F1: 0.4827586206896552
AUC: 0.565257841573631
Accuracy: 0.6052631578947368
Precision: 0.3888888888888889
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_80.xls...
Done.
Epoch: 80
Starting...
CM: [[23  4]
 [ 7  4]]
F1: 0.4210526315789474
AUC: 0.5239234449760766
Accuracy: 0.7105263157894737
Precision: 0.5
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_5_80.xls...
Done.
K-Fold split N: 6
With concat = False and six = False, size of training set: 4749...
...and size of validation set: 535
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_73 (InputLayer)           [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_432 (BatchN (None, 128, 1250, 1) 4           input_73[0][0]                   
__________________________________________________________________________________________________
conv2d_360 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_432[0][0]    
__________________________________________________________________________________________________
conv2d_362 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_432[0][0]    
__________________________________________________________________________________________________
max_pooling2d_72 (MaxPooling2D) (None, 128, 1250, 1) 0           batch_normalization_432[0][0]    
__________________________________________________________________________________________________
conv2d_361 (Conv2D)             (None, 128, 1250, 16 2320        conv2d_360[0][0]                 
__________________________________________________________________________________________________
conv2d_363 (Conv2D)             (None, 128, 1250, 16 6416        conv2d_362[0][0]                 
__________________________________________________________________________________________________
conv2d_364 (Conv2D)             (None, 128, 1250, 16 32          max_pooling2d_72[0][0]           
__________________________________________________________________________________________________
concatenate_72 (Concatenate)    (None, 128, 1250, 48 0           conv2d_361[0][0]                 
                                                                 conv2d_363[0][0]                 
                                                                 conv2d_364[0][0]                 
__________________________________________________________________________________________________
average_pooling2d_360 (AverageP (None, 64, 625, 48)  0           concatenate_72[0][0]             
__________________________________________________________________________________________________
batch_normalization_433 (BatchN (None, 64, 625, 48)  192         average_pooling2d_360[0][0]      
__________________________________________________________________________________________________
dropout_360 (Dropout)           (None, 64, 625, 48)  0           batch_normalization_433[0][0]    
__________________________________________________________________________________________________
inverted_residual_720 (Inverted (None, 64, 625, 32)  35840       dropout_360[0][0]                
__________________________________________________________________________________________________
inverted_residual_721 (Inverted (None, 64, 625, 32)  20864       inverted_residual_720[0][0]      
__________________________________________________________________________________________________
average_pooling2d_361 (AverageP (None, 32, 312, 32)  0           inverted_residual_721[0][0]      
__________________________________________________________________________________________________
batch_normalization_434 (BatchN (None, 32, 312, 32)  128         average_pooling2d_361[0][0]      
__________________________________________________________________________________________________
dropout_361 (Dropout)           (None, 32, 312, 32)  0           batch_normalization_434[0][0]    
__________________________________________________________________________________________________
inverted_residual_722 (Inverted (None, 32, 312, 64)  27136       dropout_361[0][0]                
__________________________________________________________________________________________________
inverted_residual_723 (Inverted (None, 32, 312, 64)  66304       inverted_residual_722[0][0]      
__________________________________________________________________________________________________
average_pooling2d_362 (AverageP (None, 16, 156, 64)  0           inverted_residual_723[0][0]      
__________________________________________________________________________________________________
batch_normalization_435 (BatchN (None, 16, 156, 64)  256         average_pooling2d_362[0][0]      
__________________________________________________________________________________________________
dropout_362 (Dropout)           (None, 16, 156, 64)  0           batch_normalization_435[0][0]    
__________________________________________________________________________________________________
inverted_residual_724 (Inverted (None, 16, 156, 128) 91136       dropout_362[0][0]                
__________________________________________________________________________________________________
inverted_residual_725 (Inverted (None, 16, 156, 128) 230912      inverted_residual_724[0][0]      
__________________________________________________________________________________________________
average_pooling2d_363 (AverageP (None, 8, 78, 128)   0           inverted_residual_725[0][0]      
__________________________________________________________________________________________________
batch_normalization_436 (BatchN (None, 8, 78, 128)   512         average_pooling2d_363[0][0]      
__________________________________________________________________________________________________
dropout_363 (Dropout)           (None, 8, 78, 128)   0           batch_normalization_436[0][0]    
__________________________________________________________________________________________________
inverted_residual_726 (Inverted (None, 8, 78, 256)   329728      dropout_363[0][0]                
__________________________________________________________________________________________________
inverted_residual_727 (Inverted (None, 8, 78, 256)   855040      inverted_residual_726[0][0]      
__________________________________________________________________________________________________
average_pooling2d_364 (AverageP (None, 4, 39, 256)   0           inverted_residual_727[0][0]      
__________________________________________________________________________________________________
batch_normalization_437 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_364[0][0]      
__________________________________________________________________________________________________
dropout_364 (Dropout)           (None, 4, 39, 256)   0           batch_normalization_437[0][0]    
__________________________________________________________________________________________________
inverted_residual_728 (Inverted (None, 4, 39, 512)   1249280     dropout_364[0][0]                
__________________________________________________________________________________________________
inverted_residual_729 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_728[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_72 (Gl (None, 512)          0           inverted_residual_729[0][0]      
__________________________________________________________________________________________________
dense_72 (Dense)                (None, 1)            513         global_average_pooling2d_72[0][0]
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
297/297 - 583s - loss: 0.6373 - accuracy: 0.7242 - val_loss: 0.7564 - val_accuracy: 0.7402
Confusion matrix: 
 [[396   0]
 [139   0]]
Validation f1: 0.00
Validation accuracy: 74.02
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31723430194108243
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [535   0]
cm_sum: 535
The training is defaulting to either class.
Epoch 2/80
297/297 - 579s - loss: 0.5743 - accuracy: 0.7370 - val_loss: 0.9603 - val_accuracy: 0.7402
Confusion matrix: 
 [[396   0]
 [139   0]]
Validation f1: 0.00
Validation accuracy: 74.02
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.29207632530842775
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [535   0]
cm_sum: 535
The training is defaulting to either class.
Epoch 3/80
297/297 - 576s - loss: 0.5727 - accuracy: 0.7368 - val_loss: 0.6023 - val_accuracy: 0.7383
Confusion matrix: 
 [[395   1]
 [139   0]]
Validation f1: 0.00
Validation accuracy: 73.83
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.21437374269893347
Validation class accuracies: [0.9974747474747475, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [534   1]
cm_sum: 535
The training is defaulting to either class.
Epoch 4/80
297/297 - 580s - loss: 0.5728 - accuracy: 0.7397 - val_loss: 1.7195 - val_accuracy: 0.7290
Confusion matrix: 
 [[389   7]
 [138   1]]
Validation f1: 1.36
Validation accuracy: 72.90
Validation recall: 0.72
Validation precision: 12.50
Validation AUC: 0.30514888908071686
Validation class accuracies: [0.9823232323232324, 0.007194244604316547]
TARGET: 1
target metric(test f1): 0.013605442176870748
column_sums: [527   8]
cm_sum: 535
The training is defaulting to either class.
Epoch 5/80
297/297 - 579s - loss: 0.5695 - accuracy: 0.7412 - val_loss: 0.6406 - val_accuracy: 0.7140
Confusion matrix: 
 [[379  17]
 [136   3]]
Validation f1: 3.77
Validation accuracy: 71.40
Validation recall: 2.16
Validation precision: 15.00
Validation AUC: 0.2950030740809067
Validation class accuracies: [0.9570707070707071, 0.02158273381294964]
TARGET: 1
target metric(test f1): 0.03773584905660377
column_sums: [515  20]
cm_sum: 535
The training is defaulting to either class.
Epoch 6/80
297/297 - 579s - loss: 0.5700 - accuracy: 0.7406 - val_loss: 0.6457 - val_accuracy: 0.7402
Confusion matrix: 
 [[396   0]
 [139   0]]
Validation f1: 0.00
Validation accuracy: 74.02
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2324941413163266
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [535   0]
cm_sum: 535
The training is defaulting to either class.
Epoch 7/80
297/297 - 579s - loss: 0.5670 - accuracy: 0.7395 - val_loss: 0.8034 - val_accuracy: 0.6935
Confusion matrix: 
 [[359  37]
 [127  12]]
Validation f1: 12.77
Validation accuracy: 69.35
Validation recall: 8.63
Validation precision: 24.49
Validation AUC: 0.2491077904469774
Validation class accuracies: [0.9065656565656566, 0.08633093525179857]
TARGET: 1
target metric(test f1): 0.1276595744680851
column_sums: [486  49]
cm_sum: 535
The training is defaulting to either class.
Epoch 8/80
297/297 - 578s - loss: 0.5625 - accuracy: 0.7410 - val_loss: 0.7016 - val_accuracy: 0.6935
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[365  31]
 [133   6]]
Validation f1: 6.82
Validation accuracy: 69.35
Validation recall: 4.32
Validation precision: 16.22
Validation AUC: 0.2301420193151667
Validation class accuracies: [0.9217171717171717, 0.04316546762589928]
TARGET: 1
target metric(test f1): 0.06818181818181819
column_sums: [498  37]
cm_sum: 535
The training is defaulting to either class.
Epoch 9/80
297/297 - 578s - loss: 0.5618 - accuracy: 0.7391 - val_loss: 0.6149 - val_accuracy: 0.7402
Confusion matrix: 
 [[394   2]
 [137   2]]
Validation f1: 2.80
Validation accuracy: 74.02
Validation recall: 1.44
Validation precision: 50.00
Validation AUC: 0.26906992091899756
Validation class accuracies: [0.9949494949494949, 0.014388489208633094]
TARGET: 1
target metric(test f1): 0.027972027972027972
column_sums: [531   4]
cm_sum: 535
The training is defaulting to either class.
Epoch 10/80
297/297 - 578s - loss: 0.5593 - accuracy: 0.7399 - val_loss: 0.7256 - val_accuracy: 0.7103
Confusion matrix: 
 [[377  19]
 [136   3]]
Validation f1: 3.73
Validation accuracy: 71.03
Validation recall: 2.16
Validation precision: 13.64
Validation AUC: 0.2237693367757354
Validation class accuracies: [0.952020202020202, 0.02158273381294964]
TARGET: 1
target metric(test f1): 0.037267080745341616
column_sums: [513  22]
cm_sum: 535
The training is defaulting to either class.
Epoch 11/80
297/297 - 579s - loss: 0.5567 - accuracy: 0.7402 - val_loss: 0.5865 - val_accuracy: 0.7196
Confusion matrix: 
 [[383  13]
 [137   2]]
Validation f1: 2.60
Validation accuracy: 71.96
Validation recall: 1.44
Validation precision: 13.33
Validation AUC: 0.30944198041539933
Validation class accuracies: [0.9671717171717171, 0.014388489208633094]
TARGET: 1
target metric(test f1): 0.025974025974025976
column_sums: [520  15]
cm_sum: 535
The training is defaulting to either class.
Epoch 12/80
297/297 - 578s - loss: 0.5525 - accuracy: 0.7429 - val_loss: 0.5779 - val_accuracy: 0.7327
Confusion matrix: 
 [[391   5]
 [138   1]]
Validation f1: 1.38
Validation accuracy: 73.27
Validation recall: 0.72
Validation precision: 16.67
Validation AUC: 0.33466645165557374
Validation class accuracies: [0.9873737373737373, 0.007194244604316547]
TARGET: 1
target metric(test f1): 0.01379310344827586
column_sums: [529   6]
cm_sum: 535
The training is defaulting to either class.
Epoch 13/80
297/297 - 578s - loss: 0.5497 - accuracy: 0.7397 - val_loss: 0.5781 - val_accuracy: 0.7364
Confusion matrix: 
 [[392   4]
 [137   2]]
Validation f1: 2.76
Validation accuracy: 73.64
Validation recall: 1.44
Validation precision: 33.33
Validation AUC: 0.33313982962837935
Validation class accuracies: [0.98989898989899, 0.014388489208633094]
TARGET: 1
target metric(test f1): 0.02758620689655172
column_sums: [529   6]
cm_sum: 535
The training is defaulting to either class.
Epoch 14/80
297/297 - 578s - loss: 0.5443 - accuracy: 0.7427 - val_loss: 0.6792 - val_accuracy: 0.7065
Confusion matrix: 
 [[363  33]
 [124  15]]
Validation f1: 16.04
Validation accuracy: 70.65
Validation recall: 10.79
Validation precision: 31.25
Validation AUC: 0.3018573307072876
Validation class accuracies: [0.9166666666666666, 0.1079136690647482]
TARGET: 1
target metric(test f1): 0.16042780748663102
column_sums: [487  48]
cm_sum: 535
The training is defaulting to either class.
Epoch 15/80
297/297 - 579s - loss: 0.5370 - accuracy: 0.7479 - val_loss: 0.7047 - val_accuracy: 0.6318
Confusion matrix: 
 [[308  88]
 [109  30]]
Validation f1: 23.35
Validation accuracy: 63.18
Validation recall: 21.58
Validation precision: 25.42
Validation AUC: 0.29231368551907744
Validation class accuracies: [0.7777777777777778, 0.2158273381294964]
TARGET: 1
target metric(test f1): 0.23346303501945526
column_sums: [417 118]
cm_sum: 535
inside not defaulting
Saving model...
Epoch 16/80
297/297 - 578s - loss: 0.5298 - accuracy: 0.7507 - val_loss: 0.6666 - val_accuracy: 0.6972
Confusion matrix: 
 [[354  42]
 [120  19]]
Validation f1: 19.00
Validation accuracy: 69.72
Validation recall: 13.67
Validation precision: 31.15
Validation AUC: 0.3200310758230527
Validation class accuracies: [0.8939393939393939, 0.1366906474820144]
TARGET: 1
target metric(test f1): 0.19
column_sums: [474  61]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.23346303501945526 hasn't increased by 0 in 1 epochs
Epoch 17/80
297/297 - 577s - loss: 0.5266 - accuracy: 0.7564 - val_loss: 0.7024 - val_accuracy: 0.7159
Confusion matrix: 
 [[378  18]
 [134   5]]
Validation f1: 6.17
Validation accuracy: 71.59
Validation recall: 3.60
Validation precision: 21.74
Validation AUC: 0.2592816274106278
Validation class accuracies: [0.9545454545454546, 0.03597122302158273]
TARGET: 1
target metric(test f1): 0.06172839506172839
column_sums: [512  23]
cm_sum: 535
The training is defaulting to either class.
Epoch 18/80
297/297 - 578s - loss: 0.5168 - accuracy: 0.7534 - val_loss: 0.5969 - val_accuracy: 0.6991
Confusion matrix: 
 [[341  55]
 [106  33]]
Validation f1: 29.07
Validation accuracy: 69.91
Validation recall: 23.74
Validation precision: 37.50
Validation AUC: 0.3880754766082708
Validation class accuracies: [0.8611111111111112, 0.23741007194244604]
TARGET: 1
target metric(test f1): 0.29074889867841414
column_sums: [447  88]
cm_sum: 535
inside not defaulting
Saving model...
Epoch 19/80
297/297 - 579s - loss: 0.5056 - accuracy: 0.7646 - val_loss: 0.5878 - val_accuracy: 0.7421
Confusion matrix: 
 [[385  11]
 [127  12]]
Validation f1: 14.81
Validation accuracy: 74.21
Validation recall: 8.63
Validation precision: 52.17
Validation AUC: 0.39307732194730904
Validation class accuracies: [0.9722222222222222, 0.08633093525179857]
TARGET: 1
target metric(test f1): 0.14814814814814817
column_sums: [512  23]
cm_sum: 535
The training is defaulting to either class.
Epoch 20/80
297/297 - 578s - loss: 0.4951 - accuracy: 0.7717 - val_loss: 0.6758 - val_accuracy: 0.6953
Confusion matrix: 
 [[340  56]
 [107  32]]
Validation f1: 28.19
Validation accuracy: 69.53
Validation recall: 23.02
Validation precision: 36.36
Validation AUC: 0.3376863918303449
Validation class accuracies: [0.8585858585858586, 0.2302158273381295]
TARGET: 1
target metric(test f1): 0.28193832599118945
column_sums: [447  88]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.29074889867841414 hasn't increased by 0 in 1 epochs
Epoch 21/80
297/297 - 578s - loss: 0.4838 - accuracy: 0.7810 - val_loss: 0.7286 - val_accuracy: 0.6374
Confusion matrix: 
 [[278 118]
 [ 76  63]]
Validation f1: 39.38
Validation accuracy: 63.74
Validation recall: 45.32
Validation precision: 34.81
Validation AUC: 0.3736226510013736
Validation class accuracies: [0.702020202020202, 0.45323741007194246]
TARGET: 1
target metric(test f1): 0.39375
column_sums: [354 181]
cm_sum: 535
inside not defaulting
Saving model...
Epoch 22/80
297/297 - 580s - loss: 0.4686 - accuracy: 0.7825 - val_loss: 1.0021 - val_accuracy: 0.6860
Confusion matrix: 
 [[355  41]
 [127  12]]
Validation f1: 12.50
Validation accuracy: 68.60
Validation recall: 8.63
Validation precision: 22.64
Validation AUC: 0.31910719507091007
Validation class accuracies: [0.8964646464646465, 0.08633093525179857]
TARGET: 1
target metric(test f1): 0.125
column_sums: [482  53]
cm_sum: 535
The training is defaulting to either class.
Epoch 23/80
297/297 - 579s - loss: 0.4538 - accuracy: 0.7953 - val_loss: 0.6469 - val_accuracy: 0.7234
Confusion matrix: 
 [[378  18]
 [130   9]]
Validation f1: 10.84
Validation accuracy: 72.34
Validation recall: 6.47
Validation precision: 33.33
Validation AUC: 0.34198340147111717
Validation class accuracies: [0.9545454545454546, 0.06474820143884892]
TARGET: 1
target metric(test f1): 0.10843373493975904
column_sums: [508  27]
cm_sum: 535
The training is defaulting to either class.
Epoch 24/80
297/297 - 579s - loss: 0.4340 - accuracy: 0.8056 - val_loss: 0.7570 - val_accuracy: 0.7327
Confusion matrix: 
 [[383  13]
 [130   9]]
Validation f1: 11.18
Validation accuracy: 73.27
Validation recall: 6.47
Validation precision: 40.91
Validation AUC: 0.3204068467319825
Validation class accuracies: [0.9671717171717171, 0.06474820143884892]
TARGET: 1
target metric(test f1): 0.11180124223602485
column_sums: [513  22]
cm_sum: 535
The training is defaulting to either class.
Epoch 25/80
297/297 - 584s - loss: 0.4192 - accuracy: 0.8164 - val_loss: 0.9154 - val_accuracy: 0.6804
Confusion matrix: 
 [[349  47]
 [124  15]]
Validation f1: 14.93
Validation accuracy: 68.04
Validation recall: 10.79
Validation precision: 24.19
Validation AUC: 0.32340560707047683
Validation class accuracies: [0.8813131313131313, 0.1079136690647482]
TARGET: 1
target metric(test f1): 0.14925373134328357
column_sums: [473  62]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 1 epochs
Epoch 26/80
297/297 - 585s - loss: 0.3973 - accuracy: 0.8233 - val_loss: 0.8026 - val_accuracy: 0.7009
Confusion matrix: 
 [[349  47]
 [113  26]]
Validation f1: 24.53
Validation accuracy: 70.09
Validation recall: 18.71
Validation precision: 35.62
Validation AUC: 0.3312494083960128
Validation class accuracies: [0.8813131313131313, 0.18705035971223022]
TARGET: 1
target metric(test f1): 0.24528301886792447
column_sums: [462  73]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 2 epochs
Epoch 27/80
297/297 - 586s - loss: 0.3847 - accuracy: 0.8292 - val_loss: 0.8418 - val_accuracy: 0.6617
Confusion matrix: 
 [[316  80]
 [101  38]]
Validation f1: 29.57
Validation accuracy: 66.17
Validation recall: 27.34
Validation precision: 32.20
Validation AUC: 0.33386970890282686
Validation class accuracies: [0.797979797979798, 0.2733812949640288]
TARGET: 1
target metric(test f1): 0.29571984435797666
column_sums: [417 118]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 3 epochs
Epoch 28/80
297/297 - 586s - loss: 0.3561 - accuracy: 0.8406 - val_loss: 1.0336 - val_accuracy: 0.6523
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[312  84]
 [102  37]]
Validation f1: 28.46
Validation accuracy: 65.23
Validation recall: 26.62
Validation precision: 30.58
Validation AUC: 0.34587556268906516
Validation class accuracies: [0.7878787878787878, 0.26618705035971224]
TARGET: 1
target metric(test f1): 0.2846153846153846
column_sums: [414 121]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.39375 hasn't increased by 0 in 4 epochs
Epoch 29/80
297/297 - 584s - loss: 0.2888 - accuracy: 0.8842 - val_loss: 1.1520 - val_accuracy: 0.5271
Confusion matrix: 
 [[206 190]
 [ 63  76]]
Validation f1: 37.53
Validation accuracy: 52.71
Validation recall: 54.68
Validation precision: 28.57
Validation AUC: 0.3588176966507861
Validation class accuracies: [0.5202020202020202, 0.5467625899280576]
TARGET: 1
target metric(test f1): 0.37530864197530867
column_sums: [269 266]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 5 epochs
Epoch 30/80
297/297 - 585s - loss: 0.2664 - accuracy: 0.8916 - val_loss: 0.8033 - val_accuracy: 0.6841
Confusion matrix: 
 [[313  83]
 [ 86  53]]
Validation f1: 38.55
Validation accuracy: 68.41
Validation recall: 38.13
Validation precision: 38.97
Validation AUC: 0.38914220179938935
Validation class accuracies: [0.7904040404040404, 0.381294964028777]
TARGET: 1
target metric(test f1): 0.3854545454545455
column_sums: [399 136]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 6 epochs
Epoch 31/80
297/297 - 585s - loss: 0.2446 - accuracy: 0.9059 - val_loss: 0.9238 - val_accuracy: 0.6206
Confusion matrix: 
 [[283 113]
 [ 90  49]]
Validation f1: 32.56
Validation accuracy: 62.06
Validation recall: 35.25
Validation precision: 30.25
Validation AUC: 0.34701083957479945
Validation class accuracies: [0.7146464646464646, 0.35251798561151076]
TARGET: 1
target metric(test f1): 0.3255813953488372
column_sums: [373 162]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 7 epochs
Epoch 32/80
297/297 - 585s - loss: 0.2346 - accuracy: 0.9055 - val_loss: 1.1663 - val_accuracy: 0.5439
Confusion matrix: 
 [[219 177]
 [ 67  72]]
Validation f1: 37.11
Validation accuracy: 54.39
Validation recall: 51.80
Validation precision: 28.92
Validation AUC: 0.3597894962337629
Validation class accuracies: [0.553030303030303, 0.5179856115107914]
TARGET: 1
target metric(test f1): 0.37113402061855666
column_sums: [286 249]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.39375 hasn't increased by 0 in 8 epochs
Epoch 33/80
297/297 - 584s - loss: 0.2115 - accuracy: 0.9154 - val_loss: 1.0290 - val_accuracy: 0.6000
Confusion matrix: 
 [[264 132]
 [ 82  57]]
Validation f1: 34.76
Validation accuracy: 60.00
Validation recall: 41.01
Validation precision: 30.16
Validation AUC: 0.33856057491035724
Validation class accuracies: [0.6666666666666666, 0.41007194244604317]
TARGET: 1
target metric(test f1): 0.34756097560975613
column_sums: [346 189]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 9 epochs
Epoch 34/80
297/297 - 586s - loss: 0.2066 - accuracy: 0.9177 - val_loss: 0.9516 - val_accuracy: 0.6617
Confusion matrix: 
 [[305  91]
 [ 90  49]]
Validation f1: 35.13
Validation accuracy: 66.17
Validation recall: 35.25
Validation precision: 35.00
Validation AUC: 0.34707185363549575
Validation class accuracies: [0.7702020202020202, 0.35251798561151076]
TARGET: 1
target metric(test f1): 0.35125448028673834
column_sums: [395 140]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 10 epochs
Epoch 35/80
297/297 - 585s - loss: 0.1942 - accuracy: 0.9263 - val_loss: 1.0609 - val_accuracy: 0.6449
Confusion matrix: 
 [[303  93]
 [ 97  42]]
Validation f1: 30.66
Validation accuracy: 64.49
Validation recall: 30.22
Validation precision: 31.11
Validation AUC: 0.3214511050934451
Validation class accuracies: [0.7651515151515151, 0.302158273381295]
TARGET: 1
target metric(test f1): 0.30656934306569344
column_sums: [400 135]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 11 epochs
Epoch 36/80
297/297 - 586s - loss: 0.1892 - accuracy: 0.9274 - val_loss: 1.0327 - val_accuracy: 0.6617
Confusion matrix: 
 [[313  83]
 [ 98  41]]
Validation f1: 31.18
Validation accuracy: 66.17
Validation recall: 29.50
Validation precision: 33.06
Validation AUC: 0.3287179546950554
Validation class accuracies: [0.7904040404040404, 0.2949640287769784]
TARGET: 1
target metric(test f1): 0.311787072243346
column_sums: [411 124]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.39375 hasn't increased by 0 in 12 epochs
Epoch 37/80
297/297 - 586s - loss: 0.1938 - accuracy: 0.9271 - val_loss: 1.0631 - val_accuracy: 0.6243
Confusion matrix: 
 [[283 113]
 [ 88  51]]
Validation f1: 33.66
Validation accuracy: 62.43
Validation recall: 36.69
Validation precision: 31.10
Validation AUC: 0.3374415142129543
Validation class accuracies: [0.7146464646464646, 0.3669064748201439]
TARGET: 1
target metric(test f1): 0.3366336633663366
column_sums: [371 164]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 13 epochs
Epoch 38/80
297/297 - 585s - loss: 0.1923 - accuracy: 0.9284 - val_loss: 1.0899 - val_accuracy: 0.6168
Confusion matrix: 
 [[273 123]
 [ 82  57]]
Validation f1: 35.74
Validation accuracy: 61.68
Validation recall: 41.01
Validation precision: 31.67
Validation AUC: 0.3383154135356779
Validation class accuracies: [0.6893939393939394, 0.41007194244604317]
TARGET: 1
target metric(test f1): 0.35736677115987464
column_sums: [355 180]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 14 epochs
Epoch 39/80
297/297 - 585s - loss: 0.2044 - accuracy: 0.9194 - val_loss: 1.0450 - val_accuracy: 0.6299
Confusion matrix: 
 [[284 112]
 [ 86  53]]
Validation f1: 34.87
Validation accuracy: 62.99
Validation recall: 38.13
Validation precision: 32.12
Validation AUC: 0.34302859857268114
Validation class accuracies: [0.7171717171717171, 0.381294964028777]
TARGET: 1
target metric(test f1): 0.3486842105263158
column_sums: [370 165]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 15 epochs
Epoch 40/80
297/297 - 585s - loss: 0.1868 - accuracy: 0.9240 - val_loss: 1.0340 - val_accuracy: 0.6355
Confusion matrix: 
 [[289 107]
 [ 88  51]]
Validation f1: 34.34
Validation accuracy: 63.55
Validation recall: 36.69
Validation precision: 32.28
Validation AUC: 0.3440197838291161
Validation class accuracies: [0.7297979797979798, 0.3669064748201439]
TARGET: 1
target metric(test f1): 0.3434343434343434
column_sums: [377 158]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.39375 hasn't increased by 0 in 16 epochs
Epoch 41/80
297/297 - 585s - loss: 0.1930 - accuracy: 0.9236 - val_loss: 1.0820 - val_accuracy: 0.6168
Confusion matrix: 
 [[275 121]
 [ 84  55]]
Validation f1: 34.92
Validation accuracy: 61.68
Validation recall: 39.57
Validation precision: 31.25
Validation AUC: 0.3440829235920909
Validation class accuracies: [0.6944444444444444, 0.39568345323741005]
TARGET: 1
target metric(test f1): 0.3492063492063492
column_sums: [359 176]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 17 epochs
Epoch 42/80
297/297 - 585s - loss: 0.1909 - accuracy: 0.9238 - val_loss: 1.0538 - val_accuracy: 0.6336
Confusion matrix: 
 [[288 108]
 [ 88  51]]
Validation f1: 34.23
Validation accuracy: 63.36
Validation recall: 36.69
Validation precision: 32.08
Validation AUC: 0.34188084558375775
Validation class accuracies: [0.7272727272727273, 0.3669064748201439]
TARGET: 1
target metric(test f1): 0.3422818791946309
column_sums: [376 159]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 18 epochs
Epoch 43/80
297/297 - 584s - loss: 0.1898 - accuracy: 0.9250 - val_loss: 1.0697 - val_accuracy: 0.6299
Confusion matrix: 
 [[283 113]
 [ 85  54]]
Validation f1: 35.29
Validation accuracy: 62.99
Validation recall: 38.85
Validation precision: 32.34
Validation AUC: 0.34566501746530004
Validation class accuracies: [0.7146464646464646, 0.38848920863309355]
TARGET: 1
target metric(test f1): 0.35294117647058826
column_sums: [368 167]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 19 epochs
Epoch 44/80
297/297 - 585s - loss: 0.1956 - accuracy: 0.9202 - val_loss: 1.0402 - val_accuracy: 0.6299
Confusion matrix: 
 [[284 112]
 [ 86  53]]
Validation f1: 34.87
Validation accuracy: 62.99
Validation recall: 38.13
Validation precision: 32.12
Validation AUC: 0.3477540834034881
Validation class accuracies: [0.7171717171717171, 0.381294964028777]
TARGET: 1
target metric(test f1): 0.3486842105263158
column_sums: [370 165]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.39375 hasn't increased by 0 in 20 epochs
Epoch 45/80
297/297 - 586s - loss: 0.1821 - accuracy: 0.9259 - val_loss: 1.0194 - val_accuracy: 0.6598
Confusion matrix: 
 [[310  86]
 [ 96  43]]
Validation f1: 32.09
Validation accuracy: 65.98
Validation recall: 30.94
Validation precision: 33.33
Validation AUC: 0.34072881328238436
Validation class accuracies: [0.7828282828282829, 0.30935251798561153]
TARGET: 1
target metric(test f1): 0.3208955223880597
column_sums: [406 129]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 21 epochs
Epoch 46/80
297/297 - 585s - loss: 0.1986 - accuracy: 0.9223 - val_loss: 1.0304 - val_accuracy: 0.6449
Confusion matrix: 
 [[297  99]
 [ 91  48]]
Validation f1: 33.57
Validation accuracy: 64.49
Validation recall: 34.53
Validation precision: 32.65
Validation AUC: 0.34142231953618757
Validation class accuracies: [0.75, 0.34532374100719426]
TARGET: 1
target metric(test f1): 0.3356643356643357
column_sums: [388 147]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 22 epochs
Epoch 47/80
297/297 - 585s - loss: 0.1843 - accuracy: 0.9318 - val_loss: 1.0429 - val_accuracy: 0.6411
Confusion matrix: 
 [[292 104]
 [ 88  51]]
Validation f1: 34.69
Validation accuracy: 64.11
Validation recall: 36.69
Validation precision: 32.90
Validation AUC: 0.3434494565915699
Validation class accuracies: [0.7373737373737373, 0.3669064748201439]
TARGET: 1
target metric(test f1): 0.3469387755102041
column_sums: [380 155]
cm_sum: 535
inside not defaulting
The validation tracker metric at 0.39375 hasn't increased by 0 in 23 epochs
Epoch 48/80
297/297 - 585s - loss: 0.1966 - accuracy: 0.9248 - val_loss: 1.0347 - val_accuracy: 0.6393
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[291 105]
 [ 88  51]]
Validation f1: 34.58
Validation accuracy: 63.93
Validation recall: 36.69
Validation precision: 32.69
Validation AUC: 0.3459190922689114
Validation class accuracies: [0.7348484848484849, 0.3669064748201439]
TARGET: 1
target metric(test f1): 0.34576271186440677
column_sums: [379 156]
cm_sum: 535
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.39375 hasn't increased by 0 in 24 epochs
Epoch 49/80
297/297 - 587s - loss: 0.1984 - accuracy: 0.9259 - val_loss: 1.0671 - val_accuracy: 0.6262
Confusion matrix: 
 [[281 115]
 [ 85  54]]
Validation f1: 35.06
Validation accuracy: 62.62
Validation recall: 38.85
Validation precision: 31.95
Validation AUC: 0.34870108877455075
Validation class accuracies: [0.7095959595959596, 0.38848920863309355]

The metrics for the epoch with the best target metric are: 
Best cm: [[278 118]
 [ 76  63]]
Best f1: 0.39375
Best accuracy: 0.6373831775700934
Best recall: 0.45323741007194246
Best precision: 0.34806629834254144
Best AUC: 0.3736226510013736
Best epoch: 21
TARGET: 1
target metric(test f1): 0.35064935064935066
column_sums: [366 169]
cm_sum: 535
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 15
Starting...
CM: [[ 8 19]
 [ 5  6]]
F1: 0.3333333333333333
AUC: 0.4585167464114832
Accuracy: 0.3684210526315789
Precision: 0.24
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_15.xls...
Done.
Epoch: 15
Starting...
CM: [[17 10]
 [ 9  2]]
F1: 0.17391304347826086
AUC: 0.2926634768740032
Accuracy: 0.5
Precision: 0.16666666666666666
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_15.xls...
Done.
Epoch: 15
Starting...
CM: [[20  7]
 [ 9  2]]
F1: 0.19999999999999998
AUC: 0.32044125465178097
Accuracy: 0.5789473684210527
Precision: 0.2222222222222222
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_15.xls...
Done.
Epoch: 18
Starting...
CM: [[10 17]
 [ 3  8]]
F1: 0.4444444444444444
AUC: 0.56311004784689
Accuracy: 0.47368421052631576
Precision: 0.32
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_18.xls...
Done.
Epoch: 18
Starting...
CM: [[18  9]
 [ 7  4]]
F1: 0.33333333333333337
AUC: 0.4277695988222304
Accuracy: 0.5789473684210527
Precision: 0.3076923076923077
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_18.xls...
Done.
Epoch: 18
Starting...
CM: [[24  3]
 [ 9  2]]
F1: 0.25000000000000006
AUC: 0.4093301435406698
Accuracy: 0.6842105263157895
Precision: 0.4
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_18.xls...
Done.
Epoch: 21
Starting...
CM: [[ 8 19]
 [ 2  9]]
F1: 0.46153846153846156
AUC: 0.596120984278879
Accuracy: 0.4473684210526316
Precision: 0.32142857142857145
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_21.xls...
Done.
Epoch: 21
Starting...
CM: [[12 15]
 [ 4  7]]
F1: 0.4242424242424242
AUC: 0.5299043062200957
Accuracy: 0.5
Precision: 0.3181818181818182
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_21.xls...
Done.
Epoch: 21
Starting...
CM: [[16 11]
 [ 5  6]]
F1: 0.42857142857142855
AUC: 0.5149873346467774
Accuracy: 0.5789473684210527
Precision: 0.35294117647058826
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_21.xls...
Done.
Epoch: 80
Starting...
CM: [[ 4 23]
 [ 1 10]]
F1: 0.45454545454545453
AUC: 0.6192185007974481
Accuracy: 0.3684210526315789
Precision: 0.30303030303030304
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_80.xls...
Done.
Epoch: 80
Starting...
CM: [[13 14]
 [ 4  7]]
F1: 0.43749999999999994
AUC: 0.5374800637958532
Accuracy: 0.5263157894736842
Precision: 0.3333333333333333
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_80.xls...
Done.
Epoch: 80
Starting...
CM: [[17 10]
 [ 7  4]]
F1: 0.32
AUC: 0.41678058783321936
Accuracy: 0.5526315789473685
Precision: 0.2857142857142857
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_6_80.xls...
Done.
K-Fold split N: 7
With concat = False and six = False, size of training set: 4750...
...and size of validation set: 534
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_86 (InputLayer)           [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_510 (BatchN (None, 128, 1250, 1) 4           input_86[0][0]                   
__________________________________________________________________________________________________
conv2d_425 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_510[0][0]    
__________________________________________________________________________________________________
conv2d_427 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_510[0][0]    
__________________________________________________________________________________________________
max_pooling2d_85 (MaxPooling2D) (None, 128, 1250, 1) 0           batch_normalization_510[0][0]    
__________________________________________________________________________________________________
conv2d_426 (Conv2D)             (None, 128, 1250, 16 2320        conv2d_425[0][0]                 
__________________________________________________________________________________________________
conv2d_428 (Conv2D)             (None, 128, 1250, 16 6416        conv2d_427[0][0]                 
__________________________________________________________________________________________________
conv2d_429 (Conv2D)             (None, 128, 1250, 16 32          max_pooling2d_85[0][0]           
__________________________________________________________________________________________________
concatenate_85 (Concatenate)    (None, 128, 1250, 48 0           conv2d_426[0][0]                 
                                                                 conv2d_428[0][0]                 
                                                                 conv2d_429[0][0]                 
__________________________________________________________________________________________________
average_pooling2d_425 (AverageP (None, 64, 625, 48)  0           concatenate_85[0][0]             
__________________________________________________________________________________________________
batch_normalization_511 (BatchN (None, 64, 625, 48)  192         average_pooling2d_425[0][0]      
__________________________________________________________________________________________________
dropout_425 (Dropout)           (None, 64, 625, 48)  0           batch_normalization_511[0][0]    
__________________________________________________________________________________________________
inverted_residual_850 (Inverted (None, 64, 625, 32)  35840       dropout_425[0][0]                
__________________________________________________________________________________________________
inverted_residual_851 (Inverted (None, 64, 625, 32)  20864       inverted_residual_850[0][0]      
__________________________________________________________________________________________________
average_pooling2d_426 (AverageP (None, 32, 312, 32)  0           inverted_residual_851[0][0]      
__________________________________________________________________________________________________
batch_normalization_512 (BatchN (None, 32, 312, 32)  128         average_pooling2d_426[0][0]      
__________________________________________________________________________________________________
dropout_426 (Dropout)           (None, 32, 312, 32)  0           batch_normalization_512[0][0]    
__________________________________________________________________________________________________
inverted_residual_852 (Inverted (None, 32, 312, 64)  27136       dropout_426[0][0]                
__________________________________________________________________________________________________
inverted_residual_853 (Inverted (None, 32, 312, 64)  66304       inverted_residual_852[0][0]      
__________________________________________________________________________________________________
average_pooling2d_427 (AverageP (None, 16, 156, 64)  0           inverted_residual_853[0][0]      
__________________________________________________________________________________________________
batch_normalization_513 (BatchN (None, 16, 156, 64)  256         average_pooling2d_427[0][0]      
__________________________________________________________________________________________________
dropout_427 (Dropout)           (None, 16, 156, 64)  0           batch_normalization_513[0][0]    
__________________________________________________________________________________________________
inverted_residual_854 (Inverted (None, 16, 156, 128) 91136       dropout_427[0][0]                
__________________________________________________________________________________________________
inverted_residual_855 (Inverted (None, 16, 156, 128) 230912      inverted_residual_854[0][0]      
__________________________________________________________________________________________________
average_pooling2d_428 (AverageP (None, 8, 78, 128)   0           inverted_residual_855[0][0]      
__________________________________________________________________________________________________
batch_normalization_514 (BatchN (None, 8, 78, 128)   512         average_pooling2d_428[0][0]      
__________________________________________________________________________________________________
dropout_428 (Dropout)           (None, 8, 78, 128)   0           batch_normalization_514[0][0]    
__________________________________________________________________________________________________
inverted_residual_856 (Inverted (None, 8, 78, 256)   329728      dropout_428[0][0]                
__________________________________________________________________________________________________
inverted_residual_857 (Inverted (None, 8, 78, 256)   855040      inverted_residual_856[0][0]      
__________________________________________________________________________________________________
average_pooling2d_429 (AverageP (None, 4, 39, 256)   0           inverted_residual_857[0][0]      
__________________________________________________________________________________________________
batch_normalization_515 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_429[0][0]      
__________________________________________________________________________________________________
dropout_429 (Dropout)           (None, 4, 39, 256)   0           batch_normalization_515[0][0]    
__________________________________________________________________________________________________
inverted_residual_858 (Inverted (None, 4, 39, 512)   1249280     dropout_429[0][0]                
__________________________________________________________________________________________________
inverted_residual_859 (Inverted (None, 4, 39, 512)   3282944     inverted_residual_858[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_85 (Gl (None, 512)          0           inverted_residual_859[0][0]      
__________________________________________________________________________________________________
dense_85 (Dense)                (None, 1)            513         global_average_pooling2d_85[0][0]
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
297/297 - 581s - loss: 0.6689 - accuracy: 0.7204 - val_loss: 0.9850 - val_accuracy: 0.7266
Confusion matrix: 
 [[388   0]
 [146   0]]
Validation f1: 0.00
Validation accuracy: 72.66
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24011099363182153
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [534   0]
cm_sum: 534
The training is defaulting to either class.
Epoch 2/80
297/297 - 576s - loss: 0.5732 - accuracy: 0.7385 - val_loss: 0.6378 - val_accuracy: 0.7266
Confusion matrix: 
 [[388   0]
 [146   0]]
Validation f1: 0.00
Validation accuracy: 72.66
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.35442117601714596
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [534   0]
cm_sum: 534
The training is defaulting to either class.
Epoch 3/80
297/297 - 577s - loss: 0.5697 - accuracy: 0.7373 - val_loss: 0.6552 - val_accuracy: 0.7266
Confusion matrix: 
 [[388   0]
 [146   0]]
Validation f1: 0.00
Validation accuracy: 72.66
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.35765816323498
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [534   0]
cm_sum: 534
The training is defaulting to either class.
Epoch 4/80
297/297 - 576s - loss: 0.5653 - accuracy: 0.7398 - val_loss: 0.5909 - val_accuracy: 0.7210
Confusion matrix: 
 [[378  10]
 [139   7]]
Validation f1: 8.59
Validation accuracy: 72.10
Validation recall: 4.79
Validation precision: 41.18
Validation AUC: 0.35598280790282
Validation class accuracies: [0.9742268041237113, 0.04794520547945205]
TARGET: 1
target metric(test f1): 0.08588957055214724
column_sums: [517  17]
cm_sum: 534
The training is defaulting to either class.
Epoch 5/80
297/297 - 577s - loss: 0.5638 - accuracy: 0.7398 - val_loss: 0.5915 - val_accuracy: 0.7247
Confusion matrix: 
 [[384   4]
 [143   3]]
Validation f1: 3.92
Validation accuracy: 72.47
Validation recall: 2.05
Validation precision: 42.86
Validation AUC: 0.3156776422321709
Validation class accuracies: [0.9896907216494846, 0.02054794520547945]
TARGET: 1
target metric(test f1): 0.0392156862745098
column_sums: [527   7]
cm_sum: 534
The training is defaulting to either class.
Epoch 6/80
297/297 - 576s - loss: 0.5621 - accuracy: 0.7404 - val_loss: 0.6285 - val_accuracy: 0.6835
Confusion matrix: 
 [[343  45]
 [124  22]]
Validation f1: 20.66
Validation accuracy: 68.35
Validation recall: 15.07
Validation precision: 32.84
Validation AUC: 0.34032064907607806
Validation class accuracies: [0.884020618556701, 0.1506849315068493]
TARGET: 1
target metric(test f1): 0.20657276995305163
column_sums: [467  67]
cm_sum: 534
inside not defaulting
Saving model...
Epoch 7/80
297/297 - 577s - loss: 0.5599 - accuracy: 0.7406 - val_loss: 0.5897 - val_accuracy: 0.7322
Confusion matrix: 
 [[384   4]
 [139   7]]
Validation f1: 8.92
Validation accuracy: 73.22
Validation recall: 4.79
Validation precision: 63.64
Validation AUC: 0.337660182446348
Validation class accuracies: [0.9896907216494846, 0.04794520547945205]
TARGET: 1
target metric(test f1): 0.08917197452229299
column_sums: [523  11]
cm_sum: 534
The training is defaulting to either class.
Epoch 8/80
297/297 - 576s - loss: 0.5549 - accuracy: 0.7404 - val_loss: 0.6247 - val_accuracy: 0.7210
Confusion matrix: 
 [[370  18]
 [131  15]]
Validation f1: 16.76
Validation accuracy: 72.10
Validation recall: 10.27
Validation precision: 45.45
Validation AUC: 0.3332959629801867
Validation class accuracies: [0.9536082474226805, 0.10273972602739725]
TARGET: 1
target metric(test f1): 0.16759776536312848
column_sums: [501  33]
cm_sum: 534
The training is defaulting to either class.
Epoch 9/80
297/297 - 576s - loss: 0.5527 - accuracy: 0.7411 - val_loss: 0.6693 - val_accuracy: 0.6835
Confusion matrix: 
 [[337  51]
 [118  28]]
Validation f1: 24.89
Validation accuracy: 68.35
Validation recall: 19.18
Validation precision: 35.44
Validation AUC: 0.2829631673543987
Validation class accuracies: [0.8685567010309279, 0.1917808219178082]
TARGET: 1
target metric(test f1): 0.2488888888888889
column_sums: [455  79]
cm_sum: 534
inside not defaulting
Saving model...
Epoch 10/80
297/297 - 577s - loss: 0.5489 - accuracy: 0.7417 - val_loss: 0.6768 - val_accuracy: 0.7172
Confusion matrix: 
 [[378  10]
 [141   5]]
Validation f1: 6.21
Validation accuracy: 71.72
Validation recall: 3.42
Validation precision: 33.33
Validation AUC: 0.2800648560523543
Validation class accuracies: [0.9742268041237113, 0.03424657534246575]
TARGET: 1
target metric(test f1): 0.06211180124223603
column_sums: [519  15]
cm_sum: 534
The training is defaulting to either class.
Epoch 11/80
297/297 - 576s - loss: 0.5451 - accuracy: 0.7408 - val_loss: 0.6731 - val_accuracy: 0.7266
Confusion matrix: 
 [[387   1]
 [145   1]]
Validation f1: 1.35
Validation accuracy: 72.66
Validation recall: 0.68
Validation precision: 50.00
Validation AUC: 0.2808874223140388
Validation class accuracies: [0.9974226804123711, 0.00684931506849315]
TARGET: 1
target metric(test f1): 0.013513513513513513
column_sums: [532   2]
cm_sum: 534
The training is defaulting to either class.
Epoch 12/80
297/297 - 577s - loss: 0.5394 - accuracy: 0.7436 - val_loss: 0.6375 - val_accuracy: 0.7285
Confusion matrix: 
 [[374  14]
 [131  15]]
Validation f1: 17.14
Validation accuracy: 72.85
Validation recall: 10.27
Validation precision: 51.72
Validation AUC: 0.3276310142669745
Validation class accuracies: [0.9639175257731959, 0.10273972602739725]
TARGET: 1
target metric(test f1): 0.17142857142857143
column_sums: [505  29]
cm_sum: 534
The training is defaulting to either class.
Epoch 13/80
297/297 - 576s - loss: 0.5375 - accuracy: 0.7436 - val_loss: 0.8097 - val_accuracy: 0.7228
Confusion matrix: 
 [[384   4]
 [144   2]]
Validation f1: 2.63
Validation accuracy: 72.28
Validation recall: 1.37
Validation precision: 33.33
Validation AUC: 0.30897927776303336
Validation class accuracies: [0.9896907216494846, 0.0136986301369863]
TARGET: 1
target metric(test f1): 0.02631578947368421
column_sums: [528   6]
cm_sum: 534
The training is defaulting to either class.
Epoch 14/80
297/297 - 576s - loss: 0.5309 - accuracy: 0.7488 - val_loss: 0.5952 - val_accuracy: 0.7491
Confusion matrix: 
 [[371  17]
 [117  29]]
Validation f1: 30.21
Validation accuracy: 74.91
Validation recall: 19.86
Validation precision: 63.04
Validation AUC: 0.42035895304320225
Validation class accuracies: [0.9561855670103093, 0.19863013698630136]
TARGET: 1
target metric(test f1): 0.3020833333333333
column_sums: [488  46]
cm_sum: 534
The training is defaulting to either class.
Epoch 15/80
297/297 - 577s - loss: 0.5228 - accuracy: 0.7495 - val_loss: 0.7246 - val_accuracy: 0.6442
Confusion matrix: 
 [[316  72]
 [118  28]]
Validation f1: 22.76
Validation accuracy: 64.42
Validation recall: 19.18
Validation precision: 28.00
Validation AUC: 0.2924628675999338
Validation class accuracies: [0.8144329896907216, 0.1917808219178082]
TARGET: 1
target metric(test f1): 0.22764227642276422
column_sums: [434 100]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.2488888888888889 hasn't increased by 0 in 1 epochs
Epoch 16/80
297/297 - 577s - loss: 0.5192 - accuracy: 0.7564 - val_loss: 0.6372 - val_accuracy: 0.7378
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[380   8]
 [132  14]]
Validation f1: 16.67
Validation accuracy: 73.78
Validation recall: 9.59
Validation precision: 63.64
Validation AUC: 0.37665744747920027
Validation class accuracies: [0.979381443298969, 0.0958904109589041]
TARGET: 1
target metric(test f1): 0.16666666666666663
column_sums: [512  22]
cm_sum: 534
The training is defaulting to either class.
Epoch 17/80
297/297 - 576s - loss: 0.5031 - accuracy: 0.7619 - val_loss: 0.7794 - val_accuracy: 0.6667
Confusion matrix: 
 [[319  69]
 [109  37]]
Validation f1: 29.37
Validation accuracy: 66.67
Validation recall: 25.34
Validation precision: 34.91
Validation AUC: 0.28745298682172127
Validation class accuracies: [0.8221649484536082, 0.2534246575342466]
TARGET: 1
target metric(test f1): 0.29365079365079366
column_sums: [428 106]
cm_sum: 534
inside not defaulting
Saving model...
Epoch 18/80
297/297 - 575s - loss: 0.4959 - accuracy: 0.7669 - val_loss: 0.6925 - val_accuracy: 0.7285
Confusion matrix: 
 [[388   0]
 [145   1]]
Validation f1: 1.36
Validation accuracy: 72.85
Validation recall: 0.68
Validation precision: 100.00
Validation AUC: 0.28686593450190845
Validation class accuracies: [1.0, 0.00684931506849315]
TARGET: 1
target metric(test f1): 0.013605442176870748
column_sums: [533   1]
cm_sum: 534
The training is defaulting to either class.
Epoch 19/80
297/297 - 577s - loss: 0.4841 - accuracy: 0.7728 - val_loss: 0.7413 - val_accuracy: 0.7434
Confusion matrix: 
 [[383   5]
 [132  14]]
Validation f1: 16.97
Validation accuracy: 74.34
Validation recall: 9.59
Validation precision: 73.68
Validation AUC: 0.37487814581263323
Validation class accuracies: [0.9871134020618557, 0.0958904109589041]
TARGET: 1
target metric(test f1): 0.16969696969696968
column_sums: [515  19]
cm_sum: 534
The training is defaulting to either class.
Epoch 20/80
297/297 - 577s - loss: 0.4668 - accuracy: 0.7836 - val_loss: 0.8111 - val_accuracy: 0.7097
Confusion matrix: 
 [[359  29]
 [126  20]]
Validation f1: 20.51
Validation accuracy: 70.97
Validation recall: 13.70
Validation precision: 40.82
Validation AUC: 0.3148598970083656
Validation class accuracies: [0.9252577319587629, 0.136986301369863]
TARGET: 1
target metric(test f1): 0.20512820512820512
column_sums: [485  49]
cm_sum: 534
The training is defaulting to either class.
Epoch 21/80
297/297 - 577s - loss: 0.4537 - accuracy: 0.7861 - val_loss: 0.9360 - val_accuracy: 0.5749
Confusion matrix: 
 [[242 146]
 [ 81  65]]
Validation f1: 36.41
Validation accuracy: 57.49
Validation recall: 44.52
Validation precision: 30.81
Validation AUC: 0.3575996513089834
Validation class accuracies: [0.6237113402061856, 0.4452054794520548]
TARGET: 1
target metric(test f1): 0.36414565826330536
column_sums: [323 211]
cm_sum: 534
inside not defaulting
Saving model...
Epoch 22/80
297/297 - 576s - loss: 0.4305 - accuracy: 0.8059 - val_loss: 0.7761 - val_accuracy: 0.6873
Confusion matrix: 
 [[322  66]
 [101  45]]
Validation f1: 35.02
Validation accuracy: 68.73
Validation recall: 30.82
Validation precision: 40.54
Validation AUC: 0.39506720460540135
Validation class accuracies: [0.8298969072164949, 0.3082191780821918]
TARGET: 1
target metric(test f1): 0.3501945525291829
column_sums: [423 111]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.36414565826330536 hasn't increased by 0 in 1 epochs
Epoch 23/80
297/297 - 577s - loss: 0.4061 - accuracy: 0.8217 - val_loss: 0.8145 - val_accuracy: 0.7247
Confusion matrix: 
 [[375  13]
 [134  12]]
Validation f1: 14.04
Validation accuracy: 72.47
Validation recall: 8.22
Validation precision: 48.00
Validation AUC: 0.3309305643724203
Validation class accuracies: [0.9664948453608248, 0.0821917808219178]
TARGET: 1
target metric(test f1): 0.14035087719298245
column_sums: [509  25]
cm_sum: 534
The training is defaulting to either class.
Epoch 24/80
297/297 - 576s - loss: 0.3735 - accuracy: 0.8375 - val_loss: 0.8892 - val_accuracy: 0.7285
Confusion matrix: 
 [[382   6]
 [139   7]]
Validation f1: 8.81
Validation accuracy: 72.85
Validation recall: 4.79
Validation precision: 53.85
Validation AUC: 0.3388918008475706
Validation class accuracies: [0.9845360824742269, 0.04794520547945205]
TARGET: 1
target metric(test f1): 0.0880503144654088
column_sums: [521  13]
cm_sum: 534
The training is defaulting to either class.
Epoch 25/80
297/297 - 576s - loss: 0.3529 - accuracy: 0.8478 - val_loss: 1.1929 - val_accuracy: 0.5768
Confusion matrix: 
 [[250 138]
 [ 88  58]]
Validation f1: 33.92
Validation accuracy: 57.68
Validation recall: 39.73
Validation precision: 29.59
Validation AUC: 0.3198145121047214
Validation class accuracies: [0.6443298969072165, 0.3972602739726027]
TARGET: 1
target metric(test f1): 0.3391812865497076
column_sums: [338 196]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.36414565826330536 hasn't increased by 0 in 2 epochs
Epoch 26/80
297/297 - 576s - loss: 0.3281 - accuracy: 0.8623 - val_loss: 1.0736 - val_accuracy: 0.5768
Confusion matrix: 
 [[238 150]
 [ 76  70]]
Validation f1: 38.25
Validation accuracy: 57.68
Validation recall: 47.95
Validation precision: 31.82
Validation AUC: 0.36741440308581025
Validation class accuracies: [0.6134020618556701, 0.4794520547945205]
TARGET: 1
target metric(test f1): 0.38251366120218583
column_sums: [314 220]
cm_sum: 534
inside not defaulting
Saving model...
Epoch 27/80
297/297 - 576s - loss: 0.2982 - accuracy: 0.8787 - val_loss: 0.8162 - val_accuracy: 0.6816
Confusion matrix: 
 [[331  57]
 [113  33]]
Validation f1: 27.97
Validation accuracy: 68.16
Validation recall: 22.60
Validation precision: 36.67
Validation AUC: 0.3714949177307303
Validation class accuracies: [0.8530927835051546, 0.22602739726027396]
TARGET: 1
target metric(test f1): 0.2796610169491526
column_sums: [444  90]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.38251366120218583 hasn't increased by 0 in 1 epochs
Epoch 28/80
297/297 - 577s - loss: 0.2569 - accuracy: 0.8966 - val_loss: 0.9580 - val_accuracy: 0.6854
Confusion matrix: 
 [[331  57]
 [111  35]]
Validation f1: 29.41
Validation accuracy: 68.54
Validation recall: 23.97
Validation precision: 38.04
Validation AUC: 0.3513718596203877
Validation class accuracies: [0.8530927835051546, 0.23972602739726026]
TARGET: 1
target metric(test f1): 0.29411764705882354
column_sums: [442  92]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.38251366120218583 hasn't increased by 0 in 2 epochs
Epoch 29/80
297/297 - 576s - loss: 0.2415 - accuracy: 0.9042 - val_loss: 1.3786 - val_accuracy: 0.5412
Confusion matrix: 
 [[208 180]
 [ 65  81]]
Validation f1: 39.80
Validation accuracy: 54.12
Validation recall: 55.48
Validation precision: 31.03
Validation AUC: 0.34904138019116826
Validation class accuracies: [0.5360824742268041, 0.5547945205479452]
TARGET: 1
target metric(test f1): 0.39803439803439805
column_sums: [273 261]
cm_sum: 534
inside not defaulting
Saving model...
Epoch 30/80
297/297 - 583s - loss: 0.2260 - accuracy: 0.9086 - val_loss: 1.2706 - val_accuracy: 0.7022
Confusion matrix: 
 [[360  28]
 [131  15]]
Validation f1: 15.87
Validation accuracy: 70.22
Validation recall: 10.27
Validation precision: 34.88
Validation AUC: 0.308729498393399
Validation class accuracies: [0.9278350515463918, 0.10273972602739725]
TARGET: 1
target metric(test f1): 0.15873015873015872
column_sums: [491  43]
cm_sum: 534
The training is defaulting to either class.
Epoch 31/80
297/297 - 579s - loss: 0.2025 - accuracy: 0.9208 - val_loss: 0.9757 - val_accuracy: 0.6479
Confusion matrix: 
 [[295  93]
 [ 95  51]]
Validation f1: 35.17
Validation accuracy: 64.79
Validation recall: 34.93
Validation precision: 35.42
Validation AUC: 0.38918753685492613
Validation class accuracies: [0.7603092783505154, 0.3493150684931507]
TARGET: 1
target metric(test f1): 0.3517241379310345
column_sums: [390 144]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.39803439803439805 hasn't increased by 0 in 1 epochs
Epoch 32/80
297/297 - 581s - loss: 0.1878 - accuracy: 0.9299 - val_loss: 2.0295 - val_accuracy: 0.4944
Confusion matrix: 
 [[174 214]
 [ 56  90]]
Validation f1: 40.00
Validation accuracy: 49.44
Validation recall: 61.64
Validation precision: 29.61
Validation AUC: 0.33239463361882804
Validation class accuracies: [0.4484536082474227, 0.6164383561643836]
TARGET: 1
target metric(test f1): 0.39999999999999997
column_sums: [230 304]
cm_sum: 534
inside not defaulting
Saving model...
Epoch 33/80
297/297 - 582s - loss: 0.1715 - accuracy: 0.9286 - val_loss: 1.4902 - val_accuracy: 0.6124
Confusion matrix: 
 [[263 125]
 [ 82  64]]
Validation f1: 38.21
Validation accuracy: 61.24
Validation recall: 43.84
Validation precision: 33.86
Validation AUC: 0.3456908272019811
Validation class accuracies: [0.6778350515463918, 0.4383561643835616]
TARGET: 1
target metric(test f1): 0.382089552238806
column_sums: [345 189]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 1 epochs
Epoch 34/80
297/297 - 582s - loss: 0.1515 - accuracy: 0.9371 - val_loss: 1.3655 - val_accuracy: 0.6367
Confusion matrix: 
 [[286 102]
 [ 92  54]]
Validation f1: 35.76
Validation accuracy: 63.67
Validation recall: 36.99
Validation precision: 34.62
Validation AUC: 0.37967853370060406
Validation class accuracies: [0.7371134020618557, 0.3698630136986301]
TARGET: 1
target metric(test f1): 0.35761589403973504
column_sums: [378 156]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 2 epochs
Epoch 35/80
297/297 - 580s - loss: 0.1455 - accuracy: 0.9444 - val_loss: 1.4018 - val_accuracy: 0.5974
Confusion matrix: 
 [[233 155]
 [ 60  86]]
Validation f1: 44.44
Validation accuracy: 59.74
Validation recall: 58.90
Validation precision: 35.68
Validation AUC: 0.43693450514614285
Validation class accuracies: [0.6005154639175257, 0.589041095890411]
TARGET: 1
target metric(test f1): 0.4444444444444445
column_sums: [293 241]
cm_sum: 534
inside not defaulting
Saving model...
Epoch 36/80
297/297 - 580s - loss: 0.1120 - accuracy: 0.9575 - val_loss: 1.3242 - val_accuracy: 0.6067
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[271 117]
 [ 93  53]]
Validation f1: 33.54
Validation accuracy: 60.67
Validation recall: 36.30
Validation precision: 31.18
Validation AUC: 0.34127097312510235
Validation class accuracies: [0.6984536082474226, 0.363013698630137]
TARGET: 1
target metric(test f1): 0.33544303797468356
column_sums: [364 170]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 1 epochs
Epoch 37/80
297/297 - 580s - loss: 0.1159 - accuracy: 0.9577 - val_loss: 1.4591 - val_accuracy: 0.6592
Confusion matrix: 
 [[315  73]
 [109  37]]
Validation f1: 28.91
Validation accuracy: 65.92
Validation recall: 25.34
Validation precision: 33.64
Validation AUC: 0.32597557475924843
Validation class accuracies: [0.8118556701030928, 0.2534246575342466]
TARGET: 1
target metric(test f1): 0.2890625
column_sums: [424 110]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 2 epochs
Epoch 38/80
297/297 - 583s - loss: 0.1052 - accuracy: 0.9621 - val_loss: 1.7239 - val_accuracy: 0.5787
Confusion matrix: 
 [[236 152]
 [ 73  73]]
Validation f1: 39.35
Validation accuracy: 57.87
Validation recall: 50.00
Validation precision: 32.44
Validation AUC: 0.31857937935305075
Validation class accuracies: [0.6082474226804123, 0.5]
TARGET: 1
target metric(test f1): 0.3935309973045822
column_sums: [309 225]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 3 epochs
Epoch 39/80
297/297 - 582s - loss: 0.1070 - accuracy: 0.9585 - val_loss: 1.5257 - val_accuracy: 0.6985
Confusion matrix: 
 [[355  33]
 [128  18]]
Validation f1: 18.27
Validation accuracy: 69.85
Validation recall: 12.33
Validation precision: 35.29
Validation AUC: 0.3339459251237366
Validation class accuracies: [0.9149484536082474, 0.1232876712328767]
TARGET: 1
target metric(test f1): 0.18274111675126903
column_sums: [483  51]
cm_sum: 534
The training is defaulting to either class.
Epoch 40/80
297/297 - 581s - loss: 0.0897 - accuracy: 0.9653 - val_loss: 1.8069 - val_accuracy: 0.5843
Confusion matrix: 
 [[247 141]
 [ 81  65]]
Validation f1: 36.93
Validation accuracy: 58.43
Validation recall: 44.52
Validation precision: 31.55
Validation AUC: 0.3141834392972096
Validation class accuracies: [0.6365979381443299, 0.4452054794520548]
TARGET: 1
target metric(test f1): 0.3693181818181818
column_sums: [328 206]
cm_sum: 534
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 4 epochs
Epoch 41/80
297/297 - 582s - loss: 0.0639 - accuracy: 0.9766 - val_loss: 1.4335 - val_accuracy: 0.6592
Confusion matrix: 
 [[313  75]
 [107  39]]
Validation f1: 30.00
Validation accuracy: 65.92
Validation recall: 26.71
Validation precision: 34.21
Validation AUC: 0.3230546563883584
Validation class accuracies: [0.8067010309278351, 0.2671232876712329]
TARGET: 1
target metric(test f1): 0.30000000000000004
column_sums: [420 114]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 5 epochs
Epoch 42/80
297/297 - 582s - loss: 0.0427 - accuracy: 0.9863 - val_loss: 1.6383 - val_accuracy: 0.5993
Confusion matrix: 
 [[262 126]
 [ 88  58]]
Validation f1: 35.15
Validation accuracy: 59.93
Validation recall: 39.73
Validation precision: 31.52
Validation AUC: 0.32591120801652357
Validation class accuracies: [0.6752577319587629, 0.3972602739726027]
TARGET: 1
target metric(test f1): 0.3515151515151515
column_sums: [350 184]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 6 epochs
Epoch 43/80
297/297 - 582s - loss: 0.0481 - accuracy: 0.9829 - val_loss: 1.5297 - val_accuracy: 0.6517
Confusion matrix: 
 [[309  79]
 [107  39]]
Validation f1: 29.55
Validation accuracy: 65.17
Validation recall: 26.71
Validation precision: 33.05
Validation AUC: 0.3335153691964756
Validation class accuracies: [0.7963917525773195, 0.2671232876712329]
TARGET: 1
target metric(test f1): 0.29545454545454547
column_sums: [416 118]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 7 epochs
Epoch 44/80
297/297 - 583s - loss: 0.0413 - accuracy: 0.9874 - val_loss: 1.5790 - val_accuracy: 0.6217
Confusion matrix: 
 [[286 102]
 [100  46]]
Validation f1: 31.29
Validation accuracy: 62.17
Validation recall: 31.51
Validation precision: 31.08
Validation AUC: 0.31305208124441475
Validation class accuracies: [0.7371134020618557, 0.3150684931506849]
TARGET: 1
target metric(test f1): 0.3129251700680272
column_sums: [386 148]
cm_sum: 534
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 8 epochs
Epoch 45/80
297/297 - 582s - loss: 0.0337 - accuracy: 0.9909 - val_loss: 1.5576 - val_accuracy: 0.6124
Confusion matrix: 
 [[277 111]
 [ 96  50]]
Validation f1: 32.57
Validation accuracy: 61.24
Validation recall: 34.25
Validation precision: 31.06
Validation AUC: 0.32612583252540817
Validation class accuracies: [0.7139175257731959, 0.3424657534246575]
TARGET: 1
target metric(test f1): 0.3257328990228013
column_sums: [373 161]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 9 epochs
Epoch 46/80
297/297 - 582s - loss: 0.0376 - accuracy: 0.9891 - val_loss: 1.5704 - val_accuracy: 0.6161
Confusion matrix: 
 [[279 109]
 [ 96  50]]
Validation f1: 32.79
Validation accuracy: 61.61
Validation recall: 34.25
Validation precision: 31.45
Validation AUC: 0.32513671258296034
Validation class accuracies: [0.7190721649484536, 0.3424657534246575]
TARGET: 1
target metric(test f1): 0.32786885245901637
column_sums: [375 159]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 10 epochs
Epoch 47/80
297/297 - 581s - loss: 0.0408 - accuracy: 0.9861 - val_loss: 1.6419 - val_accuracy: 0.6049
Confusion matrix: 
 [[267 121]
 [ 90  56]]
Validation f1: 34.67
Validation accuracy: 60.49
Validation recall: 38.36
Validation precision: 31.64
Validation AUC: 0.32474404480795915
Validation class accuracies: [0.6881443298969072, 0.3835616438356164]
TARGET: 1
target metric(test f1): 0.34674922600619196
column_sums: [357 177]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 11 epochs
Epoch 48/80
297/297 - 580s - loss: 0.0363 - accuracy: 0.9872 - val_loss: 1.6165 - val_accuracy: 0.6236
Confusion matrix: 
 [[283 105]
 [ 96  50]]
Validation f1: 33.22
Validation accuracy: 62.36
Validation recall: 34.25
Validation precision: 32.26
Validation AUC: 0.3285321972595064
Validation class accuracies: [0.729381443298969, 0.3424657534246575]
TARGET: 1
target metric(test f1): 0.33222591362126247
column_sums: [379 155]
cm_sum: 534
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 12 epochs
Epoch 49/80
297/297 - 583s - loss: 0.0352 - accuracy: 0.9886 - val_loss: 1.6098 - val_accuracy: 0.6180
Confusion matrix: 
 [[282 106]
 [ 98  48]]
Validation f1: 32.00
Validation accuracy: 61.80
Validation recall: 32.88
Validation precision: 31.17
Validation AUC: 0.3317206397962029
Validation class accuracies: [0.7268041237113402, 0.3287671232876712]
TARGET: 1
target metric(test f1): 0.32
column_sums: [380 154]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 13 epochs
Epoch 50/80
297/297 - 582s - loss: 0.0335 - accuracy: 0.9878 - val_loss: 1.6299 - val_accuracy: 0.6142
Confusion matrix: 
 [[277 111]
 [ 95  51]]
Validation f1: 33.12
Validation accuracy: 61.42
Validation recall: 34.93
Validation precision: 31.48
Validation AUC: 0.32890687170003924
Validation class accuracies: [0.7139175257731959, 0.3493150684931507]
TARGET: 1
target metric(test f1): 0.33116883116883117
column_sums: [372 162]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 14 epochs
Epoch 51/80
297/297 - 582s - loss: 0.0323 - accuracy: 0.9895 - val_loss: 1.5901 - val_accuracy: 0.6273
Confusion matrix: 
 [[286 102]
 [ 97  49]]
Validation f1: 33.00
Validation accuracy: 62.73
Validation recall: 33.56
Validation precision: 32.45
Validation AUC: 0.33225714219628383
Validation class accuracies: [0.7371134020618557, 0.3356164383561644]
TARGET: 1
target metric(test f1): 0.32996632996632996
column_sums: [383 151]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 15 epochs
Epoch 52/80
297/297 - 581s - loss: 0.0306 - accuracy: 0.9907 - val_loss: 1.6008 - val_accuracy: 0.6311
Confusion matrix: 
 [[288 100]
 [ 97  49]]
Validation f1: 33.22
Validation accuracy: 63.11
Validation recall: 33.56
Validation precision: 32.89
Validation AUC: 0.3292327241304473
Validation class accuracies: [0.7422680412371134, 0.3356164383561644]
TARGET: 1
target metric(test f1): 0.33220338983050846
column_sums: [385 149]
cm_sum: 534
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 16 epochs
Epoch 53/80
297/297 - 581s - loss: 0.0337 - accuracy: 0.9880 - val_loss: 1.6282 - val_accuracy: 0.6124
Confusion matrix: 
 [[277 111]
 [ 96  50]]
Validation f1: 32.57
Validation accuracy: 61.24
Validation recall: 34.25
Validation precision: 31.06
Validation AUC: 0.33227890079143374
Validation class accuracies: [0.7139175257731959, 0.3424657534246575]
TARGET: 1
target metric(test f1): 0.3257328990228013
column_sums: [373 161]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 17 epochs
Epoch 54/80
297/297 - 581s - loss: 0.0355 - accuracy: 0.9888 - val_loss: 1.6248 - val_accuracy: 0.6180
Confusion matrix: 
 [[280 108]
 [ 96  50]]
Validation f1: 32.89
Validation accuracy: 61.80
Validation recall: 34.25
Validation precision: 31.65
Validation AUC: 0.32956014547299173
Validation class accuracies: [0.7216494845360825, 0.3424657534246575]
TARGET: 1
target metric(test f1): 0.32894736842105265
column_sums: [376 158]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 18 epochs
Epoch 55/80
297/297 - 582s - loss: 0.0335 - accuracy: 0.9888 - val_loss: 1.6046 - val_accuracy: 0.6292
Confusion matrix: 
 [[289  99]
 [ 99  47]]
Validation f1: 32.19
Validation accuracy: 62.92
Validation recall: 32.19
Validation precision: 32.19
Validation AUC: 0.33343933851147717
Validation class accuracies: [0.7448453608247423, 0.3219178082191781]
TARGET: 1
target metric(test f1): 0.3219178082191781
column_sums: [388 146]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 19 epochs
Epoch 56/80
297/297 - 582s - loss: 0.0292 - accuracy: 0.9905 - val_loss: 1.6194 - val_accuracy: 0.6180
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[280 108]
 [ 96  50]]
Validation f1: 32.89
Validation accuracy: 61.80
Validation recall: 34.25
Validation precision: 31.65
Validation AUC: 0.3332731825859493
Validation class accuracies: [0.7216494845360825, 0.3424657534246575]
TARGET: 1
target metric(test f1): 0.32894736842105265
column_sums: [376 158]
cm_sum: 534
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 20 epochs
Epoch 57/80
297/297 - 582s - loss: 0.0299 - accuracy: 0.9909 - val_loss: 1.6173 - val_accuracy: 0.6180
Confusion matrix: 
 [[280 108]
 [ 96  50]]
Validation f1: 32.89
Validation accuracy: 61.80
Validation recall: 34.25
Validation precision: 31.65
Validation AUC: 0.33320250722961064
Validation class accuracies: [0.7216494845360825, 0.3424657534246575]
TARGET: 1
target metric(test f1): 0.32894736842105265
column_sums: [376 158]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 21 epochs
Epoch 58/80
297/297 - 582s - loss: 0.0344 - accuracy: 0.9899 - val_loss: 1.6212 - val_accuracy: 0.6217
Confusion matrix: 
 [[283 105]
 [ 97  49]]
Validation f1: 32.67
Validation accuracy: 62.17
Validation recall: 33.56
Validation precision: 31.82
Validation AUC: 0.3328574624969473
Validation class accuracies: [0.729381443298969, 0.3356164383561644]
TARGET: 1
target metric(test f1): 0.32666666666666666
column_sums: [380 154]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 22 epochs
Epoch 59/80
297/297 - 582s - loss: 0.0365 - accuracy: 0.9897 - val_loss: 1.6202 - val_accuracy: 0.6180
Confusion matrix: 
 [[279 109]
 [ 95  51]]
Validation f1: 33.33
Validation accuracy: 61.80
Validation recall: 34.93
Validation precision: 31.87
Validation AUC: 0.33072350303201536
Validation class accuracies: [0.7190721649484536, 0.3493150684931507]
TARGET: 1
target metric(test f1): 0.3333333333333333
column_sums: [374 160]
cm_sum: 534
inside not defaulting
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 23 epochs
Epoch 60/80
297/297 - 583s - loss: 0.0260 - accuracy: 0.9941 - val_loss: 1.6259 - val_accuracy: 0.6142
Confusion matrix: 
 [[276 112]
 [ 94  52]]
Validation f1: 33.55
Validation accuracy: 61.42
Validation recall: 35.62
Validation precision: 31.71
Validation AUC: 0.3306173029715497
Validation class accuracies: [0.711340206185567, 0.3561643835616438]
TARGET: 1
target metric(test f1): 0.33548387096774196
column_sums: [370 164]
cm_sum: 534
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.4444444444444445 hasn't increased by 0 in 24 epochs
Epoch 61/80
297/297 - 583s - loss: 0.0341 - accuracy: 0.9893 - val_loss: 1.5956 - val_accuracy: 0.6255
Confusion matrix: 
 [[285 103]
 [ 97  49]]
Validation f1: 32.89
Validation accuracy: 62.55
Validation recall: 33.56
Validation precision: 32.24
Validation AUC: 0.3346761918999317
Validation class accuracies: [0.7345360824742269, 0.3356164383561644]

The metrics for the epoch with the best target metric are: 
Best cm: [[233 155]
 [ 60  86]]
Best f1: 0.4444444444444445
Best accuracy: 0.5973782771535581
Best recall: 0.589041095890411
Best precision: 0.35684647302904565
Best AUC: 0.43693450514614285
Best epoch: 35
TARGET: 1
target metric(test f1): 0.32885906040268453
column_sums: [382 152]
cm_sum: 534
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 17
Starting...
CM: [[10 17]
 [ 3  8]]
F1: 0.4444444444444444
AUC: 0.56311004784689
Accuracy: 0.47368421052631576
Precision: 0.32
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_17.xls...
Done.
Epoch: 17
Starting...
CM: [[19  8]
 [ 6  5]]
F1: 0.41666666666666663
AUC: 0.4985277880014722
Accuracy: 0.631578947368421
Precision: 0.38461538461538464
Recall: 0.45454545454545453
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_17.xls...
Done.
Epoch: 17
Starting...
CM: [[24  3]
 [ 7  4]]
F1: 0.4444444444444444
AUC: 0.5596377306903623
Accuracy: 0.7368421052631579
Precision: 0.5714285714285714
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_17.xls...
Done.
Epoch: 21
Starting...
CM: [[ 6 21]
 [ 2  9]]
F1: 0.43902439024390244
AUC: 0.5854066985645934
Accuracy: 0.39473684210526316
Precision: 0.3
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_21.xls...
Done.
Epoch: 21
Starting...
CM: [[ 9 18]
 [ 3  8]]
F1: 0.43243243243243246
AUC: 0.5569562016930438
Accuracy: 0.4473684210526316
Precision: 0.3076923076923077
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_21.xls...
Done.
Epoch: 21
Starting...
CM: [[17 10]
 [ 5  6]]
F1: 0.4444444444444444
AUC: 0.5260167464114833
Accuracy: 0.6052631578947368
Precision: 0.375
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_21.xls...
Done.
Epoch: 26
Starting...
CM: [[ 4 23]
 [ 0 11]]
F1: 0.48888888888888893
AUC: 0.6617647058823529
Accuracy: 0.39473684210526316
Precision: 0.3235294117647059
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_26.xls...
Done.
Epoch: 26
Starting...
CM: [[10 17]
 [ 2  9]]
F1: 0.4864864864864865
AUC: 0.6084836216415164
Accuracy: 0.5
Precision: 0.34615384615384615
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_26.xls...
Done.
Epoch: 26
Starting...
CM: [[18  9]
 [ 5  6]]
F1: 0.4615384615384615
AUC: 0.5385167464114833
Accuracy: 0.631578947368421
Precision: 0.4
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_26.xls...
Done.
Epoch: 29
Starting...
CM: [[ 1 26]
 [ 0 11]]
F1: 0.4583333333333333
AUC: 0.6486486486486487
Accuracy: 0.3157894736842105
Precision: 0.2972972972972973
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_29.xls...
Done.
Epoch: 29
Starting...
CM: [[ 4 23]
 [ 0 11]]
F1: 0.48888888888888893
AUC: 0.6617647058823529
Accuracy: 0.39473684210526316
Precision: 0.3235294117647059
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_29.xls...
Done.
Epoch: 29
Starting...
CM: [[11 16]
 [ 4  7]]
F1: 0.411764705882353
AUC: 0.5229873101726649
Accuracy: 0.47368421052631576
Precision: 0.30434782608695654
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_29.xls...
Done.
Epoch: 32
Starting...
CM: [[ 0 27]
 [ 0 11]]
F1: 0.4489795918367347
AUC: 0.6447368421052632
Accuracy: 0.2894736842105263
Precision: 0.2894736842105263
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_32.xls...
Done.
Epoch: 32
Starting...
CM: [[ 3 24]
 [ 0 11]]
F1: 0.4782608695652174
AUC: 0.6571428571428571
Accuracy: 0.3684210526315789
Precision: 0.3142857142857143
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_32.xls...
Done.
Epoch: 32
Starting...
CM: [[10 17]
 [ 2  9]]
F1: 0.4864864864864865
AUC: 0.6084836216415164
Accuracy: 0.5
Precision: 0.34615384615384615
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_32.xls...
Done.
Epoch: 35
Starting...
CM: [[ 4 23]
 [ 0 11]]
F1: 0.48888888888888893
AUC: 0.6617647058823529
Accuracy: 0.39473684210526316
Precision: 0.3235294117647059
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_35.xls...
Done.
Epoch: 35
Starting...
CM: [[ 9 18]
 [ 0 11]]
F1: 0.5499999999999999
AUC: 0.6896551724137931
Accuracy: 0.5263157894736842
Precision: 0.3793103448275862
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_35.xls...
Done.
Epoch: 35
Starting...
CM: [[15 12]
 [ 3  8]]
F1: 0.5161290322580645
AUC: 0.6031100478468899
Accuracy: 0.6052631578947368
Precision: 0.4
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_35.xls...
Done.
Epoch: 6
Starting...
CM: [[15 12]
 [ 4  7]]
F1: 0.4666666666666667
AUC: 0.5550239234449761
Accuracy: 0.5789473684210527
Precision: 0.3684210526315789
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_6.xls...
Done.
Epoch: 6
Starting...
CM: [[22  5]
 [ 9  2]]
F1: 0.2222222222222222
AUC: 0.3521872863978127
Accuracy: 0.631578947368421
Precision: 0.2857142857142857
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_6.xls...
Done.
Epoch: 6
Starting...
CM: [[26  1]
 [10  1]]
F1: 0.15384615384615385
AUC: 0.4270334928229665
Accuracy: 0.7105263157894737
Precision: 0.5
Recall: 0.09090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_6.xls...
Done.
Epoch: 80
Starting...
CM: [[ 4 23]
 [ 1 10]]
F1: 0.45454545454545453
AUC: 0.6192185007974481
Accuracy: 0.3684210526315789
Precision: 0.30303030303030304
Recall: 0.9090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_80.xls...
Done.
Epoch: 80
Starting...
CM: [[12 15]
 [ 5  6]]
F1: 0.37499999999999994
AUC: 0.48137388926862607
Accuracy: 0.47368421052631576
Precision: 0.2857142857142857
Recall: 0.5454545454545454
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_80.xls...
Done.
Epoch: 80
Starting...
CM: [[21  6]
 [ 8  3]]
F1: 0.3
AUC: 0.4082934609250398
Accuracy: 0.631578947368421
Precision: 0.3333333333333333
Recall: 0.2727272727272727
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_80.xls...
Done.
Epoch: 9
Starting...
CM: [[15 12]
 [ 3  8]]
F1: 0.5161290322580645
AUC: 0.6031100478468899
Accuracy: 0.6052631578947368
Precision: 0.4
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_9.xls...
Done.
Epoch: 9
Starting...
CM: [[22  5]
 [10  1]]
F1: 0.11764705882352942
AUC: 0.2603668261562998
Accuracy: 0.6052631578947368
Precision: 0.16666666666666666
Recall: 0.09090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_9.xls...
Done.
Epoch: 9
Starting...
CM: [[25  2]
 [10  1]]
F1: 0.14285714285714288
AUC: 0.3437001594896331
Accuracy: 0.6842105263157895
Precision: 0.3333333333333333
Recall: 0.09090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_7_9.xls...
Done.
K-Fold split N: 8
With concat = False and six = False, size of training set: 4743...
...and size of validation set: 541
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_114 (InputLayer)          [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_678 (BatchN (None, 128, 1250, 1) 4           input_114[0][0]                  
__________________________________________________________________________________________________
conv2d_565 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_678[0][0]    
__________________________________________________________________________________________________
conv2d_567 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_678[0][0]    
__________________________________________________________________________________________________
max_pooling2d_113 (MaxPooling2D (None, 128, 1250, 1) 0           batch_normalization_678[0][0]    
__________________________________________________________________________________________________
conv2d_566 (Conv2D)             (None, 128, 1250, 16 2320        conv2d_565[0][0]                 
__________________________________________________________________________________________________
conv2d_568 (Conv2D)             (None, 128, 1250, 16 6416        conv2d_567[0][0]                 
__________________________________________________________________________________________________
conv2d_569 (Conv2D)             (None, 128, 1250, 16 32          max_pooling2d_113[0][0]          
__________________________________________________________________________________________________
concatenate_113 (Concatenate)   (None, 128, 1250, 48 0           conv2d_566[0][0]                 
                                                                 conv2d_568[0][0]                 
                                                                 conv2d_569[0][0]                 
__________________________________________________________________________________________________
average_pooling2d_565 (AverageP (None, 64, 625, 48)  0           concatenate_113[0][0]            
__________________________________________________________________________________________________
batch_normalization_679 (BatchN (None, 64, 625, 48)  192         average_pooling2d_565[0][0]      
__________________________________________________________________________________________________
dropout_565 (Dropout)           (None, 64, 625, 48)  0           batch_normalization_679[0][0]    
__________________________________________________________________________________________________
inverted_residual_1130 (Inverte (None, 64, 625, 32)  35840       dropout_565[0][0]                
__________________________________________________________________________________________________
inverted_residual_1131 (Inverte (None, 64, 625, 32)  20864       inverted_residual_1130[0][0]     
__________________________________________________________________________________________________
average_pooling2d_566 (AverageP (None, 32, 312, 32)  0           inverted_residual_1131[0][0]     
__________________________________________________________________________________________________
batch_normalization_680 (BatchN (None, 32, 312, 32)  128         average_pooling2d_566[0][0]      
__________________________________________________________________________________________________
dropout_566 (Dropout)           (None, 32, 312, 32)  0           batch_normalization_680[0][0]    
__________________________________________________________________________________________________
inverted_residual_1132 (Inverte (None, 32, 312, 64)  27136       dropout_566[0][0]                
__________________________________________________________________________________________________
inverted_residual_1133 (Inverte (None, 32, 312, 64)  66304       inverted_residual_1132[0][0]     
__________________________________________________________________________________________________
average_pooling2d_567 (AverageP (None, 16, 156, 64)  0           inverted_residual_1133[0][0]     
__________________________________________________________________________________________________
batch_normalization_681 (BatchN (None, 16, 156, 64)  256         average_pooling2d_567[0][0]      
__________________________________________________________________________________________________
dropout_567 (Dropout)           (None, 16, 156, 64)  0           batch_normalization_681[0][0]    
__________________________________________________________________________________________________
inverted_residual_1134 (Inverte (None, 16, 156, 128) 91136       dropout_567[0][0]                
__________________________________________________________________________________________________
inverted_residual_1135 (Inverte (None, 16, 156, 128) 230912      inverted_residual_1134[0][0]     
__________________________________________________________________________________________________
average_pooling2d_568 (AverageP (None, 8, 78, 128)   0           inverted_residual_1135[0][0]     
__________________________________________________________________________________________________
batch_normalization_682 (BatchN (None, 8, 78, 128)   512         average_pooling2d_568[0][0]      
__________________________________________________________________________________________________
dropout_568 (Dropout)           (None, 8, 78, 128)   0           batch_normalization_682[0][0]    
__________________________________________________________________________________________________
inverted_residual_1136 (Inverte (None, 8, 78, 256)   329728      dropout_568[0][0]                
__________________________________________________________________________________________________
inverted_residual_1137 (Inverte (None, 8, 78, 256)   855040      inverted_residual_1136[0][0]     
__________________________________________________________________________________________________
average_pooling2d_569 (AverageP (None, 4, 39, 256)   0           inverted_residual_1137[0][0]     
__________________________________________________________________________________________________
batch_normalization_683 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_569[0][0]      
__________________________________________________________________________________________________
dropout_569 (Dropout)           (None, 4, 39, 256)   0           batch_normalization_683[0][0]    
__________________________________________________________________________________________________
inverted_residual_1138 (Inverte (None, 4, 39, 512)   1249280     dropout_569[0][0]                
__________________________________________________________________________________________________
inverted_residual_1139 (Inverte (None, 4, 39, 512)   3282944     inverted_residual_1138[0][0]     
__________________________________________________________________________________________________
global_average_pooling2d_113 (G (None, 512)          0           inverted_residual_1139[0][0]     
__________________________________________________________________________________________________
dense_113 (Dense)               (None, 1)            513         global_average_pooling2d_113[0][0
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
297/297 - 589s - loss: 0.6188 - accuracy: 0.7244 - val_loss: 0.5493 - val_accuracy: 0.7616
Confusion matrix: 
 [[412   0]
 [129   0]]
Validation f1: 0.00
Validation accuracy: 76.16
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2609332778254103
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [541   0]
cm_sum: 541
The training is defaulting to either class.
Epoch 2/80
297/297 - 581s - loss: 0.5784 - accuracy: 0.7333 - val_loss: 0.5478 - val_accuracy: 0.7616
Confusion matrix: 
 [[411   1]
 [128   1]]
Validation f1: 1.53
Validation accuracy: 76.16
Validation recall: 0.78
Validation precision: 50.00
Validation AUC: 0.27560985324332676
Validation class accuracies: [0.9975728155339806, 0.007751937984496124]
TARGET: 1
target metric(test f1): 0.015267175572519083
column_sums: [539   2]
cm_sum: 541
The training is defaulting to either class.
Epoch 3/80
297/297 - 580s - loss: 0.5759 - accuracy: 0.7369 - val_loss: 0.6529 - val_accuracy: 0.7153
Confusion matrix: 
 [[379  33]
 [121   8]]
Validation f1: 9.41
Validation accuracy: 71.53
Validation recall: 6.20
Validation precision: 19.51
Validation AUC: 0.24033579560551274
Validation class accuracies: [0.9199029126213593, 0.06201550387596899]
TARGET: 1
target metric(test f1): 0.09411764705882353
column_sums: [500  41]
cm_sum: 541
The training is defaulting to either class.
Epoch 4/80
297/297 - 581s - loss: 0.5722 - accuracy: 0.7365 - val_loss: 1.9303 - val_accuracy: 0.2847
Confusion matrix: 
 [[ 29 383]
 [  4 125]]
Validation f1: 39.25
Validation accuracy: 28.47
Validation recall: 96.90
Validation precision: 24.61
Validation AUC: 0.21502317133839033
Validation class accuracies: [0.0703883495145631, 0.9689922480620154]
TARGET: 1
target metric(test f1): 0.3924646781789639
column_sums: [ 33 508]
cm_sum: 541
The training is defaulting to either class.
Epoch 5/80
297/297 - 579s - loss: 0.5710 - accuracy: 0.7367 - val_loss: 0.5952 - val_accuracy: 0.7505
Confusion matrix: 
 [[402  10]
 [125   4]]
Validation f1: 5.59
Validation accuracy: 75.05
Validation recall: 3.10
Validation precision: 28.57
Validation AUC: 0.23315000114609008
Validation class accuracies: [0.9757281553398058, 0.031007751937984496]
TARGET: 1
target metric(test f1): 0.055944055944055944
column_sums: [527  14]
cm_sum: 541
The training is defaulting to either class.
Epoch 6/80
297/297 - 579s - loss: 0.5701 - accuracy: 0.7348 - val_loss: 0.5635 - val_accuracy: 0.7616
Confusion matrix: 
 [[412   0]
 [129   0]]
Validation f1: 0.00
Validation accuracy: 76.16
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2562360511420102
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [541   0]
cm_sum: 541
The training is defaulting to either class.
Epoch 7/80
297/297 - 580s - loss: 0.5694 - accuracy: 0.7356 - val_loss: 0.5507 - val_accuracy: 0.7597
Confusion matrix: 
 [[410   2]
 [128   1]]
Validation f1: 1.52
Validation accuracy: 75.97
Validation recall: 0.78
Validation precision: 33.33
Validation AUC: 0.2494427871966551
Validation class accuracies: [0.9951456310679612, 0.007751937984496124]
TARGET: 1
target metric(test f1): 0.01515151515151515
column_sums: [538   3]
cm_sum: 541
The training is defaulting to either class.
Epoch 8/80
297/297 - 581s - loss: 0.5664 - accuracy: 0.7362 - val_loss: 0.5592 - val_accuracy: 0.7616
Confusion matrix: 
 [[412   0]
 [129   0]]
Validation f1: 0.00
Validation accuracy: 76.16
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2768363723669561
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [541   0]
cm_sum: 541
The training is defaulting to either class.
Epoch 9/80
297/297 - 583s - loss: 0.5634 - accuracy: 0.7362 - val_loss: 0.5527 - val_accuracy: 0.7468
Confusion matrix: 
 [[401  11]
 [126   3]]
Validation f1: 4.20
Validation accuracy: 74.68
Validation recall: 2.33
Validation precision: 21.43
Validation AUC: 0.279188085830984
Validation class accuracies: [0.9733009708737864, 0.023255813953488372]
TARGET: 1
target metric(test f1): 0.04195804195804195
column_sums: [527  14]
cm_sum: 541
The training is defaulting to either class.
Epoch 10/80
297/297 - 580s - loss: 0.5596 - accuracy: 0.7354 - val_loss: 4.2848 - val_accuracy: 0.7616
Confusion matrix: 
 [[412   0]
 [129   0]]
Validation f1: 0.00
Validation accuracy: 76.16
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24935175610148966
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [541   0]
cm_sum: 541
The training is defaulting to either class.
Epoch 11/80
297/297 - 580s - loss: 0.5616 - accuracy: 0.7377 - val_loss: 0.5371 - val_accuracy: 0.7616
Confusion matrix: 
 [[411   1]
 [128   1]]
Validation f1: 1.53
Validation accuracy: 76.16
Validation recall: 0.78
Validation precision: 50.00
Validation AUC: 0.28342967710209066
Validation class accuracies: [0.9975728155339806, 0.007751937984496124]
TARGET: 1
target metric(test f1): 0.015267175572519083
column_sums: [539   2]
cm_sum: 541
The training is defaulting to either class.
Epoch 12/80
297/297 - 580s - loss: 0.5568 - accuracy: 0.7409 - val_loss: 0.5751 - val_accuracy: 0.7024
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[340  72]
 [ 89  40]]
Validation f1: 33.20
Validation accuracy: 70.24
Validation recall: 31.01
Validation precision: 35.71
Validation AUC: 0.35814645235301173
Validation class accuracies: [0.8252427184466019, 0.31007751937984496]
TARGET: 1
target metric(test f1): 0.33195020746887965
column_sums: [429 112]
cm_sum: 541
inside not defaulting
Saving model...
Epoch 13/80
297/297 - 582s - loss: 0.5550 - accuracy: 0.7371 - val_loss: 1.2511 - val_accuracy: 0.7616
Confusion matrix: 
 [[412   0]
 [129   0]]
Validation f1: 0.00
Validation accuracy: 76.16
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.26306335286242755
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [541   0]
cm_sum: 541
The training is defaulting to either class.
Epoch 14/80
297/297 - 581s - loss: 0.5536 - accuracy: 0.7377 - val_loss: 0.5335 - val_accuracy: 0.7616
Confusion matrix: 
 [[410   2]
 [127   2]]
Validation f1: 3.01
Validation accuracy: 76.16
Validation recall: 1.55
Validation precision: 50.00
Validation AUC: 0.33427012476665713
Validation class accuracies: [0.9951456310679612, 0.015503875968992248]
TARGET: 1
target metric(test f1): 0.03007518796992481
column_sums: [537   4]
cm_sum: 541
The training is defaulting to either class.
Epoch 15/80
297/297 - 582s - loss: 0.5467 - accuracy: 0.7462 - val_loss: 0.5716 - val_accuracy: 0.7616
Confusion matrix: 
 [[412   0]
 [129   0]]
Validation f1: 0.00
Validation accuracy: 76.16
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2732475079648582
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [541   0]
cm_sum: 541
The training is defaulting to either class.
Epoch 16/80
297/297 - 582s - loss: 0.5440 - accuracy: 0.7487 - val_loss: 0.5549 - val_accuracy: 0.7542
Confusion matrix: 
 [[405   7]
 [126   3]]
Validation f1: 4.32
Validation accuracy: 75.42
Validation recall: 2.33
Validation precision: 30.00
Validation AUC: 0.3197825286153275
Validation class accuracies: [0.9830097087378641, 0.023255813953488372]
TARGET: 1
target metric(test f1): 0.04316546762589928
column_sums: [531  10]
cm_sum: 541
The training is defaulting to either class.
Epoch 17/80
297/297 - 580s - loss: 0.5378 - accuracy: 0.7478 - val_loss: 0.5719 - val_accuracy: 0.7616
Confusion matrix: 
 [[410   2]
 [127   2]]
Validation f1: 3.01
Validation accuracy: 76.16
Validation recall: 1.55
Validation precision: 50.00
Validation AUC: 0.2888159367938816
Validation class accuracies: [0.9951456310679612, 0.015503875968992248]
TARGET: 1
target metric(test f1): 0.03007518796992481
column_sums: [537   4]
cm_sum: 541
The training is defaulting to either class.
Epoch 18/80
297/297 - 582s - loss: 0.5290 - accuracy: 0.7546 - val_loss: 0.6116 - val_accuracy: 0.6858
Confusion matrix: 
 [[324  88]
 [ 82  47]]
Validation f1: 35.61
Validation accuracy: 68.58
Validation recall: 36.43
Validation precision: 34.81
Validation AUC: 0.3613694492802541
Validation class accuracies: [0.7864077669902912, 0.3643410852713178]
TARGET: 1
target metric(test f1): 0.3560606060606061
column_sums: [406 135]
cm_sum: 541
inside not defaulting
Saving model...
Epoch 19/80
297/297 - 580s - loss: 0.5249 - accuracy: 0.7527 - val_loss: 0.5383 - val_accuracy: 0.7542
Confusion matrix: 
 [[398  14]
 [119  10]]
Validation f1: 13.07
Validation accuracy: 75.42
Validation recall: 7.75
Validation precision: 41.67
Validation AUC: 0.32824803776213207
Validation class accuracies: [0.9660194174757282, 0.07751937984496124]
TARGET: 1
target metric(test f1): 0.13071895424836602
column_sums: [517  24]
cm_sum: 541
The training is defaulting to either class.
Epoch 20/80
297/297 - 581s - loss: 0.5108 - accuracy: 0.7618 - val_loss: 0.5643 - val_accuracy: 0.7264
Confusion matrix: 
 [[371  41]
 [107  22]]
Validation f1: 22.92
Validation accuracy: 72.64
Validation recall: 17.05
Validation precision: 34.92
Validation AUC: 0.3288151667767271
Validation class accuracies: [0.9004854368932039, 0.17054263565891473]
TARGET: 1
target metric(test f1): 0.22916666666666669
column_sums: [478  63]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.3560606060606061 hasn't increased by 0 in 1 epochs
Epoch 21/80
297/297 - 581s - loss: 0.5024 - accuracy: 0.7655 - val_loss: 0.5933 - val_accuracy: 0.7061
Confusion matrix: 
 [[367  45]
 [114  15]]
Validation f1: 15.87
Validation accuracy: 70.61
Validation recall: 11.63
Validation precision: 25.00
Validation AUC: 0.27562934213518553
Validation class accuracies: [0.8907766990291263, 0.11627906976744186]
TARGET: 1
target metric(test f1): 0.15873015873015872
column_sums: [481  60]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.3560606060606061 hasn't increased by 0 in 2 epochs
Epoch 22/80
297/297 - 580s - loss: 0.4912 - accuracy: 0.7685 - val_loss: 0.6491 - val_accuracy: 0.7153
Confusion matrix: 
 [[374  38]
 [116  13]]
Validation f1: 14.44
Validation accuracy: 71.53
Validation recall: 10.08
Validation precision: 25.49
Validation AUC: 0.27160577185770324
Validation class accuracies: [0.9077669902912622, 0.10077519379844961]
TARGET: 1
target metric(test f1): 0.14444444444444443
column_sums: [490  51]
cm_sum: 541
The training is defaulting to either class.
Epoch 23/80
297/297 - 584s - loss: 0.4778 - accuracy: 0.7841 - val_loss: 0.7026 - val_accuracy: 0.7597
Confusion matrix: 
 [[411   1]
 [129   0]]
Validation f1: 0.00
Validation accuracy: 75.97
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.29421405423977726
Validation class accuracies: [0.9975728155339806, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [540   1]
cm_sum: 541
The training is defaulting to either class.
Epoch 24/80
297/297 - 582s - loss: 0.4585 - accuracy: 0.7900 - val_loss: 0.6619 - val_accuracy: 0.7190
Confusion matrix: 
 [[375  37]
 [115  14]]
Validation f1: 15.56
Validation accuracy: 71.90
Validation recall: 10.85
Validation precision: 27.45
Validation AUC: 0.22101666627736555
Validation class accuracies: [0.9101941747572816, 0.10852713178294573]
TARGET: 1
target metric(test f1): 0.15555555555555556
column_sums: [490  51]
cm_sum: 541
The training is defaulting to either class.
Epoch 25/80
297/297 - 581s - loss: 0.4298 - accuracy: 0.8029 - val_loss: 0.8177 - val_accuracy: 0.6359
Confusion matrix: 
 [[270 142]
 [ 55  74]]
Validation f1: 42.90
Validation accuracy: 63.59
Validation recall: 57.36
Validation precision: 34.26
Validation AUC: 0.3418384416316777
Validation class accuracies: [0.6553398058252428, 0.5736434108527132]
TARGET: 1
target metric(test f1): 0.4289855072463768
column_sums: [325 216]
cm_sum: 541
inside not defaulting
Saving model...
Epoch 26/80
297/297 - 582s - loss: 0.4197 - accuracy: 0.8147 - val_loss: 1.0343 - val_accuracy: 0.5323
Confusion matrix: 
 [[219 193]
 [ 60  69]]
Validation f1: 35.29
Validation accuracy: 53.23
Validation recall: 53.49
Validation precision: 26.34
Validation AUC: 0.2850899491463976
Validation class accuracies: [0.5315533980582524, 0.5348837209302325]
TARGET: 1
target metric(test f1): 0.3529411764705882
column_sums: [279 262]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 1 epochs
Epoch 27/80
297/297 - 582s - loss: 0.3962 - accuracy: 0.8258 - val_loss: 0.7744 - val_accuracy: 0.6858
Confusion matrix: 
 [[340  72]
 [ 98  31]]
Validation f1: 26.72
Validation accuracy: 68.58
Validation recall: 24.03
Validation precision: 30.10
Validation AUC: 0.29988785990275957
Validation class accuracies: [0.8252427184466019, 0.24031007751937986]
TARGET: 1
target metric(test f1): 0.26724137931034486
column_sums: [438 103]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 2 epochs
Epoch 28/80
297/297 - 581s - loss: 0.3702 - accuracy: 0.8391 - val_loss: 1.4393 - val_accuracy: 0.4658
Confusion matrix: 
 [[160 252]
 [ 37  92]]
Validation f1: 38.90
Validation accuracy: 46.58
Validation recall: 71.32
Validation precision: 26.74
Validation AUC: 0.2981702179392784
Validation class accuracies: [0.3883495145631068, 0.7131782945736435]
TARGET: 1
target metric(test f1): 0.38900634249471455
column_sums: [197 344]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 3 epochs
Epoch 29/80
297/297 - 582s - loss: 0.3537 - accuracy: 0.8461 - val_loss: 0.7735 - val_accuracy: 0.6932
Confusion matrix: 
 [[360  52]
 [114  15]]
Validation f1: 15.31
Validation accuracy: 69.32
Validation recall: 11.63
Validation precision: 22.39
Validation AUC: 0.27127399417687265
Validation class accuracies: [0.8737864077669902, 0.11627906976744186]
TARGET: 1
target metric(test f1): 0.15306122448979592
column_sums: [474  67]
cm_sum: 541
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 4 epochs
Epoch 30/80
297/297 - 581s - loss: 0.2751 - accuracy: 0.8811 - val_loss: 0.8479 - val_accuracy: 0.6802
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[338  74]
 [ 99  30]]
Validation f1: 25.75
Validation accuracy: 68.02
Validation recall: 23.26
Validation precision: 28.85
Validation AUC: 0.29087625561868047
Validation class accuracies: [0.8203883495145631, 0.23255813953488372]
TARGET: 1
target metric(test f1): 0.2575107296137339
column_sums: [437 104]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 5 epochs
Epoch 31/80
297/297 - 580s - loss: 0.2520 - accuracy: 0.8982 - val_loss: 1.0322 - val_accuracy: 0.5749
Confusion matrix: 
 [[259 153]
 [ 77  52]]
Validation f1: 31.14
Validation accuracy: 57.49
Validation recall: 40.31
Validation precision: 25.37
Validation AUC: 0.2906683171166057
Validation class accuracies: [0.6286407766990292, 0.40310077519379844]
TARGET: 1
target metric(test f1): 0.31137724550898205
column_sums: [336 205]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 6 epochs
Epoch 32/80
297/297 - 579s - loss: 0.2398 - accuracy: 0.9051 - val_loss: 0.9687 - val_accuracy: 0.6932
Confusion matrix: 
 [[352  60]
 [106  23]]
Validation f1: 21.70
Validation accuracy: 69.32
Validation recall: 17.83
Validation precision: 27.71
Validation AUC: 0.2839056500603241
Validation class accuracies: [0.8543689320388349, 0.17829457364341086]
TARGET: 1
target metric(test f1): 0.2169811320754717
column_sums: [458  83]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 7 epochs
Epoch 33/80
297/297 - 580s - loss: 0.2326 - accuracy: 0.9091 - val_loss: 0.9859 - val_accuracy: 0.6470
Confusion matrix: 
 [[315  97]
 [ 94  35]]
Validation f1: 26.82
Validation accuracy: 64.70
Validation recall: 27.13
Validation precision: 26.52
Validation AUC: 0.29610066963430715
Validation class accuracies: [0.7645631067961165, 0.2713178294573643]
TARGET: 1
target metric(test f1): 0.268199233716475
column_sums: [409 132]
cm_sum: 541
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 8 epochs
Epoch 34/80
297/297 - 581s - loss: 0.1915 - accuracy: 0.9254 - val_loss: 1.0486 - val_accuracy: 0.6118
Confusion matrix: 
 [[290 122]
 [ 88  41]]
Validation f1: 28.08
Validation accuracy: 61.18
Validation recall: 31.78
Validation precision: 25.15
Validation AUC: 0.2905046573910771
Validation class accuracies: [0.7038834951456311, 0.3178294573643411]
TARGET: 1
target metric(test f1): 0.2808219178082192
column_sums: [378 163]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 9 epochs
Epoch 35/80
297/297 - 580s - loss: 0.2030 - accuracy: 0.9192 - val_loss: 1.0966 - val_accuracy: 0.6081
Confusion matrix: 
 [[286 126]
 [ 86  43]]
Validation f1: 28.86
Validation accuracy: 60.81
Validation recall: 33.33
Validation precision: 25.44
Validation AUC: 0.2941839692139277
Validation class accuracies: [0.6941747572815534, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.28859060402684567
column_sums: [372 169]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 10 epochs
Epoch 36/80
297/297 - 581s - loss: 0.1956 - accuracy: 0.9256 - val_loss: 1.1169 - val_accuracy: 0.6007
Confusion matrix: 
 [[281 131]
 [ 85  44]]
Validation f1: 28.95
Validation accuracy: 60.07
Validation recall: 34.11
Validation precision: 25.14
Validation AUC: 0.29218066303350454
Validation class accuracies: [0.6820388349514563, 0.34108527131782945]
TARGET: 1
target metric(test f1): 0.28947368421052627
column_sums: [366 175]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 11 epochs
Epoch 37/80
297/297 - 580s - loss: 0.1859 - accuracy: 0.9271 - val_loss: 1.1510 - val_accuracy: 0.5841
Confusion matrix: 
 [[268 144]
 [ 81  48]]
Validation f1: 29.91
Validation accuracy: 58.41
Validation recall: 37.21
Validation precision: 25.00
Validation AUC: 0.29455449228840624
Validation class accuracies: [0.6504854368932039, 0.37209302325581395]
TARGET: 1
target metric(test f1): 0.29906542056074764
column_sums: [349 192]
cm_sum: 541
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 12 epochs
Epoch 38/80
297/297 - 581s - loss: 0.1815 - accuracy: 0.9319 - val_loss: 1.1294 - val_accuracy: 0.5952
Confusion matrix: 
 [[277 135]
 [ 84  45]]
Validation f1: 29.13
Validation accuracy: 59.52
Validation recall: 34.88
Validation precision: 25.00
Validation AUC: 0.29234610753173035
Validation class accuracies: [0.6723300970873787, 0.3488372093023256]
TARGET: 1
target metric(test f1): 0.29126213592233013
column_sums: [361 180]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 13 epochs
Epoch 39/80
297/297 - 580s - loss: 0.1918 - accuracy: 0.9262 - val_loss: 1.1359 - val_accuracy: 0.5952
Confusion matrix: 
 [[275 137]
 [ 82  47]]
Validation f1: 30.03
Validation accuracy: 59.52
Validation recall: 36.43
Validation precision: 25.54
Validation AUC: 0.3013635729078533
Validation class accuracies: [0.6674757281553398, 0.3643410852713178]
TARGET: 1
target metric(test f1): 0.3003194888178914
column_sums: [357 184]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 14 epochs
Epoch 40/80
297/297 - 581s - loss: 0.1836 - accuracy: 0.9260 - val_loss: 1.1962 - val_accuracy: 0.5841
Confusion matrix: 
 [[263 149]
 [ 76  53]]
Validation f1: 32.02
Validation accuracy: 58.41
Validation recall: 41.09
Validation precision: 26.24
Validation AUC: 0.30137670431307173
Validation class accuracies: [0.6383495145631068, 0.4108527131782946]
TARGET: 1
target metric(test f1): 0.3202416918429003
column_sums: [339 202]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 15 epochs
Epoch 41/80
297/297 - 581s - loss: 0.1856 - accuracy: 0.9262 - val_loss: 1.1240 - val_accuracy: 0.5915
Confusion matrix: 
 [[277 135]
 [ 86  43]]
Validation f1: 28.01
Validation accuracy: 59.15
Validation recall: 33.33
Validation precision: 24.16
Validation AUC: 0.29425491047744023
Validation class accuracies: [0.6723300970873787, 0.3333333333333333]
TARGET: 1
target metric(test f1): 0.28013029315960913
column_sums: [363 178]
cm_sum: 541
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 16 epochs
Epoch 42/80
297/297 - 581s - loss: 0.1864 - accuracy: 0.9300 - val_loss: 1.1577 - val_accuracy: 0.5804
Confusion matrix: 
 [[269 143]
 [ 84  45]]
Validation f1: 28.39
Validation accuracy: 58.04
Validation recall: 34.88
Validation precision: 23.94
Validation AUC: 0.2946616205240993
Validation class accuracies: [0.6529126213592233, 0.3488372093023256]
TARGET: 1
target metric(test f1): 0.28391167192429023
column_sums: [353 188]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 17 epochs
Epoch 43/80
297/297 - 580s - loss: 0.1821 - accuracy: 0.9277 - val_loss: 1.1394 - val_accuracy: 0.5878
Confusion matrix: 
 [[272 140]
 [ 83  46]]
Validation f1: 29.21
Validation accuracy: 58.78
Validation recall: 35.66
Validation precision: 24.73
Validation AUC: 0.2951064924777854
Validation class accuracies: [0.6601941747572816, 0.35658914728682173]
TARGET: 1
target metric(test f1): 0.2920634920634921
column_sums: [355 186]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 18 epochs
Epoch 44/80
297/297 - 580s - loss: 0.1755 - accuracy: 0.9338 - val_loss: 1.1699 - val_accuracy: 0.5841
Confusion matrix: 
 [[270 142]
 [ 83  46]]
Validation f1: 29.02
Validation accuracy: 58.41
Validation recall: 35.66
Validation precision: 24.47
Validation AUC: 0.2957421729827546
Validation class accuracies: [0.6553398058252428, 0.35658914728682173]
TARGET: 1
target metric(test f1): 0.2902208201892745
column_sums: [353 188]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 19 epochs
Epoch 45/80
297/297 - 581s - loss: 0.1843 - accuracy: 0.9252 - val_loss: 1.1615 - val_accuracy: 0.5823
Confusion matrix: 
 [[269 143]
 [ 83  46]]
Validation f1: 28.93
Validation accuracy: 58.23
Validation recall: 35.66
Validation precision: 24.34
Validation AUC: 0.2963877027611606
Validation class accuracies: [0.6529126213592233, 0.35658914728682173]
TARGET: 1
target metric(test f1): 0.28930817610062887
column_sums: [352 189]
cm_sum: 541
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 20 epochs
Epoch 46/80
297/297 - 580s - loss: 0.1771 - accuracy: 0.9330 - val_loss: 1.1583 - val_accuracy: 0.5860
Confusion matrix: 
 [[271 141]
 [ 83  46]]
Validation f1: 29.11
Validation accuracy: 58.60
Validation recall: 35.66
Validation precision: 24.60
Validation AUC: 0.29631121803458593
Validation class accuracies: [0.6577669902912622, 0.35658914728682173]
TARGET: 1
target metric(test f1): 0.2911392405063291
column_sums: [354 187]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 21 epochs
Epoch 47/80
297/297 - 580s - loss: 0.1792 - accuracy: 0.9338 - val_loss: 1.1591 - val_accuracy: 0.5841
Confusion matrix: 
 [[269 143]
 [ 82  47]]
Validation f1: 29.47
Validation accuracy: 58.41
Validation recall: 36.43
Validation precision: 24.74
Validation AUC: 0.2973910190913852
Validation class accuracies: [0.6529126213592233, 0.3643410852713178]
TARGET: 1
target metric(test f1): 0.2946708463949843
column_sums: [351 190]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 22 epochs
Epoch 48/80
297/297 - 580s - loss: 0.1751 - accuracy: 0.9285 - val_loss: 1.1719 - val_accuracy: 0.5878
Confusion matrix: 
 [[271 141]
 [ 82  47]]
Validation f1: 29.65
Validation accuracy: 58.78
Validation recall: 36.43
Validation precision: 25.00
Validation AUC: 0.3012346518133052
Validation class accuracies: [0.6577669902912622, 0.3643410852713178]
TARGET: 1
target metric(test f1): 0.29652996845425866
column_sums: [353 188]
cm_sum: 541
inside not defaulting
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 23 epochs
Epoch 49/80
297/297 - 580s - loss: 0.1756 - accuracy: 0.9340 - val_loss: 1.1698 - val_accuracy: 0.5860
Confusion matrix: 
 [[271 141]
 [ 83  46]]
Validation f1: 29.11
Validation accuracy: 58.60
Validation recall: 35.66
Validation precision: 24.60
Validation AUC: 0.3030167321261009
Validation class accuracies: [0.6577669902912622, 0.35658914728682173]
TARGET: 1
target metric(test f1): 0.2911392405063291
column_sums: [354 187]
cm_sum: 541
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.4289855072463768 hasn't increased by 0 in 24 epochs
Epoch 50/80
297/297 - 581s - loss: 0.1775 - accuracy: 0.9281 - val_loss: 1.1585 - val_accuracy: 0.5841
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[269 143]
 [ 82  47]]
Validation f1: 29.47
Validation accuracy: 58.41
Validation recall: 36.43
Validation precision: 24.74
Validation AUC: 0.2958190712238533
Validation class accuracies: [0.6529126213592233, 0.3643410852713178]

The metrics for the epoch with the best target metric are: 
Best cm: [[270 142]
 [ 55  74]]
Best f1: 0.4289855072463768
Best accuracy: 0.6358595194085028
Best recall: 0.5736434108527132
Best precision: 0.3425925925925926
Best AUC: 0.3418384416316777
Best epoch: 25
TARGET: 1
target metric(test f1): 0.2946708463949843
column_sums: [351 190]
cm_sum: 541
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 12
Starting...
CM: [[14 13]
 [ 0 11]]
F1: 0.6285714285714286
AUC: 0.7291666666666666
Accuracy: 0.6578947368421053
Precision: 0.4583333333333333
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_12.xls...
Done.
Epoch: 12
Starting...
CM: [[19  8]
 [ 2  9]]
F1: 0.6428571428571428
AUC: 0.7001125809175344
Accuracy: 0.7368421052631579
Precision: 0.5294117647058824
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_12.xls...
Done.
Epoch: 12
Starting...
CM: [[20  7]
 [ 7  4]]
F1: 0.36363636363636365
AUC: 0.45574162679425845
Accuracy: 0.631578947368421
Precision: 0.36363636363636365
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_12.xls...
Done.
Epoch: 18
Starting...
CM: [[10 17]
 [ 0 11]]
F1: 0.5641025641025641
AUC: 0.6964285714285714
Accuracy: 0.5526315789473685
Precision: 0.39285714285714285
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_18.xls...
Done.
Epoch: 18
Starting...
CM: [[17 10]
 [ 2  9]]
F1: 0.6
AUC: 0.6722488038277512
Accuracy: 0.6842105263157895
Precision: 0.47368421052631576
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_18.xls...
Done.
Epoch: 18
Starting...
CM: [[24  3]
 [ 4  7]]
F1: 0.6666666666666666
AUC: 0.7208133971291866
Accuracy: 0.8157894736842105
Precision: 0.7
Recall: 0.6363636363636364
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_18.xls...
Done.
Epoch: 25
Starting...
CM: [[ 3 24]
 [ 0 11]]
F1: 0.4782608695652174
AUC: 0.6571428571428571
Accuracy: 0.3684210526315789
Precision: 0.3142857142857143
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_25.xls...
Done.
Epoch: 25
Starting...
CM: [[10 17]
 [ 0 11]]
F1: 0.5641025641025641
AUC: 0.6964285714285714
Accuracy: 0.5526315789473685
Precision: 0.39285714285714285
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_25.xls...
Done.
Epoch: 25
Starting...
CM: [[18  9]
 [ 3  8]]
F1: 0.5714285714285714
AUC: 0.6384041654939487
Accuracy: 0.6842105263157895
Precision: 0.47058823529411764
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_25.xls...
Done.
Epoch: 80
Starting...
CM: [[ 2 25]
 [ 0 11]]
F1: 0.46808510638297873
AUC: 0.6527777777777778
Accuracy: 0.34210526315789475
Precision: 0.3055555555555556
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_80.xls...
Done.
Epoch: 80
Starting...
CM: [[ 8 19]
 [ 3  8]]
F1: 0.42105263157894735
AUC: 0.5512581959950381
Accuracy: 0.42105263157894735
Precision: 0.2962962962962963
Recall: 0.7272727272727273
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_80.xls...
Done.
Epoch: 80
Starting...
CM: [[15 12]
 [ 7  4]]
F1: 0.2962962962962963
AUC: 0.39892344497607657
Accuracy: 0.5
Precision: 0.25
Recall: 0.36363636363636365
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_8_80.xls...
Done.
K-Fold split N: 9
With concat = False and six = False, size of training set: 4794...
...and size of validation set: 490
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_127 (InputLayer)          [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization_756 (BatchN (None, 128, 1250, 1) 4           input_127[0][0]                  
__________________________________________________________________________________________________
conv2d_630 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_756[0][0]    
__________________________________________________________________________________________________
conv2d_632 (Conv2D)             (None, 128, 1250, 16 32          batch_normalization_756[0][0]    
__________________________________________________________________________________________________
max_pooling2d_126 (MaxPooling2D (None, 128, 1250, 1) 0           batch_normalization_756[0][0]    
__________________________________________________________________________________________________
conv2d_631 (Conv2D)             (None, 128, 1250, 16 2320        conv2d_630[0][0]                 
__________________________________________________________________________________________________
conv2d_633 (Conv2D)             (None, 128, 1250, 16 6416        conv2d_632[0][0]                 
__________________________________________________________________________________________________
conv2d_634 (Conv2D)             (None, 128, 1250, 16 32          max_pooling2d_126[0][0]          
__________________________________________________________________________________________________
concatenate_126 (Concatenate)   (None, 128, 1250, 48 0           conv2d_631[0][0]                 
                                                                 conv2d_633[0][0]                 
                                                                 conv2d_634[0][0]                 
__________________________________________________________________________________________________
average_pooling2d_630 (AverageP (None, 64, 625, 48)  0           concatenate_126[0][0]            
__________________________________________________________________________________________________
batch_normalization_757 (BatchN (None, 64, 625, 48)  192         average_pooling2d_630[0][0]      
__________________________________________________________________________________________________
dropout_630 (Dropout)           (None, 64, 625, 48)  0           batch_normalization_757[0][0]    
__________________________________________________________________________________________________
inverted_residual_1260 (Inverte (None, 64, 625, 32)  35840       dropout_630[0][0]                
__________________________________________________________________________________________________
inverted_residual_1261 (Inverte (None, 64, 625, 32)  20864       inverted_residual_1260[0][0]     
__________________________________________________________________________________________________
average_pooling2d_631 (AverageP (None, 32, 312, 32)  0           inverted_residual_1261[0][0]     
__________________________________________________________________________________________________
batch_normalization_758 (BatchN (None, 32, 312, 32)  128         average_pooling2d_631[0][0]      
__________________________________________________________________________________________________
dropout_631 (Dropout)           (None, 32, 312, 32)  0           batch_normalization_758[0][0]    
__________________________________________________________________________________________________
inverted_residual_1262 (Inverte (None, 32, 312, 64)  27136       dropout_631[0][0]                
__________________________________________________________________________________________________
inverted_residual_1263 (Inverte (None, 32, 312, 64)  66304       inverted_residual_1262[0][0]     
__________________________________________________________________________________________________
average_pooling2d_632 (AverageP (None, 16, 156, 64)  0           inverted_residual_1263[0][0]     
__________________________________________________________________________________________________
batch_normalization_759 (BatchN (None, 16, 156, 64)  256         average_pooling2d_632[0][0]      
__________________________________________________________________________________________________
dropout_632 (Dropout)           (None, 16, 156, 64)  0           batch_normalization_759[0][0]    
__________________________________________________________________________________________________
inverted_residual_1264 (Inverte (None, 16, 156, 128) 91136       dropout_632[0][0]                
__________________________________________________________________________________________________
inverted_residual_1265 (Inverte (None, 16, 156, 128) 230912      inverted_residual_1264[0][0]     
__________________________________________________________________________________________________
average_pooling2d_633 (AverageP (None, 8, 78, 128)   0           inverted_residual_1265[0][0]     
__________________________________________________________________________________________________
batch_normalization_760 (BatchN (None, 8, 78, 128)   512         average_pooling2d_633[0][0]      
__________________________________________________________________________________________________
dropout_633 (Dropout)           (None, 8, 78, 128)   0           batch_normalization_760[0][0]    
__________________________________________________________________________________________________
inverted_residual_1266 (Inverte (None, 8, 78, 256)   329728      dropout_633[0][0]                
__________________________________________________________________________________________________
inverted_residual_1267 (Inverte (None, 8, 78, 256)   855040      inverted_residual_1266[0][0]     
__________________________________________________________________________________________________
average_pooling2d_634 (AverageP (None, 4, 39, 256)   0           inverted_residual_1267[0][0]     
__________________________________________________________________________________________________
batch_normalization_761 (BatchN (None, 4, 39, 256)   1024        average_pooling2d_634[0][0]      
__________________________________________________________________________________________________
dropout_634 (Dropout)           (None, 4, 39, 256)   0           batch_normalization_761[0][0]    
__________________________________________________________________________________________________
inverted_residual_1268 (Inverte (None, 4, 39, 512)   1249280     dropout_634[0][0]                
__________________________________________________________________________________________________
inverted_residual_1269 (Inverte (None, 4, 39, 512)   3282944     inverted_residual_1268[0][0]     
__________________________________________________________________________________________________
global_average_pooling2d_126 (G (None, 512)          0           inverted_residual_1269[0][0]     
__________________________________________________________________________________________________
dense_126 (Dense)               (None, 1)            513         global_average_pooling2d_126[0][0
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
binary
Epoch 1/80
300/300 - 591s - loss: 0.6818 - accuracy: 0.7174 - val_loss: 0.9104 - val_accuracy: 0.7633
Confusion matrix: 
 [[374   0]
 [116   0]]
Validation f1: 0.00
Validation accuracy: 76.33
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2589831739666797
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [490   0]
cm_sum: 490
The training is defaulting to either class.
Epoch 2/80
300/300 - 586s - loss: 0.5799 - accuracy: 0.7351 - val_loss: 0.5929 - val_accuracy: 0.7633
Confusion matrix: 
 [[374   0]
 [116   0]]
Validation f1: 0.00
Validation accuracy: 76.33
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2891447498678394
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [490   0]
cm_sum: 490
The training is defaulting to either class.
Epoch 3/80
300/300 - 586s - loss: 0.5756 - accuracy: 0.7374 - val_loss: 0.5686 - val_accuracy: 0.7633
Confusion matrix: 
 [[374   0]
 [116   0]]
Validation f1: 0.00
Validation accuracy: 76.33
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3060229906077978
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [490   0]
cm_sum: 490
The training is defaulting to either class.
Epoch 4/80
300/300 - 585s - loss: 0.5700 - accuracy: 0.7365 - val_loss: 0.5469 - val_accuracy: 0.7653
Confusion matrix: 
 [[370   4]
 [111   5]]
Validation f1: 8.00
Validation accuracy: 76.53
Validation recall: 4.31
Validation precision: 55.56
Validation AUC: 0.33395411498394356
Validation class accuracies: [0.9893048128342246, 0.04310344827586207]
TARGET: 1
target metric(test f1): 0.08
column_sums: [481   9]
cm_sum: 490
The training is defaulting to either class.
Epoch 5/80
300/300 - 584s - loss: 0.5646 - accuracy: 0.7376 - val_loss: 0.5684 - val_accuracy: 0.7571
Confusion matrix: 
 [[364  10]
 [109   7]]
Validation f1: 10.53
Validation accuracy: 75.71
Validation recall: 6.03
Validation precision: 41.18
Validation AUC: 0.29951986347538284
Validation class accuracies: [0.9732620320855615, 0.0603448275862069]
TARGET: 1
target metric(test f1): 0.10526315789473684
column_sums: [473  17]
cm_sum: 490
The training is defaulting to either class.
Epoch 6/80
300/300 - 586s - loss: 0.5637 - accuracy: 0.7365 - val_loss: 0.5552 - val_accuracy: 0.7571
Confusion matrix: 
 [[361  13]
 [106  10]]
Validation f1: 14.39
Validation accuracy: 75.71
Validation recall: 8.62
Validation precision: 43.48
Validation AUC: 0.29765274884474235
Validation class accuracies: [0.9652406417112299, 0.08620689655172414]
TARGET: 1
target metric(test f1): 0.14388489208633096
column_sums: [467  23]
cm_sum: 490
The training is defaulting to either class.
Epoch 7/80
300/300 - 586s - loss: 0.5606 - accuracy: 0.7363 - val_loss: 0.5555 - val_accuracy: 0.7633
Confusion matrix: 
 [[374   0]
 [116   0]]
Validation f1: 0.00
Validation accuracy: 76.33
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3702190315779763
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [490   0]
cm_sum: 490
The training is defaulting to either class.
Epoch 8/80
300/300 - 587s - loss: 0.5601 - accuracy: 0.7365 - val_loss: 0.5504 - val_accuracy: 0.7490
Confusion matrix: 
 [[358  16]
 [107   9]]
Validation f1: 12.77
Validation accuracy: 74.90
Validation recall: 7.76
Validation precision: 36.00
Validation AUC: 0.32146402565253734
Validation class accuracies: [0.9572192513368984, 0.07758620689655173]
TARGET: 1
target metric(test f1): 0.12765957446808512
column_sums: [465  25]
cm_sum: 490
The training is defaulting to either class.
Epoch 9/80
300/300 - 585s - loss: 0.5553 - accuracy: 0.7380 - val_loss: 0.5496 - val_accuracy: 0.7571
Confusion matrix: 
 [[364  10]
 [109   7]]
Validation f1: 10.53
Validation accuracy: 75.71
Validation recall: 6.03
Validation precision: 41.18
Validation AUC: 0.3095956520060577
Validation class accuracies: [0.9732620320855615, 0.0603448275862069]
TARGET: 1
target metric(test f1): 0.10526315789473684
column_sums: [473  17]
cm_sum: 490
The training is defaulting to either class.
Epoch 10/80
300/300 - 585s - loss: 0.5531 - accuracy: 0.7374 - val_loss: 0.5690 - val_accuracy: 0.7510
Confusion matrix: 
 [[366   8]
 [114   2]]
Validation f1: 3.17
Validation accuracy: 75.10
Validation recall: 1.72
Validation precision: 20.00
Validation AUC: 0.24797536968398753
Validation class accuracies: [0.9786096256684492, 0.017241379310344827]
TARGET: 1
target metric(test f1): 0.031746031746031744
column_sums: [480  10]
cm_sum: 490
The training is defaulting to either class.
Epoch 11/80
300/300 - 584s - loss: 0.5511 - accuracy: 0.7372 - val_loss: 0.5490 - val_accuracy: 0.7592
Confusion matrix: 
 [[372   2]
 [116   0]]
Validation f1: 0.00
Validation accuracy: 75.92
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.30049565258300187
Validation class accuracies: [0.9946524064171123, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [488   2]
cm_sum: 490
The training is defaulting to either class.
Epoch 12/80
300/300 - 585s - loss: 0.5445 - accuracy: 0.7405 - val_loss: 0.6865 - val_accuracy: 0.6510
Confusion matrix: 
 [[257 117]
 [ 54  62]]
Validation f1: 42.03
Validation accuracy: 65.10
Validation recall: 53.45
Validation precision: 34.64
Validation AUC: 0.33173648215922796
Validation class accuracies: [0.6871657754010695, 0.5344827586206896]
TARGET: 1
target metric(test f1): 0.42033898305084744
column_sums: [311 179]
cm_sum: 490
inside not defaulting
Saving model...
Epoch 13/80
300/300 - 585s - loss: 0.5389 - accuracy: 0.7426 - val_loss: 0.6128 - val_accuracy: 0.7633
Confusion matrix: 
 [[374   0]
 [116   0]]
Validation f1: 0.00
Validation accuracy: 76.33
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24971641002054198
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [490   0]
cm_sum: 490
The training is defaulting to either class.
Epoch 14/80
300/300 - 587s - loss: 0.5358 - accuracy: 0.7432 - val_loss: 0.5677 - val_accuracy: 0.7592
Confusion matrix: 
 [[362  12]
 [106  10]]
Validation f1: 14.49
Validation accuracy: 75.92
Validation recall: 8.62
Validation precision: 45.45
Validation AUC: 0.28291200750621315
Validation class accuracies: [0.9679144385026738, 0.08620689655172414]
TARGET: 1
target metric(test f1): 0.14492753623188406
column_sums: [468  22]
cm_sum: 490
The training is defaulting to either class.
Epoch 15/80
300/300 - 586s - loss: 0.5235 - accuracy: 0.7576 - val_loss: 0.7239 - val_accuracy: 0.6122
Confusion matrix: 
 [[249 125]
 [ 65  51]]
Validation f1: 34.93
Validation accuracy: 61.22
Validation recall: 43.97
Validation precision: 28.98
Validation AUC: 0.3149134968505838
Validation class accuracies: [0.6657754010695187, 0.4396551724137931]
TARGET: 1
target metric(test f1): 0.3493150684931507
column_sums: [314 176]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 1 epochs
Epoch 16/80
300/300 - 586s - loss: 0.5124 - accuracy: 0.7549 - val_loss: 0.5871 - val_accuracy: 0.7531
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[367   7]
 [114   2]]
Validation f1: 3.20
Validation accuracy: 75.31
Validation recall: 1.72
Validation precision: 22.22
Validation AUC: 0.25445115568914545
Validation class accuracies: [0.9812834224598931, 0.017241379310344827]
TARGET: 1
target metric(test f1): 0.032
column_sums: [481   9]
cm_sum: 490
The training is defaulting to either class.
Epoch 17/80
300/300 - 587s - loss: 0.5006 - accuracy: 0.7622 - val_loss: 0.6253 - val_accuracy: 0.7490
Confusion matrix: 
 [[362  12]
 [111   5]]
Validation f1: 7.52
Validation accuracy: 74.90
Validation recall: 4.31
Validation precision: 29.41
Validation AUC: 0.2573070082116052
Validation class accuracies: [0.9679144385026738, 0.04310344827586207]
TARGET: 1
target metric(test f1): 0.07518796992481204
column_sums: [473  17]
cm_sum: 490
The training is defaulting to either class.
Epoch 18/80
300/300 - 586s - loss: 0.4921 - accuracy: 0.7714 - val_loss: 0.9330 - val_accuracy: 0.7633
Confusion matrix: 
 [[374   0]
 [116   0]]
Validation f1: 0.00
Validation accuracy: 76.33
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2839560249714719
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [490   0]
cm_sum: 490
The training is defaulting to either class.
Epoch 19/80
300/300 - 586s - loss: 0.4644 - accuracy: 0.7835 - val_loss: 0.6539 - val_accuracy: 0.7653
Confusion matrix: 
 [[373   1]
 [114   2]]
Validation f1: 3.36
Validation accuracy: 76.53
Validation recall: 1.72
Validation precision: 66.67
Validation AUC: 0.28173789395288606
Validation class accuracies: [0.9973262032085561, 0.017241379310344827]
TARGET: 1
target metric(test f1): 0.03361344537815126
column_sums: [487   3]
cm_sum: 490
The training is defaulting to either class.
Epoch 20/80
300/300 - 586s - loss: 0.4342 - accuracy: 0.8000 - val_loss: 1.7293 - val_accuracy: 0.4082
Confusion matrix: 
 [[108 266]
 [ 24  92]]
Validation f1: 38.82
Validation accuracy: 40.82
Validation recall: 79.31
Validation precision: 25.70
Validation AUC: 0.30484055640153507
Validation class accuracies: [0.2887700534759358, 0.7931034482758621]
TARGET: 1
target metric(test f1): 0.38818565400843885
column_sums: [132 358]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 2 epochs
Epoch 21/80
300/300 - 586s - loss: 0.4124 - accuracy: 0.8141 - val_loss: 0.7628 - val_accuracy: 0.6612
Confusion matrix: 
 [[276  98]
 [ 68  48]]
Validation f1: 36.64
Validation accuracy: 66.12
Validation recall: 41.38
Validation precision: 32.88
Validation AUC: 0.31040529165122654
Validation class accuracies: [0.7379679144385026, 0.41379310344827586]
TARGET: 1
target metric(test f1): 0.366412213740458
column_sums: [344 146]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 3 epochs
Epoch 22/80
300/300 - 585s - loss: 0.3777 - accuracy: 0.8329 - val_loss: 0.7439 - val_accuracy: 0.6796
Confusion matrix: 
 [[297  77]
 [ 80  36]]
Validation f1: 31.44
Validation accuracy: 67.96
Validation recall: 31.03
Validation precision: 31.86
Validation AUC: 0.3000074406675841
Validation class accuracies: [0.7941176470588235, 0.3103448275862069]
TARGET: 1
target metric(test f1): 0.314410480349345
column_sums: [377 113]
cm_sum: 490
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 4 epochs
Epoch 23/80
300/300 - 586s - loss: 0.3036 - accuracy: 0.8728 - val_loss: 0.7956 - val_accuracy: 0.6939
Confusion matrix: 
 [[308  66]
 [ 84  32]]
Validation f1: 29.91
Validation accuracy: 69.39
Validation recall: 27.59
Validation precision: 32.65
Validation AUC: 0.2682696818827752
Validation class accuracies: [0.8235294117647058, 0.27586206896551724]
TARGET: 1
target metric(test f1): 0.2990654205607476
column_sums: [392  98]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 5 epochs
Epoch 24/80
300/300 - 585s - loss: 0.2623 - accuracy: 0.8930 - val_loss: 0.7783 - val_accuracy: 0.6898
Confusion matrix: 
 [[311  63]
 [ 89  27]]
Validation f1: 26.21
Validation accuracy: 68.98
Validation recall: 23.28
Validation precision: 30.00
Validation AUC: 0.2797758281196906
Validation class accuracies: [0.8315508021390374, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.2621359223300971
column_sums: [400  90]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 6 epochs
Epoch 25/80
300/300 - 586s - loss: 0.2471 - accuracy: 0.8982 - val_loss: 0.8423 - val_accuracy: 0.6755
Confusion matrix: 
 [[307  67]
 [ 92  24]]
Validation f1: 23.19
Validation accuracy: 67.55
Validation recall: 20.69
Validation precision: 26.37
Validation AUC: 0.25708438473529716
Validation class accuracies: [0.820855614973262, 0.20689655172413793]
TARGET: 1
target metric(test f1): 0.2318840579710145
column_sums: [399  91]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 7 epochs
Epoch 26/80
300/300 - 585s - loss: 0.2239 - accuracy: 0.9088 - val_loss: 0.8878 - val_accuracy: 0.7061
Confusion matrix: 
 [[326  48]
 [ 96  20]]
Validation f1: 21.74
Validation accuracy: 70.61
Validation recall: 17.24
Validation precision: 29.41
Validation AUC: 0.2724566999308302
Validation class accuracies: [0.8716577540106952, 0.1724137931034483]
TARGET: 1
target metric(test f1): 0.2173913043478261
column_sums: [422  68]
cm_sum: 490
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 8 epochs
Epoch 27/80
300/300 - 583s - loss: 0.1928 - accuracy: 0.9222 - val_loss: 0.9398 - val_accuracy: 0.6980
Confusion matrix: 
 [[311  63]
 [ 85  31]]
Validation f1: 29.52
Validation accuracy: 69.80
Validation recall: 26.72
Validation precision: 32.98
Validation AUC: 0.2637514429536093
Validation class accuracies: [0.8315508021390374, 0.2672413793103448]
TARGET: 1
target metric(test f1): 0.29523809523809524
column_sums: [396  94]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 9 epochs
Epoch 28/80
300/300 - 583s - loss: 0.1872 - accuracy: 0.9307 - val_loss: 0.9476 - val_accuracy: 0.7082
Confusion matrix: 
 [[319  55]
 [ 88  28]]
Validation f1: 28.14
Validation accuracy: 70.82
Validation recall: 24.14
Validation precision: 33.73
Validation AUC: 0.26205935021732946
Validation class accuracies: [0.8529411764705882, 0.2413793103448276]
TARGET: 1
target metric(test f1): 0.2814070351758794
column_sums: [407  83]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 10 epochs
Epoch 29/80
300/300 - 583s - loss: 0.1845 - accuracy: 0.9297 - val_loss: 0.9576 - val_accuracy: 0.6980
Confusion matrix: 
 [[318  56]
 [ 92  24]]
Validation f1: 24.49
Validation accuracy: 69.80
Validation recall: 20.69
Validation precision: 30.00
Validation AUC: 0.25348622541424487
Validation class accuracies: [0.8502673796791443, 0.20689655172413793]
TARGET: 1
target metric(test f1): 0.24489795918367346
column_sums: [410  80]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 11 epochs
Epoch 30/80
300/300 - 584s - loss: 0.1750 - accuracy: 0.9318 - val_loss: 0.9986 - val_accuracy: 0.6796
Confusion matrix: 
 [[304  70]
 [ 87  29]]
Validation f1: 26.98
Validation accuracy: 67.96
Validation recall: 25.00
Validation precision: 29.29
Validation AUC: 0.260507919538137
Validation class accuracies: [0.8128342245989305, 0.25]
TARGET: 1
target metric(test f1): 0.26976744186046514
column_sums: [391  99]
cm_sum: 490
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 12 epochs
Epoch 31/80
300/300 - 585s - loss: 0.1822 - accuracy: 0.9303 - val_loss: 0.9933 - val_accuracy: 0.6837
Confusion matrix: 
 [[307  67]
 [ 88  28]]
Validation f1: 26.54
Validation accuracy: 68.37
Validation recall: 24.14
Validation precision: 29.47
Validation AUC: 0.25645568032315946
Validation class accuracies: [0.820855614973262, 0.2413793103448276]
TARGET: 1
target metric(test f1): 0.2654028436018957
column_sums: [395  95]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 13 epochs
Epoch 32/80
300/300 - 583s - loss: 0.1719 - accuracy: 0.9335 - val_loss: 1.0043 - val_accuracy: 0.6816
Confusion matrix: 
 [[306  68]
 [ 88  28]]
Validation f1: 26.42
Validation accuracy: 68.16
Validation recall: 24.14
Validation precision: 29.17
Validation AUC: 0.257974177011535
Validation class accuracies: [0.8181818181818182, 0.2413793103448276]
TARGET: 1
target metric(test f1): 0.26415094339622647
column_sums: [394  96]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 14 epochs
Epoch 33/80
300/300 - 584s - loss: 0.1723 - accuracy: 0.9364 - val_loss: 1.0046 - val_accuracy: 0.6816
Confusion matrix: 
 [[308  66]
 [ 90  26]]
Validation f1: 25.00
Validation accuracy: 68.16
Validation recall: 22.41
Validation precision: 28.26
Validation AUC: 0.25389114273286717
Validation class accuracies: [0.8235294117647058, 0.22413793103448276]
TARGET: 1
target metric(test f1): 0.24999999999999994
column_sums: [398  92]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 15 epochs
Epoch 34/80
300/300 - 584s - loss: 0.1795 - accuracy: 0.9257 - val_loss: 1.0028 - val_accuracy: 0.6837
Confusion matrix: 
 [[308  66]
 [ 89  27]]
Validation f1: 25.84
Validation accuracy: 68.37
Validation recall: 23.28
Validation precision: 29.03
Validation AUC: 0.25600753909041785
Validation class accuracies: [0.8235294117647058, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.2583732057416268
column_sums: [397  93]
cm_sum: 490
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 16 epochs
Epoch 35/80
300/300 - 584s - loss: 0.1640 - accuracy: 0.9349 - val_loss: 1.0101 - val_accuracy: 0.6816
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Confusion matrix: 
 [[307  67]
 [ 89  27]]
Validation f1: 25.71
Validation accuracy: 68.16
Validation recall: 23.28
Validation precision: 28.72
Validation AUC: 0.2553026844097489
Validation class accuracies: [0.820855614973262, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.2571428571428572
column_sums: [396  94]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 17 epochs
Epoch 36/80
300/300 - 584s - loss: 0.1706 - accuracy: 0.9339 - val_loss: 1.0111 - val_accuracy: 0.6878
Confusion matrix: 
 [[310  64]
 [ 89  27]]
Validation f1: 26.09
Validation accuracy: 68.78
Validation recall: 23.28
Validation precision: 29.67
Validation AUC: 0.25745925748799153
Validation class accuracies: [0.8288770053475936, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.2608695652173913
column_sums: [399  91]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 18 epochs
Epoch 37/80
300/300 - 584s - loss: 0.1607 - accuracy: 0.9395 - val_loss: 1.0077 - val_accuracy: 0.6735
Confusion matrix: 
 [[303  71]
 [ 89  27]]
Validation f1: 25.23
Validation accuracy: 67.35
Validation recall: 23.28
Validation precision: 27.55
Validation AUC: 0.2533763580041857
Validation class accuracies: [0.8101604278074866, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.25233644859813087
column_sums: [392  98]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 19 epochs
Epoch 38/80
300/300 - 583s - loss: 0.1727 - accuracy: 0.9295 - val_loss: 1.0145 - val_accuracy: 0.6816
Confusion matrix: 
 [[307  67]
 [ 89  27]]
Validation f1: 25.71
Validation accuracy: 68.16
Validation recall: 23.28
Validation precision: 28.72
Validation AUC: 0.2569532521621289
Validation class accuracies: [0.820855614973262, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.2571428571428572
column_sums: [396  94]
cm_sum: 490
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 20 epochs
Epoch 39/80
300/300 - 584s - loss: 0.1656 - accuracy: 0.9351 - val_loss: 1.0212 - val_accuracy: 0.6816
Confusion matrix: 
 [[307  67]
 [ 89  27]]
Validation f1: 25.71
Validation accuracy: 68.16
Validation recall: 23.28
Validation precision: 28.72
Validation AUC: 0.2564816726462158
Validation class accuracies: [0.820855614973262, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.2571428571428572
column_sums: [396  94]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 21 epochs
Epoch 40/80
300/300 - 584s - loss: 0.1759 - accuracy: 0.9297 - val_loss: 1.0107 - val_accuracy: 0.6796
Confusion matrix: 
 [[307  67]
 [ 90  26]]
Validation f1: 24.88
Validation accuracy: 67.96
Validation recall: 22.41
Validation precision: 27.96
Validation AUC: 0.25418229155515676
Validation class accuracies: [0.820855614973262, 0.22413793103448276]
TARGET: 1
target metric(test f1): 0.24880382775119617
column_sums: [397  93]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 22 epochs
Epoch 41/80
300/300 - 583s - loss: 0.1695 - accuracy: 0.9314 - val_loss: 1.0116 - val_accuracy: 0.6796
Confusion matrix: 
 [[306  68]
 [ 89  27]]
Validation f1: 25.59
Validation accuracy: 67.96
Validation recall: 23.28
Validation precision: 28.42
Validation AUC: 0.25365845968785555
Validation class accuracies: [0.8181818181818182, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.2559241706161137
column_sums: [395  95]
cm_sum: 490
inside not defaulting
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 23 epochs
Epoch 42/80
300/300 - 586s - loss: 0.1684 - accuracy: 0.9389 - val_loss: 1.0082 - val_accuracy: 0.6918
Confusion matrix: 
 [[312  62]
 [ 89  27]]
Validation f1: 26.34
Validation accuracy: 69.18
Validation recall: 23.28
Validation precision: 30.34
Validation AUC: 0.25539397050521595
Validation class accuracies: [0.8342245989304813, 0.23275862068965517]
TARGET: 1
target metric(test f1): 0.2634146341463414
column_sums: [401  89]
cm_sum: 490
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.42033898305084744 hasn't increased by 0 in 24 epochs
Epoch 43/80
300/300 - 583s - loss: 0.1687 - accuracy: 0.9349 - val_loss: 1.0179 - val_accuracy: 0.6918
Confusion matrix: 
 [[312  62]
 [ 89  27]]
Validation f1: 26.34
Validation accuracy: 69.18
Validation recall: 23.28
Validation precision: 30.34
Validation AUC: 0.2566102559375353
Validation class accuracies: [0.8342245989304813, 0.23275862068965517]

The metrics for the epoch with the best target metric are: 
Best cm: [[257 117]
 [ 54  62]]
Best f1: 0.42033898305084744
Best accuracy: 0.6510204081632653
Best recall: 0.5344827586206896
Best precision: 0.3463687150837989
Best AUC: 0.33173648215922796
Best epoch: 12
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
TARGET: 1
target metric(test f1): 0.2634146341463414
column_sums: [401  89]
cm_sum: 490
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 12
Starting...
CM: [[ 8 19]
 [ 1  9]]
F1: 0.4736842105263158
AUC: 0.6242277992277993
Accuracy: 0.4594594594594595
Precision: 0.32142857142857145
Recall: 0.9
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_9_12.xls...
Done.
Epoch: 12
Starting...
CM: [[13 14]
 [ 2  8]]
F1: 0.5000000000000001
AUC: 0.6088452088452089
Accuracy: 0.5675675675675675
Precision: 0.36363636363636365
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_9_12.xls...
Done.
Epoch: 12
Starting...
CM: [[19  8]
 [ 3  7]]
F1: 0.56
AUC: 0.6238738738738738
Accuracy: 0.7027027027027027
Precision: 0.4666666666666667
Recall: 0.7
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_9_12.xls...
Done.
Epoch: 80
Starting...
CM: [[14 13]
 [ 2  8]]
F1: 0.5161290322580645
AUC: 0.6175032175032176
Accuracy: 0.5945945945945946
Precision: 0.38095238095238093
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_9_80.xls...
Done.
Epoch: 80
Starting...
CM: [[19  8]
 [ 5  5]]
F1: 0.4347826086956522
AUC: 0.5098752598752598
Accuracy: 0.6486486486486487
Precision: 0.38461538461538464
Recall: 0.5
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_9_80.xls...
Done.
Epoch: 80
Starting...
CM: [[25  2]
 [ 9  1]]
F1: 0.15384615384615383
AUC: 0.33828828828828833
Accuracy: 0.7027027027027027
Precision: 0.3333333333333333
Recall: 0.1
Ended. Saving the Excel Sheet ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/validation_sheet_9_80.xls...
Done.

 See logs at ../../new_cache/conv__2145__05_1700__v29__kfold_mod9/logs/