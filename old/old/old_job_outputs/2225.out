Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2225
Description:  v42
2021-06-16 16:34:00.136793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-16 16:34:02.741534: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 16:34:02.742651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-16 16:34:02.758693: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:02.759619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 16:34:02.759665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 16:34:02.764399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 16:34:02.764525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 16:34:02.766021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 16:34:02.766427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 16:34:02.768009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 16:34:02.769193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 16:34:02.769406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 16:34:02.769557: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:02.770334: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:02.770976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2225.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2225__06_1632__v39__v42
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 148, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 250, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-16 16:34:08.091474: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 16:34:08.091850: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:08.092922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 16:34:08.093015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 16:34:08.093116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 16:34:08.093183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 16:34:08.093237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 16:34:08.093283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 16:34:08.093328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 16:34:08.093373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 16:34:08.093413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 16:34:08.093565: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:08.094735: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:08.095661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-16 16:34:08.095759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 16:34:08.939247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-16 16:34:08.939291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-16 16:34:08.939299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-16 16:34:08.939594: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:08.940359: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:08.941022: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 16:34:08.941659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2582
-----------------------
Number of train recordings: 2582 with pneumonia: 232 and non-pneumonia: 2350
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-16 16:34:10.454435: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-16 16:34:10.456589: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-16 16:34:10.883577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 16:34:13.041954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 16:34:13.539025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
162/162 - 230s - loss: 1.1206 - accuracy: 0.5596 - val_loss: 0.4133 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.13644948222946413
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
162/162 - 229s - loss: 0.5918 - accuracy: 0.6665 - val_loss: 0.2136 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0863924788285987
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
162/162 - 230s - loss: 0.4958 - accuracy: 0.7347 - val_loss: 0.2579 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.04760132710021908
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
162/162 - 230s - loss: 0.4055 - accuracy: 0.7723 - val_loss: 0.3435 - val_accuracy: 0.8612
Confusion matrix: 
 [[506  67]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.531 0.469]]
Validation f1: 26.32
Validation accuracy: 86.12
Validation recall: 46.88
Validation precision: 18.29
Validation AUC: 0.39385337160627454
Validation class accuracies: [0.8830715532286213, 0.46875]
Saving model...
Epoch 5/65
162/162 - 230s - loss: 0.2823 - accuracy: 0.8389 - val_loss: 2.7927 - val_accuracy: 0.3471
Confusion matrix: 
 [[183 390]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.319 0.681]
 [0.156 0.844]]
Validation f1: 12.03
Validation accuracy: 34.71
Validation recall: 84.38
Validation precision: 6.47
Validation AUC: 0.5320238976215214
Validation class accuracies: [0.3193717277486911, 0.84375]
The validation tracker metric at 0.2631578947368421 hasn't increased by 0 in 1 epochs
Epoch 6/65
162/162 - 230s - loss: 0.2742 - accuracy: 0.8668 - val_loss: 0.6210 - val_accuracy: 0.8826
Confusion matrix: 
 [[520  53]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.562 0.438]]
Validation f1: 28.28
Validation accuracy: 88.26
Validation recall: 43.75
Validation precision: 20.90
Validation AUC: 0.35122451478053135
Validation class accuracies: [0.9075043630017452, 0.4375]
Saving model...
Epoch 7/65
162/162 - 231s - loss: 0.3046 - accuracy: 0.8513 - val_loss: 3.8218 - val_accuracy: 0.2579
Confusion matrix: 
 [[124 449]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.216 0.784]
 [0.    1.   ]]
Validation f1: 12.48
Validation accuracy: 25.79
Validation recall: 100.00
Validation precision: 6.65
Validation AUC: 0.1623081784745763
Validation class accuracies: [0.2164048865619546, 1.0]
The validation tracker metric at 0.2828282828282829 hasn't increased by 0 in 1 epochs
Epoch 8/65
162/162 - 230s - loss: 0.1800 - accuracy: 0.9136 - val_loss: 0.5645 - val_accuracy: 0.8446
Confusion matrix: 
 [[490  83]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.855 0.145]
 [0.344 0.656]]
Validation f1: 30.88
Validation accuracy: 84.46
Validation recall: 65.62
Validation precision: 20.19
Validation AUC: 0.5768825883305817
Validation class accuracies: [0.8551483420593369, 0.65625]
Saving model...
Epoch 9/65
162/162 - 230s - loss: 0.2096 - accuracy: 0.9024 - val_loss: 0.6584 - val_accuracy: 0.8364
Confusion matrix: 
 [[481  92]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.219 0.781]]
Validation f1: 33.56
Validation accuracy: 83.64
Validation recall: 78.12
Validation precision: 21.37
Validation AUC: 0.6190151137884805
Validation class accuracies: [0.8394415357766143, 0.78125]
Saving model...
Epoch 10/65
162/162 - 230s - loss: 0.1264 - accuracy: 0.9384 - val_loss: 7.8701 - val_accuracy: 0.2545
Confusion matrix: 
 [[122 451]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.213 0.787]
 [0.    1.   ]]
Validation f1: 12.43
Validation accuracy: 25.45
Validation recall: 100.00
Validation precision: 6.63
Validation AUC: 0.5201744690744885
Validation class accuracies: [0.21291448516579406, 1.0]
The validation tracker metric at 0.3355704697986577 hasn't increased by 0 in 1 epochs
Epoch 11/65
162/162 - 230s - loss: 0.1742 - accuracy: 0.9253 - val_loss: 0.6160 - val_accuracy: 0.8364
Confusion matrix: 
 [[485  88]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.344 0.656]]
Validation f1: 29.79
Validation accuracy: 83.64
Validation recall: 65.62
Validation precision: 19.27
Validation AUC: 0.5540551981600383
Validation class accuracies: [0.8464223385689355, 0.65625]
The validation tracker metric at 0.3355704697986577 hasn't increased by 0 in 2 epochs
Epoch 12/65
162/162 - 230s - loss: 0.1190 - accuracy: 0.9473 - val_loss: 0.9231 - val_accuracy: 0.7058
Confusion matrix: 
 [[402 171]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.702 0.298]
 [0.219 0.781]]
Validation f1: 21.93
Validation accuracy: 70.58
Validation recall: 78.12
Validation precision: 12.76
Validation AUC: 0.6100458478954187
Validation class accuracies: [0.7015706806282722, 0.78125]
The validation tracker metric at 0.3355704697986577 hasn't increased by 0 in 3 epochs
Epoch 13/65
162/162 - 230s - loss: 0.0716 - accuracy: 0.9632 - val_loss: 1.8176 - val_accuracy: 0.5388
Confusion matrix: 
 [[303 270]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.529 0.471]
 [0.281 0.719]]
Validation f1: 14.15
Validation accuracy: 53.88
Validation recall: 71.88
Validation precision: 7.85
Validation AUC: 0.42364236619315326
Validation class accuracies: [0.5287958115183246, 0.71875]
The validation tracker metric at 0.3355704697986577 hasn't increased by 0 in 4 epochs
Epoch 14/65
162/162 - 230s - loss: 0.1531 - accuracy: 0.9504 - val_loss: 2.1836 - val_accuracy: 0.7471
Confusion matrix: 
 [[431 142]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.752 0.248]
 [0.344 0.656]]
Validation f1: 21.54
Validation accuracy: 74.71
Validation recall: 65.62
Validation precision: 12.88
Validation AUC: 0.2116811853599847
Validation class accuracies: [0.7521815008726004, 0.65625]
The validation tracker metric at 0.3355704697986577 hasn't increased by 0 in 5 epochs
Epoch 15/65
162/162 - 230s - loss: 0.1889 - accuracy: 0.9191 - val_loss: 0.7869 - val_accuracy: 0.7719
Confusion matrix: 
 [[445 128]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.777 0.223]
 [0.312 0.688]]
Validation f1: 24.18
Validation accuracy: 77.19
Validation recall: 68.75
Validation precision: 14.67
Validation AUC: 0.6612745686677918
Validation class accuracies: [0.7766143106457243, 0.6875]
The validation tracker metric at 0.3355704697986577 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
162/162 - 230s - loss: 0.0749 - accuracy: 0.9597 - val_loss: 0.3529 - val_accuracy: 0.8843
Confusion matrix: 
 [[515  58]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.375 0.625]]
Validation f1: 36.36
Validation accuracy: 88.43
Validation recall: 62.50
Validation precision: 25.64
Validation AUC: 0.6518042024116625
Validation class accuracies: [0.8987783595113438, 0.625]
Saving model...
Epoch 17/65
162/162 - 230s - loss: 0.0721 - accuracy: 0.9644 - val_loss: 0.6990 - val_accuracy: 0.7934
Confusion matrix: 
 [[457 116]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.798 0.202]
 [0.281 0.719]]
Validation f1: 26.90
Validation accuracy: 79.34
Validation recall: 71.88
Validation precision: 16.55
Validation AUC: 0.6049383107350581
Validation class accuracies: [0.7975567190226877, 0.71875]
The validation tracker metric at 0.3636363636363636 hasn't increased by 0 in 1 epochs
Epoch 18/65
162/162 - 231s - loss: 0.0538 - accuracy: 0.9737 - val_loss: 0.3976 - val_accuracy: 0.8678
Confusion matrix: 
 [[506  67]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.406 0.594]]
Validation f1: 32.20
Validation accuracy: 86.78
Validation recall: 59.38
Validation precision: 22.09
Validation AUC: 0.5984940823076755
Validation class accuracies: [0.8830715532286213, 0.59375]
The validation tracker metric at 0.3636363636363636 hasn't increased by 0 in 2 epochs
Epoch 19/65
162/162 - 230s - loss: 0.0388 - accuracy: 0.9861 - val_loss: 1.4326 - val_accuracy: 0.6579
Confusion matrix: 
 [[379 194]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.661 0.339]
 [0.406 0.594]]
Validation f1: 15.51
Validation accuracy: 65.79
Validation recall: 59.38
Validation precision: 8.92
Validation AUC: 0.4522860591421772
Validation class accuracies: [0.6614310645724258, 0.59375]
The validation tracker metric at 0.3636363636363636 hasn't increased by 0 in 3 epochs
Epoch 20/65
162/162 - 230s - loss: 0.0802 - accuracy: 0.9628 - val_loss: 0.2900 - val_accuracy: 0.9190
Confusion matrix: 
 [[536  37]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.94
Validation accuracy: 91.90
Validation recall: 62.50
Validation precision: 35.09
Validation AUC: 0.6681135671794953
Validation class accuracies: [0.9354275741710296, 0.625]
Saving model...
Epoch 21/65
162/162 - 230s - loss: 0.0399 - accuracy: 0.9806 - val_loss: 0.1796 - val_accuracy: 0.9636
Confusion matrix: 
 [[564   9]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.406 0.594]]
Validation f1: 63.33
Validation accuracy: 96.36
Validation recall: 59.38
Validation precision: 67.86
Validation AUC: 0.6602872272368733
Validation class accuracies: [0.9842931937172775, 0.59375]
Saving model...
Epoch 22/65
162/162 - 230s - loss: 0.0310 - accuracy: 0.9876 - val_loss: 0.2967 - val_accuracy: 0.9074
Confusion matrix: 
 [[530  43]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.406 0.594]]
Validation f1: 40.43
Validation accuracy: 90.74
Validation recall: 59.38
Validation precision: 30.65
Validation AUC: 0.6203131418645456
Validation class accuracies: [0.924956369982548, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 1 epochs
Epoch 23/65
162/162 - 230s - loss: 0.0280 - accuracy: 0.9880 - val_loss: 0.6450 - val_accuracy: 0.7802
Confusion matrix: 
 [[452 121]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.375 0.625]]
Validation f1: 23.12
Validation accuracy: 78.02
Validation recall: 62.50
Validation precision: 14.18
Validation AUC: 0.5858378119683192
Validation class accuracies: [0.7888307155322862, 0.625]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 2 epochs
Epoch 24/65
162/162 - 230s - loss: 0.0352 - accuracy: 0.9864 - val_loss: 0.2726 - val_accuracy: 0.9471
Confusion matrix: 
 [[555  18]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.438 0.562]]
Validation f1: 52.94
Validation accuracy: 94.71
Validation recall: 56.25
Validation precision: 50.00
Validation AUC: 0.5626345796998626
Validation class accuracies: [0.9685863874345549, 0.5625]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 3 epochs
Epoch 25/65
162/162 - 231s - loss: 0.0292 - accuracy: 0.9876 - val_loss: 0.4044 - val_accuracy: 0.8645
Confusion matrix: 
 [[504  69]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.406 0.594]]
Validation f1: 31.67
Validation accuracy: 86.45
Validation recall: 59.38
Validation precision: 21.59
Validation AUC: 0.6103949421477264
Validation class accuracies: [0.8795811518324608, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 4 epochs
Epoch 26/65
162/162 - 230s - loss: 0.0227 - accuracy: 0.9899 - val_loss: 0.4217 - val_accuracy: 0.9041
Confusion matrix: 
 [[527  46]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.82
Validation accuracy: 90.41
Validation recall: 62.50
Validation precision: 30.30
Validation AUC: 0.5907486287509728
Validation class accuracies: [0.9197207678883071, 0.625]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 5 epochs
Epoch 27/65
162/162 - 230s - loss: 0.0330 - accuracy: 0.9853 - val_loss: 0.5980 - val_accuracy: 0.8678
Confusion matrix: 
 [[505  68]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.375 0.625]]
Validation f1: 33.33
Validation accuracy: 86.78
Validation recall: 62.50
Validation precision: 22.73
Validation AUC: 0.5826342060365223
Validation class accuracies: [0.881326352530541, 0.625]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 28/65
162/162 - 230s - loss: 0.0147 - accuracy: 0.9965 - val_loss: 0.3633 - val_accuracy: 0.9025
Confusion matrix: 
 [[527  46]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.406 0.594]]
Validation f1: 39.18
Validation accuracy: 90.25
Validation recall: 59.38
Validation precision: 29.23
Validation AUC: 0.575426632870605
Validation class accuracies: [0.9197207678883071, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 7 epochs
Epoch 29/65
162/162 - 230s - loss: 0.0142 - accuracy: 0.9946 - val_loss: 0.2952 - val_accuracy: 0.9289
Confusion matrix: 
 [[543  30]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.406 0.594]]
Validation f1: 46.91
Validation accuracy: 92.89
Validation recall: 59.38
Validation precision: 38.78
Validation AUC: 0.6080430437256988
Validation class accuracies: [0.9476439790575916, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 8 epochs
Epoch 30/65
162/162 - 230s - loss: 0.0331 - accuracy: 0.9868 - val_loss: 0.5116 - val_accuracy: 0.9091
Confusion matrix: 
 [[531  42]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.406 0.594]]
Validation f1: 40.86
Validation accuracy: 90.91
Validation recall: 59.38
Validation precision: 31.15
Validation AUC: 0.51163520113454
Validation class accuracies: [0.9267015706806283, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 9 epochs
Epoch 31/65
162/162 - 230s - loss: 0.0213 - accuracy: 0.9923 - val_loss: 0.7027 - val_accuracy: 0.8678
Confusion matrix: 
 [[504  69]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88  0.12 ]
 [0.344 0.656]]
Validation f1: 34.43
Validation accuracy: 86.78
Validation recall: 65.62
Validation precision: 23.33
Validation AUC: 0.5353071356440203
Validation class accuracies: [0.8795811518324608, 0.65625]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 10 epochs
Epoch 32/65
162/162 - 230s - loss: 0.0144 - accuracy: 0.9934 - val_loss: 0.5544 - val_accuracy: 0.8579
Confusion matrix: 
 [[500  73]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.406 0.594]]
Validation f1: 30.65
Validation accuracy: 85.79
Validation recall: 59.38
Validation precision: 20.65
Validation AUC: 0.5669579303377869
Validation class accuracies: [0.8726003490401396, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 11 epochs
Epoch 33/65
162/162 - 230s - loss: 0.0102 - accuracy: 0.9965 - val_loss: 0.4315 - val_accuracy: 0.8893
Confusion matrix: 
 [[522  51]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.5   0.5  ]]
Validation f1: 32.32
Validation accuracy: 88.93
Validation recall: 50.00
Validation precision: 23.88
Validation AUC: 0.4819532224753851
Validation class accuracies: [0.9109947643979057, 0.5]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 34/65
162/162 - 230s - loss: 0.0114 - accuracy: 0.9969 - val_loss: 0.4884 - val_accuracy: 0.8612
Confusion matrix: 
 [[502  71]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.406 0.594]]
Validation f1: 31.15
Validation accuracy: 86.12
Validation recall: 59.38
Validation precision: 21.11
Validation AUC: 0.5411358003918253
Validation class accuracies: [0.8760907504363001, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 13 epochs
Epoch 35/65
162/162 - 230s - loss: 0.0085 - accuracy: 0.9977 - val_loss: 0.3830 - val_accuracy: 0.9074
Confusion matrix: 
 [[531  42]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.438 0.562]]
Validation f1: 39.13
Validation accuracy: 90.74
Validation recall: 56.25
Validation precision: 30.00
Validation AUC: 0.5331223950463229
Validation class accuracies: [0.9267015706806283, 0.5625]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 14 epochs
Epoch 36/65
162/162 - 230s - loss: 0.0085 - accuracy: 0.9977 - val_loss: 0.4891 - val_accuracy: 0.8893
Confusion matrix: 
 [[519  54]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.406 0.594]]
Validation f1: 36.19
Validation accuracy: 88.93
Validation recall: 59.38
Validation precision: 26.03
Validation AUC: 0.5321565165310208
Validation class accuracies: [0.9057591623036649, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 15 epochs
Epoch 37/65
162/162 - 230s - loss: 0.0066 - accuracy: 0.9977 - val_loss: 0.3942 - val_accuracy: 0.9107
Confusion matrix: 
 [[532  41]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.406 0.594]]
Validation f1: 41.30
Validation accuracy: 91.07
Validation recall: 59.38
Validation precision: 31.67
Validation AUC: 0.5338255071040706
Validation class accuracies: [0.9284467713787086, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 16 epochs
Epoch 38/65
162/162 - 230s - loss: 0.0076 - accuracy: 0.9985 - val_loss: 0.3827 - val_accuracy: 0.9074
Confusion matrix: 
 [[532  41]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.469 0.531]]
Validation f1: 37.78
Validation accuracy: 90.74
Validation recall: 53.12
Validation precision: 29.31
Validation AUC: 0.5007921266388506
Validation class accuracies: [0.9284467713787086, 0.53125]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 17 epochs
Epoch 39/65
162/162 - 230s - loss: 0.0086 - accuracy: 0.9981 - val_loss: 0.4232 - val_accuracy: 0.8826
Confusion matrix: 
 [[516  57]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.438 0.562]]
Validation f1: 33.64
Validation accuracy: 88.26
Validation recall: 56.25
Validation precision: 24.00
Validation AUC: 0.4928848821985386
Validation class accuracies: [0.900523560209424, 0.5625]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 40/65
162/162 - 231s - loss: 0.0086 - accuracy: 0.9996 - val_loss: 0.3772 - val_accuracy: 0.9124
Confusion matrix: 
 [[533  40]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.406 0.594]]
Validation f1: 41.76
Validation accuracy: 91.24
Validation recall: 59.38
Validation precision: 32.20
Validation AUC: 0.5470892092453098
Validation class accuracies: [0.9301919720767888, 0.59375]
The validation tracker metric at 0.6333333333333334 hasn't increased by 0 in 19 epochs
Epoch 41/65
162/162 - 232s - loss: 0.0095 - accuracy: 0.9985 - val_loss: 0.3512 - val_accuracy: 0.9124
Confusion matrix: 
 [[533  40]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.76
Validation accuracy: 91.24
Validation recall: 59.38
Validation precision: 32.20
Validation AUC: 0.586436868334734
Validation class accuracies: [0.9301919720767888, 0.59375]

The metrics for job 0 with the best target metric are: 
Best cm: [[564   9]
 [ 13  19]]
Best normalized cm: [[0.984 0.016]
 [0.406 0.594]]
Best f1: 0.63
Best accuracy: 0.96
Best recall: 0.59
Best precision: 0.68
Best AUC: 0.66
Best class accuracies: [0.9842931937172775, 0.59375]
Best epoch: 21
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 12012
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_163403-3fh9f4g5/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_163403-3fh9f4g5/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99845
wandb:         val_accuracy 0.9124
wandb:             _runtime 10004
wandb:           _timestamp 1623871247
wandb:                _step 307
wandb:           train_loss 0.00948
wandb:             val_loss 0.35124
wandb:           val_recall 0.59375
wandb:        val_precision 0.32203
wandb:               val_f1 0.41758
wandb:              val_auc 0.58644
wandb:                   lr 6e-05
wandb:          best_val_f1 0.63333
wandb:    best_val_accuracy 0.96364
wandb:   best_val_precision 0.67857
wandb:      best_val_recall 0.59375
wandb:             best_auc 0.66029
wandb:           best_epoch 21
wandb: Run history:
wandb:   train_accuracy ▁▃▄▄▅▆▆▇▆▇▇▇▇▇▇▇▇██▇████████████████████
wandb:     val_accuracy ███▇▂▇▁▇▇▁▇▅▄▆▆▇▆▇▅██▇▆█▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▄▃▃▃▂▂▂▂▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▁▃▁▄▁▁█▁▂▂▃▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁▁▁▄▇▄█▆▆█▆▆▆▆▆▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅▆▅▅▅▅▅▅▅▅▅
wandb:    val_precision ▁▁▁▃▂▃▂▃▃▂▃▂▂▂▃▄▃▃▂▅█▄▂▆▃▄▃▄▅▄▃▃▃▃▄▄▄▄▃▄
wandb:           val_f1 ▁▁▁▄▂▄▂▄▅▂▄▃▃▃▄▅▄▅▃▆█▅▄▇▅▆▅▅▆▆▅▄▅▄▅▅▆▅▅▆
wandb:          val_auc ▂▁▁▅▆▄▂▇▇▆▇▇▅▃██▇▇▆██▇▇▇▇▇▇▇▇▆▇▇▆▇▆▆▆▆▆▇
wandb:               lr ███████████████▄▄▄▄▄▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_163403-3fh9f4g5


 See logs at ../../new_cache/conv__2225__06_1632__v39__v42/logs/