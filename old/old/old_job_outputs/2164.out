Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2164
Description:  new_lstmdense
2021-05-27 22:38:16.921965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-27 22:38:19.654542: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-27 22:38:19.655724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-27 22:38:19.706955: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:19.707724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-27 22:38:19.707757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-27 22:38:19.711939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-27 22:38:19.712091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-27 22:38:19.713353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-27 22:38:19.713678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-27 22:38:19.714721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-27 22:38:19.715657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-27 22:38:19.715831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-27 22:38:19.715998: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:19.716827: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:19.717531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2164.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2164__05_2220__v29__new_lstmdense/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (1250, 128), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.31 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2164
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/3g316v0x
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210527_223819-3g316v0x
wandb: Run `wandb offline` to turn off syncing.
2021-05-27 22:38:25.324916: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-27 22:38:25.325266: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:25.326068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-27 22:38:25.326119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-27 22:38:25.326204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-27 22:38:25.326227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-27 22:38:25.326266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-27 22:38:25.326288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-27 22:38:25.326310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-27 22:38:25.326330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-27 22:38:25.326351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-27 22:38:25.326452: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:25.327271: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:25.327985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-27 22:38:25.328041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-27 22:38:26.128034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-27 22:38:26.128125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-27 22:38:26.128135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-27 22:38:26.128490: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:26.129405: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:26.130143: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-27 22:38:26.130880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-27 22:39:09.319057: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-27 22:39:09.320994: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-27 22:39:17.776043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-27 22:39:18.631609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-27 22:39:18.642656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 1250, 128)]  0                                            
__________________________________________________________________________________________________
layer_normalization (LayerNorma (None, 1250, 128)    256         input_1[0][0]                    
__________________________________________________________________________________________________
time_distributed (TimeDistribut (None, 1250, 128)    0           layer_normalization[0][0]        
__________________________________________________________________________________________________
td_dense_tanh (TimeDistributed) (None, 1250, 64)     8256        time_distributed[0][0]           
__________________________________________________________________________________________________
bidirectional (Bidirectional)   (None, 1250, 64)     24832       td_dense_tanh[0][0]              
__________________________________________________________________________________________________
skip_connection (Concatenate)   (None, 1250, 128)    0           td_dense_tanh[0][0]              
                                                                 bidirectional[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1250, 64)     8256        skip_connection[0][0]            
__________________________________________________________________________________________________
average_pooling1d (AveragePooli (None, 625, 64)      0           dense_1[0][0]                    
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 625, 64)      4160        average_pooling1d[0][0]          
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 625, 128)     66048       dense_2[0][0]                    
__________________________________________________________________________________________________
average_pooling1d_1 (AveragePoo (None, 312, 128)     0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 312, 128)     16512       average_pooling1d_1[0][0]        
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 312, 256)     263168      dense_3[0][0]                    
__________________________________________________________________________________________________
average_pooling1d_2 (AveragePoo (None, 156, 256)     0           bidirectional_2[0][0]            
__________________________________________________________________________________________________
flatten (Flatten)               (None, 39936)        0           average_pooling1d_2[0][0]        
__________________________________________________________________________________________________
dropout (Dropout)               (None, 39936)        0           flatten[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 128)          5111936     dropout[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 1)            129         dense_4[0][0]                    
==================================================================================================
Total params: 5,503,553
Trainable params: 5,503,553
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/80
263/263 - 98s - loss: 0.6915 - accuracy: 0.5727 - val_loss: 0.6561 - val_accuracy: 0.8015
Confusion matrix: 
 [[865   5]
 [211   7]]
Validation f1: 6.09
Validation accuracy: 80.15
Validation recall: 3.21
Validation precision: 58.33
Validation AUC: 0.26694179026257947
Validation class accuracies: [0.9942528735632183, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.06086956521739131
inside not defaulting
Saving model...
Epoch 2/80
263/263 - 85s - loss: 0.6806 - accuracy: 0.6115 - val_loss: 0.6680 - val_accuracy: 0.6149
Confusion matrix: 
 [[556 314]
 [105 113]]
Validation f1: 35.04
Validation accuracy: 61.49
Validation recall: 51.83
Validation precision: 26.46
Validation AUC: 0.26266552781005725
Validation class accuracies: [0.639080459770115, 0.518348623853211]
TARGET: 1
target metric(test f1): 0.35038759689922483
inside not defaulting
Saving model...
Epoch 3/80
263/263 - 92s - loss: 0.6751 - accuracy: 0.6063 - val_loss: 0.6524 - val_accuracy: 0.6066
Confusion matrix: 
 [[548 322]
 [106 112]]
Validation f1: 34.36
Validation accuracy: 60.66
Validation recall: 51.38
Validation precision: 25.81
Validation AUC: 0.24179239895325877
Validation class accuracies: [0.6298850574712643, 0.5137614678899083]
TARGET: 1
target metric(test f1): 0.34355828220858897
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 1 epochs
Epoch 4/80
263/263 - 109s - loss: 0.6669 - accuracy: 0.5908 - val_loss: 0.6253 - val_accuracy: 0.6517
Confusion matrix: 
 [[615 255]
 [124  94]]
Validation f1: 33.16
Validation accuracy: 65.17
Validation recall: 43.12
Validation precision: 26.93
Validation AUC: 0.23853557184769472
Validation class accuracies: [0.7068965517241379, 0.43119266055045874]
TARGET: 1
target metric(test f1): 0.3315696649029983
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 2 epochs
Epoch 5/80
263/263 - 106s - loss: 0.6347 - accuracy: 0.6332 - val_loss: 0.7611 - val_accuracy: 0.5276
Confusion matrix: 
 [[444 426]
 [ 88 130]]
Validation f1: 33.59
Validation accuracy: 52.76
Validation recall: 59.63
Validation precision: 23.38
Validation AUC: 0.24286061838408946
Validation class accuracies: [0.5103448275862069, 0.5963302752293578]
TARGET: 1
target metric(test f1): 0.3359173126614987
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 3 epochs
Epoch 6/80
263/263 - 131s - loss: 0.5346 - accuracy: 0.7312 - val_loss: 0.6973 - val_accuracy: 0.6434
Confusion matrix: 
 [[641 229]
 [159  59]]
Validation f1: 23.32
Validation accuracy: 64.34
Validation recall: 27.06
Validation precision: 20.49
Validation AUC: 0.2079993839402558
Validation class accuracies: [0.7367816091954023, 0.2706422018348624]
TARGET: 1
target metric(test f1): 0.23320158102766797
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 4 epochs
Epoch 7/80
263/263 - 117s - loss: 0.3331 - accuracy: 0.8715 - val_loss: 0.9191 - val_accuracy: 0.6112
Confusion matrix: 
 [[574 296]
 [127  91]]
Validation f1: 30.08
Validation accuracy: 61.12
Validation recall: 41.74
Validation precision: 23.51
Validation AUC: 0.22063449913118952
Validation class accuracies: [0.6597701149425287, 0.41743119266055045]
TARGET: 1
target metric(test f1): 0.3008264462809917
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 5 epochs
Epoch 8/80
263/263 - 100s - loss: 0.2480 - accuracy: 0.9228 - val_loss: 0.8599 - val_accuracy: 0.6314
Confusion matrix: 
 [[613 257]
 [144  74]]
Validation f1: 26.96
Validation accuracy: 63.14
Validation recall: 33.94
Validation precision: 22.36
Validation AUC: 0.21777607004263486
Validation class accuracies: [0.7045977011494253, 0.3394495412844037]
TARGET: 1
target metric(test f1): 0.26958105646630237
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 6 epochs
Epoch 9/80
263/263 - 100s - loss: 0.1963 - accuracy: 0.9485 - val_loss: 0.9154 - val_accuracy: 0.6507
Confusion matrix: 
 [[642 228]
 [152  66]]
Validation f1: 25.78
Validation accuracy: 65.07
Validation recall: 30.28
Validation precision: 22.45
Validation AUC: 0.2177838620004428
Validation class accuracies: [0.7379310344827587, 0.30275229357798167]
TARGET: 1
target metric(test f1): 0.25781250000000006
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 7 epochs
Epoch 10/80
263/263 - 101s - loss: 0.1610 - accuracy: 0.9652 - val_loss: 0.9539 - val_accuracy: 0.6829
Confusion matrix: 
 [[685 185]
 [160  58]]
Validation f1: 25.16
Validation accuracy: 68.29
Validation recall: 26.61
Validation precision: 23.87
Validation AUC: 0.22238182407398316
Validation class accuracies: [0.7873563218390804, 0.26605504587155965]
TARGET: 1
target metric(test f1): 0.25162689804772237
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 8 epochs
Epoch 11/80
263/263 - 100s - loss: 0.1341 - accuracy: 0.9828 - val_loss: 1.0077 - val_accuracy: 0.6691
Confusion matrix: 
 [[666 204]
 [156  62]]
Validation f1: 25.62
Validation accuracy: 66.91
Validation recall: 28.44
Validation precision: 23.31
Validation AUC: 0.2199943147168455
Validation class accuracies: [0.7655172413793103, 0.28440366972477066]
TARGET: 1
target metric(test f1): 0.25619834710743805
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 9 epochs
Epoch 12/80
263/263 - 100s - loss: 0.1272 - accuracy: 0.9831 - val_loss: 1.0159 - val_accuracy: 0.6728
Confusion matrix: 
 [[667 203]
 [153  65]]
Validation f1: 26.75
Validation accuracy: 67.28
Validation recall: 29.82
Validation precision: 24.25
Validation AUC: 0.22167496839332873
Validation class accuracies: [0.7666666666666667, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.2674897119341564
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 10 epochs
Epoch 13/80
263/263 - 100s - loss: 0.1224 - accuracy: 0.9838 - val_loss: 1.0363 - val_accuracy: 0.6710
Confusion matrix: 
 [[665 205]
 [153  65]]
Validation f1: 26.64
Validation accuracy: 67.10
Validation recall: 29.82
Validation precision: 24.07
Validation AUC: 0.220903110145843
Validation class accuracies: [0.764367816091954, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.26639344262295084
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 11 epochs
Epoch 14/80
263/263 - 100s - loss: 0.1179 - accuracy: 0.9850 - val_loss: 1.0482 - val_accuracy: 0.6682
Confusion matrix: 
 [[662 208]
 [153  65]]
Validation f1: 26.48
Validation accuracy: 66.82
Validation recall: 29.82
Validation precision: 23.81
Validation AUC: 0.22168025641293518
Validation class accuracies: [0.7609195402298851, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.264765784114053
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 12 epochs
Epoch 15/80
263/263 - 101s - loss: 0.1130 - accuracy: 0.9857 - val_loss: 1.0337 - val_accuracy: 0.6811
Confusion matrix: 
 [[677 193]
 [154  64]]
Validation f1: 26.95
Validation accuracy: 68.11
Validation recall: 29.36
Validation precision: 24.90
Validation AUC: 0.22220872183973223
Validation class accuracies: [0.7781609195402299, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.2694736842105263
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 13 epochs
Epoch 16/80
263/263 - 99s - loss: 0.1120 - accuracy: 0.9859 - val_loss: 1.0353 - val_accuracy: 0.6820
Confusion matrix: 
 [[678 192]
 [154  64]]
Validation f1: 27.00
Validation accuracy: 68.20
Validation recall: 29.36
Validation precision: 25.00
Validation AUC: 0.2223224485754992
Validation class accuracies: [0.7793103448275862, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.27004219409282704
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 14 epochs
Epoch 17/80
263/263 - 99s - loss: 0.1114 - accuracy: 0.9864 - val_loss: 1.0425 - val_accuracy: 0.6746
Confusion matrix: 
 [[669 201]
 [153  65]]
Validation f1: 26.86
Validation accuracy: 67.46
Validation recall: 29.82
Validation precision: 24.44
Validation AUC: 0.2218055068535486
Validation class accuracies: [0.7689655172413793, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.26859504132231404
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 15 epochs
Epoch 18/80
263/263 - 100s - loss: 0.1101 - accuracy: 0.9869 - val_loss: 1.0461 - val_accuracy: 0.6746
Confusion matrix: 
 [[669 201]
 [153  65]]
Validation f1: 26.86
Validation accuracy: 67.46
Validation recall: 29.82
Validation precision: 24.44
Validation AUC: 0.22186070445291886
Validation class accuracies: [0.7689655172413793, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.26859504132231404
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 16 epochs
Epoch 19/80
263/263 - 103s - loss: 0.1094 - accuracy: 0.9869 - val_loss: 1.0428 - val_accuracy: 0.6774
Confusion matrix: 
 [[672 198]
 [153  65]]
Validation f1: 27.03
Validation accuracy: 67.74
Validation recall: 29.82
Validation precision: 24.71
Validation AUC: 0.22204469393544357
Validation class accuracies: [0.7724137931034483, 0.2981651376146789]
TARGET: 1
target metric(test f1): 0.2702702702702703
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 17 epochs
Epoch 20/80
263/263 - 102s - loss: 0.1091 - accuracy: 0.9869 - val_loss: 1.0420 - val_accuracy: 0.6774
Confusion matrix: 
 [[673 197]
 [154  64]]
Validation f1: 26.72
Validation accuracy: 67.74
Validation recall: 29.36
Validation precision: 24.52
Validation AUC: 0.22205288642223334
Validation class accuracies: [0.7735632183908046, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.267223382045929
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 18 epochs
Epoch 21/80
263/263 - 100s - loss: 0.1090 - accuracy: 0.9871 - val_loss: 1.0416 - val_accuracy: 0.6783
Confusion matrix: 
 [[674 196]
 [154  64]]
Validation f1: 26.78
Validation accuracy: 67.83
Validation recall: 29.36
Validation precision: 24.62
Validation AUC: 0.2221708428171758
Validation class accuracies: [0.774712643678161, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.26778242677824265
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 19 epochs
Epoch 22/80
263/263 - 101s - loss: 0.1087 - accuracy: 0.9876 - val_loss: 1.0417 - val_accuracy: 0.6783
Confusion matrix: 
 [[674 196]
 [154  64]]
Validation f1: 26.78
Validation accuracy: 67.83
Validation recall: 29.36
Validation precision: 24.62
Validation AUC: 0.22211321474945822
Validation class accuracies: [0.774712643678161, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.26778242677824265
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 20 epochs
Epoch 23/80
263/263 - 101s - loss: 0.1084 - accuracy: 0.9876 - val_loss: 1.0418 - val_accuracy: 0.6783
Confusion matrix: 
 [[674 196]
 [154  64]]
Validation f1: 26.78
Validation accuracy: 67.83
Validation recall: 29.36
Validation precision: 24.62
Validation AUC: 0.22212059644042037
Validation class accuracies: [0.774712643678161, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.26778242677824265
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 21 epochs
Epoch 24/80
263/263 - 101s - loss: 0.1082 - accuracy: 0.9869 - val_loss: 1.0418 - val_accuracy: 0.6783
Confusion matrix: 
 [[674 196]
 [154  64]]
Validation f1: 26.78
Validation accuracy: 67.83
Validation recall: 29.36
Validation precision: 24.62
Validation AUC: 0.22213701649962517
Validation class accuracies: [0.774712643678161, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.26778242677824265
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 22 epochs
Epoch 25/80
263/263 - 101s - loss: 0.1082 - accuracy: 0.9874 - val_loss: 1.0418 - val_accuracy: 0.6783
Confusion matrix: 
 [[674 196]
 [154  64]]
Validation f1: 26.78
Validation accuracy: 67.83
Validation recall: 29.36
Validation precision: 24.62
Validation AUC: 0.22217001394529187
Validation class accuracies: [0.774712643678161, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.26778242677824265
inside not defaulting
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 23 epochs
Epoch 26/80
263/263 - 101s - loss: 0.1082 - accuracy: 0.9874 - val_loss: 1.0418 - val_accuracy: 0.6783
Confusion matrix: 
 [[674 196]
 [154  64]]
Validation f1: 26.78
Validation accuracy: 67.83
Validation recall: 29.36
Validation precision: 24.62
Validation AUC: 0.22214807302169423
Validation class accuracies: [0.774712643678161, 0.29357798165137616]
TARGET: 1
target metric(test f1): 0.26778242677824265
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.35038759689922483 hasn't increased by 0 in 24 epochs
Epoch 27/80
263/263 - 101s - loss: 0.1084 - accuracy: 0.9876 - val_loss: 1.0419 - val_accuracy: 0.6783
Confusion matrix: 
 [[674 196]
 [154  64]]
Validation f1: 26.78
Validation accuracy: 67.83
Validation recall: 29.36
Validation precision: 24.62
Validation AUC: 0.22213131965590086
Validation class accuracies: [0.774712643678161, 0.29357798165137616]

The metrics for the epoch with the best target metric are: 
Best cm: [[556 314]
 [105 113]]
Best f1: 0.35038759689922483
Best accuracy: 0.6148897058823529
Best recall: 0.518348623853211
Best precision: 0.2646370023419204
Best AUC: 0.26266552781005725
Best epoch: 2
TARGET: 1
target metric(test f1): 0.26778242677824265
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2164.py", line 330, in <module>
    train_model(**arguments)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2164.py", line 272, in train_model
    bd_f1, bd_accuracy, bd_precision, bd_recall, bd_auc, bd_y_true, bd_y_pred = generate_bangladesh_sheet(model, grouped_val_samples, excel_dest, six, initial_channels, pneumonia_threshold)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/pneumonia.py", line 182, in generate_bangladesh_sheet
    output = model.predict(np.array([arr]))
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1629, in predict
    tmp_batch_outputs = self.predict_function(iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 871, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 726, in _initialize
    *args, **kwds))
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2969, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 3206, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 634, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 977, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1478 predict_function  *
        return step_function(self, iterator)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1468 step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:1259 run
        return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:2730 call_for_each_replica
        return self._call_for_each_replica(fn, args, kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:3417 _call_for_each_replica
        return fn(*args, **kwargs)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1461 run_step  **
        outputs = model.predict_step(data)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1434 predict_step
        return self(x, training=False)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py:998 __call__
        input_spec.assert_input_compatibility(self.input_spec, inputs, self.name)
    /home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py:274 assert_input_compatibility
        ', found shape=' + display_shape(x.shape))

    ValueError: Input 0 is incompatible with layer conv2d: expected shape=(None, 1250, 128), found shape=(None, 128, 1250, 1)

wandb: Waiting for W&B process to finish, PID 14637
wandb: Program failed with code 1.  Press ctrl-c to abort syncing.
wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210527_223819-3g316v0x/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210527_223819-3g316v0x/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98761
wandb:         val_accuracy 0.67831
wandb:             _runtime 3391
wandb:           _timestamp 1622158490
wandb:                _step 194
wandb:           train_loss 0.1084
wandb:             val_loss 1.04185
wandb:           val_recall 0.29358
wandb:        val_precision 0.24615
wandb:               val_f1 0.26778
wandb:              val_auc 0.22213
wandb:                   lr 0.0
wandb:          best_val_f1 0.35039
wandb:    best_val_accuracy 0.61489
wandb:   best_val_precision 0.26464
wandb:      best_val_recall 0.51835
wandb:             best_auc 0.26267
wandb:           best_epoch 2
wandb: Run history:
wandb:   train_accuracy ▁▂▂▁▂▄▆▇▇██████████████████
wandb:     val_accuracy █▃▃▄▁▄▃▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ████▇▆▄▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▂▁▁▃▂▆▅▆▆▇▇███████████████
wandb:       val_recall ▁▇▇▆█▄▆▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:    val_precision █▂▂▂▂▁▂▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_f1 ▁████▅▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          val_auc █▇▅▅▅▁▃▂▂▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:               lr ██████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 6 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2164: https://wandb.ai/arachid1/tensorboard-integration/runs/3g316v0x


 See logs at ../../new_cache/conv__2164__05_2220__v29__new_lstmdense/logs/