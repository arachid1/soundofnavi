Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2114
Description:  mixednet_bsize32_lowerlr
2021-05-09 16:39:33.838439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 16:39:36.361416: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 16:39:36.362518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-09 16:39:36.418735: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:36.419478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 16:39:36.419508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 16:39:36.422968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 16:39:36.423063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 16:39:36.424092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 16:39:36.424363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 16:39:36.425352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 16:39:36.426273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 16:39:36.426437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 16:39:36.426555: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:36.427279: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:36.427911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2114.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 32, 'LR': 1e-05, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 3, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2114
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/3k3yzn23
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_163936-3k3yzn23
wandb: Run `wandb offline` to turn off syncing.
2021-05-09 16:39:42.361906: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 16:39:42.362203: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:42.363196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 16:39:42.363254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 16:39:42.363319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 16:39:42.363345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 16:39:42.363370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 16:39:42.363394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 16:39:42.363419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 16:39:42.363443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 16:39:42.363466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 16:39:42.363591: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:42.364596: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:42.365528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-09 16:39:42.365600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 16:39:43.125160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-09 16:39:43.125203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-09 16:39:43.125211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-09 16:39:43.125472: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:43.126273: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:43.126949: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 16:39:43.127584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-09 16:40:25.244429: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-09 16:40:25.246386: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-09 16:40:27.008334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 16:40:27.773282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 16:40:27.781454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 1)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      80        
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
132/132 - 158s - loss: 0.6841 - accuracy: 0.6130 - val_loss: 0.6724 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16658936943434877
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
132/132 - 150s - loss: 0.6798 - accuracy: 0.6215 - val_loss: 0.6543 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16073035054557427
Validation class accuracies: [1.0, 0.0]
Epoch 3/40
132/132 - 150s - loss: 0.6773 - accuracy: 0.5922 - val_loss: 0.6415 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1623541943414425
Validation class accuracies: [1.0, 0.0]
Epoch 4/40
132/132 - 150s - loss: 0.6760 - accuracy: 0.6070 - val_loss: 0.6296 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16481998683755522
Validation class accuracies: [1.0, 0.0]
Epoch 5/40
132/132 - 150s - loss: 0.6729 - accuracy: 0.5949 - val_loss: 0.6282 - val_accuracy: 0.7877
Confusion matrix: 
 [[852  18]
 [213   5]]
Validation f1: 4.15
Validation accuracy: 78.77
Validation recall: 2.29
Validation precision: 21.74
Validation AUC: 0.21492244537815874
Validation class accuracies: [0.9793103448275862, 0.022935779816513763]
Epoch 6/40
132/132 - 150s - loss: 0.6723 - accuracy: 0.5965 - val_loss: 0.6530 - val_accuracy: 0.7243
Confusion matrix: 
 [[761 109]
 [191  27]]
Validation f1: 15.25
Validation accuracy: 72.43
Validation recall: 12.39
Validation precision: 19.85
Validation AUC: 0.22451882862853736
Validation class accuracies: [0.8747126436781609, 0.12385321100917432]
Saving model...
Epoch 7/40
132/132 - 150s - loss: 0.6719 - accuracy: 0.6037 - val_loss: 0.6703 - val_accuracy: 0.6746
Confusion matrix: 
 [[665 205]
 [149  69]]
Validation f1: 28.05
Validation accuracy: 67.46
Validation recall: 31.65
Validation precision: 25.18
Validation AUC: 0.2312108254905626
Validation class accuracies: [0.764367816091954, 0.3165137614678899]
Saving model...
Epoch 8/40
132/132 - 150s - loss: 0.6709 - accuracy: 0.6082 - val_loss: 0.6805 - val_accuracy: 0.6379
Confusion matrix: 
 [[611 259]
 [135  83]]
Validation f1: 29.64
Validation accuracy: 63.79
Validation recall: 38.07
Validation precision: 24.27
Validation AUC: 0.2283635972348141
Validation class accuracies: [0.7022988505747126, 0.38073394495412843]
Saving model...
Epoch 9/40
132/132 - 150s - loss: 0.6695 - accuracy: 0.6092 - val_loss: 0.6815 - val_accuracy: 0.6314
Confusion matrix: 
 [[600 270]
 [131  87]]
Validation f1: 30.26
Validation accuracy: 63.14
Validation recall: 39.91
Validation precision: 24.37
Validation AUC: 0.22719952672908872
Validation class accuracies: [0.6896551724137931, 0.39908256880733944]
The validation tracker metric at 0.29642857142857143 hasn't increased by 0.01 in 1 epochs
Saving model...
Epoch 10/40
132/132 - 150s - loss: 0.6701 - accuracy: 0.6099 - val_loss: 0.6883 - val_accuracy: 0.6094
Confusion matrix: 
 [[567 303]
 [122  96]]
Validation f1: 31.12
Validation accuracy: 60.94
Validation recall: 44.04
Validation precision: 24.06
Validation AUC: 0.2304785443948072
Validation class accuracies: [0.6517241379310345, 0.44036697247706424]
Saving model...
Epoch 11/40
132/132 - 150s - loss: 0.6685 - accuracy: 0.6161 - val_loss: 0.6833 - val_accuracy: 0.6241
Confusion matrix: 
 [[583 287]
 [122  96]]
Validation f1: 31.95
Validation accuracy: 62.41
Validation recall: 44.04
Validation precision: 25.07
Validation AUC: 0.23453472167127615
Validation class accuracies: [0.6701149425287356, 0.44036697247706424]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 1 epochs
Saving model...
Epoch 12/40
132/132 - 147s - loss: 0.6681 - accuracy: 0.6175 - val_loss: 0.6853 - val_accuracy: 0.6149
Confusion matrix: 
 [[570 300]
 [119  99]]
Validation f1: 32.09
Validation accuracy: 61.49
Validation recall: 45.41
Validation precision: 24.81
Validation AUC: 0.2344575333263866
Validation class accuracies: [0.6551724137931034, 0.4541284403669725]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 2 epochs
Saving model...
Epoch 13/40
132/132 - 147s - loss: 0.6667 - accuracy: 0.6194 - val_loss: 0.6815 - val_accuracy: 0.6241
Confusion matrix: 
 [[585 285]
 [124  94]]
Validation f1: 31.49
Validation accuracy: 62.41
Validation recall: 43.12
Validation precision: 24.80
Validation AUC: 0.23497596757334482
Validation class accuracies: [0.6724137931034483, 0.43119266055045874]
Lr has been adjusted to 4.999999873689376e-06
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 3 epochs
Epoch 14/40
132/132 - 146s - loss: 0.6676 - accuracy: 0.6146 - val_loss: 0.6846 - val_accuracy: 0.6131
Confusion matrix: 
 [[569 301]
 [120  98]]
Validation f1: 31.77
Validation accuracy: 61.31
Validation recall: 44.95
Validation precision: 24.56
Validation AUC: 0.23403918099762386
Validation class accuracies: [0.6540229885057471, 0.44954128440366975]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 4 epochs
Epoch 15/40
132/132 - 145s - loss: 0.6668 - accuracy: 0.6168 - val_loss: 0.6861 - val_accuracy: 0.6075
Confusion matrix: 
 [[561 309]
 [118 100]]
Validation f1: 31.90
Validation accuracy: 60.75
Validation recall: 45.87
Validation precision: 24.45
Validation AUC: 0.23288441967380136
Validation class accuracies: [0.6448275862068965, 0.45871559633027525]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 5 epochs
Epoch 16/40
132/132 - 146s - loss: 0.6672 - accuracy: 0.6151 - val_loss: 0.6830 - val_accuracy: 0.6140
Confusion matrix: 
 [[574 296]
 [124  94]]
Validation f1: 30.92
Validation accuracy: 61.40
Validation recall: 43.12
Validation precision: 24.10
Validation AUC: 0.23191732666770648
Validation class accuracies: [0.6597701149425287, 0.43119266055045874]
Lr has been adjusted to 2.499999936844688e-06
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 6 epochs
Epoch 17/40
132/132 - 146s - loss: 0.6667 - accuracy: 0.6139 - val_loss: 0.6829 - val_accuracy: 0.6103
Confusion matrix: 
 [[570 300]
 [124  94]]
Validation f1: 30.72
Validation accuracy: 61.03
Validation recall: 43.12
Validation precision: 23.86
Validation AUC: 0.23296666036806646
Validation class accuracies: [0.6551724137931034, 0.43119266055045874]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 7 epochs
Epoch 18/40
132/132 - 145s - loss: 0.6655 - accuracy: 0.6196 - val_loss: 0.6843 - val_accuracy: 0.6112
Confusion matrix: 
 [[568 302]
 [121  97]]
Validation f1: 31.44
Validation accuracy: 61.12
Validation recall: 44.50
Validation precision: 24.31
Validation AUC: 0.23314282914033363
Validation class accuracies: [0.6528735632183909, 0.44495412844036697]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 8 epochs
Epoch 19/40
132/132 - 146s - loss: 0.6663 - accuracy: 0.6182 - val_loss: 0.6849 - val_accuracy: 0.6103
Confusion matrix: 
 [[567 303]
 [121  97]]
Validation f1: 31.39
Validation accuracy: 61.03
Validation recall: 44.50
Validation precision: 24.25
Validation AUC: 0.23282177146490415
Validation class accuracies: [0.6517241379310345, 0.44495412844036697]
Lr has been adjusted to 1.249999968422344e-06
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 9 epochs
Epoch 20/40
132/132 - 146s - loss: 0.6657 - accuracy: 0.6113 - val_loss: 0.6829 - val_accuracy: 0.6094
Confusion matrix: 
 [[568 302]
 [123  95]]
Validation f1: 30.89
Validation accuracy: 60.94
Validation recall: 43.58
Validation precision: 23.93
Validation AUC: 0.23386942730870658
Validation class accuracies: [0.6528735632183909, 0.43577981651376146]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 10 epochs
Epoch 21/40
132/132 - 145s - loss: 0.6654 - accuracy: 0.6223 - val_loss: 0.6846 - val_accuracy: 0.6112
Confusion matrix: 
 [[568 302]
 [121  97]]
Validation f1: 31.44
Validation accuracy: 61.12
Validation recall: 44.50
Validation precision: 24.31
Validation AUC: 0.23331601383952144
Validation class accuracies: [0.6528735632183909, 0.44495412844036697]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 11 epochs
Epoch 22/40
132/132 - 146s - loss: 0.6665 - accuracy: 0.6232 - val_loss: 0.6838 - val_accuracy: 0.6094
Confusion matrix: 
 [[568 302]
 [123  95]]
Validation f1: 30.89
Validation accuracy: 60.94
Validation recall: 43.58
Validation precision: 23.93
Validation AUC: 0.23352948766148593
Validation class accuracies: [0.6528735632183909, 0.43577981651376146]
Lr has been adjusted to 6.24999984211172e-07
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 12 epochs
Epoch 23/40
132/132 - 146s - loss: 0.6659 - accuracy: 0.6201 - val_loss: 0.6846 - val_accuracy: 0.6094
Confusion matrix: 
 [[566 304]
 [121  97]]
Validation f1: 31.34
Validation accuracy: 60.94
Validation recall: 44.50
Validation precision: 24.19
Validation AUC: 0.2332885225121566
Validation class accuracies: [0.6505747126436782, 0.44495412844036697]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 13 epochs
Epoch 24/40
132/132 - 146s - loss: 0.6653 - accuracy: 0.6204 - val_loss: 0.6839 - val_accuracy: 0.6103
Confusion matrix: 
 [[568 302]
 [122  96]]
Validation f1: 31.17
Validation accuracy: 61.03
Validation recall: 44.04
Validation precision: 24.12
Validation AUC: 0.2333179303325404
Validation class accuracies: [0.6528735632183909, 0.44036697247706424]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 14 epochs
Epoch 25/40
132/132 - 146s - loss: 0.6656 - accuracy: 0.6208 - val_loss: 0.6850 - val_accuracy: 0.6085
Confusion matrix: 
 [[565 305]
 [121  97]]
Validation f1: 31.29
Validation accuracy: 60.85
Validation recall: 44.50
Validation precision: 24.13
Validation AUC: 0.23309167909408246
Validation class accuracies: [0.6494252873563219, 0.44495412844036697]
Lr has been adjusted to 3.12499992105586e-07
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 15 epochs
Epoch 26/40
132/132 - 146s - loss: 0.6644 - accuracy: 0.6232 - val_loss: 0.6836 - val_accuracy: 0.6094
Confusion matrix: 
 [[568 302]
 [123  95]]
Validation f1: 30.89
Validation accuracy: 60.94
Validation recall: 43.58
Validation precision: 23.93
Validation AUC: 0.23354951722450457
Validation class accuracies: [0.6528735632183909, 0.43577981651376146]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 16 epochs
Epoch 27/40
132/132 - 146s - loss: 0.6666 - accuracy: 0.6242 - val_loss: 0.6846 - val_accuracy: 0.6094
Confusion matrix: 
 [[566 304]
 [121  97]]
Validation f1: 31.34
Validation accuracy: 60.94
Validation recall: 44.50
Validation precision: 24.19
Validation AUC: 0.2332163238486666
Validation class accuracies: [0.6505747126436782, 0.44495412844036697]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 17 epochs
Epoch 28/40
132/132 - 146s - loss: 0.6662 - accuracy: 0.6134 - val_loss: 0.6829 - val_accuracy: 0.6112
Confusion matrix: 
 [[570 300]
 [123  95]]
Validation f1: 31.00
Validation accuracy: 61.12
Validation recall: 43.58
Validation precision: 24.05
Validation AUC: 0.23414100615780617
Validation class accuracies: [0.6551724137931034, 0.43577981651376146]
Lr has been adjusted to 1.56249996052793e-07
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 18 epochs
Epoch 29/40
132/132 - 145s - loss: 0.6652 - accuracy: 0.6213 - val_loss: 0.6829 - val_accuracy: 0.6103
Confusion matrix: 
 [[569 301]
 [123  95]]
Validation f1: 30.94
Validation accuracy: 61.03
Validation recall: 43.58
Validation precision: 23.99
Validation AUC: 0.23393857906265975
Validation class accuracies: [0.6540229885057471, 0.43577981651376146]
The validation tracker metric at 0.31118314424635335 hasn't increased by 0.01 in 19 epochs
Epoch 30/40
132/132 - 146s - loss: 0.6651 - accuracy: 0.6213 - val_loss: 0.6828 - val_accuracy: 0.6140
Confusion matrix: 
 [[573 297]
 [123  95]]
Validation f1: 31.15
Validation accuracy: 61.40
Validation recall: 43.58
Validation precision: 24.23
Validation AUC: 0.2333251154563824
Validation class accuracies: [0.6586206896551724, 0.43577981651376146]

The metrics for the epoch with the best target metric are: 
Best cm: [[570 300]
 [119  99]]
Best f1: 0.32090761750405183
Best accuracy: 0.6148897058823529
Best recall: 0.4541284403669725
Best precision: 0.24812030075187969
Best AUC: 0.2344575333263866
Best epoch: 12
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 10
Starting...
CM: [[13 47]
 [ 0 15]]
F1: 0.38961038961038963
Accuracy: 0.37333333333333335
Precision: 0.24193548387096775
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/validation_sheet_10.xls...
Done.
Epoch: 11
Starting...
CM: [[14 46]
 [ 0 15]]
F1: 0.3947368421052631
Accuracy: 0.38666666666666666
Precision: 0.2459016393442623
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/validation_sheet_11.xls...
Done.
Epoch: 12
Starting...
CM: [[14 46]
 [ 0 15]]
F1: 0.3947368421052631
Accuracy: 0.38666666666666666
Precision: 0.2459016393442623
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/validation_sheet_12.xls...
Done.
Epoch: 40
Starting...
CM: [[14 46]
 [ 0 15]]
F1: 0.3947368421052631
Accuracy: 0.38666666666666666
Precision: 0.2459016393442623
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/validation_sheet_40.xls...
Done.
Epoch: 6
Starting...
CM: [[33 27]
 [ 9  6]]
F1: 0.25000000000000006
Accuracy: 0.52
Precision: 0.18181818181818182
Recall: 0.4
Ended. Saving the Excel Sheet ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/validation_sheet_6.xls...
Done.
Epoch: 7
Starting...
CM: [[20 40]
 [ 3 12]]
F1: 0.3582089552238806
Accuracy: 0.4266666666666667
Precision: 0.23076923076923078
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/validation_sheet_7.xls...
Done.
Epoch: 8
Starting...
CM: [[16 44]
 [ 1 14]]
F1: 0.3835616438356165
Accuracy: 0.4
Precision: 0.2413793103448276
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/validation_sheet_8.xls...
Done.
Epoch: 9
Starting...
CM: [[15 45]
 [ 0 15]]
F1: 0.4
Accuracy: 0.4
Precision: 0.25
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/validation_sheet_9.xls...
Done.
wandb: Waiting for W&B process to finish, PID 3506
wandb: Program ended successfully.
wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.02MB uploaded (0.00MB deduped)wandb: | 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: / 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: | 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_163936-3k3yzn23/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_163936-3k3yzn23/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.62131
wandb:         val_accuracy 0.61397
wandb:             _runtime 5021
wandb:           _timestamp 1620583397
wandb:                _step 216
wandb:           train_loss 0.66506
wandb:             val_loss 0.68283
wandb:           val_recall 0.43578
wandb:        val_precision 0.24235
wandb:               val_f1 0.31148
wandb:              val_auc 0.23333
wandb:                   lr 0.0
wandb:          best_val_f1 0.32091
wandb:    best_val_accuracy 0.61489
wandb:   best_val_precision 0.24812
wandb:      best_val_recall 0.45413
wandb:             best_auc 0.23446
wandb:           best_epoch 12
wandb:           best_bd_f1 0.4
wandb:     best_bd_accuracy 0.4
wandb:    best_bd_precision 0.25
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 9
wandb: Run history:
wandb:   train_accuracy ▆▇▁▄▂▂▄▅▅▅▆▇▇▆▆▆▆▇▇▅██▇▇▇██▆▇▇
wandb:     val_accuracy █████▅▃▂▂▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▆▅▄▄▄▃▃▃▂▂▂▂▂▂▂▁▂▁▁▂▂▁▁▁▂▂▁▁
wandb:         val_loss ▆▄▃▁▁▄▆▇▇█▇█▇██▇▇██▇█▇█▇█▇█▇▇▇
wandb:       val_recall ▁▁▁▁▁▃▆▇▇█████████████████████
wandb:    val_precision ▁▁▁▁▇▇████████████████████████
wandb:           val_f1 ▁▁▁▁▂▄▇▇██████████████████████
wandb:          val_auc ▂▁▁▁▆▇█▇▇█████████████████████
wandb:               lr █████████████▄▄▄▃▃▃▂▂▂▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 7 media file(s), 7 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2114: https://wandb.ai/arachid1/tensorboard-integration/runs/3k3yzn23


 See logs at ../../new_cache/conv__2114__05_1638__v29__mixednet_bsize32_lowerlr/logs/