Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2243
Description:  augmented_icbhi_and_jordan
2021-06-23 00:49:43.716803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-23 00:49:46.144144: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 00:49:46.145115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-23 00:49:46.157230: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:46.157911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 00:49:46.157937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 00:49:46.161456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 00:49:46.161529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 00:49:46.162597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 00:49:46.162889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 00:49:46.164106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 00:49:46.165008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 00:49:46.165169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 00:49:46.165279: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:46.165988: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:46.166607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2243.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2243__06_0043__v39__augmented_icbhi_and_jordan
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 300, 'WAV_PATH': 'v42,v43,v48'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-23 00:49:51.405467: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-23 00:49:51.405672: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:51.406372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-23 00:49:51.406408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 00:49:51.406449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 00:49:51.406474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-23 00:49:51.406494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-23 00:49:51.406513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-23 00:49:51.406531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-23 00:49:51.406550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-23 00:49:51.406567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 00:49:51.406657: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:51.407523: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:51.408185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-23 00:49:51.408228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-23 00:49:52.154915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-23 00:49:52.154958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-23 00:49:52.154968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-23 00:49:52.155255: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:52.155998: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:52.156701: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-23 00:49:52.157343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2928
-----------------------
Number of train recordings: 2928 with pneumonia: 628 and non-pneumonia: 2300
Length of training samples after audio augmentation: 4728
-----------------------
Number of train recordings: 4728 with pneumonia: 628 and non-pneumonia: 4100
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-23 00:49:53.659856: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-23 00:49:53.661918: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-23 00:49:54.037225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-23 00:49:55.945920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-23 00:49:56.405083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
296/296 - 416s - loss: 0.8513 - accuracy: 0.5854 - val_loss: 1.0395 - val_accuracy: 0.0683
Confusion matrix: 
 [[  0 573]
 [  0  42]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.79
Validation accuracy: 6.83
Validation recall: 100.00
Validation precision: 6.83
Validation AUC: 0.15412117708294795
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
296/296 - 411s - loss: 0.5893 - accuracy: 0.6550 - val_loss: 0.1967 - val_accuracy: 0.9317
Confusion matrix: 
 [[562  11]
 [ 31  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.738 0.262]]
Validation f1: 34.38
Validation accuracy: 93.17
Validation recall: 26.19
Validation precision: 50.00
Validation AUC: 0.4646941113914172
Validation class accuracies: [0.9808027923211169, 0.2619047619047619]
Saving model...
Epoch 3/65
296/296 - 411s - loss: 0.5176 - accuracy: 0.7134 - val_loss: 0.4658 - val_accuracy: 0.7350
Confusion matrix: 
 [[428 145]
 [ 18  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.747 0.253]
 [0.429 0.571]]
Validation f1: 22.75
Validation accuracy: 73.50
Validation recall: 57.14
Validation precision: 14.20
Validation AUC: 0.19932614135666082
Validation class accuracies: [0.7469458987783595, 0.5714285714285714]
The validation tracker metric at 0.34375000000000006 hasn't increased by 0 in 1 epochs
Epoch 4/65
296/296 - 411s - loss: 0.4243 - accuracy: 0.7709 - val_loss: 0.4940 - val_accuracy: 0.7285
Confusion matrix: 
 [[415 158]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.724 0.276]
 [0.214 0.786]]
Validation f1: 28.33
Validation accuracy: 72.85
Validation recall: 78.57
Validation precision: 17.28
Validation AUC: 0.5870344077113564
Validation class accuracies: [0.7242582897033158, 0.7857142857142857]
The validation tracker metric at 0.34375000000000006 hasn't increased by 0 in 2 epochs
Epoch 5/65
296/296 - 411s - loss: 0.3676 - accuracy: 0.8077 - val_loss: 4.4563 - val_accuracy: 0.0699
Confusion matrix: 
 [[  1 572]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.002 0.998]
 [0.    1.   ]]
Validation f1: 12.80
Validation accuracy: 6.99
Validation recall: 100.00
Validation precision: 6.84
Validation AUC: 0.38191662253492004
Validation class accuracies: [0.0017452006980802793, 1.0]
The validation tracker metric at 0.34375000000000006 hasn't increased by 0 in 3 epochs
Epoch 6/65
296/296 - 411s - loss: 0.3991 - accuracy: 0.7929 - val_loss: 0.3154 - val_accuracy: 0.8976
Confusion matrix: 
 [[523  50]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.31  0.69 ]]
Validation f1: 47.93
Validation accuracy: 89.76
Validation recall: 69.05
Validation precision: 36.71
Validation AUC: 0.6470025883490995
Validation class accuracies: [0.912739965095986, 0.6904761904761905]
Saving model...
Epoch 7/65
296/296 - 411s - loss: 0.3211 - accuracy: 0.8310 - val_loss: 4.1046 - val_accuracy: 0.2358
Confusion matrix: 
 [[103 470]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.18 0.82]
 [0.   1.  ]]
Validation f1: 15.16
Validation accuracy: 23.58
Validation recall: 100.00
Validation precision: 8.20
Validation AUC: 0.5319428889678196
Validation class accuracies: [0.17975567190226877, 1.0]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 1 epochs
Epoch 8/65
296/296 - 411s - loss: 0.2391 - accuracy: 0.8805 - val_loss: 0.4246 - val_accuracy: 0.8650
Confusion matrix: 
 [[499  74]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.214 0.786]]
Validation f1: 44.30
Validation accuracy: 86.50
Validation recall: 78.57
Validation precision: 30.84
Validation AUC: 0.6450270742293227
Validation class accuracies: [0.8708551483420593, 0.7857142857142857]
The validation tracker metric at 0.4793388429752066 hasn't increased by 0 in 2 epochs
Epoch 9/65
296/296 - 411s - loss: 0.2470 - accuracy: 0.8809 - val_loss: 0.2228 - val_accuracy: 0.9382
Confusion matrix: 
 [[547  26]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.286 0.714]]
Validation f1: 61.22
Validation accuracy: 93.82
Validation recall: 71.43
Validation precision: 53.57
Validation AUC: 0.7218550568379485
Validation class accuracies: [0.9546247818499127, 0.7142857142857143]
Saving model...
Epoch 10/65
296/296 - 411s - loss: 0.1535 - accuracy: 0.9249 - val_loss: 2.0838 - val_accuracy: 0.4715
Confusion matrix: 
 [[248 325]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.433 0.567]
 [0.    1.   ]]
Validation f1: 20.54
Validation accuracy: 47.15
Validation recall: 100.00
Validation precision: 11.44
Validation AUC: 0.6257224789589858
Validation class accuracies: [0.4328097731239092, 1.0]
The validation tracker metric at 0.6122448979591837 hasn't increased by 0 in 1 epochs
Epoch 11/65
296/296 - 411s - loss: 0.1525 - accuracy: 0.9296 - val_loss: 0.4242 - val_accuracy: 0.8472
Confusion matrix: 
 [[486  87]
 [  7  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.167 0.833]]
Validation f1: 42.68
Validation accuracy: 84.72
Validation recall: 83.33
Validation precision: 28.69
Validation AUC: 0.6988589519893282
Validation class accuracies: [0.8481675392670157, 0.8333333333333334]
The validation tracker metric at 0.6122448979591837 hasn't increased by 0 in 2 epochs
Epoch 12/65
296/296 - 411s - loss: 0.0847 - accuracy: 0.9594 - val_loss: 0.3537 - val_accuracy: 0.8894
Confusion matrix: 
 [[513  60]
 [  8  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.19  0.81 ]]
Validation f1: 50.00
Validation accuracy: 88.94
Validation recall: 80.95
Validation precision: 36.17
Validation AUC: 0.6329786806350418
Validation class accuracies: [0.8952879581151832, 0.8095238095238095]
The validation tracker metric at 0.6122448979591837 hasn't increased by 0 in 3 epochs
Epoch 13/65
296/296 - 411s - loss: 0.0802 - accuracy: 0.9617 - val_loss: 0.7082 - val_accuracy: 0.7935
Confusion matrix: 
 [[449 124]
 [  3  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.784 0.216]
 [0.071 0.929]]
Validation f1: 38.05
Validation accuracy: 79.35
Validation recall: 92.86
Validation precision: 23.93
Validation AUC: 0.6660521991023098
Validation class accuracies: [0.7835951134380453, 0.9285714285714286]
The validation tracker metric at 0.6122448979591837 hasn't increased by 0 in 4 epochs
Epoch 14/65
296/296 - 411s - loss: 0.1386 - accuracy: 0.9495 - val_loss: 4.2413 - val_accuracy: 0.2732
Confusion matrix: 
 [[126 447]
 [  0  42]]
Normalized Confusion matrix: 
 [[0.22 0.78]
 [0.   1.  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 15.82
Validation accuracy: 27.32
Validation recall: 100.00
Validation precision: 8.59
Validation AUC: 0.2995630303509802
Validation class accuracies: [0.2198952879581152, 1.0]
The validation tracker metric at 0.6122448979591837 hasn't increased by 0 in 5 epochs
Epoch 15/65
296/296 - 411s - loss: 0.0923 - accuracy: 0.9543 - val_loss: 0.2879 - val_accuracy: 0.9480
Confusion matrix: 
 [[556  17]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.357 0.643]]
Validation f1: 62.79
Validation accuracy: 94.80
Validation recall: 64.29
Validation precision: 61.36
Validation AUC: 0.6876345175555331
Validation class accuracies: [0.9703315881326352, 0.6428571428571429]
Saving model...
Epoch 16/65
296/296 - 411s - loss: 0.0293 - accuracy: 0.9863 - val_loss: 0.5708 - val_accuracy: 0.8455
Confusion matrix: 
 [[487  86]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85  0.15 ]
 [0.214 0.786]]
Validation f1: 40.99
Validation accuracy: 84.55
Validation recall: 78.57
Validation precision: 27.73
Validation AUC: 0.6648569846194532
Validation class accuracies: [0.849912739965096, 0.7857142857142857]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 1 epochs
Epoch 17/65
296/296 - 411s - loss: 0.0437 - accuracy: 0.9850 - val_loss: 0.8832 - val_accuracy: 0.9073
Confusion matrix: 
 [[528  45]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.286 0.714]]
Validation f1: 51.28
Validation accuracy: 90.73
Validation recall: 71.43
Validation precision: 40.00
Validation AUC: 0.6027581338601632
Validation class accuracies: [0.9214659685863874, 0.7142857142857143]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 2 epochs
Epoch 18/65
296/296 - 411s - loss: 0.0768 - accuracy: 0.9689 - val_loss: 0.5624 - val_accuracy: 0.8439
Confusion matrix: 
 [[489  84]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.853 0.147]
 [0.286 0.714]]
Validation f1: 38.46
Validation accuracy: 84.39
Validation recall: 71.43
Validation precision: 26.32
Validation AUC: 0.5865981692081663
Validation class accuracies: [0.8534031413612565, 0.7142857142857143]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 3 epochs
Epoch 19/65
296/296 - 411s - loss: 0.0259 - accuracy: 0.9873 - val_loss: 0.6186 - val_accuracy: 0.8553
Confusion matrix: 
 [[496  77]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.866 0.134]
 [0.286 0.714]]
Validation f1: 40.27
Validation accuracy: 85.53
Validation recall: 71.43
Validation precision: 28.04
Validation AUC: 0.5314553280191912
Validation class accuracies: [0.8656195462478184, 0.7142857142857143]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 4 epochs
Epoch 20/65
296/296 - 411s - loss: 0.0145 - accuracy: 0.9947 - val_loss: 0.3777 - val_accuracy: 0.9154
Confusion matrix: 
 [[537  36]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.381 0.619]]
Validation f1: 50.00
Validation accuracy: 91.54
Validation recall: 61.90
Validation precision: 41.94
Validation AUC: 0.5581838368909915
Validation class accuracies: [0.93717277486911, 0.6190476190476191]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 5 epochs
Epoch 21/65
296/296 - 411s - loss: 0.0086 - accuracy: 0.9979 - val_loss: 0.3252 - val_accuracy: 0.9398
Confusion matrix: 
 [[551  22]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.357 0.643]]
Validation f1: 59.34
Validation accuracy: 93.98
Validation recall: 64.29
Validation precision: 55.10
Validation AUC: 0.6060841799280436
Validation class accuracies: [0.9616055846422339, 0.6428571428571429]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 22/65
296/296 - 411s - loss: 0.0073 - accuracy: 0.9973 - val_loss: 0.3252 - val_accuracy: 0.9317
Confusion matrix: 
 [[546  27]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.357 0.643]]
Validation f1: 56.25
Validation accuracy: 93.17
Validation recall: 64.29
Validation precision: 50.00
Validation AUC: 0.6254583234323599
Validation class accuracies: [0.9528795811518325, 0.6428571428571429]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 7 epochs
Epoch 23/65
296/296 - 411s - loss: 0.0102 - accuracy: 0.9958 - val_loss: 0.3315 - val_accuracy: 0.9203
Confusion matrix: 
 [[540  33]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.381 0.619]]
Validation f1: 51.49
Validation accuracy: 92.03
Validation recall: 61.90
Validation precision: 44.07
Validation AUC: 0.5978945000604782
Validation class accuracies: [0.9424083769633508, 0.6190476190476191]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 8 epochs
Epoch 24/65
296/296 - 411s - loss: 0.0036 - accuracy: 0.9994 - val_loss: 0.4184 - val_accuracy: 0.9106
Confusion matrix: 
 [[532  41]
 [ 14  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.333 0.667]]
Validation f1: 50.45
Validation accuracy: 91.06
Validation recall: 66.67
Validation precision: 40.58
Validation AUC: 0.5872502744737912
Validation class accuracies: [0.9284467713787086, 0.6666666666666666]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 9 epochs
Epoch 25/65
296/296 - 411s - loss: 0.0182 - accuracy: 0.9934 - val_loss: 0.6720 - val_accuracy: 0.8081
Confusion matrix: 
 [[471 102]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.381 0.619]]
Validation f1: 30.59
Validation accuracy: 80.81
Validation recall: 61.90
Validation precision: 20.31
Validation AUC: 0.48680346219933124
Validation class accuracies: [0.8219895287958116, 0.6190476190476191]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 10 epochs
Epoch 26/65
296/296 - 411s - loss: 0.0184 - accuracy: 0.9926 - val_loss: 0.2704 - val_accuracy: 0.9252
Confusion matrix: 
 [[546  27]
 [ 19  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.452 0.548]]
Validation f1: 50.00
Validation accuracy: 92.52
Validation recall: 54.76
Validation precision: 46.00
Validation AUC: 0.6192361574705727
Validation class accuracies: [0.9528795811518325, 0.5476190476190477]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 11 epochs
Epoch 27/65
296/296 - 410s - loss: 0.0055 - accuracy: 0.9983 - val_loss: 0.3198 - val_accuracy: 0.9252
Confusion matrix: 
 [[539  34]
 [ 12  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.286 0.714]]
Validation f1: 56.60
Validation accuracy: 92.52
Validation recall: 71.43
Validation precision: 46.88
Validation AUC: 0.646192587547132
Validation class accuracies: [0.9406631762652705, 0.7142857142857143]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 28/65
296/296 - 410s - loss: 0.0037 - accuracy: 0.9985 - val_loss: 0.2784 - val_accuracy: 0.9350
Confusion matrix: 
 [[548  25]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.357 0.643]]
Validation f1: 57.45
Validation accuracy: 93.50
Validation recall: 64.29
Validation precision: 51.92
Validation AUC: 0.646950233540909
Validation class accuracies: [0.956369982547993, 0.6428571428571429]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 13 epochs
Epoch 29/65
296/296 - 410s - loss: 0.0113 - accuracy: 0.9973 - val_loss: 0.3609 - val_accuracy: 0.9138
Confusion matrix: 
 [[537  36]
 [ 17  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.405 0.595]]
Validation f1: 48.54
Validation accuracy: 91.38
Validation recall: 59.52
Validation precision: 40.98
Validation AUC: 0.6067365548215302
Validation class accuracies: [0.93717277486911, 0.5952380952380952]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 14 epochs
Epoch 30/65
296/296 - 410s - loss: 0.0032 - accuracy: 0.9994 - val_loss: 0.3265 - val_accuracy: 0.9187
Confusion matrix: 
 [[539  34]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.381 0.619]]
Validation f1: 50.98
Validation accuracy: 91.87
Validation recall: 61.90
Validation precision: 43.33
Validation AUC: 0.6248083899630962
Validation class accuracies: [0.9406631762652705, 0.6190476190476191]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 15 epochs
Epoch 31/65
296/296 - 410s - loss: 0.0043 - accuracy: 0.9989 - val_loss: 0.3336 - val_accuracy: 0.9203
Confusion matrix: 
 [[540  33]
 [ 16  26]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.381 0.619]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.49
Validation accuracy: 92.03
Validation recall: 61.90
Validation precision: 44.07
Validation AUC: 0.6068487262527944
Validation class accuracies: [0.9424083769633508, 0.6190476190476191]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 16 epochs
Epoch 32/65
296/296 - 410s - loss: 0.0141 - accuracy: 0.9979 - val_loss: 0.4189 - val_accuracy: 0.9024
Confusion matrix: 
 [[529  44]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.381 0.619]]
Validation f1: 46.43
Validation accuracy: 90.24
Validation recall: 61.90
Validation precision: 37.14
Validation AUC: 0.6082108070985398
Validation class accuracies: [0.9232111692844677, 0.6190476190476191]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 17 epochs
Epoch 33/65
296/296 - 410s - loss: 0.0033 - accuracy: 0.9989 - val_loss: 0.3550 - val_accuracy: 0.9073
Confusion matrix: 
 [[531  42]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.357 0.643]]
Validation f1: 48.65
Validation accuracy: 90.73
Validation recall: 64.29
Validation precision: 39.13
Validation AUC: 0.6313962010337769
Validation class accuracies: [0.9267015706806283, 0.6428571428571429]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 34/65
296/296 - 410s - loss: 0.0028 - accuracy: 0.9994 - val_loss: 0.3303 - val_accuracy: 0.9220
Confusion matrix: 
 [[540  33]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.357 0.643]]
Validation f1: 52.94
Validation accuracy: 92.20
Validation recall: 64.29
Validation precision: 45.00
Validation AUC: 0.6344320777126808
Validation class accuracies: [0.9424083769633508, 0.6428571428571429]
The validation tracker metric at 0.6279069767441862 hasn't increased by 0 in 19 epochs
Epoch 35/65
296/296 - 410s - loss: 0.0045 - accuracy: 0.9985 - val_loss: 0.3374 - val_accuracy: 0.9203
Confusion matrix: 
 [[540  33]
 [ 16  26]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.381 0.619]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.49
Validation accuracy: 92.03
Validation recall: 61.90
Validation precision: 44.07
Validation AUC: 0.6316359700578476
Validation class accuracies: [0.9424083769633508, 0.6190476190476191]

The metrics for job 0 with the best target metric are: 
Best cm: [[556  17]
 [ 15  27]]
Best normalized cm: [[0.97  0.03 ]
 [0.357 0.643]]
Best f1: 0.63
Best accuracy: 0.95
Best recall: 0.64
Best precision: 0.61
Best AUC: 0.69
Best class accuracies: [0.9703315881326352, 0.6428571428571429]
Best epoch: 15
The number of epochs since last 1% equals the patience
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2243.py", line 412, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params, model9, job_count=0)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2243.py", line 355, in train_model
    callbacks=[metrics_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/wandb/integration/keras/keras.py", line 124, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1154, in fit
    callbacks.on_train_end(logs=training_logs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/callbacks.py", line 532, in on_train_end
    callback.on_train_end(numpy_logs)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/callbacks.py", line 133, in on_train_end
    path = os.path.join(self.job_dir, self.job_count)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/posixpath.py", line 94, in join
    genericpath._check_arg_types('join', a, *p)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/genericpath.py", line 153, in _check_arg_types
    (funcname, s.__class__.__name__)) from None
TypeError: join() argument must be str or bytes, not 'int'
wandb: Waiting for W&B process to finish, PID 31978
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_004946-184pyb68/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_004946-184pyb68/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99852
wandb:         val_accuracy 0.92033
wandb:             _runtime 14869
wandb:           _timestamp 1624424255
wandb:                _step 259
wandb:           train_loss 0.00446
wandb:             val_loss 0.33738
wandb:           val_recall 0.61905
wandb:        val_precision 0.44068
wandb:               val_f1 0.51485
wandb:              val_auc 0.63164
wandb:                   lr 0.00013
wandb:          best_val_f1 0.62791
wandb:    best_val_accuracy 0.94797
wandb:   best_val_precision 0.61364
wandb:      best_val_recall 0.64286
wandb:             best_auc 0.68763
wandb:           best_epoch 15
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210623_004946-184pyb68


 See logs at ../../new_cache/conv__2243__06_0043__v39__augmented_icbhi_and_jordan/logs/