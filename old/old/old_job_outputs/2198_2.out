Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2198
Description:  lstm_model
2021-06-07 05:22:16.097526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-07 05:22:19.046645: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-07 05:22:19.047627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-07 05:22:19.060252: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:22:19.060943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-07 05:22:19.060972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 05:22:19.064492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 05:22:19.064591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-07 05:22:19.065683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-07 05:22:19.065986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-07 05:22:19.066996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-07 05:22:19.067902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-07 05:22:19.068066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 05:22:19.068178: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:22:19.068892: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:22:19.069516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2198.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2198__06_0519__v29__lstm_model
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 8, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 80, 'FACTOR': 0.25, 'PATIENCE': 8, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 25, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-07 05:23:03.597818: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-07 05:23:03.598092: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:23:03.598780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-07 05:23:03.598827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 05:23:03.598891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 05:23:03.598910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-07 05:23:03.598935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-07 05:23:03.598954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-07 05:23:03.598972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-07 05:23:03.598990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-07 05:23:03.599007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 05:23:03.599098: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:23:03.599794: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:23:03.600415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-07 05:23:03.600460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 05:23:04.264846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-07 05:23:04.264894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-07 05:23:04.264905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-07 05:23:04.265190: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:23:04.265970: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:23:04.266727: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-07 05:23:04.267417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
The initial learning rate for this job is: 0.001
With concat = False and six = False, size of training set: 4212...
...and size of validation set: 1072
Initializing weights...
weights = {0: 0.6724137931034483, 1: 1.95}
Model: "conv2d"
____________________________________________________________________________________________________________________________________________
Layer (type)                                  Output Shape                   Param #         Connected to                                   
============================================================================================================================================
input_1 (InputLayer)                          [(None, 5, 250, 128, 1)]       0                                                              
____________________________________________________________________________________________________________________________________________
batch_normalization (BatchNormalization)      (None, 5, 250, 128, 1)         4               input_1[0][0]                                  
____________________________________________________________________________________________________________________________________________
time_distributed (TimeDistributed)            (None, 5, 250, 128, 16)        32              batch_normalization[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed)          (None, 5, 250, 128, 16)        32              batch_normalization[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed)          (None, 5, 250, 128, 1)         0               batch_normalization[0][0]                      
____________________________________________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed)          (None, 5, 250, 128, 16)        2320            time_distributed[0][0]                         
____________________________________________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed)          (None, 5, 250, 128, 16)        6416            time_distributed_2[0][0]                       
____________________________________________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed)          (None, 5, 250, 128, 16)        32              time_distributed_4[0][0]                       
____________________________________________________________________________________________________________________________________________
concatenate (Concatenate)                     (None, 5, 250, 128, 48)        0               time_distributed_1[0][0]                       
                                                                                             time_distributed_3[0][0]                       
                                                                                             time_distributed_5[0][0]                       
____________________________________________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed)          (None, 5, 125, 64, 48)         0               concatenate[0][0]                              
____________________________________________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)    (None, 5, 125, 64, 48)         192             time_distributed_6[0][0]                       
____________________________________________________________________________________________________________________________________________
dropout (Dropout)                             (None, 5, 125, 64, 48)         0               batch_normalization_1[0][0]                    
____________________________________________________________________________________________________________________________________________
time_distributed_inverted_residual (TimeDistr (None, 5, 125, 64, 48)         40512           dropout[0][0]                                  
____________________________________________________________________________________________________________________________________________
time_distributed_inverted_residual_1 (TimeDis (None, 5, 125, 64, 48)         40512           time_distributed_inverted_residual[0][0]       
____________________________________________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed)          (None, 5, 63, 32, 48)          0               time_distributed_inverted_residual_1[0][0]     
____________________________________________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)    (None, 5, 63, 32, 48)          192             time_distributed_7[0][0]                       
____________________________________________________________________________________________________________________________________________
dropout_1 (Dropout)                           (None, 5, 63, 32, 48)          0               batch_normalization_2[0][0]                    
____________________________________________________________________________________________________________________________________________
time_distributed_8 (TimeDistributed)          (None, 5, 48)                  0               dropout_1[0][0]                                
____________________________________________________________________________________________________________________________________________
bidirectional (Bidirectional)                 (None, 5, 256)                 181248          time_distributed_8[0][0]                       
____________________________________________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)               (None, 5, 256)                 394240          bidirectional[0][0]                            
____________________________________________________________________________________________________________________________________________
dense (Dense)                                 (None, 5, 128)                 32896           bidirectional_1[0][0]                          
____________________________________________________________________________________________________________________________________________
dense_1 (Dense)                               (None, 5, 1)                   129             dense[0][0]                                    
____________________________________________________________________________________________________________________________________________
flatten (Flatten)                             (None, 5)                      0               dense_1[0][0]                                  
____________________________________________________________________________________________________________________________________________
dense_2 (Dense)                               (None, 1)                      6               flatten[0][0]                                  
============================================================================================================================================
Total params: 698,763
Trainable params: 696,073
Non-trainable params: 2,690
____________________________________________________________________________________________________________________________________________
2021-06-07 05:23:06.447026: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-07 05:23:06.448714: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-07 05:23:06.701177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 05:23:08.699650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 05:23:09.164027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/80
527/527 - 366s - loss: 0.6923 - accuracy: 0.5240 - val_loss: 0.6688 - val_accuracy: 0.6194
Confusion matrix: 
 [[524 260]
 [148 140]]
Normalized Confusion matrix: 
 [[0.66836735 0.33163265]
 [0.51388889 0.48611111]]
Validation f1: 40.70
Validation accuracy: 61.94
Validation recall: 48.61
Validation precision: 35.00
Validation AUC: 0.3373550088840287
Validation class accuracies: [0.6683673469387755, 0.4861111111111111]
The clause is activated.
Not defaulting.
Lr has been adjusted to 0.0002500000118743628
Saving model...
Epoch 2/80
527/527 - 374s - loss: 0.6895 - accuracy: 0.4812 - val_loss: 0.6642 - val_accuracy: 0.5896
Confusion matrix: 
 [[460 324]
 [116 172]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58673469 0.41326531]
 [0.40277778 0.59722222]]
Validation f1: 43.88
Validation accuracy: 58.96
Validation recall: 59.72
Validation precision: 34.68
Validation AUC: 0.32617076832407343
Validation class accuracies: [0.5867346938775511, 0.5972222222222222]
The clause is activated.
Not defaulting.
Lr has been adjusted to 6.25000029685907e-05
Saving model...
Epoch 3/80
527/527 - 375s - loss: 0.6885 - accuracy: 0.4642 - val_loss: 0.6642 - val_accuracy: 0.5877
Confusion matrix: 
 [[453 331]
 [111 177]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.57780612 0.42219388]
 [0.38541667 0.61458333]]
Validation f1: 44.47
Validation accuracy: 58.77
Validation recall: 61.46
Validation precision: 34.84
Validation AUC: 0.32670204511527373
Validation class accuracies: [0.5778061224489796, 0.6145833333333334]
The clause is activated.
Not defaulting.
Lr has been adjusted to 1.5625000742147677e-05
Saving model...
Epoch 4/80
527/527 - 373s - loss: 0.6879 - accuracy: 0.4691 - val_loss: 0.6660 - val_accuracy: 0.5728
Confusion matrix: 
 [[431 353]
 [105 183]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.5497449  0.4502551 ]
 [0.36458333 0.63541667]]
Validation f1: 44.42
Validation accuracy: 57.28
Validation recall: 63.54
Validation precision: 34.14
Validation AUC: 0.32956096818795466
Validation class accuracies: [0.5497448979591837, 0.6354166666666666]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44472361809045224 hasn't increased by 0 in 1 epochs
Epoch 5/80
527/527 - 376s - loss: 0.6888 - accuracy: 0.4677 - val_loss: 0.6654 - val_accuracy: 0.5812
Confusion matrix: 
 [[442 342]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.56377551 0.43622449]
 [0.37152778 0.62847222]]
Validation f1: 44.64
Validation accuracy: 58.12
Validation recall: 62.85
Validation precision: 34.61
Validation AUC: 0.32615211691455803
Validation class accuracies: [0.5637755102040817, 0.6284722222222222]
The clause is activated.
Not defaulting.
Lr has been adjusted to 3.906250185536919e-06
Saving model...
Epoch 6/80
527/527 - 374s - loss: 0.6891 - accuracy: 0.4601 - val_loss: 0.6644 - val_accuracy: 0.5868
Confusion matrix: 
 [[452 332]
 [111 177]]
Normalized Confusion matrix: 
 [[0.57653061 0.42346939]
 [0.38541667 0.61458333]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.42
Validation accuracy: 58.68
Validation recall: 61.46
Validation precision: 34.77
Validation AUC: 0.3264257640140752
Validation class accuracies: [0.576530612244898, 0.6145833333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44636251541307026 hasn't increased by 0 in 1 epochs
Epoch 7/80
527/527 - 375s - loss: 0.6873 - accuracy: 0.4729 - val_loss: 0.6636 - val_accuracy: 0.5886
Confusion matrix: 
 [[458 326]
 [115 173]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58418367 0.41581633]
 [0.39930556 0.60069444]]
Validation f1: 43.96
Validation accuracy: 58.86
Validation recall: 60.07
Validation precision: 34.67
Validation AUC: 0.3311291113138778
Validation class accuracies: [0.5841836734693877, 0.6006944444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44636251541307026 hasn't increased by 0 in 2 epochs
Epoch 8/80
527/527 - 374s - loss: 0.6880 - accuracy: 0.4670 - val_loss: 0.6650 - val_accuracy: 0.5849
Confusion matrix: 
 [[447 337]
 [108 180]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.57015306 0.42984694]
 [0.375      0.625     ]]
Validation f1: 44.72
Validation accuracy: 58.49
Validation recall: 62.50
Validation precision: 34.82
Validation AUC: 0.32535470896866925
Validation class accuracies: [0.5701530612244898, 0.625]
The clause is activated.
Not defaulting.
Lr has been adjusted to 9.765625463842298e-07
Saving model...
Epoch 9/80
527/527 - 380s - loss: 0.6867 - accuracy: 0.4739 - val_loss: 0.6653 - val_accuracy: 0.5812
Confusion matrix: 
 [[442 342]
 [107 181]]
Normalized Confusion matrix: 
 [[0.56377551 0.43622449]
 [0.37152778 0.62847222]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.64
Validation accuracy: 58.12
Validation recall: 62.85
Validation precision: 34.61
Validation AUC: 0.3266050413010943
Validation class accuracies: [0.5637755102040817, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4472049689440994 hasn't increased by 0 in 1 epochs
Epoch 10/80
527/527 - 372s - loss: 0.6886 - accuracy: 0.4632 - val_loss: 0.6642 - val_accuracy: 0.5877
Confusion matrix: 
 [[454 330]
 [112 176]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.57908163 0.42091837]
 [0.38888889 0.61111111]]
Validation f1: 44.33
Validation accuracy: 58.77
Validation recall: 61.11
Validation precision: 34.78
Validation AUC: 0.32791482698575425
Validation class accuracies: [0.5790816326530612, 0.6111111111111112]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4472049689440994 hasn't increased by 0 in 2 epochs
Epoch 11/80
527/527 - 374s - loss: 0.6882 - accuracy: 0.4656 - val_loss: 0.6649 - val_accuracy: 0.5858
Confusion matrix: 
 [[447 337]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.57015306 0.42984694]
 [0.37152778 0.62847222]]
Validation f1: 44.91
Validation accuracy: 58.58
Validation recall: 62.85
Validation precision: 34.94
Validation AUC: 0.3251330784406982
Validation class accuracies: [0.5701530612244898, 0.6284722222222222]
The clause is activated.
Not defaulting.
Lr has been adjusted to 2.4414063659605745e-07
Saving model...
Epoch 12/80
527/527 - 374s - loss: 0.6881 - accuracy: 0.4675 - val_loss: 0.6651 - val_accuracy: 0.5830
Confusion matrix: 
 [[444 340]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.56632653 0.43367347]
 [0.37152778 0.62847222]]
Validation f1: 44.75
Validation accuracy: 58.30
Validation recall: 62.85
Validation precision: 34.74
Validation AUC: 0.3257905110485122
Validation class accuracies: [0.5663265306122449, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 1 epochs
Epoch 13/80
527/527 - 376s - loss: 0.6865 - accuracy: 0.4722 - val_loss: 0.6656 - val_accuracy: 0.5765
Confusion matrix: 
 [[436 348]
 [106 182]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.55612245 0.44387755]
 [0.36805556 0.63194444]]
Validation f1: 44.50
Validation accuracy: 57.65
Validation recall: 63.19
Validation precision: 34.34
Validation AUC: 0.32651849623286655
Validation class accuracies: [0.5561224489795918, 0.6319444444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 2 epochs
Epoch 14/80
527/527 - 372s - loss: 0.6879 - accuracy: 0.4679 - val_loss: 0.6655 - val_accuracy: 0.5802
Confusion matrix: 
 [[441 343]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.5625     0.4375    ]
 [0.37152778 0.62847222]]
Validation f1: 44.58
Validation accuracy: 58.02
Validation recall: 62.85
Validation precision: 34.54
Validation AUC: 0.3252076445581751
Validation class accuracies: [0.5625, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 3 epochs
Epoch 15/80
527/527 - 373s - loss: 0.6879 - accuracy: 0.4694 - val_loss: 0.6650 - val_accuracy: 0.5858
Confusion matrix: 
 [[447 337]
 [107 181]]
Normalized Confusion matrix: 
 [[0.57015306 0.42984694]
 [0.37152778 0.62847222]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.91
Validation accuracy: 58.58
Validation recall: 62.85
Validation precision: 34.94
Validation AUC: 0.32528425262986793
Validation class accuracies: [0.5701530612244898, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 4 epochs
Epoch 16/80
527/527 - 372s - loss: 0.6875 - accuracy: 0.4653 - val_loss: 0.6646 - val_accuracy: 0.5868
Confusion matrix: 
 [[450 334]
 [109 179]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.57397959 0.42602041]
 [0.37847222 0.62152778]]
Validation f1: 44.69
Validation accuracy: 58.68
Validation recall: 62.15
Validation precision: 34.89
Validation AUC: 0.3264325221334753
Validation class accuracies: [0.5739795918367347, 0.6215277777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 5 epochs
Epoch 17/80
527/527 - 375s - loss: 0.6878 - accuracy: 0.4694 - val_loss: 0.6654 - val_accuracy: 0.5793
Confusion matrix: 
 [[440 344]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.56122449 0.43877551]
 [0.37152778 0.62847222]]
Validation f1: 44.53
Validation accuracy: 57.93
Validation recall: 62.85
Validation precision: 34.48
Validation AUC: 0.3251788066248326
Validation class accuracies: [0.5612244897959183, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 6 epochs
Epoch 18/80
527/527 - 370s - loss: 0.6882 - accuracy: 0.4710 - val_loss: 0.6643 - val_accuracy: 0.5896
Confusion matrix: 
 [[455 329]
 [111 177]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58035714 0.41964286]
 [0.38541667 0.61458333]]
Validation f1: 44.58
Validation accuracy: 58.96
Validation recall: 61.46
Validation precision: 34.98
Validation AUC: 0.329025976218701
Validation class accuracies: [0.5803571428571429, 0.6145833333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 7 epochs
Epoch 19/80
527/527 - 371s - loss: 0.6875 - accuracy: 0.4720 - val_loss: 0.6635 - val_accuracy: 0.5886
Confusion matrix: 
 [[459 325]
 [116 172]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58545918 0.41454082]
 [0.40277778 0.59722222]]
Validation f1: 43.82
Validation accuracy: 58.86
Validation recall: 59.72
Validation precision: 34.61
Validation AUC: 0.3286549580244264
Validation class accuracies: [0.5854591836734694, 0.5972222222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 6.103515914901436e-08
Epoch 20/80
527/527 - 372s - loss: 0.6864 - accuracy: 0.4734 - val_loss: 0.6652 - val_accuracy: 0.5821
Confusion matrix: 
 [[443 341]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.56505102 0.43494898]
 [0.37152778 0.62847222]]
Validation f1: 44.69
Validation accuracy: 58.21
Validation recall: 62.85
Validation precision: 34.67
Validation AUC: 0.3251779886649113
Validation class accuracies: [0.5650510204081632, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 9 epochs
Epoch 21/80
527/527 - 372s - loss: 0.6877 - accuracy: 0.4713 - val_loss: 0.6654 - val_accuracy: 0.5793
Confusion matrix: 
 [[440 344]
 [107 181]]
Normalized Confusion matrix: 
 [[0.56122449 0.43877551]
 [0.37152778 0.62847222]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.53
Validation accuracy: 57.93
Validation recall: 62.85
Validation precision: 34.48
Validation AUC: 0.3268284472504634
Validation class accuracies: [0.5612244897959183, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 10 epochs
Epoch 22/80
527/527 - 371s - loss: 0.6881 - accuracy: 0.4649 - val_loss: 0.6641 - val_accuracy: 0.5896
Confusion matrix: 
 [[456 328]
 [112 176]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58163265 0.41836735]
 [0.38888889 0.61111111]]
Validation f1: 44.44
Validation accuracy: 58.96
Validation recall: 61.11
Validation precision: 34.92
Validation AUC: 0.3312105671517023
Validation class accuracies: [0.5816326530612245, 0.6111111111111112]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 11 epochs
Epoch 23/80
527/527 - 373s - loss: 0.6876 - accuracy: 0.4727 - val_loss: 0.6655 - val_accuracy: 0.5784
Confusion matrix: 
 [[439 345]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.55994898 0.44005102]
 [0.37152778 0.62847222]]
Validation f1: 44.47
Validation accuracy: 57.84
Validation recall: 62.85
Validation precision: 34.41
Validation AUC: 0.3269888502040226
Validation class accuracies: [0.5599489795918368, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 12 epochs
Epoch 24/80
527/527 - 371s - loss: 0.6868 - accuracy: 0.4758 - val_loss: 0.6658 - val_accuracy: 0.5746
Confusion matrix: 
 [[435 349]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.55484694 0.44515306]
 [0.37152778 0.62847222]]
Validation f1: 44.25
Validation accuracy: 57.46
Validation recall: 62.85
Validation precision: 34.15
Validation AUC: 0.32538556370167104
Validation class accuracies: [0.5548469387755102, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 13 epochs
Epoch 25/80
527/527 - 370s - loss: 0.6874 - accuracy: 0.4741 - val_loss: 0.6639 - val_accuracy: 0.5905
Confusion matrix: 
 [[457 327]
 [112 176]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58290816 0.41709184]
 [0.38888889 0.61111111]]
Validation f1: 44.50
Validation accuracy: 59.05
Validation recall: 61.11
Validation precision: 34.99
Validation AUC: 0.33034757401164394
Validation class accuracies: [0.5829081632653061, 0.6111111111111112]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 14 epochs
Epoch 26/80
527/527 - 369s - loss: 0.6868 - accuracy: 0.4746 - val_loss: 0.6641 - val_accuracy: 0.5886
Confusion matrix: 
 [[455 329]
 [112 176]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58035714 0.41964286]
 [0.38888889 0.61111111]]
Validation f1: 44.39
Validation accuracy: 58.86
Validation recall: 61.11
Validation precision: 34.85
Validation AUC: 0.3280531828228379
Validation class accuracies: [0.5803571428571429, 0.6111111111111112]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 15 epochs
Epoch 27/80
527/527 - 370s - loss: 0.6880 - accuracy: 0.4606 - val_loss: 0.6667 - val_accuracy: 0.5700
Confusion matrix: 
 [[426 358]
 [103 185]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.54336735 0.45663265]
 [0.35763889 0.64236111]]
Validation f1: 44.52
Validation accuracy: 57.00
Validation recall: 64.24
Validation precision: 34.07
Validation AUC: 0.3286269157679531
Validation class accuracies: [0.5433673469387755, 0.6423611111111112]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 16 epochs
Epoch 28/80
527/527 - 366s - loss: 0.6877 - accuracy: 0.4710 - val_loss: 0.6647 - val_accuracy: 0.5877
Confusion matrix: 
 [[450 334]
 [108 180]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.57397959 0.42602041]
 [0.375      0.625     ]]
Validation f1: 44.89
Validation accuracy: 58.77
Validation recall: 62.50
Validation precision: 35.02
Validation AUC: 0.32564641932135824
Validation class accuracies: [0.5739795918367347, 0.625]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 17 epochs
Epoch 29/80
527/527 - 367s - loss: 0.6883 - accuracy: 0.4649 - val_loss: 0.6648 - val_accuracy: 0.5877
Confusion matrix: 
 [[450 334]
 [108 180]]
Normalized Confusion matrix: 
 [[0.57397959 0.42602041]
 [0.375      0.625     ]]
Validation f1: 44.89
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 58.77
Validation recall: 62.50
Validation precision: 35.02
Validation AUC: 0.32562852885252214
Validation class accuracies: [0.5739795918367347, 0.625]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 18 epochs
Epoch 30/80
527/527 - 367s - loss: 0.6878 - accuracy: 0.4672 - val_loss: 0.6647 - val_accuracy: 0.5877
Confusion matrix: 
 [[450 334]
 [108 180]]
Normalized Confusion matrix: 
 [[0.57397959 0.42602041]
 [0.375      0.625     ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.89
Validation accuracy: 58.77
Validation recall: 62.50
Validation precision: 35.02
Validation AUC: 0.32547670531980766
Validation class accuracies: [0.5739795918367347, 0.625]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 19 epochs
Epoch 31/80
527/527 - 367s - loss: 0.6865 - accuracy: 0.4791 - val_loss: 0.6651 - val_accuracy: 0.5840
Confusion matrix: 
 [[446 338]
 [108 180]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.56887755 0.43112245]
 [0.375      0.625     ]]
Validation f1: 44.67
Validation accuracy: 58.40
Validation recall: 62.50
Validation precision: 34.75
Validation AUC: 0.3251266022801176
Validation class accuracies: [0.5688775510204082, 0.625]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 20 epochs
Epoch 32/80
527/527 - 365s - loss: 0.6869 - accuracy: 0.4767 - val_loss: 0.6650 - val_accuracy: 0.5849
Confusion matrix: 
 [[446 338]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.56887755 0.43112245]
 [0.37152778 0.62847222]]
Validation f1: 44.86
Validation accuracy: 58.49
Validation recall: 62.85
Validation precision: 34.87
Validation AUC: 0.3263801014947182
Validation class accuracies: [0.5688775510204082, 0.6284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 21 epochs
Epoch 33/80
527/527 - 366s - loss: 0.6887 - accuracy: 0.4613 - val_loss: 0.6639 - val_accuracy: 0.5886
Confusion matrix: 
 [[457 327]
 [114 174]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58290816 0.41709184]
 [0.39583333 0.60416667]]
Validation f1: 44.11
Validation accuracy: 58.86
Validation recall: 60.42
Validation precision: 34.73
Validation AUC: 0.33131624920383596
Validation class accuracies: [0.5829081632653061, 0.6041666666666666]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 22 epochs
Epoch 34/80
527/527 - 368s - loss: 0.6881 - accuracy: 0.4696 - val_loss: 0.6641 - val_accuracy: 0.5877
Confusion matrix: 
 [[454 330]
 [112 176]]
Normalized Confusion matrix: 
 [[0.57908163 0.42091837]
 [0.38888889 0.61111111]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.33
Validation accuracy: 58.77
Validation recall: 61.11
Validation precision: 34.78
Validation AUC: 0.32855269345925575
Validation class accuracies: [0.5790816326530612, 0.6111111111111112]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 23 epochs
Epoch 35/80
527/527 - 367s - loss: 0.6879 - accuracy: 0.4668 - val_loss: 0.6640 - val_accuracy: 0.5896
Confusion matrix: 
 [[457 327]
 [113 175]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.58290816 0.41709184]
 [0.39236111 0.60763889]]
Validation f1: 44.30
Validation accuracy: 58.96
Validation recall: 60.76
Validation precision: 34.86
Validation AUC: 0.33112833876993014
Validation class accuracies: [0.5829081632653061, 0.6076388888888888]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.44913151364764275 hasn't increased by 0 in 24 epochs
Epoch 36/80
527/527 - 367s - loss: 0.6879 - accuracy: 0.4646 - val_loss: 0.6663 - val_accuracy: 0.5709
Confusion matrix: 
 [[428 356]
 [104 184]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.54591837 0.45408163]
 [0.36111111 0.63888889]]
Validation f1: 44.44
Validation accuracy: 57.09
Validation recall: 63.89
Validation precision: 34.07
Validation AUC: 0.32975274506303487
Validation class accuracies: [0.5459183673469388, 0.6388888888888888]

The metrics for job 0 with the best target metric are: 
Best cm: [[447 337]
 [107 181]]
Best normalized cm: [[0.57015306 0.42984694]
 [0.37152778 0.62847222]]
Best f1: 0.45
Best accuracy: 0.59
Best recall: 0.63
Best precision: 0.35
Best AUC: 0.33
Best class accuracies: [0.5701530612244898, 0.6284722222222222]
Best epoch: 11
The clause is activated.
Not defaulting.
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2198.py", line 581, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2198.py", line 508, in train_model
    bd_f1, bd_accuracy, bd_precision, bd_recall, bd_auc, bd_y_true, bd_y_pred = generate_bangladesh_sheet(model, grouped_val_samples, excel_dest, six, initial_channels, pneumonia_threshold)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/pneumonia.py", line 182, in generate_bangladesh_sheet
    output = model.predict(np.array([arr]))
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1629, in predict
    tmp_batch_outputs = self.predict_function(iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1478, in predict_function
    return step_function(self, iterator)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1468, in step_function
    outputs = model.distribute_strategy.run(run_step, args=(data,))
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py", line 1259, in run
    return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py", line 2730, in call_for_each_replica
    return self._call_for_each_replica(fn, args, kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py", line 3417, in _call_for_each_replica
    return fn(*args, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/autograph/impl/api.py", line 572, in wrapper
    return func(*args, **kwargs)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1461, in run_step
    outputs = model.predict_step(data)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 1434, in predict_step
    return self(x, training=False)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 998, in __call__
    input_spec.assert_input_compatibility(self.input_spec, inputs, self.name)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py", line 274, in assert_input_compatibility
    ', found shape=' + display_shape(x.shape))
ValueError: Input 0 is incompatible with layer conv2d: expected shape=(None, 5, 250, 128, 1), found shape=(1, 128, 1250, 1)
wandb: Waiting for W&B process to finish, PID 31495
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_052219-1lm4thl2/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_052219-1lm4thl2/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.46462
wandb:         val_accuracy 0.5709
wandb:             _runtime 14331
wandb:           _timestamp 1623057670
wandb:                _step 269
wandb:           train_loss 0.68794
wandb:             val_loss 0.66631
wandb:           val_recall 0.63889
wandb:        val_precision 0.34074
wandb:               val_f1 0.44444
wandb:              val_auc 0.32975
wandb:                   lr 0.0
wandb:          best_val_f1 0.44913
wandb:    best_val_accuracy 0.58582
wandb:   best_val_precision 0.34942
wandb:      best_val_recall 0.62847
wandb:             best_auc 0.32513
wandb:           best_epoch 11
wandb: Run history:
wandb:   train_accuracy █▃▁▂▂▁▂▂▃▁▂▂▂▂▂▂▂▂▂▂▂▂▂▃▃▃▁▂▂▂▃▃▁▂▂▁
wandb:     val_accuracy █▄▄▁▃▃▄▃▃▄▃▃▂▂▃▃▂▄▄▃▂▄▂▂▄▄▁▄▄▄▃▃▄▄▄▁
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▃▃▄▄▂▃▁▄▃▃▁▃▃▂▃▃▂▁▃▃▂▁▂▂▃▃▃▃▁▂▄▃▃▃
wandb:         val_loss █▂▂▄▄▂▁▃▃▂▃▃▄▄▃▂▄▂▁▃▃▂▄▄▂▂▅▃▃▃▃▃▂▂▂▅
wandb:       val_recall ▁▆▇█▇▇▆▇▇▇▇▇█▇▇▇▇▇▆▇▇▇▇▇▇▇█▇▇▇▇▇▆▇▆█
wandb:    val_precision █▅▇▂▅▆▅▇▅▆▇▆▃▄▇▇▄█▅▅▄▇▄▂█▇▁███▆▇▆▆▇▁
wandb:           val_f1 ▁▆▇▇█▇▆██▇██▇▇██▇▇▆█▇▇▇▇▇▇▇█████▇▇▇▇
wandb:          val_auc █▂▂▄▂▂▄▁▂▃▁▁▂▁▁▂▁▃▃▁▂▄▂▁▄▃▃▁▁▁▁▂▅▃▄▄
wandb:               lr █▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210607_052219-1lm4thl2


 See logs at ../../new_cache/conv__2198__06_0519__v29__lstm_model/logs/