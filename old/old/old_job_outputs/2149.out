Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2149
Description:  mod9_bsize8
2021-05-18 00:00:00.518303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 00:00:03.041457: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-18 00:00:03.042409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-18 00:00:03.093020: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:03.093817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-18 00:00:03.093851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 00:00:03.097689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 00:00:03.097788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 00:00:03.098931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-18 00:00:03.099264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-18 00:00:03.100260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-18 00:00:03.101221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-18 00:00:03.101385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-18 00:00:03.101505: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:03.102294: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:03.102969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2149.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2149__05_2359__v29__mod9_bsize8/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 8, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2149
wandb: â­ï¸ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: ðŸš€ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/9ycshdka
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_000003-9ycshdka
wandb: Run `wandb offline` to turn off syncing.
2021-05-18 00:00:09.175661: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-18 00:00:09.175925: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:09.176707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-18 00:00:09.176753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 00:00:09.176822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 00:00:09.176846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 00:00:09.176868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-18 00:00:09.176889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-18 00:00:09.176910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-18 00:00:09.176931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-18 00:00:09.176951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-18 00:00:09.177047: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:09.177851: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:09.178559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-18 00:00:09.178605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 00:00:10.002236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-18 00:00:10.002288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-18 00:00:10.002298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-18 00:00:10.002613: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:10.003496: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:10.004266: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 00:00:10.004997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-18 00:00:53.595689: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-18 00:00:53.598282: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-18 00:00:57.412000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 00:00:58.165273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 00:00:58.173061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
binary
Epoch 1/80
525/525 - 529s - loss: 0.6441 - accuracy: 0.7073 - val_loss: 0.4980 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2516663587897099
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
525/525 - 525s - loss: 0.5916 - accuracy: 0.7197 - val_loss: 7.7777 - val_accuracy: 0.2482
Confusion matrix: 
 [[ 73 797]
 [ 21 197]]
Validation f1: 32.51
Validation accuracy: 24.82
Validation recall: 90.37
Validation precision: 19.82
Validation AUC: 0.23434392655698855
Validation class accuracies: [0.0839080459770115, 0.9036697247706422]
TARGET: 1
target metric(test f1): 0.3250825082508251
column_sums: [ 94 994]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
525/525 - 524s - loss: 0.5880 - accuracy: 0.7219 - val_loss: 0.6139 - val_accuracy: 0.6903
Confusion matrix: 
 [[703 167]
 [170  48]]
Validation f1: 22.17
Validation accuracy: 69.03
Validation recall: 22.02
Validation precision: 22.33
Validation AUC: 0.23453245999513775
Validation class accuracies: [0.8080459770114943, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.22170900692840648
column_sums: [873 215]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 4/80
525/525 - 526s - loss: 0.5848 - accuracy: 0.7238 - val_loss: 0.4965 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2468155095856726
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
525/525 - 524s - loss: 0.5855 - accuracy: 0.7262 - val_loss: 0.6174 - val_accuracy: 0.7298
Confusion matrix: 
 [[768 102]
 [192  26]]
Validation f1: 15.03
Validation accuracy: 72.98
Validation recall: 11.93
Validation precision: 20.31
Validation AUC: 0.22979179124118213
Validation class accuracies: [0.8827586206896552, 0.11926605504587157]
TARGET: 1
target metric(test f1): 0.15028901734104047
column_sums: [960 128]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 1 epochs
Epoch 6/80
525/525 - 525s - loss: 0.5845 - accuracy: 0.7231 - val_loss: 0.5624 - val_accuracy: 0.7757
Confusion matrix: 
 [[839  31]
 [213   5]]
Validation f1: 3.94
Validation accuracy: 77.57
Validation recall: 2.29
Validation precision: 13.89
Validation AUC: 0.20420233642473667
Validation class accuracies: [0.964367816091954, 0.022935779816513763]
TARGET: 1
target metric(test f1): 0.03937007874015748
column_sums: [1052   36]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
525/525 - 524s - loss: 0.5838 - accuracy: 0.7231 - val_loss: 0.5561 - val_accuracy: 0.7518
Confusion matrix: 
 [[795  75]
 [195  23]]
Validation f1: 14.56
Validation accuracy: 75.18
Validation recall: 10.55
Validation precision: 23.47
Validation AUC: 0.23312970945180128
Validation class accuracies: [0.9137931034482759, 0.10550458715596331]
TARGET: 1
target metric(test f1): 0.14556962025316456
column_sums: [990  98]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
525/525 - 524s - loss: 0.5809 - accuracy: 0.7271 - val_loss: 0.5235 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19609651714246468
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
525/525 - 524s - loss: 0.5795 - accuracy: 0.7250 - val_loss: 0.5477 - val_accuracy: 0.7730
Confusion matrix: 
 [[828  42]
 [205  13]]
Validation f1: 9.52
Validation accuracy: 77.30
Validation recall: 5.96
Validation precision: 23.64
Validation AUC: 0.23557877019976253
Validation class accuracies: [0.9517241379310345, 0.05963302752293578]
TARGET: 1
target metric(test f1): 0.09523809523809525
column_sums: [1033   55]
cm_sum: 1088
The training is defaulting to either class.
Epoch 10/80
525/525 - 525s - loss: 0.5775 - accuracy: 0.7255 - val_loss: 0.5128 - val_accuracy: 0.7877
Confusion matrix: 
 [[850  20]
 [211   7]]
Validation f1: 5.71
Validation accuracy: 78.77
Validation recall: 3.21
Validation precision: 25.93
Validation AUC: 0.23739347692349003
Validation class accuracies: [0.9770114942528736, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.057142857142857155
column_sums: [1061   27]
cm_sum: 1088
The training is defaulting to either class.
Epoch 11/80
525/525 - 523s - loss: 0.5754 - accuracy: 0.7252 - val_loss: 0.5337 - val_accuracy: 0.7675
Confusion matrix: 
 [[823  47]
 [206  12]]
Validation f1: 8.66
Validation accuracy: 76.75
Validation recall: 5.50
Validation precision: 20.34
Validation AUC: 0.23313295913799698
Validation class accuracies: [0.9459770114942528, 0.05504587155963303]
TARGET: 1
target metric(test f1): 0.08664259927797835
column_sums: [1029   59]
cm_sum: 1088
The training is defaulting to either class.
Epoch 12/80
525/525 - 523s - loss: 0.5734 - accuracy: 0.7250 - val_loss: 0.6236 - val_accuracy: 0.7325
Confusion matrix: 
 [[773  97]
 [194  24]]
Validation f1: 14.16
Validation accuracy: 73.25
Validation recall: 11.01
Validation precision: 19.83
Validation AUC: 0.20166334569141414
Validation class accuracies: [0.8885057471264368, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.14159292035398233
column_sums: [967 121]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 2 epochs
Epoch 13/80
525/525 - 524s - loss: 0.5672 - accuracy: 0.7278 - val_loss: 0.4968 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2224569877139317
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 14/80
525/525 - 524s - loss: 0.5644 - accuracy: 0.7264 - val_loss: 0.6069 - val_accuracy: 0.6985
Confusion matrix: 
 [[724 146]
 [182  36]]
Validation f1: 18.00
Validation accuracy: 69.85
Validation recall: 16.51
Validation precision: 19.78
Validation AUC: 0.2039785742660049
Validation class accuracies: [0.832183908045977, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.18000000000000002
column_sums: [906 182]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 3 epochs
Epoch 15/80
525/525 - 524s - loss: 0.5645 - accuracy: 0.7309 - val_loss: 0.7019 - val_accuracy: 0.6801
Confusion matrix: 
 [[703 167]
 [181  37]]
Validation f1: 17.54
Validation accuracy: 68.01
Validation recall: 16.97
Validation precision: 18.14
Validation AUC: 0.21197372544303716
Validation class accuracies: [0.8080459770114943, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.17535545023696683
column_sums: [884 204]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 4 epochs
Epoch 16/80
525/525 - 525s - loss: 0.5514 - accuracy: 0.7369 - val_loss: 0.5245 - val_accuracy: 0.7767
Confusion matrix: 
 [[837  33]
 [210   8]]
Validation f1: 6.18
Validation accuracy: 77.67
Validation recall: 3.67
Validation precision: 19.51
Validation AUC: 0.22299258090441032
Validation class accuracies: [0.9620689655172414, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.06177606177606178
column_sums: [1047   41]
cm_sum: 1088
The training is defaulting to either class.
Epoch 17/80
525/525 - 525s - loss: 0.5408 - accuracy: 0.7352 - val_loss: 0.5330 - val_accuracy: 0.7748
Confusion matrix: 
 [[831  39]
 [206  12]]
Validation f1: 8.92
Validation accuracy: 77.48
Validation recall: 5.50
Validation precision: 23.53
Validation AUC: 0.21593133291702044
Validation class accuracies: [0.9551724137931035, 0.05504587155963303]
TARGET: 1
target metric(test f1): 0.08921933085501858
column_sums: [1037   51]
cm_sum: 1088
The training is defaulting to either class.
Epoch 18/80
525/525 - 524s - loss: 0.5420 - accuracy: 0.7364 - val_loss: 0.5424 - val_accuracy: 0.7730
Confusion matrix: 
 [[831  39]
 [208  10]]
Validation f1: 7.49
Validation accuracy: 77.30
Validation recall: 4.59
Validation precision: 20.41
Validation AUC: 0.1989141413415313
Validation class accuracies: [0.9551724137931035, 0.045871559633027525]
TARGET: 1
target metric(test f1): 0.0749063670411985
column_sums: [1039   49]
cm_sum: 1088
The training is defaulting to either class.
Epoch 19/80
525/525 - 525s - loss: 0.5387 - accuracy: 0.7436 - val_loss: 0.5431 - val_accuracy: 0.7574
Confusion matrix: 
 [[810  60]
 [204  14]]
Validation f1: 9.59
Validation accuracy: 75.74
Validation recall: 6.42
Validation precision: 18.92
Validation AUC: 0.21695875858423894
Validation class accuracies: [0.9310344827586207, 0.06422018348623854]
TARGET: 1
target metric(test f1): 0.0958904109589041
column_sums: [1014   74]
cm_sum: 1088
The training is defaulting to either class.
Epoch 20/80
525/525 - 524s - loss: 0.5374 - accuracy: 0.7409 - val_loss: 0.5614 - val_accuracy: 0.7564
Confusion matrix: 
 [[799  71]
 [194  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.34
Validation accuracy: 75.64
Validation recall: 11.01
Validation precision: 25.26
Validation AUC: 0.2057951543179032
Validation class accuracies: [0.9183908045977012, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.15335463258785942
column_sums: [993  95]
cm_sum: 1088
The training is defaulting to either class.
Epoch 21/80
525/525 - 526s - loss: 0.5337 - accuracy: 0.7417 - val_loss: 0.5496 - val_accuracy: 0.7601
Confusion matrix: 
 [[810  60]
 [201  17]]
Validation f1: 11.53
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.01
Validation recall: 7.80
Validation precision: 22.08
Validation AUC: 0.2112269405521258
Validation class accuracies: [0.9310344827586207, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.1152542372881356
column_sums: [1011   77]
cm_sum: 1088
The training is defaulting to either class.
Epoch 22/80
525/525 - 525s - loss: 0.5260 - accuracy: 0.7486 - val_loss: 0.5847 - val_accuracy: 0.7454
Confusion matrix: 
 [[786  84]
 [193  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.29
Validation accuracy: 74.54
Validation recall: 11.47
Validation precision: 22.94
Validation AUC: 0.21018013158743248
Validation class accuracies: [0.903448275862069, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.1529051987767584
column_sums: [979 109]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 5 epochs
Epoch 23/80
525/525 - 525s - loss: 0.5217 - accuracy: 0.7481 - val_loss: 0.5371 - val_accuracy: 0.7711
Confusion matrix: 
 [[828  42]
 [207  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 8.12
Validation accuracy: 77.11
Validation recall: 5.05
Validation precision: 20.75
Validation AUC: 0.21777999463993317
Validation class accuracies: [0.9517241379310345, 0.05045871559633028]
TARGET: 1
target metric(test f1): 0.08118081180811809
column_sums: [1035   53]
cm_sum: 1088
The training is defaulting to either class.
Epoch 24/80
525/525 - 524s - loss: 0.5236 - accuracy: 0.7440 - val_loss: 0.5759 - val_accuracy: 0.7399
Confusion matrix: 
 [[780  90]
 [193  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.02
Validation accuracy: 73.99
Validation recall: 11.47
Validation precision: 21.74
Validation AUC: 0.20727900002942565
Validation class accuracies: [0.896551724137931, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.15015015015015015
column_sums: [973 115]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 6 epochs
Epoch 25/80
525/525 - 526s - loss: 0.5237 - accuracy: 0.7519 - val_loss: 0.5797 - val_accuracy: 0.7564
Confusion matrix: 
 [[795  75]
 [190  28]]
Validation f1: 17.45
Validation accuracy: 75.64
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 12.84
Validation precision: 27.18
Validation AUC: 0.20108997004795554
Validation class accuracies: [0.9137931034482759, 0.12844036697247707]
TARGET: 1
target metric(test f1): 0.17445482866043613
column_sums: [985 103]
cm_sum: 1088
The training is defaulting to either class.
Epoch 26/80
525/525 - 525s - loss: 0.5160 - accuracy: 0.7493 - val_loss: 0.5422 - val_accuracy: 0.7932
Confusion matrix: 
 [[861   9]
 [216   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 1.75
Validation accuracy: 79.32
Validation recall: 0.92
Validation precision: 18.18
Validation AUC: 0.20707729995143082
Validation class accuracies: [0.9896551724137931, 0.009174311926605505]
TARGET: 1
target metric(test f1): 0.017467248908296946
column_sums: [1077   11]
cm_sum: 1088
The training is defaulting to either class.
Epoch 27/80
525/525 - 524s - loss: 0.5117 - accuracy: 0.7524 - val_loss: 0.5412 - val_accuracy: 0.7868
Confusion matrix: 
 [[850  20]
 [212   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 4.92
Validation accuracy: 78.68
Validation recall: 2.75
Validation precision: 23.08
Validation AUC: 0.2051717610705238
Validation class accuracies: [0.9770114942528736, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.04918032786885246
column_sums: [1062   26]
cm_sum: 1088
The training is defaulting to either class.
Epoch 28/80
525/525 - 524s - loss: 0.5066 - accuracy: 0.7605 - val_loss: 0.5505 - val_accuracy: 0.7849
Confusion matrix: 
 [[848  22]
 [212   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 4.88
Validation accuracy: 78.49
Validation recall: 2.75
Validation precision: 21.43
Validation AUC: 0.20156995002814512
Validation class accuracies: [0.9747126436781609, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.04878048780487805
column_sums: [1060   28]
cm_sum: 1088
The training is defaulting to either class.
Epoch 29/80
525/525 - 525s - loss: 0.5051 - accuracy: 0.7614 - val_loss: 0.5558 - val_accuracy: 0.7877
Confusion matrix: 
 [[853  17]
 [214   4]]
Validation f1: 3.35
Validation accuracy: 78.77
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 1.83
Validation precision: 19.05
Validation AUC: 0.1957317159450468
Validation class accuracies: [0.9804597701149426, 0.01834862385321101]
TARGET: 1
target metric(test f1): 0.03347280334728034
column_sums: [1067   21]
cm_sum: 1088
The training is defaulting to either class.
Epoch 30/80
525/525 - 525s - loss: 0.5002 - accuracy: 0.7626 - val_loss: 0.5758 - val_accuracy: 0.7592
Confusion matrix: 
 [[802  68]
 [194  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.48
Validation accuracy: 75.92
Validation recall: 11.01
Validation precision: 26.09
Validation AUC: 0.20223754804234806
Validation class accuracies: [0.9218390804597701, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.15483870967741936
column_sums: [996  92]
cm_sum: 1088
The training is defaulting to either class.
Epoch 31/80
525/525 - 525s - loss: 0.4986 - accuracy: 0.7636 - val_loss: 0.5574 - val_accuracy: 0.7840
Confusion matrix: 
 [[847  23]
 [212   6]]
Validation f1: 4.86
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.40
Validation recall: 2.75
Validation precision: 20.69
Validation AUC: 0.200065589759842
Validation class accuracies: [0.9735632183908046, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.04858299595141701
column_sums: [1059   29]
cm_sum: 1088
The training is defaulting to either class.
Epoch 32/80
525/525 - 524s - loss: 0.4868 - accuracy: 0.7707 - val_loss: 0.5589 - val_accuracy: 0.7785
Confusion matrix: 
 [[840  30]
 [211   7]]
Validation f1: 5.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 77.85
Validation recall: 3.21
Validation precision: 18.92
Validation AUC: 0.20509824579892316
Validation class accuracies: [0.9655172413793104, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.054901960784313725
column_sums: [1051   37]
cm_sum: 1088
The training is defaulting to either class.
Epoch 33/80
525/525 - 524s - loss: 0.4919 - accuracy: 0.7693 - val_loss: 0.5571 - val_accuracy: 0.7803
Confusion matrix: 
 [[840  30]
 [209   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 7.00
Validation accuracy: 78.03
Validation recall: 4.13
Validation precision: 23.08
Validation AUC: 0.2072817874032153
Validation class accuracies: [0.9655172413793104, 0.04128440366972477]
TARGET: 1
target metric(test f1): 0.07003891050583656
column_sums: [1049   39]
cm_sum: 1088
The training is defaulting to either class.
Epoch 34/80
525/525 - 527s - loss: 0.4859 - accuracy: 0.7712 - val_loss: 0.5609 - val_accuracy: 0.7803
Confusion matrix: 
 [[841  29]
 [210   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 6.27
Validation accuracy: 78.03
Validation recall: 3.67
Validation precision: 21.62
Validation AUC: 0.20774779799059473
Validation class accuracies: [0.9666666666666667, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.06274509803921569
column_sums: [1051   37]
cm_sum: 1088
The training is defaulting to either class.
Epoch 35/80
525/525 - 525s - loss: 0.4843 - accuracy: 0.7636 - val_loss: 0.5807 - val_accuracy: 0.7849
Confusion matrix: 
 [[846  24]
 [210   8]]
Validation f1: 6.40
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 78.49
Validation recall: 3.67
Validation precision: 25.00
Validation AUC: 0.1950731857265543
Validation class accuracies: [0.9724137931034482, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.064
column_sums: [1056   32]
cm_sum: 1088
The training is defaulting to either class.
Epoch 36/80
525/525 - 525s - loss: 0.4794 - accuracy: 0.7700 - val_loss: 0.5814 - val_accuracy: 0.7491
Confusion matrix: 
 [[784  86]
 [187  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.51
Validation accuracy: 74.91
Validation recall: 14.22
Validation precision: 26.50
Validation AUC: 0.22176181120345234
Validation class accuracies: [0.9011494252873563, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.18507462686567167
column_sums: [971 117]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 7 epochs
Epoch 37/80
525/525 - 523s - loss: 0.4833 - accuracy: 0.7724 - val_loss: 0.6003 - val_accuracy: 0.7610
Confusion matrix: 
 [[810  60]
 [200  18]]
Validation f1: 12.16
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.10
Validation recall: 8.26
Validation precision: 23.08
Validation AUC: 0.20254305631490577
Validation class accuracies: [0.9310344827586207, 0.08256880733944955]
TARGET: 1
target metric(test f1): 0.12162162162162163
column_sums: [1010   78]
cm_sum: 1088
The training is defaulting to either class.
Epoch 38/80
525/525 - 522s - loss: 0.4790 - accuracy: 0.7734 - val_loss: 0.6248 - val_accuracy: 0.7160
Confusion matrix: 
 [[743 127]
 [182  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.90
Validation accuracy: 71.60
Validation recall: 16.51
Validation precision: 22.09
Validation AUC: 0.21533716669413827
Validation class accuracies: [0.8540229885057471, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.1889763779527559
column_sums: [925 163]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 8 epochs
Epoch 39/80
525/525 - 526s - loss: 0.4670 - accuracy: 0.7769 - val_loss: 0.5866 - val_accuracy: 0.7684
Confusion matrix: 
 [[816  54]
 [198  20]]
Validation f1: 13.70
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 76.84
Validation recall: 9.17
Validation precision: 27.03
Validation AUC: 0.20951146304278073
Validation class accuracies: [0.9379310344827586, 0.09174311926605505]
TARGET: 1
target metric(test f1): 0.136986301369863
column_sums: [1014   74]
cm_sum: 1088
The training is defaulting to either class.
Epoch 40/80
525/525 - 525s - loss: 0.4603 - accuracy: 0.7817 - val_loss: 0.6000 - val_accuracy: 0.7619
Confusion matrix: 
 [[805  65]
 [194  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.64
Validation accuracy: 76.19
Validation recall: 11.01
Validation precision: 26.97
Validation AUC: 0.20715822896120006
Validation class accuracies: [0.9252873563218391, 0.11009174311926606]
TARGET: 1
target metric(test f1): 0.15635179153094464
column_sums: [999  89]
cm_sum: 1088
The training is defaulting to either class.
Epoch 41/80
525/525 - 524s - loss: 0.4600 - accuracy: 0.7841 - val_loss: 0.6006 - val_accuracy: 0.7610
Confusion matrix: 
 [[802  68]
 [192  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.67
Validation accuracy: 76.10
Validation recall: 11.93
Validation precision: 27.66
Validation AUC: 0.21124114632493027
Validation class accuracies: [0.9218390804597701, 0.11926605504587157]
TARGET: 1
target metric(test f1): 0.16666666666666669
column_sums: [994  94]
cm_sum: 1088
The training is defaulting to either class.
Epoch 42/80
525/525 - 523s - loss: 0.4593 - accuracy: 0.7848 - val_loss: 0.6052 - val_accuracy: 0.7574
Confusion matrix: 
 [[797  73]
 [191  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.98
Validation accuracy: 75.74
Validation recall: 12.39
Validation precision: 27.00
Validation AUC: 0.21188589050358753
Validation class accuracies: [0.9160919540229885, 0.12385321100917432]
TARGET: 1
target metric(test f1): 0.169811320754717
column_sums: [988 100]
cm_sum: 1088
The training is defaulting to either class.
Epoch 43/80
525/525 - 524s - loss: 0.4581 - accuracy: 0.7874 - val_loss: 0.5995 - val_accuracy: 0.7564
Confusion matrix: 
 [[798  72]
 [193  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.87
Validation accuracy: 75.64
Validation recall: 11.47
Validation precision: 25.77
Validation AUC: 0.21387903683593917
Validation class accuracies: [0.9172413793103448, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.15873015873015875
column_sums: [991  97]
cm_sum: 1088
The training is defaulting to either class.
Epoch 44/80
525/525 - 523s - loss: 0.4629 - accuracy: 0.7788 - val_loss: 0.6101 - val_accuracy: 0.7546
Confusion matrix: 
 [[795  75]
 [192  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.30
Validation accuracy: 75.46
Validation recall: 11.93
Validation precision: 25.74
Validation AUC: 0.20951278349094044
Validation class accuracies: [0.9137931034482759, 0.11926605504587157]
TARGET: 1
target metric(test f1): 0.16300940438871475
column_sums: [987 101]
cm_sum: 1088
The training is defaulting to either class.
Epoch 45/80
525/525 - 523s - loss: 0.4566 - accuracy: 0.7891 - val_loss: 0.6040 - val_accuracy: 0.7546
Confusion matrix: 
 [[794  76]
 [191  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.82
Validation accuracy: 75.46
Validation recall: 12.39
Validation precision: 26.21
Validation AUC: 0.21348702829436722
Validation class accuracies: [0.9126436781609195, 0.12385321100917432]
TARGET: 1
target metric(test f1): 0.16822429906542055
column_sums: [985 103]
cm_sum: 1088
The training is defaulting to either class.
Epoch 46/80
525/525 - 523s - loss: 0.4522 - accuracy: 0.7893 - val_loss: 0.6044 - val_accuracy: 0.7564
Confusion matrix: 
 [[796  74]
 [191  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.93
Validation accuracy: 75.64
Validation recall: 12.39
Validation precision: 26.73
Validation AUC: 0.21379510252946626
Validation class accuracies: [0.9149425287356322, 0.12385321100917432]
TARGET: 1
target metric(test f1): 0.16927899686520378
column_sums: [987 101]
cm_sum: 1088
The training is defaulting to either class.
Epoch 47/80
525/525 - 524s - loss: 0.4580 - accuracy: 0.7834 - val_loss: 0.6099 - val_accuracy: 0.7537
Confusion matrix: 
 [[791  79]
 [189  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.79
Validation accuracy: 75.37
Validation recall: 13.30
Validation precision: 26.85
Validation AUC: 0.2162907466124875
Validation class accuracies: [0.9091954022988505, 0.13302752293577982]
TARGET: 1
target metric(test f1): 0.17791411042944785
column_sums: [980 108]
cm_sum: 1088
The training is defaulting to either class.
Epoch 48/80
525/525 - 524s - loss: 0.4636 - accuracy: 0.7807 - val_loss: 0.6158 - val_accuracy: 0.7482
Confusion matrix: 
 [[783  87]
 [187  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.45
Validation accuracy: 74.82
Validation recall: 14.22
Validation precision: 26.27
Validation AUC: 0.21556421182155888
Validation class accuracies: [0.9, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.18452380952380956
column_sums: [970 118]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 9 epochs
Epoch 49/80
525/525 - 524s - loss: 0.4552 - accuracy: 0.7803 - val_loss: 0.6115 - val_accuracy: 0.7491
Confusion matrix: 
 [[783  87]
 [186  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.99
Validation accuracy: 74.91
Validation recall: 14.68
Validation precision: 26.89
Validation AUC: 0.21326873623155973
Validation class accuracies: [0.9, 0.14678899082568808]
TARGET: 1
target metric(test f1): 0.18991097922848665
column_sums: [969 119]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 10 epochs
Epoch 50/80
525/525 - 524s - loss: 0.4574 - accuracy: 0.7822 - val_loss: 0.6186 - val_accuracy: 0.7445
Confusion matrix: 
 [[780  90]
 [188  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.75
Validation accuracy: 74.45
Validation recall: 13.76
Validation precision: 25.00
Validation AUC: 0.21369299914629877
Validation class accuracies: [0.896551724137931, 0.13761467889908258]
TARGET: 1
target metric(test f1): 0.1775147928994083
column_sums: [968 120]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 11 epochs
Epoch 51/80
525/525 - 525s - loss: 0.4601 - accuracy: 0.7843 - val_loss: 0.6103 - val_accuracy: 0.7509
Confusion matrix: 
 [[787  83]
 [188  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.13
Validation accuracy: 75.09
Validation recall: 13.76
Validation precision: 26.55
Validation AUC: 0.2145113631221164
Validation class accuracies: [0.9045977011494253, 0.13761467889908258]
TARGET: 1
target metric(test f1): 0.1812688821752266
column_sums: [975 113]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 12 epochs
Epoch 52/80
525/525 - 523s - loss: 0.4513 - accuracy: 0.7903 - val_loss: 0.6196 - val_accuracy: 0.7454
Confusion matrix: 
 [[778  92]
 [185  33]]
Validation f1: 19.24
Validation accuracy: 74.54
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 15.14
Validation precision: 26.40
Validation AUC: 0.21538880453272133
Validation class accuracies: [0.8942528735632184, 0.15137614678899083]
TARGET: 1
target metric(test f1): 0.19241982507288632
column_sums: [963 125]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 13 epochs
Epoch 53/80
525/525 - 522s - loss: 0.4505 - accuracy: 0.7862 - val_loss: 0.6146 - val_accuracy: 0.7518
Confusion matrix: 
 [[786  84]
 [186  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 19.16
Validation accuracy: 75.18
Validation recall: 14.68
Validation precision: 27.59
Validation AUC: 0.21402445027633824
Validation class accuracies: [0.903448275862069, 0.14678899082568808]
TARGET: 1
target metric(test f1): 0.19161676646706585
column_sums: [972 116]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 14 epochs
Epoch 54/80
525/525 - 523s - loss: 0.4542 - accuracy: 0.7812 - val_loss: 0.6176 - val_accuracy: 0.7472
Confusion matrix: 
 [[783  87]
 [188  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.91
Validation accuracy: 74.72
Validation recall: 13.76
Validation precision: 25.64
Validation AUC: 0.21268099756275322
Validation class accuracies: [0.9, 0.13761467889908258]
TARGET: 1
target metric(test f1): 0.17910447761194032
column_sums: [971 117]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 15 epochs
Epoch 55/80
525/525 - 522s - loss: 0.4445 - accuracy: 0.7943 - val_loss: 0.6135 - val_accuracy: 0.7528
Confusion matrix: 
 [[791  79]
 [190  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.23
Validation accuracy: 75.28
Validation recall: 12.84
Validation precision: 26.17
Validation AUC: 0.2138026627414068
Validation class accuracies: [0.9091954022988505, 0.12844036697247707]
TARGET: 1
target metric(test f1): 0.1723076923076923
column_sums: [981 107]
cm_sum: 1088
The training is defaulting to either class.
Epoch 56/80
525/525 - 522s - loss: 0.4505 - accuracy: 0.7893 - val_loss: 0.6076 - val_accuracy: 0.7518
Confusion matrix: 
 [[789  81]
 [189  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.68
Validation accuracy: 75.18
Validation recall: 13.30
Validation precision: 26.36
Validation AUC: 0.21383769609598718
Validation class accuracies: [0.906896551724138, 0.13302752293577982]
TARGET: 1
target metric(test f1): 0.1768292682926829
column_sums: [978 110]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 16 epochs
Epoch 57/80
525/525 - 523s - loss: 0.4457 - accuracy: 0.7931 - val_loss: 0.6215 - val_accuracy: 0.7491
Confusion matrix: 
 [[783  87]
 [186  32]]
Validation f1: 18.99
Validation accuracy: 74.91
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 14.68
Validation precision: 26.89
Validation AUC: 0.21478702474346917
Validation class accuracies: [0.9, 0.14678899082568808]
TARGET: 1
target metric(test f1): 0.18991097922848665
column_sums: [969 119]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 17 epochs
Epoch 58/80
525/525 - 523s - loss: 0.4513 - accuracy: 0.7884 - val_loss: 0.6220 - val_accuracy: 0.7482
Confusion matrix: 
 [[782  88]
 [186  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.93
Validation accuracy: 74.82
Validation recall: 14.68
Validation precision: 26.67
Validation AUC: 0.21456907757826585
Validation class accuracies: [0.8988505747126436, 0.14678899082568808]
TARGET: 1
target metric(test f1): 0.18934911242603553
column_sums: [968 120]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 18 epochs
Epoch 59/80
525/525 - 524s - loss: 0.4460 - accuracy: 0.7862 - val_loss: 0.6141 - val_accuracy: 0.7509
Confusion matrix: 
 [[786  84]
 [187  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.62
Validation accuracy: 75.09
Validation recall: 14.22
Validation precision: 26.96
Validation AUC: 0.21537263619493077
Validation class accuracies: [0.903448275862069, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.18618618618618618
column_sums: [973 115]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 19 epochs
Epoch 60/80
525/525 - 521s - loss: 0.4470 - accuracy: 0.7931 - val_loss: 0.6139 - val_accuracy: 0.7472
Confusion matrix: 
 [[782  88]
 [187  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.40
Validation accuracy: 74.72
Validation recall: 14.22
Validation precision: 26.05
Validation AUC: 0.21531651150337972
Validation class accuracies: [0.8988505747126436, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.18397626112759644
column_sums: [969 119]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 20 epochs
Epoch 61/80
525/525 - 525s - loss: 0.4498 - accuracy: 0.7919 - val_loss: 0.6118 - val_accuracy: 0.7509
Confusion matrix: 
 [[786  84]
 [187  31]]
Validation f1: 18.62
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 75.09
Validation recall: 14.22
Validation precision: 26.96
Validation AUC: 0.2147266008146787
Validation class accuracies: [0.903448275862069, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.18618618618618618
column_sums: [973 115]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 21 epochs
Epoch 62/80
525/525 - 526s - loss: 0.4435 - accuracy: 0.7917 - val_loss: 0.6145 - val_accuracy: 0.7482
Confusion matrix: 
 [[783  87]
 [187  31]]
Validation f1: 18.45
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 74.82
Validation recall: 14.22
Validation precision: 26.27
Validation AUC: 0.2152503279090615
Validation class accuracies: [0.9, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.18452380952380956
column_sums: [970 118]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 22 epochs
Epoch 63/80
525/525 - 525s - loss: 0.4547 - accuracy: 0.7931 - val_loss: 0.6206 - val_accuracy: 0.7482
Confusion matrix: 
 [[783  87]
 [187  31]]
Validation f1: 18.45
Validation accuracy: 74.82
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 14.22
Validation precision: 26.27
Validation AUC: 0.21472087465424466
Validation class accuracies: [0.9, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.18452380952380956
column_sums: [970 118]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 23 epochs
Epoch 64/80
525/525 - 526s - loss: 0.4501 - accuracy: 0.7948 - val_loss: 0.6212 - val_accuracy: 0.7482
Confusion matrix: 
 [[783  87]
 [187  31]]
Validation f1: 18.45
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 74.82
Validation recall: 14.22
Validation precision: 26.27
Validation AUC: 0.2150308873523061
Validation class accuracies: [0.9, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.18452380952380956
column_sums: [970 118]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.22170900692840648 hasn't increased by 0 in 24 epochs
Epoch 65/80
525/525 - 526s - loss: 0.4590 - accuracy: 0.7803 - val_loss: 0.6095 - val_accuracy: 0.7509
Confusion matrix: 
 [[788  82]
 [189  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.63
Validation accuracy: 75.09
Validation recall: 13.30
Validation precision: 26.13
Validation AUC: 0.21522831234345113
Validation class accuracies: [0.9057471264367816, 0.13302752293577982]

The metrics for the epoch with the best target metric are: 
Best cm: [[703 167]
 [170  48]]
Best f1: 0.22170900692840648
Best accuracy: 0.6902573529411765
Best recall: 0.22018348623853212
Best precision: 0.22325581395348837
Best AUC: 0.23453245999513775
Best epoch: 3
TARGET: 1
target metric(test f1): 0.17629179331306993
column_sums: [977 111]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 3
Starting...
CM: [[21 39]
 [ 4 11]]
F1: 0.3384615384615385
AUC: 0.5033333333333333
Accuracy: 0.4266666666666667
Precision: 0.22
Recall: 0.7333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2149__05_2359__v29__mod9_bsize8/validation_sheet_3.xls...
Done.
Epoch: 3
Starting...
CM: [[35 25]
 [ 9  6]]
F1: 0.26086956521739135
AUC: 0.35677419354838713
Accuracy: 0.5466666666666666
Precision: 0.1935483870967742
Recall: 0.4
Ended. Saving the Excel Sheet ../../new_cache/conv__2149__05_2359__v29__mod9_bsize8/validation_sheet_3.xls...
Done.
Epoch: 3
Starting...
CM: [[47 13]
 [14  1]]
F1: 0.0689655172413793
AUC: 0.1623809523809524
Accuracy: 0.64
Precision: 0.07142857142857142
Recall: 0.06666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2149__05_2359__v29__mod9_bsize8/validation_sheet_3.xls...
Done.
Epoch: 80
Starting...
CM: [[40 20]
 [ 8  7]]
F1: 0.33333333333333337
AUC: 0.41629629629629633
Accuracy: 0.6266666666666667
Precision: 0.25925925925925924
Recall: 0.4666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2149__05_2359__v29__mod9_bsize8/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[53  7]
 [15  0]]
F1: 0.0
AUC: 0.1
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2149__05_2359__v29__mod9_bsize8/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[59  1]
 [15  0]]
F1: 0.0
AUC: 0.1
Accuracy: 0.7866666666666666
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2149__05_2359__v29__mod9_bsize8/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 17915
wandb: Program ended successfully.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: / 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: - 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: \ 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.03MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_000003-9ycshdka/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_000003-9ycshdka/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.78027
wandb:         val_accuracy 0.75092
wandb:             _runtime 35860
wandb:           _timestamp 1621331863
wandb:                _step 458
wandb:           train_loss 0.45904
wandb:             val_loss 0.60949
wandb:           val_recall 0.13303
wandb:        val_precision 0.26126
wandb:               val_f1 0.17629
wandb:              val_auc 0.21523
wandb:                   lr 0.0
wandb:          best_val_f1 0.22171
wandb:    best_val_accuracy 0.69026
wandb:   best_val_precision 0.22326
wandb:      best_val_recall 0.22018
wandb:             best_auc 0.23453
wandb:           best_epoch 3
wandb:           best_bd_f1 0.33846
wandb:          best_bd_auc 0.50333
wandb:     best_bd_accuracy 0.42667
wandb:    best_bd_precision 0.22
wandb:       best_bd_recall 0.73333
wandb:        best_bd_epoch 3
wandb: Run history:
wandb:   train_accuracy â–â–‚â–‚â–ƒâ–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–…â–…â–…â–…â–†â–†â–†â–†â–†â–‡â–‡â–‡â–ˆâ–ˆâ–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡
wandb:     val_accuracy â–ˆâ–â–ˆâ–‡â–‡â–ˆâ–ˆâ–‡â–‡â–†â–ˆâ–‡â–‡â–‡â–ˆâ–‡â–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡
wandb:         _runtime â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:       _timestamp â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            _step â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:       train_loss â–ˆâ–†â–†â–†â–†â–†â–†â–†â–…â–…â–„â–„â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–‚â–‚â–‚â–‚â–â–â–â–‚â–â–‚â–â–â–â–â–â–â–â–‚
wandb:         val_loss â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:       val_recall â–â–ˆâ–â–‚â–‚â–â–â–‚â–‚â–‚â–â–â–‚â–‚â–â–‚â–â–â–‚â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
wandb:    val_precision â–â–†â–â–†â–‡â–‡â–ˆâ–†â–†â–†â–‡â–†â–‡â–‡â–†â–ˆâ–‡â–†â–ˆâ–†â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:           val_f1 â–â–ˆâ–â–„â–„â–ƒâ–‚â–„â–…â–…â–ƒâ–ƒâ–„â–„â–ƒâ–…â–‚â–‚â–„â–‚â–ƒâ–‚â–„â–…â–„â–…â–„â–…â–…â–…â–…â–…â–…â–…â–…â–…â–…â–…â–…â–…
wandb:          val_auc â–ˆâ–†â–‡â–…â–†â–†â–†â–‚â–‚â–ƒâ–„â–„â–‚â–ƒâ–„â–‚â–‚â–‚â–‚â–‚â–ƒâ–â–‚â–„â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–ƒâ–ƒâ–ƒ
wandb:               lr â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: 
wandb: Synced 6 W&B file(s), 4 media file(s), 3 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2149: https://wandb.ai/arachid1/tensorboard-integration/runs/9ycshdka


 See logs at ../../new_cache/conv__2149__05_2359__v29__mod9_bsize8/logs/