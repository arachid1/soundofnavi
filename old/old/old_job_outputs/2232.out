Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2232
Description:  timestretching
2021-06-21 15:38:33.676320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-21 15:38:35.927524: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-21 15:38:35.928408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-21 15:38:35.963714: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:35.964501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-21 15:38:35.964538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 15:38:35.967940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 15:38:35.968043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-21 15:38:35.969122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-21 15:38:35.969430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-21 15:38:35.970394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-21 15:38:35.971256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-21 15:38:35.971423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 15:38:35.971539: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:35.972258: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:35.973073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2232.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2232__06_1537__v39__timestretching
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 148, 'WAV_PATH': 'v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 148, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-21 15:38:40.909044: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-21 15:38:40.909261: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:40.909963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-21 15:38:40.910002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 15:38:40.910050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 15:38:40.910072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-21 15:38:40.910090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-21 15:38:40.910107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-21 15:38:40.910125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-21 15:38:40.910142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-21 15:38:40.910159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 15:38:40.910246: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:40.911167: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:40.911869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-21 15:38:40.911917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-21 15:38:41.684321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-21 15:38:41.684366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-21 15:38:41.684375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-21 15:38:41.684641: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:41.685428: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:41.686116: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-21 15:38:41.686791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2682
-----------------------
Number of train recordings: 2682 with pneumonia: 232 and non-pneumonia: 2450
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
The initial learning rate for this job is: 0.000900820283370619
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-21 15:38:42.998878: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-21 15:38:43.001143: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-21 15:38:43.439474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-21 15:38:45.224251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-21 15:38:45.692528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
168/168 - 241s - loss: 0.8339 - accuracy: 0.6327 - val_loss: 2.2784 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.04867090067836137
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
168/168 - 238s - loss: 0.5563 - accuracy: 0.7200 - val_loss: 1.2167 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.049227431490353885
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
168/168 - 238s - loss: 0.3701 - accuracy: 0.8069 - val_loss: 0.3158 - val_accuracy: 0.8182
Confusion matrix: 
 [[489  84]
 [ 26   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.853 0.147]
 [0.812 0.188]]
Validation f1: 9.84
Validation accuracy: 81.82
Validation recall: 18.75
Validation precision: 6.67
Validation AUC: 0.09039325843746539
Validation class accuracies: [0.8534031413612565, 0.1875]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/65
168/168 - 238s - loss: 0.3114 - accuracy: 0.8553 - val_loss: 0.4530 - val_accuracy: 0.7818
Confusion matrix: 
 [[456 117]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.469 0.531]]
Validation f1: 20.48
Validation accuracy: 78.18
Validation recall: 53.12
Validation precision: 12.69
Validation AUC: 0.3158131402338696
Validation class accuracies: [0.7958115183246073, 0.53125]
Saving model...
Epoch 5/65
168/168 - 238s - loss: 0.2213 - accuracy: 0.8956 - val_loss: 1.0422 - val_accuracy: 0.5537
Confusion matrix: 
 [[309 264]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.539 0.461]
 [0.188 0.812]]
Validation f1: 16.15
Validation accuracy: 55.37
Validation recall: 81.25
Validation precision: 8.97
Validation AUC: 0.2779219296444228
Validation class accuracies: [0.5392670157068062, 0.8125]
The validation tracker metric at 0.20481927710843373 hasn't increased by 0 in 1 epochs
Epoch 6/65
168/168 - 238s - loss: 0.2288 - accuracy: 0.8952 - val_loss: 3.6669 - val_accuracy: 0.3372
Confusion matrix: 
 [[174 399]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.304 0.696]
 [0.062 0.938]]
Validation f1: 13.02
Validation accuracy: 33.72
Validation recall: 93.75
Validation precision: 6.99
Validation AUC: 0.3993566459544927
Validation class accuracies: [0.3036649214659686, 0.9375]
The validation tracker metric at 0.20481927710843373 hasn't increased by 0 in 2 epochs
Epoch 7/65
168/168 - 238s - loss: 0.1715 - accuracy: 0.9131 - val_loss: 0.2571 - val_accuracy: 0.9322
Confusion matrix: 
 [[556  17]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97 0.03]
 [0.75 0.25]]
Validation f1: 28.07
Validation accuracy: 93.22
Validation recall: 25.00
Validation precision: 32.00
Validation AUC: 0.18748562889580975
Validation class accuracies: [0.9703315881326352, 0.25]
Saving model...
Epoch 8/65
168/168 - 238s - loss: 0.1564 - accuracy: 0.9247 - val_loss: 2.0760 - val_accuracy: 0.6347
Confusion matrix: 
 [[361 212]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.63  0.37 ]
 [0.281 0.719]]
Validation f1: 17.23
Validation accuracy: 63.47
Validation recall: 71.88
Validation precision: 9.79
Validation AUC: 0.33195372521853045
Validation class accuracies: [0.6300174520069808, 0.71875]
The validation tracker metric at 0.2807017543859649 hasn't increased by 0 in 1 epochs
Epoch 9/65
168/168 - 238s - loss: 0.1393 - accuracy: 0.9385 - val_loss: 0.5669 - val_accuracy: 0.8298
Confusion matrix: 
 [[489  84]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.853 0.147]
 [0.594 0.406]]
Validation f1: 20.16
Validation accuracy: 82.98
Validation recall: 40.62
Validation precision: 13.40
Validation AUC: 0.18413062269131472
Validation class accuracies: [0.8534031413612565, 0.40625]
The validation tracker metric at 0.2807017543859649 hasn't increased by 0 in 2 epochs
Epoch 10/65
168/168 - 238s - loss: 0.1664 - accuracy: 0.9191 - val_loss: 1.3539 - val_accuracy: 0.5455
Confusion matrix: 
 [[308 265]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.538 0.462]
 [0.312 0.688]]
Validation f1: 13.79
Validation accuracy: 54.55
Validation recall: 68.75
Validation precision: 7.67
Validation AUC: 0.37046189282917985
Validation class accuracies: [0.537521815008726, 0.6875]
The validation tracker metric at 0.2807017543859649 hasn't increased by 0 in 3 epochs
Epoch 11/65
168/168 - 238s - loss: 0.1263 - accuracy: 0.9437 - val_loss: 0.7950 - val_accuracy: 0.8364
Confusion matrix: 
 [[485  88]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.344 0.656]]
Validation f1: 29.79
Validation accuracy: 83.64
Validation recall: 65.62
Validation precision: 19.27
Validation AUC: 0.5918062686983745
Validation class accuracies: [0.8464223385689355, 0.65625]
Saving model...
Epoch 12/65
168/168 - 238s - loss: 0.1060 - accuracy: 0.9523 - val_loss: 0.2594 - val_accuracy: 0.9107
Confusion matrix: 
 [[535  38]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.5   0.5  ]]
Validation f1: 37.21
Validation accuracy: 91.07
Validation recall: 50.00
Validation precision: 29.63
Validation AUC: 0.4891768755930459
Validation class accuracies: [0.9336823734729494, 0.5]
Saving model...
Epoch 13/65
168/168 - 238s - loss: 0.1774 - accuracy: 0.9243 - val_loss: 0.9010 - val_accuracy: 0.7124
Confusion matrix: 
 [[409 164]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.714 0.286]
 [0.312 0.688]]
Validation f1: 20.18
Validation accuracy: 71.24
Validation recall: 68.75
Validation precision: 11.83
Validation AUC: 0.3964535267616478
Validation class accuracies: [0.7137870855148342, 0.6875]
The validation tracker metric at 0.37209302325581395 hasn't increased by 0 in 1 epochs
Epoch 14/65
168/168 - 238s - loss: 0.0968 - accuracy: 0.9564 - val_loss: 0.2260 - val_accuracy: 0.9388
Confusion matrix: 
 [[549  24]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.406 0.594]]
Validation f1: 50.67
Validation accuracy: 93.88
Validation recall: 59.38
Validation precision: 44.19
Validation AUC: 0.5431176246315198
Validation class accuracies: [0.9581151832460733, 0.59375]
Saving model...
Epoch 15/65
168/168 - 238s - loss: 0.0931 - accuracy: 0.9661 - val_loss: 0.6669 - val_accuracy: 0.8099
Confusion matrix: 
 [[473 100]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.469 0.531]]
Validation f1: 22.82
Validation accuracy: 80.99
Validation recall: 53.12
Validation precision: 14.53
Validation AUC: 0.4015996698461097
Validation class accuracies: [0.8254799301919721, 0.53125]
The validation tracker metric at 0.5066666666666667 hasn't increased by 0 in 1 epochs
Epoch 16/65
168/168 - 238s - loss: 0.1225 - accuracy: 0.9459 - val_loss: 0.3922 - val_accuracy: 0.8711
Confusion matrix: 
 [[507  66]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.375 0.625]]
Validation f1: 33.90
Validation accuracy: 87.11
Validation recall: 62.50
Validation precision: 23.26
Validation AUC: 0.4603657506754069
Validation class accuracies: [0.8848167539267016, 0.625]
The validation tracker metric at 0.5066666666666667 hasn't increased by 0 in 2 epochs
Epoch 17/65
168/168 - 238s - loss: 0.1207 - accuracy: 0.9526 - val_loss: 0.3663 - val_accuracy: 0.9455
Confusion matrix: 
 [[572   1]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 94.55
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3018773259252584
Validation class accuracies: [0.9982547993019197, 0.0]
The validation tracker metric at 0.5066666666666667 hasn't increased by 0 in 3 epochs
Epoch 18/65
168/168 - 238s - loss: 0.0785 - accuracy: 0.9612 - val_loss: 0.2416 - val_accuracy: 0.9372
Confusion matrix: 
 [[554  19]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.594 0.406]]
Validation f1: 40.62
Validation accuracy: 93.72
Validation recall: 40.62
Validation precision: 40.62
Validation AUC: 0.413233791724467
Validation class accuracies: [0.9668411867364747, 0.40625]
The validation tracker metric at 0.5066666666666667 hasn't increased by 0 in 4 epochs
Epoch 19/65
168/168 - 238s - loss: 0.0616 - accuracy: 0.9720 - val_loss: 0.2245 - val_accuracy: 0.9587
Confusion matrix: 
 [[566   7]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.562 0.438]]
Validation f1: 52.83
Validation accuracy: 95.87
Validation recall: 43.75
Validation precision: 66.67
Validation AUC: 0.551314822714318
Validation class accuracies: [0.987783595113438, 0.4375]
Saving model...
Epoch 20/65
168/168 - 238s - loss: 0.0557 - accuracy: 0.9720 - val_loss: 0.2374 - val_accuracy: 0.9455
Confusion matrix: 
 [[560  13]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.625 0.375]]
Validation f1: 42.11
Validation accuracy: 94.55
Validation recall: 37.50
Validation precision: 48.00
Validation AUC: 0.4148239316069091
Validation class accuracies: [0.9773123909249564, 0.375]
The validation tracker metric at 0.5283018867924528 hasn't increased by 0 in 1 epochs
Epoch 21/65
168/168 - 238s - loss: 0.0325 - accuracy: 0.9858 - val_loss: 0.4071 - val_accuracy: 0.9157
Confusion matrix: 
 [[539  34]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.531 0.469]]
Validation f1: 37.04
Validation accuracy: 91.57
Validation recall: 46.88
Validation precision: 30.61
Validation AUC: 0.3878274204954967
Validation class accuracies: [0.9406631762652705, 0.46875]
The validation tracker metric at 0.5283018867924528 hasn't increased by 0 in 2 epochs
Epoch 22/65
168/168 - 238s - loss: 0.0780 - accuracy: 0.9612 - val_loss: 0.3925 - val_accuracy: 0.8959
Confusion matrix: 
 [[523  50]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.406 0.594]]
Validation f1: 37.62
Validation accuracy: 89.59
Validation recall: 59.38
Validation precision: 27.54
Validation AUC: 0.48596897660670163
Validation class accuracies: [0.912739965095986, 0.59375]
The validation tracker metric at 0.5283018867924528 hasn't increased by 0 in 3 epochs
Epoch 23/65
168/168 - 238s - loss: 0.0991 - accuracy: 0.9631 - val_loss: 1.1299 - val_accuracy: 0.7537
Confusion matrix: 
 [[437 136]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.763 0.237]
 [0.406 0.594]]
Validation f1: 20.32
Validation accuracy: 75.37
Validation recall: 59.38
Validation precision: 12.26
Validation AUC: 0.32998281420772807
Validation class accuracies: [0.7626527050610821, 0.59375]
The validation tracker metric at 0.5283018867924528 hasn't increased by 0 in 4 epochs
Epoch 24/65
168/168 - 238s - loss: 0.0362 - accuracy: 0.9817 - val_loss: 0.2454 - val_accuracy: 0.9405
Confusion matrix: 
 [[553  20]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.5   0.5  ]]
Validation f1: 47.06
Validation accuracy: 94.05
Validation recall: 50.00
Validation precision: 44.44
Validation AUC: 0.5229868198607689
Validation class accuracies: [0.9650959860383944, 0.5]
The validation tracker metric at 0.5283018867924528 hasn't increased by 0 in 5 epochs
Epoch 25/65
168/168 - 238s - loss: 0.0240 - accuracy: 0.9896 - val_loss: 0.2881 - val_accuracy: 0.9587
Confusion matrix: 
 [[571   2]
 [ 23   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.719 0.281]]
Validation f1: 41.86
Validation accuracy: 95.87
Validation recall: 28.12
Validation precision: 81.82
Validation AUC: 0.4721700236572778
Validation class accuracies: [0.9965095986038395, 0.28125]
The validation tracker metric at 0.5283018867924528 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 26/65
168/168 - 238s - loss: 0.0203 - accuracy: 0.9922 - val_loss: 0.2537 - val_accuracy: 0.9636
Confusion matrix: 
 [[570   3]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.594 0.406]]
Validation f1: 54.17
Validation accuracy: 96.36
Validation recall: 40.62
Validation precision: 81.25
Validation AUC: 0.521583361501221
Validation class accuracies: [0.9947643979057592, 0.40625]
Saving model...
Epoch 27/65
168/168 - 238s - loss: 0.0147 - accuracy: 0.9952 - val_loss: 0.2420 - val_accuracy: 0.9603
Confusion matrix: 
 [[569   4]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.625 0.375]]
Validation f1: 50.00
Validation accuracy: 96.03
Validation recall: 37.50
Validation precision: 75.00
Validation AUC: 0.4999046278609301
Validation class accuracies: [0.9930191972076788, 0.375]
The validation tracker metric at 0.5416666666666666 hasn't increased by 0 in 1 epochs
Epoch 28/65
168/168 - 238s - loss: 0.0120 - accuracy: 0.9952 - val_loss: 0.2409 - val_accuracy: 0.9587
Confusion matrix: 
 [[565   8]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.531 0.469]]
Validation f1: 54.55
Validation accuracy: 95.87
Validation recall: 46.88
Validation precision: 65.22
Validation AUC: 0.5427130825522332
Validation class accuracies: [0.9860383944153578, 0.46875]
Saving model...
Epoch 29/65
168/168 - 238s - loss: 0.0127 - accuracy: 0.9963 - val_loss: 0.2616 - val_accuracy: 0.9554
Confusion matrix: 
 [[563  10]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.531 0.469]]
Validation f1: 52.63
Validation accuracy: 95.54
Validation recall: 46.88
Validation precision: 60.00
Validation AUC: 0.5670420414395487
Validation class accuracies: [0.9825479930191972, 0.46875]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 1 epochs
Epoch 30/65
168/168 - 238s - loss: 0.0123 - accuracy: 0.9952 - val_loss: 0.3867 - val_accuracy: 0.9174
Confusion matrix: 
 [[537  36]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.438 0.562]]
Validation f1: 41.86
Validation accuracy: 91.74
Validation recall: 56.25
Validation precision: 33.33
Validation AUC: 0.5550010547825743
Validation class accuracies: [0.93717277486911, 0.5625]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 2 epochs
Epoch 31/65
168/168 - 238s - loss: 0.0085 - accuracy: 0.9963 - val_loss: 0.2647 - val_accuracy: 0.9636
Confusion matrix: 
 [[571   2]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.625 0.375]]
Validation f1: 52.17
Validation accuracy: 96.36
Validation recall: 37.50
Validation precision: 85.71
Validation AUC: 0.5367742091964905
Validation class accuracies: [0.9965095986038395, 0.375]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 3 epochs
Epoch 32/65
168/168 - 238s - loss: 0.0093 - accuracy: 0.9959 - val_loss: 0.2745 - val_accuracy: 0.9570
Confusion matrix: 
 [[571   2]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.75  0.25 ]]
Validation f1: 38.10
Validation accuracy: 95.70
Validation recall: 25.00
Validation precision: 80.00
Validation AUC: 0.4771859291580318
Validation class accuracies: [0.9965095986038395, 0.25]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 4 epochs
Epoch 33/65
168/168 - 238s - loss: 0.0065 - accuracy: 0.9978 - val_loss: 0.2518 - val_accuracy: 0.9603
Confusion matrix: 
 [[566   7]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.531 0.469]]
Validation f1: 55.56
Validation accuracy: 96.03
Validation recall: 46.88
Validation precision: 68.18
Validation AUC: 0.5424932206289135
Validation class accuracies: [0.987783595113438, 0.46875]
Saving model...
Epoch 34/65
168/168 - 238s - loss: 0.0179 - accuracy: 0.9933 - val_loss: 4.3626 - val_accuracy: 0.4496
Confusion matrix: 
 [[246 327]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.429 0.571]
 [0.188 0.812]]
Validation f1: 13.51
Validation accuracy: 44.96
Validation recall: 81.25
Validation precision: 7.37
Validation AUC: 0.42819295153677717
Validation class accuracies: [0.4293193717277487, 0.8125]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 1 epochs
Epoch 35/65
168/168 - 238s - loss: 0.0222 - accuracy: 0.9911 - val_loss: 0.3225 - val_accuracy: 0.9554
Confusion matrix: 
 [[570   3]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.75  0.25 ]]
Validation f1: 37.21
Validation accuracy: 95.54
Validation recall: 25.00
Validation precision: 72.73
Validation AUC: 0.4363245158473133
Validation class accuracies: [0.9947643979057592, 0.25]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 2 epochs
Epoch 36/65
168/168 - 238s - loss: 0.0068 - accuracy: 0.9974 - val_loss: 0.2919 - val_accuracy: 0.9603
Confusion matrix: 
 [[571   2]
 [ 22  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.688 0.312]]
Validation f1: 45.45
Validation accuracy: 96.03
Validation recall: 31.25
Validation precision: 83.33
Validation AUC: 0.4992621630330039
Validation class accuracies: [0.9965095986038395, 0.3125]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 3 epochs
Epoch 37/65
168/168 - 238s - loss: 0.0080 - accuracy: 0.9985 - val_loss: 0.3739 - val_accuracy: 0.9504
Confusion matrix: 
 [[569   4]
 [ 26   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.812 0.188]]
Validation f1: 28.57
Validation accuracy: 95.04
Validation recall: 18.75
Validation precision: 60.00
Validation AUC: 0.36016276338352765
Validation class accuracies: [0.9930191972076788, 0.1875]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 4 epochs
Epoch 38/65
168/168 - 238s - loss: 0.0063 - accuracy: 0.9978 - val_loss: 0.2947 - val_accuracy: 0.9620
Confusion matrix: 
 [[570   3]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.625 0.375]]
Validation f1: 51.06
Validation accuracy: 96.20
Validation recall: 37.50
Validation precision: 80.00
Validation AUC: 0.5144227089143498
Validation class accuracies: [0.9947643979057592, 0.375]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 5 epochs
Epoch 39/65
168/168 - 238s - loss: 0.0032 - accuracy: 0.9993 - val_loss: 0.3114 - val_accuracy: 0.9570
Confusion matrix: 
 [[571   2]
 [ 24   8]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.75  0.25 ]]
Validation f1: 38.10
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 95.70
Validation recall: 25.00
Validation precision: 80.00
Validation AUC: 0.44288472176035504
Validation class accuracies: [0.9965095986038395, 0.25]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 40/65
168/168 - 238s - loss: 0.0050 - accuracy: 0.9993 - val_loss: 0.3289 - val_accuracy: 0.9587
Confusion matrix: 
 [[570   3]
 [ 22  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.688 0.312]]
Validation f1: 44.44
Validation accuracy: 95.87
Validation recall: 31.25
Validation precision: 76.92
Validation AUC: 0.44711272911837857
Validation class accuracies: [0.9947643979057592, 0.3125]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 7 epochs
Epoch 41/65
168/168 - 238s - loss: 0.0035 - accuracy: 0.9993 - val_loss: 0.2974 - val_accuracy: 0.9603
Confusion matrix: 
 [[569   4]
 [ 20  12]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.625 0.375]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 96.03
Validation recall: 37.50
Validation precision: 75.00
Validation AUC: 0.49551782278252
Validation class accuracies: [0.9930191972076788, 0.375]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 8 epochs
Epoch 42/65
168/168 - 238s - loss: 0.0049 - accuracy: 0.9989 - val_loss: 0.3033 - val_accuracy: 0.9653
Confusion matrix: 
 [[572   1]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.625 0.375]]
Validation f1: 53.33
Validation accuracy: 96.53
Validation recall: 37.50
Validation precision: 92.31
Validation AUC: 0.48272362419509807
Validation class accuracies: [0.9982547993019197, 0.375]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 9 epochs
Epoch 43/65
168/168 - 238s - loss: 0.0041 - accuracy: 0.9996 - val_loss: 0.3113 - val_accuracy: 0.9636
Confusion matrix: 
 [[572   1]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.656 0.344]]
Validation f1: 50.00
Validation accuracy: 96.36
Validation recall: 34.38
Validation precision: 91.67
Validation AUC: 0.4967725854776873
Validation class accuracies: [0.9982547993019197, 0.34375]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 10 epochs
Epoch 44/65
168/168 - 238s - loss: 0.0026 - accuracy: 0.9996 - val_loss: 0.3296 - val_accuracy: 0.9587
Confusion matrix: 
 [[571   2]
 [ 23   9]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.719 0.281]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.86
Validation accuracy: 95.87
Validation recall: 28.12
Validation precision: 81.82
Validation AUC: 0.45516460222687805
Validation class accuracies: [0.9965095986038395, 0.28125]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 11 epochs
Epoch 45/65
168/168 - 238s - loss: 0.0028 - accuracy: 0.9993 - val_loss: 0.2969 - val_accuracy: 0.9620
Confusion matrix: 
 [[571   2]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.656 0.344]]
Validation f1: 48.89
Validation accuracy: 96.20
Validation recall: 34.38
Validation precision: 84.62
Validation AUC: 0.4955473718830337
Validation class accuracies: [0.9965095986038395, 0.34375]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 46/65
168/168 - 238s - loss: 0.0021 - accuracy: 1.0000 - val_loss: 0.2944 - val_accuracy: 0.9620
Confusion matrix: 
 [[570   3]
 [ 20  12]]
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.625 0.375]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.06
Validation accuracy: 96.20
Validation recall: 37.50
Validation precision: 80.00
Validation AUC: 0.49539862111610666
Validation class accuracies: [0.9947643979057592, 0.375]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 13 epochs
Epoch 47/65
168/168 - 238s - loss: 0.0030 - accuracy: 0.9989 - val_loss: 0.2948 - val_accuracy: 0.9587
Confusion matrix: 
 [[567   6]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.594 0.406]]
Validation f1: 50.98
Validation accuracy: 95.87
Validation recall: 40.62
Validation precision: 68.42
Validation AUC: 0.5057774768208395
Validation class accuracies: [0.9895287958115183, 0.40625]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 14 epochs
Epoch 48/65
168/168 - 238s - loss: 0.0047 - accuracy: 0.9993 - val_loss: 0.3020 - val_accuracy: 0.9653
Confusion matrix: 
 [[570   3]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.562 0.438]]
Validation f1: 57.14
Validation accuracy: 96.53
Validation recall: 43.75
Validation precision: 82.35
Validation AUC: 0.5153352001665751
Validation class accuracies: [0.9947643979057592, 0.4375]
Saving model...
Epoch 49/65
168/168 - 238s - loss: 0.0026 - accuracy: 0.9996 - val_loss: 0.3014 - val_accuracy: 0.9636
Confusion matrix: 
 [[572   1]
 [ 21  11]]
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.656 0.344]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 96.36
Validation recall: 34.38
Validation precision: 91.67
Validation AUC: 0.5169338990838097
Validation class accuracies: [0.9982547993019197, 0.34375]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 1 epochs
Epoch 50/65
168/168 - 238s - loss: 0.0076 - accuracy: 0.9981 - val_loss: 0.3087 - val_accuracy: 0.9620
Confusion matrix: 
 [[566   7]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.5   0.5  ]]
Validation f1: 58.18
Validation accuracy: 96.20
Validation recall: 50.00
Validation precision: 69.57
Validation AUC: 0.5520203657096008
Validation class accuracies: [0.987783595113438, 0.5]
Saving model...
Epoch 51/65
168/168 - 238s - loss: 0.0042 - accuracy: 0.9981 - val_loss: 0.2847 - val_accuracy: 0.9653
Confusion matrix: 
 [[569   4]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.531 0.469]]
Validation f1: 58.82
Validation accuracy: 96.53
Validation recall: 46.88
Validation precision: 78.95
Validation AUC: 0.5466467873017186
Validation class accuracies: [0.9930191972076788, 0.46875]
Saving model...
Epoch 52/65
168/168 - 238s - loss: 0.0030 - accuracy: 0.9993 - val_loss: 0.2751 - val_accuracy: 0.9636
Confusion matrix: 
 [[568   5]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.531 0.469]]
Validation f1: 57.69
Validation accuracy: 96.36
Validation recall: 46.88
Validation precision: 75.00
Validation AUC: 0.546708221885624
Validation class accuracies: [0.9912739965095986, 0.46875]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 1 epochs
Epoch 53/65
168/168 - 237s - loss: 0.0049 - accuracy: 0.9981 - val_loss: 0.2743 - val_accuracy: 0.9636
Confusion matrix: 
 [[569   4]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.562 0.438]]
Validation f1: 56.00
Validation accuracy: 96.36
Validation recall: 43.75
Validation precision: 77.78
Validation AUC: 0.534353799401494
Validation class accuracies: [0.9930191972076788, 0.4375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 2 epochs
Epoch 54/65
168/168 - 237s - loss: 0.0023 - accuracy: 0.9989 - val_loss: 0.2851 - val_accuracy: 0.9636
Confusion matrix: 
 [[572   1]
 [ 21  11]]
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.656 0.344]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 96.36
Validation recall: 34.38
Validation precision: 91.67
Validation AUC: 0.5284199190242582
Validation class accuracies: [0.9982547993019197, 0.34375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 3 epochs
Epoch 55/65
168/168 - 237s - loss: 0.0055 - accuracy: 0.9993 - val_loss: 0.2953 - val_accuracy: 0.9636
Confusion matrix: 
 [[571   2]
 [ 20  12]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.625 0.375]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.17
Validation accuracy: 96.36
Validation recall: 37.50
Validation precision: 85.71
Validation AUC: 0.4976438734190869
Validation class accuracies: [0.9965095986038395, 0.375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 4 epochs
Epoch 56/65
168/168 - 237s - loss: 0.0026 - accuracy: 0.9996 - val_loss: 0.2849 - val_accuracy: 0.9603
Confusion matrix: 
 [[566   7]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.531 0.469]]
Validation f1: 55.56
Validation accuracy: 96.03
Validation recall: 46.88
Validation precision: 68.18
Validation AUC: 0.5311280457333283
Validation class accuracies: [0.987783595113438, 0.46875]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 5 epochs
Epoch 57/65
168/168 - 237s - loss: 0.0014 - accuracy: 0.9996 - val_loss: 0.2874 - val_accuracy: 0.9603
Confusion matrix: 
 [[569   4]
 [ 20  12]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.625 0.375]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 96.03
Validation recall: 37.50
Validation precision: 75.00
Validation AUC: 0.5193763240183845
Validation class accuracies: [0.9930191972076788, 0.375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 58/65
168/168 - 237s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.2866 - val_accuracy: 0.9620
Confusion matrix: 
 [[570   3]
 [ 20  12]]
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.625 0.375]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.06
Validation accuracy: 96.20
Validation recall: 37.50
Validation precision: 80.00
Validation AUC: 0.5142887506237768
Validation class accuracies: [0.9947643979057592, 0.375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 7 epochs
Epoch 59/65
168/168 - 237s - loss: 0.0020 - accuracy: 0.9989 - val_loss: 0.2957 - val_accuracy: 0.9620
Confusion matrix: 
 [[571   2]
 [ 21  11]]
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.656 0.344]]
Validation f1: 48.89
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 96.20
Validation recall: 34.38
Validation precision: 84.62
Validation AUC: 0.5134334380191335
Validation class accuracies: [0.9965095986038395, 0.34375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 8 epochs
Epoch 60/65
168/168 - 238s - loss: 0.0020 - accuracy: 0.9993 - val_loss: 0.2925 - val_accuracy: 0.9636
Confusion matrix: 
 [[572   1]
 [ 21  11]]
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.656 0.344]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 96.36
Validation recall: 34.38
Validation precision: 91.67
Validation AUC: 0.5127401699909091
Validation class accuracies: [0.9982547993019197, 0.34375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 9 epochs
Epoch 61/65
168/168 - 238s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.2941 - val_accuracy: 0.9636
Confusion matrix: 
 [[572   1]
 [ 21  11]]
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.656 0.344]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 96.36
Validation recall: 34.38
Validation precision: 91.67
Validation AUC: 0.5069474888446498
Validation class accuracies: [0.9982547993019197, 0.34375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 10 epochs
Epoch 62/65
168/168 - 238s - loss: 0.0033 - accuracy: 1.0000 - val_loss: 0.2901 - val_accuracy: 0.9620
Confusion matrix: 
 [[570   3]
 [ 20  12]]
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.625 0.375]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.06
Validation accuracy: 96.20
Validation recall: 37.50
Validation precision: 80.00
Validation AUC: 0.5110684309404842
Validation class accuracies: [0.9947643979057592, 0.375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 11 epochs
Epoch 63/65
168/168 - 238s - loss: 0.0015 - accuracy: 1.0000 - val_loss: 0.2922 - val_accuracy: 0.9636
Confusion matrix: 
 [[569   4]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.562 0.438]]
Validation f1: 56.00
Validation accuracy: 96.36
Validation recall: 43.75
Validation precision: 77.78
Validation AUC: 0.5299704271601048
Validation class accuracies: [0.9930191972076788, 0.4375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 64/65
168/168 - 238s - loss: 0.0019 - accuracy: 0.9996 - val_loss: 0.2895 - val_accuracy: 0.9636
Confusion matrix: 
 [[569   4]
 [ 18  14]]
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.562 0.438]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.00
Validation accuracy: 96.36
Validation recall: 43.75
Validation precision: 77.78
Validation AUC: 0.5299918150846262
Validation class accuracies: [0.9930191972076788, 0.4375]
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 13 epochs
Epoch 65/65
168/168 - 238s - loss: 0.0016 - accuracy: 0.9993 - val_loss: 0.2928 - val_accuracy: 0.9636
Confusion matrix: 
 [[570   3]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.594 0.406]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.17
Validation accuracy: 96.36
Validation recall: 40.62
Validation precision: 81.25
Validation AUC: 0.5244059269869676
Validation class accuracies: [0.9947643979057592, 0.40625]

The metrics for job 0 with the best target metric are: 
Best cm: [[569   4]
 [ 17  15]]
Best normalized cm: [[0.993 0.007]
 [0.531 0.469]]
Best f1: 0.59
Best accuracy: 0.97
Best recall: 0.47
Best precision: 0.79
Best AUC: 0.55
Best class accuracies: [0.9930191972076788, 0.46875]
Best epoch: 51
The validation tracker metric at 0.5882352941176471 hasn't increased by 0 in 14 epochs
wandb: Waiting for W&B process to finish, PID 4108
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210621_153836-3qkaym6u/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210621_153836-3qkaym6u/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99925
wandb:         val_accuracy 0.96364
wandb:             _runtime 16348
wandb:           _timestamp 1624306264
wandb:                _step 493
wandb:           train_loss 0.0016
wandb:             val_loss 0.29277
wandb:           val_recall 0.40625
wandb:        val_precision 0.8125
wandb:               val_f1 0.54167
wandb:              val_auc 0.52441
wandb:                   lr 3e-05
wandb:          best_val_f1 0.58824
wandb:    best_val_accuracy 0.96529
wandb:   best_val_precision 0.78947
wandb:      best_val_recall 0.46875
wandb:             best_auc 0.54665
wandb:           best_epoch 51
wandb: Run history:
wandb:   train_accuracy ▁▃▅▆▆▇▆▇▇▇▇▇▇▇▇█████████████████████████
wandb:     val_accuracy ▁▁▇▅█▇▅██▇███▇▆█████████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▄▃▂▂▂▂▂▂▂▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss █▄▂▄▁▂▅▁▁▃▁▁▁▂▄▁▁▁▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ██▅▇▃▄▆▅▅▅▁▄▄▅▅▃▄▄▅▃▄▃▂▄▃▄▃▃▄▄▅▄▄▄▄▄▃▃▄▄
wandb:    val_precision ▁▁▂▂▃▂▂▃▄▂▁▆▅▃▂▇▇▆▄▇▆▇▆▇▇██▇▇▇▆▇▇█▆▇██▇▇
wandb:           val_f1 ▂▂▃▃▄▃▃▅▇▄▁▇▆▅▃▆▇▇▆▆█▅▄▇▆▇▇▇▇████▇█▇▇▇█▇
wandb:          val_auc ▁▁▅▄▃▃▅▇█▆▅█▆▇▅▇▇██▇█▆▅▇▇▇▇▇▇▇███▇█▇▇▇██
wandb:               lr ████████████████▄▄▄▄▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210621_153836-3qkaym6u


 See logs at ../../new_cache/conv__2232__06_1537__v39__timestretching/logs/