Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2224
Description:  augmented_jobs
2021-06-16 02:07:45.473973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-16 02:07:48.456068: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 02:07:48.457248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-16 02:07:48.471055: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:48.471849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 02:07:48.471885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 02:07:48.475982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 02:07:48.476086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 02:07:48.477348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 02:07:48.477661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 02:07:48.478841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 02:07:48.479836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 02:07:48.480004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 02:07:48.480147: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:48.480983: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:48.481704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2224.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2224__06_0206__v39__augmented_jobs
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 148, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 200, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-16 02:07:53.751676: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 02:07:53.752008: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:53.752805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 02:07:53.752859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 02:07:53.752922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 02:07:53.752944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 02:07:53.752966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 02:07:53.752987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 02:07:53.753009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 02:07:53.753030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 02:07:53.753050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 02:07:53.753148: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:53.753932: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:53.754653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-16 02:07:53.754706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 02:07:54.610022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-16 02:07:54.610087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-16 02:07:54.610105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-16 02:07:54.610504: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:54.611756: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:54.612909: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:07:54.613934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
-----------------------
Number of train recordings: 2648 with pneumonia: 348 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2748
-----------------------
Number of train recordings: 2748 with pneumonia: 348 and non-pneumonia: 2400
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-16 02:07:56.204933: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-16 02:07:56.206911: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-16 02:07:56.600609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 02:07:58.838633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 02:07:59.379474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
172/172 - 248s - loss: 1.1409 - accuracy: 0.5364 - val_loss: 1.2405 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.04493413475561521
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
172/172 - 248s - loss: 0.5688 - accuracy: 0.6507 - val_loss: 0.9451 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.2036537899427412
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
172/172 - 248s - loss: 0.5310 - accuracy: 0.7231 - val_loss: 0.4251 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.219625818497528
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/65
172/172 - 248s - loss: 0.3801 - accuracy: 0.7922 - val_loss: 0.7791 - val_accuracy: 0.6628
Confusion matrix: 
 [[373 200]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.651 0.349]
 [0.125 0.875]]
Validation f1: 21.54
Validation accuracy: 66.28
Validation recall: 87.50
Validation precision: 12.28
Validation AUC: 0.3531851886471469
Validation class accuracies: [0.6509598603839442, 0.875]
Saving model...
Epoch 5/65
172/172 - 248s - loss: 0.3483 - accuracy: 0.8355 - val_loss: 1.5240 - val_accuracy: 0.5752
Confusion matrix: 
 [[324 249]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.565 0.435]
 [0.25  0.75 ]]
Validation f1: 15.74
Validation accuracy: 57.52
Validation recall: 75.00
Validation precision: 8.79
Validation AUC: 0.30384986649085605
Validation class accuracies: [0.5654450261780105, 0.75]
The validation tracker metric at 0.2153846153846154 hasn't increased by 0 in 1 epochs
Epoch 6/65
172/172 - 248s - loss: 0.3184 - accuracy: 0.8461 - val_loss: 0.3655 - val_accuracy: 0.8727
Confusion matrix: 
 [[511  62]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.469 0.531]]
Validation f1: 30.63
Validation accuracy: 87.27
Validation recall: 53.12
Validation precision: 21.52
Validation AUC: 0.412543716644699
Validation class accuracies: [0.8917975567190227, 0.53125]
Saving model...
Epoch 7/65
172/172 - 248s - loss: 0.2477 - accuracy: 0.8777 - val_loss: 1.4297 - val_accuracy: 0.5702
Confusion matrix: 
 [[326 247]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.569 0.431]
 [0.406 0.594]]
Validation f1: 12.75
Validation accuracy: 57.02
Validation recall: 59.38
Validation precision: 7.14
Validation AUC: 0.22361892043393417
Validation class accuracies: [0.568935427574171, 0.59375]
The validation tracker metric at 0.3063063063063063 hasn't increased by 0 in 1 epochs
Epoch 8/65
172/172 - 248s - loss: 0.3091 - accuracy: 0.8563 - val_loss: 1.8154 - val_accuracy: 0.5372
Confusion matrix: 
 [[297 276]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.518 0.482]
 [0.125 0.875]]
Validation f1: 16.67
Validation accuracy: 53.72
Validation recall: 87.50
Validation precision: 9.21
Validation AUC: 0.41103689874164484
Validation class accuracies: [0.518324607329843, 0.875]
The validation tracker metric at 0.3063063063063063 hasn't increased by 0 in 2 epochs
Epoch 9/65
172/172 - 248s - loss: 0.2038 - accuracy: 0.9050 - val_loss: 0.2618 - val_accuracy: 0.8992
Confusion matrix: 
 [[528  45]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.5   0.5  ]]
Validation f1: 34.41
Validation accuracy: 89.92
Validation recall: 50.00
Validation precision: 26.23
Validation AUC: 0.5096943279349441
Validation class accuracies: [0.9214659685863874, 0.5]
Saving model...
Epoch 10/65
172/172 - 248s - loss: 0.1616 - accuracy: 0.9229 - val_loss: 2.1168 - val_accuracy: 0.4678
Confusion matrix: 
 [[255 318]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.445 0.555]
 [0.125 0.875]]
Validation f1: 14.81
Validation accuracy: 46.78
Validation recall: 87.50
Validation precision: 8.09
Validation AUC: 0.39744595380315967
Validation class accuracies: [0.44502617801047123, 0.875]
The validation tracker metric at 0.3440860215053763 hasn't increased by 0 in 1 epochs
Epoch 11/65
172/172 - 248s - loss: 0.1688 - accuracy: 0.9356 - val_loss: 0.7308 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.16104283593092839
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.3440860215053763 hasn't increased by 0 in 2 epochs
Epoch 12/65
172/172 - 248s - loss: 0.3854 - accuracy: 0.8275 - val_loss: 1.7241 - val_accuracy: 0.6215
Confusion matrix: 
 [[351 222]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.613 0.387]
 [0.219 0.781]]
Validation f1: 17.92
Validation accuracy: 62.15
Validation recall: 78.12
Validation precision: 10.12
Validation AUC: 0.25298653529360826
Validation class accuracies: [0.612565445026178, 0.78125]
The validation tracker metric at 0.3440860215053763 hasn't increased by 0 in 3 epochs
Epoch 13/65
172/172 - 248s - loss: 0.2141 - accuracy: 0.8985 - val_loss: 0.3352 - val_accuracy: 0.9537
Confusion matrix: 
 [[573   0]
 [ 28   4]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.875 0.125]]
Validation f1: 22.22
Validation accuracy: 95.37
Validation recall: 12.50
Validation precision: 100.00
Validation AUC: 0.380149409521094
Validation class accuracies: [1.0, 0.125]
The validation tracker metric at 0.3440860215053763 hasn't increased by 0 in 4 epochs
Epoch 14/65
172/172 - 249s - loss: 0.2036 - accuracy: 0.9127 - val_loss: 1.0929 - val_accuracy: 0.6479
Confusion matrix: 
 [[366 207]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.639 0.361]
 [0.188 0.812]]
Validation f1: 19.62
Validation accuracy: 64.79
Validation recall: 81.25
Validation precision: 11.16
Validation AUC: 0.47438695194219194
Validation class accuracies: [0.6387434554973822, 0.8125]
The validation tracker metric at 0.3440860215053763 hasn't increased by 0 in 5 epochs
Epoch 15/65
172/172 - 249s - loss: 0.1152 - accuracy: 0.9392 - val_loss: 0.3860 - val_accuracy: 0.8529
Confusion matrix: 
 [[493  80]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86  0.14 ]
 [0.281 0.719]]
Validation f1: 34.07
Validation accuracy: 85.29
Validation recall: 71.88
Validation precision: 22.33
Validation AUC: 0.5708843767536386
Validation class accuracies: [0.8603839441535777, 0.71875]
The validation tracker metric at 0.3440860215053763 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
172/172 - 248s - loss: 0.0700 - accuracy: 0.9640 - val_loss: 0.2029 - val_accuracy: 0.9174
Confusion matrix: 
 [[535  38]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.375 0.625]]
Validation f1: 44.44
Validation accuracy: 91.74
Validation recall: 62.50
Validation precision: 34.48
Validation AUC: 0.6438913460173228
Validation class accuracies: [0.9336823734729494, 0.625]
Saving model...
Epoch 17/65
172/172 - 248s - loss: 0.0735 - accuracy: 0.9643 - val_loss: 0.1645 - val_accuracy: 0.9339
Confusion matrix: 
 [[547  26]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.37
Validation accuracy: 93.39
Validation recall: 56.25
Validation precision: 40.91
Validation AUC: 0.6128049011147674
Validation class accuracies: [0.9546247818499127, 0.5625]
Saving model...
Epoch 18/65
172/172 - 248s - loss: 0.0685 - accuracy: 0.9694 - val_loss: 1.7011 - val_accuracy: 0.5554
Confusion matrix: 
 [[308 265]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.538 0.462]
 [0.125 0.875]]
Validation f1: 17.23
Validation accuracy: 55.54
Validation recall: 87.50
Validation precision: 9.56
Validation AUC: 0.27845390540406395
Validation class accuracies: [0.537521815008726, 0.875]
The validation tracker metric at 0.47368421052631576 hasn't increased by 0 in 1 epochs
Epoch 19/65
172/172 - 248s - loss: 0.0635 - accuracy: 0.9643 - val_loss: 0.3587 - val_accuracy: 0.8711
Confusion matrix: 
 [[505  68]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.312 0.688]]
Validation f1: 36.07
Validation accuracy: 87.11
Validation recall: 68.75
Validation precision: 24.44
Validation AUC: 0.6033881665653013
Validation class accuracies: [0.881326352530541, 0.6875]
The validation tracker metric at 0.47368421052631576 hasn't increased by 0 in 2 epochs
Epoch 20/65
172/172 - 248s - loss: 0.0368 - accuracy: 0.9840 - val_loss: 0.2022 - val_accuracy: 0.9421
Confusion matrix: 
 [[550  23]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.375 0.625]]
Validation f1: 53.33
Validation accuracy: 94.21
Validation recall: 62.50
Validation precision: 46.51
Validation AUC: 0.5731466633478193
Validation class accuracies: [0.9598603839441536, 0.625]
Saving model...
Epoch 21/65
172/172 - 248s - loss: 0.0465 - accuracy: 0.9774 - val_loss: 0.1893 - val_accuracy: 0.9603
Confusion matrix: 
 [[567   6]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.562 0.438]]
Validation f1: 53.85
Validation accuracy: 96.03
Validation recall: 43.75
Validation precision: 70.00
Validation AUC: 0.5312435502504631
Validation class accuracies: [0.9895287958115183, 0.4375]
Saving model...
Epoch 22/65
172/172 - 248s - loss: 0.0979 - accuracy: 0.9647 - val_loss: 0.2809 - val_accuracy: 0.9124
Confusion matrix: 
 [[533  40]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.406 0.594]]
Validation f1: 41.76
Validation accuracy: 91.24
Validation recall: 59.38
Validation precision: 32.20
Validation AUC: 0.605480891778096
Validation class accuracies: [0.9301919720767888, 0.59375]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 1 epochs
Epoch 23/65
172/172 - 247s - loss: 0.0367 - accuracy: 0.9811 - val_loss: 0.1796 - val_accuracy: 0.9405
Confusion matrix: 
 [[548  25]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.344 0.656]]
Validation f1: 53.85
Validation accuracy: 94.05
Validation recall: 65.62
Validation precision: 45.65
Validation AUC: 0.6653511593788162
Validation class accuracies: [0.956369982547993, 0.65625]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 2 epochs
Epoch 24/65
172/172 - 248s - loss: 0.0209 - accuracy: 0.9887 - val_loss: 0.2313 - val_accuracy: 0.9256
Confusion matrix: 
 [[539  34]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.344 0.656]]
Validation f1: 48.28
Validation accuracy: 92.56
Validation recall: 65.62
Validation precision: 38.18
Validation AUC: 0.6591077311874494
Validation class accuracies: [0.9406631762652705, 0.65625]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 3 epochs
Epoch 25/65
172/172 - 248s - loss: 0.0184 - accuracy: 0.9942 - val_loss: 0.5602 - val_accuracy: 0.8364
Confusion matrix: 
 [[484  89]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.845 0.155]
 [0.312 0.688]]
Validation f1: 30.77
Validation accuracy: 83.64
Validation recall: 68.75
Validation precision: 19.82
Validation AUC: 0.6188101358282592
Validation class accuracies: [0.8446771378708552, 0.6875]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 4 epochs
Epoch 26/65
172/172 - 248s - loss: 0.0294 - accuracy: 0.9865 - val_loss: 0.2354 - val_accuracy: 0.9405
Confusion matrix: 
 [[550  23]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.406 0.594]]
Validation f1: 51.35
Validation accuracy: 94.05
Validation recall: 59.38
Validation precision: 45.24
Validation AUC: 0.6203041002303937
Validation class accuracies: [0.9598603839441536, 0.59375]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 5 epochs
Epoch 27/65
172/172 - 248s - loss: 0.0474 - accuracy: 0.9814 - val_loss: 0.2002 - val_accuracy: 0.9537
Confusion matrix: 
 [[565   8]
 [ 20  12]]
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.625 0.375]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 46.15
Validation accuracy: 95.37
Validation recall: 37.50
Validation precision: 60.00
Validation AUC: 0.5299229245123176
Validation class accuracies: [0.9860383944153578, 0.375]
The validation tracker metric at 0.5384615384615384 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 28/65
172/172 - 248s - loss: 0.0360 - accuracy: 0.9803 - val_loss: 0.1525 - val_accuracy: 0.9686
Confusion matrix: 
 [[572   1]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.562 0.438]]
Validation f1: 59.57
Validation accuracy: 96.86
Validation recall: 43.75
Validation precision: 93.33
Validation AUC: 0.6486098524346964
Validation class accuracies: [0.9982547993019197, 0.4375]
Saving model...
Epoch 29/65
172/172 - 248s - loss: 0.0182 - accuracy: 0.9931 - val_loss: 0.1693 - val_accuracy: 0.9488
Confusion matrix: 
 [[554  19]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.375 0.625]]
Validation f1: 56.34
Validation accuracy: 94.88
Validation recall: 62.50
Validation precision: 51.28
Validation AUC: 0.6527503363607802
Validation class accuracies: [0.9668411867364747, 0.625]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 1 epochs
Epoch 30/65
172/172 - 248s - loss: 0.0186 - accuracy: 0.9916 - val_loss: 0.1842 - val_accuracy: 0.9455
Confusion matrix: 
 [[551  22]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.344 0.656]]
Validation f1: 56.00
Validation accuracy: 94.55
Validation recall: 65.62
Validation precision: 48.84
Validation AUC: 0.6445376962199162
Validation class accuracies: [0.9616055846422339, 0.65625]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 2 epochs
Epoch 31/65
172/172 - 248s - loss: 0.0143 - accuracy: 0.9938 - val_loss: 0.1775 - val_accuracy: 0.9405
Confusion matrix: 
 [[549  24]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.63
Validation accuracy: 94.05
Validation recall: 62.50
Validation precision: 45.45
Validation AUC: 0.6403767241952341
Validation class accuracies: [0.9581151832460733, 0.625]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 3 epochs
Epoch 32/65
172/172 - 248s - loss: 0.0176 - accuracy: 0.9938 - val_loss: 1.0132 - val_accuracy: 0.7471
Confusion matrix: 
 [[427 146]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.745 0.255]
 [0.219 0.781]]
Validation f1: 24.63
Validation accuracy: 74.71
Validation recall: 78.12
Validation precision: 14.62
Validation AUC: 0.6478207455863777
Validation class accuracies: [0.7452006980802792, 0.78125]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 4 epochs
Epoch 33/65
172/172 - 248s - loss: 0.0245 - accuracy: 0.9898 - val_loss: 0.3074 - val_accuracy: 0.9174
Confusion matrix: 
 [[534  39]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.344 0.656]]
Validation f1: 45.65
Validation accuracy: 91.74
Validation recall: 65.62
Validation precision: 35.00
Validation AUC: 0.6131300099088286
Validation class accuracies: [0.9319371727748691, 0.65625]
The validation tracker metric at 0.5957446808510638 hasn't increased by 0 in 5 epochs
Epoch 34/65
172/172 - 248s - loss: 0.0119 - accuracy: 0.9942 - val_loss: 0.1595 - val_accuracy: 0.9620
Confusion matrix: 
 [[565   8]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.469 0.531]]
Validation f1: 59.65
Validation accuracy: 96.20
Validation recall: 53.12
Validation precision: 68.00
Validation AUC: 0.6171684708483269
Validation class accuracies: [0.9860383944153578, 0.53125]
Saving model...
Epoch 35/65
172/172 - 248s - loss: 0.0105 - accuracy: 0.9956 - val_loss: 0.1864 - val_accuracy: 0.9488
Confusion matrix: 
 [[556  17]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.438 0.562]]
Validation f1: 53.73
Validation accuracy: 94.88
Validation recall: 56.25
Validation precision: 51.43
Validation AUC: 0.6092620932609443
Validation class accuracies: [0.9703315881326352, 0.5625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 1 epochs
Epoch 36/65
172/172 - 248s - loss: 0.0112 - accuracy: 0.9964 - val_loss: 0.1928 - val_accuracy: 0.9421
Confusion matrix: 
 [[551  22]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.406 0.594]]
Validation f1: 52.05
Validation accuracy: 94.21
Validation recall: 59.38
Validation precision: 46.34
Validation AUC: 0.6041017969966304
Validation class accuracies: [0.9616055846422339, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 2 epochs
Epoch 37/65
172/172 - 248s - loss: 0.0094 - accuracy: 0.9964 - val_loss: 0.2019 - val_accuracy: 0.9339
Confusion matrix: 
 [[545  28]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.375 0.625]]
Validation f1: 50.00
Validation accuracy: 93.39
Validation recall: 62.50
Validation precision: 41.67
Validation AUC: 0.6251784749711423
Validation class accuracies: [0.9511343804537522, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 3 epochs
Epoch 38/65
172/172 - 248s - loss: 0.0202 - accuracy: 0.9931 - val_loss: 0.2362 - val_accuracy: 0.9289
Confusion matrix: 
 [[543  30]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.406 0.594]]
Validation f1: 46.91
Validation accuracy: 92.89
Validation recall: 59.38
Validation precision: 38.78
Validation AUC: 0.5988015721778543
Validation class accuracies: [0.9476439790575916, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 4 epochs
Epoch 39/65
172/172 - 248s - loss: 0.0100 - accuracy: 0.9956 - val_loss: 0.1632 - val_accuracy: 0.9603
Confusion matrix: 
 [[564   9]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.469 0.531]]
Validation f1: 58.62
Validation accuracy: 96.03
Validation recall: 53.12
Validation precision: 65.38
Validation AUC: 0.6113941783585172
Validation class accuracies: [0.9842931937172775, 0.53125]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 5 epochs
Epoch 40/65
172/172 - 249s - loss: 0.0087 - accuracy: 0.9982 - val_loss: 0.2450 - val_accuracy: 0.9289
Confusion matrix: 
 [[542  31]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.375 0.625]]
Validation f1: 48.19
Validation accuracy: 92.89
Validation recall: 62.50
Validation precision: 39.22
Validation AUC: 0.6042435342192334
Validation class accuracies: [0.9458987783595113, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 41/65
172/172 - 249s - loss: 0.0078 - accuracy: 0.9960 - val_loss: 0.1728 - val_accuracy: 0.9521
Confusion matrix: 
 [[558  15]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.438 0.562]]
Validation f1: 55.38
Validation accuracy: 95.21
Validation recall: 56.25
Validation precision: 54.55
Validation AUC: 0.6098512987310125
Validation class accuracies: [0.9738219895287958, 0.5625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 7 epochs
Epoch 42/65
172/172 - 250s - loss: 0.0090 - accuracy: 0.9978 - val_loss: 0.2292 - val_accuracy: 0.9355
Confusion matrix: 
 [[547  26]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.406 0.594]]
Validation f1: 49.35
Validation accuracy: 93.55
Validation recall: 59.38
Validation precision: 42.22
Validation AUC: 0.5798234148763796
Validation class accuracies: [0.9546247818499127, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 8 epochs
Epoch 43/65
172/172 - 250s - loss: 0.0082 - accuracy: 0.9989 - val_loss: 0.2411 - val_accuracy: 0.9207
Confusion matrix: 
 [[538  35]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.406 0.594]]
Validation f1: 44.19
Validation accuracy: 92.07
Validation recall: 59.38
Validation precision: 35.19
Validation AUC: 0.6075490935639177
Validation class accuracies: [0.9389179755671903, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 9 epochs
Epoch 44/65
172/172 - 251s - loss: 0.0042 - accuracy: 0.9985 - val_loss: 0.1885 - val_accuracy: 0.9488
Confusion matrix: 
 [[557  16]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.469 0.531]]
Validation f1: 52.31
Validation accuracy: 94.88
Validation recall: 53.12
Validation precision: 51.52
Validation AUC: 0.5944389501169732
Validation class accuracies: [0.9720767888307156, 0.53125]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 10 epochs
Epoch 45/65
172/172 - 251s - loss: 0.0096 - accuracy: 0.9978 - val_loss: 0.2576 - val_accuracy: 0.9240
Confusion matrix: 
 [[539  34]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.375 0.625]]
Validation f1: 46.51
Validation accuracy: 92.40
Validation recall: 62.50
Validation precision: 37.04
Validation AUC: 0.633200008216857
Validation class accuracies: [0.9406631762652705, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 11 epochs
Epoch 46/65
172/172 - 250s - loss: 0.0051 - accuracy: 0.9975 - val_loss: 0.1902 - val_accuracy: 0.9438
Confusion matrix: 
 [[552  21]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.406 0.594]]
Validation f1: 52.78
Validation accuracy: 94.38
Validation recall: 59.38
Validation precision: 47.50
Validation AUC: 0.6311869529582791
Validation class accuracies: [0.9633507853403142, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 47/65
172/172 - 250s - loss: 0.0054 - accuracy: 0.9989 - val_loss: 0.1904 - val_accuracy: 0.9405
Confusion matrix: 
 [[550  23]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.35
Validation accuracy: 94.05
Validation recall: 59.38
Validation precision: 45.24
Validation AUC: 0.6248642439763696
Validation class accuracies: [0.9598603839441536, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 13 epochs
Epoch 48/65
172/172 - 250s - loss: 0.0061 - accuracy: 0.9996 - val_loss: 0.2127 - val_accuracy: 0.9339
Confusion matrix: 
 [[545  28]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 93.39
Validation recall: 62.50
Validation precision: 41.67
Validation AUC: 0.6242697440662773
Validation class accuracies: [0.9511343804537522, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 14 epochs
Epoch 49/65
172/172 - 250s - loss: 0.0053 - accuracy: 0.9971 - val_loss: 0.2031 - val_accuracy: 0.9355
Confusion matrix: 
 [[547  26]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.35
Validation accuracy: 93.55
Validation recall: 59.38
Validation precision: 42.22
Validation AUC: 0.6250168882212893
Validation class accuracies: [0.9546247818499127, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 15 epochs
Epoch 50/65
172/172 - 249s - loss: 0.0060 - accuracy: 0.9996 - val_loss: 0.2294 - val_accuracy: 0.9339
Confusion matrix: 
 [[545  28]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 93.39
Validation recall: 62.50
Validation precision: 41.67
Validation AUC: 0.6212203065901843
Validation class accuracies: [0.9511343804537522, 0.625]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 16 epochs
Epoch 51/65
172/172 - 251s - loss: 0.0040 - accuracy: 0.9989 - val_loss: 0.1918 - val_accuracy: 0.9471
Confusion matrix: 
 [[554  19]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.406 0.594]]
Validation f1: 54.29
Validation accuracy: 94.71
Validation recall: 59.38
Validation precision: 50.00
Validation AUC: 0.6197078694747267
Validation class accuracies: [0.9668411867364747, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 17 epochs
Epoch 52/65
172/172 - 250s - loss: 0.0051 - accuracy: 0.9989 - val_loss: 0.2002 - val_accuracy: 0.9488
Confusion matrix: 
 [[555  18]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.406 0.594]]
Validation f1: 55.07
Validation accuracy: 94.88
Validation recall: 59.38
Validation precision: 51.35
Validation AUC: 0.6046235275176104
Validation class accuracies: [0.9685863874345549, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 53/65
172/172 - 251s - loss: 0.0040 - accuracy: 0.9993 - val_loss: 0.2027 - val_accuracy: 0.9405
Confusion matrix: 
 [[550  23]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.35
Validation accuracy: 94.05
Validation recall: 59.38
Validation precision: 45.24
Validation AUC: 0.6116887321870004
Validation class accuracies: [0.9598603839441536, 0.59375]
The validation tracker metric at 0.5964912280701754 hasn't increased by 0 in 19 epochs
Epoch 54/65
172/172 - 251s - loss: 0.0060 - accuracy: 1.0000 - val_loss: 0.2190 - val_accuracy: 0.9405
Confusion matrix: 
 [[550  23]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.35
Validation accuracy: 94.05
Validation recall: 59.38
Validation precision: 45.24
Validation AUC: 0.6106116674248984
Validation class accuracies: [0.9598603839441536, 0.59375]

The metrics for job 0 with the best target metric are: 
Best cm: [[565   8]
 [ 15  17]]
Best normalized cm: [[0.986 0.014]
 [0.469 0.531]]
Best f1: 0.60
Best accuracy: 0.96
Best recall: 0.53
Best precision: 0.68
Best AUC: 0.62
Best class accuracies: [0.9860383944153578, 0.53125]
Best epoch: 34
The number of epochs since last 1% equals the patience
-----------------------
Mixednet
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
-----------------------
Number of train recordings: 2648 with pneumonia: 348 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2748
-----------------------
Number of train recordings: 2748 with pneumonia: 348 and non-pneumonia: 2400
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
172/172 - 79s - loss: 0.6233 - accuracy: 0.6157 - val_loss: 0.7502 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.25801283239314443
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
172/172 - 75s - loss: 0.3518 - accuracy: 0.7787 - val_loss: 0.6187 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07882549783409713
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
172/172 - 76s - loss: 0.2271 - accuracy: 0.8734 - val_loss: 0.4697 - val_accuracy: 0.9537
Confusion matrix: 
 [[572   1]
 [ 27   5]]
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.844 0.156]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 26.32
Validation accuracy: 95.37
Validation recall: 15.62
Validation precision: 83.33
Validation AUC: 0.29182772119716316
Validation class accuracies: [0.9982547993019197, 0.15625]
Saving model...
Epoch 4/65
172/172 - 75s - loss: 0.1038 - accuracy: 0.9509 - val_loss: 1.0862 - val_accuracy: 0.4512
Confusion matrix: 
 [[245 328]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.428 0.572]
 [0.125 0.875]]
Validation f1: 14.43
Validation accuracy: 45.12
Validation recall: 87.50
Validation precision: 7.87
Validation AUC: 0.5136851272222006
Validation class accuracies: [0.42757417102966844, 0.875]
The validation tracker metric at 0.2631578947368421 hasn't increased by 0 in 1 epochs
Epoch 5/65
172/172 - 76s - loss: 0.0996 - accuracy: 0.9596 - val_loss: 0.2686 - val_accuracy: 0.9207
Confusion matrix: 
 [[540  33]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.46
Validation accuracy: 92.07
Validation recall: 53.12
Validation precision: 34.00
Validation AUC: 0.5029722032436106
Validation class accuracies: [0.9424083769633508, 0.53125]
Saving model...
Epoch 6/65
172/172 - 76s - loss: 0.0444 - accuracy: 0.9865 - val_loss: 0.2098 - val_accuracy: 0.9488
Confusion matrix: 
 [[559  14]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.531 0.469]]
Validation f1: 49.18
Validation accuracy: 94.88
Validation recall: 46.88
Validation precision: 51.72
Validation AUC: 0.48707748731489436
Validation class accuracies: [0.9755671902268761, 0.46875]
Saving model...
Epoch 7/65
172/172 - 76s - loss: 0.0255 - accuracy: 0.9938 - val_loss: 0.2044 - val_accuracy: 0.9570
Confusion matrix: 
 [[562  11]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.67
Validation accuracy: 95.70
Validation recall: 53.12
Validation precision: 60.71
Validation AUC: 0.5518604958489999
Validation class accuracies: [0.9808027923211169, 0.53125]
Saving model...
Epoch 8/65
172/172 - 76s - loss: 0.0212 - accuracy: 0.9953 - val_loss: 0.3826 - val_accuracy: 0.9008
Confusion matrix: 
 [[527  46]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.438 0.562]]
Validation f1: 37.50
Validation accuracy: 90.08
Validation recall: 56.25
Validation precision: 28.12
Validation AUC: 0.5227882246924914
Validation class accuracies: [0.9197207678883071, 0.5625]
The validation tracker metric at 0.5666666666666667 hasn't increased by 0 in 1 epochs
Epoch 9/65
172/172 - 76s - loss: 0.0143 - accuracy: 0.9971 - val_loss: 0.2021 - val_accuracy: 0.9587
Confusion matrix: 
 [[562  11]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.438 0.562]]
Validation f1: 59.02
Validation accuracy: 95.87
Validation recall: 56.25
Validation precision: 62.07
Validation AUC: 0.5858443621692359
Validation class accuracies: [0.9808027923211169, 0.5625]
Saving model...
Epoch 10/65
172/172 - 75s - loss: 0.0100 - accuracy: 0.9996 - val_loss: 0.3658 - val_accuracy: 0.9190
Confusion matrix: 
 [[538  35]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.438 0.562]]
Validation f1: 42.35
Validation accuracy: 91.90
Validation recall: 56.25
Validation precision: 33.96
Validation AUC: 0.5508094718417564
Validation class accuracies: [0.9389179755671903, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 1 epochs
Epoch 11/65
172/172 - 76s - loss: 0.0054 - accuracy: 0.9993 - val_loss: 0.2155 - val_accuracy: 0.9570
Confusion matrix: 
 [[562  11]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.67
Validation accuracy: 95.70
Validation recall: 53.12
Validation precision: 60.71
Validation AUC: 0.5838896690033424
Validation class accuracies: [0.9808027923211169, 0.53125]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 2 epochs
Epoch 12/65
172/172 - 76s - loss: 0.0185 - accuracy: 0.9913 - val_loss: 0.3585 - val_accuracy: 0.9603
Confusion matrix: 
 [[570   3]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.656 0.344]]
Validation f1: 47.83
Validation accuracy: 96.03
Validation recall: 34.38
Validation precision: 78.57
Validation AUC: 0.5215036695756696
Validation class accuracies: [0.9947643979057592, 0.34375]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 3 epochs
Epoch 13/65
172/172 - 76s - loss: 0.0174 - accuracy: 0.9942 - val_loss: 0.2813 - val_accuracy: 0.9240
Confusion matrix: 
 [[541  32]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.438 0.562]]
Validation f1: 43.90
Validation accuracy: 92.40
Validation recall: 56.25
Validation precision: 36.00
Validation AUC: 0.5747749208284093
Validation class accuracies: [0.944153577661431, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 4 epochs
Epoch 14/65
172/172 - 76s - loss: 0.0244 - accuracy: 0.9931 - val_loss: 2.0074 - val_accuracy: 0.5372
Confusion matrix: 
 [[296 277]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.517 0.483]
 [0.094 0.906]]
Validation f1: 17.16
Validation accuracy: 53.72
Validation recall: 90.62
Validation precision: 9.48
Validation AUC: 0.5265638786046515
Validation class accuracies: [0.5165794066317626, 0.90625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 5 epochs
Epoch 15/65
172/172 - 76s - loss: 0.0323 - accuracy: 0.9865 - val_loss: 0.4933 - val_accuracy: 0.8793
Confusion matrix: 
 [[511  62]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.344 0.656]]
Validation f1: 36.52
Validation accuracy: 87.93
Validation recall: 65.62
Validation precision: 25.30
Validation AUC: 0.5702798291181704
Validation class accuracies: [0.8917975567190227, 0.65625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
172/172 - 69s - loss: 0.0111 - accuracy: 0.9985 - val_loss: 0.2871 - val_accuracy: 0.9405
Confusion matrix: 
 [[550  23]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.35
Validation accuracy: 94.05
Validation recall: 59.38
Validation precision: 45.24
Validation AUC: 0.5441737045577197
Validation class accuracies: [0.9598603839441536, 0.59375]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 7 epochs
Epoch 17/65
172/172 - 70s - loss: 0.0113 - accuracy: 0.9978 - val_loss: 0.5808 - val_accuracy: 0.8562
Confusion matrix: 
 [[497  76]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.867 0.133]
 [0.344 0.656]]
Validation f1: 32.56
Validation accuracy: 85.62
Validation recall: 65.62
Validation precision: 21.65
Validation AUC: 0.5289901109328831
Validation class accuracies: [0.8673647469458988, 0.65625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 8 epochs
Epoch 18/65
172/172 - 71s - loss: 0.0111 - accuracy: 0.9971 - val_loss: 0.2559 - val_accuracy: 0.9504
Confusion matrix: 
 [[558  15]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.469 0.531]]
Validation f1: 53.12
Validation accuracy: 95.04
Validation recall: 53.12
Validation precision: 53.12
Validation AUC: 0.5315097259748465
Validation class accuracies: [0.9738219895287958, 0.53125]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 9 epochs
Epoch 19/65
172/172 - 70s - loss: 0.0050 - accuracy: 0.9989 - val_loss: 0.2670 - val_accuracy: 0.9488
Confusion matrix: 
 [[556  17]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.73
Validation accuracy: 94.88
Validation recall: 56.25
Validation precision: 51.43
Validation AUC: 0.5572631084193418
Validation class accuracies: [0.9703315881326352, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 10 epochs
Epoch 20/65
172/172 - 72s - loss: 0.0035 - accuracy: 1.0000 - val_loss: 0.2842 - val_accuracy: 0.9455
Confusion matrix: 
 [[553  20]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.406 0.594]]
Validation f1: 53.52
Validation accuracy: 94.55
Validation recall: 59.38
Validation precision: 48.72
Validation AUC: 0.5518848372495802
Validation class accuracies: [0.9650959860383944, 0.59375]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 11 epochs
Epoch 21/65
172/172 - 71s - loss: 0.0038 - accuracy: 1.0000 - val_loss: 0.3159 - val_accuracy: 0.9306
Confusion matrix: 
 [[543  30]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.78
Validation accuracy: 93.06
Validation recall: 62.50
Validation precision: 40.00
Validation AUC: 0.5543114822543271
Validation class accuracies: [0.9476439790575916, 0.625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
172/172 - 70s - loss: 0.0038 - accuracy: 1.0000 - val_loss: 0.2771 - val_accuracy: 0.9471
Confusion matrix: 
 [[555  18]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.438 0.562]]
Validation f1: 52.94
Validation accuracy: 94.71
Validation recall: 56.25
Validation precision: 50.00
Validation AUC: 0.5568425107065123
Validation class accuracies: [0.9685863874345549, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 13 epochs
Epoch 23/65
172/172 - 72s - loss: 0.0035 - accuracy: 1.0000 - val_loss: 0.2774 - val_accuracy: 0.9471
Confusion matrix: 
 [[555  18]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.94
Validation accuracy: 94.71
Validation recall: 56.25
Validation precision: 50.00
Validation AUC: 0.5584785083153503
Validation class accuracies: [0.9685863874345549, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 14 epochs
Epoch 24/65
172/172 - 70s - loss: 0.0059 - accuracy: 0.9993 - val_loss: 0.2935 - val_accuracy: 0.9421
Confusion matrix: 
 [[551  22]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.05
Validation accuracy: 94.21
Validation recall: 59.38
Validation precision: 46.34
Validation AUC: 0.5803069038230109
Validation class accuracies: [0.9616055846422339, 0.59375]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 15 epochs
Epoch 25/65
172/172 - 69s - loss: 0.0031 - accuracy: 1.0000 - val_loss: 0.2794 - val_accuracy: 0.9455
Confusion matrix: 
 [[554  19]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.438 0.562]]
Validation f1: 52.17
Validation accuracy: 94.55
Validation recall: 56.25
Validation precision: 48.65
Validation AUC: 0.556879261020848
Validation class accuracies: [0.9668411867364747, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 16 epochs
Epoch 26/65
172/172 - 70s - loss: 0.0029 - accuracy: 1.0000 - val_loss: 0.2805 - val_accuracy: 0.9471
Confusion matrix: 
 [[555  18]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.94
Validation accuracy: 94.71
Validation recall: 56.25
Validation precision: 50.00
Validation AUC: 0.5595337291495465
Validation class accuracies: [0.9685863874345549, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 17 epochs
Epoch 27/65
172/172 - 71s - loss: 0.0022 - accuracy: 1.0000 - val_loss: 0.2850 - val_accuracy: 0.9488
Confusion matrix: 
 [[556  17]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.73
Validation accuracy: 94.88
Validation recall: 56.25
Validation precision: 51.43
Validation AUC: 0.5482256676211285
Validation class accuracies: [0.9703315881326352, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
172/172 - 71s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2961 - val_accuracy: 0.9438
Confusion matrix: 
 [[553  20]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.438 0.562]]
Validation f1: 51.43
Validation accuracy: 94.38
Validation recall: 56.25
Validation precision: 47.37
Validation AUC: 0.5495061580117467
Validation class accuracies: [0.9650959860383944, 0.5625]
The validation tracker metric at 0.5901639344262296 hasn't increased by 0 in 19 epochs
Epoch 29/65
172/172 - 70s - loss: 0.0022 - accuracy: 1.0000 - val_loss: 0.2885 - val_accuracy: 0.9471
Confusion matrix: 
 [[555  18]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.94
Validation accuracy: 94.71
Validation recall: 56.25
Validation precision: 50.00
Validation AUC: 0.5471478927184786
Validation class accuracies: [0.9685863874345549, 0.5625]

The metrics for job 0 with the best target metric are: 
Best cm: [[562  11]
 [ 14  18]]
Best normalized cm: [[0.981 0.019]
 [0.438 0.562]]
Best f1: 0.59
Best accuracy: 0.96
Best recall: 0.56
Best precision: 0.62
Best AUC: 0.59
Best class accuracies: [0.9808027923211169, 0.5625]
Best epoch: 9
The number of epochs since last 1% equals the patience
-----------------------
Model 10
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
-----------------------
Number of train recordings: 2648 with pneumonia: 348 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2748
-----------------------
Number of train recordings: 2748 with pneumonia: 348 and non-pneumonia: 2400
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 128, 1250, 1)    4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 128, 1250, 8)    16           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 128, 1250, 8)    16           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 128, 1250, 8)    584          conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 128, 1250, 8)    1608         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 128, 1250, 8)    16           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_35961 (Concatenate)     (None, 128, 1250, 24)   0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 64, 625, 24)     0            concatenate_35961[0][0]              
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 64, 625, 24)     96           average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 64, 625, 16)     400          batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 64, 625, 16)     400          batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 64, 625, 24)     0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 64, 625, 16)     2320         conv2d_15[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 64, 625, 16)     6416         conv2d_17[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 64, 625, 16)     400          max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_35962 (Concatenate)     (None, 64, 625, 48)     0            conv2d_16[0][0]                      
                                                                         conv2d_18[0][0]                      
                                                                         conv2d_19[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 32, 313, 48)     0            concatenate_35962[0][0]              
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 32, 313, 48)     192          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                  (None, 32, 313, 32)     1568         batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                  (None, 32, 313, 32)     1568         batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)      (None, 32, 313, 48)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                  (None, 32, 313, 32)     9248         conv2d_20[0][0]                      
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                  (None, 32, 313, 32)     25632        conv2d_22[0][0]                      
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                  (None, 32, 313, 32)     1568         max_pooling2d_3[0][0]                
______________________________________________________________________________________________________________
concatenate_35963 (Concatenate)     (None, 32, 313, 96)     0            conv2d_21[0][0]                      
                                                                         conv2d_23[0][0]                      
                                                                         conv2d_24[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 16, 157, 96)     0            concatenate_35963[0][0]              
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 16, 157, 96)     384          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
conv2d_25 (Conv2D)                  (None, 16, 157, 64)     6208         batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
conv2d_27 (Conv2D)                  (None, 16, 157, 64)     6208         batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)      (None, 16, 157, 96)     0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
conv2d_26 (Conv2D)                  (None, 16, 157, 64)     36928        conv2d_25[0][0]                      
______________________________________________________________________________________________________________
conv2d_28 (Conv2D)                  (None, 16, 157, 64)     102464       conv2d_27[0][0]                      
______________________________________________________________________________________________________________
conv2d_29 (Conv2D)                  (None, 16, 157, 64)     6208         max_pooling2d_4[0][0]                
______________________________________________________________________________________________________________
concatenate_35964 (Concatenate)     (None, 16, 157, 192)    0            conv2d_26[0][0]                      
                                                                         conv2d_28[0][0]                      
                                                                         conv2d_29[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 8, 79, 192)      0            concatenate_35964[0][0]              
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 8, 79, 192)      768          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
conv2d_30 (Conv2D)                  (None, 8, 79, 128)      24704        batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
conv2d_32 (Conv2D)                  (None, 8, 79, 128)      24704        batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)      (None, 8, 79, 192)      0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
conv2d_31 (Conv2D)                  (None, 8, 79, 128)      147584       conv2d_30[0][0]                      
______________________________________________________________________________________________________________
conv2d_33 (Conv2D)                  (None, 8, 79, 128)      409728       conv2d_32[0][0]                      
______________________________________________________________________________________________________________
conv2d_34 (Conv2D)                  (None, 8, 79, 128)      24704        max_pooling2d_5[0][0]                
______________________________________________________________________________________________________________
concatenate_35965 (Concatenate)     (None, 8, 79, 384)      0            conv2d_31[0][0]                      
                                                                         conv2d_33[0][0]                      
                                                                         conv2d_34[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 4, 40, 384)      0            concatenate_35965[0][0]              
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 4, 40, 384)      1536         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
conv2d_35 (Conv2D)                  (None, 4, 40, 256)      98560        batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
conv2d_37 (Conv2D)                  (None, 4, 40, 256)      98560        batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)      (None, 4, 40, 384)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
conv2d_36 (Conv2D)                  (None, 4, 40, 256)      590080       conv2d_35[0][0]                      
______________________________________________________________________________________________________________
conv2d_38 (Conv2D)                  (None, 4, 40, 256)      1638656      conv2d_37[0][0]                      
______________________________________________________________________________________________________________
conv2d_39 (Conv2D)                  (None, 4, 40, 256)      98560        max_pooling2d_6[0][0]                
______________________________________________________________________________________________________________
concatenate_35966 (Concatenate)     (None, 4, 40, 768)      0            conv2d_36[0][0]                      
                                                                         conv2d_38[0][0]                      
                                                                         conv2d_39[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePoolin (None, 2, 20, 768)      0            concatenate_35966[0][0]              
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 2, 20, 768)      3072         average_pooling2d_15[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 768)             0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               769          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 3,372,437
Trainable params: 3,369,411
Non-trainable params: 3,026
______________________________________________________________________________________________________________
Epoch 1/65
172/172 - 72s - loss: 0.6747 - accuracy: 0.6401 - val_loss: 2.2266 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.09280125233434092
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
172/172 - 60s - loss: 0.4049 - accuracy: 0.7726 - val_loss: 2.9239 - val_accuracy: 0.0579
Confusion matrix: 
 [[  3 570]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.005 0.995]
 [0.    1.   ]]
Validation f1: 10.09
Validation accuracy: 5.79
Validation recall: 100.00
Validation precision: 5.32
Validation AUC: 0.47846362527531094
Validation class accuracies: [0.005235602094240838, 1.0]
Saving model...
Epoch 3/65
172/172 - 56s - loss: 0.2473 - accuracy: 0.8675 - val_loss: 0.2528 - val_accuracy: 0.9256
Confusion matrix: 
 [[547  26]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.594 0.406]]
Validation f1: 36.62
Validation accuracy: 92.56
Validation recall: 40.62
Validation precision: 33.33
Validation AUC: 0.4117243516578078
Validation class accuracies: [0.9546247818499127, 0.40625]
Saving model...
Epoch 4/65
172/172 - 57s - loss: 0.2099 - accuracy: 0.8948 - val_loss: 1.3627 - val_accuracy: 0.4992
Confusion matrix: 
 [[273 300]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.476 0.524]
 [0.094 0.906]]
Validation f1: 16.07
Validation accuracy: 49.92
Validation recall: 90.62
Validation precision: 8.81
Validation AUC: 0.4209373187782283
Validation class accuracies: [0.47643979057591623, 0.90625]
The validation tracker metric at 0.36619718309859156 hasn't increased by 0 in 1 epochs
Epoch 5/65
172/172 - 65s - loss: 0.2010 - accuracy: 0.9014 - val_loss: 1.4855 - val_accuracy: 0.6826
Confusion matrix: 
 [[392 181]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.684 0.316]
 [0.344 0.656]]
Validation f1: 17.95
Validation accuracy: 68.26
Validation recall: 65.62
Validation precision: 10.40
Validation AUC: 0.07963891602652826
Validation class accuracies: [0.6841186736474695, 0.65625]
The validation tracker metric at 0.36619718309859156 hasn't increased by 0 in 2 epochs
Epoch 6/65
172/172 - 60s - loss: 0.1340 - accuracy: 0.9316 - val_loss: 0.7294 - val_accuracy: 0.7041
Confusion matrix: 
 [[403 170]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.703 0.297]
 [0.281 0.719]]
Validation f1: 20.44
Validation accuracy: 70.41
Validation recall: 71.88
Validation precision: 11.92
Validation AUC: 0.46835073978738345
Validation class accuracies: [0.7033158813263525, 0.71875]
The validation tracker metric at 0.36619718309859156 hasn't increased by 0 in 3 epochs
Epoch 7/65
172/172 - 61s - loss: 0.1313 - accuracy: 0.9392 - val_loss: 0.1938 - val_accuracy: 0.9438
Confusion matrix: 
 [[553  20]
 [ 14  18]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.438 0.562]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.43
Validation accuracy: 94.38
Validation recall: 56.25
Validation precision: 47.37
Validation AUC: 0.5296757762002877
Validation class accuracies: [0.9650959860383944, 0.5625]
Saving model...
Epoch 8/65
172/172 - 60s - loss: 0.0709 - accuracy: 0.9672 - val_loss: 0.4249 - val_accuracy: 0.8959
Confusion matrix: 
 [[524  49]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.438 0.562]]
Validation f1: 36.36
Validation accuracy: 89.59
Validation recall: 56.25
Validation precision: 26.87
Validation AUC: 0.5233489599090042
Validation class accuracies: [0.9144851657940664, 0.5625]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 1 epochs
Epoch 9/65
172/172 - 66s - loss: 0.0545 - accuracy: 0.9731 - val_loss: 3.1584 - val_accuracy: 0.2595
Confusion matrix: 
 [[126 447]
 [  1  31]]
Normalized Confusion matrix: 
 [[0.22  0.78 ]
 [0.031 0.969]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.16
Validation accuracy: 25.95
Validation recall: 96.88
Validation precision: 6.49
Validation AUC: 0.4858888568585138
Validation class accuracies: [0.2198952879581152, 0.96875]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 2 epochs
Epoch 10/65
172/172 - 60s - loss: 0.0311 - accuracy: 0.9865 - val_loss: 0.2984 - val_accuracy: 0.9488
Confusion matrix: 
 [[561  12]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.594 0.406]]
Validation f1: 45.61
Validation accuracy: 94.88
Validation recall: 40.62
Validation precision: 52.00
Validation AUC: 0.4573730566163686
Validation class accuracies: [0.9790575916230366, 0.40625]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 3 epochs
Epoch 11/65
172/172 - 57s - loss: 0.0273 - accuracy: 0.9894 - val_loss: 0.3404 - val_accuracy: 0.9058
Confusion matrix: 
 [[528  45]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.375 0.625]]
Validation f1: 41.24
Validation accuracy: 90.58
Validation recall: 62.50
Validation precision: 30.77
Validation AUC: 0.5801294609491139
Validation class accuracies: [0.9214659685863874, 0.625]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 4 epochs
Epoch 12/65
172/172 - 56s - loss: 0.0326 - accuracy: 0.9840 - val_loss: 0.2027 - val_accuracy: 0.9388
Confusion matrix: 
 [[553  20]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.531 0.469]]
Validation f1: 44.78
Validation accuracy: 93.88
Validation recall: 46.88
Validation precision: 42.86
Validation AUC: 0.5274632654981146
Validation class accuracies: [0.9650959860383944, 0.46875]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 5 epochs
Epoch 13/65
172/172 - 65s - loss: 0.0186 - accuracy: 0.9913 - val_loss: 0.3683 - val_accuracy: 0.8826
Confusion matrix: 
 [[513  60]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.344 0.656]]
Validation f1: 37.17
Validation accuracy: 88.26
Validation recall: 65.62
Validation precision: 25.93
Validation AUC: 0.5807670493086228
Validation class accuracies: [0.8952879581151832, 0.65625]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 14/65
172/172 - 60s - loss: 0.0191 - accuracy: 0.9916 - val_loss: 0.2319 - val_accuracy: 0.9240
Confusion matrix: 
 [[545  28]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.562 0.438]]
Validation f1: 37.84
Validation accuracy: 92.40
Validation recall: 43.75
Validation precision: 33.33
Validation AUC: 0.48664229862836295
Validation class accuracies: [0.9511343804537522, 0.4375]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 7 epochs
Epoch 15/65
172/172 - 61s - loss: 0.0130 - accuracy: 0.9953 - val_loss: 0.6390 - val_accuracy: 0.7884
Confusion matrix: 
 [[455 118]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.794 0.206]
 [0.312 0.688]]
Validation f1: 25.58
Validation accuracy: 78.84
Validation recall: 68.75
Validation precision: 15.71
Validation AUC: 0.505206026642436
Validation class accuracies: [0.794066317626527, 0.6875]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 8 epochs
Epoch 16/65
172/172 - 61s - loss: 0.0164 - accuracy: 0.9956 - val_loss: 0.3479 - val_accuracy: 0.9124
Confusion matrix: 
 [[532  41]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.375 0.625]]
Validation f1: 43.01
Validation accuracy: 91.24
Validation recall: 62.50
Validation precision: 32.79
Validation AUC: 0.6473076472332305
Validation class accuracies: [0.9284467713787086, 0.625]
The validation tracker metric at 0.5142857142857142 hasn't increased by 0 in 9 epochs
Epoch 17/65
172/172 - 63s - loss: 0.0100 - accuracy: 0.9960 - val_loss: 0.2539 - val_accuracy: 0.9438
Confusion matrix: 
 [[552  21]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.78
Validation accuracy: 94.38
Validation recall: 59.38
Validation precision: 47.50
Validation AUC: 0.6365326864465947
Validation class accuracies: [0.9633507853403142, 0.59375]
Saving model...
Epoch 18/65
172/172 - 61s - loss: 0.0078 - accuracy: 0.9975 - val_loss: 0.5036 - val_accuracy: 0.9008
Confusion matrix: 
 [[520  53]
 [  7  25]]
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.219 0.781]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.45
Validation accuracy: 90.08
Validation recall: 78.12
Validation precision: 32.05
Validation AUC: 0.6345070205076813
Validation class accuracies: [0.9075043630017452, 0.78125]
The validation tracker metric at 0.5277777777777778 hasn't increased by 0 in 1 epochs
Epoch 19/65
172/172 - 59s - loss: 0.0137 - accuracy: 0.9960 - val_loss: 0.2435 - val_accuracy: 0.9504
Confusion matrix: 
 [[556  17]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.406 0.594]]
Validation f1: 55.88
Validation accuracy: 95.04
Validation recall: 59.38
Validation precision: 52.78
Validation AUC: 0.580126905708304
Validation class accuracies: [0.9703315881326352, 0.59375]
Saving model...
Epoch 20/65
172/172 - 59s - loss: 0.0062 - accuracy: 0.9985 - val_loss: 0.2278 - val_accuracy: 0.9587
Confusion matrix: 
 [[564   9]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.5   0.5  ]]
Validation f1: 56.14
Validation accuracy: 95.87
Validation recall: 50.00
Validation precision: 64.00
Validation AUC: 0.543923643942365
Validation class accuracies: [0.9842931937172775, 0.5]
Saving model...
Epoch 21/65
172/172 - 61s - loss: 0.0063 - accuracy: 0.9985 - val_loss: 0.3920 - val_accuracy: 0.9488
Confusion matrix: 
 [[561  12]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.594 0.406]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.61
Validation accuracy: 94.88
Validation recall: 40.62
Validation precision: 52.00
Validation AUC: 0.47706163259383166
Validation class accuracies: [0.9790575916230366, 0.40625]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 1 epochs
Epoch 22/65
172/172 - 60s - loss: 0.0075 - accuracy: 0.9978 - val_loss: 0.9497 - val_accuracy: 0.7884
Confusion matrix: 
 [[451 122]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.787 0.213]
 [0.188 0.812]]
Validation f1: 28.89
Validation accuracy: 78.84
Validation recall: 81.25
Validation precision: 17.57
Validation AUC: 0.5573526288480026
Validation class accuracies: [0.787085514834206, 0.8125]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 2 epochs
Epoch 23/65
172/172 - 61s - loss: 0.0152 - accuracy: 0.9953 - val_loss: 0.6203 - val_accuracy: 0.8397
Confusion matrix: 
 [[487  86]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.85  0.15 ]
 [0.344 0.656]]
Validation f1: 30.22
Validation accuracy: 83.97
Validation recall: 65.62
Validation precision: 19.63
Validation AUC: 0.5557434772514457
Validation class accuracies: [0.849912739965096, 0.65625]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 3 epochs
Epoch 24/65
172/172 - 65s - loss: 0.0074 - accuracy: 0.9971 - val_loss: 0.2906 - val_accuracy: 0.9355
Confusion matrix: 
 [[547  26]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.406 0.594]]
Validation f1: 49.35
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.55
Validation recall: 59.38
Validation precision: 42.22
Validation AUC: 0.6081459009459729
Validation class accuracies: [0.9546247818499127, 0.59375]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 4 epochs
Epoch 25/65
172/172 - 61s - loss: 0.0055 - accuracy: 0.9985 - val_loss: 0.2675 - val_accuracy: 0.9471
Confusion matrix: 
 [[554  19]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.29
Validation accuracy: 94.71
Validation recall: 59.38
Validation precision: 50.00
Validation AUC: 0.5938554583275499
Validation class accuracies: [0.9668411867364747, 0.59375]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 5 epochs
Epoch 26/65
172/172 - 61s - loss: 0.0065 - accuracy: 0.9975 - val_loss: 0.2593 - val_accuracy: 0.9438
Confusion matrix: 
 [[552  21]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.78
Validation accuracy: 94.38
Validation recall: 59.38
Validation precision: 47.50
Validation AUC: 0.610302808540576
Validation class accuracies: [0.9633507853403142, 0.59375]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 27/65
172/172 - 59s - loss: 0.0064 - accuracy: 0.9982 - val_loss: 0.3026 - val_accuracy: 0.9372
Confusion matrix: 
 [[548  25]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.406 0.594]]
Validation f1: 50.00
Validation accuracy: 93.72
Validation recall: 59.38
Validation precision: 43.18
Validation AUC: 0.5683107297339965
Validation class accuracies: [0.956369982547993, 0.59375]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 7 epochs
Epoch 28/65
172/172 - 61s - loss: 0.0029 - accuracy: 0.9996 - val_loss: 0.2687 - val_accuracy: 0.9388
Confusion matrix: 
 [[549  24]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.406 0.594]]
Validation f1: 50.67
Validation accuracy: 93.88
Validation recall: 59.38
Validation precision: 44.19
Validation AUC: 0.5835515707645441
Validation class accuracies: [0.9581151832460733, 0.59375]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 8 epochs
Epoch 29/65
172/172 - 56s - loss: 0.0033 - accuracy: 0.9996 - val_loss: 0.2746 - val_accuracy: 0.9421
Confusion matrix: 
 [[551  22]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.05
Validation accuracy: 94.21
Validation recall: 59.38
Validation precision: 46.34
Validation AUC: 0.6118840257806145
Validation class accuracies: [0.9616055846422339, 0.59375]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 9 epochs
Epoch 30/65
172/172 - 61s - loss: 0.0024 - accuracy: 0.9996 - val_loss: 0.2668 - val_accuracy: 0.9388
Confusion matrix: 
 [[549  24]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.67
Validation accuracy: 93.88
Validation recall: 59.38
Validation precision: 44.19
Validation AUC: 0.602970138105452
Validation class accuracies: [0.9581151832460733, 0.59375]
The validation tracker metric at 0.5614035087719298 hasn't increased by 0 in 10 epochs
Epoch 31/65
172/172 - 60s - loss: 0.0030 - accuracy: 0.9993 - val_loss: 0.2296 - val_accuracy: 0.9521
Confusion matrix: 
 [[557  16]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.72
Validation accuracy: 95.21
Validation recall: 59.38
Validation precision: 54.29
Validation AUC: 0.5955707273068327
Validation class accuracies: [0.9720767888307156, 0.59375]
Saving model...
Epoch 32/65
172/172 - 66s - loss: 0.0059 - accuracy: 0.9982 - val_loss: 0.4293 - val_accuracy: 0.9074
Confusion matrix: 
 [[530  43]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.406 0.594]]
Validation f1: 40.43
Validation accuracy: 90.74
Validation recall: 59.38
Validation precision: 30.65
Validation AUC: 0.5603329399443924
Validation class accuracies: [0.924956369982548, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 1 epochs
Epoch 33/65
172/172 - 61s - loss: 0.0081 - accuracy: 0.9985 - val_loss: 2.0852 - val_accuracy: 0.6612
Confusion matrix: 
 [[377 196]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.658 0.342]
 [0.281 0.719]]
Validation f1: 18.33
Validation accuracy: 66.12
Validation recall: 71.88
Validation precision: 10.50
Validation AUC: 0.3038268101619791
Validation class accuracies: [0.6579406631762653, 0.71875]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 2 epochs
Epoch 34/65
172/172 - 61s - loss: 0.0066 - accuracy: 0.9971 - val_loss: 0.2383 - val_accuracy: 0.9455
Confusion matrix: 
 [[553  20]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.52
Validation accuracy: 94.55
Validation recall: 59.38
Validation precision: 48.72
Validation AUC: 0.5945839520540855
Validation class accuracies: [0.9650959860383944, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 3 epochs
Epoch 35/65
172/172 - 61s - loss: 0.0022 - accuracy: 0.9996 - val_loss: 0.2393 - val_accuracy: 0.9438
Confusion matrix: 
 [[552  21]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.78
Validation accuracy: 94.38
Validation recall: 59.38
Validation precision: 47.50
Validation AUC: 0.6040194012640164
Validation class accuracies: [0.9633507853403142, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 4 epochs
Epoch 36/65
172/172 - 63s - loss: 0.0021 - accuracy: 0.9996 - val_loss: 0.2542 - val_accuracy: 0.9438
Confusion matrix: 
 [[552  21]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.78
Validation accuracy: 94.38
Validation recall: 59.38
Validation precision: 47.50
Validation AUC: 0.626293680347504
Validation class accuracies: [0.9633507853403142, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 5 epochs
Epoch 37/65
172/172 - 57s - loss: 0.0017 - accuracy: 1.0000 - val_loss: 0.2534 - val_accuracy: 0.9471
Confusion matrix: 
 [[554  19]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.406 0.594]]
Validation f1: 54.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.71
Validation recall: 59.38
Validation precision: 50.00
Validation AUC: 0.6101846030591623
Validation class accuracies: [0.9668411867364747, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 38/65
172/172 - 61s - loss: 0.0019 - accuracy: 0.9996 - val_loss: 0.2367 - val_accuracy: 0.9471
Confusion matrix: 
 [[554  19]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.406 0.594]]
Validation f1: 54.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.71
Validation recall: 59.38
Validation precision: 50.00
Validation AUC: 0.6295756409927863
Validation class accuracies: [0.9668411867364747, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 7 epochs
Epoch 39/65
172/172 - 60s - loss: 0.0024 - accuracy: 0.9996 - val_loss: 0.2716 - val_accuracy: 0.9372
Confusion matrix: 
 [[548  25]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 93.72
Validation recall: 59.38
Validation precision: 43.18
Validation AUC: 0.5969614352518514
Validation class accuracies: [0.956369982547993, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 8 epochs
Epoch 40/65
172/172 - 66s - loss: 0.0018 - accuracy: 0.9996 - val_loss: 0.2544 - val_accuracy: 0.9455
Confusion matrix: 
 [[553  20]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.52
Validation accuracy: 94.55
Validation recall: 59.38
Validation precision: 48.72
Validation AUC: 0.5603777327561866
Validation class accuracies: [0.9650959860383944, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 9 epochs
Epoch 41/65
172/172 - 61s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2984 - val_accuracy: 0.9372
Confusion matrix: 
 [[548  25]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 93.72
Validation recall: 59.38
Validation precision: 43.18
Validation AUC: 0.5878226548613462
Validation class accuracies: [0.956369982547993, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 10 epochs
Epoch 42/65
172/172 - 60s - loss: 0.0029 - accuracy: 0.9993 - val_loss: 0.2735 - val_accuracy: 0.9438
Confusion matrix: 
 [[552  21]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.78
Validation accuracy: 94.38
Validation recall: 59.38
Validation precision: 47.50
Validation AUC: 0.5970063569948117
Validation class accuracies: [0.9633507853403142, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 11 epochs
Epoch 43/65
172/172 - 60s - loss: 0.0018 - accuracy: 0.9996 - val_loss: 0.2635 - val_accuracy: 0.9471
Confusion matrix: 
 [[554  19]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.29
Validation accuracy: 94.71
Validation recall: 59.38
Validation precision: 50.00
Validation AUC: 0.5719319163738111
Validation class accuracies: [0.9668411867364747, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 44/65
172/172 - 60s - loss: 0.0014 - accuracy: 0.9996 - val_loss: 0.2633 - val_accuracy: 0.9471
Confusion matrix: 
 [[554  19]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.406 0.594]]
Validation f1: 54.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.71
Validation recall: 59.38
Validation precision: 50.00
Validation AUC: 0.5777962483683495
Validation class accuracies: [0.9668411867364747, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 13 epochs
Epoch 45/65
172/172 - 56s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.2604 - val_accuracy: 0.9438
Confusion matrix: 
 [[552  21]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.78
Validation accuracy: 94.38
Validation recall: 59.38
Validation precision: 47.50
Validation AUC: 0.5823566538048378
Validation class accuracies: [0.9633507853403142, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 14 epochs
Epoch 46/65
172/172 - 58s - loss: 0.0125 - accuracy: 0.9996 - val_loss: 0.3224 - val_accuracy: 0.9372
Confusion matrix: 
 [[548  25]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 93.72
Validation recall: 59.38
Validation precision: 43.18
Validation AUC: 0.5902626298414517
Validation class accuracies: [0.956369982547993, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 15 epochs
Epoch 47/65
172/172 - 61s - loss: 0.0041 - accuracy: 0.9993 - val_loss: 0.3317 - val_accuracy: 0.9355
Confusion matrix: 
 [[547  26]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.406 0.594]]
Validation f1: 49.35
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.55
Validation recall: 59.38
Validation precision: 42.22
Validation AUC: 0.5924133988758291
Validation class accuracies: [0.9546247818499127, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 16 epochs
Epoch 48/65
172/172 - 63s - loss: 0.0020 - accuracy: 0.9996 - val_loss: 0.3160 - val_accuracy: 0.9355
Confusion matrix: 
 [[547  26]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.35
Validation accuracy: 93.55
Validation recall: 59.38
Validation precision: 42.22
Validation AUC: 0.577225413434242
Validation class accuracies: [0.9546247818499127, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 17 epochs
Epoch 49/65
172/172 - 61s - loss: 0.0034 - accuracy: 0.9985 - val_loss: 0.3018 - val_accuracy: 0.9388
Confusion matrix: 
 [[549  24]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.67
Validation accuracy: 93.88
Validation recall: 59.38
Validation precision: 44.19
Validation AUC: 0.5831537273500911
Validation class accuracies: [0.9581151832460733, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 50/65
172/172 - 61s - loss: 0.0018 - accuracy: 0.9993 - val_loss: 0.2953 - val_accuracy: 0.9388
Confusion matrix: 
 [[549  24]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.67
Validation accuracy: 93.88
Validation recall: 59.38
Validation precision: 44.19
Validation AUC: 0.581225263569288
Validation class accuracies: [0.9581151832460733, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 19 epochs
Epoch 51/65
172/172 - 62s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.2944 - val_accuracy: 0.9388
Confusion matrix: 
 [[549  24]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.67
Validation accuracy: 93.88
Validation recall: 59.38
Validation precision: 44.19
Validation AUC: 0.5803423071350461
Validation class accuracies: [0.9581151832460733, 0.59375]

The metrics for job 0 with the best target metric are: 
Best cm: [[557  16]
 [ 13  19]]
Best normalized cm: [[0.972 0.028]
 [0.406 0.594]]
Best f1: 0.57
Best accuracy: 0.95
Best recall: 0.59
Best precision: 0.54
Best AUC: 0.60
Best class accuracies: [0.9720767888307156, 0.59375]
Best epoch: 31
The number of epochs since last 1% equals the patience
-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
-----------------------
Number of train recordings: 2648 with pneumonia: 348 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2748
-----------------------
Number of train recordings: 2748 with pneumonia: 348 and non-pneumonia: 2400
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormal (None, 128, 1250, 1)    4            input_4[0][0]                        
______________________________________________________________________________________________________________
conv2d_40 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_42 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_41 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_40[0][0]                      
______________________________________________________________________________________________________________
conv2d_43 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_42[0][0]                      
______________________________________________________________________________________________________________
conv2d_44 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_7[0][0]                
______________________________________________________________________________________________________________
concatenate_35967 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_41[0][0]                      
                                                                         conv2d_43[0][0]                      
                                                                         conv2d_44[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePoolin (None, 64, 625, 48)     0            concatenate_35967[0][0]              
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_16[0][0]           
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 64, 625, 48)     0            batch_normalization_19[0][0]         
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 64, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_17[0][0]           
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_20[0][0]         
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 32, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_18[0][0]           
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_21[0][0]         
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 16, 156, 128)    91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_19[0][0]           
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 8, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_20 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_20[0][0]           
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 4, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 1)               513          global_average_pooling2d_3[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
172/172 - 246s - loss: 1.2613 - accuracy: 0.5277 - val_loss: 0.5730 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05276680891618256
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
172/172 - 248s - loss: 0.5902 - accuracy: 0.6456 - val_loss: 0.4227 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.052675761976166476
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
172/172 - 249s - loss: 0.4771 - accuracy: 0.7140 - val_loss: 0.2142 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06463466161209766
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
172/172 - 249s - loss: 0.3818 - accuracy: 0.7973 - val_loss: 0.3747 - val_accuracy: 0.8661
Confusion matrix: 
 [[502  71]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.312 0.688]]
Validation f1: 35.20
Validation accuracy: 86.61
Validation recall: 68.75
Validation precision: 23.66
Validation AUC: 0.4760301236892885
Validation class accuracies: [0.8760907504363001, 0.6875]
Saving model...
Epoch 5/65
172/172 - 248s - loss: 0.3377 - accuracy: 0.8402 - val_loss: 1.6821 - val_accuracy: 0.6017
Confusion matrix: 
 [[349 224]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.609 0.391]
 [0.531 0.469]]
Validation f1: 11.07
Validation accuracy: 60.17
Validation recall: 46.88
Validation precision: 6.28
Validation AUC: 0.3094370186885834
Validation class accuracies: [0.6090750436300174, 0.46875]
The validation tracker metric at 0.35200000000000004 hasn't increased by 0 in 1 epochs
Epoch 6/65
172/172 - 248s - loss: 0.3651 - accuracy: 0.8246 - val_loss: 0.4930 - val_accuracy: 0.8595
Confusion matrix: 
 [[507  66]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.594 0.406]]
Validation f1: 23.42
Validation accuracy: 85.95
Validation recall: 40.62
Validation precision: 16.46
Validation AUC: 0.2467647415924514
Validation class accuracies: [0.8848167539267016, 0.40625]
The validation tracker metric at 0.35200000000000004 hasn't increased by 0 in 2 epochs
Epoch 7/65
172/172 - 249s - loss: 0.2778 - accuracy: 0.8541 - val_loss: 1.5000 - val_accuracy: 0.5091
Confusion matrix: 
 [[279 294]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.487 0.513]
 [0.094 0.906]]
Validation f1: 16.34
Validation accuracy: 50.91
Validation recall: 90.62
Validation precision: 8.98
Validation AUC: 0.3035647218061635
Validation class accuracies: [0.4869109947643979, 0.90625]
The validation tracker metric at 0.35200000000000004 hasn't increased by 0 in 3 epochs
Epoch 8/65
172/172 - 248s - loss: 0.2089 - accuracy: 0.8926 - val_loss: 0.3925 - val_accuracy: 0.8430
Confusion matrix: 
 [[485  88]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.219 0.781]]
Validation f1: 34.48
Validation accuracy: 84.30
Validation recall: 78.12
Validation precision: 22.12
Validation AUC: 0.6294553571458062
Validation class accuracies: [0.8464223385689355, 0.78125]
The validation tracker metric at 0.35200000000000004 hasn't increased by 0 in 4 epochs
Epoch 9/65
172/172 - 248s - loss: 0.1966 - accuracy: 0.9087 - val_loss: 0.9188 - val_accuracy: 0.7950
Confusion matrix: 
 [[463 110]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.808 0.192]
 [0.438 0.562]]
Validation f1: 22.50
Validation accuracy: 79.50
Validation recall: 56.25
Validation precision: 14.06
Validation AUC: 0.2551522040294835
Validation class accuracies: [0.8080279232111692, 0.5625]
The validation tracker metric at 0.35200000000000004 hasn't increased by 0 in 5 epochs
Epoch 10/65
172/172 - 248s - loss: 0.1381 - accuracy: 0.9309 - val_loss: 0.6668 - val_accuracy: 0.8314
Confusion matrix: 
 [[479  94]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.836 0.164]
 [0.25  0.75 ]]
Validation f1: 32.00
Validation accuracy: 83.14
Validation recall: 75.00
Validation precision: 20.34
Validation AUC: 0.49401033558201485
Validation class accuracies: [0.8359511343804538, 0.75]
The validation tracker metric at 0.35200000000000004 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 11/65
172/172 - 248s - loss: 0.1319 - accuracy: 0.9443 - val_loss: 1.2642 - val_accuracy: 0.7074
Confusion matrix: 
 [[397 176]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.693 0.307]
 [0.031 0.969]]
Validation f1: 25.94
Validation accuracy: 70.74
Validation recall: 96.88
Validation precision: 14.98
Validation AUC: 0.5366544087222207
Validation class accuracies: [0.6928446771378709, 0.96875]
The validation tracker metric at 0.35200000000000004 hasn't increased by 0 in 7 epochs
Epoch 12/65
172/172 - 248s - loss: 0.1433 - accuracy: 0.9414 - val_loss: 0.1901 - val_accuracy: 0.9322
Confusion matrix: 
 [[547  26]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.469 0.531]]
Validation f1: 45.33
Validation accuracy: 93.22
Validation recall: 53.12
Validation precision: 39.53
Validation AUC: 0.5887259216283978
Validation class accuracies: [0.9546247818499127, 0.53125]
Saving model...
Epoch 13/65
172/172 - 248s - loss: 0.0931 - accuracy: 0.9589 - val_loss: 0.9338 - val_accuracy: 0.7421
Confusion matrix: 
 [[429 144]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.749 0.251]
 [0.375 0.625]]
Validation f1: 20.41
Validation accuracy: 74.21
Validation recall: 62.50
Validation precision: 12.20
Validation AUC: 0.46349424341875084
Validation class accuracies: [0.7486910994764397, 0.625]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 1 epochs
Epoch 14/65
172/172 - 248s - loss: 0.0787 - accuracy: 0.9589 - val_loss: 1.4691 - val_accuracy: 0.6496
Confusion matrix: 
 [[366 207]
 [  5  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.639 0.361]
 [0.156 0.844]]
Validation f1: 20.30
Validation accuracy: 64.96
Validation recall: 84.38
Validation precision: 11.54
Validation AUC: 0.34214876932580685
Validation class accuracies: [0.6387434554973822, 0.84375]
The validation tracker metric at 0.45333333333333325 hasn't increased by 0 in 2 epochs
Epoch 15/65
172/172 - 249s - loss: 0.0488 - accuracy: 0.9771 - val_loss: 0.2314 - val_accuracy: 0.9223
Confusion matrix: 
 [[537  36]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.344 0.656]]
Validation f1: 47.19
Validation accuracy: 92.23
Validation recall: 65.62
Validation precision: 36.84
Validation AUC: 0.6360786583998059
Validation class accuracies: [0.93717277486911, 0.65625]
Saving model...
Epoch 16/65
172/172 - 248s - loss: 0.0366 - accuracy: 0.9851 - val_loss: 0.8690 - val_accuracy: 0.7785
Confusion matrix: 
 [[447 126]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.78 0.22]
 [0.25 0.75]]
Validation f1: 26.37
Validation accuracy: 77.85
Validation recall: 75.00
Validation precision: 16.00
Validation AUC: 0.47515600811044506
Validation class accuracies: [0.7801047120418848, 0.75]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 1 epochs
Epoch 17/65
172/172 - 248s - loss: 0.0481 - accuracy: 0.9767 - val_loss: 0.4273 - val_accuracy: 0.8860
Confusion matrix: 
 [[513  60]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.281 0.719]]
Validation f1: 40.00
Validation accuracy: 88.60
Validation recall: 71.88
Validation precision: 27.71
Validation AUC: 0.6003376004955693
Validation class accuracies: [0.8952879581151832, 0.71875]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 2 epochs
Epoch 18/65
172/172 - 249s - loss: 0.0515 - accuracy: 0.9778 - val_loss: 6.4285 - val_accuracy: 0.2744
Confusion matrix: 
 [[136 437]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.237 0.763]
 [0.062 0.938]]
Validation f1: 12.02
Validation accuracy: 27.44
Validation recall: 93.75
Validation precision: 6.42
Validation AUC: 0.30617581235795177
Validation class accuracies: [0.23734729493891799, 0.9375]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 3 epochs
Epoch 19/65
172/172 - 248s - loss: 0.0545 - accuracy: 0.9763 - val_loss: 0.5849 - val_accuracy: 0.8413
Confusion matrix: 
 [[490  83]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.855 0.145]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.36
Validation accuracy: 84.13
Validation recall: 59.38
Validation precision: 18.63
Validation AUC: 0.36903919871462953
Validation class accuracies: [0.8551483420593369, 0.59375]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 4 epochs
Epoch 20/65
172/172 - 248s - loss: 0.0275 - accuracy: 0.9902 - val_loss: 0.4598 - val_accuracy: 0.8876
Confusion matrix: 
 [[517  56]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.902 0.098]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 37.04
Validation accuracy: 88.76
Validation recall: 62.50
Validation precision: 26.32
Validation AUC: 0.5059644618630709
Validation class accuracies: [0.9022687609075044, 0.625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 5 epochs
Epoch 21/65
172/172 - 248s - loss: 0.0265 - accuracy: 0.9898 - val_loss: 0.6046 - val_accuracy: 0.8248
Confusion matrix: 
 [[477  96]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.312 0.688]]
Validation f1: 29.33
Validation accuracy: 82.48
Validation recall: 68.75
Validation precision: 18.64
Validation AUC: 0.50417013028943
Validation class accuracies: [0.8324607329842932, 0.6875]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
172/172 - 248s - loss: 0.0199 - accuracy: 0.9916 - val_loss: 0.3056 - val_accuracy: 0.9107
Confusion matrix: 
 [[533  40]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.438 0.562]]
Validation f1: 40.00
Validation accuracy: 91.07
Validation recall: 56.25
Validation precision: 31.03
Validation AUC: 0.4784301654989501
Validation class accuracies: [0.9301919720767888, 0.5625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 7 epochs
Epoch 23/65
172/172 - 249s - loss: 0.0195 - accuracy: 0.9920 - val_loss: 1.0303 - val_accuracy: 0.6992
Confusion matrix: 
 [[402 171]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.702 0.298]
 [0.344 0.656]]
Validation f1: 18.75
Validation accuracy: 69.92
Validation recall: 65.62
Validation precision: 10.94
Validation AUC: 0.31143836363480937
Validation class accuracies: [0.7015706806282722, 0.65625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 8 epochs
Epoch 24/65
172/172 - 250s - loss: 0.0195 - accuracy: 0.9898 - val_loss: 0.8071 - val_accuracy: 0.8364
Confusion matrix: 
 [[485  88]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.344 0.656]]
Validation f1: 29.79
Validation accuracy: 83.64
Validation recall: 65.62
Validation precision: 19.27
Validation AUC: 0.4561232822777078
Validation class accuracies: [0.8464223385689355, 0.65625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 9 epochs
Epoch 25/65
172/172 - 248s - loss: 0.0131 - accuracy: 0.9953 - val_loss: 0.3471 - val_accuracy: 0.8992
Confusion matrix: 
 [[529  44]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.531 0.469]]
Validation f1: 32.97
Validation accuracy: 89.92
Validation recall: 46.88
Validation precision: 25.42
Validation AUC: 0.4012600695003847
Validation class accuracies: [0.9232111692844677, 0.46875]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 10 epochs
Epoch 26/65
172/172 - 249s - loss: 0.0112 - accuracy: 0.9975 - val_loss: 1.5715 - val_accuracy: 0.6562
Confusion matrix: 
 [[373 200]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.651 0.349]
 [0.25  0.75 ]]
Validation f1: 18.75
Validation accuracy: 65.62
Validation recall: 75.00
Validation precision: 10.71
Validation AUC: 0.49085759850824845
Validation class accuracies: [0.6509598603839442, 0.75]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 11 epochs
Epoch 27/65
172/172 - 248s - loss: 0.0149 - accuracy: 0.9927 - val_loss: 0.3240 - val_accuracy: 0.9174
Confusion matrix: 
 [[537  36]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.438 0.562]]
Validation f1: 41.86
Validation accuracy: 91.74
Validation recall: 56.25
Validation precision: 33.33
Validation AUC: 0.5415407608754784
Validation class accuracies: [0.93717277486911, 0.5625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
172/172 - 249s - loss: 0.0091 - accuracy: 0.9982 - val_loss: 0.6354 - val_accuracy: 0.8727
Confusion matrix: 
 [[507  66]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.344 0.656]]
Validation f1: 35.29
Validation accuracy: 87.27
Validation recall: 65.62
Validation precision: 24.14
Validation AUC: 0.5243258965039153
Validation class accuracies: [0.8848167539267016, 0.65625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 13 epochs
Epoch 29/65
172/172 - 248s - loss: 0.0084 - accuracy: 0.9982 - val_loss: 0.4964 - val_accuracy: 0.8926
Confusion matrix: 
 [[520  53]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.375 0.625]]
Validation f1: 38.10
Validation accuracy: 89.26
Validation recall: 62.50
Validation precision: 27.40
Validation AUC: 0.5344060817255424
Validation class accuracies: [0.9075043630017452, 0.625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 14 epochs
Epoch 30/65
172/172 - 249s - loss: 0.0123 - accuracy: 0.9945 - val_loss: 0.5206 - val_accuracy: 0.8942
Confusion matrix: 
 [[520  53]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.344 0.656]]
Validation f1: 39.62
Validation accuracy: 89.42
Validation recall: 65.62
Validation precision: 28.38
Validation AUC: 0.5021717509352607
Validation class accuracies: [0.9075043630017452, 0.65625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 15 epochs
Epoch 31/65
172/172 - 248s - loss: 0.0128 - accuracy: 0.9967 - val_loss: 0.4410 - val_accuracy: 0.8942
Confusion matrix: 
 [[522  51]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.406 0.594]]
Validation f1: 37.25
Validation accuracy: 89.42
Validation recall: 59.38
Validation precision: 27.14
Validation AUC: 0.45305138769764697
Validation class accuracies: [0.9109947643979057, 0.59375]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 16 epochs
Epoch 32/65
172/172 - 248s - loss: 0.0094 - accuracy: 0.9982 - val_loss: 0.6478 - val_accuracy: 0.8744
Confusion matrix: 
 [[508  65]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.344 0.656]]
Validation f1: 35.59
Validation accuracy: 87.44
Validation recall: 65.62
Validation precision: 24.42
Validation AUC: 0.49037319622836667
Validation class accuracies: [0.8865619546247818, 0.65625]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 17 epochs
Epoch 33/65
172/172 - 248s - loss: 0.0099 - accuracy: 0.9953 - val_loss: 0.5531 - val_accuracy: 0.8876
Confusion matrix: 
 [[518  55]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.406 0.594]]
Validation f1: 35.85
Validation accuracy: 88.76
Validation recall: 59.38
Validation precision: 25.68
Validation AUC: 0.4983914627054545
Validation class accuracies: [0.9040139616055847, 0.59375]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 34/65
172/172 - 248s - loss: 0.0091 - accuracy: 0.9967 - val_loss: 0.6389 - val_accuracy: 0.8744
Confusion matrix: 
 [[510  63]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.406 0.594]]
Validation f1: 33.33
Validation accuracy: 87.44
Validation recall: 59.38
Validation precision: 23.17
Validation AUC: 0.47390963547013154
Validation class accuracies: [0.8900523560209425, 0.59375]
The validation tracker metric at 0.47191011235955055 hasn't increased by 0 in 19 epochs
Epoch 35/65
172/172 - 248s - loss: 0.0063 - accuracy: 0.9971 - val_loss: 0.4374 - val_accuracy: 0.9041
Confusion matrix: 
 [[529  44]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.438 0.562]]
Validation f1: 38.30
Validation accuracy: 90.41
Validation recall: 56.25
Validation precision: 29.03
Validation AUC: 0.4820308021713066
Validation class accuracies: [0.9232111692844677, 0.5625]

The metrics for job 0 with the best target metric are: 
Best cm: [[537  36]
 [ 11  21]]
Best normalized cm: [[0.937 0.063]
 [0.344 0.656]]
Best f1: 0.47
Best accuracy: 0.92
Best recall: 0.66
Best precision: 0.37
Best AUC: 0.64
Best class accuracies: [0.93717277486911, 0.65625]
Best epoch: 15
The number of epochs since last 1% equals the patience
-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
-----------------------
Number of train recordings: 2648 with pneumonia: 348 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2748
-----------------------
Number of train recordings: 2748 with pneumonia: 348 and non-pneumonia: 2400
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_5 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_24 (BatchNormal (None, 128, 1250, 1)    4            input_5[0][0]                        
______________________________________________________________________________________________________________
conv2d_45 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_47 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_46 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_45[0][0]                      
______________________________________________________________________________________________________________
conv2d_48 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_47[0][0]                      
______________________________________________________________________________________________________________
conv2d_49 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_8[0][0]                
______________________________________________________________________________________________________________
concatenate_35968 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_46[0][0]                      
                                                                         conv2d_48[0][0]                      
                                                                         conv2d_49[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_21 (AveragePoolin (None, 64, 625, 48)     0            concatenate_35968[0][0]              
______________________________________________________________________________________________________________
batch_normalization_25 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_21[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_25[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 64, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_22 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_26 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_22[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_26[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 32, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_23 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_27 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_23[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_27[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 16, 156, 128)    91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_24 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_28 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_24[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_28[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 8, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_25 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_29 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_25[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_29[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 4, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_4 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 1)               513          global_average_pooling2d_4[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
172/172 - 247s - loss: 0.9665 - accuracy: 0.5466 - val_loss: 1.3174 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.060751483095487155
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
172/172 - 247s - loss: 0.5061 - accuracy: 0.7249 - val_loss: 0.9676 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.05665959422175898
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
172/172 - 247s - loss: 0.3841 - accuracy: 0.7904 - val_loss: 0.9604 - val_accuracy: 0.1669
Confusion matrix: 
 [[ 69 504]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.12 0.88]
 [0.   1.  ]]
Validation f1: 11.27
Validation accuracy: 16.69
Validation recall: 100.00
Validation precision: 5.97
Validation AUC: 0.217230989173268
Validation class accuracies: [0.12041884816753927, 1.0]
Saving model...
Epoch 4/65
172/172 - 246s - loss: 0.3835 - accuracy: 0.8017 - val_loss: 1.2311 - val_accuracy: 0.4066
Confusion matrix: 
 [[222 351]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.387 0.613]
 [0.25  0.75 ]]
Validation f1: 11.79
Validation accuracy: 40.66
Validation recall: 75.00
Validation precision: 6.40
Validation AUC: 0.3034236549023083
Validation class accuracies: [0.387434554973822, 0.75]
Saving model...
Epoch 5/65
172/172 - 246s - loss: 0.3353 - accuracy: 0.8421 - val_loss: 2.2436 - val_accuracy: 0.5851
Confusion matrix: 
 [[328 245]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.572 0.428]
 [0.188 0.812]]
Validation f1: 17.16
Validation accuracy: 58.51
Validation recall: 81.25
Validation precision: 9.59
Validation AUC: 0.3510104033374587
Validation class accuracies: [0.5724258289703316, 0.8125]
Saving model...
Epoch 6/65
172/172 - 246s - loss: 0.2519 - accuracy: 0.8745 - val_loss: 0.7037 - val_accuracy: 0.7884
Confusion matrix: 
 [[456 117]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.344 0.656]]
Validation f1: 24.71
Validation accuracy: 78.84
Validation recall: 65.62
Validation precision: 15.22
Validation AUC: 0.4515513673644759
Validation class accuracies: [0.7958115183246073, 0.65625]
Saving model...
Epoch 7/65
172/172 - 246s - loss: 0.2097 - accuracy: 0.9007 - val_loss: 2.1137 - val_accuracy: 0.5554
Confusion matrix: 
 [[310 263]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.541 0.459]
 [0.188 0.812]]
Validation f1: 16.20
Validation accuracy: 55.54
Validation recall: 81.25
Validation precision: 9.00
Validation AUC: 0.29469059010234383
Validation class accuracies: [0.5410122164048866, 0.8125]
The validation tracker metric at 0.2470588235294118 hasn't increased by 0 in 1 epochs
Epoch 8/65
172/172 - 246s - loss: 0.3006 - accuracy: 0.8825 - val_loss: 4.9012 - val_accuracy: 0.6760
Confusion matrix: 
 [[385 188]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.672 0.328]
 [0.25  0.75 ]]
Validation f1: 19.67
Validation accuracy: 67.60
Validation recall: 75.00
Validation precision: 11.32
Validation AUC: 0.3809825105323657
Validation class accuracies: [0.6719022687609075, 0.75]
The validation tracker metric at 0.2470588235294118 hasn't increased by 0 in 2 epochs
Epoch 9/65
172/172 - 246s - loss: 0.2286 - accuracy: 0.8883 - val_loss: 0.5367 - val_accuracy: 0.8314
Confusion matrix: 
 [[485  88]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.438 0.562]]
Validation f1: 26.09
Validation accuracy: 83.14
Validation recall: 56.25
Validation precision: 16.98
Validation AUC: 0.42623882262224594
Validation class accuracies: [0.8464223385689355, 0.5625]
Saving model...
Epoch 10/65
172/172 - 246s - loss: 0.1437 - accuracy: 0.9312 - val_loss: 0.2580 - val_accuracy: 0.9537
Confusion matrix: 
 [[573   0]
 [ 28   4]]
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.875 0.125]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.22
Validation accuracy: 95.37
Validation recall: 12.50
Validation precision: 100.00
Validation AUC: 0.29101513123737943
Validation class accuracies: [1.0, 0.125]
The validation tracker metric at 0.2608695652173913 hasn't increased by 0 in 1 epochs
Epoch 11/65
172/172 - 246s - loss: 0.1461 - accuracy: 0.9385 - val_loss: 3.8973 - val_accuracy: 0.2215
Confusion matrix: 
 [[102 471]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.178 0.822]
 [0.    1.   ]]
Validation f1: 11.96
Validation accuracy: 22.15
Validation recall: 100.00
Validation precision: 6.36
Validation AUC: 0.31984633950004804
Validation class accuracies: [0.17801047120418848, 1.0]
The validation tracker metric at 0.2608695652173913 hasn't increased by 0 in 2 epochs
Epoch 12/65
172/172 - 246s - loss: 0.1002 - accuracy: 0.9534 - val_loss: 1.1766 - val_accuracy: 0.7504
Confusion matrix: 
 [[438 135]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.764 0.236]
 [0.5   0.5  ]]
Validation f1: 17.49
Validation accuracy: 75.04
Validation recall: 50.00
Validation precision: 10.60
Validation AUC: 0.10448068562889651
Validation class accuracies: [0.7643979057591623, 0.5]
The validation tracker metric at 0.2608695652173913 hasn't increased by 0 in 3 epochs
Epoch 13/65
172/172 - 246s - loss: 0.0816 - accuracy: 0.9574 - val_loss: 0.8123 - val_accuracy: 0.7355
Confusion matrix: 
 [[421 152]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.735 0.265]
 [0.25  0.75 ]]
Validation f1: 23.08
Validation accuracy: 73.55
Validation recall: 75.00
Validation precision: 13.64
Validation AUC: 0.26538236388746694
Validation class accuracies: [0.7347294938917975, 0.75]
The validation tracker metric at 0.2608695652173913 hasn't increased by 0 in 4 epochs
Epoch 14/65
172/172 - 247s - loss: 0.1140 - accuracy: 0.9567 - val_loss: 4.5895 - val_accuracy: 0.3025
Confusion matrix: 
 [[151 422]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.264 0.736]
 [0.    1.   ]]
Validation f1: 13.17
Validation accuracy: 30.25
Validation recall: 100.00
Validation precision: 7.05
Validation AUC: 0.1472607730842856
Validation class accuracies: [0.26352530541012215, 1.0]
The validation tracker metric at 0.2608695652173913 hasn't increased by 0 in 5 epochs
Epoch 15/65
172/172 - 246s - loss: 0.0788 - accuracy: 0.9654 - val_loss: 3.1386 - val_accuracy: 0.6777
Confusion matrix: 
 [[386 187]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.674 0.326]
 [0.25  0.75 ]]
Validation f1: 19.75
Validation accuracy: 67.77
Validation recall: 75.00
Validation precision: 11.37
Validation AUC: 0.35131834351509844
Validation class accuracies: [0.6736474694589878, 0.75]
The validation tracker metric at 0.2608695652173913 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
172/172 - 246s - loss: 0.0696 - accuracy: 0.9709 - val_loss: 0.7061 - val_accuracy: 0.7802
Confusion matrix: 
 [[448 125]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.782 0.218]
 [0.25  0.75 ]]
Validation f1: 26.52
Validation accuracy: 78.02
Validation recall: 75.00
Validation precision: 16.11
Validation AUC: 0.369072556917219
Validation class accuracies: [0.7818499127399651, 0.75]
Saving model...
Epoch 17/65
172/172 - 247s - loss: 0.0340 - accuracy: 0.9844 - val_loss: 0.6589 - val_accuracy: 0.8083
Confusion matrix: 
 [[472 101]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.824 0.176]
 [0.469 0.531]]
Validation f1: 22.67
Validation accuracy: 80.83
Validation recall: 53.12
Validation precision: 14.41
Validation AUC: 0.3797016185400481
Validation class accuracies: [0.8237347294938918, 0.53125]
The validation tracker metric at 0.26519337016574585 hasn't increased by 0 in 1 epochs
Epoch 18/65
172/172 - 246s - loss: 0.0340 - accuracy: 0.9818 - val_loss: 0.2557 - val_accuracy: 0.9554
Confusion matrix: 
 [[570   3]
 [ 24   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.75  0.25 ]]
Validation f1: 37.21
Validation accuracy: 95.54
Validation recall: 25.00
Validation precision: 72.73
Validation AUC: 0.38252161695957837
Validation class accuracies: [0.9947643979057592, 0.25]
Saving model...
Epoch 19/65
172/172 - 246s - loss: 0.0285 - accuracy: 0.9891 - val_loss: 1.0178 - val_accuracy: 0.7355
Confusion matrix: 
 [[422 151]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.736 0.264]
 [0.281 0.719]]
Validation f1: 22.33
Validation accuracy: 73.55
Validation recall: 71.88
Validation precision: 13.22
Validation AUC: 0.4095886576305155
Validation class accuracies: [0.7364746945898778, 0.71875]
The validation tracker metric at 0.37209302325581395 hasn't increased by 0 in 1 epochs
Epoch 20/65
172/172 - 246s - loss: 0.0272 - accuracy: 0.9844 - val_loss: 0.2210 - val_accuracy: 0.9471
Confusion matrix: 
 [[558  15]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.531 0.469]]
Validation f1: 48.39
Validation accuracy: 94.71
Validation recall: 46.88
Validation precision: 50.00
Validation AUC: 0.5321306504373258
Validation class accuracies: [0.9738219895287958, 0.46875]
Saving model...
Epoch 21/65
172/172 - 246s - loss: 0.0174 - accuracy: 0.9949 - val_loss: 0.2420 - val_accuracy: 0.9306
Confusion matrix: 
 [[548  25]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.531 0.469]]
Validation f1: 41.67
Validation accuracy: 93.06
Validation recall: 46.88
Validation precision: 37.50
Validation AUC: 0.4638496605494746
Validation class accuracies: [0.956369982547993, 0.46875]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 1 epochs
Epoch 22/65
172/172 - 246s - loss: 0.0943 - accuracy: 0.9654 - val_loss: 0.2859 - val_accuracy: 0.9157
Confusion matrix: 
 [[539  34]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.531 0.469]]
Validation f1: 37.04
Validation accuracy: 91.57
Validation recall: 46.88
Validation precision: 30.61
Validation AUC: 0.432804965399638
Validation class accuracies: [0.9406631762652705, 0.46875]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 2 epochs
Epoch 23/65
172/172 - 246s - loss: 0.0505 - accuracy: 0.9771 - val_loss: 0.2100 - val_accuracy: 0.9306
Confusion matrix: 
 [[546  27]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.469 0.531]]
Validation f1: 44.74
Validation accuracy: 93.06
Validation recall: 53.12
Validation precision: 38.64
Validation AUC: 0.5705222282321576
Validation class accuracies: [0.9528795811518325, 0.53125]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 3 epochs
Epoch 24/65
172/172 - 246s - loss: 0.0261 - accuracy: 0.9894 - val_loss: 0.4949 - val_accuracy: 0.8463
Confusion matrix: 
 [[492  81]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.375 0.625]]
Validation f1: 30.08
Validation accuracy: 84.63
Validation recall: 62.50
Validation precision: 19.80
Validation AUC: 0.505133224643137
Validation class accuracies: [0.8586387434554974, 0.625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 4 epochs
Epoch 25/65
172/172 - 245s - loss: 0.0282 - accuracy: 0.9884 - val_loss: 0.2463 - val_accuracy: 0.9339
Confusion matrix: 
 [[551  22]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.562 0.438]]
Validation f1: 41.18
Validation accuracy: 93.39
Validation recall: 43.75
Validation precision: 38.89
Validation AUC: 0.4348679702752439
Validation class accuracies: [0.9616055846422339, 0.4375]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 5 epochs
Epoch 26/65
172/172 - 245s - loss: 0.0157 - accuracy: 0.9938 - val_loss: 0.2240 - val_accuracy: 0.9455
Confusion matrix: 
 [[558  15]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.562 0.438]]
Validation f1: 45.90
Validation accuracy: 94.55
Validation recall: 43.75
Validation precision: 48.28
Validation AUC: 0.46325891448299766
Validation class accuracies: [0.9738219895287958, 0.4375]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 27/65
172/172 - 246s - loss: 0.0197 - accuracy: 0.9920 - val_loss: 0.6204 - val_accuracy: 0.8298
Confusion matrix: 
 [[482  91]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.375 0.625]]
Validation f1: 27.97
Validation accuracy: 82.98
Validation recall: 62.50
Validation precision: 18.02
Validation AUC: 0.4537029555720765
Validation class accuracies: [0.8411867364746946, 0.625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 7 epochs
Epoch 28/65
172/172 - 245s - loss: 0.0115 - accuracy: 0.9938 - val_loss: 0.2411 - val_accuracy: 0.9455
Confusion matrix: 
 [[560  13]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.625 0.375]]
Validation f1: 42.11
Validation accuracy: 94.55
Validation recall: 37.50
Validation precision: 48.00
Validation AUC: 0.45172472788843376
Validation class accuracies: [0.9773123909249564, 0.375]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 8 epochs
Epoch 29/65
172/172 - 246s - loss: 0.0084 - accuracy: 0.9960 - val_loss: 0.2031 - val_accuracy: 0.9537
Confusion matrix: 
 [[564   9]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.594 0.406]]
Validation f1: 48.15
Validation accuracy: 95.37
Validation recall: 40.62
Validation precision: 59.09
Validation AUC: 0.4746275966952735
Validation class accuracies: [0.9842931937172775, 0.40625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 9 epochs
Epoch 30/65
172/172 - 246s - loss: 0.0132 - accuracy: 0.9953 - val_loss: 0.2586 - val_accuracy: 0.9537
Confusion matrix: 
 [[564   9]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.594 0.406]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.15
Validation accuracy: 95.37
Validation recall: 40.62
Validation precision: 59.09
Validation AUC: 0.48272003292937476
Validation class accuracies: [0.9842931937172775, 0.40625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 10 epochs
Epoch 31/65
172/172 - 246s - loss: 0.0093 - accuracy: 0.9971 - val_loss: 0.2332 - val_accuracy: 0.9570
Confusion matrix: 
 [[568   5]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.656 0.344]]
Validation f1: 45.83
Validation accuracy: 95.70
Validation recall: 34.38
Validation precision: 68.75
Validation AUC: 0.4867763531773865
Validation class accuracies: [0.9912739965095986, 0.34375]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 11 epochs
Epoch 32/65
172/172 - 245s - loss: 0.0065 - accuracy: 0.9978 - val_loss: 0.2322 - val_accuracy: 0.9438
Confusion matrix: 
 [[558  15]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.594 0.406]]
Validation f1: 43.33
Validation accuracy: 94.38
Validation recall: 40.62
Validation precision: 46.43
Validation AUC: 0.4689839164445584
Validation class accuracies: [0.9738219895287958, 0.40625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 33/65
172/172 - 246s - loss: 0.0095 - accuracy: 0.9978 - val_loss: 0.2791 - val_accuracy: 0.9223
Confusion matrix: 
 [[541  32]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.98
Validation accuracy: 92.23
Validation recall: 53.12
Validation precision: 34.69
Validation AUC: 0.5012272070409064
Validation class accuracies: [0.944153577661431, 0.53125]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 13 epochs
Epoch 34/65
172/172 - 245s - loss: 0.0064 - accuracy: 0.9978 - val_loss: 0.2176 - val_accuracy: 0.9455
Confusion matrix: 
 [[559  14]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.594 0.406]]
Validation f1: 44.07
Validation accuracy: 94.55
Validation recall: 40.62
Validation precision: 48.15
Validation AUC: 0.47587324320496577
Validation class accuracies: [0.9755671902268761, 0.40625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 14 epochs
Epoch 35/65
172/172 - 246s - loss: 0.0056 - accuracy: 0.9985 - val_loss: 0.2380 - val_accuracy: 0.9355
Confusion matrix: 
 [[553  20]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.594 0.406]]
Validation f1: 40.00
Validation accuracy: 93.55
Validation recall: 40.62
Validation precision: 39.39
Validation AUC: 0.4530616173812827
Validation class accuracies: [0.9650959860383944, 0.40625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 15 epochs
Epoch 36/65
172/172 - 246s - loss: 0.0061 - accuracy: 0.9993 - val_loss: 0.2257 - val_accuracy: 0.9455
Confusion matrix: 
 [[559  14]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.976 0.024]
 [0.594 0.406]]
Validation f1: 44.07
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.55
Validation recall: 40.62
Validation precision: 48.15
Validation AUC: 0.46725561912986086
Validation class accuracies: [0.9755671902268761, 0.40625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 16 epochs
Epoch 37/65
172/172 - 246s - loss: 0.0065 - accuracy: 0.9985 - val_loss: 0.2505 - val_accuracy: 0.9388
Confusion matrix: 
 [[555  18]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.594 0.406]]
Validation f1: 41.27
Validation accuracy: 93.88
Validation recall: 40.62
Validation precision: 41.94
Validation AUC: 0.45984677284557357
Validation class accuracies: [0.9685863874345549, 0.40625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 17 epochs
Epoch 38/65
172/172 - 245s - loss: 0.0206 - accuracy: 0.9967 - val_loss: 0.4725 - val_accuracy: 0.8810
Confusion matrix: 
 [[513  60]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.375 0.625]]
Validation f1: 35.71
Validation accuracy: 88.10
Validation recall: 62.50
Validation precision: 25.00
Validation AUC: 0.4934972296859433
Validation class accuracies: [0.8952879581151832, 0.625]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 39/65
172/172 - 246s - loss: 0.0112 - accuracy: 0.9942 - val_loss: 0.2688 - val_accuracy: 0.9388
Confusion matrix: 
 [[554  19]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.562 0.438]]
Validation f1: 43.08
Validation accuracy: 93.88
Validation recall: 43.75
Validation precision: 42.42
Validation AUC: 0.4770128923484405
Validation class accuracies: [0.9668411867364747, 0.4375]
The validation tracker metric at 0.4838709677419355 hasn't increased by 0 in 19 epochs
Epoch 40/65
172/172 - 245s - loss: 0.0075 - accuracy: 0.9960 - val_loss: 0.2483 - val_accuracy: 0.9438
Confusion matrix: 
 [[558  15]
 [ 19  13]]
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.594 0.406]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.33
Validation accuracy: 94.38
Validation recall: 40.62
Validation precision: 46.43
Validation AUC: 0.46285809590088833
Validation class accuracies: [0.9738219895287958, 0.40625]

The metrics for job 0 with the best target metric are: 
Best cm: [[558  15]
 [ 17  15]]
Best normalized cm: [[0.974 0.026]
 [0.531 0.469]]
Best f1: 0.48
Best accuracy: 0.95
Best recall: 0.47
Best precision: 0.50
Best AUC: 0.53
Best class accuracies: [0.9738219895287958, 0.46875]
Best epoch: 20
The number of epochs since last 1% equals the patience
-----------------------
wandb: Waiting for W&B process to finish, PID 12792
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_020748-37hlvm11/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_020748-37hlvm11/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.996
wandb:         val_accuracy 0.9438
wandb:             _runtime 39921
wandb:           _timestamp 1623849189
wandb:                _step 1570
wandb:           train_loss 0.00749
wandb:             val_loss 0.24832
wandb:           val_recall 0.40625
wandb:        val_precision 0.46429
wandb:               val_f1 0.43333
wandb:              val_auc 0.46286
wandb:                   lr 6e-05
wandb:          best_val_f1 0.48387
wandb:    best_val_accuracy 0.94711
wandb:   best_val_precision 0.5
wandb:      best_val_recall 0.46875
wandb:             best_auc 0.53213
wandb:           best_epoch 20
wandb: Run history:
wandb:   train_accuracy ▃▆▅▇▇███████████▆▇████████▅▇▇███▁▆▇█████
wandb:     val_accuracy ▁▇▅███▆███████████▇█▇█████▇▇▆▇▆▇▁▅▂▇█▇██
wandb:         _runtime ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇██
wandb:       _timestamp ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇██
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ▅▃▄▁▂▁▁▁▁▁▁▁▁▁▁▁▃▂▁▁▁▁▁▁▁▁▄▂▂▁▁▁█▃▂▁▁▁▁▁
wandb:         val_loss ▂▁▄▁▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▂▃▂▄▂▃▅█▂▁▂▁▁
wandb:       val_recall █▂▅▄▃▁▅▃▂▄▃▂▃▃▃▃▁▃▄▃▄▃▃▃▃▃▄▅▆▄▅▄█▆█▂▂▄▂▁
wandb:    val_precision ▁▂▁▃▃█▂▄▅▄▄▅▃▄▄▅▃▄▃▅▂▄▄▄▄▄▂▂▁▃▁▃▁▁▁▂▄▂▃▄
wandb:           val_f1 ▁▄▂▆▅█▃▆▇▇▇▇▆▇▇▇▅▇▅▇▄▇▇▇▇▇▅▄▂▅▂▅▁▂▁▃▆▄▆▆
wandb:          val_auc ▃▅▃█▇██▇▇██▆▇▇▇▇▅▇▇▇▇█▇▇▇▇▆▆▄▆▆▆▁▄▄▅▇▆▆▆
wandb:               lr ███▄▄▃▃▃▂▁▁██▄▄▃███▄▄▃▃▂▁▁██▄▄▃▂███▄▄▃▂▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_020748-37hlvm11


 See logs at ../../new_cache/conv__2224__06_0206__v39__augmented_jobs/logs/