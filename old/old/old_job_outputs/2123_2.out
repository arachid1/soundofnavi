Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2123
Description:  redo
2021-05-11 00:47:57.314702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 00:47:59.718213: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 00:47:59.719132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-11 00:47:59.769849: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:59.770643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 00:47:59.770685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 00:47:59.774400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 00:47:59.774506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 00:47:59.775631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 00:47:59.775932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 00:47:59.776936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 00:47:59.777907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 00:47:59.778074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 00:47:59.778220: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:59.779040: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:59.779796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2123.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2123__05_0047__v29__redo/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 12, 5.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2123
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1hnkkhr4
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_004800-1hnkkhr4
wandb: Run `wandb offline` to turn off syncing.
2021-05-11 00:48:05.242941: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 00:48:05.243240: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:48:05.244068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 00:48:05.244119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 00:48:05.244178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 00:48:05.244200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 00:48:05.244223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 00:48:05.244244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 00:48:05.244270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 00:48:05.244291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 00:48:05.244312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 00:48:05.244414: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:48:05.245220: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:48:05.245967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-11 00:48:05.246018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 00:48:06.021426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-11 00:48:06.021469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-11 00:48:06.021477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-11 00:48:06.021755: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:48:06.022570: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:48:06.023353: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:48:06.024092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-11 00:48:49.044858: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-11 00:48:49.046640: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-11 00:48:53.271975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 00:48:54.096873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 00:48:54.106936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
263/263 - 525s - loss: 0.7228 - accuracy: 0.5493 - val_loss: 0.6288 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1917922259044178
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.1917922259044178
Epoch 2/40
263/263 - 515s - loss: 0.6860 - accuracy: 0.5834 - val_loss: 0.6330 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2625325308251306
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.2625325308251306
Epoch 3/40
263/263 - 516s - loss: 0.6812 - accuracy: 0.6025 - val_loss: 0.6352 - val_accuracy: 0.7987
Confusion matrix: 
 [[869   1]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.87
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2207983942166622
Validation class accuracies: [0.9988505747126437, 0.0]
TARGET: 0
target metric(test auc): 0.2207983942166622
Epoch 4/40
263/263 - 515s - loss: 0.6759 - accuracy: 0.6058 - val_loss: 0.6755 - val_accuracy: 0.7555
Confusion matrix: 
 [[797  73]
 [193  25]]
Validation f1: 15.82
Validation accuracy: 75.55
Validation recall: 11.47
Validation precision: 25.51
Validation AUC: 0.21866959206384418
Validation class accuracies: [0.9160919540229885, 0.11467889908256881]
TARGET: 0
target metric(test auc): 0.21866959206384418
Epoch 5/40
263/263 - 516s - loss: 0.6706 - accuracy: 0.6306 - val_loss: 0.6923 - val_accuracy: 0.6847
Confusion matrix: 
 [[699 171]
 [172  46]]
Validation f1: 21.15
Validation accuracy: 68.47
Validation recall: 21.10
Validation precision: 21.20
Validation AUC: 0.2310239205849611
Validation class accuracies: [0.803448275862069, 0.21100917431192662]
TARGET: 0
target metric(test auc): 0.2310239205849611
Saving model...
Epoch 6/40
263/263 - 515s - loss: 0.6684 - accuracy: 0.6304 - val_loss: 0.6716 - val_accuracy: 0.6222
Confusion matrix: 
 [[634 236]
 [175  43]]
Validation f1: 17.30
Validation accuracy: 62.22
Validation recall: 19.72
Validation precision: 15.41
Validation AUC: 0.19595834896408237
Validation class accuracies: [0.728735632183908, 0.19724770642201836]
TARGET: 0
target metric(test auc): 0.19595834896408237
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 1 epochs
Epoch 7/40
263/263 - 517s - loss: 0.6656 - accuracy: 0.6499 - val_loss: 0.6502 - val_accuracy: 0.7289
Confusion matrix: 
 [[779  91]
 [204  14]]
Validation f1: 8.67
Validation accuracy: 72.89
Validation recall: 6.42
Validation precision: 13.33
Validation AUC: 0.19853881169680754
Validation class accuracies: [0.8954022988505748, 0.06422018348623854]
TARGET: 0
target metric(test auc): 0.19853881169680754
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 2 epochs
Epoch 8/40
263/263 - 516s - loss: 0.6609 - accuracy: 0.6563 - val_loss: 0.6797 - val_accuracy: 0.6461
Confusion matrix: 
 [[670 200]
 [185  33]]
Validation f1: 14.63
Validation accuracy: 64.61
Validation recall: 15.14
Validation precision: 14.16
Validation AUC: 0.1833803706617279
Validation class accuracies: [0.7701149425287356, 0.15137614678899083]
TARGET: 0
target metric(test auc): 0.1833803706617279
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 3 epochs
Epoch 9/40
263/263 - 514s - loss: 0.6541 - accuracy: 0.6785 - val_loss: 0.7007 - val_accuracy: 0.6259
Confusion matrix: 
 [[610 260]
 [147  71]]
Validation f1: 25.87
Validation accuracy: 62.59
Validation recall: 32.57
Validation precision: 21.45
Validation AUC: 0.22752910597693438
Validation class accuracies: [0.7011494252873564, 0.3256880733944954]
TARGET: 0
target metric(test auc): 0.22752910597693438
Lr has been adjusted to 7.499999628635123e-05
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 4 epochs
Epoch 10/40
263/263 - 515s - loss: 0.6446 - accuracy: 0.7016 - val_loss: 0.7050 - val_accuracy: 0.5515
Confusion matrix: 
 [[497 373]
 [115 103]]
Validation f1: 29.68
Validation accuracy: 55.15
Validation recall: 47.25
Validation precision: 21.64
Validation AUC: 0.2364376855918749
Validation class accuracies: [0.5712643678160919, 0.4724770642201835]
TARGET: 0
target metric(test auc): 0.2364376855918749
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 5 epochs
Saving model...
Epoch 11/40
263/263 - 516s - loss: 0.6354 - accuracy: 0.7135 - val_loss: 0.7331 - val_accuracy: 0.5294
Confusion matrix: 
 [[484 386]
 [126  92]]
Validation f1: 26.44
Validation accuracy: 52.94
Validation recall: 42.20
Validation precision: 19.25
Validation AUC: 0.20428609325125296
Validation class accuracies: [0.5563218390804597, 0.42201834862385323]
TARGET: 0
target metric(test auc): 0.20428609325125296
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 6 epochs
Epoch 12/40
263/263 - 515s - loss: 0.6281 - accuracy: 0.7378 - val_loss: 0.6798 - val_accuracy: 0.7252
Confusion matrix: 
 [[759 111]
 [188  30]]
Validation f1: 16.71
Validation accuracy: 72.52
Validation recall: 13.76
Validation precision: 21.28
Validation AUC: 0.21699375675773408
Validation class accuracies: [0.8724137931034482, 0.13761467889908258]
TARGET: 0
target metric(test auc): 0.21699375675773408
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 7 epochs
Epoch 13/40
263/263 - 516s - loss: 0.6199 - accuracy: 0.7636 - val_loss: 0.7184 - val_accuracy: 0.5800
Confusion matrix: 
 [[534 336]
 [121  97]]
Validation f1: 29.80
Validation accuracy: 58.00
Validation recall: 44.50
Validation precision: 22.40
Validation AUC: 0.2335584988838073
Validation class accuracies: [0.6137931034482759, 0.44495412844036697]
TARGET: 0
target metric(test auc): 0.2335584988838073
Lr has been adjusted to 5.624999903375283e-05
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 8 epochs
Epoch 14/40
263/263 - 516s - loss: 0.6106 - accuracy: 0.7798 - val_loss: 0.7714 - val_accuracy: 0.4476
Confusion matrix: 
 [[369 501]
 [100 118]]
Validation f1: 28.20
Validation accuracy: 44.76
Validation recall: 54.13
Validation precision: 19.06
Validation AUC: 0.20180910939360475
Validation class accuracies: [0.4241379310344828, 0.5412844036697247]
TARGET: 0
target metric(test auc): 0.20180910939360475
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 9 epochs
Epoch 15/40
263/263 - 516s - loss: 0.5993 - accuracy: 0.8082 - val_loss: 0.6997 - val_accuracy: 0.6838
Confusion matrix: 
 [[704 166]
 [178  40]]
Validation f1: 18.87
Validation accuracy: 68.38
Validation recall: 18.35
Validation precision: 19.42
Validation AUC: 0.2178872442101067
Validation class accuracies: [0.8091954022988506, 0.1834862385321101]
TARGET: 0
target metric(test auc): 0.2178872442101067
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 10 epochs
Epoch 16/40
263/263 - 516s - loss: 0.5952 - accuracy: 0.8201 - val_loss: 0.6941 - val_accuracy: 0.7215
Confusion matrix: 
 [[756 114]
 [189  29]]
Validation f1: 16.07
Validation accuracy: 72.15
Validation recall: 13.30
Validation precision: 20.28
Validation AUC: 0.21020976805755948
Validation class accuracies: [0.8689655172413793, 0.13302752293577982]
TARGET: 0
target metric(test auc): 0.21020976805755948
The validation tracker metric at 0.2310239205849611 hasn't increased by 0.05 in 11 epochs
Epoch 17/40
263/263 - 516s - loss: 0.5862 - accuracy: 0.8456 - val_loss: 0.7429 - val_accuracy: 0.5496
Confusion matrix: 
 [[497 373]
 [117 101]]
Validation f1: 29.19
Validation accuracy: 54.96
Validation recall: 46.33
Validation precision: 21.31
Validation AUC: 0.22553725776316189
Validation class accuracies: [0.5712643678160919, 0.463302752293578]

The metrics for the epoch with the best target metric are: 
Best cm: [[497 373]
 [115 103]]
Best f1: 0.2968299711815562
Best accuracy: 0.5514705882352942
Best recall: 0.4724770642201835
Best precision: 0.21638655462184875
Best AUC: 0.2364376855918749
Best epoch: 10
TARGET: 0
target metric(test auc): 0.22553725776316189
Lr has been adjusted to 4.2187501094304025e-05
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 10
Starting...
CM: [[ 4 56]
 [ 0 15]]
F1: 0.3488372093023256
AUC: 0.6056338028169014
Accuracy: 0.25333333333333335
Precision: 0.2112676056338028
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2123__05_0047__v29__redo/validation_sheet_10.xls...
Done.
Epoch: 40
Starting...
CM: [[ 5 55]
 [ 1 14]]
F1: 0.33333333333333337
AUC: 0.5747826086956522
Accuracy: 0.25333333333333335
Precision: 0.2028985507246377
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2123__05_0047__v29__redo/validation_sheet_40.xls...
Done.
Epoch: 5
Starting...
CM: [[17 43]
 [ 3 12]]
F1: 0.34285714285714286
AUC: 0.5290909090909091
Accuracy: 0.38666666666666666
Precision: 0.21818181818181817
Recall: 0.8
Ended. Saving the Excel Sheet ../../new_cache/conv__2123__05_0047__v29__redo/validation_sheet_5.xls...
Done.
wandb: Waiting for W&B process to finish, PID 14029
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: | 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_004800-1hnkkhr4/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_004800-1hnkkhr4/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.84557
wandb:         val_accuracy 0.54963
wandb:             _runtime 9216
wandb:           _timestamp 1620703296
wandb:                _step 120
wandb:           train_loss 0.58623
wandb:             val_loss 0.74289
wandb:           val_recall 0.4633
wandb:        val_precision 0.21308
wandb:               val_f1 0.29191
wandb:              val_auc 0.22554
wandb:                   lr 6e-05
wandb:          best_val_f1 0.29683
wandb:    best_val_accuracy 0.55147
wandb:   best_val_precision 0.21639
wandb:      best_val_recall 0.47248
wandb:             best_auc 0.23644
wandb:           best_epoch 10
wandb:           best_bd_f1 0.34884
wandb:          best_bd_auc 0.60563
wandb:     best_bd_accuracy 0.25333
wandb:    best_bd_precision 0.21127
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 10
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▃▃▃▄▄▅▅▅▆▆▇▇█
wandb:     val_accuracy ███▇▆▄▇▅▅▃▃▇▄▁▆▆▃
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇█████
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▄▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇█████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▆▆▅▅▅▅▄▄▄▃▃▂▂▁▁
wandb:         val_loss ▁▁▁▃▄▃▂▃▅▅▆▄▅█▄▄▇
wandb:       val_recall ▁▁▁▂▄▄▂▃▅▇▆▃▇█▃▃▇
wandb:    val_precision ▁▁▁█▇▅▅▅▇▇▆▇▇▆▆▇▇
wandb:           val_f1 ▁▁▁▅▆▅▃▄▇█▇▅██▅▅█
wandb:          val_auc ▂█▄▄▅▂▂▁▅▆▃▄▅▃▄▃▅
wandb:               lr █████████▄▄▄▄▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 2 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2123: https://wandb.ai/arachid1/tensorboard-integration/runs/1hnkkhr4


 See logs at ../../new_cache/conv__2123__05_0047__v29__redo/logs/