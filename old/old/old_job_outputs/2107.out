Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2107
Description:  mod9_newparams
2021-05-09 00:36:02.948997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 00:36:06.125476: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 00:36:06.126660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-09 00:36:06.141191: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:06.142331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 00:36:06.142385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 00:36:06.147913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 00:36:06.148075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 00:36:06.149774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 00:36:06.150252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 00:36:06.151929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 00:36:06.153355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 00:36:06.153604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 00:36:06.153835: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:06.155106: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:06.156164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2107.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2107__05_0036__v29__mod9_newparams/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 1), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 5, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 1.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run worldly-dew-210
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/25oaogga
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_003606-25oaogga
wandb: Run `wandb offline` to turn off syncing.
2021-05-09 00:36:12.416104: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-09 00:36:12.416498: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:12.417367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-09 00:36:12.417435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 00:36:12.417526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 00:36:12.417560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 00:36:12.417595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-09 00:36:12.417626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-09 00:36:12.417679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-09 00:36:12.417709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-09 00:36:12.417740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-09 00:36:12.417875: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:12.418798: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:12.419543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-09 00:36:12.419601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-09 00:36:13.463489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-09 00:36:13.463547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-09 00:36:13.463566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-09 00:36:13.463990: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:13.465284: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:13.466482: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-09 00:36:13.467471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-09 00:37:05.094335: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-09 00:37:05.096363: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-09 00:37:09.286949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-09 00:37:10.258629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-09 00:37:10.282734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
Epoch 1/40
263/263 - 530s - loss: 0.7464 - accuracy: 0.5739 - val_loss: 0.6471 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.19536022855853924
Validation class accuracies: [1.0, 0.0]
Epoch 2/40
263/263 - 519s - loss: 0.6860 - accuracy: 0.5977 - val_loss: 0.5821 - val_accuracy: 0.7886
Confusion matrix: 
 [[852  18]
 [212   6]]
Validation f1: 4.96
Validation accuracy: 78.86
Validation recall: 2.75
Validation precision: 25.00
Validation AUC: 0.18359014946237445
Validation class accuracies: [0.9793103448275862, 0.027522935779816515]
Epoch 3/40
263/263 - 518s - loss: 0.6809 - accuracy: 0.6082 - val_loss: 0.6721 - val_accuracy: 0.7114
Confusion matrix: 
 [[744 126]
 [188  30]]
Validation f1: 16.04
Validation accuracy: 71.14
Validation recall: 13.76
Validation precision: 19.23
Validation AUC: 0.221242397806015
Validation class accuracies: [0.8551724137931035, 0.13761467889908258]
Epoch 4/40
263/263 - 518s - loss: 0.6846 - accuracy: 0.5646 - val_loss: 0.9463 - val_accuracy: 0.7868
Confusion matrix: 
 [[855  15]
 [217   1]]
Validation f1: 0.85
Validation accuracy: 78.68
Validation recall: 0.46
Validation precision: 6.25
Validation AUC: 0.21310330693689955
Validation class accuracies: [0.9827586206896551, 0.0045871559633027525]
Epoch 5/40
263/263 - 520s - loss: 0.6744 - accuracy: 0.6046 - val_loss: 0.5922 - val_accuracy: 0.7215
Confusion matrix: 
 [[734 136]
 [167  51]]
Validation f1: 25.19
Validation accuracy: 72.15
Validation recall: 23.39
Validation precision: 27.27
Validation AUC: 0.24874186979016696
Validation class accuracies: [0.8436781609195402, 0.23394495412844038]
Saving model...
Epoch 6/40
263/263 - 518s - loss: 0.6756 - accuracy: 0.5801 - val_loss: 0.6667 - val_accuracy: 0.6691
Confusion matrix: 
 [[669 201]
 [159  59]]
Validation f1: 24.69
Validation accuracy: 66.91
Validation recall: 27.06
Validation precision: 22.69
Validation AUC: 0.22109402998993316
Validation class accuracies: [0.7689655172413793, 0.2706422018348624]
The validation tracker metric at 0.2518518518518518 hasn't increased by 0.01 in 1 epochs
Epoch 7/40
263/263 - 518s - loss: 0.6712 - accuracy: 0.5958 - val_loss: 0.5797 - val_accuracy: 0.7629
Confusion matrix: 
 [[810  60]
 [198  20]]
Validation f1: 13.42
Validation accuracy: 76.29
Validation recall: 9.17
Validation precision: 25.00
Validation AUC: 0.2339251164851623
Validation class accuracies: [0.9310344827586207, 0.09174311926605505]
The validation tracker metric at 0.2518518518518518 hasn't increased by 0.01 in 2 epochs
Epoch 8/40
263/263 - 519s - loss: 0.6674 - accuracy: 0.6027 - val_loss: 0.6937 - val_accuracy: 0.5083
Confusion matrix: 
 [[440 430]
 [105 113]]
Validation f1: 29.70
Validation accuracy: 50.83
Validation recall: 51.83
Validation precision: 20.81
Validation AUC: 0.19691991911703322
Validation class accuracies: [0.5057471264367817, 0.518348623853211]
Saving model...
Epoch 9/40
263/263 - 519s - loss: 0.6593 - accuracy: 0.6061 - val_loss: 0.5557 - val_accuracy: 0.7537
Confusion matrix: 
 [[802  68]
 [200  18]]
Validation f1: 11.84
Validation accuracy: 75.37
Validation recall: 8.26
Validation precision: 20.93
Validation AUC: 0.23298265553354192
Validation class accuracies: [0.9218390804597701, 0.08256880733944955]
The validation tracker metric at 0.29697766097240474 hasn't increased by 0.01 in 1 epochs
Epoch 10/40
263/263 - 521s - loss: 0.6587 - accuracy: 0.6001 - val_loss: 0.5535 - val_accuracy: 0.7877
Confusion matrix: 
 [[854  16]
 [215   3]]
Validation f1: 2.53
Validation accuracy: 78.77
Validation recall: 1.38
Validation precision: 15.79
Validation AUC: 0.22068541357312035
Validation class accuracies: [0.9816091954022989, 0.013761467889908258]
The validation tracker metric at 0.29697766097240474 hasn't increased by 0.01 in 2 epochs
Epoch 11/40
263/263 - 519s - loss: 0.6537 - accuracy: 0.6161 - val_loss: 0.6619 - val_accuracy: 0.6443
Confusion matrix: 
 [[627 243]
 [144  74]]
Validation f1: 27.66
Validation accuracy: 64.43
Validation recall: 33.94
Validation precision: 23.34
Validation AUC: 0.23171728174172845
Validation class accuracies: [0.7206896551724138, 0.3394495412844037]
The validation tracker metric at 0.29697766097240474 hasn't increased by 0.01 in 3 epochs
Epoch 12/40
263/263 - 520s - loss: 0.6552 - accuracy: 0.6108 - val_loss: 0.6804 - val_accuracy: 0.5772
Confusion matrix: 
 [[539 331]
 [129  89]]
Validation f1: 27.90
Validation accuracy: 57.72
Validation recall: 40.83
Validation precision: 21.19
Validation AUC: 0.20298940790487352
Validation class accuracies: [0.6195402298850575, 0.40825688073394495]
The validation tracker metric at 0.29697766097240474 hasn't increased by 0.01 in 4 epochs
Epoch 13/40
263/263 - 520s - loss: 0.6448 - accuracy: 0.6268 - val_loss: 0.5655 - val_accuracy: 0.7546
Confusion matrix: 
 [[802  68]
 [199  19]]
Validation f1: 12.46
Validation accuracy: 75.46
Validation recall: 8.72
Validation precision: 21.84
Validation AUC: 0.20749043947250306
Validation class accuracies: [0.9218390804597701, 0.0871559633027523]
Lr has been adjusted to 0.0005000000237487257
The validation tracker metric at 0.29697766097240474 hasn't increased by 0.01 in 5 epochs
Epoch 14/40
263/263 - 514s - loss: 0.6274 - accuracy: 0.6380 - val_loss: 0.7911 - val_accuracy: 0.4991
Confusion matrix: 
 [[404 466]
 [ 79 139]]
Validation f1: 33.78
Validation accuracy: 49.91
Validation recall: 63.76
Validation precision: 22.98
Validation AUC: 0.23220246459535626
Validation class accuracies: [0.46436781609195404, 0.6376146788990825]
Saving model...
Epoch 15/40
263/263 - 514s - loss: 0.6212 - accuracy: 0.6563 - val_loss: 0.7484 - val_accuracy: 0.5368
Confusion matrix: 
 [[478 392]
 [112 106]]
Validation f1: 29.61
Validation accuracy: 53.68
Validation recall: 48.62
Validation precision: 21.29
Validation AUC: 0.22089116192927039
Validation class accuracies: [0.5494252873563218, 0.48623853211009177]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 1 epochs
Epoch 16/40
263/263 - 514s - loss: 0.6170 - accuracy: 0.6709 - val_loss: 0.6104 - val_accuracy: 0.7050
Confusion matrix: 
 [[732 138]
 [183  35]]
Validation f1: 17.90
Validation accuracy: 70.50
Validation recall: 16.06
Validation precision: 20.23
Validation AUC: 0.19709132724130424
Validation class accuracies: [0.8413793103448276, 0.16055045871559634]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 2 epochs
Epoch 17/40
263/263 - 515s - loss: 0.6076 - accuracy: 0.6737 - val_loss: 0.6272 - val_accuracy: 0.6480
Confusion matrix: 
 [[644 226]
 [157  61]]
Validation f1: 24.16
Validation accuracy: 64.80
Validation recall: 27.98
Validation precision: 21.25
Validation AUC: 0.21292379428624136
Validation class accuracies: [0.7402298850574712, 0.2798165137614679]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 3 epochs
Epoch 18/40
263/263 - 514s - loss: 0.6017 - accuracy: 0.6799 - val_loss: 0.7106 - val_accuracy: 0.5754
Confusion matrix: 
 [[533 337]
 [125  93]]
Validation f1: 28.70
Validation accuracy: 57.54
Validation recall: 42.66
Validation precision: 21.63
Validation AUC: 0.2184088959063284
Validation class accuracies: [0.6126436781609196, 0.42660550458715596]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 4 epochs
Epoch 19/40
263/263 - 513s - loss: 0.5890 - accuracy: 0.6823 - val_loss: 0.9784 - val_accuracy: 0.4733
Confusion matrix: 
 [[374 496]
 [ 77 141]]
Validation f1: 32.98
Validation accuracy: 47.33
Validation recall: 64.68
Validation precision: 22.14
Validation AUC: 0.22142880822513097
Validation class accuracies: [0.4298850574712644, 0.6467889908256881]
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 5 epochs
Epoch 20/40
263/263 - 513s - loss: 0.5685 - accuracy: 0.7042 - val_loss: 0.8609 - val_accuracy: 0.4844
Confusion matrix: 
 [[404 466]
 [ 95 123]]
Validation f1: 30.48
Validation accuracy: 48.44
Validation recall: 56.42
Validation precision: 20.88
Validation AUC: 0.21547104033411213
Validation class accuracies: [0.46436781609195404, 0.5642201834862385]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 6 epochs
Epoch 21/40
263/263 - 515s - loss: 0.5590 - accuracy: 0.7054 - val_loss: 0.8604 - val_accuracy: 0.4715
Confusion matrix: 
 [[394 476]
 [ 99 119]]
Validation f1: 29.27
Validation accuracy: 47.15
Validation recall: 54.59
Validation precision: 20.00
Validation AUC: 0.21047587407018242
Validation class accuracies: [0.4528735632183908, 0.5458715596330275]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 7 epochs
Epoch 22/40
263/263 - 514s - loss: 0.5478 - accuracy: 0.7071 - val_loss: 0.8291 - val_accuracy: 0.5156
Confusion matrix: 
 [[466 404]
 [123  95]]
Validation f1: 26.50
Validation accuracy: 51.56
Validation recall: 43.58
Validation precision: 19.04
Validation AUC: 0.20108185922190422
Validation class accuracies: [0.535632183908046, 0.43577981651376146]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 8 epochs
Epoch 23/40
263/263 - 514s - loss: 0.5374 - accuracy: 0.7228 - val_loss: 0.7465 - val_accuracy: 0.5634
Confusion matrix: 
 [[523 347]
 [128  90]]
Validation f1: 27.48
Validation accuracy: 56.34
Validation recall: 41.28
Validation precision: 20.59
Validation AUC: 0.20052494492195702
Validation class accuracies: [0.6011494252873564, 0.41284403669724773]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 9 epochs
Epoch 24/40
263/263 - 514s - loss: 0.5273 - accuracy: 0.7257 - val_loss: 0.8108 - val_accuracy: 0.5634
Confusion matrix: 
 [[516 354]
 [121  97]]
Validation f1: 29.00
Validation accuracy: 56.34
Validation recall: 44.50
Validation precision: 21.51
Validation AUC: 0.2040374712443291
Validation class accuracies: [0.593103448275862, 0.44495412844036697]
Lr has been adjusted to 0.0001250000059371814
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 10 epochs
Epoch 25/40
263/263 - 514s - loss: 0.5124 - accuracy: 0.7312 - val_loss: 0.8542 - val_accuracy: 0.5257
Confusion matrix: 
 [[473 397]
 [119  99]]
Validation f1: 27.73
Validation accuracy: 52.57
Validation recall: 45.41
Validation precision: 19.96
Validation AUC: 0.20200067765695912
Validation class accuracies: [0.5436781609195402, 0.4541284403669725]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 11 epochs
Epoch 26/40
263/263 - 515s - loss: 0.5001 - accuracy: 0.7424 - val_loss: 0.8298 - val_accuracy: 0.5322
Confusion matrix: 
 [[487 383]
 [126  92]]
Validation f1: 26.55
Validation accuracy: 53.22
Validation recall: 42.20
Validation precision: 19.37
Validation AUC: 0.19729972450234567
Validation class accuracies: [0.5597701149425287, 0.42201834862385323]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 12 epochs
Epoch 27/40
263/263 - 513s - loss: 0.4929 - accuracy: 0.7405 - val_loss: 0.7992 - val_accuracy: 0.5910
Confusion matrix: 
 [[570 300]
 [145  73]]
Validation f1: 24.70
Validation accuracy: 59.10
Validation recall: 33.49
Validation precision: 19.57
Validation AUC: 0.20341015950686325
Validation class accuracies: [0.6551724137931034, 0.3348623853211009]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 13 epochs
Epoch 28/40
263/263 - 514s - loss: 0.4868 - accuracy: 0.7438 - val_loss: 0.8430 - val_accuracy: 0.5763
Confusion matrix: 
 [[552 318]
 [143  75]]
Validation f1: 24.55
Validation accuracy: 57.63
Validation recall: 34.40
Validation precision: 19.08
Validation AUC: 0.19725990145715167
Validation class accuracies: [0.6344827586206897, 0.3440366972477064]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 14 epochs
Epoch 29/40
263/263 - 516s - loss: 0.4757 - accuracy: 0.7483 - val_loss: 0.9255 - val_accuracy: 0.5377
Confusion matrix: 
 [[494 376]
 [127  91]]
Validation f1: 26.57
Validation accuracy: 53.77
Validation recall: 41.74
Validation precision: 19.49
Validation AUC: 0.2069052578491438
Validation class accuracies: [0.5678160919540229, 0.41743119266055045]
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 15 epochs
Epoch 30/40
263/263 - 514s - loss: 0.4693 - accuracy: 0.7657 - val_loss: 0.9974 - val_accuracy: 0.4798
Confusion matrix: 
 [[412 458]
 [108 110]]
Validation f1: 27.99
Validation accuracy: 47.98
Validation recall: 50.46
Validation precision: 19.37
Validation AUC: 0.20758241203288474
Validation class accuracies: [0.4735632183908046, 0.5045871559633027]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 16 epochs
Epoch 31/40
263/263 - 514s - loss: 0.4662 - accuracy: 0.7641 - val_loss: 0.9626 - val_accuracy: 0.5046
Confusion matrix: 
 [[448 422]
 [117 101]]
Validation f1: 27.26
Validation accuracy: 50.46
Validation recall: 46.33
Validation precision: 19.31
Validation AUC: 0.20310366757090736
Validation class accuracies: [0.5149425287356322, 0.463302752293578]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 17 epochs
Epoch 32/40
263/263 - 514s - loss: 0.4665 - accuracy: 0.7593 - val_loss: 0.9112 - val_accuracy: 0.5248
Confusion matrix: 
 [[483 387]
 [130  88]]
Validation f1: 25.40
Validation accuracy: 52.48
Validation recall: 40.37
Validation precision: 18.53
Validation AUC: 0.20110763712633
Validation class accuracies: [0.5551724137931034, 0.4036697247706422]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 18 epochs
Epoch 33/40
263/263 - 522s - loss: 0.4607 - accuracy: 0.7700 - val_loss: 0.9762 - val_accuracy: 0.5110
Confusion matrix: 
 [[447 423]
 [109 109]]
Validation f1: 29.07
Validation accuracy: 51.10
Validation recall: 50.00
Validation precision: 20.49
Validation AUC: 0.20828827578047937
Validation class accuracies: [0.5137931034482759, 0.5]
The validation tracker metric at 0.3377885783718104 hasn't increased by 0.01 in 19 epochs
Epoch 34/40
263/263 - 521s - loss: 0.4610 - accuracy: 0.7700 - val_loss: 1.0520 - val_accuracy: 0.4779
Confusion matrix: 
 [[396 474]
 [ 94 124]]
Validation f1: 30.39
Validation accuracy: 47.79
Validation recall: 56.88
Validation precision: 20.74
Validation AUC: 0.21310745453632846
Validation class accuracies: [0.45517241379310347, 0.5688073394495413]

The metrics for the epoch with the best target metric are: 
Best cm: [[404 466]
 [ 79 139]]
Best f1: 0.3377885783718104
Best accuracy: 0.4990808823529412
Best recall: 0.6376146788990825
Best precision: 0.22975206611570248
Best AUC: 0.23220246459535626
Best epoch: 13
Lr has been adjusted to 3.125000148429535e-05
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 4
Starting...
F1: 0.3548387096774194
Accuracy: 0.4666666666666667
Precision: 0.23404255319148937
Recall: 0.7333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2107__05_0036__v29__mod9_newparams/validation_sheet_4.xls...
Done.
Epoch: 40
Starting...
F1: 0.3370786516853933
Accuracy: 0.21333333333333335
Precision: 0.20270270270270271
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2107__05_0036__v29__mod9_newparams/validation_sheet_40.xls...
Done.
Epoch: 13
Starting...
F1: 0.3488372093023256
Accuracy: 0.25333333333333335
Precision: 0.2112676056338028
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2107__05_0036__v29__mod9_newparams/validation_sheet_13.xls...
Done.
Epoch: 7
Starting...
F1: 0.3294117647058824
Accuracy: 0.24
Precision: 0.2
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2107__05_0036__v29__mod9_newparams/validation_sheet_7.xls...
Done.
wandb: Waiting for W&B process to finish, PID 3366
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_003606-25oaogga/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210509_003606-25oaogga/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.77002
wandb:         val_accuracy 0.47794
wandb:             _runtime 18395
wandb:           _timestamp 1620538961
wandb:                _step 240
wandb:           train_loss 0.46103
wandb:             val_loss 1.05204
wandb:           val_recall 0.56881
wandb:        val_precision 0.20736
wandb:               val_f1 0.30392
wandb:              val_auc 0.21311
wandb:                   lr 6e-05
wandb:          best_val_f1 0.33779
wandb:    best_val_accuracy 0.49908
wandb:   best_val_precision 0.22975
wandb:      best_val_recall 0.63761
wandb:             best_auc 0.2322
wandb:           best_epoch 13
wandb:           best_bd_f1 0.35484
wandb:     best_bd_accuracy 0.46667
wandb:    best_bd_precision 0.23404
wandb:       best_bd_recall 0.73333
wandb:        best_bd_epoch 4
wandb: Run history:
wandb:   train_accuracy ▁▂▂▁▂▂▂▂▂▂▃▃▃▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇█████
wandb:     val_accuracy ██▆█▆▅▇▂▇█▅▃▇▂▂▆▅▃▁▁▁▂▃▃▂▂▄▃▂▁▂▂▂▁
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▇▆▆▆▆▆▆▆▆▆▆▆▅▅▅▅▄▄▄▃▃▃▃▂▂▂▂▁▁▁▁▁▁
wandb:         val_loss ▂▁▃▇▂▃▁▃▁▁▃▃▁▄▄▂▂▃▇▅▅▅▄▅▅▅▄▅▆▇▇▆▇█
wandb:       val_recall ▁▁▂▁▄▄▂▇▂▁▅▅▂█▆▃▄▆█▇▇▆▅▆▆▆▅▅▆▆▆▅▆▇
wandb:    val_precision ▁▇▆▃█▇▇▆▆▅▇▆▇▇▆▆▆▇▇▆▆▆▆▇▆▆▆▆▆▆▆▆▆▆
wandb:           val_f1 ▁▂▄▁▆▆▄▇▃▂▇▇▄█▇▅▆▇█▇▇▆▇▇▇▇▆▆▇▇▇▆▇▇
wandb:          val_auc ▂▁▅▄█▅▆▂▆▅▆▃▄▆▅▂▄▅▅▄▄▃▃▃▃▂▃▂▄▄▃▃▄▄
wandb:               lr █████████████▄▄▄▄▄▄▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 3 media file(s), 3 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced worldly-dew-210: https://wandb.ai/arachid1/tensorboard-integration/runs/25oaogga


 See logs at ../../new_cache/conv__2107__05_0036__v29__mod9_newparams/logs/