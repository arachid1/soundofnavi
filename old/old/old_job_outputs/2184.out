Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2184
Description:  augmentation_job
2021-06-02 23:23:20.667038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:18: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-02 23:23:22.786716: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-02 23:23:22.787659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-02 23:23:22.800456: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:23:22.801189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-02 23:23:22.801215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-02 23:23:22.804608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-02 23:23:22.804678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-02 23:23:22.805692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-02 23:23:22.805955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-02 23:23:22.806916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-02 23:23:22.807764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-02 23:23:22.807908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-02 23:23:22.808013: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:23:22.808718: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:23:22.809349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2184.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2184__06_2322__v29__augmentation_job
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 80, 'FACTOR': 0.5, 'PATIENCE': 4, 'MIN_LR': 1e-05, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 25, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 350, 'WAV_PATH': 'v36,v37,v38'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 500, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 1}
-----------------------
Collecting Variables...
All variables have been collected.
wandb: wandb version 0.10.31 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2184
wandb: â­ï¸ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: ðŸš€ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/kg9stg8v
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210602_232323-kg9stg8v
wandb: Run `wandb offline` to turn off syncing.
2021-06-02 23:26:38.087096: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-02 23:26:38.087403: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:26:38.088202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-02 23:26:38.088257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-02 23:26:38.088336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-02 23:26:38.088359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-02 23:26:38.088383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-02 23:26:38.088405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-02 23:26:38.088427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-02 23:26:38.088450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-02 23:26:38.088471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-02 23:26:38.088568: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:26:38.089288: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:26:38.089926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-02 23:26:38.090000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-02 23:26:38.782628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-02 23:26:38.782675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-02 23:26:38.782684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-02 23:26:38.782987: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:26:38.783805: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:26:38.784519: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-02 23:26:38.785189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)

Original number of folders: 453
Original length of train samples: 4212
Augmenting audios...
Augmenting audios...
Augmenting audios...
Length of training samples after audio augmentation: 5262
Augmenting spectrograms...
3 functions are being applied
The number of elements in the augmentation folder is: 500
Length of training samples after spec augmentation: 5762
The initial learning rate for this job is: 0.0007309961818812912
With concat = False and six = False, size of training set: 5762...
...and size of validation set: 1072
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
2021-06-02 23:26:40.044973: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-02 23:26:40.046688: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-02 23:26:40.368759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-02 23:26:42.160139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-02 23:26:42.616001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/80
361/361 - 506s - loss: 0.6294 - accuracy: 0.7319 - val_loss: 0.5819 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3306500783566359
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 2/80
361/361 - 506s - loss: 0.5694 - accuracy: 0.7421 - val_loss: 0.6105 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23460130854208675
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 3/80
361/361 - 505s - loss: 0.5644 - accuracy: 0.7416 - val_loss: 0.6494 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24317638363430716
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 4/80
361/361 - 506s - loss: 0.5661 - accuracy: 0.7426 - val_loss: 0.7190 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.3339156265913069
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 5/80
361/361 - 506s - loss: 0.5642 - accuracy: 0.7445 - val_loss: 0.7368 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.32605866613771406
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 6/80
361/361 - 506s - loss: 0.5603 - accuracy: 0.7447 - val_loss: 0.5985 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24501097782263392
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 7/80
361/361 - 505s - loss: 0.5603 - accuracy: 0.7456 - val_loss: 0.5849 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.25562424939117445
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 8/80
361/361 - 505s - loss: 0.5608 - accuracy: 0.7445 - val_loss: 12.4338 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.6209927042968768
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 9/80
361/361 - 505s - loss: 0.5577 - accuracy: 0.7444 - val_loss: 4.2466 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.3411257559544459
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 10/80
361/361 - 505s - loss: 0.5548 - accuracy: 0.7444 - val_loss: 1.4408 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.224738257906655
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 11/80
361/361 - 505s - loss: 0.5516 - accuracy: 0.7445 - val_loss: 0.7013 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.33645465805776753
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 12/80
361/361 - 505s - loss: 0.5503 - accuracy: 0.7463 - val_loss: 0.6020 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.245841513468304
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 13/80
361/361 - 505s - loss: 0.5488 - accuracy: 0.7447 - val_loss: 5.2863 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.3382120396104265
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 14/80
361/361 - 505s - loss: 0.5469 - accuracy: 0.7494 - val_loss: 0.8429 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.27823690773233056
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 15/80
361/361 - 505s - loss: 0.5426 - accuracy: 0.7451 - val_loss: 1.3849 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.31407868941807743
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 16/80
361/361 - 505s - loss: 0.5449 - accuracy: 0.7452 - val_loss: 1.1745 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.2698810179099903
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 17/80
361/361 - 505s - loss: 0.5363 - accuracy: 0.7494 - val_loss: 1.1454 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.2949824253152278
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 18/80
361/361 - 505s - loss: 0.5270 - accuracy: 0.7562 - val_loss: 0.8314 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.2337437845562369
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 19/80
361/361 - 505s - loss: 0.5259 - accuracy: 0.7523 - val_loss: 0.6174 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 73.13
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3068014087034724
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 20/80
361/361 - 505s - loss: 0.5225 - accuracy: 0.7567 - val_loss: 12.0322 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.2936183399466621
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 21/80
361/361 - 505s - loss: 0.5100 - accuracy: 0.7640 - val_loss: 1.8217 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31865089509869093
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 22/80
361/361 - 505s - loss: 0.5045 - accuracy: 0.7697 - val_loss: 1.3602 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.22452263082597024
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 23/80
361/361 - 505s - loss: 0.4919 - accuracy: 0.7730 - val_loss: 2.2327 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.33822447414444345
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 24/80
361/361 - 505s - loss: 0.4748 - accuracy: 0.7850 - val_loss: 3.8012 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.22164635577852462
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 25/80
361/361 - 505s - loss: 0.4539 - accuracy: 0.7940 - val_loss: 4.5949 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.21412078555932756
Validation class accuracies: [0.0, 1.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 26/80
361/361 - 505s - loss: 0.4455 - accuracy: 0.7964 - val_loss: 1.2191 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3394502524121783
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 27/80
361/361 - 505s - loss: 0.4256 - accuracy: 0.8081 - val_loss: 4.7846 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.3357350816605382
Validation class accuracies: [1.0, 0.0]
TARGET: 1
The clause is activated.
The training is defaulting to either class.
Epoch 28/80
361/361 - 505s - loss: 0.4132 - accuracy: 0.8129 - val_loss: 5.5681 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.21312541418253422
Validation class accuracies: [0.0, 1.0]
local_gc_exec.sh: line 6: 19458 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2184__06_2322__v29__augmentation_job/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
