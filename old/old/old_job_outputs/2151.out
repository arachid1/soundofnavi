Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2151
Description:  mod9_MoE
2021-05-18 19:17:54.249222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 19:17:57.004622: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-18 19:17:57.005726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-18 19:17:57.060199: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:17:57.060988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-18 19:17:57.061024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 19:17:57.064858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 19:17:57.064994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 19:17:57.066213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-18 19:17:57.066603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-18 19:17:57.067699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-18 19:17:57.068664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-18 19:17:57.068847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-18 19:17:57.069014: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:17:57.069868: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:17:57.070616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2151.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2151
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2420cg7b
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_191757-2420cg7b
wandb: Run `wandb offline` to turn off syncing.
2021-05-18 19:18:03.122688: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-18 19:18:03.122970: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:18:03.123757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-18 19:18:03.123803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 19:18:03.123867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 19:18:03.123889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 19:18:03.123910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-18 19:18:03.123935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-18 19:18:03.123956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-18 19:18:03.123972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-18 19:18:03.123990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-18 19:18:03.124087: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:18:03.124804: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:18:03.125488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-18 19:18:03.125537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-18 19:18:03.906135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-18 19:18:03.906187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-18 19:18:03.906201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-18 19:18:03.906498: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:18:03.907356: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:18:03.908215: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-18 19:18:03.908956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-18 19:18:49.971645: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-18 19:18:49.973535: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
WARNING:tensorflow:Gradients do not exist for variables ['dense_mo_e/expert_bias:0', 'dense_mo_e/gating_bias:0'] when minimizing the loss.
WARNING:tensorflow:Gradients do not exist for variables ['dense_mo_e/expert_bias:0', 'dense_mo_e/gating_bias:0'] when minimizing the loss.
2021-05-18 19:18:55.025191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-18 19:18:55.864120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-18 19:18:55.886729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense_mo_e (DenseMoE)           (None, 512)          1579014     global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         dense_mo_e[0][0]                 
==================================================================================================
Total params: 7,779,763
Trainable params: 7,738,253
Non-trainable params: 41,510
__________________________________________________________________________________________________
binary
Epoch 1/80
263/263 - 521s - loss: 0.8913 - accuracy: 0.6876 - val_loss: 0.5016 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24031721600111092
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
263/263 - 515s - loss: 0.5893 - accuracy: 0.7266 - val_loss: 0.5043 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24976422979704416
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
263/263 - 515s - loss: 0.5853 - accuracy: 0.7238 - val_loss: 0.5065 - val_accuracy: 0.7987
Confusion matrix: 
 [[868   2]
 [217   1]]
Validation f1: 0.90
Validation accuracy: 79.87
Validation recall: 0.46
Validation precision: 33.33
Validation AUC: 0.24690834743516912
Validation class accuracies: [0.9977011494252873, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.009049773755656108
column_sums: [1085    3]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
263/263 - 520s - loss: 0.5819 - accuracy: 0.7250 - val_loss: 0.5077 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation precision: 0.00
Validation AUC: 0.21106074262631655
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
263/263 - 517s - loss: 0.5787 - accuracy: 0.7266 - val_loss: 0.5855 - val_accuracy: 0.7463
Confusion matrix: 
 [[780  90]
 [186  32]]
Validation f1: 18.82
Validation accuracy: 74.63
Validation recall: 14.68
Validation precision: 26.23
Validation AUC: 0.21492259898637686
Validation class accuracies: [0.896551724137931, 0.14678899082568808]
TARGET: 1
target metric(test f1): 0.18823529411764708
column_sums: [966 122]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 6/80
263/263 - 516s - loss: 0.5793 - accuracy: 0.7255 - val_loss: 0.5109 - val_accuracy: 0.7960
Confusion matrix: 
 [[864   6]
 [216   2]]
Validation f1: 1.77
Validation accuracy: 79.60
Validation recall: 0.92
Validation precision: 25.00
Validation AUC: 0.2116957114290812
Validation class accuracies: [0.993103448275862, 0.009174311926605505]
TARGET: 1
target metric(test f1): 0.017699115044247787
column_sums: [1080    8]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
263/263 - 515s - loss: 0.5736 - accuracy: 0.7238 - val_loss: 0.5171 - val_accuracy: 0.7914
Confusion matrix: 
 [[853  17]
 [210   8]]
Validation f1: 6.58
Validation accuracy: 79.14
Validation recall: 3.67
Validation precision: 32.00
Validation AUC: 0.23053115576928118
Validation class accuracies: [0.9804597701149426, 0.03669724770642202]
TARGET: 1
target metric(test f1): 0.06584362139917696
column_sums: [1063   25]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
263/263 - 514s - loss: 0.5699 - accuracy: 0.7235 - val_loss: 0.5220 - val_accuracy: 0.7923
Confusion matrix: 
 [[861   9]
 [217   1]]
Validation f1: 0.88
Validation accuracy: 79.23
Validation recall: 0.46
Validation precision: 10.00
Validation AUC: 0.19482976840463753
Validation class accuracies: [0.9896551724137931, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.008771929824561403
column_sums: [1078   10]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
263/263 - 517s - loss: 0.5675 - accuracy: 0.7264 - val_loss: 0.5193 - val_accuracy: 0.7950
Confusion matrix: 
 [[862   8]
 [215   3]]
Validation f1: 2.62
Validation accuracy: 79.50
Validation recall: 1.38
Validation precision: 27.27
Validation AUC: 0.21702920280340354
Validation class accuracies: [0.9908045977011494, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.026200873362445413
column_sums: [1077   11]
cm_sum: 1088
The training is defaulting to either class.
Epoch 10/80
263/263 - 516s - loss: 0.5688 - accuracy: 0.7259 - val_loss: 0.5132 - val_accuracy: 0.7987
Confusion matrix: 
 [[868   2]
 [217   1]]
Validation f1: 0.90
Validation accuracy: 79.87
Validation recall: 0.46
Validation precision: 33.33
Validation AUC: 0.19752053928080182
Validation class accuracies: [0.9977011494252873, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.009049773755656108
column_sums: [1085    3]
cm_sum: 1088
The training is defaulting to either class.
Epoch 11/80
263/263 - 516s - loss: 0.5612 - accuracy: 0.7247 - val_loss: 0.5251 - val_accuracy: 0.7812
Confusion matrix: 
 [[841  29]
 [209   9]]
Validation f1: 7.03
Validation accuracy: 78.12
Validation recall: 4.13
Validation precision: 23.68
Validation AUC: 0.21322975182128304
Validation class accuracies: [0.9666666666666667, 0.04128440366972477]
TARGET: 1
target metric(test f1): 0.0703125
column_sums: [1050   38]
cm_sum: 1088
The training is defaulting to either class.
Epoch 12/80
263/263 - 517s - loss: 0.5637 - accuracy: 0.7324 - val_loss: 0.5160 - val_accuracy: 0.7969
Confusion matrix: 
 [[864   6]
 [215   3]]
Validation f1: 2.64
Validation accuracy: 79.69
Validation recall: 1.38
Validation precision: 33.33
Validation AUC: 0.21286825482716049
Validation class accuracies: [0.993103448275862, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.026431718061674013
column_sums: [1079    9]
cm_sum: 1088
The training is defaulting to either class.
Epoch 13/80
263/263 - 515s - loss: 0.5573 - accuracy: 0.7319 - val_loss: 0.6093 - val_accuracy: 0.7987
Confusion matrix: 
 [[867   3]
 [216   2]]
Validation f1: 1.79
Validation accuracy: 79.87
Validation recall: 0.92
Validation precision: 40.00
Validation AUC: 0.21122729084802158
Validation class accuracies: [0.996551724137931, 0.009174311926605505]
TARGET: 1
target metric(test f1): 0.017937219730941704
column_sums: [1083    5]
cm_sum: 1088
The training is defaulting to either class.
Epoch 14/80
263/263 - 515s - loss: 0.5531 - accuracy: 0.7338 - val_loss: 0.5569 - val_accuracy: 0.7969
Confusion matrix: 
 [[863   7]
 [214   4]]
Validation f1: 3.49
Validation accuracy: 79.69
Validation recall: 1.83
Validation precision: 36.36
Validation AUC: 0.20342088996264623
Validation class accuracies: [0.9919540229885058, 0.01834862385321101]
TARGET: 1
target metric(test f1): 0.03493449781659389
column_sums: [1077   11]
cm_sum: 1088
The training is defaulting to either class.
Epoch 15/80
263/263 - 515s - loss: 0.5486 - accuracy: 0.7400 - val_loss: 0.6149 - val_accuracy: 0.7831
Confusion matrix: 
 [[846  24]
 [212   6]]
Validation f1: 4.84
Validation accuracy: 78.31
Validation recall: 2.75
Validation precision: 20.00
Validation AUC: 0.22961148286187327
Validation class accuracies: [0.9724137931034482, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.04838709677419355
column_sums: [1058   30]
cm_sum: 1088
The training is defaulting to either class.
Epoch 16/80
263/263 - 515s - loss: 0.5480 - accuracy: 0.7395 - val_loss: 0.5138 - val_accuracy: 0.7886
Confusion matrix: 
 [[852  18]
 [212   6]]
Validation f1: 4.96
Validation accuracy: 78.86
Validation recall: 2.75
Validation precision: 25.00
Validation AUC: 0.21456523398784194
Validation class accuracies: [0.9793103448275862, 0.027522935779816515]
TARGET: 1
target metric(test f1): 0.049586776859504134
column_sums: [1064   24]
cm_sum: 1088
The training is defaulting to either class.
Epoch 17/80
263/263 - 516s - loss: 0.5405 - accuracy: 0.7409 - val_loss: 0.5047 - val_accuracy: 0.7960
Confusion matrix: 
 [[866   4]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.60
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23094770322521596
Validation class accuracies: [0.9954022988505747, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1084    4]
cm_sum: 1088
The training is defaulting to either class.
Epoch 18/80
263/263 - 516s - loss: 0.5360 - accuracy: 0.7431 - val_loss: 0.6142 - val_accuracy: 0.7914
Confusion matrix: 
 [[860  10]
 [217   1]]
Validation f1: 0.87
Validation accuracy: 79.14
Validation recall: 0.46
Validation precision: 9.09
Validation AUC: 0.17250465372355203
Validation class accuracies: [0.9885057471264368, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.008733624454148473
column_sums: [1077   11]
cm_sum: 1088
The training is defaulting to either class.
Epoch 19/80
263/263 - 515s - loss: 0.5267 - accuracy: 0.7526 - val_loss: 0.5764 - val_accuracy: 0.7445
Confusion matrix: 
 [[784  86]
 [192  26]]
Validation f1: 15.76
Validation accuracy: 74.45
Validation recall: 11.93
Validation precision: 23.21
Validation AUC: 0.20741149840214873
Validation class accuracies: [0.9011494252873563, 0.11926605504587157]
TARGET: 1
target metric(test f1): 0.15757575757575756
column_sums: [976 112]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.18823529411764708 hasn't increased by 0 in 1 epochs
Epoch 20/80
263/263 - 514s - loss: 0.5166 - accuracy: 0.7495 - val_loss: 0.5705 - val_accuracy: 0.7619
Confusion matrix: 
 [[818  52]
 [207  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 7.83
Validation accuracy: 76.19
Validation recall: 5.05
Validation precision: 17.46
Validation AUC: 0.20425147171708674
Validation class accuracies: [0.9402298850574713, 0.05045871559633028]
TARGET: 1
target metric(test f1): 0.07829181494661923
column_sums: [1025   63]
cm_sum: 1088
The training is defaulting to either class.
Epoch 21/80
263/263 - 516s - loss: 0.5153 - accuracy: 0.7562 - val_loss: 0.6920 - val_accuracy: 0.6590
Confusion matrix: 
 [[622 248]
 [123  95]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 33.87
Validation accuracy: 65.90
Validation recall: 43.58
Validation precision: 27.70
Validation AUC: 0.26219621268083443
Validation class accuracies: [0.7149425287356321, 0.43577981651376146]
TARGET: 1
target metric(test f1): 0.3386809269162211
column_sums: [745 343]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 22/80
263/263 - 516s - loss: 0.4981 - accuracy: 0.7641 - val_loss: 0.5822 - val_accuracy: 0.7482
Confusion matrix: 
 [[803  67]
 [207  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 7.43
Validation accuracy: 74.82
Validation recall: 5.05
Validation precision: 14.10
Validation AUC: 0.1853120191035792
Validation class accuracies: [0.9229885057471264, 0.05045871559633028]
TARGET: 1
target metric(test f1): 0.07432432432432433
column_sums: [1010   78]
cm_sum: 1088
The training is defaulting to either class.
Epoch 23/80
263/263 - 516s - loss: 0.4894 - accuracy: 0.7662 - val_loss: 0.6109 - val_accuracy: 0.7022
Confusion matrix: 
 [[721 149]
 [175  43]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 20.98
Validation accuracy: 70.22
Validation recall: 19.72
Validation precision: 22.40
Validation AUC: 0.2015370917180322
Validation class accuracies: [0.828735632183908, 0.19724770642201836]
TARGET: 1
target metric(test f1): 0.20975609756097563
column_sums: [896 192]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 1 epochs
Epoch 24/80
263/263 - 516s - loss: 0.4762 - accuracy: 0.7757 - val_loss: 0.7245 - val_accuracy: 0.7362
Confusion matrix: 
 [[774  96]
 [191  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.84
Validation accuracy: 73.62
Validation recall: 12.39
Validation precision: 21.95
Validation AUC: 0.24158272536882983
Validation class accuracies: [0.8896551724137931, 0.12385321100917432]
TARGET: 1
target metric(test f1): 0.1583577712609971
column_sums: [965 123]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 2 epochs
Epoch 25/80
263/263 - 515s - loss: 0.4557 - accuracy: 0.7829 - val_loss: 0.6236 - val_accuracy: 0.7546
Confusion matrix: 
 [[802  68]
 [199  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 12.46
Validation accuracy: 75.46
Validation recall: 8.72
Validation precision: 21.84
Validation AUC: 0.20327431073085594
Validation class accuracies: [0.9218390804597701, 0.0871559633027523]
TARGET: 1
target metric(test f1): 0.12459016393442625
column_sums: [1001   87]
cm_sum: 1088
The training is defaulting to either class.
Epoch 26/80
263/263 - 518s - loss: 0.4317 - accuracy: 0.8027 - val_loss: 0.8100 - val_accuracy: 0.5331
Confusion matrix: 
 [[478 392]
 [116 102]]
Validation f1: 28.65
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 53.31
Validation recall: 46.79
Validation precision: 20.65
Validation AUC: 0.2167494863453837
Validation class accuracies: [0.5494252873563218, 0.46788990825688076]
TARGET: 1
target metric(test f1): 0.28651685393258425
column_sums: [594 494]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 3 epochs
Epoch 27/80
263/263 - 515s - loss: 0.4161 - accuracy: 0.8146 - val_loss: 0.6841 - val_accuracy: 0.7022
Confusion matrix: 
 [[736 134]
 [190  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 14.74
Validation accuracy: 70.22
Validation recall: 12.84
Validation precision: 17.28
Validation AUC: 0.19406868784704984
Validation class accuracies: [0.8459770114942529, 0.12844036697247707]
TARGET: 1
target metric(test f1): 0.14736842105263157
column_sums: [926 162]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 4 epochs
Epoch 28/80
263/263 - 516s - loss: 0.3461 - accuracy: 0.8449 - val_loss: 0.7176 - val_accuracy: 0.7482
Confusion matrix: 
 [[789  81]
 [193  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 15.43
Validation accuracy: 74.82
Validation recall: 11.47
Validation precision: 23.58
Validation AUC: 0.2377415417659342
Validation class accuracies: [0.906896551724138, 0.11467889908256881]
TARGET: 1
target metric(test f1): 0.15432098765432098
column_sums: [982 106]
cm_sum: 1088
The training is defaulting to either class.
Epoch 29/80
263/263 - 516s - loss: 0.3045 - accuracy: 0.8727 - val_loss: 0.8354 - val_accuracy: 0.6985
Confusion matrix: 
 [[720 150]
 [178  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 19.61
Validation accuracy: 69.85
Validation recall: 18.35
Validation precision: 21.05
Validation AUC: 0.2184154626325597
Validation class accuracies: [0.8275862068965517, 0.1834862385321101]
TARGET: 1
target metric(test f1): 0.19607843137254902
column_sums: [898 190]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 5 epochs
Epoch 30/80
263/263 - 516s - loss: 0.2932 - accuracy: 0.8720 - val_loss: 0.8323 - val_accuracy: 0.6949
Confusion matrix: 
 [[708 162]
 [170  48]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 22.43
Validation accuracy: 69.49
Validation recall: 22.02
Validation precision: 22.86
Validation AUC: 0.22416011605714656
Validation class accuracies: [0.8137931034482758, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.22429906542056077
column_sums: [878 210]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 6 epochs
Epoch 31/80
263/263 - 517s - loss: 0.2751 - accuracy: 0.8782 - val_loss: 0.8695 - val_accuracy: 0.7261
Confusion matrix: 
 [[759 111]
 [187  31]]
Validation f1: 17.22
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 72.61
Validation recall: 14.22
Validation precision: 21.83
Validation AUC: 0.22604737697208532
Validation class accuracies: [0.8724137931034482, 0.14220183486238533]
TARGET: 1
target metric(test f1): 0.17222222222222225
column_sums: [946 142]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 7 epochs
Epoch 32/80
263/263 - 515s - loss: 0.2634 - accuracy: 0.8849 - val_loss: 0.9571 - val_accuracy: 0.6838
Confusion matrix: 
 [[687 183]
 [161  57]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.89
Validation accuracy: 68.38
Validation recall: 26.15
Validation precision: 23.75
Validation AUC: 0.22313595232982994
Validation class accuracies: [0.7896551724137931, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.2489082969432314
column_sums: [848 240]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 8 epochs
Epoch 33/80
263/263 - 515s - loss: 0.2309 - accuracy: 0.9016 - val_loss: 1.0145 - val_accuracy: 0.6829
Confusion matrix: 
 [[686 184]
 [161  57]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.84
Validation accuracy: 68.29
Validation recall: 26.15
Validation precision: 23.65
Validation AUC: 0.2245694331126008
Validation class accuracies: [0.7885057471264367, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.24836601307189543
column_sums: [847 241]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 9 epochs
Epoch 34/80
263/263 - 517s - loss: 0.2258 - accuracy: 0.9092 - val_loss: 0.9895 - val_accuracy: 0.6893
Confusion matrix: 
 [[699 171]
 [167  51]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 23.18
Validation accuracy: 68.93
Validation recall: 23.39
Validation precision: 22.97
Validation AUC: 0.22982459632507707
Validation class accuracies: [0.803448275862069, 0.23394495412844038]
TARGET: 1
target metric(test f1): 0.2318181818181818
column_sums: [866 222]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 10 epochs
Epoch 35/80
263/263 - 515s - loss: 0.2228 - accuracy: 0.9061 - val_loss: 1.0134 - val_accuracy: 0.6903
Confusion matrix: 
 [[698 172]
 [165  53]]
Validation f1: 23.93
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 69.03
Validation recall: 24.31
Validation precision: 23.56
Validation AUC: 0.230368514541401
Validation class accuracies: [0.8022988505747126, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.23927765237020318
column_sums: [863 225]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 11 epochs
Epoch 36/80
263/263 - 516s - loss: 0.2316 - accuracy: 0.9030 - val_loss: 1.0548 - val_accuracy: 0.6737
Confusion matrix: 
 [[674 196]
 [159  59]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.95
Validation accuracy: 67.37
Validation recall: 27.06
Validation precision: 23.14
Validation AUC: 0.22657560453774167
Validation class accuracies: [0.774712643678161, 0.2706422018348624]
TARGET: 1
target metric(test f1): 0.24947145877378438
column_sums: [833 255]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 12 epochs
Epoch 37/80
263/263 - 516s - loss: 0.2113 - accuracy: 0.9125 - val_loss: 1.0548 - val_accuracy: 0.6811
Confusion matrix: 
 [[684 186]
 [161  57]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 24.73
Validation accuracy: 68.11
Validation recall: 26.15
Validation precision: 23.46
Validation AUC: 0.22583238898743072
Validation class accuracies: [0.7862068965517242, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.2472885032537961
column_sums: [845 243]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 13 epochs
Epoch 38/80
263/263 - 517s - loss: 0.2072 - accuracy: 0.9137 - val_loss: 1.0750 - val_accuracy: 0.6820
Confusion matrix: 
 [[683 187]
 [159  59]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.43
Validation accuracy: 68.20
Validation recall: 27.06
Validation precision: 23.98
Validation AUC: 0.22519999866178336
Validation class accuracies: [0.7850574712643679, 0.2706422018348624]
TARGET: 1
target metric(test f1): 0.2543103448275862
column_sums: [842 246]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 14 epochs
Epoch 39/80
263/263 - 513s - loss: 0.2159 - accuracy: 0.9087 - val_loss: 1.0729 - val_accuracy: 0.6847
Confusion matrix: 
 [[686 184]
 [159  59]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.60
Validation accuracy: 68.47
Validation recall: 27.06
Validation precision: 24.28
Validation AUC: 0.22511800803394472
Validation class accuracies: [0.7885057471264367, 0.2706422018348624]
TARGET: 1
target metric(test f1): 0.2559652928416486
column_sums: [845 243]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 15 epochs
Epoch 40/80
263/263 - 515s - loss: 0.2095 - accuracy: 0.9133 - val_loss: 1.0672 - val_accuracy: 0.6857
Confusion matrix: 
 [[689 181]
 [161  57]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.00
Validation accuracy: 68.57
Validation recall: 26.15
Validation precision: 23.95
Validation AUC: 0.2275701269274491
Validation class accuracies: [0.7919540229885057, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.25
column_sums: [850 238]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 16 epochs
Epoch 41/80
263/263 - 514s - loss: 0.2096 - accuracy: 0.9087 - val_loss: 1.0673 - val_accuracy: 0.6847
Confusion matrix: 
 [[686 184]
 [159  59]]
Validation f1: 25.60
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.47
Validation recall: 27.06
Validation precision: 24.28
Validation AUC: 0.22921212586749998
Validation class accuracies: [0.7885057471264367, 0.2706422018348624]
TARGET: 1
target metric(test f1): 0.2559652928416486
column_sums: [845 243]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 17 epochs
Epoch 42/80
263/263 - 517s - loss: 0.1941 - accuracy: 0.9202 - val_loss: 1.0617 - val_accuracy: 0.6875
Confusion matrix: 
 [[691 179]
 [161  57]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.11
Validation accuracy: 68.75
Validation recall: 26.15
Validation precision: 24.15
Validation AUC: 0.2274949214988664
Validation class accuracies: [0.7942528735632184, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.2511013215859031
column_sums: [852 236]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 18 epochs
Epoch 43/80
263/263 - 515s - loss: 0.1969 - accuracy: 0.9197 - val_loss: 1.0656 - val_accuracy: 0.6838
Confusion matrix: 
 [[687 183]
 [161  57]]
Validation f1: 24.89
Validation accuracy: 68.38
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 26.15
Validation precision: 23.75
Validation AUC: 0.22764298147779638
Validation class accuracies: [0.7896551724137931, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.2489082969432314
column_sums: [848 240]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 19 epochs
Epoch 44/80
263/263 - 517s - loss: 0.2134 - accuracy: 0.9121 - val_loss: 1.0670 - val_accuracy: 0.6857
Confusion matrix: 
 [[688 182]
 [160  58]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.33
Validation accuracy: 68.57
Validation recall: 26.61
Validation precision: 24.17
Validation AUC: 0.22638884601553105
Validation class accuracies: [0.7908045977011494, 0.26605504587155965]
TARGET: 1
target metric(test f1): 0.2532751091703057
column_sums: [848 240]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 20 epochs
Epoch 45/80
263/263 - 517s - loss: 0.2086 - accuracy: 0.9135 - val_loss: 1.0629 - val_accuracy: 0.6912
Confusion matrix: 
 [[695 175]
 [161  57]]
Validation f1: 25.33
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 69.12
Validation recall: 26.15
Validation precision: 24.57
Validation AUC: 0.2275182748929559
Validation class accuracies: [0.7988505747126436, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.2533333333333333
column_sums: [856 232]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 21 epochs
Epoch 46/80
263/263 - 518s - loss: 0.1994 - accuracy: 0.9197 - val_loss: 1.0569 - val_accuracy: 0.6903
Confusion matrix: 
 [[694 176]
 [161  57]]
Validation f1: 25.28
Validation accuracy: 69.03
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 26.15
Validation precision: 24.46
Validation AUC: 0.22741555546187903
Validation class accuracies: [0.7977011494252874, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.2527716186252772
column_sums: [855 233]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 22 epochs
Epoch 47/80
263/263 - 517s - loss: 0.2141 - accuracy: 0.9066 - val_loss: 1.0556 - val_accuracy: 0.6921
Confusion matrix: 
 [[697 173]
 [162  56]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 25.06
Validation accuracy: 69.21
Validation recall: 25.69
Validation precision: 24.45
Validation AUC: 0.22772278570174914
Validation class accuracies: [0.8011494252873563, 0.25688073394495414]
TARGET: 1
target metric(test f1): 0.25055928411633105
column_sums: [859 229]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 23 epochs
Epoch 48/80
263/263 - 517s - loss: 0.2109 - accuracy: 0.9116 - val_loss: 1.0678 - val_accuracy: 0.6884
Confusion matrix: 
 [[693 177]
 [162  56]]
Validation f1: 24.83
Validation accuracy: 68.84
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 25.69
Validation precision: 24.03
Validation AUC: 0.22641273163030645
Validation class accuracies: [0.7965517241379311, 0.25688073394495414]
TARGET: 1
target metric(test f1): 0.24833702882483372
column_sums: [855 233]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.3386809269162211 hasn't increased by 0 in 24 epochs
Epoch 49/80
263/263 - 517s - loss: 0.2030 - accuracy: 0.9171 - val_loss: 1.0545 - val_accuracy: 0.6903
Confusion matrix: 
 [[694 176]
 [161  57]]
Validation f1: 25.28
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 69.03
Validation recall: 26.15
Validation precision: 24.46
Validation AUC: 0.22690802204687588
Validation class accuracies: [0.7977011494252874, 0.26146788990825687]

The metrics for the epoch with the best target metric are: 
Best cm: [[622 248]
 [123  95]]
Best f1: 0.3386809269162211
Best accuracy: 0.6590073529411765
Best recall: 0.43577981651376146
Best precision: 0.27696793002915454
Best AUC: 0.26219621268083443
Best epoch: 21
TARGET: 1
target metric(test f1): 0.2527716186252772
column_sums: [855 233]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 21
Starting...
CM: [[12 48]
 [ 1 14]]
F1: 0.36363636363636365
AUC: 0.5862365591397849
Accuracy: 0.3466666666666667
Precision: 0.22580645161290322
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_21.xls...
Done.
Epoch: 21
Starting...
CM: [[26 34]
 [ 1 14]]
F1: 0.4444444444444445
AUC: 0.6191666666666668
Accuracy: 0.5333333333333333
Precision: 0.2916666666666667
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_21.xls...
Done.
Epoch: 21
Starting...
CM: [[41 19]
 [ 6  9]]
F1: 0.41860465116279066
AUC: 0.5007142857142857
Accuracy: 0.6666666666666666
Precision: 0.32142857142857145
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_21.xls...
Done.
Epoch: 5
Starting...
CM: [[34 26]
 [ 5 10]]
F1: 0.39215686274509803
AUC: 0.5055555555555555
Accuracy: 0.5866666666666667
Precision: 0.2777777777777778
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_5.xls...
Done.
Epoch: 5
Starting...
CM: [[48 12]
 [13  2]]
F1: 0.1379310344827586
AUC: 0.22476190476190477
Accuracy: 0.6666666666666666
Precision: 0.14285714285714285
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_5.xls...
Done.
Epoch: 5
Starting...
CM: [[56  4]
 [15  0]]
F1: 0.0
AUC: 0.1
Accuracy: 0.7466666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_5.xls...
Done.
Epoch: 80
Starting...
CM: [[18 42]
 [ 4 11]]
F1: 0.32352941176470584
AUC: 0.49710691823899367
Accuracy: 0.38666666666666666
Precision: 0.20754716981132076
Recall: 0.7333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[33 27]
 [ 7  8]]
F1: 0.32
AUC: 0.4276190476190477
Accuracy: 0.5466666666666666
Precision: 0.22857142857142856
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[49 11]
 [10  5]]
F1: 0.3225806451612903
AUC: 0.38958333333333334
Accuracy: 0.72
Precision: 0.3125
Recall: 0.3333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/validation_sheet_80.xls...
Done.
wandb: Waiting for W&B process to finish, PID 28350
wandb: Program ended successfully.
wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_191757-2420cg7b/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210518_191757-2420cg7b/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.91706
wandb:         val_accuracy 0.69026
wandb:             _runtime 26652
wandb:           _timestamp 1621392129
wandb:                _step 350
wandb:           train_loss 0.203
wandb:             val_loss 1.05447
wandb:           val_recall 0.26147
wandb:        val_precision 0.24464
wandb:               val_f1 0.25277
wandb:              val_auc 0.22691
wandb:                   lr 0.0
wandb:          best_val_f1 0.33868
wandb:    best_val_accuracy 0.65901
wandb:   best_val_precision 0.27697
wandb:      best_val_recall 0.43578
wandb:             best_auc 0.2622
wandb:           best_epoch 21
wandb:           best_bd_f1 0.44444
wandb:          best_bd_auc 0.61917
wandb:     best_bd_accuracy 0.53333
wandb:    best_bd_precision 0.29167
wandb:       best_bd_recall 0.93333
wandb:        best_bd_epoch 21
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▂▂▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▆▇▇▇▇██▇██████████
wandb:     val_accuracy ████▇██████████▇▇▄▅▆▇▁▇▅▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▅▅▅▅▅▅▅▅▅▅▄▄▄▄▄▄▄▄▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▁▂▁▁▁▁▁▂▂▂▁▂▂▂▃▂▄▂▅▄▅▅▆▇▇▇███████████
wandb:       val_recall ▁▁▁▁▃▂▁▁▁▁▁▁▁▁▁▃▂█▄▃▂█▃▄▄▃▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:    val_precision ▁▁▇▁▆▇▃▆▇▇█▇▅▁▃▅▄▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_f1 ▁▁▁▁▅▂▁▂▁▂▁▂▂▁▁▄▃█▅▄▄▇▄▅▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          val_auc ▆▇▇▄▄▆▃▄▃▄▄▃▅▆▁▄▃█▃▆▃▄▆▅▅▅▅▅▆▅▅▅▅▅▅▅▅▅▅▅
wandb:               lr ██████████████████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 8 media file(s), 6 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2151: https://wandb.ai/arachid1/tensorboard-integration/runs/2420cg7b


 See logs at ../../new_cache/conv__2151__05_1917__v29__mod9_MoE/logs/