Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2293
Description:  mixup
2021-07-07 22:30:13.813250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-07-07 22:30:16.282614: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-07 22:30:16.283814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-07 22:30:16.333327: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:30:16.334076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-07 22:30:16.334110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-07 22:30:16.337992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-07 22:30:16.338114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-07 22:30:16.339299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-07 22:30:16.339627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-07 22:30:16.340714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-07 22:30:16.341680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-07 22:30:16.341849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-07 22:30:16.341990: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:30:16.342816: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:30:16.343531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2293.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2293__07_2229__v39__mixup
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-07 22:35:30.549961: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-07 22:35:30.550369: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:35:30.551222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-07 22:35:30.551296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-07 22:35:30.551408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-07 22:35:30.551453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-07 22:35:30.551522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-07 22:35:30.551564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-07 22:35:30.551607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-07 22:35:30.551646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-07 22:35:30.551682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-07 22:35:30.551827: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:35:30.552685: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:35:30.553384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-07 22:35:30.553444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-07 22:35:31.334594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-07 22:35:31.334654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-07 22:35:31.334665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-07 22:35:31.335015: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:35:31.336023: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:35:31.336887: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-07 22:35:31.337713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-07-07 22:35:32.523121: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-07-07 22:35:32.524973: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-07 22:35:32.880597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-07 22:35:35.063385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-07 22:35:35.543592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_10
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_11
Length of training samples after augmix augmentation: 3016
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
189/189 - 78s - loss: 0.4939 - accuracy: 0.7032 - val_loss: 0.4834 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1545574546924881
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
189/189 - 74s - loss: 0.3518 - accuracy: 0.8183 - val_loss: 0.3139 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22232786285931808
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
189/189 - 74s - loss: 0.2232 - accuracy: 0.8883 - val_loss: 0.1734 - val_accuracy: 0.9365
Confusion matrix: 
 [[573   0]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.951 0.049]]
Validation f1: 9.30
Validation accuracy: 93.65
Validation recall: 4.88
Validation precision: 100.00
Validation AUC: 0.6350764461105458
Validation class accuracies: [1.0, 0.04878048780487805]
Saving model...
Epoch 4/65
189/189 - 74s - loss: 0.1784 - accuracy: 0.9098 - val_loss: 0.2068 - val_accuracy: 0.9414
Confusion matrix: 
 [[552  21]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.366 0.634]]
Validation f1: 59.09
Validation accuracy: 94.14
Validation recall: 63.41
Validation precision: 55.32
Validation AUC: 0.6385495483934556
Validation class accuracies: [0.9633507853403142, 0.6341463414634146]
Saving model...
Epoch 5/65
189/189 - 75s - loss: 0.1624 - accuracy: 0.9330 - val_loss: 0.2768 - val_accuracy: 0.8990
Confusion matrix: 
 [[528  45]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.415 0.585]]
Validation f1: 43.64
Validation accuracy: 89.90
Validation recall: 58.54
Validation precision: 34.78
Validation AUC: 0.5215882847522078
Validation class accuracies: [0.9214659685863874, 0.5853658536585366]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 1 epochs
Epoch 6/65
189/189 - 75s - loss: 0.1114 - accuracy: 0.9532 - val_loss: 0.9837 - val_accuracy: 0.7655
Confusion matrix: 
 [[439 134]
 [ 10  31]]
Normalized Confusion matrix: 
 [[0.766 0.234]
 [0.244 0.756]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 30.10
Validation accuracy: 76.55
Validation recall: 75.61
Validation precision: 18.79
Validation AUC: 0.49841516134715746
Validation class accuracies: [0.7661431064572426, 0.7560975609756098]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 2 epochs
Epoch 7/65
189/189 - 75s - loss: 0.1082 - accuracy: 0.9549 - val_loss: 0.3071 - val_accuracy: 0.8925
Confusion matrix: 
 [[517  56]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.902 0.098]
 [0.244 0.756]]
Validation f1: 48.44
Validation accuracy: 89.25
Validation recall: 75.61
Validation precision: 35.63
Validation AUC: 0.6172407757700836
Validation class accuracies: [0.9022687609075044, 0.7560975609756098]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 3 epochs
Epoch 8/65
189/189 - 77s - loss: 0.0541 - accuracy: 0.9798 - val_loss: 0.2207 - val_accuracy: 0.9365
Confusion matrix: 
 [[547  26]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.317 0.683]]
Validation f1: 58.95
Validation accuracy: 93.65
Validation recall: 68.29
Validation precision: 51.85
Validation AUC: 0.6419069878938223
Validation class accuracies: [0.9546247818499127, 0.6829268292682927]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 4 epochs
Epoch 9/65
189/189 - 80s - loss: 0.0462 - accuracy: 0.9834 - val_loss: 0.3655 - val_accuracy: 0.9039
Confusion matrix: 
 [[523  50]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.22  0.78 ]]
Validation f1: 52.03
Validation accuracy: 90.39
Validation recall: 78.05
Validation precision: 39.02
Validation AUC: 0.6301299265118782
Validation class accuracies: [0.912739965095986, 0.7804878048780488]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 10/65
189/189 - 80s - loss: 0.0277 - accuracy: 0.9924 - val_loss: 0.3574 - val_accuracy: 0.9055
Confusion matrix: 
 [[525  48]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.244 0.756]]
Validation f1: 51.67
Validation accuracy: 90.55
Validation recall: 75.61
Validation precision: 39.24
Validation AUC: 0.6395358332096223
Validation class accuracies: [0.9162303664921466, 0.7560975609756098]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 6 epochs
Epoch 11/65
189/189 - 76s - loss: 0.0264 - accuracy: 0.9940 - val_loss: 0.3207 - val_accuracy: 0.9121
Confusion matrix: 
 [[527  46]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.195 0.805]]
Validation f1: 55.00
Validation accuracy: 91.21
Validation recall: 80.49
Validation precision: 41.77
Validation AUC: 0.670758042459317
Validation class accuracies: [0.9197207678883071, 0.8048780487804879]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 7 epochs
Epoch 12/65
189/189 - 75s - loss: 0.0226 - accuracy: 0.9937 - val_loss: 0.3342 - val_accuracy: 0.9153
Confusion matrix: 
 [[532  41]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.268 0.732]]
Validation f1: 53.57
Validation accuracy: 91.53
Validation recall: 73.17
Validation precision: 42.25
Validation AUC: 0.6309173777736716
Validation class accuracies: [0.9284467713787086, 0.7317073170731707]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 8 epochs
Epoch 13/65
189/189 - 74s - loss: 0.0214 - accuracy: 0.9957 - val_loss: 0.2870 - val_accuracy: 0.9267
Confusion matrix: 
 [[543  30]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.366 0.634]]
Validation f1: 53.61
Validation accuracy: 92.67
Validation recall: 63.41
Validation precision: 46.43
Validation AUC: 0.607089492162908
Validation class accuracies: [0.9476439790575916, 0.6341463414634146]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 9 epochs
Epoch 14/65
189/189 - 74s - loss: 0.0345 - accuracy: 0.9910 - val_loss: 0.4723 - val_accuracy: 0.8990
Confusion matrix: 
 [[520  53]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.22  0.78 ]]
Validation f1: 50.79
Validation accuracy: 89.90
Validation recall: 78.05
Validation precision: 37.65
Validation AUC: 0.6301423109082696
Validation class accuracies: [0.9075043630017452, 0.7804878048780488]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 15/65
189/189 - 75s - loss: 0.0236 - accuracy: 0.9894 - val_loss: 0.4015 - val_accuracy: 0.9007
Confusion matrix: 
 [[523  50]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.268 0.732]]
Validation f1: 49.59
Validation accuracy: 90.07
Validation recall: 73.17
Validation precision: 37.50
Validation AUC: 0.6204180658575988
Validation class accuracies: [0.912739965095986, 0.7317073170731707]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 11 epochs
Epoch 16/65
189/189 - 75s - loss: 0.0164 - accuracy: 0.9964 - val_loss: 0.3917 - val_accuracy: 0.8974
Confusion matrix: 
 [[521  52]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.268 0.732]]
Validation f1: 48.78
Validation accuracy: 89.74
Validation recall: 73.17
Validation precision: 36.59
Validation AUC: 0.6201110014294441
Validation class accuracies: [0.9092495636998255, 0.7317073170731707]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 12 epochs
Epoch 17/65
189/189 - 77s - loss: 0.0192 - accuracy: 0.9964 - val_loss: 0.4022 - val_accuracy: 0.8941
Confusion matrix: 
 [[519  54]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.268 0.732]]
Validation f1: 48.00
Validation accuracy: 89.41
Validation recall: 73.17
Validation precision: 35.71
Validation AUC: 0.6231879188855586
Validation class accuracies: [0.9057591623036649, 0.7317073170731707]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 13 epochs
Epoch 18/65
189/189 - 81s - loss: 0.0187 - accuracy: 0.9973 - val_loss: 0.4146 - val_accuracy: 0.8958
Confusion matrix: 
 [[519  54]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.244 0.756]]
Validation f1: 49.21
Validation accuracy: 89.58
Validation recall: 75.61
Validation precision: 36.47
Validation AUC: 0.6219727645656487
Validation class accuracies: [0.9057591623036649, 0.7560975609756098]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 14 epochs
Epoch 19/65
189/189 - 80s - loss: 0.0158 - accuracy: 0.9967 - val_loss: 0.3938 - val_accuracy: 0.8958
Confusion matrix: 
 [[519  54]
 [ 10  31]]
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.244 0.756]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.21
Validation accuracy: 89.58
Validation recall: 75.61
Validation precision: 36.47
Validation AUC: 0.6247569993344764
Validation class accuracies: [0.9057591623036649, 0.7560975609756098]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 20/65
189/189 - 81s - loss: 0.0139 - accuracy: 0.9983 - val_loss: 0.3885 - val_accuracy: 0.9023
Confusion matrix: 
 [[523  50]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.244 0.756]]
Validation f1: 50.82
Validation accuracy: 90.23
Validation recall: 75.61
Validation precision: 38.27
Validation AUC: 0.6236642628203799
Validation class accuracies: [0.912739965095986, 0.7560975609756098]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 16 epochs
Epoch 21/65
189/189 - 78s - loss: 0.0174 - accuracy: 0.9967 - val_loss: 0.3823 - val_accuracy: 0.9039
Confusion matrix: 
 [[525  48]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.268 0.732]]
Validation f1: 50.42
Validation accuracy: 90.39
Validation recall: 73.17
Validation precision: 38.46
Validation AUC: 0.624150289792074
Validation class accuracies: [0.9162303664921466, 0.7317073170731707]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 17 epochs
Epoch 22/65
189/189 - 77s - loss: 0.0168 - accuracy: 0.9973 - val_loss: 0.3794 - val_accuracy: 0.9055
Confusion matrix: 
 [[526  47]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.268 0.732]]
Validation f1: 50.85
Validation accuracy: 90.55
Validation recall: 73.17
Validation precision: 38.96
Validation AUC: 0.6238500316843302
Validation class accuracies: [0.9179755671902269, 0.7317073170731707]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 18 epochs
Epoch 23/65
189/189 - 81s - loss: 0.0167 - accuracy: 0.9960 - val_loss: 0.3826 - val_accuracy: 0.9055
Confusion matrix: 
 [[526  47]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.85
Validation accuracy: 90.55
Validation recall: 73.17
Validation precision: 38.96
Validation AUC: 0.6210360366928649
Validation class accuracies: [0.9179755671902269, 0.7317073170731707]
The validation tracker metric at 0.5909090909090909 hasn't increased by 0 in 19 epochs
Epoch 24/65
189/189 - 81s - loss: 0.0150 - accuracy: 0.9977 - val_loss: 0.3889 - val_accuracy: 0.8990
Confusion matrix: 
 [[522  51]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.268 0.732]]
Validation f1: 49.18
Validation accuracy: 89.90
Validation recall: 73.17
Validation precision: 37.04
Validation AUC: 0.6216787056541714
Validation class accuracies: [0.9109947643979057, 0.7317073170731707]

The metrics for job 0 with the best target metric are: 
Best cm: [[552  21]
 [ 15  26]]
Best normalized cm: [[0.963 0.037]
 [0.366 0.634]]
Best f1: 0.59
Best accuracy: 0.94
Best recall: 0.63
Best precision: 0.55
Best AUC: 0.64
Best class accuracies: [0.9633507853403142, 0.6341463414634146]
Best epoch: 4
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.08]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.174]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_1.png, [[0.505]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.028]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_1.png, [[0.677]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.056]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.363]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.019]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.007e-05]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.053]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[3.476e-05]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.051]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[3.922e-05]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.019]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.037]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.014]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[0.096]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_1.png, [[0.824]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.498]]
../../new_cache/conv__2293__07_2229__v39__mixup/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_1.png, [[0.962]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 1213
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210707_223016-33ls25l3/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210707_223016-33ls25l3/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99768
wandb:         val_accuracy 0.89902
wandb:             _runtime 2419
wandb:           _timestamp 1625699436
wandb:                _step 173
wandb:           train_loss 0.01497
wandb:             val_loss 0.38891
wandb:           val_recall 0.73171
wandb:        val_precision 0.37037
wandb:               val_f1 0.4918
wandb:              val_auc 0.62168
wandb:                   lr 2e-05
wandb:          best_val_f1 0.59091
wandb:    best_val_accuracy 0.94137
wandb:   best_val_precision 0.55319
wandb:      best_val_recall 0.63415
wandb:             best_auc 0.63855
wandb:           best_epoch 4
wandb: Run history:
wandb:   train_accuracy ▁▄▅▆▆▇▇█████████████████
wandb:     val_accuracy ████▆▁▆█▇▇▇▇▇▆▆▆▆▆▆▆▇▇▇▆
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▆▄▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▄▂▁▁▂█▂▁▃▃▂▂▂▄▃▃▃▃▃▃▃▃▃▃
wandb:       val_recall ▁▁▁▇▆██▇███▇▇█▇▇▇███▇▇▇▇
wandb:    val_precision ▁▁█▅▃▂▃▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:           val_f1 ▁▁▂█▆▅▇█▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▂██▆▆▇█▇██▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr █████████▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210707_223016-33ls25l3

-----------------------
158/400 with v43
{'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_18
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_19
Length of training samples after augmix augmentation: 3016
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_5 (MixDepthGroupCo (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_6 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_7 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_8 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_9 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
189/189 - 80s - loss: 0.5022 - accuracy: 0.7016 - val_loss: 0.6267 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08491414688643356
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
189/189 - 76s - loss: 0.3505 - accuracy: 0.8040 - val_loss: 0.9342 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.12794856496711426
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 3/65
189/189 - 80s - loss: 0.2869 - accuracy: 0.8511 - val_loss: 0.4469 - val_accuracy: 0.8176
Confusion matrix: 
 [[473 100]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.825 0.175]
 [0.293 0.707]]
Validation f1: 34.12
Validation accuracy: 81.76
Validation recall: 70.73
Validation precision: 22.48
Validation AUC: 0.641415543539417
Validation class accuracies: [0.8254799301919721, 0.7073170731707317]
Saving model...
Epoch 4/65
189/189 - 81s - loss: 0.1970 - accuracy: 0.9118 - val_loss: 2.2252 - val_accuracy: 0.2362
Confusion matrix: 
 [[104 469]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.182 0.818]
 [0.    1.   ]]
Validation f1: 14.88
Validation accuracy: 23.62
Validation recall: 100.00
Validation precision: 8.04
Validation AUC: 0.6313331493874765
Validation class accuracies: [0.18150087260034903, 1.0]
The validation tracker metric at 0.34117647058823536 hasn't increased by 0 in 1 epochs
Epoch 5/65
189/189 - 76s - loss: 0.1296 - accuracy: 0.9393 - val_loss: 0.4193 - val_accuracy: 0.8811
Confusion matrix: 
 [[506  67]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.146 0.854]]
Validation f1: 48.95
Validation accuracy: 88.11
Validation recall: 85.37
Validation precision: 34.31
Validation AUC: 0.6534447866745684
Validation class accuracies: [0.8830715532286213, 0.8536585365853658]
Saving model...
Epoch 6/65
189/189 - 80s - loss: 0.1589 - accuracy: 0.9390 - val_loss: 0.3934 - val_accuracy: 0.8616
Confusion matrix: 
 [[500  73]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.293 0.707]]
Validation f1: 40.56
Validation accuracy: 86.16
Validation recall: 70.73
Validation precision: 28.43
Validation AUC: 0.6245498829905349
Validation class accuracies: [0.8726003490401396, 0.7073170731707317]
The validation tracker metric at 0.4895104895104895 hasn't increased by 0 in 1 epochs
Epoch 7/65
189/189 - 80s - loss: 0.1253 - accuracy: 0.9483 - val_loss: 0.9742 - val_accuracy: 0.7557
Confusion matrix: 
 [[432 141]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.754 0.246]
 [0.22  0.78 ]]
Validation f1: 29.91
Validation accuracy: 75.57
Validation recall: 78.05
Validation precision: 18.50
Validation AUC: 0.5615269042519142
Validation class accuracies: [0.7539267015706806, 0.7804878048780488]
The validation tracker metric at 0.4895104895104895 hasn't increased by 0 in 2 epochs
Epoch 8/65
189/189 - 77s - loss: 0.0987 - accuracy: 0.9602 - val_loss: 0.2125 - val_accuracy: 0.9283
Confusion matrix: 
 [[543  30]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.341 0.659]]
Validation f1: 55.10
Validation accuracy: 92.83
Validation recall: 65.85
Validation precision: 47.37
Validation AUC: 0.6634135169406933
Validation class accuracies: [0.9476439790575916, 0.6585365853658537]
Saving model...
Epoch 9/65
189/189 - 78s - loss: 0.0518 - accuracy: 0.9824 - val_loss: 0.3499 - val_accuracy: 0.9023
Confusion matrix: 
 [[523  50]
 [ 10  31]]
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.244 0.756]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.82
Validation accuracy: 90.23
Validation recall: 75.61
Validation precision: 38.27
Validation AUC: 0.6439549215160619
Validation class accuracies: [0.912739965095986, 0.7560975609756098]
The validation tracker metric at 0.5510204081632653 hasn't increased by 0 in 1 epochs
Epoch 10/65
189/189 - 81s - loss: 0.0490 - accuracy: 0.9814 - val_loss: 0.7103 - val_accuracy: 0.8420
Confusion matrix: 
 [[486  87]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.244 0.756]]
Validation f1: 38.99
Validation accuracy: 84.20
Validation recall: 75.61
Validation precision: 26.27
Validation AUC: 0.565875731321563
Validation class accuracies: [0.8481675392670157, 0.7560975609756098]
The validation tracker metric at 0.5510204081632653 hasn't increased by 0 in 2 epochs
Epoch 11/65
189/189 - 77s - loss: 0.0407 - accuracy: 0.9847 - val_loss: 0.3192 - val_accuracy: 0.9072
Confusion matrix: 
 [[528  45]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.293 0.707]]
Validation f1: 50.43
Validation accuracy: 90.72
Validation recall: 70.73
Validation precision: 39.19
Validation AUC: 0.6560163936463858
Validation class accuracies: [0.9214659685863874, 0.7073170731707317]
The validation tracker metric at 0.5510204081632653 hasn't increased by 0 in 3 epochs
Epoch 12/65
189/189 - 78s - loss: 0.0339 - accuracy: 0.9897 - val_loss: 0.2905 - val_accuracy: 0.9137
Confusion matrix: 
 [[532  41]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.293 0.707]]
Validation f1: 52.25
Validation accuracy: 91.37
Validation recall: 70.73
Validation precision: 41.43
Validation AUC: 0.6938891081565657
Validation class accuracies: [0.9284467713787086, 0.7073170731707317]
The validation tracker metric at 0.5510204081632653 hasn't increased by 0 in 4 epochs
Epoch 13/65
189/189 - 80s - loss: 0.0218 - accuracy: 0.9957 - val_loss: 0.5765 - val_accuracy: 0.8436
Confusion matrix: 
 [[483  90]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.843 0.157]
 [0.146 0.854]]
Validation f1: 42.17
Validation accuracy: 84.36
Validation recall: 85.37
Validation precision: 28.00
Validation AUC: 0.650090330694936
Validation class accuracies: [0.8429319371727748, 0.8536585365853658]
The validation tracker metric at 0.5510204081632653 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 14/65
189/189 - 79s - loss: 0.0153 - accuracy: 0.9967 - val_loss: 0.2793 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.6852289110475943
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
Saving model...
Epoch 15/65
189/189 - 76s - loss: 0.0173 - accuracy: 0.9964 - val_loss: 0.2434 - val_accuracy: 0.9283
Confusion matrix: 
 [[542  31]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.317 0.683]]
Validation f1: 56.00
Validation accuracy: 92.83
Validation recall: 68.29
Validation precision: 47.46
Validation AUC: 0.6754026680438598
Validation class accuracies: [0.9458987783595113, 0.6829268292682927]
Saving model...
Epoch 16/65
189/189 - 80s - loss: 0.0125 - accuracy: 0.9983 - val_loss: 0.2906 - val_accuracy: 0.9153
Confusion matrix: 
 [[534  39]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.317 0.683]]
Validation f1: 51.85
Validation accuracy: 91.53
Validation recall: 68.29
Validation precision: 41.79
Validation AUC: 0.6757060959260554
Validation class accuracies: [0.9319371727748691, 0.6829268292682927]
The validation tracker metric at 0.56 hasn't increased by 0 in 1 epochs
Epoch 17/65
189/189 - 80s - loss: 0.0116 - accuracy: 0.9983 - val_loss: 0.2116 - val_accuracy: 0.9397
Confusion matrix: 
 [[549  24]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.317 0.683]]
Validation f1: 60.22
Validation accuracy: 93.97
Validation recall: 68.29
Validation precision: 53.85
Validation AUC: 0.7058384483331037
Validation class accuracies: [0.9581151832460733, 0.6829268292682927]
Saving model...
Epoch 18/65
189/189 - 75s - loss: 0.0174 - accuracy: 0.9970 - val_loss: 0.2876 - val_accuracy: 0.9202
Confusion matrix: 
 [[537  36]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.317 0.683]]
Validation f1: 53.33
Validation accuracy: 92.02
Validation recall: 68.29
Validation precision: 43.75
Validation AUC: 0.6742534124660775
Validation class accuracies: [0.93717277486911, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 1 epochs
Epoch 19/65
189/189 - 80s - loss: 0.0131 - accuracy: 0.9977 - val_loss: 0.2833 - val_accuracy: 0.9137
Confusion matrix: 
 [[531  42]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.268 0.732]]
Validation f1: 53.10
Validation accuracy: 91.37
Validation recall: 73.17
Validation precision: 41.67
Validation AUC: 0.7074729714257743
Validation class accuracies: [0.9267015706806283, 0.7317073170731707]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 2 epochs
Epoch 20/65
189/189 - 80s - loss: 0.0101 - accuracy: 0.9993 - val_loss: 0.2671 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.6965612679506789
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 3 epochs
Epoch 21/65
189/189 - 75s - loss: 0.0107 - accuracy: 0.9987 - val_loss: 0.2726 - val_accuracy: 0.9251
Confusion matrix: 
 [[539  34]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.293 0.707]]
Validation f1: 55.77
Validation accuracy: 92.51
Validation recall: 70.73
Validation precision: 46.03
Validation AUC: 0.7167580145551562
Validation class accuracies: [0.9406631762652705, 0.7073170731707317]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 4 epochs
Epoch 22/65
189/189 - 80s - loss: 0.0081 - accuracy: 0.9990 - val_loss: 0.2527 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.698815626497499
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 23/65
189/189 - 79s - loss: 0.0093 - accuracy: 0.9990 - val_loss: 0.2678 - val_accuracy: 0.9283
Confusion matrix: 
 [[541  32]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.293 0.707]]
Validation f1: 56.86
Validation accuracy: 92.83
Validation recall: 70.73
Validation precision: 47.54
Validation AUC: 0.6969651433802876
Validation class accuracies: [0.944153577661431, 0.7073170731707317]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 6 epochs
Epoch 24/65
189/189 - 74s - loss: 0.0109 - accuracy: 0.9990 - val_loss: 0.2747 - val_accuracy: 0.9251
Confusion matrix: 
 [[539  34]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.77
Validation accuracy: 92.51
Validation recall: 70.73
Validation precision: 46.03
Validation AUC: 0.6975558070205643
Validation class accuracies: [0.9406631762652705, 0.7073170731707317]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 7 epochs
Epoch 25/65
189/189 - 79s - loss: 0.0110 - accuracy: 0.9990 - val_loss: 0.2842 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.6870480434356366
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 8 epochs
Epoch 26/65
189/189 - 80s - loss: 0.0107 - accuracy: 0.9987 - val_loss: 0.2710 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.696112739005814
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 9 epochs
Epoch 27/65
189/189 - 76s - loss: 0.0108 - accuracy: 0.9993 - val_loss: 0.2515 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.6970745171601366
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 28/65
189/189 - 79s - loss: 0.0087 - accuracy: 0.9993 - val_loss: 0.2608 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.69919882198908
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 11 epochs
Epoch 29/65
189/189 - 80s - loss: 0.0082 - accuracy: 0.9990 - val_loss: 0.2661 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6972052098269482
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 12 epochs
Epoch 30/65
189/189 - 77s - loss: 0.0103 - accuracy: 0.9993 - val_loss: 0.2633 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6969050760334211
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 13 epochs
Epoch 31/65
189/189 - 79s - loss: 0.0101 - accuracy: 0.9990 - val_loss: 0.2655 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6942473316800818
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 14 epochs
Epoch 32/65
189/189 - 80s - loss: 0.0095 - accuracy: 0.9983 - val_loss: 0.2689 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6968608612299989
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 3.906250185536919e-06
Epoch 33/65
189/189 - 78s - loss: 0.0066 - accuracy: 0.9997 - val_loss: 0.2666 - val_accuracy: 0.9251
Confusion matrix: 
 [[540  33]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.317 0.683]]
Validation f1: 54.90
Validation accuracy: 92.51
Validation recall: 68.29
Validation precision: 45.90
Validation AUC: 0.6971112966451175
Validation class accuracies: [0.9424083769633508, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 16 epochs
Epoch 34/65
189/189 - 77s - loss: 0.0071 - accuracy: 0.9997 - val_loss: 0.2662 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6977867539562552
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 17 epochs
Epoch 35/65
189/189 - 80s - loss: 0.0094 - accuracy: 0.9990 - val_loss: 0.2653 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6970947767307458
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 18 epochs
Epoch 36/65
189/189 - 80s - loss: 0.0085 - accuracy: 0.9987 - val_loss: 0.2617 - val_accuracy: 0.9267
Confusion matrix: 
 [[541  32]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.45
Validation accuracy: 92.67
Validation recall: 68.29
Validation precision: 46.67
Validation AUC: 0.6969997888330358
Validation class accuracies: [0.944153577661431, 0.6829268292682927]
The validation tracker metric at 0.6021505376344086 hasn't increased by 0 in 19 epochs
Epoch 37/65
189/189 - 76s - loss: 0.0089 - accuracy: 0.9997 - val_loss: 0.2696 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.699397562801842
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]

The metrics for job 1 with the best target metric are: 
Best cm: [[549  24]
 [ 13  28]]
Best normalized cm: [[0.958 0.042]
 [0.317 0.683]]
Best f1: 0.60
Best accuracy: 0.94
Best recall: 0.68
Best precision: 0.54
Best AUC: 0.71
Best class accuracies: [0.9581151832460733, 0.6829268292682927]
Best epoch: 17
The number of epochs since last 1% equals the patience
Lr has been adjusted to 9.765625463842298e-07
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_213_1p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_213_1p5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_217_1b1_Tc_sc_Meditron_3_label_0_pred_0.png, [[0.091]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_218_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_218_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_2_label_1_pred_1.png, [[0.985]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_222_1b1_Lr_sc_Meditron_7_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_218_1p1_Pl_sc_Litt3200_2_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_215_1b2_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_213_2p2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[9.189e-05]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_204_2b5_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.021]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_3b2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_219_2b1_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_205_4b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.05]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_223_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[5.495e-05]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.022]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_218_1b1_Al_sc_Meditron_8_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_203_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_213_1p2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.021]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_213_2p2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_224_1b2_Al_sc_Meditron_3_label_0_pred_0.png, [[0.059]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b3_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_213_1p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_218_1p1_Pl_sc_Litt3200_0_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.02]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.032]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_3b2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_213_1p5_Al_mc_AKGC417L_1_label_0_pred_0.png, [[1.63e-05]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_204_7p5_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_204_7p5_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_221_2b3_Al_mc_LittC2SE_1_label_0_pred_0.png, [[0.253]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_225_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.122]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.046]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_221_2b3_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.143]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_218_1b1_Pr_sc_Meditron_1_label_0_pred_0.png, [[0.064]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_213_1p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[4.593e-07]]
../../new_cache/conv__2293__07_2229__v39__mixup/1/icbhi_207_2b4_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 5327
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210707_231111-esrfe528/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210707_231111-esrfe528/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99967
wandb:         val_accuracy 0.92345
wandb:             _runtime 3686
wandb:           _timestamp 1625703158
wandb:                _step 279
wandb:           train_loss 0.00894
wandb:             val_loss 0.26957
wandb:           val_recall 0.68293
wandb:        val_precision 0.45161
wandb:               val_f1 0.54369
wandb:              val_auc 0.6994
wandb:                   lr 0.0
wandb:          best_val_f1 0.60215
wandb:    best_val_accuracy 0.93974
wandb:   best_val_precision 0.53846
wandb:      best_val_recall 0.68293
wandb:             best_auc 0.70584
wandb:           best_epoch 17
wandb: Run history:
wandb:   train_accuracy ▁▃▅▆▇▇▇▇█████████████████████████████
wandb:     val_accuracy █▁▇▂█▇▇██▇██▇████████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▆▅▄▃▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▂▄▂█▂▂▄▁▁▃▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁█▆█▇▆▆▆▆▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:    val_precision ▁▂▄▂▅▅▃▇▆▄▆▆▅▇▇▆█▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_f1 ▁▂▅▃▇▆▄▇▇▆▇▇▆▇█▇█▇▇▇▇██▇▇██▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▁▇▇▇▇▆▇▇▆▇█▇████████████████████████
wandb:               lr █████████████▃▃▃▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210707_231111-esrfe528

-----------------------
158/800 with v42, v43
{'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_20
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_21
Length of training samples after augmix augmentation: 3416
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_3 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_10 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_11 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_12 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_13 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_14 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
214/214 - 91s - loss: 0.4891 - accuracy: 0.7073 - val_loss: 0.6019 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.4143177210798914
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
214/214 - 85s - loss: 0.3669 - accuracy: 0.8126 - val_loss: 0.8376 - val_accuracy: 0.2818
Confusion matrix: 
 [[132 441]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.23 0.77]
 [0.   1.  ]]
Validation f1: 15.68
Validation accuracy: 28.18
Validation recall: 100.00
Validation precision: 8.51
Validation AUC: 0.47354610359069504
Validation class accuracies: [0.23036649214659685, 1.0]
Saving model...
Epoch 3/65
214/214 - 90s - loss: 0.2402 - accuracy: 0.8855 - val_loss: 2.6090 - val_accuracy: 0.0831
Confusion matrix: 
 [[ 10 563]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.017 0.983]
 [0.    1.   ]]
Validation f1: 12.71
Validation accuracy: 8.31
Validation recall: 100.00
Validation precision: 6.79
Validation AUC: 0.5893040272491172
Validation class accuracies: [0.017452006980802792, 1.0]
The validation tracker metric at 0.15678776290630977 hasn't increased by 0 in 1 epochs
Epoch 4/65
214/214 - 91s - loss: 0.2117 - accuracy: 0.9028 - val_loss: 0.2548 - val_accuracy: 0.9007
Confusion matrix: 
 [[518  55]
 [  6  35]]
Normalized Confusion matrix: 
 [[0.904 0.096]
 [0.146 0.854]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.44
Validation accuracy: 90.07
Validation recall: 85.37
Validation precision: 38.89
Validation AUC: 0.6811501301873826
Validation class accuracies: [0.9040139616055847, 0.8536585365853658]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 18 leaked semaphores to clean up at shutdown
  len(cache))
