Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2032
Description:  newmixednet
2021-04-06 12:12:05.431100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-06 12:12:08.024784: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-06 12:12:08.025848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-06 12:12:08.068762: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.069511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-06 12:12:08.069545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-06 12:12:08.073288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-06 12:12:08.073402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-06 12:12:08.074561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-06 12:12:08.074908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-06 12:12:08.076044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-06 12:12:08.077016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-06 12:12:08.077197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-06 12:12:08.077317: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.078272: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.079017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-06 12:12:08.081192: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-06 12:12:08.081382: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.082103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-06 12:12:08.082126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-06 12:12:08.082156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-06 12:12:08.082170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-06 12:12:08.082182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-06 12:12:08.082194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-06 12:12:08.082218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-06 12:12:08.082231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-06 12:12:08.082244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-06 12:12:08.082306: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.083115: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.083782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-06 12:12:08.083823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-06 12:12:08.821113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-06 12:12:08.821164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-06 12:12:08.821172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-06 12:12:08.821469: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.823962: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.824690: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 12:12:08.825400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-04-06 12:12:09.328086: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-06 12:12:09.328139: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-06 12:12:09.328179: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-06 12:12:09.328459: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-04-06 12:12:09.329397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-04-06 12:12:09.587792: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-06 12:12:09.590498: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-06 12:12:10.331135: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-06 12:12:10.332719: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-04-06 12:12:12.327975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-06 12:12:12.958737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-06 12:12:12.972179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-06 12:12:17.796541: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-06 12:12:17.796593: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-06 12:12:19.121380: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-06 12:12:19.125134: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-04-06 12:12:19.163034: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 1359 callback api events and 1355 activity events. 
2021-04-06 12:12:19.195659: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2032.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___04_1211___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___newmixednet___2032/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 258       
=================================================================
Total params: 106,096
Trainable params: 105,600
Non-trainable params: 496
_________________________________________________________________
Epoch 1/40
872/872 - 519s - loss: 0.3077 - calc_accuracy: 0.6745 - val_loss: 0.3369 - val_calc_accuracy: 0.7444
Epoch 2/40
872/872 - 517s - loss: 0.2478 - calc_accuracy: 0.7397 - val_loss: 0.3111 - val_calc_accuracy: 0.7413
Epoch 3/40
872/872 - 519s - loss: 0.2271 - calc_accuracy: 0.7587 - val_loss: 0.2827 - val_calc_accuracy: 0.7924
Epoch 4/40
872/872 - 516s - loss: 0.2070 - calc_accuracy: 0.7832 - val_loss: 0.3236 - val_calc_accuracy: 0.7350
Epoch 5/40
872/872 - 518s - loss: 0.1961 - calc_accuracy: 0.7983 - val_loss: 0.2697 - val_calc_accuracy: 0.8024
Epoch 6/40
872/872 - 516s - loss: 0.1815 - calc_accuracy: 0.8120 - val_loss: 0.3046 - val_calc_accuracy: 0.7344
Epoch 7/40
872/872 - 520s - loss: 0.1685 - calc_accuracy: 0.8269 - val_loss: 0.2914 - val_calc_accuracy: 0.7772
Epoch 8/40
872/872 - 517s - loss: 0.1595 - calc_accuracy: 0.8327 - val_loss: 0.2285 - val_calc_accuracy: 0.8336
Epoch 9/40
872/872 - 517s - loss: 0.1461 - calc_accuracy: 0.8493 - val_loss: 0.2668 - val_calc_accuracy: 0.7807
Epoch 10/40
872/872 - 516s - loss: 0.1343 - calc_accuracy: 0.8616 - val_loss: 0.2331 - val_calc_accuracy: 0.8264
Epoch 11/40
872/872 - 521s - loss: 0.1275 - calc_accuracy: 0.8678 - val_loss: 0.2101 - val_calc_accuracy: 0.8483
Epoch 12/40
872/872 - 519s - loss: 0.1169 - calc_accuracy: 0.8786 - val_loss: 0.2498 - val_calc_accuracy: 0.8297
Epoch 13/40
872/872 - 517s - loss: 0.1079 - calc_accuracy: 0.8910 - val_loss: 0.1946 - val_calc_accuracy: 0.8661
Epoch 14/40
872/872 - 516s - loss: 0.0998 - calc_accuracy: 0.8971 - val_loss: 0.2623 - val_calc_accuracy: 0.8348
Epoch 15/40
872/872 - 518s - loss: 0.0953 - calc_accuracy: 0.9023 - val_loss: 0.4541 - val_calc_accuracy: 0.7318
Epoch 16/40
872/872 - 513s - loss: 0.0885 - calc_accuracy: 0.9094 - val_loss: 0.1914 - val_calc_accuracy: 0.8689
Epoch 17/40
872/872 - 517s - loss: 0.0800 - calc_accuracy: 0.9191 - val_loss: 0.2104 - val_calc_accuracy: 0.8569
Epoch 18/40
872/872 - 518s - loss: 0.0751 - calc_accuracy: 0.9249 - val_loss: 0.2015 - val_calc_accuracy: 0.8666
Epoch 19/40
872/872 - 519s - loss: 0.0685 - calc_accuracy: 0.9328 - val_loss: 0.3244 - val_calc_accuracy: 0.8086

Epoch 00019: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 20/40
872/872 - 518s - loss: 0.0611 - calc_accuracy: 0.9422 - val_loss: 0.1803 - val_calc_accuracy: 0.8764
Epoch 21/40
872/872 - 518s - loss: 0.0555 - calc_accuracy: 0.9501 - val_loss: 0.1957 - val_calc_accuracy: 0.8790
Epoch 22/40
872/872 - 520s - loss: 0.0541 - calc_accuracy: 0.9496 - val_loss: 0.2144 - val_calc_accuracy: 0.8681
Epoch 23/40
872/872 - 523s - loss: 0.0518 - calc_accuracy: 0.9520 - val_loss: 0.2176 - val_calc_accuracy: 0.8686
Epoch 24/40
872/872 - 519s - loss: 0.0494 - calc_accuracy: 0.9537 - val_loss: 0.4153 - val_calc_accuracy: 0.7893

Epoch 00024: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 25/40
872/872 - 518s - loss: 0.0441 - calc_accuracy: 0.9601 - val_loss: 0.1816 - val_calc_accuracy: 0.8818
Epoch 26/40
872/872 - 531s - loss: 0.0399 - calc_accuracy: 0.9647 - val_loss: 0.1789 - val_calc_accuracy: 0.8824
Epoch 27/40
872/872 - 519s - loss: 0.0375 - calc_accuracy: 0.9671 - val_loss: 0.2330 - val_calc_accuracy: 0.8603
Epoch 28/40
872/872 - 511s - loss: 0.0377 - calc_accuracy: 0.9688 - val_loss: 0.1804 - val_calc_accuracy: 0.8858
Epoch 29/40
872/872 - 512s - loss: 0.0359 - calc_accuracy: 0.9696 - val_loss: 0.2848 - val_calc_accuracy: 0.8428
Epoch 00029: early stopping

 See logs at ../../cache/conv___04_1211___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___newmixednet___2032/logs/