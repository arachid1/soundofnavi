Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2028
Description:  512ch_3
2021-03-30 16:26:58.170694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-30 16:27:02.754896: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-30 16:27:02.766231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-03-30 16:27:02.831948: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:02.832700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-03-30 16:27:02.832762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-30 16:27:02.854289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-30 16:27:02.854383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-30 16:27:02.865769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-30 16:27:02.868879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-30 16:27:02.873419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-30 16:27:02.878695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-30 16:27:02.880028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-30 16:27:02.880182: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:02.880935: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:02.881728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-30 16:27:02.887688: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-30 16:27:02.887920: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:02.888592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-03-30 16:27:02.888614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-30 16:27:02.888641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-30 16:27:02.888655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-30 16:27:02.888677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-30 16:27:02.888691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-30 16:27:02.888713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-30 16:27:02.888726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-30 16:27:02.888740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-30 16:27:02.888816: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:02.889506: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:02.890143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-30 16:27:02.890865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-30 16:27:04.254945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-30 16:27:04.254992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-03-30 16:27:04.255001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-03-30 16:27:04.255326: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:04.256184: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:04.257013: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-30 16:27:04.257660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-03-30 16:27:04.766727: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-30 16:27:04.766777: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-30 16:27:04.768183: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-03-30 16:27:04.768594: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-03-30 16:27:04.780023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-03-30 16:27:04.996527: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-03-30 16:27:04.999445: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2028.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___03_1626___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___512ch_3___2028/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        2021-03-30 16:27:06.097629: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-03-30 16:27:06.100757: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-03-30 16:27:10.195892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-30 16:27:11.506010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-30 16:27:11.524514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-30 16:27:21.276636: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-30 16:27:21.276688: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-30 16:27:23.712281: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-03-30 16:27:23.716207: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-03-30 16:27:23.764409: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 2327 callback api events and 2323 activity events. 
2021-03-30 16:27:23.823766: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.

__________________________________________________________________________________________________
dense_mo_e (DenseMoE)           (None, 512)          789507      global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            1026        dense_mo_e[0][0]                 
==================================================================================================
Total params: 6,990,769
Trainable params: 6,949,259
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
872/872 - 1683s - loss: 0.3765 - calc_accuracy: 0.5959 - val_loss: 2.4637 - val_calc_accuracy: 0.3119
Epoch 2/40
872/872 - 1649s - loss: 0.2628 - calc_accuracy: 0.7234 - val_loss: 0.4834 - val_calc_accuracy: 0.6200
Epoch 3/40
872/872 - 1663s - loss: 0.2437 - calc_accuracy: 0.7436 - val_loss: 0.3735 - val_calc_accuracy: 0.7101
Epoch 4/40
872/872 - 1659s - loss: 0.2314 - calc_accuracy: 0.7542 - val_loss: 0.3543 - val_calc_accuracy: 0.7247
Epoch 5/40
872/872 - 1661s - loss: 0.2217 - calc_accuracy: 0.7674 - val_loss: 0.3695 - val_calc_accuracy: 0.7290
Epoch 6/40
872/872 - 1661s - loss: 0.2121 - calc_accuracy: 0.7723 - val_loss: 0.3513 - val_calc_accuracy: 0.6758
Epoch 7/40
872/872 - 1657s - loss: 0.2037 - calc_accuracy: 0.7821 - val_loss: 0.4034 - val_calc_accuracy: 0.6943
Epoch 8/40
872/872 - 1649s - loss: 0.1909 - calc_accuracy: 0.8014 - val_loss: 0.2539 - val_calc_accuracy: 0.8221
Epoch 9/40
872/872 - 1663s - loss: 0.1729 - calc_accuracy: 0.8270 - val_loss: 0.2198 - val_calc_accuracy: 0.8468
Epoch 10/40
872/872 - 1658s - loss: 0.1601 - calc_accuracy: 0.8390 - val_loss: 0.2132 - val_calc_accuracy: 0.8557
Epoch 11/40
872/872 - 1650s - loss: 0.1520 - calc_accuracy: 0.8446 - val_loss: 0.2059 - val_calc_accuracy: 0.8494
Epoch 12/40
872/872 - 1649s - loss: 0.1460 - calc_accuracy: 0.8536 - val_loss: 0.1803 - val_calc_accuracy: 0.8687
Epoch 13/40
872/872 - 1649s - loss: 0.1404 - calc_accuracy: 0.8583 - val_loss: 0.2910 - val_calc_accuracy: 0.8173
Epoch 14/40
872/872 - 1650s - loss: 0.1331 - calc_accuracy: 0.8680 - val_loss: 0.3754 - val_calc_accuracy: 0.7510
Epoch 15/40
872/872 - 1653s - loss: 0.1265 - calc_accuracy: 0.8710 - val_loss: 0.1594 - val_calc_accuracy: 0.8836
Epoch 16/40
872/872 - 1655s - loss: 0.1243 - calc_accuracy: 0.8727 - val_loss: 0.2348 - val_calc_accuracy: 0.8399
Epoch 17/40
872/872 - 1654s - loss: 0.1174 - calc_accuracy: 0.8819 - val_loss: 0.1878 - val_calc_accuracy: 0.8698
Epoch 18/40
872/872 - 1651s - loss: 0.1109 - calc_accuracy: 0.8894 - val_loss: 0.2182 - val_calc_accuracy: 0.8492

Epoch 00018: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 19/40
872/872 - 1648s - loss: 0.1041 - calc_accuracy: 0.8944 - val_loss: 0.1641 - val_calc_accuracy: 0.8841
Epoch 20/40
872/872 - 1650s - loss: 0.0995 - calc_accuracy: 0.9022 - val_loss: 0.1742 - val_calc_accuracy: 0.8743
Epoch 21/40
872/872 - 1649s - loss: 0.0936 - calc_accuracy: 0.9050 - val_loss: 0.1592 - val_calc_accuracy: 0.8947
Epoch 22/40
872/872 - 1650s - loss: 0.0920 - calc_accuracy: 0.9086 - val_loss: 0.1471 - val_calc_accuracy: 0.8993
Epoch 23/40
872/872 - 1650s - loss: 0.0882 - calc_accuracy: 0.9116 - val_loss: 0.1450 - val_calc_accuracy: 0.9022
Epoch 24/40
872/872 - 1648s - loss: 0.0818 - calc_accuracy: 0.9168 - val_loss: 0.1723 - val_calc_accuracy: 0.8870
Epoch 25/40
872/872 - 1647s - loss: 0.0802 - calc_accuracy: 0.9187 - val_loss: 0.1566 - val_calc_accuracy: 0.8976
Epoch 26/40
872/872 - 1650s - loss: 0.0780 - calc_accuracy: 0.9207 - val_loss: 0.1533 - val_calc_accuracy: 0.8999

Epoch 00026: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 27/40
872/872 - 1650s - loss: 0.0666 - calc_accuracy: 0.9344 - val_loss: 0.1435 - val_calc_accuracy: 0.9085
Epoch 28/40
872/872 - 1649s - loss: 0.0671 - calc_accuracy: 0.9330 - val_loss: 0.1535 - val_calc_accuracy: 0.9015
Epoch 29/40
872/872 - 1649s - loss: 0.0639 - calc_accuracy: 0.9344 - val_loss: 0.1840 - val_calc_accuracy: 0.8967
Epoch 30/40
872/872 - 1650s - loss: 0.0580 - calc_accuracy: 0.9410 - val_loss: 0.1584 - val_calc_accuracy: 0.9084

Epoch 00030: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 31/40
872/872 - 1648s - loss: 0.0520 - calc_accuracy: 0.9465 - val_loss: 0.1670 - val_calc_accuracy: 0.9060
Epoch 32/40
872/872 - 1648s - loss: 0.0500 - calc_accuracy: 0.9489 - val_loss: 0.1674 - val_calc_accuracy: 0.9128
Epoch 33/40
872/872 - 1651s - loss: 0.0471 - calc_accuracy: 0.9519 - val_loss: 0.1591 - val_calc_accuracy: 0.9116
Epoch 34/40
872/872 - 1649s - loss: 0.0465 - calc_accuracy: 0.9531 - val_loss: 0.1879 - val_calc_accuracy: 0.9067
Epoch 35/40
872/872 - 1655s - loss: 0.0427 - calc_accuracy: 0.9555 - val_loss: 0.1540 - val_calc_accuracy: 0.9192
Epoch 36/40
872/872 - 1659s - loss: 0.0423 - calc_accuracy: 0.9580 - val_loss: 0.1542 - val_calc_accuracy: 0.9209
Epoch 37/40
872/872 - 1692s - loss: 0.0409 - calc_accuracy: 0.9590 - val_loss: 0.2089 - val_calc_accuracy: 0.8993
Epoch 38/40
872/872 - 1681s - loss: 0.0389 - calc_accuracy: 0.9612 - val_loss: 0.1563 - val_calc_accuracy: 0.9150
Epoch 39/40
872/872 - 1683s - loss: 0.0349 - calc_accuracy: 0.9648 - val_loss: 0.1602 - val_calc_accuracy: 0.9174

Epoch 00039: ReduceLROnPlateau reducing learning rate to 0.00031640623637940735.
Epoch 40/40
872/872 - 1711s - loss: 0.0329 - calc_accuracy: 0.9678 - val_loss: 0.1633 - val_calc_accuracy: 0.9196
Using TensorFlow backend.

 See logs at ../../cache/conv___03_1626___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___512ch_3___2028/logs/