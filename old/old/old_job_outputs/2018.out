Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v27_augm_v0_cleaned_8000.pkl
File:  conv.train2018
Description:  redo_mod9_64ch
2021-03-22 10:35:34.948122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-22 10:35:36.847708: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-22 10:35:36.848557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-03-22 10:35:36.885410: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:36.886020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-03-22 10:35:36.886046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-22 10:35:36.889395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-22 10:35:36.889469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-22 10:35:36.890542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-22 10:35:36.890831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-22 10:35:36.891817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-22 10:35:36.892743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-22 10:35:36.892916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-22 10:35:36.893023: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:36.893708: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:36.894300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-22 10:35:36.896211: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-22 10:35:36.896363: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:36.896961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-03-22 10:35:36.896987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-22 10:35:36.897016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-22 10:35:36.897033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-22 10:35:36.897050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-22 10:35:36.897066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-22 10:35:36.897094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-22 10:35:36.897111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-22 10:35:36.897128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-22 10:35:36.897206: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:36.897808: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:36.898354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-22 10:35:36.898393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-22 10:35:37.538063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-22 10:35:37.538111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-03-22 10:35:37.538120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-03-22 10:35:37.538378: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:37.539053: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:37.539634: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-22 10:35:37.540194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14760 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
2021-03-22 10:35:37.989214: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-22 10:35:37.989247: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-22 10:35:37.991449: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-03-22 10:35:37.992869: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-03-22 10:35:37.993668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-03-22 10:35:38.178811: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-03-22 10:35:38.181341: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2018.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v27_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___03_1019___all_sw_coch_preprocessed_v2_param_v27_augm_v0_cleaned_8000___redo_mod9_64ch___2018/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 32, 'LR': 0.001, 'SHAPE': (64, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07}
Learning Rate Parameters: {'factor': 0.5, 'patience': 4, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 8, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 64, 1250, 3) 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 64, 1250, 3)  12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 64, 1250, 16) 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 64, 1250, 16) 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 64, 1250, 3)  0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 64, 1250, 16) 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 64, 1250, 16) 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 64, 1250, 16) 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 64, 1250, 48) 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 32, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 32, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 32, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 32, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 16, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 16, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 16, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 16, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 16, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 8, 156, 64)   0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 8, 156, 64)   256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 8, 156, 64)   0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 8, 156, 128)  91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 8, 156, 128)  230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 4, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 4, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 4, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 4, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 4, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 2, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 2, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 2, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 2, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 2, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        2021-03-22 10:35:39.072734: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-03-22 10:35:39.074716: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-03-22 10:35:42.307527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-22 10:35:42.699795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-22 10:35:42.712259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-22 10:35:46.268084: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-22 10:35:46.268122: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-22 10:35:47.447308: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-03-22 10:35:47.450007: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-03-22 10:35:47.488914: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 1823 callback api events and 1819 activity events. 
2021-03-22 10:35:47.528449: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.

__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            1026        global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,201,262
Trainable params: 6,159,752
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
436/436 - 330s - loss: 0.3325 - calc_accuracy: 0.6611 - val_loss: 0.7491 - val_calc_accuracy: 0.3941
Epoch 2/40
436/436 - 319s - loss: 0.2525 - calc_accuracy: 0.7361 - val_loss: 0.5744 - val_calc_accuracy: 0.6147
Epoch 3/40
436/436 - 320s - loss: 0.2329 - calc_accuracy: 0.7557 - val_loss: 0.4820 - val_calc_accuracy: 0.6348
Epoch 4/40
436/436 - 320s - loss: 0.2204 - calc_accuracy: 0.7694 - val_loss: 0.4145 - val_calc_accuracy: 0.6735
Epoch 5/40
436/436 - 319s - loss: 0.2122 - calc_accuracy: 0.7781 - val_loss: 0.4359 - val_calc_accuracy: 0.6346
Epoch 6/40
436/436 - 318s - loss: 0.2038 - calc_accuracy: 0.7850 - val_loss: 0.2511 - val_calc_accuracy: 0.8098
Epoch 7/40
436/436 - 319s - loss: 0.1947 - calc_accuracy: 0.8003 - val_loss: 0.3189 - val_calc_accuracy: 0.7619
Epoch 8/40
436/436 - 319s - loss: 0.1849 - calc_accuracy: 0.8095 - val_loss: 0.2606 - val_calc_accuracy: 0.7961
Epoch 9/40
436/436 - 320s - loss: 0.1793 - calc_accuracy: 0.8154 - val_loss: 0.2662 - val_calc_accuracy: 0.7957
Epoch 10/40
436/436 - 319s - loss: 0.1748 - calc_accuracy: 0.8160 - val_loss: 0.4589 - val_calc_accuracy: 0.6976

Epoch 00010: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
Epoch 11/40
436/436 - 320s - loss: 0.1510 - calc_accuracy: 0.8436 - val_loss: 0.2323 - val_calc_accuracy: 0.8170
Epoch 12/40
436/436 - 320s - loss: 0.1422 - calc_accuracy: 0.8526 - val_loss: 0.2427 - val_calc_accuracy: 0.8181
Epoch 13/40
436/436 - 319s - loss: 0.1358 - calc_accuracy: 0.8590 - val_loss: 0.2226 - val_calc_accuracy: 0.8371
Epoch 14/40
436/436 - 321s - loss: 0.1272 - calc_accuracy: 0.8686 - val_loss: 0.2910 - val_calc_accuracy: 0.8101
Epoch 15/40
436/436 - 319s - loss: 0.1209 - calc_accuracy: 0.8792 - val_loss: 0.2170 - val_calc_accuracy: 0.8376
Epoch 16/40
436/436 - 321s - loss: 0.1123 - calc_accuracy: 0.8879 - val_loss: 0.2080 - val_calc_accuracy: 0.8489
Epoch 17/40
436/436 - 322s - loss: 0.1049 - calc_accuracy: 0.8937 - val_loss: 0.2438 - val_calc_accuracy: 0.8373
Epoch 18/40
436/436 - 321s - loss: 0.0980 - calc_accuracy: 0.8991 - val_loss: 0.2513 - val_calc_accuracy: 0.8390
Epoch 19/40
436/436 - 320s - loss: 0.0906 - calc_accuracy: 0.9090 - val_loss: 0.2260 - val_calc_accuracy: 0.8368
Epoch 20/40
436/436 - 321s - loss: 0.0828 - calc_accuracy: 0.9146 - val_loss: 0.2429 - val_calc_accuracy: 0.8371

Epoch 00020: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
Epoch 21/40
436/436 - 320s - loss: 0.0626 - calc_accuracy: 0.9353 - val_loss: 0.2222 - val_calc_accuracy: 0.8661
Epoch 22/40
436/436 - 320s - loss: 0.0558 - calc_accuracy: 0.9424 - val_loss: 0.2175 - val_calc_accuracy: 0.8654
Epoch 23/40
436/436 - 319s - loss: 0.0500 - calc_accuracy: 0.9495 - val_loss: 0.2208 - val_calc_accuracy: 0.8706
Epoch 24/40
436/436 - 320s - loss: 0.0436 - calc_accuracy: 0.9555 - val_loss: 0.2505 - val_calc_accuracy: 0.8706
Epoch 25/40
436/436 - 322s - loss: 0.0416 - calc_accuracy: 0.9591 - val_loss: 0.2401 - val_calc_accuracy: 0.8692
Epoch 26/40
436/436 - 320s - loss: 0.0353 - calc_accuracy: 0.9649 - val_loss: 0.2600 - val_calc_accuracy: 0.8709
Epoch 27/40
436/436 - 320s - loss: 0.0349 - calc_accuracy: 0.9650 - val_loss: 0.2760 - val_calc_accuracy: 0.8712
Epoch 28/40
436/436 - 321s - loss: 0.0311 - calc_accuracy: 0.9698 - val_loss: 0.2549 - val_calc_accuracy: 0.8733
Epoch 29/40
436/436 - 321s - loss: 0.0288 - calc_accuracy: 0.9707 - val_loss: 0.2289 - val_calc_accuracy: 0.8818
Epoch 30/40
436/436 - 322s - loss: 0.0256 - calc_accuracy: 0.9742 - val_loss: 0.2815 - val_calc_accuracy: 0.8801
Epoch 31/40
436/436 - 321s - loss: 0.0254 - calc_accuracy: 0.9748 - val_loss: 0.2760 - val_calc_accuracy: 0.8709
Epoch 32/40
436/436 - 319s - loss: 0.0228 - calc_accuracy: 0.9768 - val_loss: 0.2719 - val_calc_accuracy: 0.8737
Epoch 33/40
436/436 - 319s - loss: 0.0218 - calc_accuracy: 0.9786 - val_loss: 0.2684 - val_calc_accuracy: 0.8818

Epoch 00033: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
Epoch 34/40
436/436 - 321s - loss: 0.0156 - calc_accuracy: 0.9858 - val_loss: 0.2777 - val_calc_accuracy: 0.8813
Epoch 35/40
436/436 - 321s - loss: 0.0147 - calc_accuracy: 0.9873 - val_loss: 0.2792 - val_calc_accuracy: 0.8841
Epoch 36/40
436/436 - 322s - loss: 0.0132 - calc_accuracy: 0.9877 - val_loss: 0.2902 - val_calc_accuracy: 0.8898
Epoch 37/40
436/436 - 321s - loss: 0.0112 - calc_accuracy: 0.9895 - val_loss: 0.3028 - val_calc_accuracy: 0.8904
Epoch 00037: early stopping

 See logs at ../../cache/conv___03_1019___all_sw_coch_preprocessed_v2_param_v27_augm_v0_cleaned_8000___redo_mod9_64ch___2018/logs/